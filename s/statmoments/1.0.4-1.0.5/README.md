# Comparing `tmp/statmoments-1.0.4.tar.gz` & `tmp/statmoments-1.0.5.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "statmoments-1.0.4.tar", last modified: Mon Nov  6 05:30:47 2023, max compression
+gzip compressed data, was "statmoments-1.0.5.tar", last modified: Tue May 21 07:18:11 2024, max compression
```

## Comparing `statmoments-1.0.4.tar` & `statmoments-1.0.5.tar`

### file list

```diff
@@ -1,34 +1,34 @@
-drwxrwxrwx   0        0        0        0 2023-11-06 05:30:47.542318 statmoments-1.0.4/
--rw-rw-rw-   0        0        0     1094 2023-04-30 05:31:06.000000 statmoments-1.0.4/LICENSE
--rw-rw-rw-   0        0        0    10504 2023-11-06 05:30:47.543307 statmoments-1.0.4/PKG-INFO
--rw-rw-rw-   0        0        0     8990 2023-11-06 05:30:35.000000 statmoments-1.0.4/README.md
--rw-rw-rw-   0        0        0     1936 2023-11-06 05:30:47.554123 statmoments-1.0.4/setup.cfg
--rw-rw-rw-   0        0        0     2268 2023-11-05 11:22:08.000000 statmoments-1.0.4/setup.py
-drwxrwxrwx   0        0        0        0 2023-11-06 05:30:47.336545 statmoments-1.0.4/statmoments/
--rw-rw-rw-   0        0        0      715 2023-09-16 05:14:35.000000 statmoments-1.0.4/statmoments/__init__.py
--rw-rw-rw-   0        0        0  3022830 2023-11-05 09:52:52.000000 statmoments-1.0.4/statmoments/_native.c
--rw-rw-rw-   0        0        0     1381 2023-11-06 05:18:59.000000 statmoments-1.0.4/statmoments/_native_shim.py
--rw-rw-rw-   0        0        0    12994 2023-11-06 05:30:35.000000 statmoments-1.0.4/statmoments/_statmoments_impl.py
--rw-rw-rw-   0        0        0       23 2023-11-06 05:30:35.000000 statmoments-1.0.4/statmoments/_version.py
-drwxrwxrwx   0        0        0        0 2023-11-06 05:30:47.483957 statmoments-1.0.4/statmoments/benchmark/
--rw-rw-rw-   0        0        0        0 2023-09-16 05:14:35.000000 statmoments-1.0.4/statmoments/benchmark/__init__.py
--rw-rw-rw-   0        0        0       80 2023-09-16 05:14:35.000000 statmoments-1.0.4/statmoments/benchmark/__main__.py
--rw-rw-rw-   0        0        0    15909 2023-09-16 05:14:35.000000 statmoments-1.0.4/statmoments/benchmark/bench_bivar.py
--rw-rw-rw-   0        0        0     3111 2023-09-16 05:14:35.000000 statmoments-1.0.4/statmoments/benchmark/benchlib.py
--rw-rw-rw-   0        0        0     1765 2023-10-04 20:58:04.000000 statmoments-1.0.4/statmoments/bivar.py
--rw-rw-rw-   0        0        0     2344 2023-09-16 05:14:35.000000 statmoments-1.0.4/statmoments/stattests.py
-drwxrwxrwx   0        0        0        0 2023-11-06 05:30:47.537307 statmoments-1.0.4/statmoments/tests/
--rw-rw-rw-   0        0        0        0 2023-09-16 05:14:35.000000 statmoments-1.0.4/statmoments/tests/__init__.py
--rw-rw-rw-   0        0        0      314 2023-09-16 05:14:35.000000 statmoments-1.0.4/statmoments/tests/__main__.py
--rw-rw-rw-   0        0        0     8341 2023-09-16 05:14:35.000000 statmoments-1.0.4/statmoments/tests/test_bivar.py
--rw-rw-rw-   0        0        0     5049 2023-09-16 05:14:35.000000 statmoments-1.0.4/statmoments/tests/test_connect.py
--rw-rw-rw-   0        0        0    17519 2023-11-05 09:39:38.000000 statmoments-1.0.4/statmoments/tests/test_stattest.py
--rw-rw-rw-   0        0        0     5655 2023-09-16 05:14:35.000000 statmoments-1.0.4/statmoments/tests/test_univar.py
--rw-rw-rw-   0        0        0     1396 2023-09-27 03:57:05.000000 statmoments-1.0.4/statmoments/univar.py
-drwxrwxrwx   0        0        0        0 2023-11-06 05:30:47.441946 statmoments-1.0.4/statmoments.egg-info/
--rw-rw-rw-   0        0        0    10504 2023-11-06 05:30:46.000000 statmoments-1.0.4/statmoments.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      776 2023-11-06 05:30:47.000000 statmoments-1.0.4/statmoments.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2023-11-06 05:30:46.000000 statmoments-1.0.4/statmoments.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0        2 2023-11-05 08:34:22.000000 statmoments-1.0.4/statmoments.egg-info/not-zip-safe
--rw-rw-rw-   0        0        0       24 2023-11-06 05:30:46.000000 statmoments-1.0.4/statmoments.egg-info/requires.txt
--rw-rw-rw-   0        0        0       12 2023-11-06 05:30:46.000000 statmoments-1.0.4/statmoments.egg-info/top_level.txt
+drwxrwxrwx   0        0        0        0 2024-05-21 07:18:11.196660 statmoments-1.0.5/
+-rw-rw-rw-   0        0        0     1094 2023-04-30 05:31:06.000000 statmoments-1.0.5/LICENSE
+-rw-rw-rw-   0        0        0     8609 2024-05-21 07:18:11.196660 statmoments-1.0.5/PKG-INFO
+-rw-rw-rw-   0        0        0     7095 2024-05-21 07:02:24.000000 statmoments-1.0.5/README.md
+-rw-rw-rw-   0        0        0     1881 2024-05-21 07:18:11.198017 statmoments-1.0.5/setup.cfg
+-rw-rw-rw-   0        0        0     2266 2024-05-19 21:29:53.000000 statmoments-1.0.5/setup.py
+drwxrwxrwx   0        0        0        0 2024-05-21 07:18:11.056156 statmoments-1.0.5/statmoments/
+-rw-rw-rw-   0        0        0      715 2023-09-16 05:14:35.000000 statmoments-1.0.5/statmoments/__init__.py
+-rw-rw-rw-   0        0        0  3128650 2024-05-21 07:18:10.000000 statmoments-1.0.5/statmoments/_native.c
+-rw-rw-rw-   0        0        0     1381 2024-05-21 07:02:14.000000 statmoments-1.0.5/statmoments/_native_shim.py
+-rw-rw-rw-   0        0        0    13085 2024-05-20 20:37:45.000000 statmoments-1.0.5/statmoments/_statmoments_impl.py
+-rw-rw-rw-   0        0        0       23 2024-05-21 07:15:33.000000 statmoments-1.0.5/statmoments/_version.py
+drwxrwxrwx   0        0        0        0 2024-05-21 07:18:11.167863 statmoments-1.0.5/statmoments/benchmark/
+-rw-rw-rw-   0        0        0        0 2023-09-16 05:14:35.000000 statmoments-1.0.5/statmoments/benchmark/__init__.py
+-rw-rw-rw-   0        0        0       80 2023-12-17 02:59:20.000000 statmoments-1.0.5/statmoments/benchmark/__main__.py
+-rw-rw-rw-   0        0        0     1651 2024-02-22 20:44:20.000000 statmoments-1.0.5/statmoments/benchmark/bench_bivar.py
+-rw-rw-rw-   0        0        0     3286 2023-12-17 07:17:21.000000 statmoments-1.0.5/statmoments/benchmark/benchlib.py
+-rw-rw-rw-   0        0        0     1765 2023-10-04 20:58:04.000000 statmoments-1.0.5/statmoments/bivar.py
+-rw-rw-rw-   0        0        0     2382 2023-12-17 06:29:18.000000 statmoments-1.0.5/statmoments/stattests.py
+drwxrwxrwx   0        0        0        0 2024-05-21 07:18:11.195651 statmoments-1.0.5/statmoments/tests/
+-rw-rw-rw-   0        0        0        0 2023-09-16 05:14:35.000000 statmoments-1.0.5/statmoments/tests/__init__.py
+-rw-rw-rw-   0        0        0      150 2024-02-22 20:44:20.000000 statmoments-1.0.5/statmoments/tests/__main__.py
+-rw-rw-rw-   0        0        0     7923 2024-05-21 05:49:42.000000 statmoments-1.0.5/statmoments/tests/test_bivar.py
+-rw-rw-rw-   0        0        0     4209 2024-02-22 20:44:20.000000 statmoments-1.0.5/statmoments/tests/test_connect.py
+-rw-rw-rw-   0        0        0    15927 2024-05-21 07:02:24.000000 statmoments-1.0.5/statmoments/tests/test_stattest.py
+-rw-rw-rw-   0        0        0     5570 2024-02-22 20:44:20.000000 statmoments-1.0.5/statmoments/tests/test_univar.py
+-rw-rw-rw-   0        0        0     1396 2023-09-27 03:57:05.000000 statmoments-1.0.5/statmoments/univar.py
+drwxrwxrwx   0        0        0        0 2024-05-21 07:18:11.128011 statmoments-1.0.5/statmoments.egg-info/
+-rw-rw-rw-   0        0        0     8609 2024-05-21 07:18:10.000000 statmoments-1.0.5/statmoments.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      776 2024-05-21 07:18:10.000000 statmoments-1.0.5/statmoments.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2024-05-21 07:18:10.000000 statmoments-1.0.5/statmoments.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0        2 2024-05-21 07:18:10.000000 statmoments-1.0.5/statmoments.egg-info/not-zip-safe
+-rw-rw-rw-   0        0        0       24 2024-05-21 07:18:10.000000 statmoments-1.0.5/statmoments.egg-info/requires.txt
+-rw-rw-rw-   0        0        0       12 2024-05-21 07:18:10.000000 statmoments-1.0.5/statmoments.egg-info/top_level.txt
```

### Comparing `statmoments-1.0.4/LICENSE` & `statmoments-1.0.5/LICENSE`

 * *Files identical despite different names*

### Comparing `statmoments-1.0.4/PKG-INFO` & `statmoments-1.0.5/PKG-INFO`

 * *Files 22% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: statmoments
-Version: 1.0.4
+Version: 1.0.5
 Summary: Fast streaming single-pass univariate/bivariate statistics and t-test
 Author: Anton Kochepasov
 Author-email: akss@me.com
 License: MIT
 Project-URL: Source Code, https://github.com/akochepasov/statmoments/
 Keywords: data-science,univariate,bivariate,statistics,streaming,numpy,vectorization
 Platform: any
@@ -31,53 +31,52 @@
 Description-Content-Type: text/markdown
 License-File: LICENSE
 
 # statmoments
 
 Fast streaming univariate and bivariate moments and t-statistics.
 
-statmoments is a library for the fast streaming one-pass computation of univariate and bivariate moments for batches of multiple of waveforms or traces with thousands of sample points. Given the data sorting with classifiers, it can compute Welch's t-test statistics of various orders for arbitrary data partitioning to allow finding relationships and statistical differences among many data splits, which are unknown beforehand. statmoments uses best-of-class BLAS implementation and preprocesses input data to make the most of computational power and perform computations as fast as possible on Windows and Linux platforms.
+statmoments is a library for fast one-pass computation of univariate and bivariate moments for batches of waveforms or traces with thousands of sample points. It can compute Welch's t-test statistics for arbitrary data partitioning, helping find relationships and statistical differences among data splits. Using top BLAS implementations, statmoments preprocesses data to maximize computational efficiency on Windows and Linux.
 
 ## How is that different?
 
-When the difference in input data is really subtle, millions of waveforms should be processed to find the statistically significant difference. Therefore, computationally efficient algorithms for analyzing such volumes of data are crucial for practical use. Due to their nature, computing high-order moments and statistics requires 2- or 3-pass computations. However, not all the data can fit into the available memory. In another case, after initial input has been processed, new data may appear, which requires starting the process over. When the input waveforms contain many thousands of sample points, it adds another dimension to an already complex problem.
+When input data differences are subtle, millions of waveforms may have to be processed to find the statistically significant difference, requiring efficient algorithms. In addition to that, the high-order moment computation need multiple passes and may require starting over once new data appear. With thousands of sample points per waveform, the problem becomes more complex.
 
-This can be overcome with a streaming approach. A streaming algorithm examines a sequence of inputs in a single pass, it processes data as it is collected, without waiting for it to be pre-collected and stored in a persistent storage. Streaming computation is often used to process data from real-time sources, such as oscilloscopes, sensors as well as financial markets. It can also be used to process large datasets that are too large to fit in memory or to process data that is constantly changing. Another name for such an approach is an online algorithm.
+A streaming algorithm process a sequence of inputs in a single pass it is collected, when it's fast enough, it's suitable for real-time sources like oscilloscopes, sensors, and financial markets, or for large datasets that don't fit in memory. The dense matrix representation reduces memory requirements. The accumulator can be converted to co-moments and Welch's t-test statistics on demand. Data batches can be iteratively processed, increasing precision and then discarded. The library handles significant input streams, processing hundreds of megabytes per second.
 
-This library implements streaming algorithms to avoid recomputation, and stores intermediate data in the accumulator. The algorithm also takes into account that covariance and higher matrices are represented by a symmetric matrix, decreasing the memory requirement two-fold. The data update is blazingly fast and at any moment the internal accumulator can be converted to (co-)moments on demand and the moments in turn can be converted to t-statistics with Welch's t-test. Once more data is collected, it can be iteratively processed, increasing the precision of the moments, and discarded. The computation is optimized to consume significant input streams, hundreds of megabytes per second of waveforms, which may contain thousands of points.
 Yet another dimension can be added when the data split is unknown. In other words, which bucket the input waveform belongs to. This library solves this with pre-classification of the input data and computing moments for all the requested data splits.
 
 Some of the benefits of streaming computation include:
 
-- Real-time insights from the data, such as identifying trends and detecting anomalies.
-- Reduced latency of data processing, as the data is processed as generated and then discarded. This is important for applications where time is critical, from financial trading to online gaming.
-- Scalability: Streaming computation can handle large volumes of data. This is important for research that generates large amounts of data, such as astrophysics and financial analysis.
+- Real-time insights for trend identification and anomaly detection
+- Reduced data processing latency, crucial for time-sensitive applications
+- Scalability to handle large data volumes, essential for data-intensive research in fields like astrophysics and financial analysis
 
 ## Where is this needed?
 
-Univariate statistics are used in various fields and contexts to analyze and describe the characteristics of a single variable or data set. Common applications can be:
+Univariate statistics analyze and describe a single variable or dataset. Common applications include
 
-- Descriptive Statistics: summarizing and describing the central tendency, dispersion, and shape of a dataset.
-- Hypothesis Testing: testing hypothesis to determine if there are significant differences or relationships between groups or conditions.
-- Finance and Economics: Examining the performance of financial assets, tracking market trends, and assessing risk in real-time.
+- Descriptive Statistics: Summarizing central tendency, dispersion, and shape of a dataset
+- Hypothesis Testing: Determining significant differences or relationships between groups or conditions
+- Finance and Economics: Examining asset performance, tracking market trends, and assessing risk in real-time
 
-In summary, univariate statistics are a fundamental tool in data analysis and are widely used across a range of fields to explore, summarize, and draw conclusions from single-variable data. They provide essential insights into the characteristics and behavior of individual variables, which can inform decision-making and further research.
+In summary, univariate statistics are fundamental for data analysis, providing essential insights into individual variables across various fields, aiding in decision-making and further research.
 
-Bivariate statistics is a tool for understanding the relationships between two variables. Researchers and practitioners use it in a wide range of fields to make informed decisions and improve outcomes. They can be used to answer a variety of questions, such as:
+Bivariate statistics help understand relationships between two variables, aiding informed decisions across various fields. They address questions like:
 
 - Is there a statistically significant relationship between variables?
 - Which data points are related?
-- If any, how strong is the relationship?
-- Can we use one variable to predict the other variable?
+- How strong is the relationship?
+- Can we use one variable to predict the other?
 
-These statistical methods are used in medical and bioinformatics research, astrophysics, seismology, market predictions, and many more where the input data may be measured in hundreds of gigabytes.
+These statistical methods are used in medical and bioinformatics research, astrophysics, seismology, market predictions, and other fields, handling input data measured in hundreds of gigabytes.
 
 ## Numeric accuracy
 
-The numeric accuracy of results is dependent on the coefficient of variation (COV) of the sample point in the input waveforms. With COV of about 5%, the computed (co-)kurtosis has about 10 correct significant digits for 10'000 waveforms, which is more than enough for the resulting t-test. Increasing data by about 100x additionally loses one more significant digit.
+The numeric accuracy of results depends on the coefficient of variation (COV) of a sample point in the input waveforms. With a COV of about 5%, the computed (co-)kurtosis has about 10 correct significant digits for 10,000 waveforms, sufficient for Welch's t-test. Increasing data by 100x loses one more significant digit.
 
 ## Examples
 
 ### Performing univariate data analysis
 
 ```python
   # Input data parameters
@@ -91,16 +90,16 @@
   # Process input data and split hypotheses
   uveng.update(wforms1, classification1)
 
   # Process more input data and split hypotheses
   uveng.update(wforms2, classification2)
 
   # Get statistical moments
-  mean       = [cm.copy() for cm in uveng.moments(moments=1)]
-  skeweness  = [cm.copy() for cm in uveng.moments(moments=3)]
+  mean       = [cm.copy() for cm in uveng.moments(moments=1)]  # E(X)
+  skeweness  = [cm.copy() for cm in uveng.moments(moments=3)]  # E(X^3)
 
   # Detect statistical differences in the first-order t-test
   for i, tt in enumerate(statmoments.stattests.ttests(uveng, moment=1)):
     if np.any(np.abs(tt) > 5):
       print(f"Data split {i} has different means")
 
   # Process more input data and split hypotheses
@@ -123,20 +122,20 @@
   # Process input data and split hypotheses
   bveng.update(wforms1, classification1)
 
   # Process more input data and split hypotheses
   bveng.update(wforms2, classification2)
 
   # Get bivariate moments
-  covariance    = [cm.copy() for cm in bveng.comoments(moments=(1, 1))]
-  cokurtosis22  = [cm.copy() for cm in bveng.comoments(moments=(2, 2))]
-  cokurtosis13  = [cm.copy() for cm in bveng.comoments(moments=(1, 3))]
+  covariance    = [cm.copy() for cm in bveng.comoments(moments=(1, 1))]  # E(X Y)
+  cokurtosis22  = [cm.copy() for cm in bveng.comoments(moments=(2, 2))]  # E(X^2 Y^2)
+  cokurtosis13  = [cm.copy() for cm in bveng.comoments(moments=(1, 3))]  # E(X^1 Y^3)
 
   # univariate statistical moments are also can be obtained
-  variance   = [cm.copy() for cm in bveng.moments(moments=2)]
+  variance   = [cm.copy() for cm in bveng.moments(moments=2)]  # E(X^2)
 
   # Detect statistical differences in the second order t-test (covariances)
   for i, tt in enumerate(statmoments.stattests.ttests(bveng, moment=(1,1))):
     if np.any(np.abs(tt) > 5):
       print(f"Found stat diff in the split {i}")
 
   # Process more input data and split hypotheses
@@ -144,31 +143,27 @@
 
   # Get updated statistical moments and t-tests
 ```
 
 ### Performing data analysis from the command line
 
 ```shell
-# Find univariate t-test statistics of skeweness for
-# the first 5000 waveform sample points
-# taken from the HDF5 dataset
+# Find univariate t-test statistics of skeweness for the first
+# 5000 waveform sample points, stored in a HDF5 dataset
 python -m statmoments.univar -i data.h5 -m 3 -r 0:5000
 
-# Find bivariate t-test statistics of covariance for
-# the first 1000 waveform sample points
-# Taken from the HDF5 dataset
+# Find bivariate t-test statistics of covariance for the first
+# 1000 waveform sample points, stored in a HDF5 dataset
 python -m statmoments.bivar -i data.h5 -r 0:1000
 ```
 
 More examples can be found in the examples and tests directories.
 
 ## Implementation notes
 
-Since the output data can exhaust the existing RAM, the results are the matrices of statistical moments for the requested region, which is produced in a one-at-a-time fashion for each input classifier. The output moment for each classifier has dimension 2 x M x L, where, M is an index of the requested classifier, L is the region length. t-test is represented by a 1D array for each classifier.
-The **bivariate moments** are represented by the **upper triangle** of the symmetric matrix.
-
+Due to RAM limits, results are produced one at a time for each input classifier as the set of statistical moments. Each classifier's output moment has dimensions 2 x M x L, where M is an index of the requested classifier and L is the region length. The co-moments and t-tests is represented by a 1D array for each classifier. **Bivariate moments** are represented by the **upper triangle** of the symmetric matrix.
 
 ## Installation
 
 ```shell
 pip install statmoments
 ```
```

### Comparing `statmoments-1.0.4/README.md` & `statmoments-1.0.5/statmoments.egg-info/PKG-INFO`

 * *Files 11% similar despite different names*

```diff
@@ -1,50 +1,82 @@
+Metadata-Version: 2.1
+Name: statmoments
+Version: 1.0.5
+Summary: Fast streaming single-pass univariate/bivariate statistics and t-test
+Author: Anton Kochepasov
+Author-email: akss@me.com
+License: MIT
+Project-URL: Source Code, https://github.com/akochepasov/statmoments/
+Keywords: data-science,univariate,bivariate,statistics,streaming,numpy,vectorization
+Platform: any
+Classifier: Development Status :: 5 - Production/Stable
+Classifier: Environment :: Console
+Classifier: Intended Audience :: Developers
+Classifier: Intended Audience :: Science/Research
+Classifier: Intended Audience :: Financial and Insurance Industry
+Classifier: License :: OSI Approved :: MIT License
+Classifier: Operating System :: OS Independent
+Classifier: Programming Language :: Cython
+Classifier: Programming Language :: Python
+Classifier: Programming Language :: Python :: 3
+Classifier: Programming Language :: Python :: 3.6
+Classifier: Programming Language :: Python :: 3.7
+Classifier: Programming Language :: Python :: 3.8
+Classifier: Programming Language :: Python :: 3.9
+Classifier: Programming Language :: Python :: 3.10
+Classifier: Topic :: Scientific/Engineering :: Artificial Intelligence
+Classifier: Topic :: Scientific/Engineering :: Image Processing
+Classifier: Topic :: Scientific/Engineering :: Information Analysis
+Classifier: Topic :: Scientific/Engineering :: Mathematics
+Classifier: Topic :: Scientific/Engineering :: Physics
+Description-Content-Type: text/markdown
+License-File: LICENSE
+
 # statmoments
 
 Fast streaming univariate and bivariate moments and t-statistics.
 
-statmoments is a library for the fast streaming one-pass computation of univariate and bivariate moments for batches of multiple of waveforms or traces with thousands of sample points. Given the data sorting with classifiers, it can compute Welch's t-test statistics of various orders for arbitrary data partitioning to allow finding relationships and statistical differences among many data splits, which are unknown beforehand. statmoments uses best-of-class BLAS implementation and preprocesses input data to make the most of computational power and perform computations as fast as possible on Windows and Linux platforms.
+statmoments is a library for fast one-pass computation of univariate and bivariate moments for batches of waveforms or traces with thousands of sample points. It can compute Welch's t-test statistics for arbitrary data partitioning, helping find relationships and statistical differences among data splits. Using top BLAS implementations, statmoments preprocesses data to maximize computational efficiency on Windows and Linux.
 
 ## How is that different?
 
-When the difference in input data is really subtle, millions of waveforms should be processed to find the statistically significant difference. Therefore, computationally efficient algorithms for analyzing such volumes of data are crucial for practical use. Due to their nature, computing high-order moments and statistics requires 2- or 3-pass computations. However, not all the data can fit into the available memory. In another case, after initial input has been processed, new data may appear, which requires starting the process over. When the input waveforms contain many thousands of sample points, it adds another dimension to an already complex problem.
+When input data differences are subtle, millions of waveforms may have to be processed to find the statistically significant difference, requiring efficient algorithms. In addition to that, the high-order moment computation need multiple passes and may require starting over once new data appear. With thousands of sample points per waveform, the problem becomes more complex.
 
-This can be overcome with a streaming approach. A streaming algorithm examines a sequence of inputs in a single pass, it processes data as it is collected, without waiting for it to be pre-collected and stored in a persistent storage. Streaming computation is often used to process data from real-time sources, such as oscilloscopes, sensors as well as financial markets. It can also be used to process large datasets that are too large to fit in memory or to process data that is constantly changing. Another name for such an approach is an online algorithm.
+A streaming algorithm process a sequence of inputs in a single pass it is collected, when it's fast enough, it's suitable for real-time sources like oscilloscopes, sensors, and financial markets, or for large datasets that don't fit in memory. The dense matrix representation reduces memory requirements. The accumulator can be converted to co-moments and Welch's t-test statistics on demand. Data batches can be iteratively processed, increasing precision and then discarded. The library handles significant input streams, processing hundreds of megabytes per second.
 
-This library implements streaming algorithms to avoid recomputation, and stores intermediate data in the accumulator. The algorithm also takes into account that covariance and higher matrices are represented by a symmetric matrix, decreasing the memory requirement two-fold. The data update is blazingly fast and at any moment the internal accumulator can be converted to (co-)moments on demand and the moments in turn can be converted to t-statistics with Welch's t-test. Once more data is collected, it can be iteratively processed, increasing the precision of the moments, and discarded. The computation is optimized to consume significant input streams, hundreds of megabytes per second of waveforms, which may contain thousands of points.
 Yet another dimension can be added when the data split is unknown. In other words, which bucket the input waveform belongs to. This library solves this with pre-classification of the input data and computing moments for all the requested data splits.
 
 Some of the benefits of streaming computation include:
 
-- Real-time insights from the data, such as identifying trends and detecting anomalies.
-- Reduced latency of data processing, as the data is processed as generated and then discarded. This is important for applications where time is critical, from financial trading to online gaming.
-- Scalability: Streaming computation can handle large volumes of data. This is important for research that generates large amounts of data, such as astrophysics and financial analysis.
+- Real-time insights for trend identification and anomaly detection
+- Reduced data processing latency, crucial for time-sensitive applications
+- Scalability to handle large data volumes, essential for data-intensive research in fields like astrophysics and financial analysis
 
 ## Where is this needed?
 
-Univariate statistics are used in various fields and contexts to analyze and describe the characteristics of a single variable or data set. Common applications can be:
+Univariate statistics analyze and describe a single variable or dataset. Common applications include
 
-- Descriptive Statistics: summarizing and describing the central tendency, dispersion, and shape of a dataset.
-- Hypothesis Testing: testing hypothesis to determine if there are significant differences or relationships between groups or conditions.
-- Finance and Economics: Examining the performance of financial assets, tracking market trends, and assessing risk in real-time.
+- Descriptive Statistics: Summarizing central tendency, dispersion, and shape of a dataset
+- Hypothesis Testing: Determining significant differences or relationships between groups or conditions
+- Finance and Economics: Examining asset performance, tracking market trends, and assessing risk in real-time
 
-In summary, univariate statistics are a fundamental tool in data analysis and are widely used across a range of fields to explore, summarize, and draw conclusions from single-variable data. They provide essential insights into the characteristics and behavior of individual variables, which can inform decision-making and further research.
+In summary, univariate statistics are fundamental for data analysis, providing essential insights into individual variables across various fields, aiding in decision-making and further research.
 
-Bivariate statistics is a tool for understanding the relationships between two variables. Researchers and practitioners use it in a wide range of fields to make informed decisions and improve outcomes. They can be used to answer a variety of questions, such as:
+Bivariate statistics help understand relationships between two variables, aiding informed decisions across various fields. They address questions like:
 
 - Is there a statistically significant relationship between variables?
 - Which data points are related?
-- If any, how strong is the relationship?
-- Can we use one variable to predict the other variable?
+- How strong is the relationship?
+- Can we use one variable to predict the other?
 
-These statistical methods are used in medical and bioinformatics research, astrophysics, seismology, market predictions, and many more where the input data may be measured in hundreds of gigabytes.
+These statistical methods are used in medical and bioinformatics research, astrophysics, seismology, market predictions, and other fields, handling input data measured in hundreds of gigabytes.
 
 ## Numeric accuracy
 
-The numeric accuracy of results is dependent on the coefficient of variation (COV) of the sample point in the input waveforms. With COV of about 5%, the computed (co-)kurtosis has about 10 correct significant digits for 10'000 waveforms, which is more than enough for the resulting t-test. Increasing data by about 100x additionally loses one more significant digit.
+The numeric accuracy of results depends on the coefficient of variation (COV) of a sample point in the input waveforms. With a COV of about 5%, the computed (co-)kurtosis has about 10 correct significant digits for 10,000 waveforms, sufficient for Welch's t-test. Increasing data by 100x loses one more significant digit.
 
 ## Examples
 
 ### Performing univariate data analysis
 
 ```python
   # Input data parameters
@@ -58,16 +90,16 @@
   # Process input data and split hypotheses
   uveng.update(wforms1, classification1)
 
   # Process more input data and split hypotheses
   uveng.update(wforms2, classification2)
 
   # Get statistical moments
-  mean       = [cm.copy() for cm in uveng.moments(moments=1)]
-  skeweness  = [cm.copy() for cm in uveng.moments(moments=3)]
+  mean       = [cm.copy() for cm in uveng.moments(moments=1)]  # E(X)
+  skeweness  = [cm.copy() for cm in uveng.moments(moments=3)]  # E(X^3)
 
   # Detect statistical differences in the first-order t-test
   for i, tt in enumerate(statmoments.stattests.ttests(uveng, moment=1)):
     if np.any(np.abs(tt) > 5):
       print(f"Data split {i} has different means")
 
   # Process more input data and split hypotheses
@@ -90,20 +122,20 @@
   # Process input data and split hypotheses
   bveng.update(wforms1, classification1)
 
   # Process more input data and split hypotheses
   bveng.update(wforms2, classification2)
 
   # Get bivariate moments
-  covariance    = [cm.copy() for cm in bveng.comoments(moments=(1, 1))]
-  cokurtosis22  = [cm.copy() for cm in bveng.comoments(moments=(2, 2))]
-  cokurtosis13  = [cm.copy() for cm in bveng.comoments(moments=(1, 3))]
+  covariance    = [cm.copy() for cm in bveng.comoments(moments=(1, 1))]  # E(X Y)
+  cokurtosis22  = [cm.copy() for cm in bveng.comoments(moments=(2, 2))]  # E(X^2 Y^2)
+  cokurtosis13  = [cm.copy() for cm in bveng.comoments(moments=(1, 3))]  # E(X^1 Y^3)
 
   # univariate statistical moments are also can be obtained
-  variance   = [cm.copy() for cm in bveng.moments(moments=2)]
+  variance   = [cm.copy() for cm in bveng.moments(moments=2)]  # E(X^2)
 
   # Detect statistical differences in the second order t-test (covariances)
   for i, tt in enumerate(statmoments.stattests.ttests(bveng, moment=(1,1))):
     if np.any(np.abs(tt) > 5):
       print(f"Found stat diff in the split {i}")
 
   # Process more input data and split hypotheses
@@ -111,31 +143,27 @@
 
   # Get updated statistical moments and t-tests
 ```
 
 ### Performing data analysis from the command line
 
 ```shell
-# Find univariate t-test statistics of skeweness for
-# the first 5000 waveform sample points
-# taken from the HDF5 dataset
+# Find univariate t-test statistics of skeweness for the first
+# 5000 waveform sample points, stored in a HDF5 dataset
 python -m statmoments.univar -i data.h5 -m 3 -r 0:5000
 
-# Find bivariate t-test statistics of covariance for
-# the first 1000 waveform sample points
-# Taken from the HDF5 dataset
+# Find bivariate t-test statistics of covariance for the first
+# 1000 waveform sample points, stored in a HDF5 dataset
 python -m statmoments.bivar -i data.h5 -r 0:1000
 ```
 
 More examples can be found in the examples and tests directories.
 
 ## Implementation notes
 
-Since the output data can exhaust the existing RAM, the results are the matrices of statistical moments for the requested region, which is produced in a one-at-a-time fashion for each input classifier. The output moment for each classifier has dimension 2 x M x L, where, M is an index of the requested classifier, L is the region length. t-test is represented by a 1D array for each classifier.
-The **bivariate moments** are represented by the **upper triangle** of the symmetric matrix.
-
+Due to RAM limits, results are produced one at a time for each input classifier as the set of statistical moments. Each classifier's output moment has dimensions 2 x M x L, where M is an index of the requested classifier and L is the region length. The co-moments and t-tests is represented by a 1D array for each classifier. **Bivariate moments** are represented by the **upper triangle** of the symmetric matrix.
 
 ## Installation
 
 ```shell
 pip install statmoments
 ```
```

### Comparing `statmoments-1.0.4/setup.cfg` & `statmoments-1.0.5/setup.cfg`

 * *Files 4% similar despite different names*

```diff
@@ -86,36 +86,33 @@
 00000550: 203d 2066 696e 643a 0d0a 696e 7374 616c   = find:..instal
 00000560: 6c5f 7265 7175 6972 6573 203d 200d 0a09  l_requires = ...
 00000570: 6835 7079 0d0a 096e 756d 7079 0d0a 0973  h5py...numpy...s
 00000580: 6369 7079 0d0a 0970 7375 7469 6c0d 0a73  cipy...psutil..s
 00000590: 6574 7570 5f72 6571 7569 7265 7320 3d20  etup_requires = 
 000005a0: 0d0a 0963 7974 686f 6e0d 0a0d 0a5b 666c  ...cython....[fl
 000005b0: 616b 6538 5d0d 0a69 676e 6f72 6520 3d20  ake8]..ignore = 
-000005c0: 4531 3131 2c45 3131 342c 4532 3236 2c45  E111,E114,E226,E
-000005d0: 3233 312c 4532 3431 2c45 3237 322c 4532  231,E241,E272,E2
-000005e0: 3231 0d0a 7065 722d 6669 6c65 2d69 676e  21..per-file-ign
-000005f0: 6f72 6573 203d 200d 0a09 5f5f 696e 6974  ores = ...__init
-00000600: 5f5f 2e70 793a 2046 3430 310d 0a09 5f73  __.py: F401..._s
-00000610: 7461 746d 6f6d 656e 7473 5f69 6d70 6c2e  tatmoments_impl.
-00000620: 7079 3a20 4634 3031 0d0a 095f 6e61 7469  py: F401..._nati
-00000630: 7665 5f73 6869 6d2e 7079 3a20 2045 3430  ve_shim.py:  E40
-00000640: 322c 4634 3031 2c46 3430 330d 0a09 6265  2,F401,F403...be
-00000650: 6e63 685f 6269 7661 722e 7079 3a20 2020  nch_bivar.py:   
-00000660: 4531 3231 2c45 3132 322c 4532 3031 2c45  E121,E122,E201,E
-00000670: 3236 322c 4532 3635 0d0a 0965 7861 6d70  262,E265...examp
-00000680: 6c65 732f 6269 7661 722e 7079 3a20 2046  les/bivar.py:  F
-00000690: 3834 310d 0a09 6578 616d 706c 6573 2f75  841...examples/u
-000006a0: 6e69 7661 722e 7079 3a20 4638 3431 0d0a  nivar.py: F841..
-000006b0: 6578 636c 7564 6520 3d20 0d0a 092e 6769  exclude = ....gi
-000006c0: 742c 0d0a 095f 5f70 7963 6163 6865 5f5f  t,...__pycache__
-000006d0: 2c0d 0a09 6275 696c 640d 0a6d 6178 2d6c  ,...build..max-l
-000006e0: 696e 652d 6c65 6e67 7468 203d 2031 3630  ine-length = 160
-000006f0: 0d0a 7374 6174 6973 7469 6373 203d 2079  ..statistics = y
-00000700: 6573 0d0a 0d0a 5b70 6570 385d 0d0a 6967  es....[pep8]..ig
-00000710: 6e6f 7265 203d 2045 3131 312c 4531 3134  nore = E111,E114
-00000720: 2c45 3232 362c 4532 3331 2c45 3234 312c  ,E226,E231,E241,
-00000730: 4532 3732 2c45 3232 310d 0a6d 6178 2d6c  E272,E221..max-l
-00000740: 696e 652d 6c65 6e67 7468 203d 2031 3630  ine-length = 160
-00000750: 0d0a 7374 6174 6973 7469 6373 203d 2079  ..statistics = y
-00000760: 6573 0d0a 0d0a 5b65 6767 5f69 6e66 6f5d  es....[egg_info]
-00000770: 0d0a 7461 675f 6275 696c 6420 3d20 0d0a  ..tag_build = ..
-00000780: 7461 675f 6461 7465 203d 2030 0d0a 0d0a  tag_date = 0....
+000005c0: 4531 3131 2c45 3131 342c 4532 3231 2c45  E111,E114,E221,E
+000005d0: 3234 312c 4532 3732 0d0a 7065 722d 6669  241,E272..per-fi
+000005e0: 6c65 2d69 676e 6f72 6573 203d 200d 0a09  le-ignores = ...
+000005f0: 5f5f 696e 6974 5f5f 2e70 793a 2046 3430  __init__.py: F40
+00000600: 310d 0a09 5f73 7461 746d 6f6d 656e 7473  1..._statmoments
+00000610: 5f69 6d70 6c2e 7079 3a20 4634 3031 0d0a  _impl.py: F401..
+00000620: 095f 6e61 7469 7665 5f73 6869 6d2e 7079  ._native_shim.py
+00000630: 3a20 2045 3430 322c 4634 3031 2c46 3430  :  E402,F401,F40
+00000640: 330d 0a09 6578 616d 706c 6573 2f62 6976  3...examples/biv
+00000650: 6172 2e70 793a 2020 4638 3431 0d0a 0965  ar.py:  F841...e
+00000660: 7861 6d70 6c65 732f 756e 6976 6172 2e70  xamples/univar.p
+00000670: 793a 2046 3834 310d 0a65 7863 6c75 6465  y: F841..exclude
+00000680: 203d 200d 0a09 2e67 6974 2c0d 0a09 5f5f   = ....git,...__
+00000690: 7079 6361 6368 655f 5f2c 0d0a 0962 7569  pycache__,...bui
+000006a0: 6c64 0d0a 6d61 782d 6c69 6e65 2d6c 656e  ld..max-line-len
+000006b0: 6774 6820 3d20 3136 300d 0a73 7461 7469  gth = 160..stati
+000006c0: 7374 6963 7320 3d20 7965 730d 0a0d 0a5b  stics = yes....[
+000006d0: 7065 7038 5d0d 0a69 676e 6f72 6520 3d20  pep8]..ignore = 
+000006e0: 4531 3131 2c45 3131 342c 4532 3236 2c45  E111,E114,E226,E
+000006f0: 3233 312c 4532 3431 2c45 3237 322c 4532  231,E241,E272,E2
+00000700: 3231 0d0a 6d61 782d 6c69 6e65 2d6c 656e  21..max-line-len
+00000710: 6774 6820 3d20 3136 300d 0a73 7461 7469  gth = 160..stati
+00000720: 7374 6963 7320 3d20 7965 730d 0a0d 0a5b  stics = yes....[
+00000730: 6567 675f 696e 666f 5d0d 0a74 6167 5f62  egg_info]..tag_b
+00000740: 7569 6c64 203d 200d 0a74 6167 5f64 6174  uild = ..tag_dat
+00000750: 6520 3d20 300d 0a0d 0a                   e = 0....
```

### Comparing `statmoments-1.0.4/setup.py` & `statmoments-1.0.5/setup.py`

 * *Files 0% similar despite different names*

```diff
@@ -7,14 +7,15 @@
 from Cython.Build import cythonize
 
 
 if sys.version_info < (3, 6, 0):
   # It should work even with 2.7, just never really tested
   raise RuntimeError("statmoments requires Python 3.6 or later")
 
+kwargs = {}
 basedir = os.path.abspath(os.path.dirname(__file__))
 USE_CYTHON = os.path.isfile(os.path.join(basedir, "statmoments/_native.pyx"))
 
 
 def make_ext(modname, filename):
   # This function required for in-place pyximport compilation over pyxbld
   compile_args, link_args = [], []
@@ -58,16 +59,14 @@
 
 #    self.cython_compile_time_env = cythonize_options
 #    self.force = True # TODO: delete this later
 
 #  setuptools.setup(
 #    cmdclass = {'build_ext' : build_ext_cupy},
 
-kwargs = {}
-
 
 def main():
   ext = '.pyx' if USE_CYTHON else '.c'
   extensions = [make_ext("statmoments._native", 'statmoments/_native' + ext)]
   extensions = cythonize('statmoments/_native' + ext) if USE_CYTHON else extensions
   setuptools.setup(
       version=get_version(),
```

### Comparing `statmoments-1.0.4/statmoments/__init__.py` & `statmoments-1.0.5/statmoments/__init__.py`

 * *Files identical despite different names*

### Comparing `statmoments-1.0.4/statmoments/_native.c` & `statmoments-1.0.5/statmoments/_native.c`

 * *Files 1% similar despite different names*

```diff
@@ -1149,23 +1149,23 @@
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_3__comoments;
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_4__moments;
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_5__triuflatten_gen;
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_6_memory_size;
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_7_genexpr;
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_8__moments;
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_9__comoments;
-struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10__sz_helper;
+struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10_memory_size;
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_11_genexpr;
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_12__moments;
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_13__comoments;
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_14__comoments;
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_15__ms_helper;
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_16_genexpr;
-struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17__moments;
-struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18__comoments;
+struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17_moments;
+struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18_comoments;
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_19_memory_size;
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_20_genexpr;
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_21__moments;
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_22__moments;
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
@@ -1175,172 +1175,176 @@
 struct __pyx_opt_args_11statmoments_7_native_dger;
 struct __pyx_opt_args_11statmoments_7_native_ssyrk;
 struct __pyx_opt_args_11statmoments_7_native_dsyrk;
 struct __pyx_opt_args_11statmoments_7_native_dgemm;
 struct __pyx_defaults;
 typedef struct __pyx_defaults __pyx_defaults;
 
-/* "statmoments/_native.pyx":44
+/* "statmoments/_native.pyx":56
  * @cython.returns(cython.void)
- * @cython.locals(a = 'double[::1]', b = 'double[::1]', da = cython.double)
+ * @cython.locals(a='double[::1]', b='double[::1]', da=cython.double)
  * def daxpy(a, b, da=1.0):             # <<<<<<<<<<<<<<
  *   """ b += da * a """
- *   cython.declare(n = cython.int, incx = cython.int)
+ *   cython.declare(n=cython.int, incx=cython.int)
  */
 struct __pyx_opt_args_11statmoments_7_native_daxpy {
   int __pyx_n;
   double da;
 };
 
-/* "statmoments/_native.pyx":61
- * @cython.locals(A = 'double[::1]', x = 'double[::1]', y = 'double[::1]', alpha = cython.double, beta = cython.double,
- *                uplo = cython.char, k = cython.int, lda = cython.int, incx = cython.int, incy = cython.int)
+/* "statmoments/_native.pyx":73
+ * @cython.locals(A='double[::1]', x='double[::1]', y='double[::1]', alpha=cython.double, beta=cython.double,
+ *                uplo=cython.char, k=cython.int, lda=cython.int, incx=cython.int, incy=cython.int)
  * def dsbmv(A, x, y, alpha = 1.0, beta = 0.0, uplo = b'L', k = 0, lda = 1, incx = 1, incy = 1):             # <<<<<<<<<<<<<<
  *   """ y := alpha*A*x + beta*y """
- *   cython.declare(n = cython.int)
+ *   cython.declare(n=cython.int)
  */
 struct __pyx_opt_args_11statmoments_7_native_dsbmv {
   int __pyx_n;
   double alpha;
   double beta;
   char uplo;
   int k;
   int lda;
   int incx;
   int incy;
 };
 
-/* "statmoments/_native.pyx":80
- * @cython.locals(A = 'double[:,::1]', x = 'double[::1]', y = 'double[::1]', alpha = cython.double,
- *                incx = cython.int, incy = cython.int)
+/* "statmoments/_native.pyx":93
+ * @cython.locals(A='double[:,::1]', x='double[::1]', y='double[::1]', alpha=cython.double,
+ *                incx=cython.int, incy=cython.int)
  * def dger(A, x, y, alpha=1.0, incx = 1, incy = 1):             # <<<<<<<<<<<<<<
- *     """ A := alpha*x*trans(y) + A """
- *     cython.declare(m = cython.int, n = cython.int)
+ *   """ A := alpha*x*trans(y) + A """
+ *   cython.declare(m=cython.int, n=cython.int)
  */
 struct __pyx_opt_args_11statmoments_7_native_dger {
   int __pyx_n;
   double alpha;
   int incx;
   int incy;
 };
 
-/* "statmoments/_native.pyx":98
- * @cython.locals(A = 'float[:,::1]', C = 'float[:,::1]', uplo = cython.char,
- *                trans = cython.char, alpha = cython.float, beta = cython.float)
+/* "statmoments/_native.pyx":111
+ * @cython.locals(A='float[:,::1]', C='float[:,::1]', uplo=cython.char,
+ *                trans=cython.char, alpha=cython.float, beta=cython.float)
  * def ssyrk(A, C, uplo, trans=b'N', alpha=1.0, beta=1.0):             # <<<<<<<<<<<<<<
  *   """ C = alpha * trans(A * A^T) + beta * C """
- *   cython.declare(n = cython.int, k = cython.int, lda = cython.int, ldc = cython.int)
+ *   cython.declare(n=cython.int, k=cython.int, lda=cython.int, ldc=cython.int)
  */
 struct __pyx_opt_args_11statmoments_7_native_ssyrk {
   int __pyx_n;
   char trans;
   float alpha;
   float beta;
 };
 
-/* "statmoments/_native.pyx":120
- * @cython.locals(A = 'double[:,::1]', C = 'double[:,::1]', uplo = cython.char,
- *                trans = cython.char, alpha = cython.double, beta = cython.double)
+/* "statmoments/_native.pyx":134
+ * @cython.locals(A='double[:,::1]', C='double[:,::1]', uplo=cython.char,
+ *                trans=cython.char, alpha=cython.double, beta=cython.double)
  * def dsyrk(A, C, uplo, trans=b'N', alpha=1.0, beta=1.0):             # <<<<<<<<<<<<<<
  *   """ C = alpha * trans(A * A^T) + beta * C """
- *   cython.declare(n = cython.int, k = cython.int, lda = cython.int, ldc = cython.int)
+ *   cython.declare(n=cython.int, k=cython.int, lda=cython.int, ldc=cython.int)
  */
 struct __pyx_opt_args_11statmoments_7_native_dsyrk {
   int __pyx_n;
   char trans;
   double alpha;
   double beta;
 };
 
-/* "statmoments/_native.pyx":158
- * @cython.returns(cython.void)
- * @cython.locals(a = 'double[:,::1]', b = 'double[:,::1]', c = 'double[:,::1]', transa = cython.char, transb = cython.char, alpha = cython.double, beta = cython.double)
+/* "statmoments/_native.pyx":174
+ * @cython.locals(a='double[:,::1]', b='double[:,::1]', c='double[:,::1]', transa=cython.char, transb=cython.char,
+ *                alpha=cython.double, beta=cython.double)
  * def dgemm(a, b, c, transa=b'N', transb=b'N', alpha=1.0, beta=1.0):             # <<<<<<<<<<<<<<
  *   """ C = alpha * transa(A) * transb(B) + beta * C """
- *   cython.declare(n = cython.int, m = cython.int, k = cython.int, lda = cython.int, ldb = cython.int, ldc = cython.int)
+ *   cython.declare(n=cython.int, m=cython.int, k=cython.int, lda=cython.int, ldb=cython.int, ldc=cython.int)
  */
 struct __pyx_opt_args_11statmoments_7_native_dgemm {
   int __pyx_n;
   char transa;
   char transb;
   double alpha;
   double beta;
 };
 struct __pyx_defaults {
   PyObject *__pyx_arg_acc_dtype;
 };
 
-/* "statmoments/_native.pyx":355
- *     return (lytsz + accssz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
+/* "statmoments/_native.pyx":378
+ *     return (lytsz + accssz + bufsz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
- *     mem_ttest = 0  # included in mem_class
+ *     # ttest memory included in mem_class or std normalization computed one line at a time
  */
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct__memory_size {
   PyObject_HEAD
   PyObject *__pyx_v_self;
 };
 
 
-/* "statmoments/_native.pyx":356
+/* "statmoments/_native.pyx":379
  * 
  *   def memory_size(self):
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))             # <<<<<<<<<<<<<<
- *     mem_ttest = 0  # included in mem_class
- *     return mem_class + mem_ttest * 8
+ *     # ttest memory included in mem_class or std normalization computed one line at a time
+ *     mem_ttest = 0  if self.moment < 3 else self.trace_len
  */
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_1_genexpr {
   PyObject_HEAD
   struct __pyx_obj_11statmoments_7_native___pyx_scope_struct__memory_size *__pyx_outer_scope;
   PyObject *__pyx_v_v;
   PyObject *__pyx_t_0;
   Py_ssize_t __pyx_t_1;
   Py_ssize_t __pyx_t_2;
   int __pyx_t_3;
 };
 
 
-/* "statmoments/_native.pyx":406
+/* "statmoments/_native.pyx":430
  *     return acc0[0, 0], acc1[0, 0]
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     maxm = np.max(moments)
  *     if self.moment * 2 < maxm:
  */
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_2__moments {
   PyObject_HEAD
   long __pyx_v__i;
+  PyObject *__pyx_v_acc;
   PyObject *__pyx_v_acc0;
   PyObject *__pyx_v_acc1;
   PyObject *__pyx_v_buf;
   PyObject *__pyx_v_cl_len;
   PyObject *__pyx_v_cm;
   PyObject *__pyx_v_cmi;
   PyObject *__pyx_v_i;
   PyObject *__pyx_v_ii;
   PyObject *__pyx_8genexpr1__pyx_v_m;
   PyObject *__pyx_v_ma;
   PyObject *__pyx_v_maxm;
+  PyObject *__pyx_v_min_cnt;
   PyObject *__pyx_v_moments;
   PyObject *__pyx_v_n0;
   PyObject *__pyx_v_n1;
+  PyObject *__pyx_v_nn;
   PyObject *__pyx_v_normalize;
+  PyObject *__pyx_v_raw;
   PyObject *__pyx_v_raw0;
   PyObject *__pyx_v_raw1;
   PyObject *__pyx_v_sd;
   PyObject *__pyx_v_self;
   PyObject *__pyx_v_tr_len;
   Py_ssize_t __pyx_t_0;
   PyObject *(*__pyx_t_1)(PyObject *);
   PyObject *__pyx_t_2;
 };
 
 
-/* "statmoments/_native.pyx":452
+/* "statmoments/_native.pyx":481
  *       yield cm[:, moments]
  * 
  *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     retm = self._retm
  *     tr_len, cl_len = self.trace_len, self._accs.shape[0]
  */
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_3__comoments {
@@ -1353,16 +1357,14 @@
   PyObject *__pyx_v_i;
   PyObject *__pyx_v_ii;
   PyObject *__pyx_v_j;
   PyObject *__pyx_v_jj;
   PyObject *__pyx_v_k;
   PyObject *__pyx_v_lm;
   PyObject *__pyx_v_m1;
-  PyObject *__pyx_v_m10;
-  PyObject *__pyx_v_m11;
   PyObject *__pyx_v_m2;
   PyObject *__pyx_v_ma;
   PyObject *__pyx_v_min_cnt;
   PyObject *__pyx_v_moments;
   PyObject *__pyx_v_n0;
   PyObject *__pyx_v_n1;
   PyObject *__pyx_v_nn;
@@ -1377,117 +1379,119 @@
   PyObject *__pyx_v_tr_len;
   PyObject *__pyx_t_0;
   Py_ssize_t __pyx_t_1;
   PyObject *(*__pyx_t_2)(PyObject *);
 };
 
 
-/* "statmoments/_native.pyx":532
- *     super().update(tr_copy-self._dbuf, cl_copy)
+/* "statmoments/_native.pyx":558
+ *     super().update(tr_copy - self._dbuf, cl_copy)
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     m1idx = [i for i, m in enumerate(moments) if m == 1]
  *     has_m1 = len(m1idx) != 0
  */
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_4__moments {
   PyObject_HEAD
+  PyObject *__pyx_v_dbuf;
   PyObject *__pyx_v_has_m1;
   PyObject *__pyx_8genexpr2__pyx_v_i;
   PyObject *__pyx_8genexpr2__pyx_v_m;
   PyObject *__pyx_v_m1idx;
   PyObject *__pyx_v_moments;
   PyObject *__pyx_v_normalize;
   PyObject *__pyx_v_res;
   PyObject *__pyx_v_self;
   PyObject *__pyx_t_0;
   Py_ssize_t __pyx_t_1;
   PyObject *(*__pyx_t_2)(PyObject *);
 };
 
 
-/* "statmoments/_native.pyx":542
+/* "statmoments/_native.pyx":569
  * 
  * 
  * def _triuflatten_gen(n):             # <<<<<<<<<<<<<<
  *   _ndx = np.triu_indices_from(np.empty((n, n)))
  *   def _triu(tr2d):
  */
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_5__triuflatten_gen {
   PyObject_HEAD
   PyObject *__pyx_v__ndx;
 };
 
 
-/* "statmoments/_native.pyx":635
- *     return mem_class * classifier_len * 8
+/* "statmoments/_native.pyx":670
+ *     return (lytsz + accs1dsz + accs2dsz) * np.finfo(acc_dtype).bits // 8 + (ttsz + ttstdsz) * 8 + clssz * 4
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
- *     mem_ttest = self._accs1d.shape[2] ** 2 // 2 * 4
+ *     # ttest memory included in mem_class or one additional square for std normalization
  */
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_6_memory_size {
   PyObject_HEAD
   PyObject *__pyx_v_self;
 };
 
 
-/* "statmoments/_native.pyx":636
+/* "statmoments/_native.pyx":671
  * 
  *   def memory_size(self):
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))             # <<<<<<<<<<<<<<
- *     mem_ttest = self._accs1d.shape[2] ** 2 // 2 * 4
- *     return mem_class + mem_ttest * 8
+ *     # ttest memory included in mem_class or one additional square for std normalization
+ *     mem_ttest = 0  if self.moment < 3 else self.trace_len + self.trace_len ** 2
  */
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_7_genexpr {
   PyObject_HEAD
   struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_6_memory_size *__pyx_outer_scope;
   PyObject *__pyx_v_v;
   PyObject *__pyx_t_0;
   Py_ssize_t __pyx_t_1;
   Py_ssize_t __pyx_t_2;
   int __pyx_t_3;
 };
 
 
-/* "statmoments/_native.pyx":683
+/* "statmoments/_native.pyx":721
  *     return self._cls_count[i]
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
- *     maxm = np.max(moments)
+ *     maxm, min_cnt = np.max(moments), self.acc_min_count
  *     if self.moment * 2 < maxm:
  */
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_8__moments {
   PyObject_HEAD
   long __pyx_v__i;
   PyObject *__pyx_v_cl_len;
   PyObject *__pyx_v_cm;
   PyObject *__pyx_v_ii;
   PyObject *__pyx_v_jj;
   PyObject *__pyx_8genexpr4__pyx_v_m;
   PyObject *__pyx_v_m;
   PyObject *__pyx_v_maxm;
+  PyObject *__pyx_v_min_cnt;
   PyObject *__pyx_v_moments;
   PyObject *__pyx_v_nn;
   PyObject *__pyx_v_normalize;
   PyObject *__pyx_v_retm;
   PyObject *__pyx_v_sd;
   PyObject *__pyx_v_self;
   PyObject *__pyx_v_tr_len;
   PyObject *__pyx_t_0;
   Py_ssize_t __pyx_t_1;
   PyObject *(*__pyx_t_2)(PyObject *);
 };
 
 
-/* "statmoments/_native.pyx":711
+/* "statmoments/_native.pyx":754
  *       yield retm
  * 
  *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
- * #    self._retm[:] = 0  # TODO: Check if needed
  *     retm = self._retm
+ *     tr_len, min_cnt = self.trace_len, self.acc_min_count
  */
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_9__comoments {
   PyObject_HEAD
   PyObject *__pyx_v_C;
   PyObject *__pyx_v_accs2d;
   PyObject *__pyx_v_accs_count;
   PyObject *__pyx_v_jj;
@@ -1504,150 +1508,163 @@
   PyObject *__pyx_v_triuflatten;
   PyObject *__pyx_t_0;
   Py_ssize_t __pyx_t_1;
   PyObject *(*__pyx_t_2)(PyObject *);
 };
 
 
-/* "statmoments/_native.pyx":791
+/* "statmoments/_native.pyx":839
+ *     return mem_class * 8
  * 
- *   def memory_size(self):
- *     def _sz_helper(inst):             # <<<<<<<<<<<<<<
- *       return sum(v.nbytes for v in inst if isinstance(v, np.ndarray))
- *     mem_class =  sum(map(_sz_helper, [vars(self).values()]))
+ *   def memory_size(self):             # <<<<<<<<<<<<<<
+ *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
+ *     return mem_class
  */
-struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10__sz_helper {
+struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10_memory_size {
   PyObject_HEAD
-  PyObject *__pyx_v_inst;
+  PyObject *__pyx_v_self;
 };
 
 
-/* "statmoments/_native.pyx":792
+/* "statmoments/_native.pyx":840
+ * 
  *   def memory_size(self):
- *     def _sz_helper(inst):
- *       return sum(v.nbytes for v in inst if isinstance(v, np.ndarray))             # <<<<<<<<<<<<<<
- *     mem_class =  sum(map(_sz_helper, [vars(self).values()]))
- *     mem_ttest = 0  # included in mem_class
+ *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))             # <<<<<<<<<<<<<<
+ *     return mem_class
+ * 
  */
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_11_genexpr {
   PyObject_HEAD
-  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10__sz_helper *__pyx_outer_scope;
+  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10_memory_size *__pyx_outer_scope;
   PyObject *__pyx_v_v;
   PyObject *__pyx_t_0;
   Py_ssize_t __pyx_t_1;
-  PyObject *(*__pyx_t_2)(PyObject *);
+  Py_ssize_t __pyx_t_2;
+  int __pyx_t_3;
 };
 
 
-/* "statmoments/_native.pyx":809
+/* "statmoments/_native.pyx":855
  *     return self.total_count - c1, c1
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
+ *     min_cnt = self.acc_min_count
  *     tr_len, cl_len = self.trace_len, self.classifiers_len
- * 
  */
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_12__moments {
   PyObject_HEAD
   long __pyx_v__i;
   PyObject *__pyx_v_cl_len;
   PyObject *__pyx_v_cls0;
   PyObject *__pyx_v_cm;
   PyObject *__pyx_v_ii;
   PyObject *__pyx_v_jj;
   PyObject *__pyx_v_m;
+  PyObject *__pyx_v_min_cnt;
   PyObject *__pyx_v_moments;
-  PyObject *__pyx_v_n;
+  PyObject *__pyx_v_n0;
+  PyObject *__pyx_v_n1;
+  PyObject *__pyx_v_nn;
   PyObject *__pyx_v_normalize;
+  PyObject *__pyx_v_raw;
   PyObject *__pyx_v_retm;
   PyObject *__pyx_v_sd;
   PyObject *__pyx_v_self;
   PyObject *__pyx_v_tr_len;
   PyObject *__pyx_v_tr_set;
-  PyObject *__pyx_v_tr_set_mean;
   PyObject *__pyx_v_traces_cl;
+  PyObject *__pyx_8genexpr6__pyx_v_ts;
   Py_ssize_t __pyx_t_0;
   PyObject *__pyx_t_1;
   PyObject *(*__pyx_t_2)(PyObject *);
 };
 
 
-/* "statmoments/_native.pyx":839
+/* "statmoments/_native.pyx":906
+ *     return mem_base + mem_ttstd * 8
  * 
- * class bivar_2pass(_BivarNpassBase):
  *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
- *     C = self._tmpsq
- *     tr_len, cl_len = self.trace_len, self.cls.shape[1]
+ *     min_cnt, C = self.acc_min_count, self._tmpsq
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len
  */
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_13__comoments {
   PyObject_HEAD
   PyObject *__pyx_v_C;
   long __pyx_v__i;
   PyObject *__pyx_v_cl_len;
   PyObject *__pyx_v_ii;
   PyObject *__pyx_v_jj;
   PyObject *__pyx_v_lm;
   PyObject *__pyx_v_m;
   PyObject *__pyx_v_mft;
+  PyObject *__pyx_v_min_cnt;
   PyObject *__pyx_v_moments;
   PyObject *__pyx_v_n;
   PyObject *__pyx_v_normalize;
   PyObject *__pyx_v_retm;
   PyObject *__pyx_v_rm;
   PyObject *__pyx_v_sd;
   PyObject *__pyx_v_self;
   PyObject *__pyx_v_tr_len;
   PyObject *__pyx_v_triuflatten;
+  PyObject *__pyx_t_0;
+  Py_ssize_t __pyx_t_1;
+  PyObject *(*__pyx_t_2)(PyObject *);
 };
 
 
-/* "statmoments/_native.pyx":875
+/* "statmoments/_native.pyx":961
  *     return self._tri[:m]
  * 
  *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
- *     C = self._tmpsq
- *     tr_len, cl_len = self.trace_len, self.cls.shape[1]
+ *     min_cnt, C = self.acc_min_count, self._tmpsq
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len
  */
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_14__comoments {
   PyObject_HEAD
   PyObject *__pyx_v_C;
   long __pyx_v__i;
   PyObject *__pyx_v_cl_len;
   PyObject *__pyx_v_cl_set;
   PyObject *__pyx_v_ii;
   PyObject *__pyx_v_jj;
   PyObject *__pyx_v_lm;
   PyObject *__pyx_v_m;
   PyObject *__pyx_v_mft;
+  PyObject *__pyx_v_min_cnt;
   PyObject *__pyx_v_moments;
   PyObject *__pyx_v_n;
   PyObject *__pyx_v_normalize;
   PyObject *__pyx_v_retm;
   PyObject *__pyx_v_rm;
   PyObject *__pyx_v_sd;
   PyObject *__pyx_v_self;
   PyObject *__pyx_v_tr_len;
   PyObject *__pyx_v_tri;
   PyObject *__pyx_v_triuflatten;
+  PyObject *__pyx_t_0;
+  Py_ssize_t __pyx_t_1;
+  PyObject *(*__pyx_t_2)(PyObject *);
 };
 
 
-/* "statmoments/_native.pyx":934
+/* "statmoments/_native.pyx":1014
  * 
  *   def memory_size(self):
  *     def _ms_helper(instl):             # <<<<<<<<<<<<<<
  *       return sum(i.GetActualMemorySize() for i in instl)
  * 
  */
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_15__ms_helper {
   PyObject_HEAD
   PyObject *__pyx_v_instl;
 };
 
 
-/* "statmoments/_native.pyx":935
+/* "statmoments/_native.pyx":1015
  *   def memory_size(self):
  *     def _ms_helper(instl):
  *       return sum(i.GetActualMemorySize() for i in instl)             # <<<<<<<<<<<<<<
  * 
  *     intbl0  = [mcs.GetInputDataObject(0, 0) for mcss in self._stats for mcs in mcss]
  */
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_16_genexpr {
@@ -1656,79 +1673,89 @@
   PyObject *__pyx_v_i;
   PyObject *__pyx_t_0;
   Py_ssize_t __pyx_t_1;
   PyObject *(*__pyx_t_2)(PyObject *);
 };
 
 
-/* "statmoments/_native.pyx":974
+/* "statmoments/_native.pyx":1056
  *     return self._counts[i]
  * 
- *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
- *     m = moments[0]
- *     if self.moment < np.max(m):
+ *   def moments(self, moments, normalize):             # <<<<<<<<<<<<<<
+ *     maxm = np.max(moments)
+ *     if self.moment * 2 < maxm:
  */
-struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17__moments {
+struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17_moments {
   PyObject_HEAD
-  PyObject *__pyx_v_avg;
-  PyObject *__pyx_v_avgs;
+  PyObject *__pyx_v__i;
+  PyObject *__pyx_v_cm;
   PyObject *__pyx_v_dd;
+  PyObject *__pyx_v_ii;
+  PyObject *__pyx_v_jj;
+  PyObject *__pyx_v_k;
   PyObject *__pyx_v_m;
+  PyObject *__pyx_v_maxm;
   PyObject *__pyx_v_mcs;
   PyObject *__pyx_v_mcss;
   PyObject *__pyx_v_min_cnt;
   PyObject *__pyx_v_moments;
   PyObject *__pyx_v_n;
+  PyObject *__pyx_v_nn;
   PyObject *__pyx_v_normalize;
+  PyObject *__pyx_v_retm;
   PyObject *__pyx_v_self;
   PyObject *__pyx_v_tr_len;
   PyObject *__pyx_v_triuflatten;
 };
 
 
-/* "statmoments/_native.pyx":994
- *     yield (avgs[0], avgs[0]), (avgs[1], avgs[1])
+/* "statmoments/_native.pyx":1085
+ *     yield retm[:, :len(moments)]
  * 
- *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
+ *   def comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     tr_len, min_cnt = self.trace_len, self.acc_min_count
  *     triuflatten = _triuflatten_gen(tr_len)
  */
-struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18__comoments {
+struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18_comoments {
   PyObject_HEAD
+  PyObject *__pyx_v__i;
   PyObject *__pyx_v_cov_arr;
-  PyObject *__pyx_v_covs;
   PyObject *__pyx_v_dd;
+  PyObject *__pyx_v_ii;
+  PyObject *__pyx_v_jj;
   PyObject *__pyx_v_k;
   PyObject *__pyx_v_m;
   PyObject *__pyx_v_mcs;
   PyObject *__pyx_v_mcss;
   PyObject *__pyx_v_min_cnt;
   PyObject *__pyx_v_moments;
   PyObject *__pyx_v_n;
+  PyObject *__pyx_v_nn;
   PyObject *__pyx_v_normalize;
+  PyObject *__pyx_v_retm;
   PyObject *__pyx_v_self;
   PyObject *__pyx_v_tr_len;
   PyObject *__pyx_v_triuflatten;
 };
 
 
-/* "statmoments/_native.pyx":1051
- *     return ((classifier_len+1)*moment*trace_len + 2*moment*trace_len + 3 * trace_len) * 8
+/* "statmoments/_native.pyx":1149
+ *     return (lytsz + accssz + bufsz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
  *     mem_ttest = 0  # included in mem_class
  */
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_19_memory_size {
   PyObject_HEAD
   PyObject *__pyx_v_self;
 };
 
 
-/* "statmoments/_native.pyx":1052
+/* "statmoments/_native.pyx":1150
  * 
  *   def memory_size(self):
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))             # <<<<<<<<<<<<<<
  *     mem_ttest = 0  # included in mem_class
  *     return mem_class + mem_ttest * 8
  */
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_20_genexpr {
@@ -1738,15 +1765,15 @@
   PyObject *__pyx_t_0;
   Py_ssize_t __pyx_t_1;
   Py_ssize_t __pyx_t_2;
   int __pyx_t_3;
 };
 
 
-/* "statmoments/_native.pyx":1060
+/* "statmoments/_native.pyx":1158
  *     return self._accs[0, 0] - c1, c1
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     maxm = np.max(moments)
  *     if 2 * self.moment < maxm:
  */
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_21__moments {
@@ -1754,41 +1781,42 @@
   long __pyx_v__i;
   PyObject *__pyx_v_acc1;
   PyObject *__pyx_v_accT;
   PyObject *__pyx_v_buf;
   PyObject *__pyx_v_cm;
   PyObject *__pyx_v_cmi;
   PyObject *__pyx_v_i;
-  PyObject *__pyx_9genexpr14__pyx_v_m;
+  PyObject *__pyx_9genexpr15__pyx_v_m;
   PyObject *__pyx_v_maxm;
   PyObject *__pyx_v_moments;
   PyObject *__pyx_v_n1;
   PyObject *__pyx_v_nT;
   PyObject *__pyx_v_nn;
   PyObject *__pyx_v_normalize;
   PyObject *__pyx_v_sd;
   PyObject *__pyx_v_self;
   PyObject *__pyx_t_0;
   Py_ssize_t __pyx_t_1;
   PyObject *(*__pyx_t_2)(PyObject *);
 };
 
 
-/* "statmoments/_native.pyx":1149
- *     super().update(tr_copy-self._dbuf, cl_copy)
+/* "statmoments/_native.pyx":1248
+ *     super().update(tr_copy - self._dbuf, cl_copy)
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     m1idx = [i for i, m in enumerate(moments) if m == 1]
  *     has_m1 = len(m1idx) != 0
  */
 struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_22__moments {
   PyObject_HEAD
+  PyObject *__pyx_v_dbuf_nonempty;
   PyObject *__pyx_v_has_m1;
-  PyObject *__pyx_9genexpr15__pyx_v_i;
-  PyObject *__pyx_9genexpr15__pyx_v_m;
+  PyObject *__pyx_9genexpr16__pyx_v_i;
+  PyObject *__pyx_9genexpr16__pyx_v_m;
   PyObject *__pyx_v_m1idx;
   PyObject *__pyx_v_moments;
   PyObject *__pyx_v_normalize;
   PyObject *__pyx_v_res;
   PyObject *__pyx_v_self;
   PyObject *__pyx_t_0;
   Py_ssize_t __pyx_t_1;
@@ -1991,14 +2019,89 @@
 #else
 #define __Pyx_PyObject_GetAttrStr(o,n) PyObject_GetAttr(o,n)
 #endif
 
 /* GetBuiltinName.proto */
 static PyObject *__Pyx_GetBuiltinName(PyObject *name);
 
+/* Import.proto */
+static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level);
+
+/* PyObjectCall.proto */
+#if CYTHON_COMPILING_IN_CPYTHON
+static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
+#else
+#define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
+#endif
+
+/* GetTopmostException.proto */
+#if CYTHON_USE_EXC_INFO_STACK
+static _PyErr_StackItem * __Pyx_PyErr_GetTopmostException(PyThreadState *tstate);
+#endif
+
+/* PyThreadStateGet.proto */
+#if CYTHON_FAST_THREAD_STATE
+#define __Pyx_PyThreadState_declare  PyThreadState *__pyx_tstate;
+#define __Pyx_PyThreadState_assign  __pyx_tstate = __Pyx_PyThreadState_Current;
+#define __Pyx_PyErr_Occurred()  __pyx_tstate->curexc_type
+#else
+#define __Pyx_PyThreadState_declare
+#define __Pyx_PyThreadState_assign
+#define __Pyx_PyErr_Occurred()  PyErr_Occurred()
+#endif
+
+/* SaveResetException.proto */
+#if CYTHON_FAST_THREAD_STATE
+#define __Pyx_ExceptionSave(type, value, tb)  __Pyx__ExceptionSave(__pyx_tstate, type, value, tb)
+static CYTHON_INLINE void __Pyx__ExceptionSave(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
+#define __Pyx_ExceptionReset(type, value, tb)  __Pyx__ExceptionReset(__pyx_tstate, type, value, tb)
+static CYTHON_INLINE void __Pyx__ExceptionReset(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb);
+#else
+#define __Pyx_ExceptionSave(type, value, tb)   PyErr_GetExcInfo(type, value, tb)
+#define __Pyx_ExceptionReset(type, value, tb)  PyErr_SetExcInfo(type, value, tb)
+#endif
+
+/* PyErrFetchRestore.proto */
+#if CYTHON_FAST_THREAD_STATE
+#define __Pyx_PyErr_Clear() __Pyx_ErrRestore(NULL, NULL, NULL)
+#define __Pyx_ErrRestoreWithState(type, value, tb)  __Pyx_ErrRestoreInState(PyThreadState_GET(), type, value, tb)
+#define __Pyx_ErrFetchWithState(type, value, tb)    __Pyx_ErrFetchInState(PyThreadState_GET(), type, value, tb)
+#define __Pyx_ErrRestore(type, value, tb)  __Pyx_ErrRestoreInState(__pyx_tstate, type, value, tb)
+#define __Pyx_ErrFetch(type, value, tb)    __Pyx_ErrFetchInState(__pyx_tstate, type, value, tb)
+static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb);
+static CYTHON_INLINE void __Pyx_ErrFetchInState(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
+#if CYTHON_COMPILING_IN_CPYTHON
+#define __Pyx_PyErr_SetNone(exc) (Py_INCREF(exc), __Pyx_ErrRestore((exc), NULL, NULL))
+#else
+#define __Pyx_PyErr_SetNone(exc) PyErr_SetNone(exc)
+#endif
+#else
+#define __Pyx_PyErr_Clear() PyErr_Clear()
+#define __Pyx_PyErr_SetNone(exc) PyErr_SetNone(exc)
+#define __Pyx_ErrRestoreWithState(type, value, tb)  PyErr_Restore(type, value, tb)
+#define __Pyx_ErrFetchWithState(type, value, tb)  PyErr_Fetch(type, value, tb)
+#define __Pyx_ErrRestoreInState(tstate, type, value, tb)  PyErr_Restore(type, value, tb)
+#define __Pyx_ErrFetchInState(tstate, type, value, tb)  PyErr_Fetch(type, value, tb)
+#define __Pyx_ErrRestore(type, value, tb)  PyErr_Restore(type, value, tb)
+#define __Pyx_ErrFetch(type, value, tb)  PyErr_Fetch(type, value, tb)
+#endif
+
+/* FastTypeChecks.proto */
+#if CYTHON_COMPILING_IN_CPYTHON
+#define __Pyx_TypeCheck(obj, type) __Pyx_IsSubtype(Py_TYPE(obj), (PyTypeObject *)type)
+static CYTHON_INLINE int __Pyx_IsSubtype(PyTypeObject *a, PyTypeObject *b);
+static CYTHON_INLINE int __Pyx_PyErr_GivenExceptionMatches(PyObject *err, PyObject *type);
+static CYTHON_INLINE int __Pyx_PyErr_GivenExceptionMatches2(PyObject *err, PyObject *type1, PyObject *type2);
+#else
+#define __Pyx_TypeCheck(obj, type) PyObject_TypeCheck(obj, (PyTypeObject *)type)
+#define __Pyx_PyErr_GivenExceptionMatches(err, type) PyErr_GivenExceptionMatches(err, type)
+#define __Pyx_PyErr_GivenExceptionMatches2(err, type1, type2) (PyErr_GivenExceptionMatches(err, type1) || PyErr_GivenExceptionMatches(err, type2))
+#endif
+#define __Pyx_PyException_Check(obj) __Pyx_TypeCheck(obj, PyExc_Exception)
+
 /* PyDictVersioning.proto */
 #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_TYPE_SLOTS
 #define __PYX_DICT_VERSION_INIT  ((PY_UINT64_T) -1)
 #define __PYX_GET_DICT_VERSION(dict)  (((PyDictObject*)(dict))->ma_version_tag)
 #define __PYX_UPDATE_DICT_CACHE(dict, value, cache_var, version_var)\
     (version_var) = __PYX_GET_DICT_VERSION(dict);\
     (cache_var) = (value);
@@ -2038,14 +2141,22 @@
 static PyObject *__Pyx__GetModuleGlobalName(PyObject *name, PY_UINT64_T *dict_version, PyObject **dict_cached_value);
 #else
 #define __Pyx_GetModuleGlobalName(var, name)  (var) = __Pyx__GetModuleGlobalName(name)
 #define __Pyx_GetModuleGlobalNameUncached(var, name)  (var) = __Pyx__GetModuleGlobalName(name)
 static CYTHON_INLINE PyObject *__Pyx__GetModuleGlobalName(PyObject *name);
 #endif
 
+/* GetException.proto */
+#if CYTHON_FAST_THREAD_STATE
+#define __Pyx_GetException(type, value, tb)  __Pyx__GetException(__pyx_tstate, type, value, tb)
+static int __Pyx__GetException(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
+#else
+static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb);
+#endif
+
 /* PyFunctionFastCall.proto */
 #if CYTHON_FAST_PYCALL
 #define __Pyx_PyFunction_FastCall(func, args, nargs)\
     __Pyx_PyFunction_FastCallDict((func), (args), (nargs), NULL)
 #if 1 || PY_VERSION_HEX < 0x030600B1
 static PyObject *__Pyx_PyFunction_FastCallDict(PyObject *func, PyObject **args, Py_ssize_t nargs, PyObject *kwargs);
 #else
@@ -2076,57 +2187,14 @@
 /* PyCFunctionFastCall.proto */
 #if CYTHON_FAST_PYCCALL
 static CYTHON_INLINE PyObject *__Pyx_PyCFunction_FastCall(PyObject *func, PyObject **args, Py_ssize_t nargs);
 #else
 #define __Pyx_PyCFunction_FastCall(func, args, nargs)  (assert(0), NULL)
 #endif
 
-/* PyObjectCall.proto */
-#if CYTHON_COMPILING_IN_CPYTHON
-static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
-#else
-#define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
-#endif
-
-/* PyThreadStateGet.proto */
-#if CYTHON_FAST_THREAD_STATE
-#define __Pyx_PyThreadState_declare  PyThreadState *__pyx_tstate;
-#define __Pyx_PyThreadState_assign  __pyx_tstate = __Pyx_PyThreadState_Current;
-#define __Pyx_PyErr_Occurred()  __pyx_tstate->curexc_type
-#else
-#define __Pyx_PyThreadState_declare
-#define __Pyx_PyThreadState_assign
-#define __Pyx_PyErr_Occurred()  PyErr_Occurred()
-#endif
-
-/* PyErrFetchRestore.proto */
-#if CYTHON_FAST_THREAD_STATE
-#define __Pyx_PyErr_Clear() __Pyx_ErrRestore(NULL, NULL, NULL)
-#define __Pyx_ErrRestoreWithState(type, value, tb)  __Pyx_ErrRestoreInState(PyThreadState_GET(), type, value, tb)
-#define __Pyx_ErrFetchWithState(type, value, tb)    __Pyx_ErrFetchInState(PyThreadState_GET(), type, value, tb)
-#define __Pyx_ErrRestore(type, value, tb)  __Pyx_ErrRestoreInState(__pyx_tstate, type, value, tb)
-#define __Pyx_ErrFetch(type, value, tb)    __Pyx_ErrFetchInState(__pyx_tstate, type, value, tb)
-static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb);
-static CYTHON_INLINE void __Pyx_ErrFetchInState(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
-#if CYTHON_COMPILING_IN_CPYTHON
-#define __Pyx_PyErr_SetNone(exc) (Py_INCREF(exc), __Pyx_ErrRestore((exc), NULL, NULL))
-#else
-#define __Pyx_PyErr_SetNone(exc) PyErr_SetNone(exc)
-#endif
-#else
-#define __Pyx_PyErr_Clear() PyErr_Clear()
-#define __Pyx_PyErr_SetNone(exc) PyErr_SetNone(exc)
-#define __Pyx_ErrRestoreWithState(type, value, tb)  PyErr_Restore(type, value, tb)
-#define __Pyx_ErrFetchWithState(type, value, tb)  PyErr_Fetch(type, value, tb)
-#define __Pyx_ErrRestoreInState(tstate, type, value, tb)  PyErr_Restore(type, value, tb)
-#define __Pyx_ErrFetchInState(tstate, type, value, tb)  PyErr_Fetch(type, value, tb)
-#define __Pyx_ErrRestore(type, value, tb)  PyErr_Restore(type, value, tb)
-#define __Pyx_ErrFetch(type, value, tb)  PyErr_Fetch(type, value, tb)
-#endif
-
 /* WriteUnraisableException.proto */
 static void __Pyx_WriteUnraisable(const char *name, int clineno,
                                   int lineno, const char *filename,
                                   int full_traceback, int nogil);
 
 /* MemviewSliceInit.proto */
 #define __Pyx_BUF_MAX_NDIMS %(BUF_MAX_NDIMS)d
@@ -2550,62 +2618,22 @@
 
 /* GetAttr3.proto */
 static CYTHON_INLINE PyObject *__Pyx_GetAttr3(PyObject *, PyObject *, PyObject *);
 
 /* ExtTypeTest.proto */
 static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type);
 
-/* GetTopmostException.proto */
-#if CYTHON_USE_EXC_INFO_STACK
-static _PyErr_StackItem * __Pyx_PyErr_GetTopmostException(PyThreadState *tstate);
-#endif
-
-/* SaveResetException.proto */
-#if CYTHON_FAST_THREAD_STATE
-#define __Pyx_ExceptionSave(type, value, tb)  __Pyx__ExceptionSave(__pyx_tstate, type, value, tb)
-static CYTHON_INLINE void __Pyx__ExceptionSave(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
-#define __Pyx_ExceptionReset(type, value, tb)  __Pyx__ExceptionReset(__pyx_tstate, type, value, tb)
-static CYTHON_INLINE void __Pyx__ExceptionReset(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb);
-#else
-#define __Pyx_ExceptionSave(type, value, tb)   PyErr_GetExcInfo(type, value, tb)
-#define __Pyx_ExceptionReset(type, value, tb)  PyErr_SetExcInfo(type, value, tb)
-#endif
-
-/* GetException.proto */
-#if CYTHON_FAST_THREAD_STATE
-#define __Pyx_GetException(type, value, tb)  __Pyx__GetException(__pyx_tstate, type, value, tb)
-static int __Pyx__GetException(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
-#else
-static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb);
-#endif
-
 /* SwapException.proto */
 #if CYTHON_FAST_THREAD_STATE
 #define __Pyx_ExceptionSwap(type, value, tb)  __Pyx__ExceptionSwap(__pyx_tstate, type, value, tb)
 static CYTHON_INLINE void __Pyx__ExceptionSwap(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
 #else
 static CYTHON_INLINE void __Pyx_ExceptionSwap(PyObject **type, PyObject **value, PyObject **tb);
 #endif
 
-/* Import.proto */
-static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level);
-
-/* FastTypeChecks.proto */
-#if CYTHON_COMPILING_IN_CPYTHON
-#define __Pyx_TypeCheck(obj, type) __Pyx_IsSubtype(Py_TYPE(obj), (PyTypeObject *)type)
-static CYTHON_INLINE int __Pyx_IsSubtype(PyTypeObject *a, PyTypeObject *b);
-static CYTHON_INLINE int __Pyx_PyErr_GivenExceptionMatches(PyObject *err, PyObject *type);
-static CYTHON_INLINE int __Pyx_PyErr_GivenExceptionMatches2(PyObject *err, PyObject *type1, PyObject *type2);
-#else
-#define __Pyx_TypeCheck(obj, type) PyObject_TypeCheck(obj, (PyTypeObject *)type)
-#define __Pyx_PyErr_GivenExceptionMatches(err, type) PyErr_GivenExceptionMatches(err, type)
-#define __Pyx_PyErr_GivenExceptionMatches2(err, type1, type2) (PyErr_GivenExceptionMatches(err, type1) || PyErr_GivenExceptionMatches(err, type2))
-#endif
-#define __Pyx_PyException_Check(obj) __Pyx_TypeCheck(obj, PyExc_Exception)
-
 static CYTHON_UNUSED int __pyx_memoryview_getbuffer(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /*proto*/
 /* ListExtend.proto */
 static CYTHON_INLINE int __Pyx_PyList_Extend(PyObject* L, PyObject* v) {
 #if CYTHON_COMPILING_IN_CPYTHON
     PyObject* none = _PyList_Extend((PyListObject*)L, v);
     if (unlikely(!none))
         return -1;
@@ -3028,23 +3056,23 @@
 static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_3__comoments = 0;
 static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_4__moments = 0;
 static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_5__triuflatten_gen = 0;
 static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_6_memory_size = 0;
 static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_7_genexpr = 0;
 static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_8__moments = 0;
 static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_9__comoments = 0;
-static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_10__sz_helper = 0;
+static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_10_memory_size = 0;
 static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_11_genexpr = 0;
 static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_12__moments = 0;
 static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_13__comoments = 0;
 static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_14__comoments = 0;
 static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_15__ms_helper = 0;
 static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_16_genexpr = 0;
-static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_17__moments = 0;
-static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_18__comoments = 0;
+static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_17_moments = 0;
+static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_18_comoments = 0;
 static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_19_memory_size = 0;
 static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_20_genexpr = 0;
 static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_21__moments = 0;
 static PyTypeObject *__pyx_ptype_11statmoments_7_native___pyx_scope_struct_22__moments = 0;
 static PyTypeObject *__pyx_array_type = 0;
 static PyTypeObject *__pyx_MemviewEnum_type = 0;
 static PyTypeObject *__pyx_memoryview_type = 0;
@@ -3111,22 +3139,24 @@
 extern int __pyx_module_is_main_statmoments___native;
 int __pyx_module_is_main_statmoments___native = 0;
 
 /* Implementation of 'statmoments._native' */
 static PyObject *__pyx_builtin_object;
 static PyObject *__pyx_builtin_staticmethod;
 static PyObject *__pyx_builtin_property;
+static PyObject *__pyx_builtin_print;
 static PyObject *__pyx_builtin_NotImplementedError;
 static PyObject *__pyx_builtin_ValueError;
 static PyObject *__pyx_builtin_range;
 static PyObject *__pyx_builtin_super;
 static PyObject *__pyx_builtin_sum;
 static PyObject *__pyx_builtin_vars;
 static PyObject *__pyx_builtin_enumerate;
 static PyObject *__pyx_builtin_zip;
+static PyObject *__pyx_builtin_min;
 static PyObject *__pyx_builtin_map;
 static PyObject *__pyx_builtin_MemoryError;
 static PyObject *__pyx_builtin_TypeError;
 static PyObject *__pyx_builtin_Ellipsis;
 static PyObject *__pyx_builtin_id;
 static PyObject *__pyx_builtin_IndexError;
 static const char __pyx_k_2[] = "2";
@@ -3163,34 +3193,35 @@
 static const char __pyx_k_n2[] = "n2";
 static const char __pyx_k_nT[] = "nT";
 static const char __pyx_k_nn[] = "nn";
 static const char __pyx_k_np[] = "np";
 static const char __pyx_k_rm[] = "rm";
 static const char __pyx_k_sd[] = "sd";
 static const char __pyx_k_tr[] = "tr";
+static const char __pyx_k_ts[] = "ts";
 static const char __pyx_k_Mpq[] = "Mpq";
-static const char __pyx_k__63[] = "*";
+static const char __pyx_k__62[] = "*";
 static const char __pyx_k_acc[] = "acc";
 static const char __pyx_k_arr[] = "arr";
 static const char __pyx_k_ave[] = "ave";
-static const char __pyx_k_avg[] = "avg";
 static const char __pyx_k_buf[] = "_buf";
 static const char __pyx_k_cls[] = "cls";
 static const char __pyx_k_cmi[] = "cmi";
 static const char __pyx_k_com[] = "com";
 static const char __pyx_k_doc[] = "__doc__";
 static const char __pyx_k_i_2[] = "_i";
 static const char __pyx_k_m10[] = "m10";
 static const char __pyx_k_m11[] = "m11";
 static const char __pyx_k_m20[] = "m20";
 static const char __pyx_k_m21[] = "m21";
 static const char __pyx_k_map[] = "map";
 static const char __pyx_k_max[] = "max";
 static const char __pyx_k_mcs[] = "mcs";
 static const char __pyx_k_mft[] = "mft";
+static const char __pyx_k_min[] = "min";
 static const char __pyx_k_ndx[] = "_ndx";
 static const char __pyx_k_new[] = "__new__";
 static const char __pyx_k_obj[] = "obj";
 static const char __pyx_k_out[] = "out";
 static const char __pyx_k_pop[] = "pop";
 static const char __pyx_k_raw[] = "raw";
 static const char __pyx_k_res[] = "res";
@@ -3198,34 +3229,31 @@
 static const char __pyx_k_std[] = "std";
 static const char __pyx_k_sum[] = "sum";
 static const char __pyx_k_tbl[] = "tbl";
 static const char __pyx_k_tri[] = "_tri";
 static const char __pyx_k_veq[] = "veq";
 static const char __pyx_k_vtk[] = "vtk";
 static const char __pyx_k_zip[] = "zip";
-static const char __pyx_k__154[] = "_";
+static const char __pyx_k__165[] = "_";
 static const char __pyx_k_acc0[] = "acc0";
 static const char __pyx_k_acc1[] = "acc1";
 static const char __pyx_k_accT[] = "accT";
 static const char __pyx_k_accs[] = "_accs";
 static const char __pyx_k_args[] = "args";
-static const char __pyx_k_avgs[] = "avgs";
 static const char __pyx_k_axis[] = "axis";
 static const char __pyx_k_base[] = "base";
 static const char __pyx_k_bits[] = "bits";
 static const char __pyx_k_cbuf[] = "_cbuf";
 static const char __pyx_k_cls0[] = "cls0";
 static const char __pyx_k_copy[] = "copy";
-static const char __pyx_k_covs[] = "covs";
 static const char __pyx_k_dbuf[] = "_dbuf";
 static const char __pyx_k_dger[] = "dger";
 static const char __pyx_k_diag[] = "diag";
 static const char __pyx_k_dict[] = "__dict__";
 static const char __pyx_k_init[] = "__init__";
-static const char __pyx_k_inst[] = "inst";
 static const char __pyx_k_main[] = "__main__";
 static const char __pyx_k_maxm[] = "maxm";
 static const char __pyx_k_mcss[] = "mcss";
 static const char __pyx_k_mean[] = "mean";
 static const char __pyx_k_mlen[] = "mlen";
 static const char __pyx_k_mode[] = "mode";
 static const char __pyx_k_name[] = "name";
@@ -3249,16 +3277,18 @@
 static const char __pyx_k_acc1d[] = "acc1d";
 static const char __pyx_k_acc2d[] = "acc2d";
 static const char __pyx_k_array[] = "array";
 static const char __pyx_k_ave_i[] = "ave_i";
 static const char __pyx_k_ave_j[] = "ave_j";
 static const char __pyx_k_binom[] = "binom";
 static const char __pyx_k_buf_2[] = "buf";
+static const char __pyx_k_bufsz[] = "bufsz";
 static const char __pyx_k_class[] = "__class__";
 static const char __pyx_k_close[] = "close";
+static const char __pyx_k_clssz[] = "clssz";
 static const char __pyx_k_daxpy[] = "daxpy";
 static const char __pyx_k_delta[] = "delta";
 static const char __pyx_k_dgemm[] = "dgemm";
 static const char __pyx_k_dsbmv[] = "dsbmv";
 static const char __pyx_k_dscal[] = "dscal";
 static const char __pyx_k_dsyrk[] = "dsyrk";
 static const char __pyx_k_dtype[] = "dtype";
@@ -3270,14 +3300,15 @@
 static const char __pyx_k_inv_n[] = "inv_n";
 static const char __pyx_k_items[] = "items";
 static const char __pyx_k_lytsz[] = "lytsz";
 static const char __pyx_k_m1idx[] = "m1idx";
 static const char __pyx_k_numpy[] = "numpy";
 static const char __pyx_k_outer[] = "outer";
 static const char __pyx_k_power[] = "power";
+static const char __pyx_k_print[] = "print";
 static const char __pyx_k_range[] = "range";
 static const char __pyx_k_ravel[] = "ravel";
 static const char __pyx_k_shape[] = "shape";
 static const char __pyx_k_ssyrk[] = "ssyrk";
 static const char __pyx_k_start[] = "start";
 static const char __pyx_k_stats[] = "_stats";
 static const char __pyx_k_super[] = "super";
@@ -3293,14 +3324,15 @@
 static const char __pyx_k_accs_2[] = "accs";
 static const char __pyx_k_accssz[] = "accssz";
 static const char __pyx_k_ar_len[] = "ar_len";
 static const char __pyx_k_cl_len[] = "cl_len";
 static const char __pyx_k_cl_lyt[] = "cl_lyt";
 static const char __pyx_k_cl_set[] = "cl_set";
 static const char __pyx_k_counts[] = "counts";
+static const char __pyx_k_dbuf_2[] = "dbuf";
 static const char __pyx_k_encode[] = "encode";
 static const char __pyx_k_format[] = "format";
 static const char __pyx_k_has_m1[] = "has_m1";
 static const char __pyx_k_import[] = "__import__";
 static const char __pyx_k_intbl0[] = "intbl0";
 static const char __pyx_k_kwargs[] = "kwargs";
 static const char __pyx_k_layout[] = "_layout";
@@ -3336,31 +3368,37 @@
 static const char __pyx_k_cov_arr[] = "cov_arr";
 static const char __pyx_k_db_part[] = "db_part";
 static const char __pyx_k_dtype_2[] = "_dtype";
 static const char __pyx_k_float32[] = "float32";
 static const char __pyx_k_float64[] = "float64";
 static const char __pyx_k_fortran[] = "fortran";
 static const char __pyx_k_genexpr[] = "genexpr";
+static const char __pyx_k_mem_tri[] = "mem_tri";
 static const char __pyx_k_memview[] = "memview";
 static const char __pyx_k_min_cnt[] = "min_cnt";
 static const char __pyx_k_moments[] = "moments";
 static const char __pyx_k_ndarray[] = "ndarray";
 static const char __pyx_k_newaxis[] = "newaxis";
 static const char __pyx_k_outtbl0[] = "outtbl0";
 static const char __pyx_k_prepare[] = "__prepare__";
 static const char __pyx_k_reshape[] = "reshape";
 static const char __pyx_k_tr_copy[] = "tr_copy";
+static const char __pyx_k_ttstdsz[] = "ttstdsz";
 static const char __pyx_k_vtk_arr[] = "vtk_arr";
 static const char __pyx_k_Ellipsis[] = "Ellipsis";
 static const char __pyx_k_GetBlock[] = "GetBlock";
+static const char __pyx_k_accs1dsz[] = "accs1dsz";
 static const char __pyx_k_accs2d_2[] = "accs2d";
+static const char __pyx_k_accs2dsz[] = "accs2dsz";
 static const char __pyx_k_counts_2[] = "_counts";
 static const char __pyx_k_diagonal[] = "diagonal";
+static const char __pyx_k_edge_val[] = "edge_val";
 static const char __pyx_k_getstate[] = "__getstate__";
 static const char __pyx_k_itemsize[] = "itemsize";
+static const char __pyx_k_mem_base[] = "mem_base";
 static const char __pyx_k_multiply[] = "multiply";
 static const char __pyx_k_property[] = "property";
 static const char __pyx_k_pyx_type[] = "__pyx_type";
 static const char __pyx_k_qualname[] = "__qualname__";
 static const char __pyx_k_setstate[] = "__setstate__";
 static const char __pyx_k_variance[] = "variance";
 static const char __pyx_k_vtkTable[] = "vtkTable";
@@ -3373,21 +3411,21 @@
 static const char __pyx_k_bivar_vtk[] = "bivar_vtk";
 static const char __pyx_k_cl_layout[] = "_cl_layout";
 static const char __pyx_k_cls_count[] = "_cls_count";
 static const char __pyx_k_comoments[] = "_comoments";
 static const char __pyx_k_enumerate[] = "enumerate";
 static const char __pyx_k_mem_class[] = "mem_class";
 static const char __pyx_k_mem_ttest[] = "mem_ttest";
+static const char __pyx_k_mem_ttstd[] = "mem_ttstd";
 static const char __pyx_k_metaclass[] = "__metaclass__";
 static const char __pyx_k_moments_2[] = "_moments";
 static const char __pyx_k_ms_helper[] = "_ms_helper";
 static const char __pyx_k_normalize[] = "normalize";
 static const char __pyx_k_pyx_state[] = "__pyx_state";
 static const char __pyx_k_reduce_ex[] = "__reduce_ex__";
-static const char __pyx_k_sz_helper[] = "_sz_helper";
 static const char __pyx_k_temp_diag[] = "temp_diag";
 static const char __pyx_k_tr_layout[] = "tr_layout";
 static const char __pyx_k_trace_len[] = "trace_len";
 static const char __pyx_k_traces_cl[] = "traces_cl";
 static const char __pyx_k_IndexError[] = "IndexError";
 static const char __pyx_k_ValueError[] = "ValueError";
 static const char __pyx_k_accs_count[] = "accs_count";
@@ -3409,26 +3447,26 @@
 static const char __pyx_k_comoments_2[] = "comoments";
 static const char __pyx_k_detrend_cnt[] = "detrend_cnt";
 static const char __pyx_k_memory_size[] = "memory_size";
 static const char __pyx_k_realloc_tri[] = "_realloc_tri";
 static const char __pyx_k_rmoms2cmoms[] = "_rmoms2cmoms";
 static const char __pyx_k_total_count[] = "total_count";
 static const char __pyx_k_tr_lyt_view[] = "tr_lyt_view";
-static const char __pyx_k_tr_set_mean[] = "tr_set_mean";
 static const char __pyx_k_triuflatten[] = "triuflatten";
 static const char __pyx_k_SetInputData[] = "SetInputData";
 static const char __pyx_k_broadcast_to[] = "broadcast_to";
 static const char __pyx_k_numpy_to_vtk[] = "numpy_to_vtk";
 static const char __pyx_k_pyx_checksum[] = "__pyx_checksum";
 static const char __pyx_k_staticmethod[] = "staticmethod";
 static const char __pyx_k_stringsource[] = "stringsource";
 static const char __pyx_k_vtk_to_numpy[] = "vtk_to_numpy";
 static const char __pyx_k_SetTestOption[] = "SetTestOption";
 static const char __pyx_k_acc_min_count[] = "acc_min_count";
 static const char __pyx_k_bivar_sum_mix[] = "bivar_sum_mix";
+static const char __pyx_k_dbuf_nonempty[] = "dbuf_nonempty";
 static const char __pyx_k_detrend_cnt_2[] = "_detrend_cnt";
 static const char __pyx_k_pyx_getbuffer[] = "__pyx_getbuffer";
 static const char __pyx_k_reduce_cython[] = "__reduce_cython__";
 static const char __pyx_k_scipy_special[] = "scipy.special";
 static const char __pyx_k_sort_meanfree[] = "_sort_meanfree";
 static const char __pyx_k_std_normalize[] = "_std_normalize";
 static const char __pyx_k_AccBase___init[] = "_AccBase.__init__";
@@ -3455,42 +3493,45 @@
 static const char __pyx_k_pyx_PickleError[] = "__pyx_PickleError";
 static const char __pyx_k_setstate_cython[] = "__setstate_cython__";
 static const char __pyx_k_triuflatten_gen[] = "_triuflatten_gen";
 static const char __pyx_k_bivar_sum___init[] = "bivar_sum.__init__";
 static const char __pyx_k_bivar_vtk___init[] = "bivar_vtk.__init__";
 static const char __pyx_k_bivar_vtk_counts[] = "bivar_vtk.counts";
 static const char __pyx_k_bivar_vtk_update[] = "bivar_vtk.update";
+static const char __pyx_k_is_vtk_installed[] = "is_vtk_installed";
 static const char __pyx_k_AccBase_comoments[] = "_AccBase.comoments";
 static const char __pyx_k_bivar_cntr___init[] = "bivar_cntr.__init__";
 static const char __pyx_k_bivar_cntr_counts[] = "bivar_cntr.counts";
 static const char __pyx_k_bivar_cntr_update[] = "bivar_cntr.update";
 static const char __pyx_k_bivar_sum_detrend[] = "bivar_sum_detrend";
+static const char __pyx_k_bivar_vtk_moments[] = "bivar_vtk.moments";
 static const char __pyx_k_estimate_mem_size[] = "estimate_mem_size";
 static const char __pyx_k_pyx_unpickle_Enum[] = "__pyx_unpickle_Enum";
 static const char __pyx_k_scipy_linalg_blas[] = "scipy.linalg.blas";
 static const char __pyx_k_triu_indices_from[] = "triu_indices_from";
 static const char __pyx_k_univar_sum___init[] = "univar_sum.__init__";
 static const char __pyx_k_univar_sum_counts[] = "univar_sum.counts";
 static const char __pyx_k_univar_sum_update[] = "univar_sum.update";
 static const char __pyx_k_GetInputDataObject[] = "GetInputDataObject";
 static const char __pyx_k_bivar_txtbk___init[] = "bivar_txtbk.__init__";
-static const char __pyx_k_bivar_vtk__moments[] = "bivar_vtk._moments";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
 static const char __pyx_k_strided_and_direct[] = "<strided and direct>";
 static const char __pyx_k_univar_sum_detrend[] = "univar_sum_detrend";
 static const char __pyx_k_AccBase__ensure_ret[] = "_AccBase._ensure_ret";
 static const char __pyx_k_AccBase_memory_size[] = "_AccBase.memory_size";
 static const char __pyx_k_GetActualMemorySize[] = "GetActualMemorySize";
 static const char __pyx_k_GetOutputDataObject[] = "GetOutputDataObject";
+static const char __pyx_k_ModuleNotFoundError[] = "ModuleNotFoundError";
 static const char __pyx_k_NotImplementedError[] = "NotImplementedError";
 static const char __pyx_k_bivar_cntr__moments[] = "bivar_cntr._moments";
+static const char __pyx_k_bivar_vtk_comoments[] = "bivar_vtk.comoments";
 static const char __pyx_k_statmoments__native[] = "statmoments._native";
 static const char __pyx_k_univar_sum__moments[] = "univar_sum._moments";
+static const char __pyx_k_VTK_is_not_installed[] = "VTK is not installed";
 static const char __pyx_k_bivar_sum_mix___init[] = "bivar_sum_mix.__init__";
-static const char __pyx_k_bivar_vtk__comoments[] = "bivar_vtk._comoments";
 static const char __pyx_k_strided_and_indirect[] = "<strided and indirect>";
 static const char __pyx_k_BivarNpassBase___init[] = "_BivarNpassBase.__init__";
 static const char __pyx_k_BivarNpassBase_counts[] = "_BivarNpassBase.counts";
 static const char __pyx_k_BivarNpassBase_update[] = "_BivarNpassBase.update";
 static const char __pyx_k_bivar_cntr__comoments[] = "bivar_cntr._comoments";
 static const char __pyx_k_bivar_sum_base___init[] = "_bivar_sum_base.__init__";
 static const char __pyx_k_bivar_sum_base_counts[] = "_bivar_sum_base.counts";
@@ -3502,40 +3543,45 @@
 static const char __pyx_k_bivar_2pass__comoments[] = "bivar_2pass._comoments";
 static const char __pyx_k_bivar_cntr_memory_size[] = "bivar_cntr.memory_size";
 static const char __pyx_k_bivar_txtbk__comoments[] = "bivar_txtbk._comoments";
 static const char __pyx_k_univar_sum_memory_size[] = "univar_sum.memory_size";
 static const char __pyx_k_vtk_util_numpy_support[] = "vtk.util.numpy_support";
 static const char __pyx_k_BivarNpassBase__moments[] = "_BivarNpassBase._moments";
 static const char __pyx_k_MemoryView_of_r_at_0x_x[] = "<MemoryView of %r at 0x%x>";
+static const char __pyx_k_bivar_2pass_memory_size[] = "bivar_2pass.memory_size";
 static const char __pyx_k_bivar_sum_base__moments[] = "_bivar_sum_base._moments";
+static const char __pyx_k_bivar_txtbk_memory_size[] = "bivar_txtbk.memory_size";
 static const char __pyx_k_contiguous_and_indirect[] = "<contiguous and indirect>";
 static const char __pyx_k_statmoments__native_pyx[] = "statmoments\\_native.pyx";
 static const char __pyx_k_Cannot_index_with_type_s[] = "Cannot index with type '%s'";
 static const char __pyx_k_bivar_sum_detrend___init[] = "bivar_sum_detrend.__init__";
 static const char __pyx_k_bivar_sum_detrend_update[] = "bivar_sum_detrend.update";
 static const char __pyx_k_bivar_txtbk__realloc_tri[] = "bivar_txtbk._realloc_tri";
 static const char __pyx_k_AccBase_estimate_mem_size[] = "_AccBase.estimate_mem_size";
 static const char __pyx_k_Invalid_shape_in_axis_d_d[] = "Invalid shape in axis %d: %d.";
+static const char __pyx_k_VTK_is_installed_and_used[] = "VTK is installed and used";
 static const char __pyx_k_bivar_sum_base__comoments[] = "_bivar_sum_base._comoments";
 static const char __pyx_k_univar_sum_detrend___init[] = "univar_sum_detrend.__init__";
 static const char __pyx_k_univar_sum_detrend_update[] = "univar_sum_detrend.update";
 static const char __pyx_k_BivarNpassBase_memory_size[] = "_BivarNpassBase.memory_size";
 static const char __pyx_k_bivar_sum_base_memory_size[] = "_bivar_sum_base.memory_size";
 static const char __pyx_k_bivar_sum_detrend__moments[] = "bivar_sum_detrend._moments";
 static const char __pyx_k_calc_central_moment_general[] = "calc_central_moment_general";
 static const char __pyx_k_itemsize_0_for_cython_array[] = "itemsize <= 0 for cython.array";
 static const char __pyx_k_univar_sum_detrend__moments[] = "univar_sum_detrend._moments";
 static const char __pyx_k_bivar_cntr_estimate_mem_size[] = "bivar_cntr.estimate_mem_size";
 static const char __pyx_k_triuflatten_gen_locals__triu[] = "_triuflatten_gen.<locals>._triu";
 static const char __pyx_k_univar_sum_estimate_mem_size[] = "univar_sum.estimate_mem_size";
+static const char __pyx_k_bivar_2pass_estimate_mem_size[] = "bivar_2pass.estimate_mem_size";
+static const char __pyx_k_bivar_txtbk_estimate_mem_size[] = "bivar_txtbk.estimate_mem_size";
 static const char __pyx_k_unable_to_allocate_array_data[] = "unable to allocate array data.";
 static const char __pyx_k_vtkMultiCorrelativeStatistics[] = "vtkMultiCorrelativeStatistics";
 static const char __pyx_k_strided_and_direct_or_indirect[] = "<strided and direct or indirect>";
 static const char __pyx_k_BivarNpassBase_estimate_mem_siz[] = "_BivarNpassBase.estimate_mem_size";
-static const char __pyx_k_BivarNpassBase_memory_size_loca[] = "_BivarNpassBase.memory_size.<locals>._sz_helper.<locals>.genexpr";
+static const char __pyx_k_BivarNpassBase_memory_size_loca[] = "_BivarNpassBase.memory_size.<locals>.genexpr";
 static const char __pyx_k_The_input_moment_should_be_less[] = "The input moment should be less or equal than indicated in constructor.";
 static const char __pyx_k_bivar_sum_base_estimate_mem_siz[] = "_bivar_sum_base.estimate_mem_size";
 static const char __pyx_k_bivar_sum_base_memory_size_loca[] = "_bivar_sum_base.memory_size.<locals>.genexpr";
 static const char __pyx_k_A_class_using_vtk_multivariate_k[] = "A class, using vtk multivariate kernel. Covariance ONLY!!!";
 static const char __pyx_k_A_class_working_with_2D_accs_whi[] = "A class, working with 2D accs, which track central moments";
 static const char __pyx_k_Buffer_view_does_not_expose_stri[] = "Buffer view does not expose strides";
 static const char __pyx_k_Can_only_create_a_buffer_that_is[] = "Can only create a buffer that is contiguous in memory.";
@@ -3552,15 +3598,14 @@
 static const char __pyx_k_Unable_to_convert_item_to_object[] = "Unable to convert item to object";
 static const char __pyx_k_bivar_cntr_memory_size_locals_ge[] = "bivar_cntr.memory_size.<locals>.genexpr";
 static const char __pyx_k_bivar_vtk_memory_size_locals__ms[] = "bivar_vtk.memory_size.<locals>._ms_helper.<locals>.genexpr";
 static const char __pyx_k_got_differing_extents_in_dimensi[] = "got differing extents in dimension %d (got %d and %d)";
 static const char __pyx_k_no_default___reduce___due_to_non[] = "no default __reduce__ due to non-trivial __cinit__";
 static const char __pyx_k_unable_to_allocate_shape_and_str[] = "unable to allocate shape and strides.";
 static const char __pyx_k_univar_sum_memory_size_locals_ge[] = "univar_sum.memory_size.<locals>.genexpr";
-static const char __pyx_k_BivarNpassBase_memory_size_loca_2[] = "_BivarNpassBase.memory_size.<locals>._sz_helper";
 static const char __pyx_k_bivar_vtk_memory_size_locals__ms_2[] = "bivar_vtk.memory_size.<locals>._ms_helper";
 static PyObject *__pyx_kp_b_2;
 static PyObject *__pyx_n_s_ASCII;
 static PyObject *__pyx_kp_s_A_class_using_vtk_multivariate_k;
 static PyObject *__pyx_kp_s_A_class_working_with_2D_accs_whi;
 static PyObject *__pyx_n_s_AccBase;
 static PyObject *__pyx_n_s_AccBase___init;
@@ -3575,15 +3620,14 @@
 static PyObject *__pyx_n_s_BivarNpassBase;
 static PyObject *__pyx_n_s_BivarNpassBase___init;
 static PyObject *__pyx_n_s_BivarNpassBase__moments;
 static PyObject *__pyx_n_s_BivarNpassBase_counts;
 static PyObject *__pyx_n_s_BivarNpassBase_estimate_mem_siz;
 static PyObject *__pyx_n_s_BivarNpassBase_memory_size;
 static PyObject *__pyx_n_s_BivarNpassBase_memory_size_loca;
-static PyObject *__pyx_n_s_BivarNpassBase_memory_size_loca_2;
 static PyObject *__pyx_n_s_BivarNpassBase_update;
 static PyObject *__pyx_kp_s_Buffer_view_does_not_expose_stri;
 static PyObject *__pyx_n_s_C;
 static PyObject *__pyx_kp_s_Can_only_create_a_buffer_that_is;
 static PyObject *__pyx_kp_s_Cannot_assign_to_read_only_memor;
 static PyObject *__pyx_kp_s_Cannot_create_writable_memory_vi;
 static PyObject *__pyx_kp_s_Cannot_index_with_type_s;
@@ -3602,14 +3646,15 @@
 static PyObject *__pyx_kp_s_Invalid_mode_expected_c_or_fortr;
 static PyObject *__pyx_kp_s_Invalid_shape_in_axis_d_d;
 static PyObject *__pyx_n_s_M;
 static PyObject *__pyx_n_s_MM;
 static PyObject *__pyx_n_s_MemoryError;
 static PyObject *__pyx_kp_s_MemoryView_of_r_at_0x_x;
 static PyObject *__pyx_kp_s_MemoryView_of_r_object;
+static PyObject *__pyx_n_s_ModuleNotFoundError;
 static PyObject *__pyx_n_s_Mpq;
 static PyObject *__pyx_kp_u_Must_be_implemented_in_an_inheri;
 static PyObject *__pyx_n_s_NotImplementedError;
 static PyObject *__pyx_kp_u_Not_implemented;
 static PyObject *__pyx_n_b_O;
 static PyObject *__pyx_kp_s_Out_of_bounds_on_buffer_access_a;
 static PyObject *__pyx_kp_u_P;
@@ -3625,54 +3670,58 @@
 static PyObject *__pyx_n_s_T;
 static PyObject *__pyx_kp_u_The_input_moment_lists_should_ha;
 static PyObject *__pyx_kp_u_The_input_moment_should_be_less;
 static PyObject *__pyx_kp_u_The_moment_should_be_less_or_equ;
 static PyObject *__pyx_n_s_TypeError;
 static PyObject *__pyx_kp_s_Unable_to_convert_item_to_object;
 static PyObject *__pyx_n_s_Update;
+static PyObject *__pyx_kp_u_VTK_is_installed_and_used;
+static PyObject *__pyx_kp_u_VTK_is_not_installed;
 static PyObject *__pyx_n_s_ValueError;
 static PyObject *__pyx_n_s_View_MemoryView;
-static PyObject *__pyx_n_s__154;
-static PyObject *__pyx_n_s__63;
+static PyObject *__pyx_n_s__165;
+static PyObject *__pyx_n_s__62;
 static PyObject *__pyx_n_s_acc;
 static PyObject *__pyx_n_s_acc0;
 static PyObject *__pyx_n_s_acc1;
 static PyObject *__pyx_n_s_acc1d;
 static PyObject *__pyx_n_s_acc2d;
 static PyObject *__pyx_n_s_accT;
 static PyObject *__pyx_n_s_acc_dtype;
 static PyObject *__pyx_n_s_acc_min_count;
 static PyObject *__pyx_n_u_acc_min_count;
 static PyObject *__pyx_n_s_accs;
 static PyObject *__pyx_n_s_accs1d;
+static PyObject *__pyx_n_s_accs1dsz;
 static PyObject *__pyx_n_s_accs2d;
 static PyObject *__pyx_n_s_accs2d_2;
+static PyObject *__pyx_n_s_accs2dsz;
 static PyObject *__pyx_n_s_accs_2;
 static PyObject *__pyx_n_s_accs_count;
 static PyObject *__pyx_n_s_accssz;
 static PyObject *__pyx_n_s_acctype;
 static PyObject *__pyx_n_u_acctype;
 static PyObject *__pyx_n_s_allocate_buffer;
 static PyObject *__pyx_n_s_ar_len;
 static PyObject *__pyx_n_s_args;
 static PyObject *__pyx_n_s_arr;
 static PyObject *__pyx_n_s_array;
 static PyObject *__pyx_n_s_asarray;
 static PyObject *__pyx_n_s_ave;
 static PyObject *__pyx_n_s_ave_i;
 static PyObject *__pyx_n_s_ave_j;
-static PyObject *__pyx_n_s_avg;
-static PyObject *__pyx_n_s_avgs;
 static PyObject *__pyx_n_s_axis;
 static PyObject *__pyx_n_s_base;
 static PyObject *__pyx_n_s_batch_cnt;
 static PyObject *__pyx_n_s_binom;
 static PyObject *__pyx_n_s_bits;
 static PyObject *__pyx_n_s_bivar_2pass;
 static PyObject *__pyx_n_s_bivar_2pass__comoments;
+static PyObject *__pyx_n_s_bivar_2pass_estimate_mem_size;
+static PyObject *__pyx_n_s_bivar_2pass_memory_size;
 static PyObject *__pyx_n_s_bivar_cntr;
 static PyObject *__pyx_n_s_bivar_cntr___init;
 static PyObject *__pyx_n_s_bivar_cntr__comoments;
 static PyObject *__pyx_n_s_bivar_cntr__moments;
 static PyObject *__pyx_n_s_bivar_cntr_counts;
 static PyObject *__pyx_n_s_bivar_cntr_estimate_mem_size;
 static PyObject *__pyx_n_s_bivar_cntr_memory_size;
@@ -3695,27 +3744,30 @@
 static PyObject *__pyx_n_s_bivar_sum_detrend_update;
 static PyObject *__pyx_n_s_bivar_sum_mix;
 static PyObject *__pyx_n_s_bivar_sum_mix___init;
 static PyObject *__pyx_n_s_bivar_txtbk;
 static PyObject *__pyx_n_s_bivar_txtbk___init;
 static PyObject *__pyx_n_s_bivar_txtbk__comoments;
 static PyObject *__pyx_n_s_bivar_txtbk__realloc_tri;
+static PyObject *__pyx_n_s_bivar_txtbk_estimate_mem_size;
+static PyObject *__pyx_n_s_bivar_txtbk_memory_size;
 static PyObject *__pyx_n_s_bivar_vtk;
 static PyObject *__pyx_n_s_bivar_vtk___init;
-static PyObject *__pyx_n_s_bivar_vtk__comoments;
-static PyObject *__pyx_n_s_bivar_vtk__moments;
+static PyObject *__pyx_n_s_bivar_vtk_comoments;
 static PyObject *__pyx_n_s_bivar_vtk_counts;
 static PyObject *__pyx_n_s_bivar_vtk_memory_size;
 static PyObject *__pyx_n_s_bivar_vtk_memory_size_locals__ms;
 static PyObject *__pyx_n_s_bivar_vtk_memory_size_locals__ms_2;
+static PyObject *__pyx_n_s_bivar_vtk_moments;
 static PyObject *__pyx_n_s_bivar_vtk_total_count;
 static PyObject *__pyx_n_s_bivar_vtk_update;
 static PyObject *__pyx_n_s_broadcast_to;
 static PyObject *__pyx_n_s_buf;
 static PyObject *__pyx_n_s_buf_2;
+static PyObject *__pyx_n_s_bufsz;
 static PyObject *__pyx_n_s_c;
 static PyObject *__pyx_n_u_c;
 static PyObject *__pyx_n_s_c1;
 static PyObject *__pyx_n_s_calc_central_moment_general;
 static PyObject *__pyx_n_s_calc_comoments;
 static PyObject *__pyx_n_s_cbuf;
 static PyObject *__pyx_n_s_cl;
@@ -3731,31 +3783,33 @@
 static PyObject *__pyx_n_s_classifiers;
 static PyObject *__pyx_n_s_classifiers_len;
 static PyObject *__pyx_n_s_cline_in_traceback;
 static PyObject *__pyx_n_s_close;
 static PyObject *__pyx_n_s_cls;
 static PyObject *__pyx_n_s_cls0;
 static PyObject *__pyx_n_s_cls_count;
+static PyObject *__pyx_n_s_clssz;
 static PyObject *__pyx_n_s_cm;
 static PyObject *__pyx_n_s_cmi;
 static PyObject *__pyx_n_s_com;
 static PyObject *__pyx_n_s_comoments;
 static PyObject *__pyx_n_s_comoments_2;
 static PyObject *__pyx_n_s_compute_by_rows;
 static PyObject *__pyx_kp_s_contiguous_and_direct;
 static PyObject *__pyx_kp_s_contiguous_and_indirect;
 static PyObject *__pyx_n_s_copy;
 static PyObject *__pyx_n_s_counts;
 static PyObject *__pyx_n_s_counts_2;
 static PyObject *__pyx_n_s_cov_arr;
-static PyObject *__pyx_n_s_covs;
 static PyObject *__pyx_n_s_da;
 static PyObject *__pyx_n_s_daxpy;
 static PyObject *__pyx_n_s_db_part;
 static PyObject *__pyx_n_s_dbuf;
+static PyObject *__pyx_n_s_dbuf_2;
+static PyObject *__pyx_n_s_dbuf_nonempty;
 static PyObject *__pyx_n_s_dd;
 static PyObject *__pyx_n_s_delta;
 static PyObject *__pyx_n_u_detrend_cnt;
 static PyObject *__pyx_n_s_detrend_cnt_2;
 static PyObject *__pyx_n_s_dgemm;
 static PyObject *__pyx_n_s_dger;
 static PyObject *__pyx_n_s_diag;
@@ -3764,14 +3818,15 @@
 static PyObject *__pyx_n_s_doc;
 static PyObject *__pyx_n_s_dsbmv;
 static PyObject *__pyx_n_s_dscal;
 static PyObject *__pyx_n_s_dsyrk;
 static PyObject *__pyx_n_s_dtype;
 static PyObject *__pyx_n_s_dtype_2;
 static PyObject *__pyx_n_s_dtype_is_object;
+static PyObject *__pyx_n_s_edge_val;
 static PyObject *__pyx_n_s_empty;
 static PyObject *__pyx_n_s_empty_like;
 static PyObject *__pyx_n_s_encode;
 static PyObject *__pyx_n_s_ensure_ret;
 static PyObject *__pyx_n_s_enumerate;
 static PyObject *__pyx_n_s_error;
 static PyObject *__pyx_n_s_estimate_mem_size;
@@ -3790,18 +3845,18 @@
 static PyObject *__pyx_n_s_has_m1;
 static PyObject *__pyx_n_s_i;
 static PyObject *__pyx_n_s_i_2;
 static PyObject *__pyx_n_s_id;
 static PyObject *__pyx_n_s_ii;
 static PyObject *__pyx_n_s_import;
 static PyObject *__pyx_n_s_init;
-static PyObject *__pyx_n_s_inst;
 static PyObject *__pyx_n_s_instl;
 static PyObject *__pyx_n_s_intbl0;
 static PyObject *__pyx_n_s_inv_n;
+static PyObject *__pyx_n_s_is_vtk_installed;
 static PyObject *__pyx_n_s_items;
 static PyObject *__pyx_n_s_itemsize;
 static PyObject *__pyx_kp_s_itemsize_0_for_cython_array;
 static PyObject *__pyx_n_s_j;
 static PyObject *__pyx_n_s_jj;
 static PyObject *__pyx_n_s_k;
 static PyObject *__pyx_n_s_kwargs;
@@ -3821,20 +3876,24 @@
 static PyObject *__pyx_n_s_main;
 static PyObject *__pyx_n_s_map;
 static PyObject *__pyx_n_s_max;
 static PyObject *__pyx_n_s_maxm;
 static PyObject *__pyx_n_s_mcs;
 static PyObject *__pyx_n_s_mcss;
 static PyObject *__pyx_n_s_mean;
+static PyObject *__pyx_n_s_mem_base;
 static PyObject *__pyx_n_s_mem_class;
+static PyObject *__pyx_n_s_mem_tri;
 static PyObject *__pyx_n_s_mem_ttest;
+static PyObject *__pyx_n_s_mem_ttstd;
 static PyObject *__pyx_n_s_memory_size;
 static PyObject *__pyx_n_s_memview;
 static PyObject *__pyx_n_s_metaclass;
 static PyObject *__pyx_n_s_mft;
+static PyObject *__pyx_n_s_min;
 static PyObject *__pyx_n_s_min_cnt;
 static PyObject *__pyx_n_s_mlen;
 static PyObject *__pyx_n_s_mode;
 static PyObject *__pyx_n_s_module;
 static PyObject *__pyx_n_s_moment;
 static PyObject *__pyx_n_s_moments;
 static PyObject *__pyx_n_s_moments_2;
@@ -3869,14 +3928,15 @@
 static PyObject *__pyx_n_s_p;
 static PyObject *__pyx_n_s_pack;
 static PyObject *__pyx_n_s_pickle;
 static PyObject *__pyx_n_s_pop;
 static PyObject *__pyx_n_s_power;
 static PyObject *__pyx_n_s_prepare;
 static PyObject *__pyx_n_s_preprocvar;
+static PyObject *__pyx_n_s_print;
 static PyObject *__pyx_n_s_property;
 static PyObject *__pyx_n_s_pyx_PickleError;
 static PyObject *__pyx_n_s_pyx_checksum;
 static PyObject *__pyx_n_s_pyx_getbuffer;
 static PyObject *__pyx_n_s_pyx_result;
 static PyObject *__pyx_n_s_pyx_state;
 static PyObject *__pyx_n_s_pyx_type;
@@ -3925,15 +3985,14 @@
 static PyObject *__pyx_kp_s_strided_and_direct;
 static PyObject *__pyx_kp_s_strided_and_direct_or_indirect;
 static PyObject *__pyx_kp_s_strided_and_indirect;
 static PyObject *__pyx_kp_s_stringsource;
 static PyObject *__pyx_n_s_struct;
 static PyObject *__pyx_n_s_sum;
 static PyObject *__pyx_n_s_super;
-static PyObject *__pyx_n_s_sz_helper;
 static PyObject *__pyx_n_s_tbl;
 static PyObject *__pyx_n_s_temp_diag;
 static PyObject *__pyx_n_s_test;
 static PyObject *__pyx_n_s_throw;
 static PyObject *__pyx_n_s_tmpbuf;
 static PyObject *__pyx_n_s_tmpsq;
 static PyObject *__pyx_n_s_total_count;
@@ -3941,26 +4000,27 @@
 static PyObject *__pyx_n_s_tr2d;
 static PyObject *__pyx_n_s_tr_copy;
 static PyObject *__pyx_n_s_tr_layout;
 static PyObject *__pyx_n_s_tr_len;
 static PyObject *__pyx_n_s_tr_lyt;
 static PyObject *__pyx_n_s_tr_lyt_view;
 static PyObject *__pyx_n_s_tr_set;
-static PyObject *__pyx_n_s_tr_set_mean;
 static PyObject *__pyx_n_s_trace_len;
 static PyObject *__pyx_n_s_traces;
 static PyObject *__pyx_n_s_traces_cl;
 static PyObject *__pyx_n_s_tri;
 static PyObject *__pyx_n_s_tri_2;
 static PyObject *__pyx_n_s_triu;
 static PyObject *__pyx_n_s_triu_indices_from;
 static PyObject *__pyx_n_s_triuflatten;
 static PyObject *__pyx_n_s_triuflatten_gen;
 static PyObject *__pyx_n_s_triuflatten_gen_locals__triu;
+static PyObject *__pyx_n_s_ts;
 static PyObject *__pyx_n_s_ttest;
+static PyObject *__pyx_n_s_ttstdsz;
 static PyObject *__pyx_n_s_ttsz;
 static PyObject *__pyx_n_s_uint32;
 static PyObject *__pyx_n_s_uint8;
 static PyObject *__pyx_kp_s_unable_to_allocate_array_data;
 static PyObject *__pyx_kp_s_unable_to_allocate_shape_and_str;
 static PyObject *__pyx_n_s_univar_sum;
 static PyObject *__pyx_n_s_univar_sum___init;
@@ -3987,86 +4047,90 @@
 static PyObject *__pyx_n_s_vtkMultiCorrelativeStatistics;
 static PyObject *__pyx_n_s_vtkTable;
 static PyObject *__pyx_n_s_vtk_arr;
 static PyObject *__pyx_n_s_vtk_to_numpy;
 static PyObject *__pyx_n_s_vtk_util_numpy_support;
 static PyObject *__pyx_n_s_zeros;
 static PyObject *__pyx_n_s_zip;
+static PyObject *__pyx_pf_11statmoments_7_native_is_vtk_installed(CYTHON_UNUSED PyObject *__pyx_self); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_8_AccBase___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_tr_len, PyObject *__pyx_v_cl_len, PyObject *__pyx_v_moment, PyObject *__pyx_v_normalize, PyObject *__pyx_v_kwargs); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_8_AccBase_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_trace_len, CYTHON_UNUSED PyObject *__pyx_v_classifier_len, CYTHON_UNUSED PyObject *__pyx_v_moment); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_8_AccBase_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_tr_len, CYTHON_UNUSED PyObject *__pyx_v_cl_len, CYTHON_UNUSED PyObject *__pyx_v_moment); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_8_AccBase_4memory_size(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_8_AccBase_6update(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_traces, CYTHON_UNUSED PyObject *__pyx_v_classifiers); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_8_AccBase_8counts(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_i); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_8_AccBase_10moments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_8_AccBase_12_ensure_ret(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_mlen); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_8_AccBase_14comoments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native__rmoms2cmoms(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_M, PyObject *__pyx_v_moment, CYTHON_UNUSED PyObject *__pyx_v_tmpbuf); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_2calc_central_moment_general(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_raw, PyObject *__pyx_v_ave, PyObject *__pyx_v_n, PyObject *__pyx_v_k, PyObject *__pyx_v_l, PyObject *__pyx_v_i, PyObject *__pyx_v_j); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_2_rmoms2cmoms(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_M, PyObject *__pyx_v_moment, CYTHON_UNUSED PyObject *__pyx_v_tmpbuf); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_4calc_central_moment_general(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_raw, PyObject *__pyx_v_ave, PyObject *__pyx_v_n, PyObject *__pyx_v_k, PyObject *__pyx_v_l, PyObject *__pyx_v_i, PyObject *__pyx_v_j); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_15_bivar_sum_base___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_trace_len, PyObject *__pyx_v_classifier_len, PyObject *__pyx_v_kwargs); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_20__defaults__(CYTHON_UNUSED PyObject *__pyx_self); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_15_bivar_sum_base_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_trace_len, PyObject *__pyx_v_classifier_len, PyObject *__pyx_v_moment, PyObject *__pyx_v_acc_dtype); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_22__defaults__(CYTHON_UNUSED PyObject *__pyx_self); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_15_bivar_sum_base_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tr_len, PyObject *__pyx_v_cl_len, PyObject *__pyx_v_moment, PyObject *__pyx_v_acc_dtype); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_15_bivar_sum_base_11memory_size_genexpr(PyObject *__pyx_self); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_15_bivar_sum_base_4memory_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_15_bivar_sum_base_6update(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_traces, PyObject *__pyx_v_classifiers); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_15_bivar_sum_base_8counts(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_i); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_15_bivar_sum_base_10_moments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_15_bivar_sum_base_13_comoments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_9bivar_sum___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_trace_len, PyObject *__pyx_v_classifier_len, PyObject *__pyx_v_kwargs); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_13bivar_sum_mix___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_trace_len, PyObject *__pyx_v_classifier_len, PyObject *__pyx_v_kwargs); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_17bivar_sum_detrend___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_trace_len, PyObject *__pyx_v_classifier_len, PyObject *__pyx_v_kwargs); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_17bivar_sum_detrend_2update(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_traces, PyObject *__pyx_v_classifiers); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_17bivar_sum_detrend_4_moments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_16_triuflatten_gen__triu(PyObject *__pyx_self, PyObject *__pyx_v_tr2d); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_4_triuflatten_gen(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_n); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_6_compute_by_rows(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tr_len, PyObject *__pyx_v_f); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_8update_moments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_acc2d, PyObject *__pyx_v_acc1d, PyObject *__pyx_v_n1, PyObject *__pyx_v_moment, PyObject *__pyx_v_traces); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_10_calc_comoments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_MM, PyObject *__pyx_v_lm, PyObject *__pyx_v_rm, PyObject *__pyx_v_normalize); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_6_triuflatten_gen(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_n); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_8_compute_by_rows(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tr_len, PyObject *__pyx_v_f); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_10update_moments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_acc2d, PyObject *__pyx_v_acc1d, PyObject *__pyx_v_n1, PyObject *__pyx_v_moment, PyObject *__pyx_v_traces); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_12_calc_comoments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_MM, PyObject *__pyx_v_lm, PyObject *__pyx_v_rm, PyObject *__pyx_v_normalize); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_10bivar_cntr___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_trace_len, PyObject *__pyx_v_classifier_len, PyObject *__pyx_v_kwargs); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_10bivar_cntr_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tr_len, PyObject *__pyx_v_classifier_len, PyObject *__pyx_v_moment); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_10bivar_cntr_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tr_len, PyObject *__pyx_v_cl_len, PyObject *__pyx_v_moment); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_10bivar_cntr_11memory_size_genexpr(PyObject *__pyx_self); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_10bivar_cntr_4memory_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_10bivar_cntr_6update(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_traces, PyObject *__pyx_v_classifiers); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_10bivar_cntr_8counts(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_i); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_10bivar_cntr_10_moments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_10bivar_cntr_13_comoments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_12_std_normalize(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_arr); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_14_sort_meanfree(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ret, PyObject *__pyx_v_normalize); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_14_std_normalize(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_arr); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_16_sort_meanfree(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ret, PyObject *__pyx_v_normalize); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_15_BivarNpassBase___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_tr_len, PyObject *__pyx_v_cl_len, PyObject *__pyx_v_kwargs); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_15_BivarNpassBase_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_trace_len, PyObject *__pyx_v_classifier_len, CYTHON_UNUSED PyObject *__pyx_v_moment); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_15_BivarNpassBase_11memory_size_10_sz_helper_genexpr(PyObject *__pyx_self); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_15_BivarNpassBase_11memory_size__sz_helper(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_inst); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_15_BivarNpassBase_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tr_len, CYTHON_UNUSED PyObject *__pyx_v_cl_len, CYTHON_UNUSED PyObject *__pyx_v_moment); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_15_BivarNpassBase_11memory_size_genexpr(PyObject *__pyx_self); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_15_BivarNpassBase_4memory_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_15_BivarNpassBase_6update(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_traces, PyObject *__pyx_v_classifiers); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_15_BivarNpassBase_8counts(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_i); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_15_BivarNpassBase_10_moments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_11bivar_2pass__comoments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_11bivar_2pass_estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tr_len, PyObject *__pyx_v_cl_len, PyObject *__pyx_v_moment); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_11bivar_2pass_2memory_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_11bivar_2pass_4_comoments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_11bivar_txtbk___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_trace_len, PyObject *__pyx_v_classifier_len, PyObject *__pyx_v_kwargs); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_11bivar_txtbk_2_realloc_tri(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_m); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_11bivar_txtbk_4_comoments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_9bivar_vtk___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_trace_len, PyObject *__pyx_v_classifier_len, PyObject *__pyx_v_moment, PyObject *__pyx_v_kwargs); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_11bivar_txtbk_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tr_len, PyObject *__pyx_v_cl_len, PyObject *__pyx_v_moment); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_11bivar_txtbk_4memory_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_11bivar_txtbk_6_realloc_tri(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_m); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_11bivar_txtbk_8_comoments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_9bivar_vtk___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_tr_len, PyObject *__pyx_v_classifier_len, PyObject *__pyx_v_moment, PyObject *__pyx_v_kwargs); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_9bivar_vtk_11memory_size_10_ms_helper_genexpr(PyObject *__pyx_self); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_9bivar_vtk_11memory_size__ms_helper(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_instl); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_9bivar_vtk_2memory_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_9bivar_vtk_4total_count(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_9bivar_vtk_6update(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_traces, PyObject *__pyx_v_classifiers); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_9bivar_vtk_8counts(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_i); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_9bivar_vtk_10_moments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_9bivar_vtk_13_comoments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_moments, CYTHON_UNUSED PyObject *__pyx_v_normalize); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_9bivar_vtk_10moments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_9bivar_vtk_13comoments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, CYTHON_UNUSED PyObject *__pyx_v_normalize); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_10univar_sum___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_trace_len, PyObject *__pyx_v_classifier_len, PyObject *__pyx_v_kwargs); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_10univar_sum_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_trace_len, PyObject *__pyx_v_classifier_len, PyObject *__pyx_v_moment); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_10univar_sum_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tr_len, PyObject *__pyx_v_cl_len, PyObject *__pyx_v_moment); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_10univar_sum_11memory_size_genexpr(PyObject *__pyx_self); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_10univar_sum_4memory_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_10univar_sum_6counts(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_i); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_10univar_sum_8_moments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_10univar_sum_11update(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_traces, PyObject *__pyx_v_classifiers); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_18univar_sum_detrend___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_trace_len, PyObject *__pyx_v_classifier_len, PyObject *__pyx_v_kwargs); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_18univar_sum_detrend_2update(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_traces, PyObject *__pyx_v_classifiers); /* proto */
 static PyObject *__pyx_pf_11statmoments_7_native_18univar_sum_detrend_4_moments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_16_preprocvar(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_M, PyObject *__pyx_v_m, PyObject *__pyx_v_variance); /* proto */
-static PyObject *__pyx_pf_11statmoments_7_native_18ttest(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_n0, PyObject *__pyx_v_n1, PyObject *__pyx_v_m10, PyObject *__pyx_v_m11, PyObject *__pyx_v_m20, PyObject *__pyx_v_m21, PyObject *__pyx_v_veq); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_18_preprocvar(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_M, PyObject *__pyx_v_m, PyObject *__pyx_v_variance); /* proto */
+static PyObject *__pyx_pf_11statmoments_7_native_20ttest(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_n0, PyObject *__pyx_v_n1, PyObject *__pyx_v_m10, PyObject *__pyx_v_m11, PyObject *__pyx_v_m20, PyObject *__pyx_v_m21, PyObject *__pyx_v_veq); /* proto */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array___cinit__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_shape, Py_ssize_t __pyx_v_itemsize, PyObject *__pyx_v_format, PyObject *__pyx_v_mode, int __pyx_v_allocate_buffer); /* proto */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array_2__getbuffer__(struct __pyx_array_obj *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /* proto */
 static void __pyx_array___pyx_pf_15View_dot_MemoryView_5array_4__dealloc__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView_5array_7memview___get__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static Py_ssize_t __pyx_array___pyx_pf_15View_dot_MemoryView_5array_6__len__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_array___pyx_pf_15View_dot_MemoryView_5array_8__getattr__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_attr); /* proto */
 static PyObject *__pyx_array___pyx_pf_15View_dot_MemoryView_5array_10__getitem__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_item); /* proto */
@@ -4111,23 +4175,23 @@
 static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_3__comoments(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_4__moments(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_5__triuflatten_gen(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_6_memory_size(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_7_genexpr(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_8__moments(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_9__comoments(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
-static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_10__sz_helper(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
+static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_10_memory_size(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_11_genexpr(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_12__moments(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_13__comoments(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_14__comoments(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_15__ms_helper(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_16_genexpr(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
-static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_17__moments(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
-static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_18__comoments(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
+static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_17_moments(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
+static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_18_comoments(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_19_memory_size(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_20_genexpr(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_21__moments(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_22__moments(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_array(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_Enum(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_memoryview(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
@@ -4152,42 +4216,43 @@
 static PyObject *__pyx_int_112105877;
 static PyObject *__pyx_int_136983863;
 static PyObject *__pyx_int_184977713;
 static PyObject *__pyx_int_neg_1;
 static PyObject *__pyx_int_neg_4;
 static PyObject *__pyx_int_neg_24;
 static PyObject *__pyx_tuple_;
-static PyObject *__pyx_slice__5;
+static PyObject *__pyx_slice__7;
 static PyObject *__pyx_tuple__2;
 static PyObject *__pyx_tuple__3;
 static PyObject *__pyx_tuple__4;
+static PyObject *__pyx_tuple__5;
 static PyObject *__pyx_tuple__6;
-static PyObject *__pyx_tuple__7;
 static PyObject *__pyx_tuple__8;
 static PyObject *__pyx_tuple__9;
-static PyObject *__pyx_slice__17;
-static PyObject *__pyx_slice__20;
+static PyObject *__pyx_slice__19;
+static PyObject *__pyx_slice__22;
 static PyObject *__pyx_tuple__10;
 static PyObject *__pyx_tuple__11;
 static PyObject *__pyx_tuple__12;
 static PyObject *__pyx_tuple__13;
 static PyObject *__pyx_tuple__14;
 static PyObject *__pyx_tuple__15;
 static PyObject *__pyx_tuple__16;
+static PyObject *__pyx_tuple__17;
 static PyObject *__pyx_tuple__18;
-static PyObject *__pyx_tuple__19;
+static PyObject *__pyx_tuple__20;
 static PyObject *__pyx_tuple__21;
 static PyObject *__pyx_tuple__23;
-static PyObject *__pyx_tuple__24;
-static PyObject *__pyx_tuple__26;
-static PyObject *__pyx_tuple__28;
-static PyObject *__pyx_tuple__32;
-static PyObject *__pyx_tuple__37;
-static PyObject *__pyx_tuple__40;
-static PyObject *__pyx_tuple__43;
+static PyObject *__pyx_tuple__25;
+static PyObject *__pyx_tuple__27;
+static PyObject *__pyx_tuple__29;
+static PyObject *__pyx_tuple__36;
+static PyObject *__pyx_tuple__39;
+static PyObject *__pyx_tuple__42;
+static PyObject *__pyx_tuple__44;
 static PyObject *__pyx_tuple__45;
 static PyObject *__pyx_tuple__46;
 static PyObject *__pyx_tuple__47;
 static PyObject *__pyx_tuple__48;
 static PyObject *__pyx_tuple__49;
 static PyObject *__pyx_tuple__50;
 static PyObject *__pyx_tuple__51;
@@ -4197,168 +4262,411 @@
 static PyObject *__pyx_tuple__55;
 static PyObject *__pyx_tuple__56;
 static PyObject *__pyx_tuple__57;
 static PyObject *__pyx_tuple__58;
 static PyObject *__pyx_tuple__59;
 static PyObject *__pyx_tuple__60;
 static PyObject *__pyx_tuple__61;
-static PyObject *__pyx_tuple__62;
-static PyObject *__pyx_tuple__64;
+static PyObject *__pyx_tuple__63;
 static PyObject *__pyx_tuple__65;
-static PyObject *__pyx_tuple__67;
+static PyObject *__pyx_tuple__66;
 static PyObject *__pyx_tuple__68;
-static PyObject *__pyx_tuple__70;
+static PyObject *__pyx_tuple__69;
 static PyObject *__pyx_tuple__71;
-static PyObject *__pyx_tuple__73;
-static PyObject *__pyx_tuple__75;
-static PyObject *__pyx_tuple__77;
-static PyObject *__pyx_tuple__79;
+static PyObject *__pyx_tuple__72;
+static PyObject *__pyx_tuple__74;
+static PyObject *__pyx_tuple__76;
+static PyObject *__pyx_tuple__78;
 static PyObject *__pyx_tuple__80;
-static PyObject *__pyx_tuple__82;
-static PyObject *__pyx_tuple__84;
+static PyObject *__pyx_tuple__81;
+static PyObject *__pyx_tuple__83;
 static PyObject *__pyx_tuple__85;
-static PyObject *__pyx_tuple__87;
-static PyObject *__pyx_tuple__89;
-static PyObject *__pyx_tuple__91;
-static PyObject *__pyx_tuple__93;
-static PyObject *__pyx_tuple__95;
-static PyObject *__pyx_tuple__97;
-static PyObject *__pyx_tuple__99;
+static PyObject *__pyx_tuple__86;
+static PyObject *__pyx_tuple__88;
+static PyObject *__pyx_tuple__90;
+static PyObject *__pyx_tuple__92;
+static PyObject *__pyx_tuple__94;
+static PyObject *__pyx_tuple__96;
+static PyObject *__pyx_tuple__98;
 static PyObject *__pyx_tuple__100;
 static PyObject *__pyx_tuple__101;
-static PyObject *__pyx_tuple__103;
-static PyObject *__pyx_tuple__105;
-static PyObject *__pyx_tuple__107;
-static PyObject *__pyx_tuple__109;
+static PyObject *__pyx_tuple__102;
+static PyObject *__pyx_tuple__104;
+static PyObject *__pyx_tuple__106;
+static PyObject *__pyx_tuple__108;
 static PyObject *__pyx_tuple__110;
-static PyObject *__pyx_tuple__112;
-static PyObject *__pyx_tuple__114;
-static PyObject *__pyx_tuple__116;
-static PyObject *__pyx_tuple__118;
-static PyObject *__pyx_tuple__120;
-static PyObject *__pyx_tuple__122;
+static PyObject *__pyx_tuple__111;
+static PyObject *__pyx_tuple__113;
+static PyObject *__pyx_tuple__115;
+static PyObject *__pyx_tuple__117;
+static PyObject *__pyx_tuple__119;
+static PyObject *__pyx_tuple__121;
 static PyObject *__pyx_tuple__123;
-static PyObject *__pyx_tuple__125;
-static PyObject *__pyx_tuple__127;
-static PyObject *__pyx_tuple__129;
+static PyObject *__pyx_tuple__124;
+static PyObject *__pyx_tuple__126;
+static PyObject *__pyx_tuple__128;
 static PyObject *__pyx_tuple__130;
 static PyObject *__pyx_tuple__131;
-static PyObject *__pyx_tuple__133;
-static PyObject *__pyx_tuple__135;
-static PyObject *__pyx_tuple__137;
-static PyObject *__pyx_tuple__139;
+static PyObject *__pyx_tuple__132;
+static PyObject *__pyx_tuple__134;
+static PyObject *__pyx_tuple__136;
+static PyObject *__pyx_tuple__138;
 static PyObject *__pyx_tuple__140;
-static PyObject *__pyx_tuple__142;
-static PyObject *__pyx_tuple__144;
-static PyObject *__pyx_tuple__146;
+static PyObject *__pyx_tuple__141;
+static PyObject *__pyx_tuple__143;
+static PyObject *__pyx_tuple__145;
 static PyObject *__pyx_tuple__147;
 static PyObject *__pyx_tuple__148;
 static PyObject *__pyx_tuple__150;
-static PyObject *__pyx_tuple__152;
+static PyObject *__pyx_tuple__151;
 static PyObject *__pyx_tuple__153;
-static PyObject *__pyx_tuple__155;
-static PyObject *__pyx_tuple__157;
+static PyObject *__pyx_tuple__154;
+static PyObject *__pyx_tuple__156;
 static PyObject *__pyx_tuple__158;
-static PyObject *__pyx_tuple__160;
-static PyObject *__pyx_tuple__162;
+static PyObject *__pyx_tuple__159;
+static PyObject *__pyx_tuple__161;
+static PyObject *__pyx_tuple__163;
 static PyObject *__pyx_tuple__164;
 static PyObject *__pyx_tuple__166;
-static PyObject *__pyx_tuple__167;
 static PyObject *__pyx_tuple__168;
-static PyObject *__pyx_tuple__170;
-static PyObject *__pyx_tuple__172;
-static PyObject *__pyx_tuple__174;
-static PyObject *__pyx_tuple__176;
+static PyObject *__pyx_tuple__169;
+static PyObject *__pyx_tuple__171;
+static PyObject *__pyx_tuple__173;
+static PyObject *__pyx_tuple__175;
 static PyObject *__pyx_tuple__177;
+static PyObject *__pyx_tuple__178;
 static PyObject *__pyx_tuple__179;
 static PyObject *__pyx_tuple__181;
 static PyObject *__pyx_tuple__183;
 static PyObject *__pyx_tuple__184;
 static PyObject *__pyx_tuple__186;
 static PyObject *__pyx_tuple__188;
 static PyObject *__pyx_tuple__189;
-static PyObject *__pyx_tuple__190;
 static PyObject *__pyx_tuple__191;
-static PyObject *__pyx_tuple__192;
 static PyObject *__pyx_tuple__193;
-static PyObject *__pyx_codeobj__22;
-static PyObject *__pyx_codeobj__25;
-static PyObject *__pyx_codeobj__27;
-static PyObject *__pyx_codeobj__29;
+static PyObject *__pyx_tuple__195;
+static PyObject *__pyx_tuple__196;
+static PyObject *__pyx_tuple__198;
+static PyObject *__pyx_tuple__200;
+static PyObject *__pyx_tuple__201;
+static PyObject *__pyx_tuple__202;
+static PyObject *__pyx_tuple__203;
+static PyObject *__pyx_tuple__204;
+static PyObject *__pyx_tuple__205;
+static PyObject *__pyx_codeobj__24;
+static PyObject *__pyx_codeobj__26;
+static PyObject *__pyx_codeobj__28;
 static PyObject *__pyx_codeobj__30;
 static PyObject *__pyx_codeobj__31;
+static PyObject *__pyx_codeobj__32;
 static PyObject *__pyx_codeobj__33;
 static PyObject *__pyx_codeobj__34;
 static PyObject *__pyx_codeobj__35;
-static PyObject *__pyx_codeobj__36;
+static PyObject *__pyx_codeobj__37;
 static PyObject *__pyx_codeobj__38;
-static PyObject *__pyx_codeobj__39;
+static PyObject *__pyx_codeobj__40;
 static PyObject *__pyx_codeobj__41;
-static PyObject *__pyx_codeobj__42;
-static PyObject *__pyx_codeobj__44;
-static PyObject *__pyx_codeobj__66;
-static PyObject *__pyx_codeobj__69;
-static PyObject *__pyx_codeobj__72;
-static PyObject *__pyx_codeobj__74;
-static PyObject *__pyx_codeobj__76;
-static PyObject *__pyx_codeobj__78;
-static PyObject *__pyx_codeobj__81;
-static PyObject *__pyx_codeobj__83;
-static PyObject *__pyx_codeobj__86;
-static PyObject *__pyx_codeobj__88;
-static PyObject *__pyx_codeobj__90;
-static PyObject *__pyx_codeobj__92;
-static PyObject *__pyx_codeobj__94;
-static PyObject *__pyx_codeobj__96;
-static PyObject *__pyx_codeobj__98;
-static PyObject *__pyx_codeobj__102;
-static PyObject *__pyx_codeobj__104;
-static PyObject *__pyx_codeobj__106;
-static PyObject *__pyx_codeobj__108;
-static PyObject *__pyx_codeobj__111;
-static PyObject *__pyx_codeobj__113;
-static PyObject *__pyx_codeobj__115;
-static PyObject *__pyx_codeobj__117;
-static PyObject *__pyx_codeobj__119;
-static PyObject *__pyx_codeobj__121;
-static PyObject *__pyx_codeobj__124;
-static PyObject *__pyx_codeobj__126;
-static PyObject *__pyx_codeobj__128;
-static PyObject *__pyx_codeobj__132;
-static PyObject *__pyx_codeobj__134;
-static PyObject *__pyx_codeobj__136;
-static PyObject *__pyx_codeobj__138;
-static PyObject *__pyx_codeobj__141;
-static PyObject *__pyx_codeobj__143;
-static PyObject *__pyx_codeobj__145;
+static PyObject *__pyx_codeobj__43;
+static PyObject *__pyx_codeobj__64;
+static PyObject *__pyx_codeobj__67;
+static PyObject *__pyx_codeobj__70;
+static PyObject *__pyx_codeobj__73;
+static PyObject *__pyx_codeobj__75;
+static PyObject *__pyx_codeobj__77;
+static PyObject *__pyx_codeobj__79;
+static PyObject *__pyx_codeobj__82;
+static PyObject *__pyx_codeobj__84;
+static PyObject *__pyx_codeobj__87;
+static PyObject *__pyx_codeobj__89;
+static PyObject *__pyx_codeobj__91;
+static PyObject *__pyx_codeobj__93;
+static PyObject *__pyx_codeobj__95;
+static PyObject *__pyx_codeobj__97;
+static PyObject *__pyx_codeobj__99;
+static PyObject *__pyx_codeobj__103;
+static PyObject *__pyx_codeobj__105;
+static PyObject *__pyx_codeobj__107;
+static PyObject *__pyx_codeobj__109;
+static PyObject *__pyx_codeobj__112;
+static PyObject *__pyx_codeobj__114;
+static PyObject *__pyx_codeobj__116;
+static PyObject *__pyx_codeobj__118;
+static PyObject *__pyx_codeobj__120;
+static PyObject *__pyx_codeobj__122;
+static PyObject *__pyx_codeobj__125;
+static PyObject *__pyx_codeobj__127;
+static PyObject *__pyx_codeobj__129;
+static PyObject *__pyx_codeobj__133;
+static PyObject *__pyx_codeobj__135;
+static PyObject *__pyx_codeobj__137;
+static PyObject *__pyx_codeobj__139;
+static PyObject *__pyx_codeobj__142;
+static PyObject *__pyx_codeobj__144;
+static PyObject *__pyx_codeobj__146;
 static PyObject *__pyx_codeobj__149;
-static PyObject *__pyx_codeobj__151;
-static PyObject *__pyx_codeobj__156;
-static PyObject *__pyx_codeobj__159;
-static PyObject *__pyx_codeobj__161;
-static PyObject *__pyx_codeobj__163;
-static PyObject *__pyx_codeobj__165;
-static PyObject *__pyx_codeobj__169;
-static PyObject *__pyx_codeobj__171;
-static PyObject *__pyx_codeobj__173;
-static PyObject *__pyx_codeobj__175;
-static PyObject *__pyx_codeobj__178;
+static PyObject *__pyx_codeobj__152;
+static PyObject *__pyx_codeobj__155;
+static PyObject *__pyx_codeobj__157;
+static PyObject *__pyx_codeobj__160;
+static PyObject *__pyx_codeobj__162;
+static PyObject *__pyx_codeobj__167;
+static PyObject *__pyx_codeobj__170;
+static PyObject *__pyx_codeobj__172;
+static PyObject *__pyx_codeobj__174;
+static PyObject *__pyx_codeobj__176;
 static PyObject *__pyx_codeobj__180;
 static PyObject *__pyx_codeobj__182;
 static PyObject *__pyx_codeobj__185;
 static PyObject *__pyx_codeobj__187;
+static PyObject *__pyx_codeobj__190;
+static PyObject *__pyx_codeobj__192;
 static PyObject *__pyx_codeobj__194;
+static PyObject *__pyx_codeobj__197;
+static PyObject *__pyx_codeobj__199;
+static PyObject *__pyx_codeobj__206;
 /* Late includes */
 
-/* "statmoments/_native.pyx":30
+/* "statmoments/_native.pyx":19
+ * USE_GPU = 0
+ * 
+ * def is_vtk_installed():             # <<<<<<<<<<<<<<
+ *   if not USE_VTK:
+ *     return False
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_11statmoments_7_native_1is_vtk_installed(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static PyMethodDef __pyx_mdef_11statmoments_7_native_1is_vtk_installed = {"is_vtk_installed", (PyCFunction)__pyx_pw_11statmoments_7_native_1is_vtk_installed, METH_NOARGS, 0};
+static PyObject *__pyx_pw_11statmoments_7_native_1is_vtk_installed(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("is_vtk_installed (wrapper)", 0);
+  __pyx_r = __pyx_pf_11statmoments_7_native_is_vtk_installed(__pyx_self);
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_11statmoments_7_native_is_vtk_installed(CYTHON_UNUSED PyObject *__pyx_self) {
+  CYTHON_UNUSED PyObject *__pyx_v_vtk = NULL;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  int __pyx_t_1;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  PyObject *__pyx_t_6 = NULL;
+  PyObject *__pyx_t_7 = NULL;
+  PyObject *__pyx_t_8 = NULL;
+  int __pyx_t_9;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("is_vtk_installed", 0);
+
+  /* "statmoments/_native.pyx":20
+ * 
+ * def is_vtk_installed():
+ *   if not USE_VTK:             # <<<<<<<<<<<<<<
+ *     return False
+ * 
+ */
+  __pyx_t_1 = ((!(__pyx_v_11statmoments_7_native_USE_VTK != 0)) != 0);
+  if (__pyx_t_1) {
+
+    /* "statmoments/_native.pyx":21
+ * def is_vtk_installed():
+ *   if not USE_VTK:
+ *     return False             # <<<<<<<<<<<<<<
+ * 
+ *   try:
+ */
+    __Pyx_XDECREF(__pyx_r);
+    __Pyx_INCREF(Py_False);
+    __pyx_r = Py_False;
+    goto __pyx_L0;
+
+    /* "statmoments/_native.pyx":20
+ * 
+ * def is_vtk_installed():
+ *   if not USE_VTK:             # <<<<<<<<<<<<<<
+ *     return False
+ * 
+ */
+  }
+
+  /* "statmoments/_native.pyx":23
+ *     return False
+ * 
+ *   try:             # <<<<<<<<<<<<<<
+ *     import vtk
+ *     print("VTK is installed and used")
+ */
+  {
+    __Pyx_PyThreadState_declare
+    __Pyx_PyThreadState_assign
+    __Pyx_ExceptionSave(&__pyx_t_2, &__pyx_t_3, &__pyx_t_4);
+    __Pyx_XGOTREF(__pyx_t_2);
+    __Pyx_XGOTREF(__pyx_t_3);
+    __Pyx_XGOTREF(__pyx_t_4);
+    /*try:*/ {
+
+      /* "statmoments/_native.pyx":24
+ * 
+ *   try:
+ *     import vtk             # <<<<<<<<<<<<<<
+ *     print("VTK is installed and used")
+ *     return True
+ */
+      __pyx_t_5 = __Pyx_Import(__pyx_n_s_vtk, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 24, __pyx_L4_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_v_vtk = __pyx_t_5;
+      __pyx_t_5 = 0;
+
+      /* "statmoments/_native.pyx":25
+ *   try:
+ *     import vtk
+ *     print("VTK is installed and used")             # <<<<<<<<<<<<<<
+ *     return True
+ *   except ModuleNotFoundError:
+ */
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple_, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 25, __pyx_L4_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+
+      /* "statmoments/_native.pyx":26
+ *     import vtk
+ *     print("VTK is installed and used")
+ *     return True             # <<<<<<<<<<<<<<
+ *   except ModuleNotFoundError:
+ *     print("VTK is not installed")
+ */
+      __Pyx_XDECREF(__pyx_r);
+      __Pyx_INCREF(Py_True);
+      __pyx_r = Py_True;
+      goto __pyx_L8_try_return;
+
+      /* "statmoments/_native.pyx":23
+ *     return False
+ * 
+ *   try:             # <<<<<<<<<<<<<<
+ *     import vtk
+ *     print("VTK is installed and used")
+ */
+    }
+    __pyx_L4_error:;
+    __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+
+    /* "statmoments/_native.pyx":27
+ *     print("VTK is installed and used")
+ *     return True
+ *   except ModuleNotFoundError:             # <<<<<<<<<<<<<<
+ *     print("VTK is not installed")
+ *     return False
+ */
+    __Pyx_ErrFetch(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7);
+    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_ModuleNotFoundError); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 27, __pyx_L6_except_error)
+    __Pyx_GOTREF(__pyx_t_8);
+    __pyx_t_9 = __Pyx_PyErr_GivenExceptionMatches(__pyx_t_5, __pyx_t_8);
+    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+    __Pyx_ErrRestore(__pyx_t_5, __pyx_t_6, __pyx_t_7);
+    __pyx_t_5 = 0; __pyx_t_6 = 0; __pyx_t_7 = 0;
+    if (__pyx_t_9) {
+      __Pyx_AddTraceback("statmoments._native.is_vtk_installed", __pyx_clineno, __pyx_lineno, __pyx_filename);
+      if (__Pyx_GetException(&__pyx_t_7, &__pyx_t_6, &__pyx_t_5) < 0) __PYX_ERR(0, 27, __pyx_L6_except_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __Pyx_GOTREF(__pyx_t_6);
+      __Pyx_GOTREF(__pyx_t_5);
+
+      /* "statmoments/_native.pyx":28
+ *     return True
+ *   except ModuleNotFoundError:
+ *     print("VTK is not installed")             # <<<<<<<<<<<<<<
+ *     return False
+ * 
+ */
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__2, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 28, __pyx_L6_except_error)
+      __Pyx_GOTREF(__pyx_t_8);
+      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+
+      /* "statmoments/_native.pyx":29
+ *   except ModuleNotFoundError:
+ *     print("VTK is not installed")
+ *     return False             # <<<<<<<<<<<<<<
+ * 
+ * #if USE_GPU:
+ */
+      __Pyx_XDECREF(__pyx_r);
+      __Pyx_INCREF(Py_False);
+      __pyx_r = Py_False;
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      goto __pyx_L7_except_return;
+    }
+    goto __pyx_L6_except_error;
+    __pyx_L6_except_error:;
+
+    /* "statmoments/_native.pyx":23
+ *     return False
+ * 
+ *   try:             # <<<<<<<<<<<<<<
+ *     import vtk
+ *     print("VTK is installed and used")
+ */
+    __Pyx_XGIVEREF(__pyx_t_2);
+    __Pyx_XGIVEREF(__pyx_t_3);
+    __Pyx_XGIVEREF(__pyx_t_4);
+    __Pyx_ExceptionReset(__pyx_t_2, __pyx_t_3, __pyx_t_4);
+    goto __pyx_L1_error;
+    __pyx_L8_try_return:;
+    __Pyx_XGIVEREF(__pyx_t_2);
+    __Pyx_XGIVEREF(__pyx_t_3);
+    __Pyx_XGIVEREF(__pyx_t_4);
+    __Pyx_ExceptionReset(__pyx_t_2, __pyx_t_3, __pyx_t_4);
+    goto __pyx_L0;
+    __pyx_L7_except_return:;
+    __Pyx_XGIVEREF(__pyx_t_2);
+    __Pyx_XGIVEREF(__pyx_t_3);
+    __Pyx_XGIVEREF(__pyx_t_4);
+    __Pyx_ExceptionReset(__pyx_t_2, __pyx_t_3, __pyx_t_4);
+    goto __pyx_L0;
+  }
+
+  /* "statmoments/_native.pyx":19
+ * USE_GPU = 0
+ * 
+ * def is_vtk_installed():             # <<<<<<<<<<<<<<
+ *   if not USE_VTK:
+ *     return False
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_AddTraceback("statmoments._native.is_vtk_installed", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XDECREF(__pyx_v_vtk);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "statmoments/_native.pyx":42
  * @cython.returns(cython.void)
- * @cython.locals(da = cython.double, dx = 'double[::1]')
+ * @cython.locals(da=cython.double, dx='double[::1]')
  * def dscal(da, dx):             # <<<<<<<<<<<<<<
  *   """ dx *= da """
- *   cython.declare(n = cython.int, incx = cython.int)
+ *   cython.declare(n=cython.int, incx=cython.int)
  */
 
 static CYTHON_INLINE void __pyx_f_11statmoments_7_native_dscal(double __pyx_v_da, __Pyx_memviewslice __pyx_v_dx) {
   int __pyx_v_n;
   int __pyx_v_incx;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
@@ -4373,82 +4681,82 @@
   int __pyx_t_10;
   PyObject *__pyx_t_11 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("dscal", 0);
 
-  /* "statmoments/_native.pyx":33
+  /* "statmoments/_native.pyx":45
  *   """ dx *= da """
- *   cython.declare(n = cython.int, incx = cython.int)
+ *   cython.declare(n=cython.int, incx=cython.int)
  *   n = cython.cast(cython.int, dx.shape[0])             # <<<<<<<<<<<<<<
  *   incx = 1
  *   if cython.compiled:
  */
   __pyx_v_n = ((int)(__pyx_v_dx.shape[0]));
 
-  /* "statmoments/_native.pyx":34
- *   cython.declare(n = cython.int, incx = cython.int)
+  /* "statmoments/_native.pyx":46
+ *   cython.declare(n=cython.int, incx=cython.int)
  *   n = cython.cast(cython.int, dx.shape[0])
  *   incx = 1             # <<<<<<<<<<<<<<
  *   if cython.compiled:
  *     cython_blas.dscal(cython.address(n), cython.address(da), cython.address(dx[0]), cython.address(incx))
  */
   __pyx_v_incx = 1;
 
-  /* "statmoments/_native.pyx":35
+  /* "statmoments/_native.pyx":47
  *   n = cython.cast(cython.int, dx.shape[0])
  *   incx = 1
  *   if cython.compiled:             # <<<<<<<<<<<<<<
  *     cython_blas.dscal(cython.address(n), cython.address(da), cython.address(dx[0]), cython.address(incx))
  *   else:
  */
   __pyx_t_1 = (1 != 0);
   if (__pyx_t_1) {
 
-    /* "statmoments/_native.pyx":36
+    /* "statmoments/_native.pyx":48
  *   incx = 1
  *   if cython.compiled:
  *     cython_blas.dscal(cython.address(n), cython.address(da), cython.address(dx[0]), cython.address(incx))             # <<<<<<<<<<<<<<
  *   else:
  *     scipy_blas.dscal(da, dx, n, 0, incx)
  */
     __pyx_t_2 = 0;
     __pyx_f_5scipy_6linalg_11cython_blas_dscal((&__pyx_v_n), (&__pyx_v_da), (&(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_dx.data) + __pyx_t_2)) )))), (&__pyx_v_incx));
 
-    /* "statmoments/_native.pyx":35
+    /* "statmoments/_native.pyx":47
  *   n = cython.cast(cython.int, dx.shape[0])
  *   incx = 1
  *   if cython.compiled:             # <<<<<<<<<<<<<<
  *     cython_blas.dscal(cython.address(n), cython.address(da), cython.address(dx[0]), cython.address(incx))
  *   else:
  */
     goto __pyx_L3;
   }
 
-  /* "statmoments/_native.pyx":38
+  /* "statmoments/_native.pyx":50
  *     cython_blas.dscal(cython.address(n), cython.address(da), cython.address(dx[0]), cython.address(incx))
  *   else:
  *     scipy_blas.dscal(da, dx, n, 0, incx)             # <<<<<<<<<<<<<<
  * 
  * @cython.cfunc
  */
   /*else*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_scipy_blas); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 38, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_scipy_blas); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 50, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_dscal); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 38, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_dscal); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 50, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_da); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 38, __pyx_L1_error)
+    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_da); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 50, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_dx, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 38, __pyx_L1_error)
+    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_dx, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 50, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_n); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 38, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_n); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 50, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_incx); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 38, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_incx); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 50, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_9 = NULL;
     __pyx_t_10 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_9)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
@@ -4457,37 +4765,37 @@
         __Pyx_DECREF_SET(__pyx_t_5, function);
         __pyx_t_10 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_5)) {
       PyObject *__pyx_temp[6] = {__pyx_t_9, __pyx_t_4, __pyx_t_6, __pyx_t_7, __pyx_int_0, __pyx_t_8};
-      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 5+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 38, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 5+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 50, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
       PyObject *__pyx_temp[6] = {__pyx_t_9, __pyx_t_4, __pyx_t_6, __pyx_t_7, __pyx_int_0, __pyx_t_8};
-      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 5+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 38, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 5+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 50, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     } else
     #endif
     {
-      __pyx_t_11 = PyTuple_New(5+__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 38, __pyx_L1_error)
+      __pyx_t_11 = PyTuple_New(5+__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 50, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       if (__pyx_t_9) {
         __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_9); __pyx_t_9 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_4);
       PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_10, __pyx_t_4);
       __Pyx_GIVEREF(__pyx_t_6);
@@ -4499,29 +4807,29 @@
       PyTuple_SET_ITEM(__pyx_t_11, 3+__pyx_t_10, __pyx_int_0);
       __Pyx_GIVEREF(__pyx_t_8);
       PyTuple_SET_ITEM(__pyx_t_11, 4+__pyx_t_10, __pyx_t_8);
       __pyx_t_4 = 0;
       __pyx_t_6 = 0;
       __pyx_t_7 = 0;
       __pyx_t_8 = 0;
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_11, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 38, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_11, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 50, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __pyx_L3:;
 
-  /* "statmoments/_native.pyx":30
+  /* "statmoments/_native.pyx":42
  * @cython.returns(cython.void)
- * @cython.locals(da = cython.double, dx = 'double[::1]')
+ * @cython.locals(da=cython.double, dx='double[::1]')
  * def dscal(da, dx):             # <<<<<<<<<<<<<<
  *   """ dx *= da """
- *   cython.declare(n = cython.int, incx = cython.int)
+ *   cython.declare(n=cython.int, incx=cython.int)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
@@ -4532,20 +4840,20 @@
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_XDECREF(__pyx_t_11);
   __Pyx_WriteUnraisable("statmoments._native.dscal", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
 }
 
-/* "statmoments/_native.pyx":44
+/* "statmoments/_native.pyx":56
  * @cython.returns(cython.void)
- * @cython.locals(a = 'double[::1]', b = 'double[::1]', da = cython.double)
+ * @cython.locals(a='double[::1]', b='double[::1]', da=cython.double)
  * def daxpy(a, b, da=1.0):             # <<<<<<<<<<<<<<
  *   """ b += da * a """
- *   cython.declare(n = cython.int, incx = cython.int)
+ *   cython.declare(n=cython.int, incx=cython.int)
  */
 
 static CYTHON_INLINE void __pyx_f_11statmoments_7_native_daxpy(__Pyx_memviewslice __pyx_v_a, __Pyx_memviewslice __pyx_v_b, struct __pyx_opt_args_11statmoments_7_native_daxpy *__pyx_optional_args) {
   double __pyx_v_da = ((double)1.0);
   int __pyx_v_n;
   int __pyx_v_incx;
   __Pyx_RefNannyDeclarations
@@ -4570,98 +4878,98 @@
   __Pyx_RefNannySetupContext("daxpy", 0);
   if (__pyx_optional_args) {
     if (__pyx_optional_args->__pyx_n > 0) {
       __pyx_v_da = __pyx_optional_args->da;
     }
   }
 
-  /* "statmoments/_native.pyx":47
+  /* "statmoments/_native.pyx":59
  *   """ b += da * a """
- *   cython.declare(n = cython.int, incx = cython.int)
+ *   cython.declare(n=cython.int, incx=cython.int)
  *   incx = 1             # <<<<<<<<<<<<<<
  *   n = cython.cast(cython.int, min(a.shape[0], b.shape[0]))
  * 
  */
   __pyx_v_incx = 1;
 
-  /* "statmoments/_native.pyx":48
- *   cython.declare(n = cython.int, incx = cython.int)
+  /* "statmoments/_native.pyx":60
+ *   cython.declare(n=cython.int, incx=cython.int)
  *   incx = 1
  *   n = cython.cast(cython.int, min(a.shape[0], b.shape[0]))             # <<<<<<<<<<<<<<
  * 
  *   if cython.compiled:
  */
   __pyx_t_1 = (__pyx_v_b.shape[0]);
   __pyx_t_2 = (__pyx_v_a.shape[0]);
   if (((__pyx_t_1 < __pyx_t_2) != 0)) {
     __pyx_t_3 = __pyx_t_1;
   } else {
     __pyx_t_3 = __pyx_t_2;
   }
   __pyx_v_n = ((int)__pyx_t_3);
 
-  /* "statmoments/_native.pyx":50
+  /* "statmoments/_native.pyx":62
  *   n = cython.cast(cython.int, min(a.shape[0], b.shape[0]))
  * 
  *   if cython.compiled:             # <<<<<<<<<<<<<<
  *     cython_blas.daxpy(cython.address(n), cython.address(da),
- *       cython.address(a[0]), cython.address(incx), cython.address(b[0]), cython.address(incx))
+ *                       cython.address(a[0]), cython.address(incx), cython.address(b[0]), cython.address(incx))
  */
   __pyx_t_4 = (1 != 0);
   if (__pyx_t_4) {
 
-    /* "statmoments/_native.pyx":52
+    /* "statmoments/_native.pyx":64
  *   if cython.compiled:
  *     cython_blas.daxpy(cython.address(n), cython.address(da),
- *       cython.address(a[0]), cython.address(incx), cython.address(b[0]), cython.address(incx))             # <<<<<<<<<<<<<<
+ *                       cython.address(a[0]), cython.address(incx), cython.address(b[0]), cython.address(incx))             # <<<<<<<<<<<<<<
  *   else:
  *     scipy_blas.daxpy(a, b, n, da)
  */
     __pyx_t_5 = 0;
     __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":51
+    /* "statmoments/_native.pyx":63
  * 
  *   if cython.compiled:
  *     cython_blas.daxpy(cython.address(n), cython.address(da),             # <<<<<<<<<<<<<<
- *       cython.address(a[0]), cython.address(incx), cython.address(b[0]), cython.address(incx))
+ *                       cython.address(a[0]), cython.address(incx), cython.address(b[0]), cython.address(incx))
  *   else:
  */
     __pyx_f_5scipy_6linalg_11cython_blas_daxpy((&__pyx_v_n), (&__pyx_v_da), (&(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a.data) + __pyx_t_5)) )))), (&__pyx_v_incx), (&(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b.data) + __pyx_t_6)) )))), (&__pyx_v_incx));
 
-    /* "statmoments/_native.pyx":50
+    /* "statmoments/_native.pyx":62
  *   n = cython.cast(cython.int, min(a.shape[0], b.shape[0]))
  * 
  *   if cython.compiled:             # <<<<<<<<<<<<<<
  *     cython_blas.daxpy(cython.address(n), cython.address(da),
- *       cython.address(a[0]), cython.address(incx), cython.address(b[0]), cython.address(incx))
+ *                       cython.address(a[0]), cython.address(incx), cython.address(b[0]), cython.address(incx))
  */
     goto __pyx_L3;
   }
 
-  /* "statmoments/_native.pyx":54
- *       cython.address(a[0]), cython.address(incx), cython.address(b[0]), cython.address(incx))
+  /* "statmoments/_native.pyx":66
+ *                       cython.address(a[0]), cython.address(incx), cython.address(b[0]), cython.address(incx))
  *   else:
  *     scipy_blas.daxpy(a, b, n, da)             # <<<<<<<<<<<<<<
  * 
  * @cython.cfunc
  */
   /*else*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_scipy_blas); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 54, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_scipy_blas); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 66, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_daxpy); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 54, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_daxpy); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 66, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_a, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 54, __pyx_L1_error)
+    __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_a, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 66, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_b, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 54, __pyx_L1_error)
+    __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_b, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 66, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_11 = __Pyx_PyInt_From_int(__pyx_v_n); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 54, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyInt_From_int(__pyx_v_n); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 66, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_12 = PyFloat_FromDouble(__pyx_v_da); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 54, __pyx_L1_error)
+    __pyx_t_12 = PyFloat_FromDouble(__pyx_v_da); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 66, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __pyx_t_13 = NULL;
     __pyx_t_14 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
       __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_9);
       if (likely(__pyx_t_13)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
@@ -4670,37 +4978,37 @@
         __Pyx_DECREF_SET(__pyx_t_9, function);
         __pyx_t_14 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_9)) {
       PyObject *__pyx_temp[5] = {__pyx_t_13, __pyx_t_8, __pyx_t_10, __pyx_t_11, __pyx_t_12};
-      __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_14, 4+__pyx_t_14); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 54, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_14, 4+__pyx_t_14); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 66, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
       PyObject *__pyx_temp[5] = {__pyx_t_13, __pyx_t_8, __pyx_t_10, __pyx_t_11, __pyx_t_12};
-      __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_14, 4+__pyx_t_14); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 54, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_14, 4+__pyx_t_14); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 66, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     } else
     #endif
     {
-      __pyx_t_15 = PyTuple_New(4+__pyx_t_14); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 54, __pyx_L1_error)
+      __pyx_t_15 = PyTuple_New(4+__pyx_t_14); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 66, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_15);
       if (__pyx_t_13) {
         __Pyx_GIVEREF(__pyx_t_13); PyTuple_SET_ITEM(__pyx_t_15, 0, __pyx_t_13); __pyx_t_13 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_8);
       PyTuple_SET_ITEM(__pyx_t_15, 0+__pyx_t_14, __pyx_t_8);
       __Pyx_GIVEREF(__pyx_t_10);
@@ -4709,29 +5017,29 @@
       PyTuple_SET_ITEM(__pyx_t_15, 2+__pyx_t_14, __pyx_t_11);
       __Pyx_GIVEREF(__pyx_t_12);
       PyTuple_SET_ITEM(__pyx_t_15, 3+__pyx_t_14, __pyx_t_12);
       __pyx_t_8 = 0;
       __pyx_t_10 = 0;
       __pyx_t_11 = 0;
       __pyx_t_12 = 0;
-      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_15, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 54, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_15, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 66, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     }
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   }
   __pyx_L3:;
 
-  /* "statmoments/_native.pyx":44
+  /* "statmoments/_native.pyx":56
  * @cython.returns(cython.void)
- * @cython.locals(a = 'double[::1]', b = 'double[::1]', da = cython.double)
+ * @cython.locals(a='double[::1]', b='double[::1]', da=cython.double)
  * def daxpy(a, b, da=1.0):             # <<<<<<<<<<<<<<
  *   """ b += da * a """
- *   cython.declare(n = cython.int, incx = cython.int)
+ *   cython.declare(n=cython.int, incx=cython.int)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_8);
@@ -4742,20 +5050,20 @@
   __Pyx_XDECREF(__pyx_t_13);
   __Pyx_XDECREF(__pyx_t_15);
   __Pyx_WriteUnraisable("statmoments._native.daxpy", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
 }
 
-/* "statmoments/_native.pyx":61
- * @cython.locals(A = 'double[::1]', x = 'double[::1]', y = 'double[::1]', alpha = cython.double, beta = cython.double,
- *                uplo = cython.char, k = cython.int, lda = cython.int, incx = cython.int, incy = cython.int)
+/* "statmoments/_native.pyx":73
+ * @cython.locals(A='double[::1]', x='double[::1]', y='double[::1]', alpha=cython.double, beta=cython.double,
+ *                uplo=cython.char, k=cython.int, lda=cython.int, incx=cython.int, incy=cython.int)
  * def dsbmv(A, x, y, alpha = 1.0, beta = 0.0, uplo = b'L', k = 0, lda = 1, incx = 1, incy = 1):             # <<<<<<<<<<<<<<
  *   """ y := alpha*A*x + beta*y """
- *   cython.declare(n = cython.int)
+ *   cython.declare(n=cython.int)
  */
 
 static CYTHON_INLINE void __pyx_f_11statmoments_7_native_dsbmv(__Pyx_memviewslice __pyx_v_A, __Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y, struct __pyx_opt_args_11statmoments_7_native_dsbmv *__pyx_optional_args) {
   double __pyx_v_alpha = ((double)1.0);
   double __pyx_v_beta = ((double)0.0);
   char __pyx_v_uplo = ((char)'L');
   int __pyx_v_k = ((int)0);
@@ -4811,17 +5119,17 @@
           }
         }
       }
     }
   }
   __PYX_INC_MEMVIEW(&__pyx_v_A, 1);
 
-  /* "statmoments/_native.pyx":64
+  /* "statmoments/_native.pyx":76
  *   """ y := alpha*A*x + beta*y """
- *   cython.declare(n = cython.int)
+ *   cython.declare(n=cython.int)
  *   n = cython.cast(cython.int, min(A.shape[0], x.shape[0], y.shape[0]))             # <<<<<<<<<<<<<<
  *   # lda = A.shape[1]
  * 
  */
   __pyx_t_1 = (__pyx_v_x.shape[0]);
   __pyx_t_2 = (__pyx_v_y.shape[0]);
   __pyx_t_3 = (__pyx_v_A.shape[0]);
@@ -4834,77 +5142,85 @@
   if (((__pyx_t_2 < __pyx_t_3) != 0)) {
     __pyx_t_4 = __pyx_t_2;
   } else {
     __pyx_t_4 = __pyx_t_3;
   }
   __pyx_v_n = ((int)__pyx_t_4);
 
-  /* "statmoments/_native.pyx":67
+  /* "statmoments/_native.pyx":79
  *   # lda = A.shape[1]
  * 
  *   if cython.compiled:             # <<<<<<<<<<<<<<
  *     cython_blas.dsbmv(cython.address(uplo), cython.address(n), cython.address(k),
- *       cython.address(alpha), cython.address(A[0]), cython.address(lda), cython.address(x[0]), cython.address(incx),
+ *                       cython.address(alpha), cython.address(A[0]), cython.address(lda),
  */
   __pyx_t_5 = (1 != 0);
   if (__pyx_t_5) {
 
-    /* "statmoments/_native.pyx":69
+    /* "statmoments/_native.pyx":81
  *   if cython.compiled:
  *     cython_blas.dsbmv(cython.address(uplo), cython.address(n), cython.address(k),
- *       cython.address(alpha), cython.address(A[0]), cython.address(lda), cython.address(x[0]), cython.address(incx),             # <<<<<<<<<<<<<<
- *       cython.address(beta), cython.address(y[0]), cython.address(incy))
- *   else:
+ *                       cython.address(alpha), cython.address(A[0]), cython.address(lda),             # <<<<<<<<<<<<<<
+ *                       cython.address(x[0]), cython.address(incx),
+ *                       cython.address(beta), cython.address(y[0]), cython.address(incy))
  */
     __pyx_t_6 = 0;
-    __pyx_t_7 = 0;
 
-    /* "statmoments/_native.pyx":70
+    /* "statmoments/_native.pyx":82
  *     cython_blas.dsbmv(cython.address(uplo), cython.address(n), cython.address(k),
- *       cython.address(alpha), cython.address(A[0]), cython.address(lda), cython.address(x[0]), cython.address(incx),
- *       cython.address(beta), cython.address(y[0]), cython.address(incy))             # <<<<<<<<<<<<<<
+ *                       cython.address(alpha), cython.address(A[0]), cython.address(lda),
+ *                       cython.address(x[0]), cython.address(incx),             # <<<<<<<<<<<<<<
+ *                       cython.address(beta), cython.address(y[0]), cython.address(incy))
+ *   else:
+ */
+    __pyx_t_7 = 0;
+
+    /* "statmoments/_native.pyx":83
+ *                       cython.address(alpha), cython.address(A[0]), cython.address(lda),
+ *                       cython.address(x[0]), cython.address(incx),
+ *                       cython.address(beta), cython.address(y[0]), cython.address(incy))             # <<<<<<<<<<<<<<
  *   else:
  *     A = A.reshape(len(A), -1)
  */
     __pyx_t_8 = 0;
 
-    /* "statmoments/_native.pyx":68
+    /* "statmoments/_native.pyx":80
  * 
  *   if cython.compiled:
  *     cython_blas.dsbmv(cython.address(uplo), cython.address(n), cython.address(k),             # <<<<<<<<<<<<<<
- *       cython.address(alpha), cython.address(A[0]), cython.address(lda), cython.address(x[0]), cython.address(incx),
- *       cython.address(beta), cython.address(y[0]), cython.address(incy))
+ *                       cython.address(alpha), cython.address(A[0]), cython.address(lda),
+ *                       cython.address(x[0]), cython.address(incx),
  */
     __pyx_f_5scipy_6linalg_11cython_blas_dsbmv((&__pyx_v_uplo), (&__pyx_v_n), (&__pyx_v_k), (&__pyx_v_alpha), (&(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_A.data) + __pyx_t_6)) )))), (&__pyx_v_lda), (&(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x.data) + __pyx_t_7)) )))), (&__pyx_v_incx), (&__pyx_v_beta), (&(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_y.data) + __pyx_t_8)) )))), (&__pyx_v_incy));
 
-    /* "statmoments/_native.pyx":67
+    /* "statmoments/_native.pyx":79
  *   # lda = A.shape[1]
  * 
  *   if cython.compiled:             # <<<<<<<<<<<<<<
  *     cython_blas.dsbmv(cython.address(uplo), cython.address(n), cython.address(k),
- *       cython.address(alpha), cython.address(A[0]), cython.address(lda), cython.address(x[0]), cython.address(incx),
+ *                       cython.address(alpha), cython.address(A[0]), cython.address(lda),
  */
     goto __pyx_L3;
   }
 
-  /* "statmoments/_native.pyx":72
- *       cython.address(beta), cython.address(y[0]), cython.address(incy))
+  /* "statmoments/_native.pyx":85
+ *                       cython.address(beta), cython.address(y[0]), cython.address(incy))
  *   else:
  *     A = A.reshape(len(A), -1)             # <<<<<<<<<<<<<<
  *     scipy_blas.dsbmv(k, alpha, A.T, x, 1, 0, beta, y, 1, 0, 1 if uplo == b'L' else 0, 1)
  * 
  */
   /*else*/ {
-    __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_A, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 72, __pyx_L1_error)
+    __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_A, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 85, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_reshape); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 72, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_reshape); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 85, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __pyx_t_12 = __Pyx_MemoryView_Len(__pyx_v_A); 
-    __pyx_t_10 = __Pyx_PyInt_FromSize_t(__pyx_t_12); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 72, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyInt_FromSize_t(__pyx_t_12); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 85, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __pyx_t_13 = NULL;
     __pyx_t_14 = 0;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
       __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_11);
       if (likely(__pyx_t_13)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
@@ -4913,82 +5229,82 @@
         __Pyx_DECREF_SET(__pyx_t_11, function);
         __pyx_t_14 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_11)) {
       PyObject *__pyx_temp[3] = {__pyx_t_13, __pyx_t_10, __pyx_int_neg_1};
-      __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_14, 2+__pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 72, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_14, 2+__pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 85, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_11)) {
       PyObject *__pyx_temp[3] = {__pyx_t_13, __pyx_t_10, __pyx_int_neg_1};
-      __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_14, 2+__pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 72, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_14, 2+__pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 85, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     } else
     #endif
     {
-      __pyx_t_15 = PyTuple_New(2+__pyx_t_14); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 72, __pyx_L1_error)
+      __pyx_t_15 = PyTuple_New(2+__pyx_t_14); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 85, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_15);
       if (__pyx_t_13) {
         __Pyx_GIVEREF(__pyx_t_13); PyTuple_SET_ITEM(__pyx_t_15, 0, __pyx_t_13); __pyx_t_13 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_10);
       PyTuple_SET_ITEM(__pyx_t_15, 0+__pyx_t_14, __pyx_t_10);
       __Pyx_INCREF(__pyx_int_neg_1);
       __Pyx_GIVEREF(__pyx_int_neg_1);
       PyTuple_SET_ITEM(__pyx_t_15, 1+__pyx_t_14, __pyx_int_neg_1);
       __pyx_t_10 = 0;
-      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_15, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 72, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_15, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 85, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     }
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_9, PyBUF_WRITABLE); if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 72, __pyx_L1_error)
+    __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_9, PyBUF_WRITABLE); if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 85, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_A, 1);
     __pyx_v_A = __pyx_t_16;
     __pyx_t_16.memview = NULL;
     __pyx_t_16.data = NULL;
 
-    /* "statmoments/_native.pyx":73
+    /* "statmoments/_native.pyx":86
  *   else:
  *     A = A.reshape(len(A), -1)
  *     scipy_blas.dsbmv(k, alpha, A.T, x, 1, 0, beta, y, 1, 0, 1 if uplo == b'L' else 0, 1)             # <<<<<<<<<<<<<<
  * 
  * @cython.cfunc
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_scipy_blas); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 73, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_scipy_blas); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 86, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_dsbmv); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 73, __pyx_L1_error)
+    __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_dsbmv); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 86, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    __pyx_t_11 = __Pyx_PyInt_From_int(__pyx_v_k); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 73, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyInt_From_int(__pyx_v_k); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 86, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_10 = PyFloat_FromDouble(__pyx_v_alpha); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 73, __pyx_L1_error)
+    __pyx_t_10 = PyFloat_FromDouble(__pyx_v_alpha); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 86, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __pyx_t_16 = __pyx_v_A;
     __PYX_INC_MEMVIEW(&__pyx_t_16, 1);
-    if (unlikely(__pyx_memslice_transpose(&__pyx_t_16) == 0)) __PYX_ERR(0, 73, __pyx_L1_error)
-    __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_t_16, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 73, __pyx_L1_error)
+    if (unlikely(__pyx_memslice_transpose(&__pyx_t_16) == 0)) __PYX_ERR(0, 86, __pyx_L1_error)
+    __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_t_16, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 86, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __PYX_XDEC_MEMVIEW(&__pyx_t_16, 1);
     __pyx_t_16.memview = NULL;
     __pyx_t_16.data = NULL;
-    __pyx_t_17 = __pyx_memoryview_fromslice(__pyx_v_x, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 73, __pyx_L1_error)
+    __pyx_t_17 = __pyx_memoryview_fromslice(__pyx_v_x, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 86, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_17);
-    __pyx_t_18 = PyFloat_FromDouble(__pyx_v_beta); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 73, __pyx_L1_error)
+    __pyx_t_18 = PyFloat_FromDouble(__pyx_v_beta); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 86, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_18);
-    __pyx_t_19 = __pyx_memoryview_fromslice(__pyx_v_y, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 73, __pyx_L1_error)
+    __pyx_t_19 = __pyx_memoryview_fromslice(__pyx_v_y, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 86, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_19);
     if (((__pyx_v_uplo == 'L') != 0)) {
       __Pyx_INCREF(__pyx_int_1);
       __pyx_t_20 = __pyx_int_1;
     } else {
       __Pyx_INCREF(__pyx_int_0);
       __pyx_t_20 = __pyx_int_0;
@@ -5004,43 +5320,43 @@
         __Pyx_DECREF_SET(__pyx_t_15, function);
         __pyx_t_14 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_15)) {
       PyObject *__pyx_temp[13] = {__pyx_t_21, __pyx_t_11, __pyx_t_10, __pyx_t_13, __pyx_t_17, __pyx_int_1, __pyx_int_0, __pyx_t_18, __pyx_t_19, __pyx_int_1, __pyx_int_0, __pyx_t_20, __pyx_int_1};
-      __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_15, __pyx_temp+1-__pyx_t_14, 12+__pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 73, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_15, __pyx_temp+1-__pyx_t_14, 12+__pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 86, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_21); __pyx_t_21 = 0;
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
       __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
       __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
       __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_15)) {
       PyObject *__pyx_temp[13] = {__pyx_t_21, __pyx_t_11, __pyx_t_10, __pyx_t_13, __pyx_t_17, __pyx_int_1, __pyx_int_0, __pyx_t_18, __pyx_t_19, __pyx_int_1, __pyx_int_0, __pyx_t_20, __pyx_int_1};
-      __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_15, __pyx_temp+1-__pyx_t_14, 12+__pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 73, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_15, __pyx_temp+1-__pyx_t_14, 12+__pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 86, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_21); __pyx_t_21 = 0;
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
       __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
       __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
       __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
     } else
     #endif
     {
-      __pyx_t_22 = PyTuple_New(12+__pyx_t_14); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 73, __pyx_L1_error)
+      __pyx_t_22 = PyTuple_New(12+__pyx_t_14); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 86, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_22);
       if (__pyx_t_21) {
         __Pyx_GIVEREF(__pyx_t_21); PyTuple_SET_ITEM(__pyx_t_22, 0, __pyx_t_21); __pyx_t_21 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_11);
       PyTuple_SET_ITEM(__pyx_t_22, 0+__pyx_t_14, __pyx_t_11);
       __Pyx_GIVEREF(__pyx_t_10);
@@ -5073,29 +5389,29 @@
       __pyx_t_11 = 0;
       __pyx_t_10 = 0;
       __pyx_t_13 = 0;
       __pyx_t_17 = 0;
       __pyx_t_18 = 0;
       __pyx_t_19 = 0;
       __pyx_t_20 = 0;
-      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_15, __pyx_t_22, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 73, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_15, __pyx_t_22, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 86, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
     }
     __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   }
   __pyx_L3:;
 
-  /* "statmoments/_native.pyx":61
- * @cython.locals(A = 'double[::1]', x = 'double[::1]', y = 'double[::1]', alpha = cython.double, beta = cython.double,
- *                uplo = cython.char, k = cython.int, lda = cython.int, incx = cython.int, incy = cython.int)
+  /* "statmoments/_native.pyx":73
+ * @cython.locals(A='double[::1]', x='double[::1]', y='double[::1]', alpha=cython.double, beta=cython.double,
+ *                uplo=cython.char, k=cython.int, lda=cython.int, incx=cython.int, incy=cython.int)
  * def dsbmv(A, x, y, alpha = 1.0, beta = 0.0, uplo = b'L', k = 0, lda = 1, incx = 1, incy = 1):             # <<<<<<<<<<<<<<
  *   """ y := alpha*A*x + beta*y """
- *   cython.declare(n = cython.int)
+ *   cython.declare(n=cython.int)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_XDECREF(__pyx_t_10);
@@ -5111,20 +5427,20 @@
   __Pyx_XDECREF(__pyx_t_22);
   __Pyx_WriteUnraisable("statmoments._native.dsbmv", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_A, 1);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "statmoments/_native.pyx":80
- * @cython.locals(A = 'double[:,::1]', x = 'double[::1]', y = 'double[::1]', alpha = cython.double,
- *                incx = cython.int, incy = cython.int)
+/* "statmoments/_native.pyx":93
+ * @cython.locals(A='double[:,::1]', x='double[::1]', y='double[::1]', alpha=cython.double,
+ *                incx=cython.int, incy=cython.int)
  * def dger(A, x, y, alpha=1.0, incx = 1, incy = 1):             # <<<<<<<<<<<<<<
- *     """ A := alpha*x*trans(y) + A """
- *     cython.declare(m = cython.int, n = cython.int)
+ *   """ A := alpha*x*trans(y) + A """
+ *   cython.declare(m=cython.int, n=cython.int)
  */
 
 static CYTHON_INLINE void __pyx_f_11statmoments_7_native_dger(__Pyx_memviewslice __pyx_v_A, __Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y, struct __pyx_opt_args_11statmoments_7_native_dger *__pyx_optional_args) {
   double __pyx_v_alpha = ((double)1.0);
   int __pyx_v_incx = ((int)1);
   int __pyx_v_incy = ((int)1);
   int __pyx_v_m;
@@ -5162,96 +5478,96 @@
           __pyx_v_incy = __pyx_optional_args->incy;
         }
       }
     }
   }
   __PYX_INC_MEMVIEW(&__pyx_v_A, 1);
 
-  /* "statmoments/_native.pyx":83
- *     """ A := alpha*x*trans(y) + A """
- *     cython.declare(m = cython.int, n = cython.int)
- *     m = cython.cast(cython.int, A.shape[0])             # <<<<<<<<<<<<<<
- *     n = cython.cast(cython.int, A.shape[1])
- *     if cython.compiled:
+  /* "statmoments/_native.pyx":96
+ *   """ A := alpha*x*trans(y) + A """
+ *   cython.declare(m=cython.int, n=cython.int)
+ *   m = cython.cast(cython.int, A.shape[0])             # <<<<<<<<<<<<<<
+ *   n = cython.cast(cython.int, A.shape[1])
+ *   if cython.compiled:
  */
   __pyx_v_m = ((int)(__pyx_v_A.shape[0]));
 
-  /* "statmoments/_native.pyx":84
- *     cython.declare(m = cython.int, n = cython.int)
- *     m = cython.cast(cython.int, A.shape[0])
- *     n = cython.cast(cython.int, A.shape[1])             # <<<<<<<<<<<<<<
- *     if cython.compiled:
- *       cython_blas.dger(cython.address(n), cython.address(m),
+  /* "statmoments/_native.pyx":97
+ *   cython.declare(m=cython.int, n=cython.int)
+ *   m = cython.cast(cython.int, A.shape[0])
+ *   n = cython.cast(cython.int, A.shape[1])             # <<<<<<<<<<<<<<
+ *   if cython.compiled:
+ *     cython_blas.dger(cython.address(n), cython.address(m),
  */
   __pyx_v_n = ((int)(__pyx_v_A.shape[1]));
 
-  /* "statmoments/_native.pyx":85
- *     m = cython.cast(cython.int, A.shape[0])
- *     n = cython.cast(cython.int, A.shape[1])
- *     if cython.compiled:             # <<<<<<<<<<<<<<
- *       cython_blas.dger(cython.address(n), cython.address(m),
- *         cython.address(alpha), cython.address(y[0]), cython.address(incy),
+  /* "statmoments/_native.pyx":98
+ *   m = cython.cast(cython.int, A.shape[0])
+ *   n = cython.cast(cython.int, A.shape[1])
+ *   if cython.compiled:             # <<<<<<<<<<<<<<
+ *     cython_blas.dger(cython.address(n), cython.address(m),
+ *                      cython.address(alpha), cython.address(y[0]), cython.address(incy),
  */
   __pyx_t_1 = (1 != 0);
   if (__pyx_t_1) {
 
-    /* "statmoments/_native.pyx":87
- *     if cython.compiled:
- *       cython_blas.dger(cython.address(n), cython.address(m),
- *         cython.address(alpha), cython.address(y[0]), cython.address(incy),             # <<<<<<<<<<<<<<
- *         cython.address(x[0]), cython.address(incx), cython.address(A[0, 0]), cython.address(n))
- *     else:
+    /* "statmoments/_native.pyx":100
+ *   if cython.compiled:
+ *     cython_blas.dger(cython.address(n), cython.address(m),
+ *                      cython.address(alpha), cython.address(y[0]), cython.address(incy),             # <<<<<<<<<<<<<<
+ *                      cython.address(x[0]), cython.address(incx), cython.address(A[0, 0]), cython.address(n))
+ *   else:
  */
     __pyx_t_2 = 0;
 
-    /* "statmoments/_native.pyx":88
- *       cython_blas.dger(cython.address(n), cython.address(m),
- *         cython.address(alpha), cython.address(y[0]), cython.address(incy),
- *         cython.address(x[0]), cython.address(incx), cython.address(A[0, 0]), cython.address(n))             # <<<<<<<<<<<<<<
- *     else:
- *       A = A.reshape(len(A), -1)
+    /* "statmoments/_native.pyx":101
+ *     cython_blas.dger(cython.address(n), cython.address(m),
+ *                      cython.address(alpha), cython.address(y[0]), cython.address(incy),
+ *                      cython.address(x[0]), cython.address(incx), cython.address(A[0, 0]), cython.address(n))             # <<<<<<<<<<<<<<
+ *   else:
+ *     A = A.reshape(len(A), -1)
  */
     __pyx_t_3 = 0;
     __pyx_t_4 = 0;
     __pyx_t_5 = 0;
 
-    /* "statmoments/_native.pyx":86
- *     n = cython.cast(cython.int, A.shape[1])
- *     if cython.compiled:
- *       cython_blas.dger(cython.address(n), cython.address(m),             # <<<<<<<<<<<<<<
- *         cython.address(alpha), cython.address(y[0]), cython.address(incy),
- *         cython.address(x[0]), cython.address(incx), cython.address(A[0, 0]), cython.address(n))
+    /* "statmoments/_native.pyx":99
+ *   n = cython.cast(cython.int, A.shape[1])
+ *   if cython.compiled:
+ *     cython_blas.dger(cython.address(n), cython.address(m),             # <<<<<<<<<<<<<<
+ *                      cython.address(alpha), cython.address(y[0]), cython.address(incy),
+ *                      cython.address(x[0]), cython.address(incx), cython.address(A[0, 0]), cython.address(n))
  */
     __pyx_f_5scipy_6linalg_11cython_blas_dger((&__pyx_v_n), (&__pyx_v_m), (&__pyx_v_alpha), (&(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_y.data) + __pyx_t_2)) )))), (&__pyx_v_incy), (&(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x.data) + __pyx_t_3)) )))), (&__pyx_v_incx), (&(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_4 * __pyx_v_A.strides[0]) )) + __pyx_t_5)) )))), (&__pyx_v_n));
 
-    /* "statmoments/_native.pyx":85
- *     m = cython.cast(cython.int, A.shape[0])
- *     n = cython.cast(cython.int, A.shape[1])
- *     if cython.compiled:             # <<<<<<<<<<<<<<
- *       cython_blas.dger(cython.address(n), cython.address(m),
- *         cython.address(alpha), cython.address(y[0]), cython.address(incy),
+    /* "statmoments/_native.pyx":98
+ *   m = cython.cast(cython.int, A.shape[0])
+ *   n = cython.cast(cython.int, A.shape[1])
+ *   if cython.compiled:             # <<<<<<<<<<<<<<
+ *     cython_blas.dger(cython.address(n), cython.address(m),
+ *                      cython.address(alpha), cython.address(y[0]), cython.address(incy),
  */
     goto __pyx_L3;
   }
 
-  /* "statmoments/_native.pyx":90
- *         cython.address(x[0]), cython.address(incx), cython.address(A[0, 0]), cython.address(n))
- *     else:
- *       A = A.reshape(len(A), -1)             # <<<<<<<<<<<<<<
- *       scipy_blas.dger(alpha, y, x, incy, incx, A.T, 1, 1, 1)
+  /* "statmoments/_native.pyx":103
+ *                      cython.address(x[0]), cython.address(incx), cython.address(A[0, 0]), cython.address(n))
+ *   else:
+ *     A = A.reshape(len(A), -1)             # <<<<<<<<<<<<<<
+ *     scipy_blas.dger(alpha, y, x, incy, incx, A.T, 1, 1, 1)
  * 
  */
   /*else*/ {
-    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_A, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 90, __pyx_L1_error)
+    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_A, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 103, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_reshape); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 90, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_reshape); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 103, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_t_9 = __Pyx_MemoryView_Len(__pyx_v_A); 
-    __pyx_t_7 = __Pyx_PyInt_FromSize_t(__pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 90, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_FromSize_t(__pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 103, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_10 = NULL;
     __pyx_t_11 = 0;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_8))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_8);
       if (likely(__pyx_t_10)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
@@ -5260,79 +5576,79 @@
         __Pyx_DECREF_SET(__pyx_t_8, function);
         __pyx_t_11 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_8)) {
       PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_t_7, __pyx_int_neg_1};
-      __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 90, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 103, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_8)) {
       PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_t_7, __pyx_int_neg_1};
-      __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 90, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 103, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     {
-      __pyx_t_12 = PyTuple_New(2+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 90, __pyx_L1_error)
+      __pyx_t_12 = PyTuple_New(2+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 103, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       if (__pyx_t_10) {
         __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_t_7);
       __Pyx_INCREF(__pyx_int_neg_1);
       __Pyx_GIVEREF(__pyx_int_neg_1);
       PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_int_neg_1);
       __pyx_t_7 = 0;
-      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_12, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 90, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_12, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 103, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     }
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 90, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 103, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_A, 1);
     __pyx_v_A = __pyx_t_13;
     __pyx_t_13.memview = NULL;
     __pyx_t_13.data = NULL;
 
-    /* "statmoments/_native.pyx":91
- *     else:
- *       A = A.reshape(len(A), -1)
- *       scipy_blas.dger(alpha, y, x, incy, incx, A.T, 1, 1, 1)             # <<<<<<<<<<<<<<
+    /* "statmoments/_native.pyx":104
+ *   else:
+ *     A = A.reshape(len(A), -1)
+ *     scipy_blas.dger(alpha, y, x, incy, incx, A.T, 1, 1, 1)             # <<<<<<<<<<<<<<
  * 
  * @cython.cfunc
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_scipy_blas); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 91, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_scipy_blas); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 104, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_dger); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 91, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_dger); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 104, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_alpha); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 91, __pyx_L1_error)
+    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_alpha); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 104, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_y, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 91, __pyx_L1_error)
+    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_y, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 104, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_x, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 91, __pyx_L1_error)
+    __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_x, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 104, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_14 = __Pyx_PyInt_From_int(__pyx_v_incy); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 91, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyInt_From_int(__pyx_v_incy); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 104, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
-    __pyx_t_15 = __Pyx_PyInt_From_int(__pyx_v_incx); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 91, __pyx_L1_error)
+    __pyx_t_15 = __Pyx_PyInt_From_int(__pyx_v_incx); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 104, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
     __pyx_t_16 = __pyx_v_A;
     __PYX_INC_MEMVIEW(&__pyx_t_16, 1);
-    if (unlikely(__pyx_memslice_transpose(&__pyx_t_16) == 0)) __PYX_ERR(0, 91, __pyx_L1_error)
-    __pyx_t_17 = __pyx_memoryview_fromslice(__pyx_t_16, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 91, __pyx_L1_error)
+    if (unlikely(__pyx_memslice_transpose(&__pyx_t_16) == 0)) __PYX_ERR(0, 104, __pyx_L1_error)
+    __pyx_t_17 = __pyx_memoryview_fromslice(__pyx_t_16, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 104, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_17);
     __PYX_XDEC_MEMVIEW(&__pyx_t_16, 1);
     __pyx_t_16.memview = NULL;
     __pyx_t_16.data = NULL;
     __pyx_t_18 = NULL;
     __pyx_t_11 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_12))) {
@@ -5344,41 +5660,41 @@
         __Pyx_DECREF_SET(__pyx_t_12, function);
         __pyx_t_11 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_12)) {
       PyObject *__pyx_temp[10] = {__pyx_t_18, __pyx_t_8, __pyx_t_7, __pyx_t_10, __pyx_t_14, __pyx_t_15, __pyx_t_17, __pyx_int_1, __pyx_int_1, __pyx_int_1};
-      __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_12, __pyx_temp+1-__pyx_t_11, 9+__pyx_t_11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 91, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_12, __pyx_temp+1-__pyx_t_11, 9+__pyx_t_11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 104, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_18); __pyx_t_18 = 0;
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
       __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_12)) {
       PyObject *__pyx_temp[10] = {__pyx_t_18, __pyx_t_8, __pyx_t_7, __pyx_t_10, __pyx_t_14, __pyx_t_15, __pyx_t_17, __pyx_int_1, __pyx_int_1, __pyx_int_1};
-      __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_12, __pyx_temp+1-__pyx_t_11, 9+__pyx_t_11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 91, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_12, __pyx_temp+1-__pyx_t_11, 9+__pyx_t_11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 104, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_18); __pyx_t_18 = 0;
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
       __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
     } else
     #endif
     {
-      __pyx_t_19 = PyTuple_New(9+__pyx_t_11); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 91, __pyx_L1_error)
+      __pyx_t_19 = PyTuple_New(9+__pyx_t_11); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 104, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_19);
       if (__pyx_t_18) {
         __Pyx_GIVEREF(__pyx_t_18); PyTuple_SET_ITEM(__pyx_t_19, 0, __pyx_t_18); __pyx_t_18 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_8);
       PyTuple_SET_ITEM(__pyx_t_19, 0+__pyx_t_11, __pyx_t_8);
       __Pyx_GIVEREF(__pyx_t_7);
@@ -5402,29 +5718,29 @@
       PyTuple_SET_ITEM(__pyx_t_19, 8+__pyx_t_11, __pyx_int_1);
       __pyx_t_8 = 0;
       __pyx_t_7 = 0;
       __pyx_t_10 = 0;
       __pyx_t_14 = 0;
       __pyx_t_15 = 0;
       __pyx_t_17 = 0;
-      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_t_19, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 91, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_t_19, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 104, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
     }
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
   __pyx_L3:;
 
-  /* "statmoments/_native.pyx":80
- * @cython.locals(A = 'double[:,::1]', x = 'double[::1]', y = 'double[::1]', alpha = cython.double,
- *                incx = cython.int, incy = cython.int)
+  /* "statmoments/_native.pyx":93
+ * @cython.locals(A='double[:,::1]', x='double[::1]', y='double[::1]', alpha=cython.double,
+ *                incx=cython.int, incy=cython.int)
  * def dger(A, x, y, alpha=1.0, incx = 1, incy = 1):             # <<<<<<<<<<<<<<
- *     """ A := alpha*x*trans(y) + A """
- *     cython.declare(m = cython.int, n = cython.int)
+ *   """ A := alpha*x*trans(y) + A """
+ *   cython.declare(m=cython.int, n=cython.int)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_6);
   __Pyx_XDECREF(__pyx_t_7);
@@ -5440,20 +5756,20 @@
   __Pyx_XDECREF(__pyx_t_19);
   __Pyx_WriteUnraisable("statmoments._native.dger", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_A, 1);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "statmoments/_native.pyx":98
- * @cython.locals(A = 'float[:,::1]', C = 'float[:,::1]', uplo = cython.char,
- *                trans = cython.char, alpha = cython.float, beta = cython.float)
+/* "statmoments/_native.pyx":111
+ * @cython.locals(A='float[:,::1]', C='float[:,::1]', uplo=cython.char,
+ *                trans=cython.char, alpha=cython.float, beta=cython.float)
  * def ssyrk(A, C, uplo, trans=b'N', alpha=1.0, beta=1.0):             # <<<<<<<<<<<<<<
  *   """ C = alpha * trans(A * A^T) + beta * C """
- *   cython.declare(n = cython.int, k = cython.int, lda = cython.int, ldc = cython.int)
+ *   cython.declare(n=cython.int, k=cython.int, lda=cython.int, ldc=cython.int)
  */
 
 static CYTHON_INLINE void __pyx_f_11statmoments_7_native_ssyrk(__Pyx_memviewslice __pyx_v_A, __Pyx_memviewslice __pyx_v_C, char __pyx_v_uplo, struct __pyx_opt_args_11statmoments_7_native_ssyrk *__pyx_optional_args) {
   char __pyx_v_trans = ((char)'N');
   float __pyx_v_alpha = ((float)1.0);
   float __pyx_v_beta = ((float)1.0);
   int __pyx_v_n;
@@ -5491,125 +5807,133 @@
         if (__pyx_optional_args->__pyx_n > 2) {
           __pyx_v_beta = __pyx_optional_args->beta;
         }
       }
     }
   }
 
-  /* "statmoments/_native.pyx":101
+  /* "statmoments/_native.pyx":114
  *   """ C = alpha * trans(A * A^T) + beta * C """
- *   cython.declare(n = cython.int, k = cython.int, lda = cython.int, ldc = cython.int)
- *   n   = cython.cast(cython.int, C.shape[0])             # <<<<<<<<<<<<<<
- *   k   = cython.cast(cython.int, A.shape[0] if trans == b'N' else A.shape[1])
+ *   cython.declare(n=cython.int, k=cython.int, lda=cython.int, ldc=cython.int)
+ *   n = cython.cast(cython.int, C.shape[0])             # <<<<<<<<<<<<<<
+ *   k = cython.cast(cython.int, A.shape[0] if trans == b'N' else A.shape[1])
  *   lda = cython.cast(cython.int, A.shape[1])
  */
   __pyx_v_n = ((int)(__pyx_v_C.shape[0]));
 
-  /* "statmoments/_native.pyx":102
- *   cython.declare(n = cython.int, k = cython.int, lda = cython.int, ldc = cython.int)
- *   n   = cython.cast(cython.int, C.shape[0])
- *   k   = cython.cast(cython.int, A.shape[0] if trans == b'N' else A.shape[1])             # <<<<<<<<<<<<<<
+  /* "statmoments/_native.pyx":115
+ *   cython.declare(n=cython.int, k=cython.int, lda=cython.int, ldc=cython.int)
+ *   n = cython.cast(cython.int, C.shape[0])
+ *   k = cython.cast(cython.int, A.shape[0] if trans == b'N' else A.shape[1])             # <<<<<<<<<<<<<<
  *   lda = cython.cast(cython.int, A.shape[1])
  *   ldc = cython.cast(cython.int, C.shape[1])
  */
   if (((__pyx_v_trans == 'N') != 0)) {
     __pyx_t_1 = (__pyx_v_A.shape[0]);
   } else {
     __pyx_t_1 = (__pyx_v_A.shape[1]);
   }
   __pyx_v_k = ((int)__pyx_t_1);
 
-  /* "statmoments/_native.pyx":103
- *   n   = cython.cast(cython.int, C.shape[0])
- *   k   = cython.cast(cython.int, A.shape[0] if trans == b'N' else A.shape[1])
+  /* "statmoments/_native.pyx":116
+ *   n = cython.cast(cython.int, C.shape[0])
+ *   k = cython.cast(cython.int, A.shape[0] if trans == b'N' else A.shape[1])
  *   lda = cython.cast(cython.int, A.shape[1])             # <<<<<<<<<<<<<<
  *   ldc = cython.cast(cython.int, C.shape[1])
  *   #assert (A.shape[1] if trans == b'N' else A.shape[0]) == n
  */
   __pyx_v_lda = ((int)(__pyx_v_A.shape[1]));
 
-  /* "statmoments/_native.pyx":104
- *   k   = cython.cast(cython.int, A.shape[0] if trans == b'N' else A.shape[1])
+  /* "statmoments/_native.pyx":117
+ *   k = cython.cast(cython.int, A.shape[0] if trans == b'N' else A.shape[1])
  *   lda = cython.cast(cython.int, A.shape[1])
  *   ldc = cython.cast(cython.int, C.shape[1])             # <<<<<<<<<<<<<<
  *   #assert (A.shape[1] if trans == b'N' else A.shape[0]) == n
  *   #assert C.shape[1] == n
  */
   __pyx_v_ldc = ((int)(__pyx_v_C.shape[1]));
 
-  /* "statmoments/_native.pyx":109
+  /* "statmoments/_native.pyx":122
  * 
  *   # !!! uplo 'L' and 'U' mixed up !!!
  *   if cython.compiled:             # <<<<<<<<<<<<<<
- *       cython_blas.ssyrk(cython.address(uplo), cython.address(trans), cython.address(n), cython.address(k), cython.address(alpha),
- *         cython.address(A[0, 0]), cython.address(lda), cython.address(beta), cython.address(C[0, 0]), cython.address(ldc))
+ *     cython_blas.ssyrk(cython.address(uplo), cython.address(trans), cython.address(n), cython.address(k),
+ *                       cython.address(alpha), cython.address(A[0, 0]), cython.address(lda),
  */
   __pyx_t_2 = (1 != 0);
   if (__pyx_t_2) {
 
-    /* "statmoments/_native.pyx":111
+    /* "statmoments/_native.pyx":124
  *   if cython.compiled:
- *       cython_blas.ssyrk(cython.address(uplo), cython.address(trans), cython.address(n), cython.address(k), cython.address(alpha),
- *         cython.address(A[0, 0]), cython.address(lda), cython.address(beta), cython.address(C[0, 0]), cython.address(ldc))             # <<<<<<<<<<<<<<
+ *     cython_blas.ssyrk(cython.address(uplo), cython.address(trans), cython.address(n), cython.address(k),
+ *                       cython.address(alpha), cython.address(A[0, 0]), cython.address(lda),             # <<<<<<<<<<<<<<
+ *                       cython.address(beta), cython.address(C[0, 0]), cython.address(ldc))
  *   else:
- *     scipy_blas.ssyrk(alpha, A.T, beta, C.T, 1 if trans != b'N' else 0, 1 if uplo != b'U' else 0, 1)
  */
     __pyx_t_3 = 0;
     __pyx_t_4 = 0;
+
+    /* "statmoments/_native.pyx":125
+ *     cython_blas.ssyrk(cython.address(uplo), cython.address(trans), cython.address(n), cython.address(k),
+ *                       cython.address(alpha), cython.address(A[0, 0]), cython.address(lda),
+ *                       cython.address(beta), cython.address(C[0, 0]), cython.address(ldc))             # <<<<<<<<<<<<<<
+ *   else:
+ *     scipy_blas.ssyrk(alpha, A.T, beta, C.T, 1 if trans != b'N' else 0, 1 if uplo != b'U' else 0, 1)
+ */
     __pyx_t_5 = 0;
     __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":110
+    /* "statmoments/_native.pyx":123
  *   # !!! uplo 'L' and 'U' mixed up !!!
  *   if cython.compiled:
- *       cython_blas.ssyrk(cython.address(uplo), cython.address(trans), cython.address(n), cython.address(k), cython.address(alpha),             # <<<<<<<<<<<<<<
- *         cython.address(A[0, 0]), cython.address(lda), cython.address(beta), cython.address(C[0, 0]), cython.address(ldc))
- *   else:
+ *     cython_blas.ssyrk(cython.address(uplo), cython.address(trans), cython.address(n), cython.address(k),             # <<<<<<<<<<<<<<
+ *                       cython.address(alpha), cython.address(A[0, 0]), cython.address(lda),
+ *                       cython.address(beta), cython.address(C[0, 0]), cython.address(ldc))
  */
     __pyx_f_5scipy_6linalg_11cython_blas_ssyrk((&__pyx_v_uplo), (&__pyx_v_trans), (&__pyx_v_n), (&__pyx_v_k), (&__pyx_v_alpha), (&(*((float *) ( /* dim=1 */ ((char *) (((float *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_3 * __pyx_v_A.strides[0]) )) + __pyx_t_4)) )))), (&__pyx_v_lda), (&__pyx_v_beta), (&(*((float *) ( /* dim=1 */ ((char *) (((float *) ( /* dim=0 */ (__pyx_v_C.data + __pyx_t_5 * __pyx_v_C.strides[0]) )) + __pyx_t_6)) )))), (&__pyx_v_ldc));
 
-    /* "statmoments/_native.pyx":109
+    /* "statmoments/_native.pyx":122
  * 
  *   # !!! uplo 'L' and 'U' mixed up !!!
  *   if cython.compiled:             # <<<<<<<<<<<<<<
- *       cython_blas.ssyrk(cython.address(uplo), cython.address(trans), cython.address(n), cython.address(k), cython.address(alpha),
- *         cython.address(A[0, 0]), cython.address(lda), cython.address(beta), cython.address(C[0, 0]), cython.address(ldc))
+ *     cython_blas.ssyrk(cython.address(uplo), cython.address(trans), cython.address(n), cython.address(k),
+ *                       cython.address(alpha), cython.address(A[0, 0]), cython.address(lda),
  */
     goto __pyx_L3;
   }
 
-  /* "statmoments/_native.pyx":113
- *         cython.address(A[0, 0]), cython.address(lda), cython.address(beta), cython.address(C[0, 0]), cython.address(ldc))
+  /* "statmoments/_native.pyx":127
+ *                       cython.address(beta), cython.address(C[0, 0]), cython.address(ldc))
  *   else:
  *     scipy_blas.ssyrk(alpha, A.T, beta, C.T, 1 if trans != b'N' else 0, 1 if uplo != b'U' else 0, 1)             # <<<<<<<<<<<<<<
  * 
  * @cython.cfunc
  */
   /*else*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_scipy_blas); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 113, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_scipy_blas); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 127, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_ssyrk); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 113, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_ssyrk); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 127, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_alpha); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 113, __pyx_L1_error)
+    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_alpha); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 127, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_10 = __pyx_v_A;
     __PYX_INC_MEMVIEW(&__pyx_t_10, 1);
-    if (unlikely(__pyx_memslice_transpose(&__pyx_t_10) == 0)) __PYX_ERR(0, 113, __pyx_L1_error)
-    __pyx_t_11 = __pyx_memoryview_fromslice(__pyx_t_10, 2, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 113, __pyx_L1_error)
+    if (unlikely(__pyx_memslice_transpose(&__pyx_t_10) == 0)) __PYX_ERR(0, 127, __pyx_L1_error)
+    __pyx_t_11 = __pyx_memoryview_fromslice(__pyx_t_10, 2, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 127, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __PYX_XDEC_MEMVIEW(&__pyx_t_10, 1);
     __pyx_t_10.memview = NULL;
     __pyx_t_10.data = NULL;
-    __pyx_t_12 = PyFloat_FromDouble(__pyx_v_beta); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 113, __pyx_L1_error)
+    __pyx_t_12 = PyFloat_FromDouble(__pyx_v_beta); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 127, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __pyx_t_10 = __pyx_v_C;
     __PYX_INC_MEMVIEW(&__pyx_t_10, 1);
-    if (unlikely(__pyx_memslice_transpose(&__pyx_t_10) == 0)) __PYX_ERR(0, 113, __pyx_L1_error)
-    __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_t_10, 2, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 113, __pyx_L1_error)
+    if (unlikely(__pyx_memslice_transpose(&__pyx_t_10) == 0)) __PYX_ERR(0, 127, __pyx_L1_error)
+    __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_t_10, 2, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 127, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __PYX_XDEC_MEMVIEW(&__pyx_t_10, 1);
     __pyx_t_10.memview = NULL;
     __pyx_t_10.data = NULL;
     if (((__pyx_v_trans != 'N') != 0)) {
       __Pyx_INCREF(__pyx_int_1);
       __pyx_t_14 = __pyx_int_1;
@@ -5635,41 +5959,41 @@
         __Pyx_DECREF_SET(__pyx_t_9, function);
         __pyx_t_17 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_9)) {
       PyObject *__pyx_temp[8] = {__pyx_t_16, __pyx_t_8, __pyx_t_11, __pyx_t_12, __pyx_t_13, __pyx_t_14, __pyx_t_15, __pyx_int_1};
-      __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_17, 7+__pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 113, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_17, 7+__pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 127, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_16); __pyx_t_16 = 0;
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
       PyObject *__pyx_temp[8] = {__pyx_t_16, __pyx_t_8, __pyx_t_11, __pyx_t_12, __pyx_t_13, __pyx_t_14, __pyx_t_15, __pyx_int_1};
-      __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_17, 7+__pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 113, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_17, 7+__pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 127, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_16); __pyx_t_16 = 0;
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     } else
     #endif
     {
-      __pyx_t_18 = PyTuple_New(7+__pyx_t_17); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 113, __pyx_L1_error)
+      __pyx_t_18 = PyTuple_New(7+__pyx_t_17); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 127, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_18);
       if (__pyx_t_16) {
         __Pyx_GIVEREF(__pyx_t_16); PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_16); __pyx_t_16 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_8);
       PyTuple_SET_ITEM(__pyx_t_18, 0+__pyx_t_17, __pyx_t_8);
       __Pyx_GIVEREF(__pyx_t_11);
@@ -5687,29 +6011,29 @@
       PyTuple_SET_ITEM(__pyx_t_18, 6+__pyx_t_17, __pyx_int_1);
       __pyx_t_8 = 0;
       __pyx_t_11 = 0;
       __pyx_t_12 = 0;
       __pyx_t_13 = 0;
       __pyx_t_14 = 0;
       __pyx_t_15 = 0;
-      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_18, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 113, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_18, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 127, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
     }
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   }
   __pyx_L3:;
 
-  /* "statmoments/_native.pyx":98
- * @cython.locals(A = 'float[:,::1]', C = 'float[:,::1]', uplo = cython.char,
- *                trans = cython.char, alpha = cython.float, beta = cython.float)
+  /* "statmoments/_native.pyx":111
+ * @cython.locals(A='float[:,::1]', C='float[:,::1]', uplo=cython.char,
+ *                trans=cython.char, alpha=cython.float, beta=cython.float)
  * def ssyrk(A, C, uplo, trans=b'N', alpha=1.0, beta=1.0):             # <<<<<<<<<<<<<<
  *   """ C = alpha * trans(A * A^T) + beta * C """
- *   cython.declare(n = cython.int, k = cython.int, lda = cython.int, ldc = cython.int)
+ *   cython.declare(n=cython.int, k=cython.int, lda=cython.int, ldc=cython.int)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_8);
@@ -5723,20 +6047,20 @@
   __Pyx_XDECREF(__pyx_t_16);
   __Pyx_XDECREF(__pyx_t_18);
   __Pyx_WriteUnraisable("statmoments._native.ssyrk", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
 }
 
-/* "statmoments/_native.pyx":120
- * @cython.locals(A = 'double[:,::1]', C = 'double[:,::1]', uplo = cython.char,
- *                trans = cython.char, alpha = cython.double, beta = cython.double)
+/* "statmoments/_native.pyx":134
+ * @cython.locals(A='double[:,::1]', C='double[:,::1]', uplo=cython.char,
+ *                trans=cython.char, alpha=cython.double, beta=cython.double)
  * def dsyrk(A, C, uplo, trans=b'N', alpha=1.0, beta=1.0):             # <<<<<<<<<<<<<<
  *   """ C = alpha * trans(A * A^T) + beta * C """
- *   cython.declare(n = cython.int, k = cython.int, lda = cython.int, ldc = cython.int)
+ *   cython.declare(n=cython.int, k=cython.int, lda=cython.int, ldc=cython.int)
  */
 
 static CYTHON_INLINE void __pyx_f_11statmoments_7_native_dsyrk(__Pyx_memviewslice __pyx_v_A, __Pyx_memviewslice __pyx_v_C, char __pyx_v_uplo, struct __pyx_opt_args_11statmoments_7_native_dsyrk *__pyx_optional_args) {
   char __pyx_v_trans = ((char)'N');
   double __pyx_v_alpha = ((double)1.0);
   double __pyx_v_beta = ((double)1.0);
   int __pyx_v_n;
@@ -5774,125 +6098,133 @@
         if (__pyx_optional_args->__pyx_n > 2) {
           __pyx_v_beta = __pyx_optional_args->beta;
         }
       }
     }
   }
 
-  /* "statmoments/_native.pyx":123
+  /* "statmoments/_native.pyx":137
  *   """ C = alpha * trans(A * A^T) + beta * C """
- *   cython.declare(n = cython.int, k = cython.int, lda = cython.int, ldc = cython.int)
- *   n   = cython.cast(cython.int, C.shape[0])             # <<<<<<<<<<<<<<
- *   k   = cython.cast(cython.int, A.shape[0] if trans == b'N' else A.shape[1])
+ *   cython.declare(n=cython.int, k=cython.int, lda=cython.int, ldc=cython.int)
+ *   n = cython.cast(cython.int, C.shape[0])             # <<<<<<<<<<<<<<
+ *   k = cython.cast(cython.int, A.shape[0] if trans == b'N' else A.shape[1])
  *   lda = cython.cast(cython.int, A.shape[1])
  */
   __pyx_v_n = ((int)(__pyx_v_C.shape[0]));
 
-  /* "statmoments/_native.pyx":124
- *   cython.declare(n = cython.int, k = cython.int, lda = cython.int, ldc = cython.int)
- *   n   = cython.cast(cython.int, C.shape[0])
- *   k   = cython.cast(cython.int, A.shape[0] if trans == b'N' else A.shape[1])             # <<<<<<<<<<<<<<
+  /* "statmoments/_native.pyx":138
+ *   cython.declare(n=cython.int, k=cython.int, lda=cython.int, ldc=cython.int)
+ *   n = cython.cast(cython.int, C.shape[0])
+ *   k = cython.cast(cython.int, A.shape[0] if trans == b'N' else A.shape[1])             # <<<<<<<<<<<<<<
  *   lda = cython.cast(cython.int, A.shape[1])
  *   ldc = cython.cast(cython.int, C.shape[1])
  */
   if (((__pyx_v_trans == 'N') != 0)) {
     __pyx_t_1 = (__pyx_v_A.shape[0]);
   } else {
     __pyx_t_1 = (__pyx_v_A.shape[1]);
   }
   __pyx_v_k = ((int)__pyx_t_1);
 
-  /* "statmoments/_native.pyx":125
- *   n   = cython.cast(cython.int, C.shape[0])
- *   k   = cython.cast(cython.int, A.shape[0] if trans == b'N' else A.shape[1])
+  /* "statmoments/_native.pyx":139
+ *   n = cython.cast(cython.int, C.shape[0])
+ *   k = cython.cast(cython.int, A.shape[0] if trans == b'N' else A.shape[1])
  *   lda = cython.cast(cython.int, A.shape[1])             # <<<<<<<<<<<<<<
  *   ldc = cython.cast(cython.int, C.shape[1])
  *   #assert (A.shape[1] if trans == b'N' else A.shape[0]) == n
  */
   __pyx_v_lda = ((int)(__pyx_v_A.shape[1]));
 
-  /* "statmoments/_native.pyx":126
- *   k   = cython.cast(cython.int, A.shape[0] if trans == b'N' else A.shape[1])
+  /* "statmoments/_native.pyx":140
+ *   k = cython.cast(cython.int, A.shape[0] if trans == b'N' else A.shape[1])
  *   lda = cython.cast(cython.int, A.shape[1])
  *   ldc = cython.cast(cython.int, C.shape[1])             # <<<<<<<<<<<<<<
  *   #assert (A.shape[1] if trans == b'N' else A.shape[0]) == n
  *   #assert C.shape[1] == n
  */
   __pyx_v_ldc = ((int)(__pyx_v_C.shape[1]));
 
-  /* "statmoments/_native.pyx":131
+  /* "statmoments/_native.pyx":145
  * 
  *   # !!! uplo 'L' and 'U' mixed up !!!
  *   if cython.compiled:             # <<<<<<<<<<<<<<
- * #    if not USE_GPU:
- *       cython_blas.dsyrk(cython.address(uplo), cython.address(trans), cython.address(n), cython.address(k), cython.address(alpha),
+ *     #    if not USE_GPU:
+ *     cython_blas.dsyrk(cython.address(uplo), cython.address(trans), cython.address(n), cython.address(k),
  */
   __pyx_t_2 = (1 != 0);
   if (__pyx_t_2) {
 
-    /* "statmoments/_native.pyx":134
- * #    if not USE_GPU:
- *       cython_blas.dsyrk(cython.address(uplo), cython.address(trans), cython.address(n), cython.address(k), cython.address(alpha),
- *         cython.address(A[0, 0]), cython.address(lda), cython.address(beta), cython.address(C[0, 0]), cython.address(ldc))             # <<<<<<<<<<<<<<
- * #    else:
- * #      cython.declare(device = cython.int, uplo_ = cython.int, trns_ = cython.int)
+    /* "statmoments/_native.pyx":148
+ *     #    if not USE_GPU:
+ *     cython_blas.dsyrk(cython.address(uplo), cython.address(trans), cython.address(n), cython.address(k),
+ *                       cython.address(alpha), cython.address(A[0, 0]), cython.address(lda),             # <<<<<<<<<<<<<<
+ *                       cython.address(beta), cython.address(C[0, 0]), cython.address(ldc))
+ *   #    else:
  */
     __pyx_t_3 = 0;
     __pyx_t_4 = 0;
+
+    /* "statmoments/_native.pyx":149
+ *     cython_blas.dsyrk(cython.address(uplo), cython.address(trans), cython.address(n), cython.address(k),
+ *                       cython.address(alpha), cython.address(A[0, 0]), cython.address(lda),
+ *                       cython.address(beta), cython.address(C[0, 0]), cython.address(ldc))             # <<<<<<<<<<<<<<
+ *   #    else:
+ *   #      cython.declare(device = cython.int, uplo_ = cython.int, trns_ = cython.int)
+ */
     __pyx_t_5 = 0;
     __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":133
+    /* "statmoments/_native.pyx":147
  *   if cython.compiled:
- * #    if not USE_GPU:
- *       cython_blas.dsyrk(cython.address(uplo), cython.address(trans), cython.address(n), cython.address(k), cython.address(alpha),             # <<<<<<<<<<<<<<
- *         cython.address(A[0, 0]), cython.address(lda), cython.address(beta), cython.address(C[0, 0]), cython.address(ldc))
- * #    else:
+ *     #    if not USE_GPU:
+ *     cython_blas.dsyrk(cython.address(uplo), cython.address(trans), cython.address(n), cython.address(k),             # <<<<<<<<<<<<<<
+ *                       cython.address(alpha), cython.address(A[0, 0]), cython.address(lda),
+ *                       cython.address(beta), cython.address(C[0, 0]), cython.address(ldc))
  */
     __pyx_f_5scipy_6linalg_11cython_blas_dsyrk((&__pyx_v_uplo), (&__pyx_v_trans), (&__pyx_v_n), (&__pyx_v_k), (&__pyx_v_alpha), (&(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_3 * __pyx_v_A.strides[0]) )) + __pyx_t_4)) )))), (&__pyx_v_lda), (&__pyx_v_beta), (&(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_C.data + __pyx_t_5 * __pyx_v_C.strides[0]) )) + __pyx_t_6)) )))), (&__pyx_v_ldc));
 
-    /* "statmoments/_native.pyx":131
+    /* "statmoments/_native.pyx":145
  * 
  *   # !!! uplo 'L' and 'U' mixed up !!!
  *   if cython.compiled:             # <<<<<<<<<<<<<<
- * #    if not USE_GPU:
- *       cython_blas.dsyrk(cython.address(uplo), cython.address(trans), cython.address(n), cython.address(k), cython.address(alpha),
+ *     #    if not USE_GPU:
+ *     cython_blas.dsyrk(cython.address(uplo), cython.address(trans), cython.address(n), cython.address(k),
  */
     goto __pyx_L3;
   }
 
-  /* "statmoments/_native.pyx":152
+  /* "statmoments/_native.pyx":167
  *   else:
- * #    cupy_cublas.syrk(trans, A.T, C.T, alpha, beta, 1 if uplo != b'U' else 0)
+ *     #    cupy_cublas.syrk(trans, A.T, C.T, alpha, beta, 1 if uplo != b'U' else 0)
  *     scipy_blas.dsyrk(alpha, A.T, beta, C.T, 1 if trans != b'N' else 0, 1 if uplo != b'U' else 0, 1)             # <<<<<<<<<<<<<<
  * 
  * @cython.cfunc
  */
   /*else*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_scipy_blas); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 152, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_scipy_blas); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 167, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_dsyrk); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 152, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_dsyrk); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 167, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_alpha); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 152, __pyx_L1_error)
+    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_alpha); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 167, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_10 = __pyx_v_A;
     __PYX_INC_MEMVIEW(&__pyx_t_10, 1);
-    if (unlikely(__pyx_memslice_transpose(&__pyx_t_10) == 0)) __PYX_ERR(0, 152, __pyx_L1_error)
-    __pyx_t_11 = __pyx_memoryview_fromslice(__pyx_t_10, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 152, __pyx_L1_error)
+    if (unlikely(__pyx_memslice_transpose(&__pyx_t_10) == 0)) __PYX_ERR(0, 167, __pyx_L1_error)
+    __pyx_t_11 = __pyx_memoryview_fromslice(__pyx_t_10, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 167, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __PYX_XDEC_MEMVIEW(&__pyx_t_10, 1);
     __pyx_t_10.memview = NULL;
     __pyx_t_10.data = NULL;
-    __pyx_t_12 = PyFloat_FromDouble(__pyx_v_beta); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 152, __pyx_L1_error)
+    __pyx_t_12 = PyFloat_FromDouble(__pyx_v_beta); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 167, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __pyx_t_10 = __pyx_v_C;
     __PYX_INC_MEMVIEW(&__pyx_t_10, 1);
-    if (unlikely(__pyx_memslice_transpose(&__pyx_t_10) == 0)) __PYX_ERR(0, 152, __pyx_L1_error)
-    __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_t_10, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 152, __pyx_L1_error)
+    if (unlikely(__pyx_memslice_transpose(&__pyx_t_10) == 0)) __PYX_ERR(0, 167, __pyx_L1_error)
+    __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_t_10, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 167, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __PYX_XDEC_MEMVIEW(&__pyx_t_10, 1);
     __pyx_t_10.memview = NULL;
     __pyx_t_10.data = NULL;
     if (((__pyx_v_trans != 'N') != 0)) {
       __Pyx_INCREF(__pyx_int_1);
       __pyx_t_14 = __pyx_int_1;
@@ -5918,41 +6250,41 @@
         __Pyx_DECREF_SET(__pyx_t_9, function);
         __pyx_t_17 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_9)) {
       PyObject *__pyx_temp[8] = {__pyx_t_16, __pyx_t_8, __pyx_t_11, __pyx_t_12, __pyx_t_13, __pyx_t_14, __pyx_t_15, __pyx_int_1};
-      __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_17, 7+__pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 152, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_17, 7+__pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 167, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_16); __pyx_t_16 = 0;
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
       PyObject *__pyx_temp[8] = {__pyx_t_16, __pyx_t_8, __pyx_t_11, __pyx_t_12, __pyx_t_13, __pyx_t_14, __pyx_t_15, __pyx_int_1};
-      __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_17, 7+__pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 152, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_17, 7+__pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 167, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_16); __pyx_t_16 = 0;
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     } else
     #endif
     {
-      __pyx_t_18 = PyTuple_New(7+__pyx_t_17); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 152, __pyx_L1_error)
+      __pyx_t_18 = PyTuple_New(7+__pyx_t_17); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 167, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_18);
       if (__pyx_t_16) {
         __Pyx_GIVEREF(__pyx_t_16); PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_16); __pyx_t_16 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_8);
       PyTuple_SET_ITEM(__pyx_t_18, 0+__pyx_t_17, __pyx_t_8);
       __Pyx_GIVEREF(__pyx_t_11);
@@ -5970,29 +6302,29 @@
       PyTuple_SET_ITEM(__pyx_t_18, 6+__pyx_t_17, __pyx_int_1);
       __pyx_t_8 = 0;
       __pyx_t_11 = 0;
       __pyx_t_12 = 0;
       __pyx_t_13 = 0;
       __pyx_t_14 = 0;
       __pyx_t_15 = 0;
-      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_18, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 152, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_18, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 167, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
     }
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   }
   __pyx_L3:;
 
-  /* "statmoments/_native.pyx":120
- * @cython.locals(A = 'double[:,::1]', C = 'double[:,::1]', uplo = cython.char,
- *                trans = cython.char, alpha = cython.double, beta = cython.double)
+  /* "statmoments/_native.pyx":134
+ * @cython.locals(A='double[:,::1]', C='double[:,::1]', uplo=cython.char,
+ *                trans=cython.char, alpha=cython.double, beta=cython.double)
  * def dsyrk(A, C, uplo, trans=b'N', alpha=1.0, beta=1.0):             # <<<<<<<<<<<<<<
  *   """ C = alpha * trans(A * A^T) + beta * C """
- *   cython.declare(n = cython.int, k = cython.int, lda = cython.int, ldc = cython.int)
+ *   cython.declare(n=cython.int, k=cython.int, lda=cython.int, ldc=cython.int)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_8);
@@ -6006,20 +6338,20 @@
   __Pyx_XDECREF(__pyx_t_16);
   __Pyx_XDECREF(__pyx_t_18);
   __Pyx_WriteUnraisable("statmoments._native.dsyrk", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
 }
 
-/* "statmoments/_native.pyx":158
- * @cython.returns(cython.void)
- * @cython.locals(a = 'double[:,::1]', b = 'double[:,::1]', c = 'double[:,::1]', transa = cython.char, transb = cython.char, alpha = cython.double, beta = cython.double)
+/* "statmoments/_native.pyx":174
+ * @cython.locals(a='double[:,::1]', b='double[:,::1]', c='double[:,::1]', transa=cython.char, transb=cython.char,
+ *                alpha=cython.double, beta=cython.double)
  * def dgemm(a, b, c, transa=b'N', transb=b'N', alpha=1.0, beta=1.0):             # <<<<<<<<<<<<<<
  *   """ C = alpha * transa(A) * transb(B) + beta * C """
- *   cython.declare(n = cython.int, m = cython.int, k = cython.int, lda = cython.int, ldb = cython.int, ldc = cython.int)
+ *   cython.declare(n=cython.int, m=cython.int, k=cython.int, lda=cython.int, ldb=cython.int, ldc=cython.int)
  */
 
 static CYTHON_INLINE void __pyx_f_11statmoments_7_native_dgemm(__Pyx_memviewslice __pyx_v_a, __Pyx_memviewslice __pyx_v_b, __Pyx_memviewslice __pyx_v_c, struct __pyx_opt_args_11statmoments_7_native_dgemm *__pyx_optional_args) {
   char __pyx_v_transa = ((char)'N');
   char __pyx_v_transb = ((char)'N');
   double __pyx_v_alpha = ((double)1.0);
   double __pyx_v_beta = ((double)1.0);
@@ -6066,161 +6398,169 @@
             __pyx_v_beta = __pyx_optional_args->beta;
           }
         }
       }
     }
   }
 
-  /* "statmoments/_native.pyx":161
+  /* "statmoments/_native.pyx":177
  *   """ C = alpha * transa(A) * transb(B) + beta * C """
- *   cython.declare(n = cython.int, m = cython.int, k = cython.int, lda = cython.int, ldb = cython.int, ldc = cython.int)
- *   n   = cython.cast(cython.int, c.shape[0])             # <<<<<<<<<<<<<<
- *   m   = cython.cast(cython.int, c.shape[1])
- *   k   = cython.cast(cython.int, a.shape[0] if transa == b'N' else a.shape[1])
+ *   cython.declare(n=cython.int, m=cython.int, k=cython.int, lda=cython.int, ldb=cython.int, ldc=cython.int)
+ *   n = cython.cast(cython.int, c.shape[0])             # <<<<<<<<<<<<<<
+ *   m = cython.cast(cython.int, c.shape[1])
+ *   k = cython.cast(cython.int, a.shape[0] if transa == b'N' else a.shape[1])
  */
   __pyx_v_n = ((int)(__pyx_v_c.shape[0]));
 
-  /* "statmoments/_native.pyx":162
- *   cython.declare(n = cython.int, m = cython.int, k = cython.int, lda = cython.int, ldb = cython.int, ldc = cython.int)
- *   n   = cython.cast(cython.int, c.shape[0])
- *   m   = cython.cast(cython.int, c.shape[1])             # <<<<<<<<<<<<<<
- *   k   = cython.cast(cython.int, a.shape[0] if transa == b'N' else a.shape[1])
+  /* "statmoments/_native.pyx":178
+ *   cython.declare(n=cython.int, m=cython.int, k=cython.int, lda=cython.int, ldb=cython.int, ldc=cython.int)
+ *   n = cython.cast(cython.int, c.shape[0])
+ *   m = cython.cast(cython.int, c.shape[1])             # <<<<<<<<<<<<<<
+ *   k = cython.cast(cython.int, a.shape[0] if transa == b'N' else a.shape[1])
  *   lda = cython.cast(cython.int, a.shape[1])
  */
   __pyx_v_m = ((int)(__pyx_v_c.shape[1]));
 
-  /* "statmoments/_native.pyx":163
- *   n   = cython.cast(cython.int, c.shape[0])
- *   m   = cython.cast(cython.int, c.shape[1])
- *   k   = cython.cast(cython.int, a.shape[0] if transa == b'N' else a.shape[1])             # <<<<<<<<<<<<<<
+  /* "statmoments/_native.pyx":179
+ *   n = cython.cast(cython.int, c.shape[0])
+ *   m = cython.cast(cython.int, c.shape[1])
+ *   k = cython.cast(cython.int, a.shape[0] if transa == b'N' else a.shape[1])             # <<<<<<<<<<<<<<
  *   lda = cython.cast(cython.int, a.shape[1])
  *   ldb = cython.cast(cython.int, b.shape[1])
  */
   if (((__pyx_v_transa == 'N') != 0)) {
     __pyx_t_1 = (__pyx_v_a.shape[0]);
   } else {
     __pyx_t_1 = (__pyx_v_a.shape[1]);
   }
   __pyx_v_k = ((int)__pyx_t_1);
 
-  /* "statmoments/_native.pyx":164
- *   m   = cython.cast(cython.int, c.shape[1])
- *   k   = cython.cast(cython.int, a.shape[0] if transa == b'N' else a.shape[1])
+  /* "statmoments/_native.pyx":180
+ *   m = cython.cast(cython.int, c.shape[1])
+ *   k = cython.cast(cython.int, a.shape[0] if transa == b'N' else a.shape[1])
  *   lda = cython.cast(cython.int, a.shape[1])             # <<<<<<<<<<<<<<
  *   ldb = cython.cast(cython.int, b.shape[1])
  *   ldc = cython.cast(cython.int, c.shape[1])
  */
   __pyx_v_lda = ((int)(__pyx_v_a.shape[1]));
 
-  /* "statmoments/_native.pyx":165
- *   k   = cython.cast(cython.int, a.shape[0] if transa == b'N' else a.shape[1])
+  /* "statmoments/_native.pyx":181
+ *   k = cython.cast(cython.int, a.shape[0] if transa == b'N' else a.shape[1])
  *   lda = cython.cast(cython.int, a.shape[1])
  *   ldb = cython.cast(cython.int, b.shape[1])             # <<<<<<<<<<<<<<
  *   ldc = cython.cast(cython.int, c.shape[1])
  *   #assert (b.shape[0] if transb == b'N' else b.shape[1]) == n
  */
   __pyx_v_ldb = ((int)(__pyx_v_b.shape[1]));
 
-  /* "statmoments/_native.pyx":166
+  /* "statmoments/_native.pyx":182
  *   lda = cython.cast(cython.int, a.shape[1])
  *   ldb = cython.cast(cython.int, b.shape[1])
  *   ldc = cython.cast(cython.int, c.shape[1])             # <<<<<<<<<<<<<<
  *   #assert (b.shape[0] if transb == b'N' else b.shape[1]) == n
  *   #assert (a.shape[1] if transa == b'N' else a.shape[0]) == m
  */
   __pyx_v_ldc = ((int)(__pyx_v_c.shape[1]));
 
-  /* "statmoments/_native.pyx":171
+  /* "statmoments/_native.pyx":187
  *   #assert (b.shape[1] if transb == b'N' else b.shape[0]) == k
  * 
  *   if cython.compiled:             # <<<<<<<<<<<<<<
- *     cython_blas.dgemm(cython.address(transa), cython.address(transb), cython.address(m), cython.address(n), cython.address(k), cython.address(alpha),
- *                       cython.address(a[0, 0]), cython.address(lda), cython.address(b[0, 0]), cython.address(ldb), cython.address(beta),
+ *     cython_blas.dgemm(cython.address(transa), cython.address(transb),
+ *                       cython.address(m), cython.address(n), cython.address(k),
  */
   __pyx_t_2 = (1 != 0);
   if (__pyx_t_2) {
 
-    /* "statmoments/_native.pyx":173
- *   if cython.compiled:
- *     cython_blas.dgemm(cython.address(transa), cython.address(transb), cython.address(m), cython.address(n), cython.address(k), cython.address(alpha),
- *                       cython.address(a[0, 0]), cython.address(lda), cython.address(b[0, 0]), cython.address(ldb), cython.address(beta),             # <<<<<<<<<<<<<<
- *                       cython.address(c[0, 0]), cython.address(ldc))
- *   else:
+    /* "statmoments/_native.pyx":190
+ *     cython_blas.dgemm(cython.address(transa), cython.address(transb),
+ *                       cython.address(m), cython.address(n), cython.address(k),
+ *                       cython.address(alpha), cython.address(a[0, 0]), cython.address(lda),             # <<<<<<<<<<<<<<
+ *                       cython.address(b[0, 0]), cython.address(ldb),
+ *                       cython.address(beta), cython.address(c[0, 0]), cython.address(ldc))
  */
     __pyx_t_3 = 0;
     __pyx_t_4 = 0;
+
+    /* "statmoments/_native.pyx":191
+ *                       cython.address(m), cython.address(n), cython.address(k),
+ *                       cython.address(alpha), cython.address(a[0, 0]), cython.address(lda),
+ *                       cython.address(b[0, 0]), cython.address(ldb),             # <<<<<<<<<<<<<<
+ *                       cython.address(beta), cython.address(c[0, 0]), cython.address(ldc))
+ *   else:
+ */
     __pyx_t_5 = 0;
     __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":174
- *     cython_blas.dgemm(cython.address(transa), cython.address(transb), cython.address(m), cython.address(n), cython.address(k), cython.address(alpha),
- *                       cython.address(a[0, 0]), cython.address(lda), cython.address(b[0, 0]), cython.address(ldb), cython.address(beta),
- *                       cython.address(c[0, 0]), cython.address(ldc))             # <<<<<<<<<<<<<<
+    /* "statmoments/_native.pyx":192
+ *                       cython.address(alpha), cython.address(a[0, 0]), cython.address(lda),
+ *                       cython.address(b[0, 0]), cython.address(ldb),
+ *                       cython.address(beta), cython.address(c[0, 0]), cython.address(ldc))             # <<<<<<<<<<<<<<
  *   else:
  *     scipy_blas.dgemm(alpha, a.T, b.T, beta, c.T, 1 if transa != b'N' else 0, 1 if transb != b'N' else 0, 1)
  */
     __pyx_t_7 = 0;
     __pyx_t_8 = 0;
 
-    /* "statmoments/_native.pyx":172
+    /* "statmoments/_native.pyx":188
  * 
  *   if cython.compiled:
- *     cython_blas.dgemm(cython.address(transa), cython.address(transb), cython.address(m), cython.address(n), cython.address(k), cython.address(alpha),             # <<<<<<<<<<<<<<
- *                       cython.address(a[0, 0]), cython.address(lda), cython.address(b[0, 0]), cython.address(ldb), cython.address(beta),
- *                       cython.address(c[0, 0]), cython.address(ldc))
+ *     cython_blas.dgemm(cython.address(transa), cython.address(transb),             # <<<<<<<<<<<<<<
+ *                       cython.address(m), cython.address(n), cython.address(k),
+ *                       cython.address(alpha), cython.address(a[0, 0]), cython.address(lda),
  */
     __pyx_f_5scipy_6linalg_11cython_blas_dgemm((&__pyx_v_transa), (&__pyx_v_transb), (&__pyx_v_m), (&__pyx_v_n), (&__pyx_v_k), (&__pyx_v_alpha), (&(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_a.data + __pyx_t_3 * __pyx_v_a.strides[0]) )) + __pyx_t_4)) )))), (&__pyx_v_lda), (&(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_b.data + __pyx_t_5 * __pyx_v_b.strides[0]) )) + __pyx_t_6)) )))), (&__pyx_v_ldb), (&__pyx_v_beta), (&(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_c.data + __pyx_t_7 * __pyx_v_c.strides[0]) )) + __pyx_t_8)) )))), (&__pyx_v_ldc));
 
-    /* "statmoments/_native.pyx":171
+    /* "statmoments/_native.pyx":187
  *   #assert (b.shape[1] if transb == b'N' else b.shape[0]) == k
  * 
  *   if cython.compiled:             # <<<<<<<<<<<<<<
- *     cython_blas.dgemm(cython.address(transa), cython.address(transb), cython.address(m), cython.address(n), cython.address(k), cython.address(alpha),
- *                       cython.address(a[0, 0]), cython.address(lda), cython.address(b[0, 0]), cython.address(ldb), cython.address(beta),
+ *     cython_blas.dgemm(cython.address(transa), cython.address(transb),
+ *                       cython.address(m), cython.address(n), cython.address(k),
  */
     goto __pyx_L3;
   }
 
-  /* "statmoments/_native.pyx":176
- *                       cython.address(c[0, 0]), cython.address(ldc))
+  /* "statmoments/_native.pyx":194
+ *                       cython.address(beta), cython.address(c[0, 0]), cython.address(ldc))
  *   else:
  *     scipy_blas.dgemm(alpha, a.T, b.T, beta, c.T, 1 if transa != b'N' else 0, 1 if transb != b'N' else 0, 1)             # <<<<<<<<<<<<<<
  * 
- * 
+ * ################################ LOCAL HELPERS ################################
  */
   /*else*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_scipy_blas); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 176, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_scipy_blas); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 194, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_dgemm); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 176, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_dgemm); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 194, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = PyFloat_FromDouble(__pyx_v_alpha); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 176, __pyx_L1_error)
+    __pyx_t_10 = PyFloat_FromDouble(__pyx_v_alpha); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 194, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __pyx_t_12 = __pyx_v_a;
     __PYX_INC_MEMVIEW(&__pyx_t_12, 1);
-    if (unlikely(__pyx_memslice_transpose(&__pyx_t_12) == 0)) __PYX_ERR(0, 176, __pyx_L1_error)
-    __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_t_12, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 176, __pyx_L1_error)
+    if (unlikely(__pyx_memslice_transpose(&__pyx_t_12) == 0)) __PYX_ERR(0, 194, __pyx_L1_error)
+    __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_t_12, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 194, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __PYX_XDEC_MEMVIEW(&__pyx_t_12, 1);
     __pyx_t_12.memview = NULL;
     __pyx_t_12.data = NULL;
     __pyx_t_12 = __pyx_v_b;
     __PYX_INC_MEMVIEW(&__pyx_t_12, 1);
-    if (unlikely(__pyx_memslice_transpose(&__pyx_t_12) == 0)) __PYX_ERR(0, 176, __pyx_L1_error)
-    __pyx_t_14 = __pyx_memoryview_fromslice(__pyx_t_12, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 176, __pyx_L1_error)
+    if (unlikely(__pyx_memslice_transpose(&__pyx_t_12) == 0)) __PYX_ERR(0, 194, __pyx_L1_error)
+    __pyx_t_14 = __pyx_memoryview_fromslice(__pyx_t_12, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 194, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __PYX_XDEC_MEMVIEW(&__pyx_t_12, 1);
     __pyx_t_12.memview = NULL;
     __pyx_t_12.data = NULL;
-    __pyx_t_15 = PyFloat_FromDouble(__pyx_v_beta); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 176, __pyx_L1_error)
+    __pyx_t_15 = PyFloat_FromDouble(__pyx_v_beta); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 194, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
     __pyx_t_12 = __pyx_v_c;
     __PYX_INC_MEMVIEW(&__pyx_t_12, 1);
-    if (unlikely(__pyx_memslice_transpose(&__pyx_t_12) == 0)) __PYX_ERR(0, 176, __pyx_L1_error)
-    __pyx_t_16 = __pyx_memoryview_fromslice(__pyx_t_12, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 176, __pyx_L1_error)
+    if (unlikely(__pyx_memslice_transpose(&__pyx_t_12) == 0)) __PYX_ERR(0, 194, __pyx_L1_error)
+    __pyx_t_16 = __pyx_memoryview_fromslice(__pyx_t_12, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 194, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_16);
     __PYX_XDEC_MEMVIEW(&__pyx_t_12, 1);
     __pyx_t_12.memview = NULL;
     __pyx_t_12.data = NULL;
     if (((__pyx_v_transa != 'N') != 0)) {
       __Pyx_INCREF(__pyx_int_1);
       __pyx_t_17 = __pyx_int_1;
@@ -6246,43 +6586,43 @@
         __Pyx_DECREF_SET(__pyx_t_11, function);
         __pyx_t_20 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_11)) {
       PyObject *__pyx_temp[9] = {__pyx_t_19, __pyx_t_10, __pyx_t_13, __pyx_t_14, __pyx_t_15, __pyx_t_16, __pyx_t_17, __pyx_t_18, __pyx_int_1};
-      __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_20, 8+__pyx_t_20); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 176, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_20, 8+__pyx_t_20); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 194, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_19); __pyx_t_19 = 0;
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
       __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
       __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_11)) {
       PyObject *__pyx_temp[9] = {__pyx_t_19, __pyx_t_10, __pyx_t_13, __pyx_t_14, __pyx_t_15, __pyx_t_16, __pyx_t_17, __pyx_t_18, __pyx_int_1};
-      __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_20, 8+__pyx_t_20); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 176, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_20, 8+__pyx_t_20); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 194, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_19); __pyx_t_19 = 0;
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
       __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
       __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
     } else
     #endif
     {
-      __pyx_t_21 = PyTuple_New(8+__pyx_t_20); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 176, __pyx_L1_error)
+      __pyx_t_21 = PyTuple_New(8+__pyx_t_20); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 194, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_21);
       if (__pyx_t_19) {
         __Pyx_GIVEREF(__pyx_t_19); PyTuple_SET_ITEM(__pyx_t_21, 0, __pyx_t_19); __pyx_t_19 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_10);
       PyTuple_SET_ITEM(__pyx_t_21, 0+__pyx_t_20, __pyx_t_10);
       __Pyx_GIVEREF(__pyx_t_13);
@@ -6303,29 +6643,29 @@
       __pyx_t_10 = 0;
       __pyx_t_13 = 0;
       __pyx_t_14 = 0;
       __pyx_t_15 = 0;
       __pyx_t_16 = 0;
       __pyx_t_17 = 0;
       __pyx_t_18 = 0;
-      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_21, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 176, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_21, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 194, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
     }
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   }
   __pyx_L3:;
 
-  /* "statmoments/_native.pyx":158
- * @cython.returns(cython.void)
- * @cython.locals(a = 'double[:,::1]', b = 'double[:,::1]', c = 'double[:,::1]', transa = cython.char, transb = cython.char, alpha = cython.double, beta = cython.double)
+  /* "statmoments/_native.pyx":174
+ * @cython.locals(a='double[:,::1]', b='double[:,::1]', c='double[:,::1]', transa=cython.char, transb=cython.char,
+ *                alpha=cython.double, beta=cython.double)
  * def dgemm(a, b, c, transa=b'N', transb=b'N', alpha=1.0, beta=1.0):             # <<<<<<<<<<<<<<
  *   """ C = alpha * transa(A) * transb(B) + beta * C """
- *   cython.declare(n = cython.int, m = cython.int, k = cython.int, lda = cython.int, ldb = cython.int, ldc = cython.int)
+ *   cython.declare(n=cython.int, m=cython.int, k=cython.int, lda=cython.int, ldb=cython.int, ldc=cython.int)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_XDECREF(__pyx_t_10);
@@ -6340,17 +6680,17 @@
   __Pyx_XDECREF(__pyx_t_19);
   __Pyx_XDECREF(__pyx_t_21);
   __Pyx_WriteUnraisable("statmoments._native.dgemm", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
 }
 
-/* "statmoments/_native.pyx":182
+/* "statmoments/_native.pyx":199
  * @cython.cfunc
- * @cython.locals(i = cython.Py_ssize_t, tr_len = cython.Py_ssize_t)
+ * @cython.locals(i=cython.Py_ssize_t, tr_len=cython.Py_ssize_t)
  * def _block_index(i, tr_len):             # <<<<<<<<<<<<<<
  *   j = slice(i, tr_len)
  *   k = slice(tr_len * i - (i - 1) * i // 2, tr_len * (i + 1) - (i + 1) * i // 2)
  */
 
 static PyObject *__pyx_f_11statmoments_7_native__block_index(Py_ssize_t __pyx_v_i, Py_ssize_t __pyx_v_tr_len) {
   PyObject *__pyx_v_j = NULL;
@@ -6361,73 +6701,73 @@
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_block_index", 0);
 
-  /* "statmoments/_native.pyx":183
- * @cython.locals(i = cython.Py_ssize_t, tr_len = cython.Py_ssize_t)
+  /* "statmoments/_native.pyx":200
+ * @cython.locals(i=cython.Py_ssize_t, tr_len=cython.Py_ssize_t)
  * def _block_index(i, tr_len):
  *   j = slice(i, tr_len)             # <<<<<<<<<<<<<<
  *   k = slice(tr_len * i - (i - 1) * i // 2, tr_len * (i + 1) - (i + 1) * i // 2)
  *   return j, k
  */
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 183, __pyx_L1_error)
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 200, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_tr_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 183, __pyx_L1_error)
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_tr_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 200, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PySlice_New(__pyx_t_1, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 183, __pyx_L1_error)
+  __pyx_t_3 = PySlice_New(__pyx_t_1, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 200, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_j = ((PyObject*)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":184
+  /* "statmoments/_native.pyx":201
  * def _block_index(i, tr_len):
  *   j = slice(i, tr_len)
  *   k = slice(tr_len * i - (i - 1) * i // 2, tr_len * (i + 1) - (i + 1) * i // 2)             # <<<<<<<<<<<<<<
  *   return j, k
  * 
  */
-  __pyx_t_3 = PyInt_FromSsize_t(((__pyx_v_tr_len * __pyx_v_i) - (((__pyx_v_i - 1) * __pyx_v_i) / 2))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 184, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(((__pyx_v_tr_len * __pyx_v_i) - (((__pyx_v_i - 1) * __pyx_v_i) / 2))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 201, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyInt_FromSsize_t(((__pyx_v_tr_len * (__pyx_v_i + 1)) - (((__pyx_v_i + 1) * __pyx_v_i) / 2))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 184, __pyx_L1_error)
+  __pyx_t_2 = PyInt_FromSsize_t(((__pyx_v_tr_len * (__pyx_v_i + 1)) - (((__pyx_v_i + 1) * __pyx_v_i) / 2))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 201, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PySlice_New(__pyx_t_3, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 184, __pyx_L1_error)
+  __pyx_t_1 = PySlice_New(__pyx_t_3, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 201, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_k = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":185
+  /* "statmoments/_native.pyx":202
  *   j = slice(i, tr_len)
  *   k = slice(tr_len * i - (i - 1) * i // 2, tr_len * (i + 1) - (i + 1) * i // 2)
  *   return j, k             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 185, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 202, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_j);
   __Pyx_GIVEREF(__pyx_v_j);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_j);
   __Pyx_INCREF(__pyx_v_k);
   __Pyx_GIVEREF(__pyx_v_k);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_k);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":182
+  /* "statmoments/_native.pyx":199
  * @cython.cfunc
- * @cython.locals(i = cython.Py_ssize_t, tr_len = cython.Py_ssize_t)
+ * @cython.locals(i=cython.Py_ssize_t, tr_len=cython.Py_ssize_t)
  * def _block_index(i, tr_len):             # <<<<<<<<<<<<<<
  *   j = slice(i, tr_len)
  *   k = slice(tr_len * i - (i - 1) * i // 2, tr_len * (i + 1) - (i + 1) * i // 2)
  */
 
   /* function exit code */
   __pyx_L1_error:;
@@ -6440,15 +6780,15 @@
   __Pyx_XDECREF(__pyx_v_j);
   __Pyx_XDECREF(__pyx_v_k);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":190
+/* "statmoments/_native.pyx":207
  * ############################### COMMON CLASS ##################################
  * class _AccBase(object):
  *   def __init__(self, tr_len, cl_len, moment=2, normalize=True, **kwargs):             # <<<<<<<<<<<<<<
  *     self.total_count = 0
  *     self.moment = moment
  */
 
@@ -6497,21 +6837,21 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 3, 5, 1); __PYX_ERR(0, 190, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 3, 5, 1); __PYX_ERR(0, 207, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_cl_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 3, 5, 2); __PYX_ERR(0, 190, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 3, 5, 2); __PYX_ERR(0, 207, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moment);
           if (value) { values[3] = value; kw_args--; }
         }
@@ -6519,15 +6859,15 @@
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_normalize);
           if (value) { values[4] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 190, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 207, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
@@ -6542,15 +6882,15 @@
     __pyx_v_tr_len = values[1];
     __pyx_v_cl_len = values[2];
     __pyx_v_moment = values[3];
     __pyx_v_normalize = values[4];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 190, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 207, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
   __Pyx_AddTraceback("statmoments._native._AccBase.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_8_AccBase___init__(__pyx_self, __pyx_v_self, __pyx_v_tr_len, __pyx_v_cl_len, __pyx_v_moment, __pyx_v_normalize, __pyx_v_kwargs);
@@ -6566,72 +6906,72 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "statmoments/_native.pyx":191
+  /* "statmoments/_native.pyx":208
  * class _AccBase(object):
  *   def __init__(self, tr_len, cl_len, moment=2, normalize=True, **kwargs):
  *     self.total_count = 0             # <<<<<<<<<<<<<<
  *     self.moment = moment
  *     self.normalize = normalize
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_total_count, __pyx_int_0) < 0) __PYX_ERR(0, 191, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_total_count, __pyx_int_0) < 0) __PYX_ERR(0, 208, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":192
+  /* "statmoments/_native.pyx":209
  *   def __init__(self, tr_len, cl_len, moment=2, normalize=True, **kwargs):
  *     self.total_count = 0
  *     self.moment = moment             # <<<<<<<<<<<<<<
  *     self.normalize = normalize
  *     self.trace_len = tr_len
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_moment, __pyx_v_moment) < 0) __PYX_ERR(0, 192, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_moment, __pyx_v_moment) < 0) __PYX_ERR(0, 209, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":193
+  /* "statmoments/_native.pyx":210
  *     self.total_count = 0
  *     self.moment = moment
  *     self.normalize = normalize             # <<<<<<<<<<<<<<
  *     self.trace_len = tr_len
  *     self.classifiers_len = cl_len
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_normalize, __pyx_v_normalize) < 0) __PYX_ERR(0, 193, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_normalize, __pyx_v_normalize) < 0) __PYX_ERR(0, 210, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":194
+  /* "statmoments/_native.pyx":211
  *     self.moment = moment
  *     self.normalize = normalize
  *     self.trace_len = tr_len             # <<<<<<<<<<<<<<
  *     self.classifiers_len = cl_len
  *     self.acc_min_count = kwargs.pop('acc_min_count', 10)
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_trace_len, __pyx_v_tr_len) < 0) __PYX_ERR(0, 194, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_trace_len, __pyx_v_tr_len) < 0) __PYX_ERR(0, 211, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":195
+  /* "statmoments/_native.pyx":212
  *     self.normalize = normalize
  *     self.trace_len = tr_len
  *     self.classifiers_len = cl_len             # <<<<<<<<<<<<<<
  *     self.acc_min_count = kwargs.pop('acc_min_count', 10)
  * 
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_classifiers_len, __pyx_v_cl_len) < 0) __PYX_ERR(0, 195, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_classifiers_len, __pyx_v_cl_len) < 0) __PYX_ERR(0, 212, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":196
+  /* "statmoments/_native.pyx":213
  *     self.trace_len = tr_len
  *     self.classifiers_len = cl_len
  *     self.acc_min_count = kwargs.pop('acc_min_count', 10)             # <<<<<<<<<<<<<<
  * 
  *   @staticmethod
  */
-  __pyx_t_1 = __Pyx_PyDict_Pop(__pyx_v_kwargs, __pyx_n_u_acc_min_count, __pyx_int_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 196, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_Pop(__pyx_v_kwargs, __pyx_n_u_acc_min_count, __pyx_int_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 213, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_acc_min_count, __pyx_t_1) < 0) __PYX_ERR(0, 196, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_acc_min_count, __pyx_t_1) < 0) __PYX_ERR(0, 213, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":190
+  /* "statmoments/_native.pyx":207
  * ############################### COMMON CLASS ##################################
  * class _AccBase(object):
  *   def __init__(self, tr_len, cl_len, moment=2, normalize=True, **kwargs):             # <<<<<<<<<<<<<<
  *     self.total_count = 0
  *     self.moment = moment
  */
 
@@ -6644,37 +6984,37 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":199
+/* "statmoments/_native.pyx":216
  * 
  *   @staticmethod
- *   def estimate_mem_size(trace_len, classifier_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_11statmoments_7_native_8_AccBase_3estimate_mem_size(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_11statmoments_7_native_8_AccBase_3estimate_mem_size = {"estimate_mem_size", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_8_AccBase_3estimate_mem_size, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_11statmoments_7_native_8_AccBase_3estimate_mem_size(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  CYTHON_UNUSED PyObject *__pyx_v_trace_len = 0;
-  CYTHON_UNUSED PyObject *__pyx_v_classifier_len = 0;
+  CYTHON_UNUSED PyObject *__pyx_v_tr_len = 0;
+  CYTHON_UNUSED PyObject *__pyx_v_cl_len = 0;
   CYTHON_UNUSED PyObject *__pyx_v_moment = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("estimate_mem_size (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_trace_len,&__pyx_n_s_classifier_len,&__pyx_n_s_moment,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_tr_len,&__pyx_n_s_cl_len,&__pyx_n_s_moment,0};
     PyObject* values[3] = {0,0,0};
     values[1] = ((PyObject *)((PyObject *)__pyx_int_1));
     values[2] = ((PyObject *)((PyObject *)__pyx_int_2));
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
@@ -6686,103 +7026,103 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_trace_len)) != 0)) kw_args--;
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr_len)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifier_len);
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_cl_len);
           if (value) { values[1] = value; kw_args--; }
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moment);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "estimate_mem_size") < 0)) __PYX_ERR(0, 199, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "estimate_mem_size") < 0)) __PYX_ERR(0, 216, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
-    __pyx_v_trace_len = values[0];
-    __pyx_v_classifier_len = values[1];
+    __pyx_v_tr_len = values[0];
+    __pyx_v_cl_len = values[1];
     __pyx_v_moment = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("estimate_mem_size", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 199, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("estimate_mem_size", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 216, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native._AccBase.estimate_mem_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11statmoments_7_native_8_AccBase_2estimate_mem_size(__pyx_self, __pyx_v_trace_len, __pyx_v_classifier_len, __pyx_v_moment);
+  __pyx_r = __pyx_pf_11statmoments_7_native_8_AccBase_2estimate_mem_size(__pyx_self, __pyx_v_tr_len, __pyx_v_cl_len, __pyx_v_moment);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11statmoments_7_native_8_AccBase_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_trace_len, CYTHON_UNUSED PyObject *__pyx_v_classifier_len, CYTHON_UNUSED PyObject *__pyx_v_moment) {
+static PyObject *__pyx_pf_11statmoments_7_native_8_AccBase_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_tr_len, CYTHON_UNUSED PyObject *__pyx_v_cl_len, CYTHON_UNUSED PyObject *__pyx_v_moment) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("estimate_mem_size", 0);
 
-  /* "statmoments/_native.pyx":200
+  /* "statmoments/_native.pyx":217
  *   @staticmethod
- *   def estimate_mem_size(trace_len, classifier_len=1, moment=2):
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):
  *     raise NotImplementedError("Must be implemented in an inherited class")             # <<<<<<<<<<<<<<
  * 
  *   def memory_size(self):
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_NotImplementedError, __pyx_tuple_, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 200, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_NotImplementedError, __pyx_tuple__3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 217, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __PYX_ERR(0, 200, __pyx_L1_error)
+  __PYX_ERR(0, 217, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":199
+  /* "statmoments/_native.pyx":216
  * 
  *   @staticmethod
- *   def estimate_mem_size(trace_len, classifier_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_AddTraceback("statmoments._native._AccBase.estimate_mem_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":202
+/* "statmoments/_native.pyx":219
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  */
 
@@ -6805,28 +7145,28 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("memory_size", 0);
 
-  /* "statmoments/_native.pyx":203
+  /* "statmoments/_native.pyx":220
  * 
  *   def memory_size(self):
  *     raise NotImplementedError("Must be implemented in an inherited class")             # <<<<<<<<<<<<<<
  * 
  *   def update(self, traces, classifiers):
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_NotImplementedError, __pyx_tuple_, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 203, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_NotImplementedError, __pyx_tuple__3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 220, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __PYX_ERR(0, 203, __pyx_L1_error)
+  __PYX_ERR(0, 220, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":202
+  /* "statmoments/_native.pyx":219
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  */
 
@@ -6836,15 +7176,15 @@
   __Pyx_AddTraceback("statmoments._native._AccBase.memory_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":205
+/* "statmoments/_native.pyx":222
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  */
 
@@ -6882,40 +7222,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_traces)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 1); __PYX_ERR(0, 205, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 1); __PYX_ERR(0, 222, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifiers)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 2); __PYX_ERR(0, 205, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 2); __PYX_ERR(0, 222, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update") < 0)) __PYX_ERR(0, 205, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update") < 0)) __PYX_ERR(0, 222, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_traces = values[1];
     __pyx_v_classifiers = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 205, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 222, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native._AccBase.update", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_8_AccBase_6update(__pyx_self, __pyx_v_self, __pyx_v_traces, __pyx_v_classifiers);
 
@@ -6929,28 +7269,28 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("update", 0);
 
-  /* "statmoments/_native.pyx":206
+  /* "statmoments/_native.pyx":223
  * 
  *   def update(self, traces, classifiers):
  *     raise NotImplementedError("Must be implemented in an inherited class")             # <<<<<<<<<<<<<<
  * 
  *   def counts(self, i):
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_NotImplementedError, __pyx_tuple_, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 206, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_NotImplementedError, __pyx_tuple__3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 223, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __PYX_ERR(0, 206, __pyx_L1_error)
+  __PYX_ERR(0, 223, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":205
+  /* "statmoments/_native.pyx":222
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  */
 
@@ -6960,15 +7300,15 @@
   __Pyx_AddTraceback("statmoments._native._AccBase.update", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":208
+/* "statmoments/_native.pyx":225
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  */
 
@@ -7003,32 +7343,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_i)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, 1); __PYX_ERR(0, 208, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, 1); __PYX_ERR(0, 225, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "counts") < 0)) __PYX_ERR(0, 208, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "counts") < 0)) __PYX_ERR(0, 225, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_i = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 208, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 225, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native._AccBase.counts", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_8_AccBase_8counts(__pyx_self, __pyx_v_self, __pyx_v_i);
 
@@ -7042,28 +7382,28 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("counts", 0);
 
-  /* "statmoments/_native.pyx":209
+  /* "statmoments/_native.pyx":226
  * 
  *   def counts(self, i):
  *     raise NotImplementedError("Must be implemented in an inherited class")             # <<<<<<<<<<<<<<
  * 
  *   def moments(self, moments=None, normalize=None):
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_NotImplementedError, __pyx_tuple_, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 209, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_NotImplementedError, __pyx_tuple__3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 226, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __PYX_ERR(0, 209, __pyx_L1_error)
+  __PYX_ERR(0, 226, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":208
+  /* "statmoments/_native.pyx":225
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  */
 
@@ -7073,15 +7413,15 @@
   __Pyx_AddTraceback("statmoments._native._AccBase.counts", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":211
+/* "statmoments/_native.pyx":228
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  *   def moments(self, moments=None, normalize=None):             # <<<<<<<<<<<<<<
  *     """Return a generator yielding a pair of univariate statistical moments for each classifier"""
  *     moments = moments if moments is not None else [self.moment]
  */
 
@@ -7132,15 +7472,15 @@
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_normalize);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "moments") < 0)) __PYX_ERR(0, 211, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "moments") < 0)) __PYX_ERR(0, 228, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
@@ -7151,15 +7491,15 @@
     }
     __pyx_v_self = values[0];
     __pyx_v_moments = values[1];
     __pyx_v_normalize = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("moments", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 211, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("moments", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 228, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native._AccBase.moments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_8_AccBase_10moments(__pyx_self, __pyx_v_self, __pyx_v_moments, __pyx_v_normalize);
 
@@ -7180,68 +7520,68 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("moments", 0);
   __Pyx_INCREF(__pyx_v_moments);
   __Pyx_INCREF(__pyx_v_normalize);
 
-  /* "statmoments/_native.pyx":213
+  /* "statmoments/_native.pyx":230
  *   def moments(self, moments=None, normalize=None):
  *     """Return a generator yielding a pair of univariate statistical moments for each classifier"""
  *     moments = moments if moments is not None else [self.moment]             # <<<<<<<<<<<<<<
  *     normalize = normalize if normalize is not None else self.normalize
  *     return self._moments(moments, normalize)
  */
   __pyx_t_2 = (__pyx_v_moments != Py_None);
   if ((__pyx_t_2 != 0)) {
     __Pyx_INCREF(__pyx_v_moments);
     __pyx_t_1 = __pyx_v_moments;
   } else {
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 213, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 230, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 213, __pyx_L1_error)
+    __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 230, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_3);
     PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
     __pyx_t_3 = 0;
     __pyx_t_1 = __pyx_t_4;
     __pyx_t_4 = 0;
   }
   __Pyx_DECREF_SET(__pyx_v_moments, __pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":214
+  /* "statmoments/_native.pyx":231
  *     """Return a generator yielding a pair of univariate statistical moments for each classifier"""
  *     moments = moments if moments is not None else [self.moment]
  *     normalize = normalize if normalize is not None else self.normalize             # <<<<<<<<<<<<<<
  *     return self._moments(moments, normalize)
  * 
  */
   __pyx_t_2 = (__pyx_v_normalize != Py_None);
   if ((__pyx_t_2 != 0)) {
     __Pyx_INCREF(__pyx_v_normalize);
     __pyx_t_1 = __pyx_v_normalize;
   } else {
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_normalize); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 214, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_normalize); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 231, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_1 = __pyx_t_4;
     __pyx_t_4 = 0;
   }
   __Pyx_DECREF_SET(__pyx_v_normalize, __pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":215
+  /* "statmoments/_native.pyx":232
  *     moments = moments if moments is not None else [self.moment]
  *     normalize = normalize if normalize is not None else self.normalize
  *     return self._moments(moments, normalize)             # <<<<<<<<<<<<<<
  * 
  *   def _ensure_ret(self, mlen):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moments_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 215, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moments_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 232, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_3 = NULL;
   __pyx_t_5 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -7250,49 +7590,49 @@
       __Pyx_DECREF_SET(__pyx_t_4, function);
       __pyx_t_5 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_4)) {
     PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_moments, __pyx_v_normalize};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 215, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 232, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
     PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_moments, __pyx_v_normalize};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 215, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 232, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   {
-    __pyx_t_6 = PyTuple_New(2+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 215, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 232, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     if (__pyx_t_3) {
       __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3); __pyx_t_3 = NULL;
     }
     __Pyx_INCREF(__pyx_v_moments);
     __Pyx_GIVEREF(__pyx_v_moments);
     PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_5, __pyx_v_moments);
     __Pyx_INCREF(__pyx_v_normalize);
     __Pyx_GIVEREF(__pyx_v_normalize);
     PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_5, __pyx_v_normalize);
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 215, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 232, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":211
+  /* "statmoments/_native.pyx":228
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  *   def moments(self, moments=None, normalize=None):             # <<<<<<<<<<<<<<
  *     """Return a generator yielding a pair of univariate statistical moments for each classifier"""
  *     moments = moments if moments is not None else [self.moment]
  */
 
@@ -7308,20 +7648,20 @@
   __Pyx_XDECREF(__pyx_v_moments);
   __Pyx_XDECREF(__pyx_v_normalize);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":217
+/* "statmoments/_native.pyx":234
  *     return self._moments(moments, normalize)
  * 
  *   def _ensure_ret(self, mlen):             # <<<<<<<<<<<<<<
  *     if self._retm.shape[1] < mlen:
- *         tr_len = self.trace_len
+ *       tr_len = self.trace_len
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_11statmoments_7_native_8_AccBase_13_ensure_ret(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_11statmoments_7_native_8_AccBase_13_ensure_ret = {"_ensure_ret", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_8_AccBase_13_ensure_ret, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_11statmoments_7_native_8_AccBase_13_ensure_ret(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
@@ -7351,32 +7691,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mlen)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_ensure_ret", 1, 2, 2, 1); __PYX_ERR(0, 217, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_ensure_ret", 1, 2, 2, 1); __PYX_ERR(0, 234, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_ensure_ret") < 0)) __PYX_ERR(0, 217, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_ensure_ret") < 0)) __PYX_ERR(0, 234, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_mlen = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_ensure_ret", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 217, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_ensure_ret", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 234, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native._AccBase._ensure_ret", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_8_AccBase_12_ensure_ret(__pyx_self, __pyx_v_self, __pyx_v_mlen);
 
@@ -7396,129 +7736,129 @@
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_ensure_ret", 0);
 
-  /* "statmoments/_native.pyx":218
+  /* "statmoments/_native.pyx":235
  * 
  *   def _ensure_ret(self, mlen):
  *     if self._retm.shape[1] < mlen:             # <<<<<<<<<<<<<<
- *         tr_len = self.trace_len
- *         self._retm   = np.empty((2, mlen, tr_len * (tr_len + 1) // 2), dtype=np.float64)
+ *       tr_len = self.trace_len
+ *       self._retm = np.empty((2, mlen, tr_len * (tr_len + 1) // 2), dtype=np.float64)
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 218, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 235, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 218, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 235, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 218, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 235, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_v_mlen, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 218, __pyx_L1_error)
+  __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_v_mlen, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 235, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 218, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 235, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (__pyx_t_3) {
 
-    /* "statmoments/_native.pyx":219
+    /* "statmoments/_native.pyx":236
  *   def _ensure_ret(self, mlen):
  *     if self._retm.shape[1] < mlen:
- *         tr_len = self.trace_len             # <<<<<<<<<<<<<<
- *         self._retm   = np.empty((2, mlen, tr_len * (tr_len + 1) // 2), dtype=np.float64)
+ *       tr_len = self.trace_len             # <<<<<<<<<<<<<<
+ *       self._retm = np.empty((2, mlen, tr_len * (tr_len + 1) // 2), dtype=np.float64)
  * 
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 219, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 236, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_tr_len = __pyx_t_2;
     __pyx_t_2 = 0;
 
-    /* "statmoments/_native.pyx":220
+    /* "statmoments/_native.pyx":237
  *     if self._retm.shape[1] < mlen:
- *         tr_len = self.trace_len
- *         self._retm   = np.empty((2, mlen, tr_len * (tr_len + 1) // 2), dtype=np.float64)             # <<<<<<<<<<<<<<
+ *       tr_len = self.trace_len
+ *       self._retm = np.empty((2, mlen, tr_len * (tr_len + 1) // 2), dtype=np.float64)             # <<<<<<<<<<<<<<
  * 
  *     return self._retm
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 220, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 237, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 220, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 237, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_tr_len, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 220, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_tr_len, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 237, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = PyNumber_Multiply(__pyx_v_tr_len, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 220, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Multiply(__pyx_v_tr_len, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 237, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_4, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 220, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_4, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 237, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 220, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 237, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_int_2);
     __Pyx_GIVEREF(__pyx_int_2);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_int_2);
     __Pyx_INCREF(__pyx_v_mlen);
     __Pyx_GIVEREF(__pyx_v_mlen);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_mlen);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_2);
     __pyx_t_2 = 0;
-    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 220, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 237, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
     __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 220, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 237, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 220, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 237, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 220, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 237, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 220, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 237, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 220, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 237, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_retm, __pyx_t_6) < 0) __PYX_ERR(0, 220, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_retm, __pyx_t_6) < 0) __PYX_ERR(0, 237, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":218
+    /* "statmoments/_native.pyx":235
  * 
  *   def _ensure_ret(self, mlen):
  *     if self._retm.shape[1] < mlen:             # <<<<<<<<<<<<<<
- *         tr_len = self.trace_len
- *         self._retm   = np.empty((2, mlen, tr_len * (tr_len + 1) // 2), dtype=np.float64)
+ *       tr_len = self.trace_len
+ *       self._retm = np.empty((2, mlen, tr_len * (tr_len + 1) // 2), dtype=np.float64)
  */
   }
 
-  /* "statmoments/_native.pyx":222
- *         self._retm   = np.empty((2, mlen, tr_len * (tr_len + 1) // 2), dtype=np.float64)
+  /* "statmoments/_native.pyx":239
+ *       self._retm = np.empty((2, mlen, tr_len * (tr_len + 1) // 2), dtype=np.float64)
  * 
  *     return self._retm             # <<<<<<<<<<<<<<
  * 
  *   def comoments(self, moments=None, normalize=None):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 222, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 239, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __pyx_r = __pyx_t_6;
   __pyx_t_6 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":217
+  /* "statmoments/_native.pyx":234
  *     return self._moments(moments, normalize)
  * 
  *   def _ensure_ret(self, mlen):             # <<<<<<<<<<<<<<
  *     if self._retm.shape[1] < mlen:
- *         tr_len = self.trace_len
+ *       tr_len = self.trace_len
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4);
@@ -7529,15 +7869,15 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_tr_len);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":224
+/* "statmoments/_native.pyx":241
  *     return self._retm
  * 
  *   def comoments(self, moments=None, normalize=None):             # <<<<<<<<<<<<<<
  *     """Return a generator yielding the requested set of bivariate comoments for each classifier"""
  *     moments = moments if moments is not None else np.broadcast_to(self.moment, (2, 1))
  */
 
@@ -7588,15 +7928,15 @@
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_normalize);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "comoments") < 0)) __PYX_ERR(0, 224, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "comoments") < 0)) __PYX_ERR(0, 241, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
@@ -7607,15 +7947,15 @@
     }
     __pyx_v_self = values[0];
     __pyx_v_moments = values[1];
     __pyx_v_normalize = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("comoments", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 224, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("comoments", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 241, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native._AccBase.comoments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_8_AccBase_14comoments(__pyx_self, __pyx_v_self, __pyx_v_moments, __pyx_v_normalize);
 
@@ -7640,32 +7980,32 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("comoments", 0);
   __Pyx_INCREF(__pyx_v_moments);
   __Pyx_INCREF(__pyx_v_normalize);
 
-  /* "statmoments/_native.pyx":226
+  /* "statmoments/_native.pyx":243
  *   def comoments(self, moments=None, normalize=None):
  *     """Return a generator yielding the requested set of bivariate comoments for each classifier"""
  *     moments = moments if moments is not None else np.broadcast_to(self.moment, (2, 1))             # <<<<<<<<<<<<<<
  *     normalize = normalize if normalize is not None else self.normalize
  *     if len(moments[0]) != len(moments[1]):
  */
   __pyx_t_2 = (__pyx_v_moments != Py_None);
   if ((__pyx_t_2 != 0)) {
     __Pyx_INCREF(__pyx_v_moments);
     __pyx_t_1 = __pyx_v_moments;
   } else {
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 226, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 243, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_broadcast_to); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 226, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_broadcast_to); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 243, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 226, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 243, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_6 = NULL;
     __pyx_t_7 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
@@ -7673,213 +8013,213 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
         __pyx_t_7 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_5)) {
-      PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_t_4, __pyx_tuple__2};
-      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 226, __pyx_L1_error)
+      PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_t_4, __pyx_tuple__4};
+      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 243, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
-      PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_t_4, __pyx_tuple__2};
-      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 226, __pyx_L1_error)
+      PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_t_4, __pyx_tuple__4};
+      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 243, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     } else
     #endif
     {
-      __pyx_t_8 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 226, __pyx_L1_error)
+      __pyx_t_8 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 243, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       if (__pyx_t_6) {
         __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_4);
       PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, __pyx_t_4);
-      __Pyx_INCREF(__pyx_tuple__2);
-      __Pyx_GIVEREF(__pyx_tuple__2);
-      PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, __pyx_tuple__2);
+      __Pyx_INCREF(__pyx_tuple__4);
+      __Pyx_GIVEREF(__pyx_tuple__4);
+      PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, __pyx_tuple__4);
       __pyx_t_4 = 0;
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_8, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 226, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_8, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 243, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_1 = __pyx_t_3;
     __pyx_t_3 = 0;
   }
   __Pyx_DECREF_SET(__pyx_v_moments, __pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":227
+  /* "statmoments/_native.pyx":244
  *     """Return a generator yielding the requested set of bivariate comoments for each classifier"""
  *     moments = moments if moments is not None else np.broadcast_to(self.moment, (2, 1))
  *     normalize = normalize if normalize is not None else self.normalize             # <<<<<<<<<<<<<<
  *     if len(moments[0]) != len(moments[1]):
  *       raise ValueError("The input moment lists should have equal lengths.")
  */
   __pyx_t_2 = (__pyx_v_normalize != Py_None);
   if ((__pyx_t_2 != 0)) {
     __Pyx_INCREF(__pyx_v_normalize);
     __pyx_t_1 = __pyx_v_normalize;
   } else {
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_normalize); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 227, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_normalize); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 244, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_1 = __pyx_t_3;
     __pyx_t_3 = 0;
   }
   __Pyx_DECREF_SET(__pyx_v_normalize, __pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":228
+  /* "statmoments/_native.pyx":245
  *     moments = moments if moments is not None else np.broadcast_to(self.moment, (2, 1))
  *     normalize = normalize if normalize is not None else self.normalize
  *     if len(moments[0]) != len(moments[1]):             # <<<<<<<<<<<<<<
  *       raise ValueError("The input moment lists should have equal lengths.")
  * 
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_moments, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 228, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_moments, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 245, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_9 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 228, __pyx_L1_error)
+  __pyx_t_9 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 245, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_moments, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 228, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_moments, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 245, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_10 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 228, __pyx_L1_error)
+  __pyx_t_10 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 245, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_2 = ((__pyx_t_9 != __pyx_t_10) != 0);
   if (unlikely(__pyx_t_2)) {
 
-    /* "statmoments/_native.pyx":229
+    /* "statmoments/_native.pyx":246
  *     normalize = normalize if normalize is not None else self.normalize
  *     if len(moments[0]) != len(moments[1]):
  *       raise ValueError("The input moment lists should have equal lengths.")             # <<<<<<<<<<<<<<
  * 
  *     if self.moment < np.max(moments):
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 229, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 246, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 229, __pyx_L1_error)
+    __PYX_ERR(0, 246, __pyx_L1_error)
 
-    /* "statmoments/_native.pyx":228
+    /* "statmoments/_native.pyx":245
  *     moments = moments if moments is not None else np.broadcast_to(self.moment, (2, 1))
  *     normalize = normalize if normalize is not None else self.normalize
  *     if len(moments[0]) != len(moments[1]):             # <<<<<<<<<<<<<<
  *       raise ValueError("The input moment lists should have equal lengths.")
  * 
  */
   }
 
-  /* "statmoments/_native.pyx":231
+  /* "statmoments/_native.pyx":248
  *       raise ValueError("The input moment lists should have equal lengths.")
  * 
  *     if self.moment < np.max(moments):             # <<<<<<<<<<<<<<
  *       raise ValueError("The input moment should be less or equal than indicated in constructor.")
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 231, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 248, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 231, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 248, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_max); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 231, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_max); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 248, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_8);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_8, function);
     }
   }
   __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_5, __pyx_v_moments) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_v_moments);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 231, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 248, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  __pyx_t_8 = PyObject_RichCompare(__pyx_t_1, __pyx_t_3, Py_LT); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 231, __pyx_L1_error)
+  __pyx_t_8 = PyObject_RichCompare(__pyx_t_1, __pyx_t_3, Py_LT); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 248, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 231, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 248, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   if (unlikely(__pyx_t_2)) {
 
-    /* "statmoments/_native.pyx":232
+    /* "statmoments/_native.pyx":249
  * 
  *     if self.moment < np.max(moments):
  *       raise ValueError("The input moment should be less or equal than indicated in constructor.")             # <<<<<<<<<<<<<<
  * 
  *     self._ensure_ret(len(moments[0]))
  */
-    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 232, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__6, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 249, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_Raise(__pyx_t_8, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __PYX_ERR(0, 232, __pyx_L1_error)
+    __PYX_ERR(0, 249, __pyx_L1_error)
 
-    /* "statmoments/_native.pyx":231
+    /* "statmoments/_native.pyx":248
  *       raise ValueError("The input moment lists should have equal lengths.")
  * 
  *     if self.moment < np.max(moments):             # <<<<<<<<<<<<<<
  *       raise ValueError("The input moment should be less or equal than indicated in constructor.")
  * 
  */
   }
 
-  /* "statmoments/_native.pyx":234
+  /* "statmoments/_native.pyx":251
  *       raise ValueError("The input moment should be less or equal than indicated in constructor.")
  * 
  *     self._ensure_ret(len(moments[0]))             # <<<<<<<<<<<<<<
  * 
  *     return self._comoments(moments, normalize)
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_ensure_ret); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 234, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_ensure_ret); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 251, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_moments, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 234, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_moments, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 251, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_10 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 234, __pyx_L1_error)
+  __pyx_t_10 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 251, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 234, __pyx_L1_error)
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 251, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_8 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 234, __pyx_L1_error)
+  if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 251, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-  /* "statmoments/_native.pyx":236
+  /* "statmoments/_native.pyx":253
  *     self._ensure_ret(len(moments[0]))
  * 
  *     return self._comoments(moments, normalize)             # <<<<<<<<<<<<<<
  * 
- * ########################## BIVARIATE IMPLEMENTATIONS ##########################
+ * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_comoments); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 236, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_comoments); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 253, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_1 = NULL;
   __pyx_t_7 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_1)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -7888,49 +8228,49 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_7 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_moments, __pyx_v_normalize};
-    __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 236, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 253, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_GOTREF(__pyx_t_8);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_moments, __pyx_v_normalize};
-    __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 236, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 253, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_GOTREF(__pyx_t_8);
   } else
   #endif
   {
-    __pyx_t_5 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 236, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 253, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     if (__pyx_t_1) {
       __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1); __pyx_t_1 = NULL;
     }
     __Pyx_INCREF(__pyx_v_moments);
     __Pyx_GIVEREF(__pyx_v_moments);
     PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_7, __pyx_v_moments);
     __Pyx_INCREF(__pyx_v_normalize);
     __Pyx_GIVEREF(__pyx_v_normalize);
     PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_7, __pyx_v_normalize);
-    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 236, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 253, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_r = __pyx_t_8;
   __pyx_t_8 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":224
+  /* "statmoments/_native.pyx":241
  *     return self._retm
  * 
  *   def comoments(self, moments=None, normalize=None):             # <<<<<<<<<<<<<<
  *     """Return a generator yielding the requested set of bivariate comoments for each classifier"""
  *     moments = moments if moments is not None else np.broadcast_to(self.moment, (2, 1))
  */
 
@@ -7948,26 +8288,26 @@
   __Pyx_XDECREF(__pyx_v_moments);
   __Pyx_XDECREF(__pyx_v_normalize);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":243
+/* "statmoments/_native.pyx":261
  * #@cython.returns('double[:, ::1]')
  * #@cython.locals(M = 'double[:, ::1]', moment='int', tmpbuf = 'double[:, ::1]')
  * def _rmoms2cmoms(M, moment, tmpbuf):             # <<<<<<<<<<<<<<
  *   cython.declare(k='int', p='int')
  * 
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11statmoments_7_native_1_rmoms2cmoms(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_11statmoments_7_native_1_rmoms2cmoms = {"_rmoms2cmoms", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_1_rmoms2cmoms, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11statmoments_7_native_1_rmoms2cmoms(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_11statmoments_7_native_3_rmoms2cmoms(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_11statmoments_7_native_3_rmoms2cmoms = {"_rmoms2cmoms", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_3_rmoms2cmoms, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11statmoments_7_native_3_rmoms2cmoms(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_M = 0;
   PyObject *__pyx_v_moment = 0;
   CYTHON_UNUSED PyObject *__pyx_v_tmpbuf = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
@@ -7994,53 +8334,53 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_M)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moment)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_rmoms2cmoms", 1, 3, 3, 1); __PYX_ERR(0, 243, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_rmoms2cmoms", 1, 3, 3, 1); __PYX_ERR(0, 261, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tmpbuf)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_rmoms2cmoms", 1, 3, 3, 2); __PYX_ERR(0, 243, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_rmoms2cmoms", 1, 3, 3, 2); __PYX_ERR(0, 261, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_rmoms2cmoms") < 0)) __PYX_ERR(0, 243, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_rmoms2cmoms") < 0)) __PYX_ERR(0, 261, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_M = values[0];
     __pyx_v_moment = values[1];
     __pyx_v_tmpbuf = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_rmoms2cmoms", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 243, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_rmoms2cmoms", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 261, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native._rmoms2cmoms", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11statmoments_7_native__rmoms2cmoms(__pyx_self, __pyx_v_M, __pyx_v_moment, __pyx_v_tmpbuf);
+  __pyx_r = __pyx_pf_11statmoments_7_native_2_rmoms2cmoms(__pyx_self, __pyx_v_M, __pyx_v_moment, __pyx_v_tmpbuf);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11statmoments_7_native__rmoms2cmoms(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_M, PyObject *__pyx_v_moment, CYTHON_UNUSED PyObject *__pyx_v_tmpbuf) {
+static PyObject *__pyx_pf_11statmoments_7_native_2_rmoms2cmoms(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_M, PyObject *__pyx_v_moment, CYTHON_UNUSED PyObject *__pyx_v_tmpbuf) {
   int __pyx_v_k;
   int __pyx_v_p;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   long __pyx_t_1;
   int __pyx_t_2;
   int __pyx_t_3;
@@ -8058,54 +8398,54 @@
   PyObject *__pyx_t_15 = NULL;
   long __pyx_t_16;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_rmoms2cmoms", 0);
 
-  /* "statmoments/_native.pyx":246
+  /* "statmoments/_native.pyx":264
  *   cython.declare(k='int', p='int')
  * 
  *   for k in range(moment, 0, -1):             # <<<<<<<<<<<<<<
  *     for p in range(2, k):
- *       M[k-1] += (-1)**(k-p) * binom(k, p) * M[p-1] * np.power(M[0], k-p)
+ *       M[k - 1] += (-1) ** (k - p) * binom(k, p) * M[p - 1] * np.power(M[0], k - p)
  */
-  __pyx_t_1 = __Pyx_PyInt_As_long(__pyx_v_moment); if (unlikely((__pyx_t_1 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 246, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_As_long(__pyx_v_moment); if (unlikely((__pyx_t_1 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 264, __pyx_L1_error)
   for (__pyx_t_2 = __pyx_t_1; __pyx_t_2 > 0; __pyx_t_2-=1) {
     __pyx_v_k = __pyx_t_2;
 
-    /* "statmoments/_native.pyx":247
+    /* "statmoments/_native.pyx":265
  * 
  *   for k in range(moment, 0, -1):
  *     for p in range(2, k):             # <<<<<<<<<<<<<<
- *       M[k-1] += (-1)**(k-p) * binom(k, p) * M[p-1] * np.power(M[0], k-p)
- *     M[k-1] += (-1)**(k-1) * (k-1) * np.power(M[0], k)
+ *       M[k - 1] += (-1) ** (k - p) * binom(k, p) * M[p - 1] * np.power(M[0], k - p)
+ *     M[k - 1] += (-1) ** (k - 1) * (k - 1) * np.power(M[0], k)
  */
     __pyx_t_3 = __pyx_v_k;
     __pyx_t_4 = __pyx_t_3;
     for (__pyx_t_5 = 2; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
       __pyx_v_p = __pyx_t_5;
 
-      /* "statmoments/_native.pyx":248
+      /* "statmoments/_native.pyx":266
  *   for k in range(moment, 0, -1):
  *     for p in range(2, k):
- *       M[k-1] += (-1)**(k-p) * binom(k, p) * M[p-1] * np.power(M[0], k-p)             # <<<<<<<<<<<<<<
- *     M[k-1] += (-1)**(k-1) * (k-1) * np.power(M[0], k)
+ *       M[k - 1] += (-1) ** (k - p) * binom(k, p) * M[p - 1] * np.power(M[0], k - p)             # <<<<<<<<<<<<<<
+ *     M[k - 1] += (-1) ** (k - 1) * (k - 1) * np.power(M[0], k)
  * 
  */
       __pyx_t_6 = (__pyx_v_k - 1);
-      __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_M, __pyx_t_6, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 248, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_M, __pyx_t_6, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 266, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_8 = __Pyx_PyInt_From_long(__Pyx_pow_long(-1L, ((long)(__pyx_v_k - __pyx_v_p)))); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 248, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyInt_From_long(__Pyx_pow_long(-1L, ((long)(__pyx_v_k - __pyx_v_p)))); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 266, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
-      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_binom); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 248, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_binom); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 266, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_11 = __Pyx_PyInt_From_int(__pyx_v_k); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 248, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyInt_From_int(__pyx_v_k); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 266, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
-      __pyx_t_12 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 248, __pyx_L1_error)
+      __pyx_t_12 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 266, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __pyx_t_13 = NULL;
       __pyx_t_14 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
         __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_10);
         if (likely(__pyx_t_13)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
@@ -8114,67 +8454,67 @@
           __Pyx_DECREF_SET(__pyx_t_10, function);
           __pyx_t_14 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_10)) {
         PyObject *__pyx_temp[3] = {__pyx_t_13, __pyx_t_11, __pyx_t_12};
-        __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_14, 2+__pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 248, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_14, 2+__pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 266, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_10)) {
         PyObject *__pyx_temp[3] = {__pyx_t_13, __pyx_t_11, __pyx_t_12};
-        __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_14, 2+__pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 248, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_14, 2+__pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 266, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       } else
       #endif
       {
-        __pyx_t_15 = PyTuple_New(2+__pyx_t_14); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 248, __pyx_L1_error)
+        __pyx_t_15 = PyTuple_New(2+__pyx_t_14); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 266, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_15);
         if (__pyx_t_13) {
           __Pyx_GIVEREF(__pyx_t_13); PyTuple_SET_ITEM(__pyx_t_15, 0, __pyx_t_13); __pyx_t_13 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_11);
         PyTuple_SET_ITEM(__pyx_t_15, 0+__pyx_t_14, __pyx_t_11);
         __Pyx_GIVEREF(__pyx_t_12);
         PyTuple_SET_ITEM(__pyx_t_15, 1+__pyx_t_14, __pyx_t_12);
         __pyx_t_11 = 0;
         __pyx_t_12 = 0;
-        __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_15, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 248, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_15, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 266, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
       }
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = PyNumber_Multiply(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 248, __pyx_L1_error)
+      __pyx_t_10 = PyNumber_Multiply(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 266, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __pyx_t_16 = (__pyx_v_p - 1);
-      __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_M, __pyx_t_16, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 248, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_M, __pyx_t_16, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 266, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_8 = PyNumber_Multiply(__pyx_t_10, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 248, __pyx_L1_error)
+      __pyx_t_8 = PyNumber_Multiply(__pyx_t_10, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 266, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 248, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 266, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_power); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 248, __pyx_L1_error)
+      __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_power); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 266, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_15);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_M, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 248, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_M, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 266, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_12 = __Pyx_PyInt_From_int((__pyx_v_k - __pyx_v_p)); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 248, __pyx_L1_error)
+      __pyx_t_12 = __Pyx_PyInt_From_int((__pyx_v_k - __pyx_v_p)); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 266, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __pyx_t_11 = NULL;
       __pyx_t_14 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_15))) {
         __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_15);
         if (likely(__pyx_t_11)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_15);
@@ -8183,80 +8523,80 @@
           __Pyx_DECREF_SET(__pyx_t_15, function);
           __pyx_t_14 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_15)) {
         PyObject *__pyx_temp[3] = {__pyx_t_11, __pyx_t_10, __pyx_t_12};
-        __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_15, __pyx_temp+1-__pyx_t_14, 2+__pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 248, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_15, __pyx_temp+1-__pyx_t_14, 2+__pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 266, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_15)) {
         PyObject *__pyx_temp[3] = {__pyx_t_11, __pyx_t_10, __pyx_t_12};
-        __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_15, __pyx_temp+1-__pyx_t_14, 2+__pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 248, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_15, __pyx_temp+1-__pyx_t_14, 2+__pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 266, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       } else
       #endif
       {
-        __pyx_t_13 = PyTuple_New(2+__pyx_t_14); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 248, __pyx_L1_error)
+        __pyx_t_13 = PyTuple_New(2+__pyx_t_14); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 266, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_13);
         if (__pyx_t_11) {
           __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_11); __pyx_t_11 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_10);
         PyTuple_SET_ITEM(__pyx_t_13, 0+__pyx_t_14, __pyx_t_10);
         __Pyx_GIVEREF(__pyx_t_12);
         PyTuple_SET_ITEM(__pyx_t_13, 1+__pyx_t_14, __pyx_t_12);
         __pyx_t_10 = 0;
         __pyx_t_12 = 0;
-        __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_15, __pyx_t_13, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 248, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_15, __pyx_t_13, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 266, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
       }
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-      __pyx_t_15 = PyNumber_Multiply(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 248, __pyx_L1_error)
+      __pyx_t_15 = PyNumber_Multiply(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 266, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_15);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = PyNumber_InPlaceAdd(__pyx_t_7, __pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 248, __pyx_L1_error)
+      __pyx_t_9 = PyNumber_InPlaceAdd(__pyx_t_7, __pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 266, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-      if (unlikely(__Pyx_SetItemInt(__pyx_v_M, __pyx_t_6, __pyx_t_9, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) < 0)) __PYX_ERR(0, 248, __pyx_L1_error)
+      if (unlikely(__Pyx_SetItemInt(__pyx_v_M, __pyx_t_6, __pyx_t_9, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) < 0)) __PYX_ERR(0, 266, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     }
 
-    /* "statmoments/_native.pyx":249
+    /* "statmoments/_native.pyx":267
  *     for p in range(2, k):
- *       M[k-1] += (-1)**(k-p) * binom(k, p) * M[p-1] * np.power(M[0], k-p)
- *     M[k-1] += (-1)**(k-1) * (k-1) * np.power(M[0], k)             # <<<<<<<<<<<<<<
+ *       M[k - 1] += (-1) ** (k - p) * binom(k, p) * M[p - 1] * np.power(M[0], k - p)
+ *     M[k - 1] += (-1) ** (k - 1) * (k - 1) * np.power(M[0], k)             # <<<<<<<<<<<<<<
  * 
  *   return M
  */
     __pyx_t_6 = (__pyx_v_k - 1);
-    __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_M, __pyx_t_6, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 249, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_M, __pyx_t_6, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 267, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_15 = __Pyx_PyInt_From_long((__Pyx_pow_long(-1L, (__pyx_v_k - 1)) * (__pyx_v_k - 1))); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 249, __pyx_L1_error)
+    __pyx_t_15 = __Pyx_PyInt_From_long((__Pyx_pow_long(-1L, (__pyx_v_k - 1)) * (__pyx_v_k - 1))); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 267, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
-    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 249, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 267, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_power); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 249, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_power); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 267, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_M, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 249, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_M, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 267, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_12 = __Pyx_PyInt_From_int(__pyx_v_k); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 249, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyInt_From_int(__pyx_v_k); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 267, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __pyx_t_10 = NULL;
     __pyx_t_3 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_13);
       if (likely(__pyx_t_10)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
@@ -8265,73 +8605,73 @@
         __Pyx_DECREF_SET(__pyx_t_13, function);
         __pyx_t_3 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_13)) {
       PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_t_8, __pyx_t_12};
-      __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_3, 2+__pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 249, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_3, 2+__pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 267, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_13)) {
       PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_t_8, __pyx_t_12};
-      __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_3, 2+__pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 249, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_13, __pyx_temp+1-__pyx_t_3, 2+__pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 267, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     } else
     #endif
     {
-      __pyx_t_11 = PyTuple_New(2+__pyx_t_3); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 249, __pyx_L1_error)
+      __pyx_t_11 = PyTuple_New(2+__pyx_t_3); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 267, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       if (__pyx_t_10) {
         __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_10); __pyx_t_10 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_8);
       PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_3, __pyx_t_8);
       __Pyx_GIVEREF(__pyx_t_12);
       PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_3, __pyx_t_12);
       __pyx_t_8 = 0;
       __pyx_t_12 = 0;
-      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_11, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 249, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_11, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 267, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     }
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-    __pyx_t_13 = PyNumber_Multiply(__pyx_t_15, __pyx_t_7); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 249, __pyx_L1_error)
+    __pyx_t_13 = PyNumber_Multiply(__pyx_t_15, __pyx_t_7); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 267, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyNumber_InPlaceAdd(__pyx_t_9, __pyx_t_13); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 249, __pyx_L1_error)
+    __pyx_t_7 = PyNumber_InPlaceAdd(__pyx_t_9, __pyx_t_13); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 267, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-    if (unlikely(__Pyx_SetItemInt(__pyx_v_M, __pyx_t_6, __pyx_t_7, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) < 0)) __PYX_ERR(0, 249, __pyx_L1_error)
+    if (unlikely(__Pyx_SetItemInt(__pyx_v_M, __pyx_t_6, __pyx_t_7, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) < 0)) __PYX_ERR(0, 267, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   }
 
-  /* "statmoments/_native.pyx":251
- *     M[k-1] += (-1)**(k-1) * (k-1) * np.power(M[0], k)
+  /* "statmoments/_native.pyx":269
+ *     M[k - 1] += (-1) ** (k - 1) * (k - 1) * np.power(M[0], k)
  * 
  *   return M             # <<<<<<<<<<<<<<
  * 
- * 
+ * def calc_central_moment_general(raw, ave, n, k, l, i, j):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_M);
   __pyx_r = __pyx_v_M;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":243
+  /* "statmoments/_native.pyx":261
  * #@cython.returns('double[:, ::1]')
  * #@cython.locals(M = 'double[:, ::1]', moment='int', tmpbuf = 'double[:, ::1]')
  * def _rmoms2cmoms(M, moment, tmpbuf):             # <<<<<<<<<<<<<<
  *   cython.declare(k='int', p='int')
  * 
  */
 
@@ -8349,27 +8689,27 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":254
- * 
+/* "statmoments/_native.pyx":271
+ *   return M
  * 
  * def calc_central_moment_general(raw, ave, n, k, l, i, j):             # <<<<<<<<<<<<<<
  *   """ Calculate co-moments for any available moments """
- *   ave_i = ave[i]
+ *   ave_i = ave[i]  # i is a scalar
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11statmoments_7_native_3calc_central_moment_general(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_11statmoments_7_native_2calc_central_moment_general[] = " Calculate co-moments for any available moments ";
-static PyMethodDef __pyx_mdef_11statmoments_7_native_3calc_central_moment_general = {"calc_central_moment_general", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_3calc_central_moment_general, METH_VARARGS|METH_KEYWORDS, __pyx_doc_11statmoments_7_native_2calc_central_moment_general};
-static PyObject *__pyx_pw_11statmoments_7_native_3calc_central_moment_general(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_11statmoments_7_native_5calc_central_moment_general(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_11statmoments_7_native_4calc_central_moment_general[] = " Calculate co-moments for any available moments ";
+static PyMethodDef __pyx_mdef_11statmoments_7_native_5calc_central_moment_general = {"calc_central_moment_general", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_5calc_central_moment_general, METH_VARARGS|METH_KEYWORDS, __pyx_doc_11statmoments_7_native_4calc_central_moment_general};
+static PyObject *__pyx_pw_11statmoments_7_native_5calc_central_moment_general(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_raw = 0;
   PyObject *__pyx_v_ave = 0;
   PyObject *__pyx_v_n = 0;
   PyObject *__pyx_v_k = 0;
   PyObject *__pyx_v_l = 0;
   PyObject *__pyx_v_i = 0;
   PyObject *__pyx_v_j = 0;
@@ -8408,49 +8748,49 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_raw)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_ave)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("calc_central_moment_general", 1, 7, 7, 1); __PYX_ERR(0, 254, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calc_central_moment_general", 1, 7, 7, 1); __PYX_ERR(0, 271, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_n)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("calc_central_moment_general", 1, 7, 7, 2); __PYX_ERR(0, 254, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calc_central_moment_general", 1, 7, 7, 2); __PYX_ERR(0, 271, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_k)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("calc_central_moment_general", 1, 7, 7, 3); __PYX_ERR(0, 254, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calc_central_moment_general", 1, 7, 7, 3); __PYX_ERR(0, 271, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_l)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("calc_central_moment_general", 1, 7, 7, 4); __PYX_ERR(0, 254, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calc_central_moment_general", 1, 7, 7, 4); __PYX_ERR(0, 271, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_i)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("calc_central_moment_general", 1, 7, 7, 5); __PYX_ERR(0, 254, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calc_central_moment_general", 1, 7, 7, 5); __PYX_ERR(0, 271, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_j)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("calc_central_moment_general", 1, 7, 7, 6); __PYX_ERR(0, 254, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calc_central_moment_general", 1, 7, 7, 6); __PYX_ERR(0, 271, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calc_central_moment_general") < 0)) __PYX_ERR(0, 254, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calc_central_moment_general") < 0)) __PYX_ERR(0, 271, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 7) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -8465,33 +8805,34 @@
     __pyx_v_k = values[3];
     __pyx_v_l = values[4];
     __pyx_v_i = values[5];
     __pyx_v_j = values[6];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("calc_central_moment_general", 1, 7, 7, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 254, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("calc_central_moment_general", 1, 7, 7, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 271, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native.calc_central_moment_general", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11statmoments_7_native_2calc_central_moment_general(__pyx_self, __pyx_v_raw, __pyx_v_ave, __pyx_v_n, __pyx_v_k, __pyx_v_l, __pyx_v_i, __pyx_v_j);
+  __pyx_r = __pyx_pf_11statmoments_7_native_4calc_central_moment_general(__pyx_self, __pyx_v_raw, __pyx_v_ave, __pyx_v_n, __pyx_v_k, __pyx_v_l, __pyx_v_i, __pyx_v_j);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11statmoments_7_native_2calc_central_moment_general(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_raw, PyObject *__pyx_v_ave, PyObject *__pyx_v_n, PyObject *__pyx_v_k, PyObject *__pyx_v_l, PyObject *__pyx_v_i, PyObject *__pyx_v_j) {
+static PyObject *__pyx_pf_11statmoments_7_native_4calc_central_moment_general(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_raw, PyObject *__pyx_v_ave, PyObject *__pyx_v_n, PyObject *__pyx_v_k, PyObject *__pyx_v_l, PyObject *__pyx_v_i, PyObject *__pyx_v_j) {
   PyObject *__pyx_v_ave_i = NULL;
   PyObject *__pyx_v_ave_j = NULL;
   PyObject *__pyx_v_inv_n = NULL;
   PyObject *__pyx_v_com = NULL;
   PyObject *__pyx_v_p = NULL;
+  PyObject *__pyx_v_edge_val = NULL;
   PyObject *__pyx_v_q = NULL;
   PyObject *__pyx_v_Mpq = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
@@ -8506,896 +8847,914 @@
   int __pyx_t_12;
   PyObject *__pyx_t_13 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("calc_central_moment_general", 0);
 
-  /* "statmoments/_native.pyx":256
+  /* "statmoments/_native.pyx":273
  * def calc_central_moment_general(raw, ave, n, k, l, i, j):
  *   """ Calculate co-moments for any available moments """
- *   ave_i = ave[i]             # <<<<<<<<<<<<<<
- *   ave_j = ave[j]
+ *   ave_i = ave[i]  # i is a scalar             # <<<<<<<<<<<<<<
+ *   ave_j = ave[j]  # j is a slice such that indices (j, j) add diagonal!
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_ave, __pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_ave, __pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 273, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_ave_i = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":257
+  /* "statmoments/_native.pyx":274
  *   """ Calculate co-moments for any available moments """
- *   ave_i = ave[i]
- *   ave_j = ave[j]             # <<<<<<<<<<<<<<
+ *   ave_i = ave[i]  # i is a scalar
+ *   ave_j = ave[j]  # j is a slice such that indices (j, j) add diagonal!             # <<<<<<<<<<<<<<
  * 
  *   inv_n = 1.0 / n
  */
-  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_ave, __pyx_v_j); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 257, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_ave, __pyx_v_j); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 274, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_ave_j = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":259
- *   ave_j = ave[j]
+  /* "statmoments/_native.pyx":276
+ *   ave_j = ave[j]  # j is a slice such that indices (j, j) add diagonal!
  * 
  *   inv_n = 1.0 / n             # <<<<<<<<<<<<<<
  *   com = (-1) ** (k + l) * (1 - k - l) * n * ave_i ** k * ave_j ** l
  * 
  */
-  __pyx_t_1 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_v_n, 1.0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 259, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_v_n, 1.0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_inv_n = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":260
+  /* "statmoments/_native.pyx":277
  * 
  *   inv_n = 1.0 / n
  *   com = (-1) ** (k + l) * (1 - k - l) * n * ave_i ** k * ave_j ** l             # <<<<<<<<<<<<<<
  * 
  *   for p in range(2, k + 1):
  */
-  __pyx_t_1 = PyNumber_Add(__pyx_v_k, __pyx_v_l); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Add(__pyx_v_k, __pyx_v_l); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 277, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyNumber_Power(__pyx_int_neg_1, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 260, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Power(__pyx_int_neg_1, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 277, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_k, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_k, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 277, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_v_l); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 260, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_v_l); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 277, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Multiply(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 277, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_v_n); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 260, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_v_n); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 277, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Power(__pyx_v_ave_i, __pyx_v_k, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Power(__pyx_v_ave_i, __pyx_v_k, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 277, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyNumber_Multiply(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 260, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 277, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Power(__pyx_v_ave_j, __pyx_v_l, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Power(__pyx_v_ave_j, __pyx_v_l, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 277, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 260, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 277, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_com = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":262
+  /* "statmoments/_native.pyx":279
  *   com = (-1) ** (k + l) * (1 - k - l) * n * ave_i ** k * ave_j ** l
  * 
  *   for p in range(2, k + 1):             # <<<<<<<<<<<<<<
- *     com += (-1) ** (k + l - p) * binom(k, p) * raw[0,:,p-2,:][i, i]            * ave_j ** l * ave_i ** (k - p)
- *   for q in range(2, l + 1):
+ *     edge_val = raw[0, :, p - 2, :][i, i]
+ *     com += (-1) ** (k + l - p) * binom(k, p) * edge_val * ave_j ** l * ave_i ** (k - p)
  */
-  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_k, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 262, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_k, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 279, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 262, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 279, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_int_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 262, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 279, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
     __pyx_t_1 = __pyx_t_3; __Pyx_INCREF(__pyx_t_1); __pyx_t_4 = 0;
     __pyx_t_5 = NULL;
   } else {
-    __pyx_t_4 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 262, __pyx_L1_error)
+    __pyx_t_4 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 279, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 262, __pyx_L1_error)
+    __pyx_t_5 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 279, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   for (;;) {
     if (likely(!__pyx_t_5)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 262, __pyx_L1_error)
+        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 279, __pyx_L1_error)
         #else
-        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 262, __pyx_L1_error)
+        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 279, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         #endif
       } else {
         if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 262, __pyx_L1_error)
+        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 279, __pyx_L1_error)
         #else
-        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 262, __pyx_L1_error)
+        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 279, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         #endif
       }
     } else {
       __pyx_t_3 = __pyx_t_5(__pyx_t_1);
       if (unlikely(!__pyx_t_3)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 262, __pyx_L1_error)
+          else __PYX_ERR(0, 279, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_3);
     }
     __Pyx_XDECREF_SET(__pyx_v_p, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "statmoments/_native.pyx":263
+    /* "statmoments/_native.pyx":280
  * 
  *   for p in range(2, k + 1):
- *     com += (-1) ** (k + l - p) * binom(k, p) * raw[0,:,p-2,:][i, i]            * ave_j ** l * ave_i ** (k - p)             # <<<<<<<<<<<<<<
+ *     edge_val = raw[0, :, p - 2, :][i, i]             # <<<<<<<<<<<<<<
+ *     com += (-1) ** (k + l - p) * binom(k, p) * edge_val * ave_j ** l * ave_i ** (k - p)
  *   for q in range(2, l + 1):
- *     com += (-1) ** (k + l - q) * binom(l, q) * raw[0,:,q-2,:][j, j].diagonal() * ave_i ** k * ave_j ** (l - q)
  */
-    __pyx_t_3 = PyNumber_Add(__pyx_v_k, __pyx_v_l); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 263, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_v_p, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 280, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = PyNumber_Subtract(__pyx_t_3, __pyx_v_p); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 263, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 280, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Power(__pyx_int_neg_1, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 263, __pyx_L1_error)
+    __Pyx_INCREF(__pyx_int_0);
+    __Pyx_GIVEREF(__pyx_int_0);
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_0);
+    __Pyx_INCREF(__pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_slice__7);
+    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_t_3);
+    PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_t_3);
+    __Pyx_INCREF(__pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_slice__7);
+    PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_slice__7);
+    __pyx_t_3 = 0;
+    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 280, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_binom); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 263, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 280, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_INCREF(__pyx_v_i);
+    __Pyx_GIVEREF(__pyx_v_i);
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_i);
+    __Pyx_INCREF(__pyx_v_i);
+    __Pyx_GIVEREF(__pyx_v_i);
+    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_i);
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 280, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_XDECREF_SET(__pyx_v_edge_val, __pyx_t_6);
+    __pyx_t_6 = 0;
+
+    /* "statmoments/_native.pyx":281
+ *   for p in range(2, k + 1):
+ *     edge_val = raw[0, :, p - 2, :][i, i]
+ *     com += (-1) ** (k + l - p) * binom(k, p) * edge_val * ave_j ** l * ave_i ** (k - p)             # <<<<<<<<<<<<<<
+ *   for q in range(2, l + 1):
+ *     edge_val = raw[0, :, q - 2, :][j, j].diagonal()
+ */
+    __pyx_t_6 = PyNumber_Add(__pyx_v_k, __pyx_v_l); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 281, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_2 = PyNumber_Subtract(__pyx_t_6, __pyx_v_p); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 281, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyNumber_Power(__pyx_int_neg_1, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 281, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_binom); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 281, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_7 = NULL;
     __pyx_t_8 = 0;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
-      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_7)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_6, function);
+        __Pyx_DECREF_SET(__pyx_t_3, function);
         __pyx_t_8 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
-    if (PyFunction_Check(__pyx_t_6)) {
+    if (PyFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_v_k, __pyx_v_p};
-      __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 263, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 281, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_GOTREF(__pyx_t_2);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
-    if (__Pyx_PyFastCFunction_Check(__pyx_t_6)) {
+    if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_v_k, __pyx_v_p};
-      __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 263, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 281, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_GOTREF(__pyx_t_2);
     } else
     #endif
     {
-      __pyx_t_9 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 263, __pyx_L1_error)
+      __pyx_t_9 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 281, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       if (__pyx_t_7) {
         __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_7); __pyx_t_7 = NULL;
       }
       __Pyx_INCREF(__pyx_v_k);
       __Pyx_GIVEREF(__pyx_v_k);
       PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_8, __pyx_v_k);
       __Pyx_INCREF(__pyx_v_p);
       __Pyx_GIVEREF(__pyx_v_p);
       PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_8, __pyx_v_p);
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_9, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 263, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_9, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 281, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     }
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyNumber_Multiply(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 263, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_v_p, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 263, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 263, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Multiply(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 281, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_INCREF(__pyx_int_0);
-    __Pyx_GIVEREF(__pyx_int_0);
-    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_int_0);
-    __Pyx_INCREF(__pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_slice__5);
-    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_t_2);
-    PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_2);
-    __Pyx_INCREF(__pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_slice__5);
-    PyTuple_SET_ITEM(__pyx_t_3, 3, __pyx_slice__5);
-    __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 263, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = PyNumber_Multiply(__pyx_t_3, __pyx_v_edge_val); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 281, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 263, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Power(__pyx_v_ave_j, __pyx_v_l, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 281, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_INCREF(__pyx_v_i);
-    __Pyx_GIVEREF(__pyx_v_i);
-    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_i);
-    __Pyx_INCREF(__pyx_v_i);
-    __Pyx_GIVEREF(__pyx_v_i);
-    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_i);
-    __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 263, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_9);
+    __pyx_t_6 = PyNumber_Multiply(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 281, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Multiply(__pyx_t_6, __pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 263, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Subtract(__pyx_v_k, __pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 281, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Power(__pyx_v_ave_j, __pyx_v_l, Py_None); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 263, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_6 = PyNumber_Multiply(__pyx_t_3, __pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 263, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_2 = PyNumber_Power(__pyx_v_ave_i, __pyx_t_3, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 281, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Subtract(__pyx_v_k, __pyx_v_p); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 263, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_3 = PyNumber_Power(__pyx_v_ave_i, __pyx_t_9, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 263, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Multiply(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 281, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Multiply(__pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 263, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = PyNumber_InPlaceAdd(__pyx_v_com, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 281, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_com, __pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 263, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __Pyx_DECREF_SET(__pyx_v_com, __pyx_t_3);
-    __pyx_t_3 = 0;
+    __Pyx_DECREF_SET(__pyx_v_com, __pyx_t_2);
+    __pyx_t_2 = 0;
 
-    /* "statmoments/_native.pyx":262
+    /* "statmoments/_native.pyx":279
  *   com = (-1) ** (k + l) * (1 - k - l) * n * ave_i ** k * ave_j ** l
  * 
  *   for p in range(2, k + 1):             # <<<<<<<<<<<<<<
- *     com += (-1) ** (k + l - p) * binom(k, p) * raw[0,:,p-2,:][i, i]            * ave_j ** l * ave_i ** (k - p)
- *   for q in range(2, l + 1):
+ *     edge_val = raw[0, :, p - 2, :][i, i]
+ *     com += (-1) ** (k + l - p) * binom(k, p) * edge_val * ave_j ** l * ave_i ** (k - p)
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":264
- *   for p in range(2, k + 1):
- *     com += (-1) ** (k + l - p) * binom(k, p) * raw[0,:,p-2,:][i, i]            * ave_j ** l * ave_i ** (k - p)
+  /* "statmoments/_native.pyx":282
+ *     edge_val = raw[0, :, p - 2, :][i, i]
+ *     com += (-1) ** (k + l - p) * binom(k, p) * edge_val * ave_j ** l * ave_i ** (k - p)
  *   for q in range(2, l + 1):             # <<<<<<<<<<<<<<
- *     com += (-1) ** (k + l - q) * binom(l, q) * raw[0,:,q-2,:][j, j].diagonal() * ave_i ** k * ave_j ** (l - q)
- *   for p in range(1, k + 1):
+ *     edge_val = raw[0, :, q - 2, :][j, j].diagonal()
+ *     com += (-1) ** (k + l - q) * binom(l, q) * edge_val * ave_i ** k * ave_j ** (l - q)
  */
-  __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_v_l, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 264, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_v_l, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 282, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 264, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 282, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_int_2);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_2);
   __Pyx_GIVEREF(__pyx_t_1);
-  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 264, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 282, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
-    __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
+    __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_4 = 0;
     __pyx_t_5 = NULL;
   } else {
-    __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 264, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 264, __pyx_L1_error)
+    __pyx_t_4 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 282, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_5 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 282, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_5)) {
-      if (likely(PyList_CheckExact(__pyx_t_3))) {
-        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
+      if (likely(PyList_CheckExact(__pyx_t_2))) {
+        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 264, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 282, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 264, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 282, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
-        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
+        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 264, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 282, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 264, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 282, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
-      __pyx_t_1 = __pyx_t_5(__pyx_t_3);
+      __pyx_t_1 = __pyx_t_5(__pyx_t_2);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 264, __pyx_L1_error)
+          else __PYX_ERR(0, 282, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XDECREF_SET(__pyx_v_q, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":265
- *     com += (-1) ** (k + l - p) * binom(k, p) * raw[0,:,p-2,:][i, i]            * ave_j ** l * ave_i ** (k - p)
+    /* "statmoments/_native.pyx":283
+ *     com += (-1) ** (k + l - p) * binom(k, p) * edge_val * ave_j ** l * ave_i ** (k - p)
  *   for q in range(2, l + 1):
- *     com += (-1) ** (k + l - q) * binom(l, q) * raw[0,:,q-2,:][j, j].diagonal() * ave_i ** k * ave_j ** (l - q)             # <<<<<<<<<<<<<<
+ *     edge_val = raw[0, :, q - 2, :][j, j].diagonal()             # <<<<<<<<<<<<<<
+ *     com += (-1) ** (k + l - q) * binom(l, q) * edge_val * ave_i ** k * ave_j ** (l - q)
+ *   for p in range(1, k + 1):
+ */
+    __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_v_q, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 283, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_6 = PyTuple_New(4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 283, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_INCREF(__pyx_int_0);
+    __Pyx_GIVEREF(__pyx_int_0);
+    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_int_0);
+    __Pyx_INCREF(__pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_slice__7);
+    PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_t_3);
+    PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_t_3);
+    __Pyx_INCREF(__pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_slice__7);
+    PyTuple_SET_ITEM(__pyx_t_6, 3, __pyx_slice__7);
+    __pyx_t_3 = 0;
+    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 283, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 283, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_INCREF(__pyx_v_j);
+    __Pyx_GIVEREF(__pyx_v_j);
+    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_j);
+    __Pyx_INCREF(__pyx_v_j);
+    __Pyx_GIVEREF(__pyx_v_j);
+    PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_v_j);
+    __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 283, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_diagonal); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 283, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+    __pyx_t_9 = NULL;
+    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
+      __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_6);
+      if (likely(__pyx_t_9)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
+        __Pyx_INCREF(__pyx_t_9);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_6, function);
+      }
+    }
+    __pyx_t_1 = (__pyx_t_9) ? __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_9) : __Pyx_PyObject_CallNoArg(__pyx_t_6);
+    __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 283, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_XDECREF_SET(__pyx_v_edge_val, __pyx_t_1);
+    __pyx_t_1 = 0;
+
+    /* "statmoments/_native.pyx":284
+ *   for q in range(2, l + 1):
+ *     edge_val = raw[0, :, q - 2, :][j, j].diagonal()
+ *     com += (-1) ** (k + l - q) * binom(l, q) * edge_val * ave_i ** k * ave_j ** (l - q)             # <<<<<<<<<<<<<<
  *   for p in range(1, k + 1):
  *     for q in range(1, l + 1):
  */
-    __pyx_t_1 = PyNumber_Add(__pyx_v_k, __pyx_v_l); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Add(__pyx_v_k, __pyx_v_l); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 284, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_9 = PyNumber_Subtract(__pyx_t_1, __pyx_v_q); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 265, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_9);
+    __pyx_t_6 = PyNumber_Subtract(__pyx_t_1, __pyx_v_q); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 284, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Power(__pyx_int_neg_1, __pyx_t_9, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Power(__pyx_int_neg_1, __pyx_t_6, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 284, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_binom); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 265, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_2 = NULL;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_binom); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 284, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
+    __pyx_t_3 = NULL;
     __pyx_t_8 = 0;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
-      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
-      if (likely(__pyx_t_2)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
-        __Pyx_INCREF(__pyx_t_2);
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
+      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_9);
+      if (likely(__pyx_t_3)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
+        __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_6, function);
+        __Pyx_DECREF_SET(__pyx_t_9, function);
         __pyx_t_8 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
-    if (PyFunction_Check(__pyx_t_6)) {
-      PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_v_l, __pyx_v_q};
-      __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 265, __pyx_L1_error)
-      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __Pyx_GOTREF(__pyx_t_9);
+    if (PyFunction_Check(__pyx_t_9)) {
+      PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_l, __pyx_v_q};
+      __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 284, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_GOTREF(__pyx_t_6);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
-    if (__Pyx_PyFastCFunction_Check(__pyx_t_6)) {
-      PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_v_l, __pyx_v_q};
-      __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 265, __pyx_L1_error)
-      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __Pyx_GOTREF(__pyx_t_9);
+    if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
+      PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_l, __pyx_v_q};
+      __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 284, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_GOTREF(__pyx_t_6);
     } else
     #endif
     {
-      __pyx_t_7 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 265, __pyx_L1_error)
+      __pyx_t_7 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 284, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      if (__pyx_t_2) {
-        __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_2); __pyx_t_2 = NULL;
+      if (__pyx_t_3) {
+        __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_3); __pyx_t_3 = NULL;
       }
       __Pyx_INCREF(__pyx_v_l);
       __Pyx_GIVEREF(__pyx_v_l);
       PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_8, __pyx_v_l);
       __Pyx_INCREF(__pyx_v_q);
       __Pyx_GIVEREF(__pyx_v_q);
       PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_8, __pyx_v_q);
-      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_7, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 265, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_9);
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_7, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 284, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     }
+    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+    __pyx_t_9 = PyNumber_Multiply(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 284, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyNumber_Multiply(__pyx_t_1, __pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Multiply(__pyx_t_9, __pyx_v_edge_val); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 284, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_v_q, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 265, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = PyTuple_New(4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 265, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_INCREF(__pyx_int_0);
-    __Pyx_GIVEREF(__pyx_int_0);
-    PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_int_0);
-    __Pyx_INCREF(__pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_slice__5);
-    PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_t_1);
-    PyTuple_SET_ITEM(__pyx_t_7, 2, __pyx_t_1);
-    __Pyx_INCREF(__pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_slice__5);
-    PyTuple_SET_ITEM(__pyx_t_7, 3, __pyx_slice__5);
-    __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 265, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 265, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_INCREF(__pyx_v_j);
-    __Pyx_GIVEREF(__pyx_v_j);
-    PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_j);
-    __Pyx_INCREF(__pyx_v_j);
-    __Pyx_GIVEREF(__pyx_v_j);
-    PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_v_j);
-    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 265, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_diagonal); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 265, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = NULL;
-    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
-      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_7);
-      if (likely(__pyx_t_2)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
-        __Pyx_INCREF(__pyx_t_2);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_7, function);
-      }
-    }
-    __pyx_t_9 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_7);
-    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Power(__pyx_v_ave_i, __pyx_v_k, Py_None); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 284, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyNumber_Multiply(__pyx_t_6, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 265, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_7);
+    __pyx_t_1 = PyNumber_Multiply(__pyx_t_6, __pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 284, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Power(__pyx_v_ave_i, __pyx_v_k, Py_None); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Subtract(__pyx_v_l, __pyx_v_q); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 284, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_6 = PyNumber_Multiply(__pyx_t_7, __pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Power(__pyx_v_ave_j, __pyx_t_9, Py_None); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 284, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Subtract(__pyx_v_l, __pyx_v_q); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 265, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_7 = PyNumber_Power(__pyx_v_ave_j, __pyx_t_9, Py_None); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 265, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Multiply(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 265, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Multiply(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 284, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyNumber_InPlaceAdd(__pyx_v_com, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 265, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_7);
+    __pyx_t_6 = PyNumber_InPlaceAdd(__pyx_v_com, __pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 284, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __Pyx_DECREF_SET(__pyx_v_com, __pyx_t_7);
-    __pyx_t_7 = 0;
+    __Pyx_DECREF_SET(__pyx_v_com, __pyx_t_6);
+    __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":264
- *   for p in range(2, k + 1):
- *     com += (-1) ** (k + l - p) * binom(k, p) * raw[0,:,p-2,:][i, i]            * ave_j ** l * ave_i ** (k - p)
+    /* "statmoments/_native.pyx":282
+ *     edge_val = raw[0, :, p - 2, :][i, i]
+ *     com += (-1) ** (k + l - p) * binom(k, p) * edge_val * ave_j ** l * ave_i ** (k - p)
  *   for q in range(2, l + 1):             # <<<<<<<<<<<<<<
- *     com += (-1) ** (k + l - q) * binom(l, q) * raw[0,:,q-2,:][j, j].diagonal() * ave_i ** k * ave_j ** (l - q)
- *   for p in range(1, k + 1):
+ *     edge_val = raw[0, :, q - 2, :][j, j].diagonal()
+ *     com += (-1) ** (k + l - q) * binom(l, q) * edge_val * ave_i ** k * ave_j ** (l - q)
  */
   }
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":266
- *   for q in range(2, l + 1):
- *     com += (-1) ** (k + l - q) * binom(l, q) * raw[0,:,q-2,:][j, j].diagonal() * ave_i ** k * ave_j ** (l - q)
+  /* "statmoments/_native.pyx":285
+ *     edge_val = raw[0, :, q - 2, :][j, j].diagonal()
+ *     com += (-1) ** (k + l - q) * binom(l, q) * edge_val * ave_i ** k * ave_j ** (l - q)
  *   for p in range(1, k + 1):             # <<<<<<<<<<<<<<
  *     for q in range(1, l + 1):
- *       Mpq = raw[p-1, :, q-1, :][i, j] if p <= q else raw[q-1, :, p-1, :][j, i]
+ *       Mpq = raw[p - 1, :, q - 1, :][i, j] if p <= q else raw[q - 1, :, p - 1, :][j, i]
  */
-  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_k, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 266, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 266, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
+  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_k, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 285, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 285, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
-  PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_int_1);
-  __Pyx_GIVEREF(__pyx_t_3);
-  PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_3);
-  __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 266, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
-    __pyx_t_7 = __pyx_t_3; __Pyx_INCREF(__pyx_t_7); __pyx_t_4 = 0;
+  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_int_1);
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_2);
+  __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 285, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
+    __pyx_t_6 = __pyx_t_2; __Pyx_INCREF(__pyx_t_6); __pyx_t_4 = 0;
     __pyx_t_5 = NULL;
   } else {
-    __pyx_t_4 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 266, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_5 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 266, __pyx_L1_error)
+    __pyx_t_4 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 285, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_5 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 285, __pyx_L1_error)
   }
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   for (;;) {
     if (likely(!__pyx_t_5)) {
-      if (likely(PyList_CheckExact(__pyx_t_7))) {
-        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_7)) break;
+      if (likely(PyList_CheckExact(__pyx_t_6))) {
+        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_6)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 266, __pyx_L1_error)
+        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 285, __pyx_L1_error)
         #else
-        __pyx_t_3 = PySequence_ITEM(__pyx_t_7, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 266, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
+        __pyx_t_2 = PySequence_ITEM(__pyx_t_6, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 285, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
         #endif
       } else {
-        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
+        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_6)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 266, __pyx_L1_error)
+        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 285, __pyx_L1_error)
         #else
-        __pyx_t_3 = PySequence_ITEM(__pyx_t_7, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 266, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
+        __pyx_t_2 = PySequence_ITEM(__pyx_t_6, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 285, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
         #endif
       }
     } else {
-      __pyx_t_3 = __pyx_t_5(__pyx_t_7);
-      if (unlikely(!__pyx_t_3)) {
+      __pyx_t_2 = __pyx_t_5(__pyx_t_6);
+      if (unlikely(!__pyx_t_2)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 266, __pyx_L1_error)
+          else __PYX_ERR(0, 285, __pyx_L1_error)
         }
         break;
       }
-      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_GOTREF(__pyx_t_2);
     }
-    __Pyx_XDECREF_SET(__pyx_v_p, __pyx_t_3);
-    __pyx_t_3 = 0;
+    __Pyx_XDECREF_SET(__pyx_v_p, __pyx_t_2);
+    __pyx_t_2 = 0;
 
-    /* "statmoments/_native.pyx":267
- *     com += (-1) ** (k + l - q) * binom(l, q) * raw[0,:,q-2,:][j, j].diagonal() * ave_i ** k * ave_j ** (l - q)
+    /* "statmoments/_native.pyx":286
+ *     com += (-1) ** (k + l - q) * binom(l, q) * edge_val * ave_i ** k * ave_j ** (l - q)
  *   for p in range(1, k + 1):
  *     for q in range(1, l + 1):             # <<<<<<<<<<<<<<
- *       Mpq = raw[p-1, :, q-1, :][i, j] if p <= q else raw[q-1, :, p-1, :][j, i]
+ *       Mpq = raw[p - 1, :, q - 1, :][i, j] if p <= q else raw[q - 1, :, p - 1, :][j, i]
  *       com += (-1) ** (k + l - p - q) * binom(k, p) * binom(l, q) * Mpq * ave_i ** (k - p) * ave_j ** (l - q)
  */
-    __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_l, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 267, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 267, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_l, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 286, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_INCREF(__pyx_int_1);
     __Pyx_GIVEREF(__pyx_int_1);
     PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_int_1);
-    __Pyx_GIVEREF(__pyx_t_3);
-    PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_t_3);
-    __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_9, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 267, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_GIVEREF(__pyx_t_2);
+    PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_t_2);
+    __pyx_t_2 = 0;
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_9, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
-      __pyx_t_9 = __pyx_t_3; __Pyx_INCREF(__pyx_t_9); __pyx_t_10 = 0;
+    if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
+      __pyx_t_9 = __pyx_t_2; __Pyx_INCREF(__pyx_t_9); __pyx_t_10 = 0;
       __pyx_t_11 = NULL;
     } else {
-      __pyx_t_10 = -1; __pyx_t_9 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 267, __pyx_L1_error)
+      __pyx_t_10 = -1; __pyx_t_9 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 286, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_11 = Py_TYPE(__pyx_t_9)->tp_iternext; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 267, __pyx_L1_error)
+      __pyx_t_11 = Py_TYPE(__pyx_t_9)->tp_iternext; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 286, __pyx_L1_error)
     }
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     for (;;) {
       if (likely(!__pyx_t_11)) {
         if (likely(PyList_CheckExact(__pyx_t_9))) {
           if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_9)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_9, __pyx_t_10); __Pyx_INCREF(__pyx_t_3); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 267, __pyx_L1_error)
+          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_9, __pyx_t_10); __Pyx_INCREF(__pyx_t_2); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 286, __pyx_L1_error)
           #else
-          __pyx_t_3 = PySequence_ITEM(__pyx_t_9, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 267, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
+          __pyx_t_2 = PySequence_ITEM(__pyx_t_9, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 286, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_2);
           #endif
         } else {
           if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_9)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_10); __Pyx_INCREF(__pyx_t_3); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 267, __pyx_L1_error)
+          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_10); __Pyx_INCREF(__pyx_t_2); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 286, __pyx_L1_error)
           #else
-          __pyx_t_3 = PySequence_ITEM(__pyx_t_9, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 267, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
+          __pyx_t_2 = PySequence_ITEM(__pyx_t_9, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 286, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_2);
           #endif
         }
       } else {
-        __pyx_t_3 = __pyx_t_11(__pyx_t_9);
-        if (unlikely(!__pyx_t_3)) {
+        __pyx_t_2 = __pyx_t_11(__pyx_t_9);
+        if (unlikely(!__pyx_t_2)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 267, __pyx_L1_error)
+            else __PYX_ERR(0, 286, __pyx_L1_error)
           }
           break;
         }
-        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_GOTREF(__pyx_t_2);
       }
-      __Pyx_XDECREF_SET(__pyx_v_q, __pyx_t_3);
-      __pyx_t_3 = 0;
+      __Pyx_XDECREF_SET(__pyx_v_q, __pyx_t_2);
+      __pyx_t_2 = 0;
 
-      /* "statmoments/_native.pyx":268
+      /* "statmoments/_native.pyx":287
  *   for p in range(1, k + 1):
  *     for q in range(1, l + 1):
- *       Mpq = raw[p-1, :, q-1, :][i, j] if p <= q else raw[q-1, :, p-1, :][j, i]             # <<<<<<<<<<<<<<
+ *       Mpq = raw[p - 1, :, q - 1, :][i, j] if p <= q else raw[q - 1, :, p - 1, :][j, i]             # <<<<<<<<<<<<<<
  *       com += (-1) ** (k + l - p - q) * binom(k, p) * binom(l, q) * Mpq * ave_i ** (k - p) * ave_j ** (l - q)
  *   return com * inv_n
  */
-      __pyx_t_6 = PyObject_RichCompare(__pyx_v_p, __pyx_v_q, Py_LE); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 268, __pyx_L1_error)
-      __pyx_t_12 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_12 < 0)) __PYX_ERR(0, 268, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __pyx_t_1 = PyObject_RichCompare(__pyx_v_p, __pyx_v_q, Py_LE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 287, __pyx_L1_error)
+      __pyx_t_12 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_12 < 0)) __PYX_ERR(0, 287, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       if (__pyx_t_12) {
-        __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_v_p, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 268, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_v_q, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 268, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 268, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_1);
-        __Pyx_GIVEREF(__pyx_t_6);
-        PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_t_2);
-        PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_t_2);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_1, 3, __pyx_slice__5);
-        __pyx_t_6 = 0;
-        __pyx_t_2 = 0;
-        __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 268, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 268, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_v_p, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 287, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
+        __pyx_t_7 = __Pyx_PyInt_SubtractObjC(__pyx_v_q, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 287, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_7);
+        __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 287, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_GIVEREF(__pyx_t_1);
+        PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_t_7);
+        PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_7);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_3, 3, __pyx_slice__7);
+        __pyx_t_1 = 0;
+        __pyx_t_7 = 0;
+        __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 287, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_7);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 287, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
         __Pyx_INCREF(__pyx_v_i);
         __Pyx_GIVEREF(__pyx_v_i);
-        PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_i);
+        PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_i);
         __Pyx_INCREF(__pyx_v_j);
         __Pyx_GIVEREF(__pyx_v_j);
-        PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_j);
-        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 268, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_3 = __pyx_t_6;
-        __pyx_t_6 = 0;
+        PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_j);
+        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_7, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 287, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __pyx_t_2 = __pyx_t_1;
+        __pyx_t_1 = 0;
       } else {
-        __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_v_q, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 268, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_v_p, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 268, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_v_q, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 287, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 268, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
-        __Pyx_GIVEREF(__pyx_t_6);
-        PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_slice__5);
+        __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_v_p, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 287, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __pyx_t_7 = PyTuple_New(4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 287, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_7);
         __Pyx_GIVEREF(__pyx_t_1);
-        PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_t_1);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_slice__5);
-        __pyx_t_6 = 0;
+        PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_1);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_t_3);
+        PyTuple_SET_ITEM(__pyx_t_7, 2, __pyx_t_3);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_7, 3, __pyx_slice__7);
         __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 268, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_1);
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 268, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_3 = 0;
+        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 287, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+        __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 287, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_7);
         __Pyx_INCREF(__pyx_v_j);
         __Pyx_GIVEREF(__pyx_v_j);
-        PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_j);
+        PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_j);
         __Pyx_INCREF(__pyx_v_i);
         __Pyx_GIVEREF(__pyx_v_i);
-        PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_i);
-        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 268, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_3 = __pyx_t_6;
-        __pyx_t_6 = 0;
+        PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_v_i);
+        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 287, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+        __pyx_t_2 = __pyx_t_1;
+        __pyx_t_1 = 0;
       }
-      __Pyx_XDECREF_SET(__pyx_v_Mpq, __pyx_t_3);
-      __pyx_t_3 = 0;
+      __Pyx_XDECREF_SET(__pyx_v_Mpq, __pyx_t_2);
+      __pyx_t_2 = 0;
 
-      /* "statmoments/_native.pyx":269
+      /* "statmoments/_native.pyx":288
  *     for q in range(1, l + 1):
- *       Mpq = raw[p-1, :, q-1, :][i, j] if p <= q else raw[q-1, :, p-1, :][j, i]
+ *       Mpq = raw[p - 1, :, q - 1, :][i, j] if p <= q else raw[q - 1, :, p - 1, :][j, i]
  *       com += (-1) ** (k + l - p - q) * binom(k, p) * binom(l, q) * Mpq * ave_i ** (k - p) * ave_j ** (l - q)             # <<<<<<<<<<<<<<
  *   return com * inv_n
  * 
  */
-      __pyx_t_3 = PyNumber_Add(__pyx_v_k, __pyx_v_l); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 269, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_6 = PyNumber_Subtract(__pyx_t_3, __pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 269, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyNumber_Subtract(__pyx_t_6, __pyx_v_q); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 269, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = PyNumber_Power(__pyx_int_neg_1, __pyx_t_3, Py_None); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 269, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_binom); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 269, __pyx_L1_error)
+      __pyx_t_2 = PyNumber_Add(__pyx_v_k, __pyx_v_l); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_1 = NULL;
+      __pyx_t_1 = PyNumber_Subtract(__pyx_t_2, __pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_t_2 = PyNumber_Subtract(__pyx_t_1, __pyx_v_q); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_t_1 = PyNumber_Power(__pyx_int_neg_1, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_binom); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 288, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __pyx_t_3 = NULL;
       __pyx_t_8 = 0;
-      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
-        if (likely(__pyx_t_1)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-          __Pyx_INCREF(__pyx_t_1);
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
+        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_7);
+        if (likely(__pyx_t_3)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
+          __Pyx_INCREF(__pyx_t_3);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_2, function);
+          __Pyx_DECREF_SET(__pyx_t_7, function);
           __pyx_t_8 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
-      if (PyFunction_Check(__pyx_t_2)) {
-        PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_k, __pyx_v_p};
-        __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 269, __pyx_L1_error)
-        __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __Pyx_GOTREF(__pyx_t_3);
+      if (PyFunction_Check(__pyx_t_7)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_k, __pyx_v_p};
+        __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __Pyx_GOTREF(__pyx_t_2);
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
-      if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
-        PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_k, __pyx_v_p};
-        __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 269, __pyx_L1_error)
-        __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __Pyx_GOTREF(__pyx_t_3);
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_7)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_k, __pyx_v_p};
+        __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __Pyx_GOTREF(__pyx_t_2);
       } else
       #endif
       {
-        __pyx_t_13 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 269, __pyx_L1_error)
+        __pyx_t_13 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 288, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_13);
-        if (__pyx_t_1) {
-          __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_1); __pyx_t_1 = NULL;
+        if (__pyx_t_3) {
+          __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_3); __pyx_t_3 = NULL;
         }
         __Pyx_INCREF(__pyx_v_k);
         __Pyx_GIVEREF(__pyx_v_k);
         PyTuple_SET_ITEM(__pyx_t_13, 0+__pyx_t_8, __pyx_v_k);
         __Pyx_INCREF(__pyx_v_p);
         __Pyx_GIVEREF(__pyx_v_p);
         PyTuple_SET_ITEM(__pyx_t_13, 1+__pyx_t_8, __pyx_v_p);
-        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_13, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 269, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
+        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_13, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
       }
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      __pyx_t_7 = PyNumber_Multiply(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 288, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyNumber_Multiply(__pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 269, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_binom); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 269, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_binom); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
       __pyx_t_13 = NULL;
       __pyx_t_8 = 0;
-      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
-        __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_6);
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
+        __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_13)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
           __Pyx_INCREF(__pyx_t_13);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_6, function);
+          __Pyx_DECREF_SET(__pyx_t_1, function);
           __pyx_t_8 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
-      if (PyFunction_Check(__pyx_t_6)) {
+      if (PyFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[3] = {__pyx_t_13, __pyx_v_l, __pyx_v_q};
-        __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 269, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_GOTREF(__pyx_t_2);
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
-      if (__Pyx_PyFastCFunction_Check(__pyx_t_6)) {
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[3] = {__pyx_t_13, __pyx_v_l, __pyx_v_q};
-        __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 269, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_GOTREF(__pyx_t_2);
       } else
       #endif
       {
-        __pyx_t_1 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 269, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_1);
+        __pyx_t_3 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 288, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
         if (__pyx_t_13) {
-          __Pyx_GIVEREF(__pyx_t_13); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_13); __pyx_t_13 = NULL;
+          __Pyx_GIVEREF(__pyx_t_13); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_13); __pyx_t_13 = NULL;
         }
         __Pyx_INCREF(__pyx_v_l);
         __Pyx_GIVEREF(__pyx_v_l);
-        PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_8, __pyx_v_l);
+        PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_8, __pyx_v_l);
         __Pyx_INCREF(__pyx_v_q);
         __Pyx_GIVEREF(__pyx_v_q);
-        PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_8, __pyx_v_q);
-        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 269, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_8, __pyx_v_q);
+        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       }
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = PyNumber_Multiply(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 269, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_t_1 = PyNumber_Multiply(__pyx_t_7, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyNumber_Multiply(__pyx_t_6, __pyx_v_Mpq); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 269, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = PyNumber_Subtract(__pyx_v_k, __pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 269, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_2 = PyNumber_Power(__pyx_v_ave_i, __pyx_t_6, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 269, __pyx_L1_error)
+      __pyx_t_2 = PyNumber_Multiply(__pyx_t_1, __pyx_v_Mpq); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = PyNumber_Multiply(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 269, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_t_1 = PyNumber_Subtract(__pyx_v_k, __pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_7 = PyNumber_Power(__pyx_v_ave_i, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 288, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_t_1 = PyNumber_Multiply(__pyx_t_2, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyNumber_Subtract(__pyx_v_l, __pyx_v_q); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 269, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      __pyx_t_7 = PyNumber_Subtract(__pyx_v_l, __pyx_v_q); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 288, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __pyx_t_2 = PyNumber_Power(__pyx_v_ave_j, __pyx_t_7, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_3 = PyNumber_Power(__pyx_v_ave_j, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 269, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      __pyx_t_7 = PyNumber_Multiply(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 288, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyNumber_Multiply(__pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 269, __pyx_L1_error)
+      __pyx_t_2 = PyNumber_InPlaceAdd(__pyx_v_com, __pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_com, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 269, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __Pyx_DECREF_SET(__pyx_v_com, __pyx_t_3);
-      __pyx_t_3 = 0;
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      __Pyx_DECREF_SET(__pyx_v_com, __pyx_t_2);
+      __pyx_t_2 = 0;
 
-      /* "statmoments/_native.pyx":267
- *     com += (-1) ** (k + l - q) * binom(l, q) * raw[0,:,q-2,:][j, j].diagonal() * ave_i ** k * ave_j ** (l - q)
+      /* "statmoments/_native.pyx":286
+ *     com += (-1) ** (k + l - q) * binom(l, q) * edge_val * ave_i ** k * ave_j ** (l - q)
  *   for p in range(1, k + 1):
  *     for q in range(1, l + 1):             # <<<<<<<<<<<<<<
- *       Mpq = raw[p-1, :, q-1, :][i, j] if p <= q else raw[q-1, :, p-1, :][j, i]
+ *       Mpq = raw[p - 1, :, q - 1, :][i, j] if p <= q else raw[q - 1, :, p - 1, :][j, i]
  *       com += (-1) ** (k + l - p - q) * binom(k, p) * binom(l, q) * Mpq * ave_i ** (k - p) * ave_j ** (l - q)
  */
     }
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-    /* "statmoments/_native.pyx":266
- *   for q in range(2, l + 1):
- *     com += (-1) ** (k + l - q) * binom(l, q) * raw[0,:,q-2,:][j, j].diagonal() * ave_i ** k * ave_j ** (l - q)
+    /* "statmoments/_native.pyx":285
+ *     edge_val = raw[0, :, q - 2, :][j, j].diagonal()
+ *     com += (-1) ** (k + l - q) * binom(l, q) * edge_val * ave_i ** k * ave_j ** (l - q)
  *   for p in range(1, k + 1):             # <<<<<<<<<<<<<<
  *     for q in range(1, l + 1):
- *       Mpq = raw[p-1, :, q-1, :][i, j] if p <= q else raw[q-1, :, p-1, :][j, i]
+ *       Mpq = raw[p - 1, :, q - 1, :][i, j] if p <= q else raw[q - 1, :, p - 1, :][j, i]
  */
   }
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "statmoments/_native.pyx":270
- *       Mpq = raw[p-1, :, q-1, :][i, j] if p <= q else raw[q-1, :, p-1, :][j, i]
+  /* "statmoments/_native.pyx":289
+ *       Mpq = raw[p - 1, :, q - 1, :][i, j] if p <= q else raw[q - 1, :, p - 1, :][j, i]
  *       com += (-1) ** (k + l - p - q) * binom(k, p) * binom(l, q) * Mpq * ave_i ** (k - p) * ave_j ** (l - q)
  *   return com * inv_n             # <<<<<<<<<<<<<<
  * 
  * @cython.cfunc
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_7 = PyNumber_Multiply(__pyx_v_com, __pyx_v_inv_n); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 270, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __pyx_r = __pyx_t_7;
-  __pyx_t_7 = 0;
+  __pyx_t_6 = PyNumber_Multiply(__pyx_v_com, __pyx_v_inv_n); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 289, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_6);
+  __pyx_r = __pyx_t_6;
+  __pyx_t_6 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":254
- * 
+  /* "statmoments/_native.pyx":271
+ *   return M
  * 
  * def calc_central_moment_general(raw, ave, n, k, l, i, j):             # <<<<<<<<<<<<<<
  *   """ Calculate co-moments for any available moments """
- *   ave_i = ave[i]
+ *   ave_i = ave[i]  # i is a scalar
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
@@ -9407,22 +9766,23 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_ave_i);
   __Pyx_XDECREF(__pyx_v_ave_j);
   __Pyx_XDECREF(__pyx_v_inv_n);
   __Pyx_XDECREF(__pyx_v_com);
   __Pyx_XDECREF(__pyx_v_p);
+  __Pyx_XDECREF(__pyx_v_edge_val);
   __Pyx_XDECREF(__pyx_v_q);
   __Pyx_XDECREF(__pyx_v_Mpq);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":274
+/* "statmoments/_native.pyx":293
  * @cython.cfunc
  * @cython.locals(n=cython.double, lm=cython.int, rm=cython.int, i=cython.int)
  * def calc_central_moments(raw, ave, n, lm, rm, i, j):             # <<<<<<<<<<<<<<
  *   """Optimized for moments (1, 1) and (2, 2). For others calc_central_moment_general is called"""
  * 
  */
 
@@ -9441,1506 +9801,1514 @@
   PyObject *__pyx_v_M_33 = NULL;
   PyObject *__pyx_v_M_34 = NULL;
   PyObject *__pyx_v_M_44 = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_t_2;
-  PyObject *__pyx_t_3 = NULL;
+  int __pyx_t_3;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
-  int __pyx_t_6;
+  PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
   PyObject *__pyx_t_10 = NULL;
   PyObject *__pyx_t_11 = NULL;
   PyObject *__pyx_t_12 = NULL;
   int __pyx_t_13;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("calc_central_moments", 0);
 
-  /* "statmoments/_native.pyx":277
+  /* "statmoments/_native.pyx":296
  *   """Optimized for moments (1, 1) and (2, 2). For others calc_central_moment_general is called"""
  * 
  *   inv_n = 1.0 / n             # <<<<<<<<<<<<<<
- *   ave_i = ave[i] # i is a scalar number
- *   ave_j = ave[j] # j is a slice such that indices (j, j) add diagonal!
+ *   ave_i = ave[i]  # i is a scalar
+ *   ave_j = ave[j]  # j is a slice such that indices (j, j) add diagonal!
  */
   __pyx_v_inv_n = (1.0 / __pyx_v_n);
 
-  /* "statmoments/_native.pyx":278
+  /* "statmoments/_native.pyx":297
  * 
  *   inv_n = 1.0 / n
- *   ave_i = ave[i] # i is a scalar number             # <<<<<<<<<<<<<<
- *   ave_j = ave[j] # j is a slice such that indices (j, j) add diagonal!
+ *   ave_i = ave[i]  # i is a scalar             # <<<<<<<<<<<<<<
+ *   ave_j = ave[j]  # j is a slice such that indices (j, j) add diagonal!
  * 
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_ave, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 278, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_ave, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_ave_i = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":279
+  /* "statmoments/_native.pyx":298
  *   inv_n = 1.0 / n
- *   ave_i = ave[i] # i is a scalar number
- *   ave_j = ave[j] # j is a slice such that indices (j, j) add diagonal!             # <<<<<<<<<<<<<<
+ *   ave_i = ave[i]  # i is a scalar
+ *   ave_j = ave[j]  # j is a slice such that indices (j, j) add diagonal!             # <<<<<<<<<<<<<<
  * 
  *   # Expressions for conversions raw moments to central moments in the
  */
-  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_ave, __pyx_v_j); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 279, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_ave, __pyx_v_j); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 298, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_ave_j = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":283
- *   # Expressions for conversions raw moments to central moments in the
- *   # Horner representation generated with sympy
- *   if lm + rm == 2:                             # E(X Y)             # <<<<<<<<<<<<<<
- *     M_11 = raw[0,:,0,:]
+  /* "statmoments/_native.pyx":304
+ *   if False:
+ *     pass # Helps formatting for all cases
+ *   elif lm == 1 and rm == 1:  # E(X Y)             # <<<<<<<<<<<<<<
+ *     M_11 = raw[0, :, 0, :]   # 0
  *     m = M_11[i, j] * inv_n - ave_i * ave_j
  */
-  __pyx_t_2 = (((__pyx_v_lm + __pyx_v_rm) == 2) != 0);
+  __pyx_t_3 = ((__pyx_v_lm == 1) != 0);
+  if (__pyx_t_3) {
+  } else {
+    __pyx_t_2 = __pyx_t_3;
+    goto __pyx_L4_bool_binop_done;
+  }
+  __pyx_t_3 = ((__pyx_v_rm == 1) != 0);
+  __pyx_t_2 = __pyx_t_3;
+  __pyx_L4_bool_binop_done:;
   if (__pyx_t_2) {
 
-    /* "statmoments/_native.pyx":284
- *   # Horner representation generated with sympy
- *   if lm + rm == 2:                             # E(X Y)
- *     M_11 = raw[0,:,0,:]             # <<<<<<<<<<<<<<
+    /* "statmoments/_native.pyx":305
+ *     pass # Helps formatting for all cases
+ *   elif lm == 1 and rm == 1:  # E(X Y)
+ *     M_11 = raw[0, :, 0, :]   # 0             # <<<<<<<<<<<<<<
  *     m = M_11[i, j] * inv_n - ave_i * ave_j
- *   elif lm + rm == 3:                           # E(XX Y)
+ *   elif lm + rm == 3:         # E(XX Y)
  */
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 284, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 305, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_v_M_11 = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":285
- *   if lm + rm == 2:                             # E(X Y)
- *     M_11 = raw[0,:,0,:]
+    /* "statmoments/_native.pyx":306
+ *   elif lm == 1 and rm == 1:  # E(X Y)
+ *     M_11 = raw[0, :, 0, :]   # 0
  *     m = M_11[i, j] * inv_n - ave_i * ave_j             # <<<<<<<<<<<<<<
- *   elif lm + rm == 3:                           # E(XX Y)
- *     M_11 = raw[0,:,0,:]  # 0
+ *   elif lm + rm == 3:         # E(XX Y)
+ *     M_11 = raw[0, :, 0, :]   # 0
  */
-    __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 285, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 306, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 285, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 306, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_1);
-    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
+    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
-    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_j);
+    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_j);
     __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_M_11, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 285, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_M_11, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 306, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_inv_n); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 285, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 285, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_inv_n); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 306, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_5 = PyNumber_Multiply(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 306, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_v_ave_j); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 285, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_1 = PyNumber_Subtract(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 285, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_v_ave_j); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 306, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_1 = PyNumber_Subtract(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 306, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_v_m = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":283
- *   # Expressions for conversions raw moments to central moments in the
- *   # Horner representation generated with sympy
- *   if lm + rm == 2:                             # E(X Y)             # <<<<<<<<<<<<<<
- *     M_11 = raw[0,:,0,:]
+    /* "statmoments/_native.pyx":304
+ *   if False:
+ *     pass # Helps formatting for all cases
+ *   elif lm == 1 and rm == 1:  # E(X Y)             # <<<<<<<<<<<<<<
+ *     M_11 = raw[0, :, 0, :]   # 0
  *     m = M_11[i, j] * inv_n - ave_i * ave_j
  */
     goto __pyx_L3;
   }
 
-  /* "statmoments/_native.pyx":286
- *     M_11 = raw[0,:,0,:]
+  /* "statmoments/_native.pyx":307
+ *     M_11 = raw[0, :, 0, :]   # 0
  *     m = M_11[i, j] * inv_n - ave_i * ave_j
- *   elif lm + rm == 3:                           # E(XX Y)             # <<<<<<<<<<<<<<
- *     M_11 = raw[0,:,0,:]  # 0
- *     M_12 = raw[0,:,1,:]
+ *   elif lm + rm == 3:         # E(XX Y)             # <<<<<<<<<<<<<<
+ *     M_11 = raw[0, :, 0, :]   # 0
+ *     M_12 = raw[0, :, 1, :]
  */
   __pyx_t_2 = (((__pyx_v_lm + __pyx_v_rm) == 3) != 0);
   if (__pyx_t_2) {
 
-    /* "statmoments/_native.pyx":287
+    /* "statmoments/_native.pyx":308
  *     m = M_11[i, j] * inv_n - ave_i * ave_j
- *   elif lm + rm == 3:                           # E(XX Y)
- *     M_11 = raw[0,:,0,:]  # 0             # <<<<<<<<<<<<<<
- *     M_12 = raw[0,:,1,:]
- *     m = ave_j*(2*n*ave_i*ave_j - 2*M_11[i, j]) \
+ *   elif lm + rm == 3:         # E(XX Y)
+ *     M_11 = raw[0, :, 0, :]   # 0             # <<<<<<<<<<<<<<
+ *     M_12 = raw[0, :, 1, :]
+ *     m = ave_j * (2 * n * ave_i * ave_j - 2 * M_11[i, j]) \
  */
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 287, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 308, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_v_M_11 = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":288
- *   elif lm + rm == 3:                           # E(XX Y)
- *     M_11 = raw[0,:,0,:]  # 0
- *     M_12 = raw[0,:,1,:]             # <<<<<<<<<<<<<<
- *     m = ave_j*(2*n*ave_i*ave_j - 2*M_11[i, j]) \
- *         - ave_i*M_11[j, j].diagonal() \
+    /* "statmoments/_native.pyx":309
+ *   elif lm + rm == 3:         # E(XX Y)
+ *     M_11 = raw[0, :, 0, :]   # 0
+ *     M_12 = raw[0, :, 1, :]             # <<<<<<<<<<<<<<
+ *     m = ave_j * (2 * n * ave_i * ave_j - 2 * M_11[i, j]) \
+ *         - ave_i * M_11[j, j].diagonal() \
  */
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 309, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_v_M_12 = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":289
- *     M_11 = raw[0,:,0,:]  # 0
- *     M_12 = raw[0,:,1,:]
- *     m = ave_j*(2*n*ave_i*ave_j - 2*M_11[i, j]) \             # <<<<<<<<<<<<<<
- *         - ave_i*M_11[j, j].diagonal() \
+    /* "statmoments/_native.pyx":310
+ *     M_11 = raw[0, :, 0, :]   # 0
+ *     M_12 = raw[0, :, 1, :]
+ *     m = ave_j * (2 * n * ave_i * ave_j - 2 * M_11[i, j]) \             # <<<<<<<<<<<<<<
+ *         - ave_i * M_11[j, j].diagonal() \
  *         + M_12[i, j]
  */
-    __pyx_t_1 = PyFloat_FromDouble((2.0 * __pyx_v_n)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 289, __pyx_L1_error)
+    __pyx_t_1 = PyFloat_FromDouble((2.0 * __pyx_v_n)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 310, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_v_ave_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 289, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_v_ave_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 310, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Multiply(__pyx_t_3, __pyx_v_ave_j); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 289, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Multiply(__pyx_t_4, __pyx_v_ave_j); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 310, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 289, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 289, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 310, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_GIVEREF(__pyx_t_3);
-    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 310, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_GIVEREF(__pyx_t_4);
+    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
-    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_j);
-    __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_M_11, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 289, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_j);
+    __pyx_t_4 = 0;
+    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_M_11, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 310, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = PyNumber_Multiply(__pyx_int_2, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 310, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Multiply(__pyx_int_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 289, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Subtract(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 310, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 289, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = PyNumber_Multiply(__pyx_v_ave_j, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 310, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Multiply(__pyx_v_ave_j, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 289, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "statmoments/_native.pyx":290
- *     M_12 = raw[0,:,1,:]
- *     m = ave_j*(2*n*ave_i*ave_j - 2*M_11[i, j]) \
- *         - ave_i*M_11[j, j].diagonal() \             # <<<<<<<<<<<<<<
+    /* "statmoments/_native.pyx":311
+ *     M_12 = raw[0, :, 1, :]
+ *     m = ave_j * (2 * n * ave_i * ave_j - 2 * M_11[i, j]) \
+ *         - ave_i * M_11[j, j].diagonal() \             # <<<<<<<<<<<<<<
  *         + M_12[i, j]
  *     m *= inv_n
  */
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 290, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 311, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_j);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_j);
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_M_11, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 290, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_M_11, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 311, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_diagonal); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 290, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_diagonal); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 311, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = NULL;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
-      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
-      if (likely(__pyx_t_5)) {
+      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
+      if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
-        __Pyx_INCREF(__pyx_t_5);
+        __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
-    __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_5) : __Pyx_PyObject_CallNoArg(__pyx_t_1);
-    __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 290, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_4 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_6) : __Pyx_PyObject_CallNoArg(__pyx_t_1);
+    __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 311, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 290, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 311, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Subtract(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 290, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = PyNumber_Subtract(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 311, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":291
- *     m = ave_j*(2*n*ave_i*ave_j - 2*M_11[i, j]) \
- *         - ave_i*M_11[j, j].diagonal() \
+    /* "statmoments/_native.pyx":312
+ *     m = ave_j * (2 * n * ave_i * ave_j - 2 * M_11[i, j]) \
+ *         - ave_i * M_11[j, j].diagonal() \
  *         + M_12[i, j]             # <<<<<<<<<<<<<<
  *     m *= inv_n
- *   elif lm == 2 and rm == 2:                    # E(XX YY)
+ *   elif lm == 2 and rm == 2:  # E(XX YY)
  */
-    __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 291, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 312, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 291, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 312, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_1);
-    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
+    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
-    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_j);
+    PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_j);
     __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_M_12, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 291, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_M_12, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 312, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = PyNumber_Add(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 312, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Add(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 291, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_v_m = __pyx_t_4;
-    __pyx_t_4 = 0;
+    __pyx_v_m = __pyx_t_5;
+    __pyx_t_5 = 0;
 
-    /* "statmoments/_native.pyx":292
- *         - ave_i*M_11[j, j].diagonal() \
+    /* "statmoments/_native.pyx":313
+ *         - ave_i * M_11[j, j].diagonal() \
  *         + M_12[i, j]
  *     m *= inv_n             # <<<<<<<<<<<<<<
- *   elif lm == 2 and rm == 2:                    # E(XX YY)
- *     M_11 = raw[0,:,0,:]  # 0
+ *   elif lm == 2 and rm == 2:  # E(XX YY)
+ *     M_11 = raw[0, :, 0, :]   # 0
  */
-    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_inv_n); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 292, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = PyNumber_InPlaceMultiply(__pyx_v_m, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 292, __pyx_L1_error)
+    __pyx_t_5 = PyFloat_FromDouble(__pyx_v_inv_n); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 313, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_1 = PyNumber_InPlaceMultiply(__pyx_v_m, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 313, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF_SET(__pyx_v_m, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":286
- *     M_11 = raw[0,:,0,:]
+    /* "statmoments/_native.pyx":307
+ *     M_11 = raw[0, :, 0, :]   # 0
  *     m = M_11[i, j] * inv_n - ave_i * ave_j
- *   elif lm + rm == 3:                           # E(XX Y)             # <<<<<<<<<<<<<<
- *     M_11 = raw[0,:,0,:]  # 0
- *     M_12 = raw[0,:,1,:]
+ *   elif lm + rm == 3:         # E(XX Y)             # <<<<<<<<<<<<<<
+ *     M_11 = raw[0, :, 0, :]   # 0
+ *     M_12 = raw[0, :, 1, :]
  */
     goto __pyx_L3;
   }
 
-  /* "statmoments/_native.pyx":293
+  /* "statmoments/_native.pyx":314
  *         + M_12[i, j]
  *     m *= inv_n
- *   elif lm == 2 and rm == 2:                    # E(XX YY)             # <<<<<<<<<<<<<<
- *     M_11 = raw[0,:,0,:]  # 0
- *     M_12 = raw[0,:,1,:]
+ *   elif lm == 2 and rm == 2:  # E(XX YY)             # <<<<<<<<<<<<<<
+ *     M_11 = raw[0, :, 0, :]   # 0
+ *     M_12 = raw[0, :, 1, :]
  */
-  __pyx_t_6 = ((__pyx_v_lm == 2) != 0);
-  if (__pyx_t_6) {
+  __pyx_t_3 = ((__pyx_v_lm == 2) != 0);
+  if (__pyx_t_3) {
   } else {
-    __pyx_t_2 = __pyx_t_6;
-    goto __pyx_L4_bool_binop_done;
+    __pyx_t_2 = __pyx_t_3;
+    goto __pyx_L6_bool_binop_done;
   }
-  __pyx_t_6 = ((__pyx_v_rm == 2) != 0);
-  __pyx_t_2 = __pyx_t_6;
-  __pyx_L4_bool_binop_done:;
+  __pyx_t_3 = ((__pyx_v_rm == 2) != 0);
+  __pyx_t_2 = __pyx_t_3;
+  __pyx_L6_bool_binop_done:;
   if (__pyx_t_2) {
 
-    /* "statmoments/_native.pyx":294
+    /* "statmoments/_native.pyx":315
  *     m *= inv_n
- *   elif lm == 2 and rm == 2:                    # E(XX YY)
- *     M_11 = raw[0,:,0,:]  # 0             # <<<<<<<<<<<<<<
- *     M_12 = raw[0,:,1,:]
- *     M_22 = raw[1,:,1,:]  # 1
+ *   elif lm == 2 and rm == 2:  # E(XX YY)
+ *     M_11 = raw[0, :, 0, :]   # 0             # <<<<<<<<<<<<<<
+ *     M_12 = raw[0, :, 1, :]
+ *     M_22 = raw[1, :, 1, :]   # 1
  */
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 294, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 315, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_v_M_11 = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":295
- *   elif lm == 2 and rm == 2:                    # E(XX YY)
- *     M_11 = raw[0,:,0,:]  # 0
- *     M_12 = raw[0,:,1,:]             # <<<<<<<<<<<<<<
- *     M_22 = raw[1,:,1,:]  # 1
- *     m = ave_i*(ave_i*M_11[j, j].diagonal() - 2 * M_12[i, j]) \
+    /* "statmoments/_native.pyx":316
+ *   elif lm == 2 and rm == 2:  # E(XX YY)
+ *     M_11 = raw[0, :, 0, :]   # 0
+ *     M_12 = raw[0, :, 1, :]             # <<<<<<<<<<<<<<
+ *     M_22 = raw[1, :, 1, :]   # 1
+ *     m = ave_i * (ave_i * M_11[j, j].diagonal() - 2 * M_12[i, j]) \
  */
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 295, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 316, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_v_M_12 = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":296
- *     M_11 = raw[0,:,0,:]  # 0
- *     M_12 = raw[0,:,1,:]
- *     M_22 = raw[1,:,1,:]  # 1             # <<<<<<<<<<<<<<
- *     m = ave_i*(ave_i*M_11[j, j].diagonal() - 2 * M_12[i, j]) \
- *         + ave_j*(4*ave_i*M_11[i, j] + ave_j*(M_11[i, i] - 3*n*ave_i*ave_i) - 2*M_12[j, i]) \
+    /* "statmoments/_native.pyx":317
+ *     M_11 = raw[0, :, 0, :]   # 0
+ *     M_12 = raw[0, :, 1, :]
+ *     M_22 = raw[1, :, 1, :]   # 1             # <<<<<<<<<<<<<<
+ *     m = ave_i * (ave_i * M_11[j, j].diagonal() - 2 * M_12[i, j]) \
+ *         + ave_j * (4 * ave_i * M_11[i, j] + ave_j * (M_11[i, i] - 3 * n * ave_i * ave_i) - 2 * M_12[j, i]) \
  */
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 296, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 317, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_v_M_22 = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":297
- *     M_12 = raw[0,:,1,:]
- *     M_22 = raw[1,:,1,:]  # 1
- *     m = ave_i*(ave_i*M_11[j, j].diagonal() - 2 * M_12[i, j]) \             # <<<<<<<<<<<<<<
- *         + ave_j*(4*ave_i*M_11[i, j] + ave_j*(M_11[i, i] - 3*n*ave_i*ave_i) - 2*M_12[j, i]) \
+    /* "statmoments/_native.pyx":318
+ *     M_12 = raw[0, :, 1, :]
+ *     M_22 = raw[1, :, 1, :]   # 1
+ *     m = ave_i * (ave_i * M_11[j, j].diagonal() - 2 * M_12[i, j]) \             # <<<<<<<<<<<<<<
+ *         + ave_j * (4 * ave_i * M_11[i, j] + ave_j * (M_11[i, i] - 3 * n * ave_i * ave_i) - 2 * M_12[j, i]) \
  *         + M_22[i, j]
  */
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 297, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
-    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_j);
+    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_j);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
-    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_j);
-    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_M_11, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 297, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_diagonal); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 297, __pyx_L1_error)
+    PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_j);
+    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_M_11, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 318, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = NULL;
-    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
-      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
-      if (likely(__pyx_t_3)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
-        __Pyx_INCREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_diagonal); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = NULL;
+    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
+      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
+      if (likely(__pyx_t_4)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
+        __Pyx_INCREF(__pyx_t_4);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_4, function);
+        __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
-    __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
-    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 297, __pyx_L1_error)
+    __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_5);
+    __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 318, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 297, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 297, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 318, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 297, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_1);
-    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
+    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
-    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_j);
+    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_j);
     __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_M_12, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 297, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_M_12, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 318, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Multiply(__pyx_int_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 297, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = PyNumber_Multiply(__pyx_int_2, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Subtract(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 297, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Subtract(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 318, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 297, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_4 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":298
- *     M_22 = raw[1,:,1,:]  # 1
- *     m = ave_i*(ave_i*M_11[j, j].diagonal() - 2 * M_12[i, j]) \
- *         + ave_j*(4*ave_i*M_11[i, j] + ave_j*(M_11[i, i] - 3*n*ave_i*ave_i) - 2*M_12[j, i]) \             # <<<<<<<<<<<<<<
+    /* "statmoments/_native.pyx":319
+ *     M_22 = raw[1, :, 1, :]   # 1
+ *     m = ave_i * (ave_i * M_11[j, j].diagonal() - 2 * M_12[i, j]) \
+ *         + ave_j * (4 * ave_i * M_11[i, j] + ave_j * (M_11[i, i] - 3 * n * ave_i * ave_i) - 2 * M_12[j, i]) \             # <<<<<<<<<<<<<<
  *         + M_22[i, j]
  *     m *= inv_n
  */
-    __pyx_t_1 = PyNumber_Multiply(__pyx_int_4, __pyx_v_ave_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Multiply(__pyx_int_4, __pyx_v_ave_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 319, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 298, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 319, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_GIVEREF(__pyx_t_4);
-    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 319, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_GIVEREF(__pyx_t_5);
+    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
-    PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_j);
-    __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_M_11, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 298, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_Multiply(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 298, __pyx_L1_error)
+    PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_v_j);
+    __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_M_11, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 319, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyNumber_Multiply(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 319, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 298, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 319, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 319, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 319, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_GIVEREF(__pyx_t_4);
-    PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4);
+    __Pyx_GIVEREF(__pyx_t_5);
+    PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_1);
-    __pyx_t_4 = 0;
+    __pyx_t_5 = 0;
     __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_M_11, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_M_11, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 319, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyFloat_FromDouble((3.0 * __pyx_v_n)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_7 = PyFloat_FromDouble((3.0 * __pyx_v_n)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 319, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_4 = PyNumber_Multiply(__pyx_t_7, __pyx_v_ave_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 298, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_5 = PyNumber_Multiply(__pyx_t_7, __pyx_v_ave_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 319, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyNumber_Multiply(__pyx_t_4, __pyx_v_ave_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_7 = PyNumber_Multiply(__pyx_t_5, __pyx_v_ave_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 319, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Subtract(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 298, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = PyNumber_Subtract(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 319, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyNumber_Multiply(__pyx_v_ave_j, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_7 = PyNumber_Multiply(__pyx_v_ave_j, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 319, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Add(__pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 298, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = PyNumber_Add(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 319, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 319, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 298, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 319, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
-    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_j);
+    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_j);
     __Pyx_GIVEREF(__pyx_t_7);
-    PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_7);
+    PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_7);
     __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_M_12, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_M_12, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 319, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_Multiply(__pyx_int_2, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 298, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyNumber_Multiply(__pyx_int_2, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 319, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyNumber_Subtract(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_7 = PyNumber_Subtract(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 319, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_Multiply(__pyx_v_ave_j, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 298, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyNumber_Multiply(__pyx_v_ave_j, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 319, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyNumber_Add(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_7 = PyNumber_Add(__pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 319, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":299
- *     m = ave_i*(ave_i*M_11[j, j].diagonal() - 2 * M_12[i, j]) \
- *         + ave_j*(4*ave_i*M_11[i, j] + ave_j*(M_11[i, i] - 3*n*ave_i*ave_i) - 2*M_12[j, i]) \
+    /* "statmoments/_native.pyx":320
+ *     m = ave_i * (ave_i * M_11[j, j].diagonal() - 2 * M_12[i, j]) \
+ *         + ave_j * (4 * ave_i * M_11[i, j] + ave_j * (M_11[i, i] - 3 * n * ave_i * ave_i) - 2 * M_12[j, i]) \
  *         + M_22[i, j]             # <<<<<<<<<<<<<<
  *     m *= inv_n
- *   elif lm == 4 and rm == 4:                    # E(XXXX YYYY)
+ *   elif lm == 4 and rm == 4:  # E(XXXX YYYY)
  */
-    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 299, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 299, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_GIVEREF(__pyx_t_5);
-    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
+    __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_GIVEREF(__pyx_t_6);
+    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
-    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_j);
-    __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_M_22, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 299, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Add(__pyx_t_7, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 299, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_j);
+    __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_M_22, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = PyNumber_Add(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_v_m = __pyx_t_3;
-    __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_v_m = __pyx_t_4;
+    __pyx_t_4 = 0;
 
-    /* "statmoments/_native.pyx":300
- *         + ave_j*(4*ave_i*M_11[i, j] + ave_j*(M_11[i, i] - 3*n*ave_i*ave_i) - 2*M_12[j, i]) \
+    /* "statmoments/_native.pyx":321
+ *         + ave_j * (4 * ave_i * M_11[i, j] + ave_j * (M_11[i, i] - 3 * n * ave_i * ave_i) - 2 * M_12[j, i]) \
  *         + M_22[i, j]
  *     m *= inv_n             # <<<<<<<<<<<<<<
- *   elif lm == 4 and rm == 4:                    # E(XXXX YYYY)
- *     M_11 = raw[0,:,0,:]  # 0
+ *   elif lm == 4 and rm == 4:  # E(XXXX YYYY)
+ *     M_11 = raw[0, :, 0, :]   # 0
  */
-    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_inv_n); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 300, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_5 = PyNumber_InPlaceMultiply(__pyx_v_m, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 300, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_DECREF_SET(__pyx_v_m, __pyx_t_5);
-    __pyx_t_5 = 0;
+    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_inv_n); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 321, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_6 = PyNumber_InPlaceMultiply(__pyx_v_m, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 321, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF_SET(__pyx_v_m, __pyx_t_6);
+    __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":293
+    /* "statmoments/_native.pyx":314
  *         + M_12[i, j]
  *     m *= inv_n
- *   elif lm == 2 and rm == 2:                    # E(XX YY)             # <<<<<<<<<<<<<<
- *     M_11 = raw[0,:,0,:]  # 0
- *     M_12 = raw[0,:,1,:]
+ *   elif lm == 2 and rm == 2:  # E(XX YY)             # <<<<<<<<<<<<<<
+ *     M_11 = raw[0, :, 0, :]   # 0
+ *     M_12 = raw[0, :, 1, :]
  */
     goto __pyx_L3;
   }
 
-  /* "statmoments/_native.pyx":301
+  /* "statmoments/_native.pyx":322
  *         + M_22[i, j]
  *     m *= inv_n
- *   elif lm == 4 and rm == 4:                    # E(XXXX YYYY)             # <<<<<<<<<<<<<<
- *     M_11 = raw[0,:,0,:]  # 0
- *     M_12 = raw[0,:,1,:]
+ *   elif lm == 4 and rm == 4:  # E(XXXX YYYY)             # <<<<<<<<<<<<<<
+ *     M_11 = raw[0, :, 0, :]   # 0
+ *     M_12 = raw[0, :, 1, :]
  */
-  __pyx_t_6 = ((__pyx_v_lm == 4) != 0);
-  if (__pyx_t_6) {
+  __pyx_t_3 = ((__pyx_v_lm == 4) != 0);
+  if (__pyx_t_3) {
   } else {
-    __pyx_t_2 = __pyx_t_6;
-    goto __pyx_L6_bool_binop_done;
+    __pyx_t_2 = __pyx_t_3;
+    goto __pyx_L8_bool_binop_done;
   }
-  __pyx_t_6 = ((__pyx_v_rm == 4) != 0);
-  __pyx_t_2 = __pyx_t_6;
-  __pyx_L6_bool_binop_done:;
+  __pyx_t_3 = ((__pyx_v_rm == 4) != 0);
+  __pyx_t_2 = __pyx_t_3;
+  __pyx_L8_bool_binop_done:;
   if (__pyx_t_2) {
 
-    /* "statmoments/_native.pyx":302
+    /* "statmoments/_native.pyx":323
  *     m *= inv_n
- *   elif lm == 4 and rm == 4:                    # E(XXXX YYYY)
- *     M_11 = raw[0,:,0,:]  # 0             # <<<<<<<<<<<<<<
- *     M_12 = raw[0,:,1,:]
- *     M_13 = raw[0,:,2,:]
+ *   elif lm == 4 and rm == 4:  # E(XXXX YYYY)
+ *     M_11 = raw[0, :, 0, :]   # 0             # <<<<<<<<<<<<<<
+ *     M_12 = raw[0, :, 1, :]
+ *     M_13 = raw[0, :, 2, :]
  */
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 302, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_v_M_11 = __pyx_t_5;
-    __pyx_t_5 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 323, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_v_M_11 = __pyx_t_6;
+    __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":303
- *   elif lm == 4 and rm == 4:                    # E(XXXX YYYY)
- *     M_11 = raw[0,:,0,:]  # 0
- *     M_12 = raw[0,:,1,:]             # <<<<<<<<<<<<<<
- *     M_13 = raw[0,:,2,:]
- *     M_14 = raw[0,:,3,:]
+    /* "statmoments/_native.pyx":324
+ *   elif lm == 4 and rm == 4:  # E(XXXX YYYY)
+ *     M_11 = raw[0, :, 0, :]   # 0
+ *     M_12 = raw[0, :, 1, :]             # <<<<<<<<<<<<<<
+ *     M_13 = raw[0, :, 2, :]
+ *     M_14 = raw[0, :, 3, :]
  */
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 303, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_v_M_12 = __pyx_t_5;
-    __pyx_t_5 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 324, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_v_M_12 = __pyx_t_6;
+    __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":304
- *     M_11 = raw[0,:,0,:]  # 0
- *     M_12 = raw[0,:,1,:]
- *     M_13 = raw[0,:,2,:]             # <<<<<<<<<<<<<<
- *     M_14 = raw[0,:,3,:]
- *     M_22 = raw[1,:,1,:]  # 1
+    /* "statmoments/_native.pyx":325
+ *     M_11 = raw[0, :, 0, :]   # 0
+ *     M_12 = raw[0, :, 1, :]
+ *     M_13 = raw[0, :, 2, :]             # <<<<<<<<<<<<<<
+ *     M_14 = raw[0, :, 3, :]
+ *     M_22 = raw[1, :, 1, :]   # 1
  */
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 304, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_v_M_13 = __pyx_t_5;
-    __pyx_t_5 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 325, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_v_M_13 = __pyx_t_6;
+    __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":305
- *     M_12 = raw[0,:,1,:]
- *     M_13 = raw[0,:,2,:]
- *     M_14 = raw[0,:,3,:]             # <<<<<<<<<<<<<<
- *     M_22 = raw[1,:,1,:]  # 1
- *     M_23 = raw[1,:,2,:]
+    /* "statmoments/_native.pyx":326
+ *     M_12 = raw[0, :, 1, :]
+ *     M_13 = raw[0, :, 2, :]
+ *     M_14 = raw[0, :, 3, :]             # <<<<<<<<<<<<<<
+ *     M_22 = raw[1, :, 1, :]   # 1
+ *     M_23 = raw[1, :, 2, :]
  */
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__10); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 305, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_v_M_14 = __pyx_t_5;
-    __pyx_t_5 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__12); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 326, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_v_M_14 = __pyx_t_6;
+    __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":306
- *     M_13 = raw[0,:,2,:]
- *     M_14 = raw[0,:,3,:]
- *     M_22 = raw[1,:,1,:]  # 1             # <<<<<<<<<<<<<<
- *     M_23 = raw[1,:,2,:]
- *     M_24 = raw[1,:,3,:]
+    /* "statmoments/_native.pyx":327
+ *     M_13 = raw[0, :, 2, :]
+ *     M_14 = raw[0, :, 3, :]
+ *     M_22 = raw[1, :, 1, :]   # 1             # <<<<<<<<<<<<<<
+ *     M_23 = raw[1, :, 2, :]
+ *     M_24 = raw[1, :, 3, :]
  */
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 306, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_v_M_22 = __pyx_t_5;
-    __pyx_t_5 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__10); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 327, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_v_M_22 = __pyx_t_6;
+    __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":307
- *     M_14 = raw[0,:,3,:]
- *     M_22 = raw[1,:,1,:]  # 1
- *     M_23 = raw[1,:,2,:]             # <<<<<<<<<<<<<<
- *     M_24 = raw[1,:,3,:]
- *     M_33 = raw[2,:,2,:]  # 2
+    /* "statmoments/_native.pyx":328
+ *     M_14 = raw[0, :, 3, :]
+ *     M_22 = raw[1, :, 1, :]   # 1
+ *     M_23 = raw[1, :, 2, :]             # <<<<<<<<<<<<<<
+ *     M_24 = raw[1, :, 3, :]
+ *     M_33 = raw[2, :, 2, :]   # 2
  */
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 307, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_v_M_23 = __pyx_t_5;
-    __pyx_t_5 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__13); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 328, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_v_M_23 = __pyx_t_6;
+    __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":308
- *     M_22 = raw[1,:,1,:]  # 1
- *     M_23 = raw[1,:,2,:]
- *     M_24 = raw[1,:,3,:]             # <<<<<<<<<<<<<<
- *     M_33 = raw[2,:,2,:]  # 2
- *     M_34 = raw[2,:,3,:]
+    /* "statmoments/_native.pyx":329
+ *     M_22 = raw[1, :, 1, :]   # 1
+ *     M_23 = raw[1, :, 2, :]
+ *     M_24 = raw[1, :, 3, :]             # <<<<<<<<<<<<<<
+ *     M_33 = raw[2, :, 2, :]   # 2
+ *     M_34 = raw[2, :, 3, :]
  */
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__12); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 308, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_v_M_24 = __pyx_t_5;
-    __pyx_t_5 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__14); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 329, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_v_M_24 = __pyx_t_6;
+    __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":309
- *     M_23 = raw[1,:,2,:]
- *     M_24 = raw[1,:,3,:]
- *     M_33 = raw[2,:,2,:]  # 2             # <<<<<<<<<<<<<<
- *     M_34 = raw[2,:,3,:]
- *     M_44 = raw[3,:,3,:]  # 3
+    /* "statmoments/_native.pyx":330
+ *     M_23 = raw[1, :, 2, :]
+ *     M_24 = raw[1, :, 3, :]
+ *     M_33 = raw[2, :, 2, :]   # 2             # <<<<<<<<<<<<<<
+ *     M_34 = raw[2, :, 3, :]
+ *     M_44 = raw[3, :, 3, :]   # 3
  */
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__13); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 309, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_v_M_33 = __pyx_t_5;
-    __pyx_t_5 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__15); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 330, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_v_M_33 = __pyx_t_6;
+    __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":310
- *     M_24 = raw[1,:,3,:]
- *     M_33 = raw[2,:,2,:]  # 2
- *     M_34 = raw[2,:,3,:]             # <<<<<<<<<<<<<<
- *     M_44 = raw[3,:,3,:]  # 3
+    /* "statmoments/_native.pyx":331
+ *     M_24 = raw[1, :, 3, :]
+ *     M_33 = raw[2, :, 2, :]   # 2
+ *     M_34 = raw[2, :, 3, :]             # <<<<<<<<<<<<<<
+ *     M_44 = raw[3, :, 3, :]   # 3
  *     m = ave_i * (-4 * M_34[i, j] + ave_i * (6 * M_24[i, j] + ave_i * (M_13[j, j].diagonal() * ave_i - 4 * M_14[i, j]))) \
  */
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__14); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 310, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_v_M_34 = __pyx_t_5;
-    __pyx_t_5 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__16); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 331, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_v_M_34 = __pyx_t_6;
+    __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":311
- *     M_33 = raw[2,:,2,:]  # 2
- *     M_34 = raw[2,:,3,:]
- *     M_44 = raw[3,:,3,:]  # 3             # <<<<<<<<<<<<<<
+    /* "statmoments/_native.pyx":332
+ *     M_33 = raw[2, :, 2, :]   # 2
+ *     M_34 = raw[2, :, 3, :]
+ *     M_44 = raw[3, :, 3, :]   # 3             # <<<<<<<<<<<<<<
  *     m = ave_i * (-4 * M_34[i, j] + ave_i * (6 * M_24[i, j] + ave_i * (M_13[j, j].diagonal() * ave_i - 4 * M_14[i, j]))) \
  *         + ave_j * (-4 * M_34[j, i] \
  */
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__15); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 311, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_v_M_44 = __pyx_t_5;
-    __pyx_t_5 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_raw, __pyx_tuple__17); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 332, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_v_M_44 = __pyx_t_6;
+    __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":312
- *     M_34 = raw[2,:,3,:]
- *     M_44 = raw[3,:,3,:]  # 3
+    /* "statmoments/_native.pyx":333
+ *     M_34 = raw[2, :, 3, :]
+ *     M_44 = raw[3, :, 3, :]   # 3
  *     m = ave_i * (-4 * M_34[i, j] + ave_i * (6 * M_24[i, j] + ave_i * (M_13[j, j].diagonal() * ave_i - 4 * M_14[i, j]))) \             # <<<<<<<<<<<<<<
  *         + ave_j * (-4 * M_34[j, i] \
  *                      + ave_i * (16 * M_33[i, j] + ave_i * (-24 * M_23[i, j] + ave_i * (-4 * M_12[j, j].diagonal() * ave_i + 16 * M_13[i, j]))) \
  */
-    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 312, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 312, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_GIVEREF(__pyx_t_5);
-    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
+    __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 333, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 333, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_GIVEREF(__pyx_t_6);
+    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
-    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_j);
-    __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_M_34, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 312, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Multiply(__pyx_int_neg_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 312, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 312, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 312, __pyx_L1_error)
+    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_j);
+    __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_M_34, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 333, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = PyNumber_Multiply(__pyx_int_neg_4, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 333, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 333, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 333, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_GIVEREF(__pyx_t_5);
-    PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5);
+    __Pyx_GIVEREF(__pyx_t_6);
+    PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_6);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
     PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_v_j);
-    __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_M_24, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 312, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_M_24, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 333, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyNumber_Multiply(__pyx_int_6, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 312, __pyx_L1_error)
+    __pyx_t_7 = PyNumber_Multiply(__pyx_int_6, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 333, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 312, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 333, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
-    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_j);
+    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_j);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
-    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_j);
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_M_13, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 312, __pyx_L1_error)
+    PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_j);
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_M_13, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 333, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_diagonal); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 312, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_diagonal); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 333, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_1 = NULL;
-    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
-      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
+    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
+      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_1)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_4, function);
+        __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
-    __pyx_t_5 = (__pyx_t_1) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_1) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
+    __pyx_t_6 = (__pyx_t_1) ? __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_1) : __Pyx_PyObject_CallNoArg(__pyx_t_5);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 312, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Multiply(__pyx_t_5, __pyx_v_ave_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 312, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
+    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 333, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 312, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Multiply(__pyx_t_6, __pyx_v_ave_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 333, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 312, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 333, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 333, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GIVEREF(__pyx_t_5);
-    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
+    __Pyx_GIVEREF(__pyx_t_6);
+    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_j);
-    __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_M_14, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 312, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_M_14, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 333, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Multiply(__pyx_int_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 312, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Multiply(__pyx_int_4, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 333, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyNumber_Subtract(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 333, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_Subtract(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 312, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 312, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 333, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_Add(__pyx_t_7, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 312, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyNumber_Add(__pyx_t_7, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 333, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 312, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 333, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_Add(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 312, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyNumber_Add(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 333, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 312, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 333, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":313
- *     M_44 = raw[3,:,3,:]  # 3
+    /* "statmoments/_native.pyx":334
+ *     M_44 = raw[3, :, 3, :]   # 3
  *     m = ave_i * (-4 * M_34[i, j] + ave_i * (6 * M_24[i, j] + ave_i * (M_13[j, j].diagonal() * ave_i - 4 * M_14[i, j]))) \
  *         + ave_j * (-4 * M_34[j, i] \             # <<<<<<<<<<<<<<
  *                      + ave_i * (16 * M_33[i, j] + ave_i * (-24 * M_23[i, j] + ave_i * (-4 * M_12[j, j].diagonal() * ave_i + 16 * M_13[i, j]))) \
  *                      + ave_j * (6 * M_24[j, i] \
  */
-    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 313, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 313, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 334, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 334, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
-    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_j);
-    __Pyx_GIVEREF(__pyx_t_5);
-    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_5);
-    __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_M_34, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 313, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Multiply(__pyx_int_neg_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 313, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_j);
+    __Pyx_GIVEREF(__pyx_t_6);
+    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_6);
+    __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_M_34, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 334, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = PyNumber_Multiply(__pyx_int_neg_4, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 334, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":314
+    /* "statmoments/_native.pyx":335
  *     m = ave_i * (-4 * M_34[i, j] + ave_i * (6 * M_24[i, j] + ave_i * (M_13[j, j].diagonal() * ave_i - 4 * M_14[i, j]))) \
  *         + ave_j * (-4 * M_34[j, i] \
  *                      + ave_i * (16 * M_33[i, j] + ave_i * (-24 * M_23[i, j] + ave_i * (-4 * M_12[j, j].diagonal() * ave_i + 16 * M_13[i, j]))) \             # <<<<<<<<<<<<<<
  *                      + ave_j * (6 * M_24[j, i] \
  *                                   + ave_i * (-24 * M_23[j, i] + ave_i * (36 * M_22[i, j] + ave_i * ((6 * ave_i) * M_11[j, j].diagonal() - 24 * M_12[i, j]))) \
  */
-    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 314, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 314, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 335, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 335, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_GIVEREF(__pyx_t_5);
-    PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5);
+    __Pyx_GIVEREF(__pyx_t_6);
+    PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_6);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
     PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_v_j);
-    __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_M_33, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 314, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_M_33, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 335, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyNumber_Multiply(__pyx_int_16, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 314, __pyx_L1_error)
+    __pyx_t_7 = PyNumber_Multiply(__pyx_int_16, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 335, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 314, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 335, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 335, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 314, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_GIVEREF(__pyx_t_5);
-    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
+    __Pyx_GIVEREF(__pyx_t_6);
+    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
-    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_j);
-    __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_M_23, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 314, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Multiply(__pyx_int_neg_24, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 314, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
+    PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_j);
+    __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_M_23, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 335, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 314, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Multiply(__pyx_int_neg_24, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 335, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 335, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
     PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_v_j);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
     PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_v_j);
-    __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_v_M_12, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 314, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_v_M_12, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 335, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_diagonal); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 314, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_diagonal); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 335, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __pyx_t_9 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_8))) {
       __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_8);
       if (likely(__pyx_t_9)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
         __Pyx_INCREF(__pyx_t_9);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_8, function);
       }
     }
-    __pyx_t_5 = (__pyx_t_9) ? __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_9) : __Pyx_PyObject_CallNoArg(__pyx_t_8);
+    __pyx_t_6 = (__pyx_t_9) ? __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_9) : __Pyx_PyObject_CallNoArg(__pyx_t_8);
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 314, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
+    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 335, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = PyNumber_Multiply(__pyx_int_neg_4, __pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 314, __pyx_L1_error)
+    __pyx_t_8 = PyNumber_Multiply(__pyx_int_neg_4, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 335, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_Multiply(__pyx_t_8, __pyx_v_ave_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 314, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyNumber_Multiply(__pyx_t_8, __pyx_v_ave_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 335, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 314, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 335, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 314, __pyx_L1_error)
+    __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 335, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_8);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
     PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_v_j);
     __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_v_M_13, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 314, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_v_M_13, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 335, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Multiply(__pyx_int_16, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 314, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Multiply(__pyx_int_16, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 335, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = PyNumber_Add(__pyx_t_5, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 314, __pyx_L1_error)
+    __pyx_t_8 = PyNumber_Add(__pyx_t_6, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 335, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 314, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 335, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = PyNumber_Add(__pyx_t_4, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 314, __pyx_L1_error)
+    __pyx_t_8 = PyNumber_Add(__pyx_t_5, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 335, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 314, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 335, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = PyNumber_Add(__pyx_t_7, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 314, __pyx_L1_error)
+    __pyx_t_8 = PyNumber_Add(__pyx_t_7, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 335, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 314, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 335, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = PyNumber_Add(__pyx_t_3, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 314, __pyx_L1_error)
+    __pyx_t_8 = PyNumber_Add(__pyx_t_4, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 335, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-    /* "statmoments/_native.pyx":315
+    /* "statmoments/_native.pyx":336
  *         + ave_j * (-4 * M_34[j, i] \
  *                      + ave_i * (16 * M_33[i, j] + ave_i * (-24 * M_23[i, j] + ave_i * (-4 * M_12[j, j].diagonal() * ave_i + 16 * M_13[i, j]))) \
  *                      + ave_j * (6 * M_24[j, i] \             # <<<<<<<<<<<<<<
  *                                   + ave_i * (-24 * M_23[j, i] + ave_i * (36 * M_22[i, j] + ave_i * ((6 * ave_i) * M_11[j, j].diagonal() - 24 * M_12[i, j]))) \
  *                                   + ave_j * (-4 * M_14[j, i] \
  */
-    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 315, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 336, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 315, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 336, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
-    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_j);
+    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_j);
     __Pyx_GIVEREF(__pyx_t_9);
-    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_9);
+    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_9);
     __pyx_t_9 = 0;
-    __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_v_M_24, __pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 315, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_v_M_24, __pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 336, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Multiply(__pyx_int_6, __pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 315, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = PyNumber_Multiply(__pyx_int_6, __pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 336, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-    /* "statmoments/_native.pyx":316
+    /* "statmoments/_native.pyx":337
  *                      + ave_i * (16 * M_33[i, j] + ave_i * (-24 * M_23[i, j] + ave_i * (-4 * M_12[j, j].diagonal() * ave_i + 16 * M_13[i, j]))) \
  *                      + ave_j * (6 * M_24[j, i] \
  *                                   + ave_i * (-24 * M_23[j, i] + ave_i * (36 * M_22[i, j] + ave_i * ((6 * ave_i) * M_11[j, j].diagonal() - 24 * M_12[i, j]))) \             # <<<<<<<<<<<<<<
  *                                   + ave_j * (-4 * M_14[j, i] \
  *                                                + ave_i * (16 * M_13[j, i] + ave_i * (16 * ave_i * M_11[i, j] - 24 * M_12[j, i])) \
  */
-    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 316, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 337, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 316, __pyx_L1_error)
+    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 337, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
     PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_j);
     __Pyx_GIVEREF(__pyx_t_9);
     PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_9);
     __pyx_t_9 = 0;
-    __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_v_M_23, __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 316, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_v_M_23, __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 337, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyNumber_Multiply(__pyx_int_neg_24, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 316, __pyx_L1_error)
+    __pyx_t_7 = PyNumber_Multiply(__pyx_int_neg_24, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 337, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 316, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 337, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 316, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 337, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_9);
-    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_9);
+    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_9);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
-    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_j);
+    PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_j);
     __pyx_t_9 = 0;
-    __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_v_M_22, __pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 316, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_v_M_22, __pyx_t_5); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 337, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Multiply(__pyx_int_36, __pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 316, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = PyNumber_Multiply(__pyx_int_36, __pyx_t_9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 337, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Multiply(__pyx_int_6, __pyx_v_ave_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 316, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Multiply(__pyx_int_6, __pyx_v_ave_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 337, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 316, __pyx_L1_error)
+    __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 337, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
     PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_v_j);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
     PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_v_j);
-    __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_v_M_11, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 316, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_v_M_11, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 337, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_diagonal); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 316, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_diagonal); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 337, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     __pyx_t_11 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
       __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_10);
       if (likely(__pyx_t_11)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
         __Pyx_INCREF(__pyx_t_11);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_10, function);
       }
     }
-    __pyx_t_5 = (__pyx_t_11) ? __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_11) : __Pyx_PyObject_CallNoArg(__pyx_t_10);
+    __pyx_t_6 = (__pyx_t_11) ? __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_11) : __Pyx_PyObject_CallNoArg(__pyx_t_10);
     __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 316, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
+    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 337, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = PyNumber_Multiply(__pyx_t_9, __pyx_t_5); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 316, __pyx_L1_error)
+    __pyx_t_10 = PyNumber_Multiply(__pyx_t_9, __pyx_t_6); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 337, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 316, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 316, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 337, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 337, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __Pyx_GIVEREF(__pyx_t_5);
-    PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_5);
+    __Pyx_GIVEREF(__pyx_t_6);
+    PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_6);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
     PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_v_j);
-    __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_M_12, __pyx_t_9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 316, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_M_12, __pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 337, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Multiply(__pyx_int_24, __pyx_t_5); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 316, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Multiply(__pyx_int_24, __pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 337, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_Subtract(__pyx_t_10, __pyx_t_9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 316, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyNumber_Subtract(__pyx_t_10, __pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 337, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_5); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 316, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 337, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyNumber_Add(__pyx_t_5, __pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 337, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_Add(__pyx_t_4, __pyx_t_9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 316, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_5); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 316, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 337, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_Add(__pyx_t_7, __pyx_t_9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 316, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyNumber_Add(__pyx_t_7, __pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 337, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_5); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 316, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 337, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_Add(__pyx_t_3, __pyx_t_9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 316, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyNumber_Add(__pyx_t_4, __pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 337, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-    /* "statmoments/_native.pyx":317
+    /* "statmoments/_native.pyx":338
  *                      + ave_j * (6 * M_24[j, i] \
  *                                   + ave_i * (-24 * M_23[j, i] + ave_i * (36 * M_22[i, j] + ave_i * ((6 * ave_i) * M_11[j, j].diagonal() - 24 * M_12[i, j]))) \
  *                                   + ave_j * (-4 * M_14[j, i] \             # <<<<<<<<<<<<<<
  *                                                + ave_i * (16 * M_13[j, i] + ave_i * (16 * ave_i * M_11[i, j] - 24 * M_12[j, i])) \
  *                                                + ave_j * (M_13[i, i] \
  */
-    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 317, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 338, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 317, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 338, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
-    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_j);
+    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_j);
     __Pyx_GIVEREF(__pyx_t_9);
-    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_9);
+    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_9);
     __pyx_t_9 = 0;
-    __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_v_M_14, __pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 317, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_v_M_14, __pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 338, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Multiply(__pyx_int_neg_4, __pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 317, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = PyNumber_Multiply(__pyx_int_neg_4, __pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 338, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-    /* "statmoments/_native.pyx":318
+    /* "statmoments/_native.pyx":339
  *                                   + ave_i * (-24 * M_23[j, i] + ave_i * (36 * M_22[i, j] + ave_i * ((6 * ave_i) * M_11[j, j].diagonal() - 24 * M_12[i, j]))) \
  *                                   + ave_j * (-4 * M_14[j, i] \
  *                                                + ave_i * (16 * M_13[j, i] + ave_i * (16 * ave_i * M_11[i, j] - 24 * M_12[j, i])) \             # <<<<<<<<<<<<<<
  *                                                + ave_j * (M_13[i, i] \
  *                                                             + ave_i * (-4 * M_12[i, i] + ave_i * (6 * M_11[i, i] - 7* n * ave_i ** 2)))))) \
  */
-    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 339, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 339, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
     PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_j);
     __Pyx_GIVEREF(__pyx_t_9);
     PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_9);
     __pyx_t_9 = 0;
-    __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_v_M_13, __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_v_M_13, __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 339, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyNumber_Multiply(__pyx_int_16, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __pyx_t_7 = PyNumber_Multiply(__pyx_int_16, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 339, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Multiply(__pyx_int_16, __pyx_v_ave_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Multiply(__pyx_int_16, __pyx_v_ave_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 339, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 318, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 339, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 339, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __Pyx_GIVEREF(__pyx_t_4);
-    PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_4);
+    __Pyx_GIVEREF(__pyx_t_5);
+    PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_5);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
     PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_v_j);
-    __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_M_11, __pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 318, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_M_11, __pyx_t_10); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 339, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = PyNumber_Multiply(__pyx_t_9, __pyx_t_4); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __pyx_t_10 = PyNumber_Multiply(__pyx_t_9, __pyx_t_5); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 339, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 318, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 339, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 339, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
     PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_v_j);
-    __Pyx_GIVEREF(__pyx_t_4);
-    PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_t_4);
-    __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_M_12, __pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 318, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_GIVEREF(__pyx_t_5);
+    PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_t_5);
+    __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_M_12, __pyx_t_9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 339, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Multiply(__pyx_int_24, __pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Multiply(__pyx_int_24, __pyx_t_5); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 339, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Subtract(__pyx_t_10, __pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 318, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = PyNumber_Subtract(__pyx_t_10, __pyx_t_9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 339, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_5); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 339, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Add(__pyx_t_7, __pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 318, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = PyNumber_Add(__pyx_t_7, __pyx_t_9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 339, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_5); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 339, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = PyNumber_Add(__pyx_t_4, __pyx_t_9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 339, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Add(__pyx_t_3, __pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 318, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-    /* "statmoments/_native.pyx":319
+    /* "statmoments/_native.pyx":340
  *                                   + ave_j * (-4 * M_14[j, i] \
  *                                                + ave_i * (16 * M_13[j, i] + ave_i * (16 * ave_i * M_11[i, j] - 24 * M_12[j, i])) \
  *                                                + ave_j * (M_13[i, i] \             # <<<<<<<<<<<<<<
  *                                                             + ave_i * (-4 * M_12[i, i] + ave_i * (6 * M_11[i, i] - 7* n * ave_i ** 2)))))) \
  *         + M_44[i, j]
  */
-    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 319, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 340, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 319, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 319, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 340, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 340, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_9);
     PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_9);
-    __Pyx_GIVEREF(__pyx_t_3);
-    PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_3);
+    __Pyx_GIVEREF(__pyx_t_4);
+    PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_4);
     __pyx_t_9 = 0;
-    __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_M_13, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 319, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_4 = 0;
+    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_M_13, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 340, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-    /* "statmoments/_native.pyx":320
+    /* "statmoments/_native.pyx":341
  *                                                + ave_i * (16 * M_13[j, i] + ave_i * (16 * ave_i * M_11[i, j] - 24 * M_12[j, i])) \
  *                                                + ave_j * (M_13[i, i] \
  *                                                             + ave_i * (-4 * M_12[i, i] + ave_i * (6 * M_11[i, i] - 7* n * ave_i ** 2)))))) \             # <<<<<<<<<<<<<<
  *         + M_44[i, j]
  *     m *= inv_n
  */
-    __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_GIVEREF(__pyx_t_7);
     PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_9);
     PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_t_9);
     __pyx_t_7 = 0;
     __pyx_t_9 = 0;
-    __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_v_M_12, __pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_v_M_12, __pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = PyNumber_Multiply(__pyx_int_neg_4, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __pyx_t_10 = PyNumber_Multiply(__pyx_int_neg_4, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_11 = PyTuple_New(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __pyx_t_11 = PyTuple_New(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_GIVEREF(__pyx_t_9);
     PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_9);
     __Pyx_GIVEREF(__pyx_t_7);
     PyTuple_SET_ITEM(__pyx_t_11, 1, __pyx_t_7);
     __pyx_t_9 = 0;
     __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_M_11, __pyx_t_11); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_M_11, __pyx_t_11); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    __pyx_t_11 = PyNumber_Multiply(__pyx_int_6, __pyx_t_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __pyx_t_11 = PyNumber_Multiply(__pyx_int_6, __pyx_t_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyFloat_FromDouble((7.0 * __pyx_v_n)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __pyx_t_7 = PyFloat_FromDouble((7.0 * __pyx_v_n)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_9 = PyNumber_Power(__pyx_v_ave_i, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Power(__pyx_v_ave_i, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_12 = PyNumber_Multiply(__pyx_t_7, __pyx_t_9); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __pyx_t_12 = PyNumber_Multiply(__pyx_t_7, __pyx_t_9); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Subtract(__pyx_t_11, __pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Subtract(__pyx_t_11, __pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-    __pyx_t_12 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_9); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __pyx_t_12 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_9); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Add(__pyx_t_10, __pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Add(__pyx_t_10, __pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-    __pyx_t_12 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_9); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __pyx_t_12 = PyNumber_Multiply(__pyx_v_ave_i, __pyx_t_9); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Add(__pyx_t_3, __pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Add(__pyx_t_4, __pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 341, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-    /* "statmoments/_native.pyx":319
+    /* "statmoments/_native.pyx":340
  *                                   + ave_j * (-4 * M_14[j, i] \
  *                                                + ave_i * (16 * M_13[j, i] + ave_i * (16 * ave_i * M_11[i, j] - 24 * M_12[j, i])) \
  *                                                + ave_j * (M_13[i, i] \             # <<<<<<<<<<<<<<
  *                                                             + ave_i * (-4 * M_12[i, i] + ave_i * (6 * M_11[i, i] - 7* n * ave_i ** 2)))))) \
  *         + M_44[i, j]
  */
-    __pyx_t_12 = PyNumber_Multiply(__pyx_v_ave_j, __pyx_t_9); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 319, __pyx_L1_error)
+    __pyx_t_12 = PyNumber_Multiply(__pyx_v_ave_j, __pyx_t_9); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 340, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Add(__pyx_t_4, __pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 319, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Add(__pyx_t_5, __pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 340, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-    /* "statmoments/_native.pyx":317
+    /* "statmoments/_native.pyx":338
  *                      + ave_j * (6 * M_24[j, i] \
  *                                   + ave_i * (-24 * M_23[j, i] + ave_i * (36 * M_22[i, j] + ave_i * ((6 * ave_i) * M_11[j, j].diagonal() - 24 * M_12[i, j]))) \
  *                                   + ave_j * (-4 * M_14[j, i] \             # <<<<<<<<<<<<<<
  *                                                + ave_i * (16 * M_13[j, i] + ave_i * (16 * ave_i * M_11[i, j] - 24 * M_12[j, i])) \
  *                                                + ave_j * (M_13[i, i] \
  */
-    __pyx_t_12 = PyNumber_Multiply(__pyx_v_ave_j, __pyx_t_9); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 317, __pyx_L1_error)
+    __pyx_t_12 = PyNumber_Multiply(__pyx_v_ave_j, __pyx_t_9); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 338, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Add(__pyx_t_5, __pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 317, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Add(__pyx_t_6, __pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 338, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-    /* "statmoments/_native.pyx":315
+    /* "statmoments/_native.pyx":336
  *         + ave_j * (-4 * M_34[j, i] \
  *                      + ave_i * (16 * M_33[i, j] + ave_i * (-24 * M_23[i, j] + ave_i * (-4 * M_12[j, j].diagonal() * ave_i + 16 * M_13[i, j]))) \
  *                      + ave_j * (6 * M_24[j, i] \             # <<<<<<<<<<<<<<
  *                                   + ave_i * (-24 * M_23[j, i] + ave_i * (36 * M_22[i, j] + ave_i * ((6 * ave_i) * M_11[j, j].diagonal() - 24 * M_12[i, j]))) \
  *                                   + ave_j * (-4 * M_14[j, i] \
  */
-    __pyx_t_12 = PyNumber_Multiply(__pyx_v_ave_j, __pyx_t_9); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 315, __pyx_L1_error)
+    __pyx_t_12 = PyNumber_Multiply(__pyx_v_ave_j, __pyx_t_9); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 336, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Add(__pyx_t_8, __pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 315, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Add(__pyx_t_8, __pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 336, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-    /* "statmoments/_native.pyx":313
- *     M_44 = raw[3,:,3,:]  # 3
+    /* "statmoments/_native.pyx":334
+ *     M_44 = raw[3, :, 3, :]   # 3
  *     m = ave_i * (-4 * M_34[i, j] + ave_i * (6 * M_24[i, j] + ave_i * (M_13[j, j].diagonal() * ave_i - 4 * M_14[i, j]))) \
  *         + ave_j * (-4 * M_34[j, i] \             # <<<<<<<<<<<<<<
  *                      + ave_i * (16 * M_33[i, j] + ave_i * (-24 * M_23[i, j] + ave_i * (-4 * M_12[j, j].diagonal() * ave_i + 16 * M_13[i, j]))) \
  *                      + ave_j * (6 * M_24[j, i] \
  */
-    __pyx_t_12 = PyNumber_Multiply(__pyx_v_ave_j, __pyx_t_9); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 313, __pyx_L1_error)
+    __pyx_t_12 = PyNumber_Multiply(__pyx_v_ave_j, __pyx_t_9); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 334, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Add(__pyx_t_1, __pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 313, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Add(__pyx_t_1, __pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 334, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-    /* "statmoments/_native.pyx":321
+    /* "statmoments/_native.pyx":342
  *                                                + ave_j * (M_13[i, i] \
  *                                                             + ave_i * (-4 * M_12[i, i] + ave_i * (6 * M_11[i, i] - 7* n * ave_i ** 2)))))) \
  *         + M_44[i, j]             # <<<<<<<<<<<<<<
  *     m *= inv_n
  *   else:
  */
-    __pyx_t_12 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 321, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 342, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 321, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 342, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_12);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_12);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_j);
     __pyx_t_12 = 0;
-    __pyx_t_12 = __Pyx_PyObject_GetItem(__pyx_v_M_44, __pyx_t_1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 321, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_GetItem(__pyx_v_M_44, __pyx_t_1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 342, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Add(__pyx_t_9, __pyx_t_12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 321, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Add(__pyx_t_9, __pyx_t_12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 342, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     __pyx_v_m = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":322
+    /* "statmoments/_native.pyx":343
  *                                                             + ave_i * (-4 * M_12[i, i] + ave_i * (6 * M_11[i, i] - 7* n * ave_i ** 2)))))) \
  *         + M_44[i, j]
  *     m *= inv_n             # <<<<<<<<<<<<<<
  *   else:
  *     m = calc_central_moment_general(raw, ave, n, lm, rm, i, j)
  */
-    __pyx_t_1 = PyFloat_FromDouble(__pyx_v_inv_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 322, __pyx_L1_error)
+    __pyx_t_1 = PyFloat_FromDouble(__pyx_v_inv_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 343, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_12 = PyNumber_InPlaceMultiply(__pyx_v_m, __pyx_t_1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 322, __pyx_L1_error)
+    __pyx_t_12 = PyNumber_InPlaceMultiply(__pyx_v_m, __pyx_t_1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 343, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF_SET(__pyx_v_m, __pyx_t_12);
     __pyx_t_12 = 0;
 
-    /* "statmoments/_native.pyx":301
+    /* "statmoments/_native.pyx":322
  *         + M_22[i, j]
  *     m *= inv_n
- *   elif lm == 4 and rm == 4:                    # E(XXXX YYYY)             # <<<<<<<<<<<<<<
- *     M_11 = raw[0,:,0,:]  # 0
- *     M_12 = raw[0,:,1,:]
+ *   elif lm == 4 and rm == 4:  # E(XXXX YYYY)             # <<<<<<<<<<<<<<
+ *     M_11 = raw[0, :, 0, :]   # 0
+ *     M_12 = raw[0, :, 1, :]
  */
     goto __pyx_L3;
   }
 
-  /* "statmoments/_native.pyx":324
+  /* "statmoments/_native.pyx":345
  *     m *= inv_n
  *   else:
  *     m = calc_central_moment_general(raw, ave, n, lm, rm, i, j)             # <<<<<<<<<<<<<<
  * 
  *   return m
  */
   /*else*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_calc_central_moment_general); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 324, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_calc_central_moment_general); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 345, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_9 = PyFloat_FromDouble(__pyx_v_n); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 324, __pyx_L1_error)
+    __pyx_t_9 = PyFloat_FromDouble(__pyx_v_n); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 345, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_lm); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 324, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_lm); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 345, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_rm); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 324, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_rm); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 345, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 345, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 324, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = NULL;
+    __pyx_t_4 = NULL;
     __pyx_t_13 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
-      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
-      if (likely(__pyx_t_3)) {
+      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
+      if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
-        __Pyx_INCREF(__pyx_t_3);
+        __Pyx_INCREF(__pyx_t_4);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
         __pyx_t_13 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_1)) {
-      PyObject *__pyx_temp[8] = {__pyx_t_3, __pyx_v_raw, __pyx_v_ave, __pyx_t_9, __pyx_t_8, __pyx_t_5, __pyx_t_4, __pyx_v_j};
-      __pyx_t_12 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_13, 7+__pyx_t_13); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 324, __pyx_L1_error)
-      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+      PyObject *__pyx_temp[8] = {__pyx_t_4, __pyx_v_raw, __pyx_v_ave, __pyx_t_9, __pyx_t_8, __pyx_t_6, __pyx_t_5, __pyx_v_j};
+      __pyx_t_12 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_13, 7+__pyx_t_13); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 345, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
-      PyObject *__pyx_temp[8] = {__pyx_t_3, __pyx_v_raw, __pyx_v_ave, __pyx_t_9, __pyx_t_8, __pyx_t_5, __pyx_t_4, __pyx_v_j};
-      __pyx_t_12 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_13, 7+__pyx_t_13); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 324, __pyx_L1_error)
-      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+      PyObject *__pyx_temp[8] = {__pyx_t_4, __pyx_v_raw, __pyx_v_ave, __pyx_t_9, __pyx_t_8, __pyx_t_6, __pyx_t_5, __pyx_v_j};
+      __pyx_t_12 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_13, 7+__pyx_t_13); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 345, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     } else
     #endif
     {
-      __pyx_t_10 = PyTuple_New(7+__pyx_t_13); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 324, __pyx_L1_error)
+      __pyx_t_10 = PyTuple_New(7+__pyx_t_13); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 345, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      if (__pyx_t_3) {
-        __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_3); __pyx_t_3 = NULL;
+      if (__pyx_t_4) {
+        __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_4); __pyx_t_4 = NULL;
       }
       __Pyx_INCREF(__pyx_v_raw);
       __Pyx_GIVEREF(__pyx_v_raw);
       PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_13, __pyx_v_raw);
       __Pyx_INCREF(__pyx_v_ave);
       __Pyx_GIVEREF(__pyx_v_ave);
       PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_13, __pyx_v_ave);
       __Pyx_GIVEREF(__pyx_t_9);
       PyTuple_SET_ITEM(__pyx_t_10, 2+__pyx_t_13, __pyx_t_9);
       __Pyx_GIVEREF(__pyx_t_8);
       PyTuple_SET_ITEM(__pyx_t_10, 3+__pyx_t_13, __pyx_t_8);
+      __Pyx_GIVEREF(__pyx_t_6);
+      PyTuple_SET_ITEM(__pyx_t_10, 4+__pyx_t_13, __pyx_t_6);
       __Pyx_GIVEREF(__pyx_t_5);
-      PyTuple_SET_ITEM(__pyx_t_10, 4+__pyx_t_13, __pyx_t_5);
-      __Pyx_GIVEREF(__pyx_t_4);
-      PyTuple_SET_ITEM(__pyx_t_10, 5+__pyx_t_13, __pyx_t_4);
+      PyTuple_SET_ITEM(__pyx_t_10, 5+__pyx_t_13, __pyx_t_5);
       __Pyx_INCREF(__pyx_v_j);
       __Pyx_GIVEREF(__pyx_v_j);
       PyTuple_SET_ITEM(__pyx_t_10, 6+__pyx_t_13, __pyx_v_j);
       __pyx_t_9 = 0;
       __pyx_t_8 = 0;
+      __pyx_t_6 = 0;
       __pyx_t_5 = 0;
-      __pyx_t_4 = 0;
-      __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_10, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 324, __pyx_L1_error)
+      __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_10, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 345, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_v_m = __pyx_t_12;
     __pyx_t_12 = 0;
   }
   __pyx_L3:;
 
-  /* "statmoments/_native.pyx":326
+  /* "statmoments/_native.pyx":347
  *     m = calc_central_moment_general(raw, ave, n, lm, rm, i, j)
  * 
  *   return m             # <<<<<<<<<<<<<<
  * 
- * class _bivar_sum_base(_AccBase):
+ * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_m);
   __pyx_r = __pyx_v_m;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":274
+  /* "statmoments/_native.pyx":293
  * @cython.cfunc
  * @cython.locals(n=cython.double, lm=cython.int, rm=cython.int, i=cython.int)
  * def calc_central_moments(raw, ave, n, lm, rm, i, j):             # <<<<<<<<<<<<<<
  *   """Optimized for moments (1, 1) and (2, 2). For others calc_central_moment_general is called"""
  * 
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
   __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_8);
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_XDECREF(__pyx_t_10);
   __Pyx_XDECREF(__pyx_t_11);
   __Pyx_XDECREF(__pyx_t_12);
   __Pyx_AddTraceback("statmoments._native.calc_central_moments", __pyx_clineno, __pyx_lineno, __pyx_filename);
@@ -10960,15 +11328,15 @@
   __Pyx_XDECREF(__pyx_v_M_34);
   __Pyx_XDECREF(__pyx_v_M_44);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":329
+/* "statmoments/_native.pyx":351
  * 
  * class _bivar_sum_base(_AccBase):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  * 
  */
 
@@ -11009,40 +11377,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_trace_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 1); __PYX_ERR(0, 329, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 1); __PYX_ERR(0, 351, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifier_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 2); __PYX_ERR(0, 329, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 2); __PYX_ERR(0, 351, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 329, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 351, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_trace_len = values[1];
     __pyx_v_classifier_len = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 329, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 351, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
   __Pyx_AddTraceback("statmoments._native._bivar_sum_base.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_15_bivar_sum_base___init__(__pyx_self, __pyx_v_self, __pyx_v_trace_len, __pyx_v_classifier_len, __pyx_v_kwargs);
@@ -11064,285 +11432,285 @@
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "statmoments/_native.pyx":330
+  /* "statmoments/_native.pyx":352
  * class _bivar_sum_base(_AccBase):
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, **kwargs)             # <<<<<<<<<<<<<<
  * 
  *     moment = self.moment
  */
   __pyx_t_1 = __Pyx_CyFunction_GetClassObj(__pyx_self);
-  if (!__pyx_t_1) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 330, __pyx_L1_error) }
+  if (!__pyx_t_1) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 352, __pyx_L1_error) }
   __Pyx_INCREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 330, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 352, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __Pyx_INCREF(__pyx_v_self);
   __Pyx_GIVEREF(__pyx_v_self);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_self);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 330, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 352, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_init); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 330, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_init); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 352, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 330, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 352, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_trace_len);
   __Pyx_GIVEREF(__pyx_v_trace_len);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_trace_len);
   __Pyx_INCREF(__pyx_v_classifier_len);
   __Pyx_GIVEREF(__pyx_v_classifier_len);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_classifier_len);
-  __pyx_t_3 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 330, __pyx_L1_error)
+  __pyx_t_3 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 352, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 330, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 352, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":332
+  /* "statmoments/_native.pyx":354
  *     super().__init__(trace_len, classifier_len, **kwargs)
  * 
  *     moment = self.moment             # <<<<<<<<<<<<<<
- *     exp_traces = 50 # Guesstimate the number of traces in the input batch
+ *     exp_traces = 50  # Guesstimate the number of traces in the input batch
  *     self._dtype = kwargs.pop('acctype', np.float64)
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 332, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 354, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_v_moment = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":333
+  /* "statmoments/_native.pyx":355
  * 
  *     moment = self.moment
- *     exp_traces = 50 # Guesstimate the number of traces in the input batch             # <<<<<<<<<<<<<<
+ *     exp_traces = 50  # Guesstimate the number of traces in the input batch             # <<<<<<<<<<<<<<
  *     self._dtype = kwargs.pop('acctype', np.float64)
  * 
  */
   __pyx_v_exp_traces = 50;
 
-  /* "statmoments/_native.pyx":334
+  /* "statmoments/_native.pyx":356
  *     moment = self.moment
- *     exp_traces = 50 # Guesstimate the number of traces in the input batch
+ *     exp_traces = 50  # Guesstimate the number of traces in the input batch
  *     self._dtype = kwargs.pop('acctype', np.float64)             # <<<<<<<<<<<<<<
  * 
  *     # Buffers for operations to avoid reallocations
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 334, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 356, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 334, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 356, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_Pop(__pyx_v_kwargs, __pyx_n_u_acctype, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 334, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_Pop(__pyx_v_kwargs, __pyx_n_u_acctype, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 356, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2, __pyx_t_4) < 0) __PYX_ERR(0, 334, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2, __pyx_t_4) < 0) __PYX_ERR(0, 356, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":337
+  /* "statmoments/_native.pyx":359
  * 
  *     # Buffers for operations to avoid reallocations
- *     self._buf = np.empty((3, trace_len), dtype=self._dtype) # BLAS ops             # <<<<<<<<<<<<<<
+ *     self._buf    = np.empty((3, trace_len), dtype=self._dtype)  # BLAS ops buffer             # <<<<<<<<<<<<<<
  *     self._layout = np.empty((exp_traces, moment * trace_len + 1), dtype=self._dtype)
  *     self._retm   = np.empty((2, 2, trace_len * (trace_len + 1) // 2), dtype=np.float64)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 337, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 359, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 337, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 359, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 337, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 359, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_int_3);
   __Pyx_GIVEREF(__pyx_int_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_int_3);
   __Pyx_INCREF(__pyx_v_trace_len);
   __Pyx_GIVEREF(__pyx_v_trace_len);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_trace_len);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 337, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 359, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 337, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 359, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 337, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 359, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 337, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 359, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 337, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 359, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_buf, __pyx_t_2) < 0) __PYX_ERR(0, 337, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_buf, __pyx_t_2) < 0) __PYX_ERR(0, 359, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":338
+  /* "statmoments/_native.pyx":360
  *     # Buffers for operations to avoid reallocations
- *     self._buf = np.empty((3, trace_len), dtype=self._dtype) # BLAS ops
+ *     self._buf    = np.empty((3, trace_len), dtype=self._dtype)  # BLAS ops buffer
  *     self._layout = np.empty((exp_traces, moment * trace_len + 1), dtype=self._dtype)             # <<<<<<<<<<<<<<
  *     self._retm   = np.empty((2, 2, trace_len * (trace_len + 1) // 2), dtype=np.float64)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 338, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 360, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 338, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 360, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_exp_traces); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 338, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_exp_traces); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 360, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_v_moment, __pyx_v_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 338, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_moment, __pyx_v_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 360, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 338, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 360, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 338, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 360, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_3);
   __pyx_t_2 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 338, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 360, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 338, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 360, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 338, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 360, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 338, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 360, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 338, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 360, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_layout, __pyx_t_2) < 0) __PYX_ERR(0, 338, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_layout, __pyx_t_2) < 0) __PYX_ERR(0, 360, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":339
- *     self._buf = np.empty((3, trace_len), dtype=self._dtype) # BLAS ops
+  /* "statmoments/_native.pyx":361
+ *     self._buf    = np.empty((3, trace_len), dtype=self._dtype)  # BLAS ops buffer
  *     self._layout = np.empty((exp_traces, moment * trace_len + 1), dtype=self._dtype)
  *     self._retm   = np.empty((2, 2, trace_len * (trace_len + 1) // 2), dtype=np.float64)             # <<<<<<<<<<<<<<
  * 
  *     # Accumulators
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 339, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 361, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 339, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 361, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_trace_len, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 339, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_trace_len, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 361, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_v_trace_len, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 339, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_v_trace_len, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 361, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_3, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 339, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_3, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 361, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 339, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 361, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_int_2);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_2);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 339, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 361, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 339, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 361, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 339, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 361, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 339, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 361, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 339, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 361, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 339, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 361, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_retm, __pyx_t_5) < 0) __PYX_ERR(0, 339, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_retm, __pyx_t_5) < 0) __PYX_ERR(0, 361, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":343
+  /* "statmoments/_native.pyx":365
  *     # Accumulators
  *     # acc0 is upper triangle of accs[:,:-1], acc1 is lower triangle of accs[:, 1:]
  *     self._accs   = np.zeros((classifier_len, moment * trace_len + 2, moment * trace_len + 1), dtype=self._dtype)             # <<<<<<<<<<<<<<
  * 
  *   @staticmethod
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyNumber_Multiply(__pyx_v_moment, __pyx_v_trace_len); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Multiply(__pyx_v_moment, __pyx_v_trace_len); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_t_5, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_t_5, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyNumber_Multiply(__pyx_v_moment, __pyx_v_trace_len); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Multiply(__pyx_v_moment, __pyx_v_trace_len); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_t_5, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_t_5, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(__pyx_v_classifier_len);
   __Pyx_GIVEREF(__pyx_v_classifier_len);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_classifier_len);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_t_1);
   __pyx_t_2 = 0;
   __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 343, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_accs, __pyx_t_2) < 0) __PYX_ERR(0, 343, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_accs, __pyx_t_2) < 0) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":329
+  /* "statmoments/_native.pyx":351
  * 
  * class _bivar_sum_base(_AccBase):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  * 
  */
 
@@ -11360,44 +11728,44 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_moment);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":346
+/* "statmoments/_native.pyx":368
  * 
  *   @staticmethod
- *   def estimate_mem_size(trace_len, classifier_len=1, moment=2, acc_dtype=np.float64):             # <<<<<<<<<<<<<<
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2, acc_dtype=np.float64):             # <<<<<<<<<<<<<<
  *     # Approximate memory consumption for 1 classifier, 1 moment:
  *     # 10k: 5GB,  20k: 15GB,  50k: 80GB
  */
 
-static PyObject *__pyx_pf_11statmoments_7_native_20__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
+static PyObject *__pyx_pf_11statmoments_7_native_22__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__defaults__", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 346, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 368, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(((PyObject *)__pyx_int_1));
   __Pyx_GIVEREF(((PyObject *)__pyx_int_1));
   PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_int_1));
   __Pyx_INCREF(((PyObject *)__pyx_int_2));
   __Pyx_GIVEREF(((PyObject *)__pyx_int_2));
   PyTuple_SET_ITEM(__pyx_t_1, 1, ((PyObject *)__pyx_int_2));
   __Pyx_INCREF(__Pyx_CyFunction_Defaults(__pyx_defaults, __pyx_self)->__pyx_arg_acc_dtype);
   __Pyx_GIVEREF(__Pyx_CyFunction_Defaults(__pyx_defaults, __pyx_self)->__pyx_arg_acc_dtype);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __Pyx_CyFunction_Defaults(__pyx_defaults, __pyx_self)->__pyx_arg_acc_dtype);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 346, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 368, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __Pyx_INCREF(Py_None);
   __Pyx_GIVEREF(Py_None);
   PyTuple_SET_ITEM(__pyx_t_2, 1, Py_None);
   __pyx_t_1 = 0;
@@ -11417,26 +11785,26 @@
   return __pyx_r;
 }
 
 /* Python wrapper */
 static PyObject *__pyx_pw_11statmoments_7_native_15_bivar_sum_base_3estimate_mem_size(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_11statmoments_7_native_15_bivar_sum_base_3estimate_mem_size = {"estimate_mem_size", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_15_bivar_sum_base_3estimate_mem_size, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_11statmoments_7_native_15_bivar_sum_base_3estimate_mem_size(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyObject *__pyx_v_trace_len = 0;
-  PyObject *__pyx_v_classifier_len = 0;
+  PyObject *__pyx_v_tr_len = 0;
+  PyObject *__pyx_v_cl_len = 0;
   PyObject *__pyx_v_moment = 0;
   PyObject *__pyx_v_acc_dtype = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("estimate_mem_size (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_trace_len,&__pyx_n_s_classifier_len,&__pyx_n_s_moment,&__pyx_n_s_acc_dtype,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_tr_len,&__pyx_n_s_cl_len,&__pyx_n_s_moment,&__pyx_n_s_acc_dtype,0};
     PyObject* values[4] = {0,0,0,0};
     __pyx_defaults *__pyx_dynamic_args = __Pyx_CyFunction_Defaults(__pyx_defaults, __pyx_self);
     values[1] = ((PyObject *)((PyObject *)__pyx_int_1));
     values[2] = ((PyObject *)((PyObject *)__pyx_int_2));
     values[3] = __pyx_dynamic_args->__pyx_arg_acc_dtype;
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
@@ -11452,20 +11820,20 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_trace_len)) != 0)) kw_args--;
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr_len)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifier_len);
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_cl_len);
           if (value) { values[1] = value; kw_args--; }
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moment);
           if (value) { values[2] = value; kw_args--; }
@@ -11474,208 +11842,231 @@
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_acc_dtype);
           if (value) { values[3] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "estimate_mem_size") < 0)) __PYX_ERR(0, 346, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "estimate_mem_size") < 0)) __PYX_ERR(0, 368, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
-    __pyx_v_trace_len = values[0];
-    __pyx_v_classifier_len = values[1];
+    __pyx_v_tr_len = values[0];
+    __pyx_v_cl_len = values[1];
     __pyx_v_moment = values[2];
     __pyx_v_acc_dtype = values[3];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("estimate_mem_size", 0, 1, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 346, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("estimate_mem_size", 0, 1, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 368, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native._bivar_sum_base.estimate_mem_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11statmoments_7_native_15_bivar_sum_base_2estimate_mem_size(__pyx_self, __pyx_v_trace_len, __pyx_v_classifier_len, __pyx_v_moment, __pyx_v_acc_dtype);
+  __pyx_r = __pyx_pf_11statmoments_7_native_15_bivar_sum_base_2estimate_mem_size(__pyx_self, __pyx_v_tr_len, __pyx_v_cl_len, __pyx_v_moment, __pyx_v_acc_dtype);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11statmoments_7_native_15_bivar_sum_base_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_trace_len, PyObject *__pyx_v_classifier_len, PyObject *__pyx_v_moment, PyObject *__pyx_v_acc_dtype) {
+static PyObject *__pyx_pf_11statmoments_7_native_15_bivar_sum_base_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tr_len, PyObject *__pyx_v_cl_len, PyObject *__pyx_v_moment, PyObject *__pyx_v_acc_dtype) {
   PyObject *__pyx_v_exp_traces = NULL;
+  PyObject *__pyx_v_bufsz = NULL;
   PyObject *__pyx_v_lytsz = NULL;
   PyObject *__pyx_v_accssz = NULL;
   PyObject *__pyx_v_ttsz = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("estimate_mem_size", 0);
 
-  /* "statmoments/_native.pyx":349
+  /* "statmoments/_native.pyx":371
  *     # Approximate memory consumption for 1 classifier, 1 moment:
  *     # 10k: 5GB,  20k: 15GB,  50k: 80GB
- *     exp_traces = 50 # Expected number of traces in the input batch             # <<<<<<<<<<<<<<
- *     lytsz  = exp_traces * moment*trace_len
- *     accssz = classifier_len * (moment*trace_len**2)
+ *     exp_traces = 50  # Expected number of traces in the input batch             # <<<<<<<<<<<<<<
+ *     bufsz      = 3 * tr_len
+ *     lytsz      = exp_traces * (moment * tr_len + 1)
  */
   __Pyx_INCREF(__pyx_int_50);
   __pyx_v_exp_traces = __pyx_int_50;
 
-  /* "statmoments/_native.pyx":350
+  /* "statmoments/_native.pyx":372
  *     # 10k: 5GB,  20k: 15GB,  50k: 80GB
- *     exp_traces = 50 # Expected number of traces in the input batch
- *     lytsz  = exp_traces * moment*trace_len             # <<<<<<<<<<<<<<
- *     accssz = classifier_len * (moment*trace_len**2)
- *     ttsz   = 2 * 2 * trace_len*trace_len // 2
+ *     exp_traces = 50  # Expected number of traces in the input batch
+ *     bufsz      = 3 * tr_len             # <<<<<<<<<<<<<<
+ *     lytsz      = exp_traces * (moment * tr_len + 1)
+ *     accssz     = cl_len * (moment * tr_len + 1) ** 2
  */
-  __pyx_t_1 = PyNumber_Multiply(__pyx_v_exp_traces, __pyx_v_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 350, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_int_3, __pyx_v_tr_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 372, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyNumber_Multiply(__pyx_t_1, __pyx_v_trace_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 350, __pyx_L1_error)
+  __pyx_v_bufsz = __pyx_t_1;
+  __pyx_t_1 = 0;
+
+  /* "statmoments/_native.pyx":373
+ *     exp_traces = 50  # Expected number of traces in the input batch
+ *     bufsz      = 3 * tr_len
+ *     lytsz      = exp_traces * (moment * tr_len + 1)             # <<<<<<<<<<<<<<
+ *     accssz     = cl_len * (moment * tr_len + 1) ** 2
+ *     ttsz       = 2 * 2 * tr_len * tr_len // 2
+ */
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_moment, __pyx_v_tr_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 373, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 373, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_lytsz = __pyx_t_2;
-  __pyx_t_2 = 0;
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_exp_traces, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 373, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_v_lytsz = __pyx_t_1;
+  __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":351
- *     exp_traces = 50 # Expected number of traces in the input batch
- *     lytsz  = exp_traces * moment*trace_len
- *     accssz = classifier_len * (moment*trace_len**2)             # <<<<<<<<<<<<<<
- *     ttsz   = 2 * 2 * trace_len*trace_len // 2
- *     return (lytsz + accssz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
+  /* "statmoments/_native.pyx":374
+ *     bufsz      = 3 * tr_len
+ *     lytsz      = exp_traces * (moment * tr_len + 1)
+ *     accssz     = cl_len * (moment * tr_len + 1) ** 2             # <<<<<<<<<<<<<<
+ *     ttsz       = 2 * 2 * tr_len * tr_len // 2
+ *     return (lytsz + accssz + bufsz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
  */
-  __pyx_t_2 = PyNumber_Power(__pyx_v_trace_len, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 351, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_moment, __pyx_v_tr_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 374, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 374, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_v_moment, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 351, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyNumber_Power(__pyx_t_2, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 374, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyNumber_Multiply(__pyx_v_classifier_len, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 351, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_v_cl_len, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 374, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_accssz = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":352
- *     lytsz  = exp_traces * moment*trace_len
- *     accssz = classifier_len * (moment*trace_len**2)
- *     ttsz   = 2 * 2 * trace_len*trace_len // 2             # <<<<<<<<<<<<<<
- *     return (lytsz + accssz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
+  /* "statmoments/_native.pyx":375
+ *     lytsz      = exp_traces * (moment * tr_len + 1)
+ *     accssz     = cl_len * (moment * tr_len + 1) ** 2
+ *     ttsz       = 2 * 2 * tr_len * tr_len // 2             # <<<<<<<<<<<<<<
+ *     return (lytsz + accssz + bufsz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
  * 
  */
-  __pyx_t_2 = PyNumber_Multiply(__pyx_int_4, __pyx_v_trace_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 352, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_int_4, __pyx_v_tr_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 375, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_t_2, __pyx_v_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 352, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_2, __pyx_v_tr_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 375, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_1, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 352, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_1, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 375, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_ttsz = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":353
- *     accssz = classifier_len * (moment*trace_len**2)
- *     ttsz   = 2 * 2 * trace_len*trace_len // 2
- *     return (lytsz + accssz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8             # <<<<<<<<<<<<<<
+  /* "statmoments/_native.pyx":376
+ *     accssz     = cl_len * (moment * tr_len + 1) ** 2
+ *     ttsz       = 2 * 2 * tr_len * tr_len // 2
+ *     return (lytsz + accssz + bufsz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8             # <<<<<<<<<<<<<<
  * 
  *   def memory_size(self):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = PyNumber_Add(__pyx_v_lytsz, __pyx_v_accssz); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 353, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Add(__pyx_v_lytsz, __pyx_v_accssz); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 376, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 353, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Add(__pyx_t_2, __pyx_v_bufsz); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 376, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 376, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_finfo); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 353, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_finfo); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 376, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
-  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_acc_dtype) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_acc_dtype);
+  __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_acc_dtype) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_acc_dtype);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 353, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 376, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_bits); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 353, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_bits); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 376, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Multiply(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 353, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = PyNumber_Multiply(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 376, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_1, __pyx_int_8, 8, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 353, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_2, __pyx_int_8, 8, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 376, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Multiply(__pyx_v_ttsz, __pyx_int_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 353, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyNumber_Add(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 353, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = PyNumber_Multiply(__pyx_v_ttsz, __pyx_int_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 376, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = PyNumber_Add(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 376, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_r = __pyx_t_2;
-  __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":346
+  /* "statmoments/_native.pyx":368
  * 
  *   @staticmethod
- *   def estimate_mem_size(trace_len, classifier_len=1, moment=2, acc_dtype=np.float64):             # <<<<<<<<<<<<<<
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2, acc_dtype=np.float64):             # <<<<<<<<<<<<<<
  *     # Approximate memory consumption for 1 classifier, 1 moment:
  *     # 10k: 5GB,  20k: 15GB,  50k: 80GB
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_AddTraceback("statmoments._native._bivar_sum_base.estimate_mem_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_exp_traces);
+  __Pyx_XDECREF(__pyx_v_bufsz);
   __Pyx_XDECREF(__pyx_v_lytsz);
   __Pyx_XDECREF(__pyx_v_accssz);
   __Pyx_XDECREF(__pyx_v_ttsz);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":355
- *     return (lytsz + accssz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
+/* "statmoments/_native.pyx":378
+ *     return (lytsz + accssz + bufsz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
- *     mem_ttest = 0  # included in mem_class
+ *     # ttest memory included in mem_class or std normalization computed one line at a time
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_11statmoments_7_native_15_bivar_sum_base_5memory_size(PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
 static PyMethodDef __pyx_mdef_11statmoments_7_native_15_bivar_sum_base_5memory_size = {"memory_size", (PyCFunction)__pyx_pw_11statmoments_7_native_15_bivar_sum_base_5memory_size, METH_O, 0};
 static PyObject *__pyx_pw_11statmoments_7_native_15_bivar_sum_base_5memory_size(PyObject *__pyx_self, PyObject *__pyx_v_self) {
   PyObject *__pyx_r = 0;
@@ -11685,43 +12076,43 @@
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static PyObject *__pyx_gb_11statmoments_7_native_15_bivar_sum_base_11memory_size_2generator12(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "statmoments/_native.pyx":356
+/* "statmoments/_native.pyx":379
  * 
  *   def memory_size(self):
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))             # <<<<<<<<<<<<<<
- *     mem_ttest = 0  # included in mem_class
- *     return mem_class + mem_ttest * 8
+ *     # ttest memory included in mem_class or std normalization computed one line at a time
+ *     mem_ttest = 0  if self.moment < 3 else self.trace_len
  */
 
 static PyObject *__pyx_pf_11statmoments_7_native_15_bivar_sum_base_11memory_size_genexpr(PyObject *__pyx_self) {
   struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_1_genexpr *__pyx_cur_scope;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("genexpr", 0);
   __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_1_genexpr *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_1_genexpr(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_1_genexpr, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_1_genexpr *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 356, __pyx_L1_error)
+    __PYX_ERR(0, 379, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct__memory_size *) __pyx_self;
   __Pyx_INCREF(((PyObject *)__pyx_cur_scope->__pyx_outer_scope));
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_outer_scope);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_15_bivar_sum_base_11memory_size_2generator12, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_bivar_sum_base_memory_size_loca, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 356, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_15_bivar_sum_base_11memory_size_2generator12, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_bivar_sum_base_memory_size_loca, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 379, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -11755,48 +12146,48 @@
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L7_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 356, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 379, __pyx_L1_error)
   __pyx_t_2 = 0;
-  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_self)) { __Pyx_RaiseClosureNameError("self"); __PYX_ERR(0, 356, __pyx_L1_error) }
-  __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_vars, __pyx_cur_scope->__pyx_outer_scope->__pyx_v_self); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 356, __pyx_L1_error)
+  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_self)) { __Pyx_RaiseClosureNameError("self"); __PYX_ERR(0, 379, __pyx_L1_error) }
+  __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_vars, __pyx_cur_scope->__pyx_outer_scope->__pyx_v_self); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 379, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   if (unlikely(__pyx_t_5 == Py_None)) {
     PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "values");
-    __PYX_ERR(0, 356, __pyx_L1_error)
+    __PYX_ERR(0, 379, __pyx_L1_error)
   }
-  __pyx_t_6 = __Pyx_dict_iterator(__pyx_t_5, 0, __pyx_n_s_values, (&__pyx_t_3), (&__pyx_t_4)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 356, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_dict_iterator(__pyx_t_5, 0, __pyx_n_s_values, (&__pyx_t_3), (&__pyx_t_4)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 379, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_XDECREF(__pyx_t_1);
   __pyx_t_1 = __pyx_t_6;
   __pyx_t_6 = 0;
   while (1) {
     __pyx_t_7 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_3, &__pyx_t_2, NULL, &__pyx_t_6, NULL, __pyx_t_4);
     if (unlikely(__pyx_t_7 == 0)) break;
-    if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 356, __pyx_L1_error)
+    if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 379, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_v);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_v, __pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_6);
     __pyx_t_6 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 356, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 379, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_ndarray); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 356, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_ndarray); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 379, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_8 = PyObject_IsInstance(__pyx_cur_scope->__pyx_v_v, __pyx_t_5); if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 356, __pyx_L1_error)
+    __pyx_t_8 = PyObject_IsInstance(__pyx_cur_scope->__pyx_v_v, __pyx_t_5); if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 379, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_9 = (__pyx_t_8 != 0);
     if (__pyx_t_9) {
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_v, __pyx_n_s_nbytes); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 356, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_v, __pyx_n_s_nbytes); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 379, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __pyx_r = __pyx_t_5;
       __pyx_t_5 = 0;
       __Pyx_XGIVEREF(__pyx_t_1);
       __pyx_cur_scope->__pyx_t_0 = __pyx_t_1;
       __pyx_cur_scope->__pyx_t_1 = __pyx_t_2;
       __pyx_cur_scope->__pyx_t_2 = __pyx_t_3;
@@ -11810,15 +12201,15 @@
       __pyx_L7_resume_from_yield:;
       __pyx_t_1 = __pyx_cur_scope->__pyx_t_0;
       __pyx_cur_scope->__pyx_t_0 = 0;
       __Pyx_XGOTREF(__pyx_t_1);
       __pyx_t_2 = __pyx_cur_scope->__pyx_t_1;
       __pyx_t_3 = __pyx_cur_scope->__pyx_t_2;
       __pyx_t_4 = __pyx_cur_scope->__pyx_t_3;
-      if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 356, __pyx_L1_error)
+      if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 379, __pyx_L1_error)
     }
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
   /* function exit code */
   PyErr_SetNone(PyExc_StopIteration);
@@ -11835,114 +12226,132 @@
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":355
- *     return (lytsz + accssz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
+/* "statmoments/_native.pyx":378
+ *     return (lytsz + accssz + bufsz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
- *     mem_ttest = 0  # included in mem_class
+ *     # ttest memory included in mem_class or std normalization computed one line at a time
  */
 
 static PyObject *__pyx_pf_11statmoments_7_native_15_bivar_sum_base_4memory_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
   struct __pyx_obj_11statmoments_7_native___pyx_scope_struct__memory_size *__pyx_cur_scope;
   PyObject *__pyx_v_mem_class = NULL;
   PyObject *__pyx_v_mem_ttest = NULL;
   PyObject *__pyx_gb_11statmoments_7_native_15_bivar_sum_base_11memory_size_2generator12 = 0;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  int __pyx_t_4;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("memory_size", 0);
   __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct__memory_size *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct__memory_size(__pyx_ptype_11statmoments_7_native___pyx_scope_struct__memory_size, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct__memory_size *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 355, __pyx_L1_error)
+    __PYX_ERR(0, 378, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
 
-  /* "statmoments/_native.pyx":356
+  /* "statmoments/_native.pyx":379
  * 
  *   def memory_size(self):
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))             # <<<<<<<<<<<<<<
- *     mem_ttest = 0  # included in mem_class
- *     return mem_class + mem_ttest * 8
+ *     # ttest memory included in mem_class or std normalization computed one line at a time
+ *     mem_ttest = 0  if self.moment < 3 else self.trace_len
  */
-  __pyx_t_1 = __pyx_pf_11statmoments_7_native_15_bivar_sum_base_11memory_size_genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 356, __pyx_L1_error)
+  __pyx_t_1 = __pyx_pf_11statmoments_7_native_15_bivar_sum_base_11memory_size_genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 379, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_sum, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 356, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_sum, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 379, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_mem_class = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":357
- *   def memory_size(self):
+  /* "statmoments/_native.pyx":381
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
- *     mem_ttest = 0  # included in mem_class             # <<<<<<<<<<<<<<
+ *     # ttest memory included in mem_class or std normalization computed one line at a time
+ *     mem_ttest = 0  if self.moment < 3 else self.trace_len             # <<<<<<<<<<<<<<
  *     return mem_class + mem_ttest * 8
  * 
  */
-  __Pyx_INCREF(__pyx_int_0);
-  __pyx_v_mem_ttest = __pyx_int_0;
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 381, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = PyObject_RichCompare(__pyx_t_1, __pyx_int_3, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 381, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 381, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (__pyx_t_4) {
+    __Pyx_INCREF(__pyx_int_0);
+    __pyx_t_2 = __pyx_int_0;
+  } else {
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 381, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_2 = __pyx_t_3;
+    __pyx_t_3 = 0;
+  }
+  __pyx_v_mem_ttest = __pyx_t_2;
+  __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":358
- *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
- *     mem_ttest = 0  # included in mem_class
+  /* "statmoments/_native.pyx":382
+ *     # ttest memory included in mem_class or std normalization computed one line at a time
+ *     mem_ttest = 0  if self.moment < 3 else self.trace_len
  *     return mem_class + mem_ttest * 8             # <<<<<<<<<<<<<<
  * 
  *   def update(self, traces, classifiers):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = PyNumber_Multiply(__pyx_v_mem_ttest, __pyx_int_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 358, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_v_mem_ttest, __pyx_int_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 382, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyNumber_Add(__pyx_v_mem_class, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 358, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = PyNumber_Add(__pyx_v_mem_class, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 382, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_r = __pyx_t_1;
-  __pyx_t_1 = 0;
+  __pyx_r = __pyx_t_3;
+  __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":355
- *     return (lytsz + accssz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
+  /* "statmoments/_native.pyx":378
+ *     return (lytsz + accssz + bufsz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
- *     mem_ttest = 0  # included in mem_class
+ *     # ttest memory included in mem_class or std normalization computed one line at a time
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
   __Pyx_AddTraceback("statmoments._native._bivar_sum_base.memory_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_mem_class);
   __Pyx_XDECREF(__pyx_v_mem_ttest);
   __Pyx_XDECREF(__pyx_gb_11statmoments_7_native_15_bivar_sum_base_11memory_size_2generator12);
   __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":360
+/* "statmoments/_native.pyx":384
  *     return mem_class + mem_ttest * 8
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     moment, batch_cnt = self.moment, len(traces)
  *     tr_len, cl_len = self.trace_len, self.classifiers_len
  */
 
@@ -11980,40 +12389,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_traces)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 1); __PYX_ERR(0, 360, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 1); __PYX_ERR(0, 384, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifiers)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 2); __PYX_ERR(0, 360, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 2); __PYX_ERR(0, 384, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update") < 0)) __PYX_ERR(0, 360, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update") < 0)) __PYX_ERR(0, 384, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_traces = values[1];
     __pyx_v_classifiers = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 360, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 384, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native._bivar_sum_base.update", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_15_bivar_sum_base_6update(__pyx_self, __pyx_v_self, __pyx_v_traces, __pyx_v_classifiers);
 
@@ -12056,171 +12465,171 @@
   __Pyx_memviewslice __pyx_t_18 = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_t_19 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("update", 0);
 
-  /* "statmoments/_native.pyx":361
+  /* "statmoments/_native.pyx":385
  * 
  *   def update(self, traces, classifiers):
  *     moment, batch_cnt = self.moment, len(traces)             # <<<<<<<<<<<<<<
  *     tr_len, cl_len = self.trace_len, self.classifiers_len
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 361, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 385, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_Length(__pyx_v_traces); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 361, __pyx_L1_error)
-  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 361, __pyx_L1_error)
+  __pyx_t_2 = PyObject_Length(__pyx_v_traces); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 385, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 385, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_v_moment = __pyx_t_1;
   __pyx_t_1 = 0;
   __pyx_v_batch_cnt = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":362
+  /* "statmoments/_native.pyx":386
  *   def update(self, traces, classifiers):
  *     moment, batch_cnt = self.moment, len(traces)
  *     tr_len, cl_len = self.trace_len, self.classifiers_len             # <<<<<<<<<<<<<<
  * 
  *     self.total_count += batch_cnt
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 362, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 386, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_classifiers_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 362, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_classifiers_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 386, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_tr_len = __pyx_t_3;
   __pyx_t_3 = 0;
   __pyx_v_cl_len = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":364
+  /* "statmoments/_native.pyx":388
  *     tr_len, cl_len = self.trace_len, self.classifiers_len
  * 
  *     self.total_count += batch_cnt             # <<<<<<<<<<<<<<
  * 
  *     if len(self._layout) < batch_cnt:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_total_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 364, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_total_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 388, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_t_1, __pyx_v_batch_cnt); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 364, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_t_1, __pyx_v_batch_cnt); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 388, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_total_count, __pyx_t_3) < 0) __PYX_ERR(0, 364, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_total_count, __pyx_t_3) < 0) __PYX_ERR(0, 388, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":366
+  /* "statmoments/_native.pyx":390
  *     self.total_count += batch_cnt
  * 
  *     if len(self._layout) < batch_cnt:             # <<<<<<<<<<<<<<
- *         self._layout = np.empty((batch_cnt, moment * tr_len + 1), dtype=self._layout.dtype)
+ *       self._layout = np.empty((batch_cnt, moment * tr_len + 1), dtype=self._layout.dtype)
  * 
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_layout); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 366, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_layout); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 390, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 366, __pyx_L1_error)
+  __pyx_t_2 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 390, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 366, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 390, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyObject_RichCompare(__pyx_t_3, __pyx_v_batch_cnt, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 366, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(__pyx_t_3, __pyx_v_batch_cnt, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 390, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 366, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 390, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_4) {
 
-    /* "statmoments/_native.pyx":367
+    /* "statmoments/_native.pyx":391
  * 
  *     if len(self._layout) < batch_cnt:
- *         self._layout = np.empty((batch_cnt, moment * tr_len + 1), dtype=self._layout.dtype)             # <<<<<<<<<<<<<<
+ *       self._layout = np.empty((batch_cnt, moment * tr_len + 1), dtype=self._layout.dtype)             # <<<<<<<<<<<<<<
  * 
  *     tr_lyt = self._layout[:batch_cnt]
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 367, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 391, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 367, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 391, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Multiply(__pyx_v_moment, __pyx_v_tr_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 367, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Multiply(__pyx_v_moment, __pyx_v_tr_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 391, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 367, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 391, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 367, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 391, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v_batch_cnt);
     __Pyx_GIVEREF(__pyx_v_batch_cnt);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_batch_cnt);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_5);
     __pyx_t_5 = 0;
-    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 367, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 391, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
     __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 367, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 391, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_layout); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 367, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_layout); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 391, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_dtype); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 367, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_dtype); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 391, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 367, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 391, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 367, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 391, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_layout, __pyx_t_7) < 0) __PYX_ERR(0, 367, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_layout, __pyx_t_7) < 0) __PYX_ERR(0, 391, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-    /* "statmoments/_native.pyx":366
+    /* "statmoments/_native.pyx":390
  *     self.total_count += batch_cnt
  * 
  *     if len(self._layout) < batch_cnt:             # <<<<<<<<<<<<<<
- *         self._layout = np.empty((batch_cnt, moment * tr_len + 1), dtype=self._layout.dtype)
+ *       self._layout = np.empty((batch_cnt, moment * tr_len + 1), dtype=self._layout.dtype)
  * 
  */
   }
 
-  /* "statmoments/_native.pyx":369
- *         self._layout = np.empty((batch_cnt, moment * tr_len + 1), dtype=self._layout.dtype)
+  /* "statmoments/_native.pyx":393
+ *       self._layout = np.empty((batch_cnt, moment * tr_len + 1), dtype=self._layout.dtype)
  * 
  *     tr_lyt = self._layout[:batch_cnt]             # <<<<<<<<<<<<<<
  *     tr_lyt[:, 0] = 1
  *     tr_lyt_view = tr_lyt[:, 1:].reshape(batch_cnt, moment, tr_len)
  */
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_layout); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 369, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_layout); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 393, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_t_7, 0, 0, NULL, &__pyx_v_batch_cnt, NULL, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 369, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_t_7, 0, 0, NULL, &__pyx_v_batch_cnt, NULL, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 393, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_v_tr_lyt = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":370
+  /* "statmoments/_native.pyx":394
  * 
  *     tr_lyt = self._layout[:batch_cnt]
  *     tr_lyt[:, 0] = 1             # <<<<<<<<<<<<<<
  *     tr_lyt_view = tr_lyt[:, 1:].reshape(batch_cnt, moment, tr_len)
  *     for i in range(cl_len):
  */
-  if (unlikely(PyObject_SetItem(__pyx_v_tr_lyt, __pyx_tuple__16, __pyx_int_1) < 0)) __PYX_ERR(0, 370, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_tr_lyt, __pyx_tuple__18, __pyx_int_1) < 0)) __PYX_ERR(0, 394, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":371
+  /* "statmoments/_native.pyx":395
  *     tr_lyt = self._layout[:batch_cnt]
  *     tr_lyt[:, 0] = 1
  *     tr_lyt_view = tr_lyt[:, 1:].reshape(batch_cnt, moment, tr_len)             # <<<<<<<<<<<<<<
  *     for i in range(cl_len):
  *       n0, n1 = 0, 0
  */
-  __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_tr_lyt, __pyx_tuple__18); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 371, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_tr_lyt, __pyx_tuple__20); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 395, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_reshape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 371, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_reshape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 395, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_t_7 = NULL;
   __pyx_t_8 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_7)) {
@@ -12230,103 +12639,103 @@
       __Pyx_DECREF_SET(__pyx_t_5, function);
       __pyx_t_8 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_5)) {
     PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_v_batch_cnt, __pyx_v_moment, __pyx_v_tr_len};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 371, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 395, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
     PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_v_batch_cnt, __pyx_v_moment, __pyx_v_tr_len};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 371, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 395, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   {
-    __pyx_t_3 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 371, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 395, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     if (__pyx_t_7) {
       __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_7); __pyx_t_7 = NULL;
     }
     __Pyx_INCREF(__pyx_v_batch_cnt);
     __Pyx_GIVEREF(__pyx_v_batch_cnt);
     PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_8, __pyx_v_batch_cnt);
     __Pyx_INCREF(__pyx_v_moment);
     __Pyx_GIVEREF(__pyx_v_moment);
     PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_8, __pyx_v_moment);
     __Pyx_INCREF(__pyx_v_tr_len);
     __Pyx_GIVEREF(__pyx_v_tr_len);
     PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_8, __pyx_v_tr_len);
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 371, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 395, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_tr_lyt_view = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":372
+  /* "statmoments/_native.pyx":396
  *     tr_lyt[:, 0] = 1
  *     tr_lyt_view = tr_lyt[:, 1:].reshape(batch_cnt, moment, tr_len)
  *     for i in range(cl_len):             # <<<<<<<<<<<<<<
  *       n0, n1 = 0, 0
  *       # Sort traces by classifiers
  */
-  __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_v_cl_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 372, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_v_cl_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 396, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
     __pyx_t_5 = __pyx_t_1; __Pyx_INCREF(__pyx_t_5); __pyx_t_2 = 0;
     __pyx_t_9 = NULL;
   } else {
-    __pyx_t_2 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 372, __pyx_L1_error)
+    __pyx_t_2 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 396, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_9 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 372, __pyx_L1_error)
+    __pyx_t_9 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 396, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_9)) {
       if (likely(PyList_CheckExact(__pyx_t_5))) {
         if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_5)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 372, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 396, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 372, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 396, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 372, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 396, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 372, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 396, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
       __pyx_t_1 = __pyx_t_9(__pyx_t_5);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 372, __pyx_L1_error)
+          else __PYX_ERR(0, 396, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":373
+    /* "statmoments/_native.pyx":397
  *     tr_lyt_view = tr_lyt[:, 1:].reshape(batch_cnt, moment, tr_len)
  *     for i in range(cl_len):
  *       n0, n1 = 0, 0             # <<<<<<<<<<<<<<
  *       # Sort traces by classifiers
  *       for j, tr in enumerate(traces):
  */
     __pyx_t_1 = __pyx_int_0;
@@ -12334,286 +12743,286 @@
     __pyx_t_3 = __pyx_int_0;
     __Pyx_INCREF(__pyx_t_3);
     __Pyx_XDECREF_SET(__pyx_v_n0, __pyx_t_1);
     __pyx_t_1 = 0;
     __Pyx_XDECREF_SET(__pyx_v_n1, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "statmoments/_native.pyx":375
+    /* "statmoments/_native.pyx":399
  *       n0, n1 = 0, 0
  *       # Sort traces by classifiers
  *       for j, tr in enumerate(traces):             # <<<<<<<<<<<<<<
  *         if classifiers[j][i]:
  *           tr_lyt_view[batch_cnt - n1 - 1, 0, :] = tr
  */
     __Pyx_INCREF(__pyx_int_0);
     __pyx_t_3 = __pyx_int_0;
     if (likely(PyList_CheckExact(__pyx_v_traces)) || PyTuple_CheckExact(__pyx_v_traces)) {
       __pyx_t_1 = __pyx_v_traces; __Pyx_INCREF(__pyx_t_1); __pyx_t_10 = 0;
       __pyx_t_11 = NULL;
     } else {
-      __pyx_t_10 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_traces); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 375, __pyx_L1_error)
+      __pyx_t_10 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_traces); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 399, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_11 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 375, __pyx_L1_error)
+      __pyx_t_11 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 399, __pyx_L1_error)
     }
     for (;;) {
       if (likely(!__pyx_t_11)) {
         if (likely(PyList_CheckExact(__pyx_t_1))) {
           if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_10); __Pyx_INCREF(__pyx_t_7); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 375, __pyx_L1_error)
+          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_10); __Pyx_INCREF(__pyx_t_7); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 399, __pyx_L1_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_1, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 375, __pyx_L1_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_1, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 399, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         } else {
           if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_10); __Pyx_INCREF(__pyx_t_7); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 375, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_10); __Pyx_INCREF(__pyx_t_7); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 399, __pyx_L1_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_1, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 375, __pyx_L1_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_1, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 399, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         }
       } else {
         __pyx_t_7 = __pyx_t_11(__pyx_t_1);
         if (unlikely(!__pyx_t_7)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 375, __pyx_L1_error)
+            else __PYX_ERR(0, 399, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_7);
       }
       __Pyx_XDECREF_SET(__pyx_v_tr, __pyx_t_7);
       __pyx_t_7 = 0;
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_3);
-      __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_3, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 375, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_3, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 399, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_3);
       __pyx_t_3 = __pyx_t_7;
       __pyx_t_7 = 0;
 
-      /* "statmoments/_native.pyx":376
+      /* "statmoments/_native.pyx":400
  *       # Sort traces by classifiers
  *       for j, tr in enumerate(traces):
  *         if classifiers[j][i]:             # <<<<<<<<<<<<<<
  *           tr_lyt_view[batch_cnt - n1 - 1, 0, :] = tr
  *           n1 += 1
  */
-      __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_classifiers, __pyx_v_j); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 376, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_classifiers, __pyx_v_j); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 400, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_7, __pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 376, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_7, __pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 400, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 376, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 400, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       if (__pyx_t_4) {
 
-        /* "statmoments/_native.pyx":377
+        /* "statmoments/_native.pyx":401
  *       for j, tr in enumerate(traces):
  *         if classifiers[j][i]:
  *           tr_lyt_view[batch_cnt - n1 - 1, 0, :] = tr             # <<<<<<<<<<<<<<
  *           n1 += 1
  *         else:
  */
-        __pyx_t_6 = PyNumber_Subtract(__pyx_v_batch_cnt, __pyx_v_n1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 377, __pyx_L1_error)
+        __pyx_t_6 = PyNumber_Subtract(__pyx_v_batch_cnt, __pyx_v_n1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 401, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 377, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 401, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 377, __pyx_L1_error)
+        __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 401, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_GIVEREF(__pyx_t_7);
         PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_7);
         __Pyx_INCREF(__pyx_int_0);
         __Pyx_GIVEREF(__pyx_int_0);
         PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_0);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_slice__5);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_slice__7);
         __pyx_t_7 = 0;
-        if (unlikely(PyObject_SetItem(__pyx_v_tr_lyt_view, __pyx_t_6, __pyx_v_tr) < 0)) __PYX_ERR(0, 377, __pyx_L1_error)
+        if (unlikely(PyObject_SetItem(__pyx_v_tr_lyt_view, __pyx_t_6, __pyx_v_tr) < 0)) __PYX_ERR(0, 401, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-        /* "statmoments/_native.pyx":378
+        /* "statmoments/_native.pyx":402
  *         if classifiers[j][i]:
  *           tr_lyt_view[batch_cnt - n1 - 1, 0, :] = tr
  *           n1 += 1             # <<<<<<<<<<<<<<
  *         else:
  *           tr_lyt_view[n0, 0, :] = tr
  */
-        __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_v_n1, __pyx_int_1, 1, 1, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 378, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_v_n1, __pyx_int_1, 1, 1, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 402, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF_SET(__pyx_v_n1, __pyx_t_6);
         __pyx_t_6 = 0;
 
-        /* "statmoments/_native.pyx":376
+        /* "statmoments/_native.pyx":400
  *       # Sort traces by classifiers
  *       for j, tr in enumerate(traces):
  *         if classifiers[j][i]:             # <<<<<<<<<<<<<<
  *           tr_lyt_view[batch_cnt - n1 - 1, 0, :] = tr
  *           n1 += 1
  */
         goto __pyx_L8;
       }
 
-      /* "statmoments/_native.pyx":380
+      /* "statmoments/_native.pyx":404
  *           n1 += 1
  *         else:
  *           tr_lyt_view[n0, 0, :] = tr             # <<<<<<<<<<<<<<
  *           n0 += 1
  * 
  */
       /*else*/ {
-        __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 380, __pyx_L1_error)
+        __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 404, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_INCREF(__pyx_v_n0);
         __Pyx_GIVEREF(__pyx_v_n0);
         PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_n0);
         __Pyx_INCREF(__pyx_int_0);
         __Pyx_GIVEREF(__pyx_int_0);
         PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_0);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_slice__5);
-        if (unlikely(PyObject_SetItem(__pyx_v_tr_lyt_view, __pyx_t_6, __pyx_v_tr) < 0)) __PYX_ERR(0, 380, __pyx_L1_error)
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_slice__7);
+        if (unlikely(PyObject_SetItem(__pyx_v_tr_lyt_view, __pyx_t_6, __pyx_v_tr) < 0)) __PYX_ERR(0, 404, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-        /* "statmoments/_native.pyx":381
+        /* "statmoments/_native.pyx":405
  *         else:
  *           tr_lyt_view[n0, 0, :] = tr
  *           n0 += 1             # <<<<<<<<<<<<<<
  * 
  *       # Step 1: Create layout matrix up to moment degree
  */
-        __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_v_n0, __pyx_int_1, 1, 1, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 381, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_v_n0, __pyx_int_1, 1, 1, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 405, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF_SET(__pyx_v_n0, __pyx_t_6);
         __pyx_t_6 = 0;
       }
       __pyx_L8:;
 
-      /* "statmoments/_native.pyx":375
+      /* "statmoments/_native.pyx":399
  *       n0, n1 = 0, 0
  *       # Sort traces by classifiers
  *       for j, tr in enumerate(traces):             # <<<<<<<<<<<<<<
  *         if classifiers[j][i]:
  *           tr_lyt_view[batch_cnt - n1 - 1, 0, :] = tr
  */
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "statmoments/_native.pyx":384
+    /* "statmoments/_native.pyx":408
  * 
  *       # Step 1: Create layout matrix up to moment degree
  *       for j in range(1, moment):             # <<<<<<<<<<<<<<
  *         np.multiply(tr_lyt_view[:, 0, :], tr_lyt_view[:, j - 1, :], tr_lyt_view[:, j, :])
  * 
  */
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 384, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 408, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_int_1);
     __Pyx_GIVEREF(__pyx_int_1);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_int_1);
     __Pyx_INCREF(__pyx_v_moment);
     __Pyx_GIVEREF(__pyx_v_moment);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_moment);
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 384, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 408, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
       __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3); __pyx_t_10 = 0;
       __pyx_t_11 = NULL;
     } else {
-      __pyx_t_10 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 384, __pyx_L1_error)
+      __pyx_t_10 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 408, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_11 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 384, __pyx_L1_error)
+      __pyx_t_11 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 408, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     for (;;) {
       if (likely(!__pyx_t_11)) {
         if (likely(PyList_CheckExact(__pyx_t_3))) {
           if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_3)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_10); __Pyx_INCREF(__pyx_t_1); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 384, __pyx_L1_error)
+          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_10); __Pyx_INCREF(__pyx_t_1); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 408, __pyx_L1_error)
           #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 384, __pyx_L1_error)
+          __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 408, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           #endif
         } else {
           if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_10); __Pyx_INCREF(__pyx_t_1); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 384, __pyx_L1_error)
+          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_10); __Pyx_INCREF(__pyx_t_1); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 408, __pyx_L1_error)
           #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 384, __pyx_L1_error)
+          __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 408, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           #endif
         }
       } else {
         __pyx_t_1 = __pyx_t_11(__pyx_t_3);
         if (unlikely(!__pyx_t_1)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 384, __pyx_L1_error)
+            else __PYX_ERR(0, 408, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_1);
       }
       __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_1);
       __pyx_t_1 = 0;
 
-      /* "statmoments/_native.pyx":385
+      /* "statmoments/_native.pyx":409
  *       # Step 1: Create layout matrix up to moment degree
  *       for j in range(1, moment):
  *         np.multiply(tr_lyt_view[:, 0, :], tr_lyt_view[:, j - 1, :], tr_lyt_view[:, j, :])             # <<<<<<<<<<<<<<
  * 
  *       # Step 2: Gram multiplication accumulates sums of all combinations of all degrees
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 385, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_multiply); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 385, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_multiply); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_tr_lyt_view, __pyx_tuple__19); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 385, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_tr_lyt_view, __pyx_tuple__21); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_12 = __Pyx_PyInt_SubtractObjC(__pyx_v_j, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 385, __pyx_L1_error)
+      __pyx_t_12 = __Pyx_PyInt_SubtractObjC(__pyx_v_j, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
-      __pyx_t_13 = PyTuple_New(3); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 385, __pyx_L1_error)
+      __pyx_t_13 = PyTuple_New(3); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_13);
-      __Pyx_INCREF(__pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_slice__5);
-      PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_slice__5);
+      __Pyx_INCREF(__pyx_slice__7);
+      __Pyx_GIVEREF(__pyx_slice__7);
+      PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_slice__7);
       __Pyx_GIVEREF(__pyx_t_12);
       PyTuple_SET_ITEM(__pyx_t_13, 1, __pyx_t_12);
-      __Pyx_INCREF(__pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_slice__5);
-      PyTuple_SET_ITEM(__pyx_t_13, 2, __pyx_slice__5);
+      __Pyx_INCREF(__pyx_slice__7);
+      __Pyx_GIVEREF(__pyx_slice__7);
+      PyTuple_SET_ITEM(__pyx_t_13, 2, __pyx_slice__7);
       __pyx_t_12 = 0;
-      __pyx_t_12 = __Pyx_PyObject_GetItem(__pyx_v_tr_lyt_view, __pyx_t_13); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 385, __pyx_L1_error)
+      __pyx_t_12 = __Pyx_PyObject_GetItem(__pyx_v_tr_lyt_view, __pyx_t_13); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-      __pyx_t_13 = PyTuple_New(3); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 385, __pyx_L1_error)
+      __pyx_t_13 = PyTuple_New(3); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_13);
-      __Pyx_INCREF(__pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_slice__5);
-      PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_slice__5);
+      __Pyx_INCREF(__pyx_slice__7);
+      __Pyx_GIVEREF(__pyx_slice__7);
+      PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_slice__7);
       __Pyx_INCREF(__pyx_v_j);
       __Pyx_GIVEREF(__pyx_v_j);
       PyTuple_SET_ITEM(__pyx_t_13, 1, __pyx_v_j);
-      __Pyx_INCREF(__pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_slice__5);
-      PyTuple_SET_ITEM(__pyx_t_13, 2, __pyx_slice__5);
-      __pyx_t_14 = __Pyx_PyObject_GetItem(__pyx_v_tr_lyt_view, __pyx_t_13); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 385, __pyx_L1_error)
+      __Pyx_INCREF(__pyx_slice__7);
+      __Pyx_GIVEREF(__pyx_slice__7);
+      PyTuple_SET_ITEM(__pyx_t_13, 2, __pyx_slice__7);
+      __pyx_t_14 = __Pyx_PyObject_GetItem(__pyx_v_tr_lyt_view, __pyx_t_13); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_14);
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
       __pyx_t_13 = NULL;
       __pyx_t_8 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
         __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_7);
         if (likely(__pyx_t_13)) {
@@ -12623,326 +13032,326 @@
           __Pyx_DECREF_SET(__pyx_t_7, function);
           __pyx_t_8 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_7)) {
         PyObject *__pyx_temp[4] = {__pyx_t_13, __pyx_t_6, __pyx_t_12, __pyx_t_14};
-        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 385, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 409, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_7)) {
         PyObject *__pyx_temp[4] = {__pyx_t_13, __pyx_t_6, __pyx_t_12, __pyx_t_14};
-        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 385, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 409, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
       } else
       #endif
       {
-        __pyx_t_15 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 385, __pyx_L1_error)
+        __pyx_t_15 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 409, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_15);
         if (__pyx_t_13) {
           __Pyx_GIVEREF(__pyx_t_13); PyTuple_SET_ITEM(__pyx_t_15, 0, __pyx_t_13); __pyx_t_13 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_6);
         PyTuple_SET_ITEM(__pyx_t_15, 0+__pyx_t_8, __pyx_t_6);
         __Pyx_GIVEREF(__pyx_t_12);
         PyTuple_SET_ITEM(__pyx_t_15, 1+__pyx_t_8, __pyx_t_12);
         __Pyx_GIVEREF(__pyx_t_14);
         PyTuple_SET_ITEM(__pyx_t_15, 2+__pyx_t_8, __pyx_t_14);
         __pyx_t_6 = 0;
         __pyx_t_12 = 0;
         __pyx_t_14 = 0;
-        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_15, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 385, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_15, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 409, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
       }
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "statmoments/_native.pyx":384
+      /* "statmoments/_native.pyx":408
  * 
  *       # Step 1: Create layout matrix up to moment degree
  *       for j in range(1, moment):             # <<<<<<<<<<<<<<
  *         np.multiply(tr_lyt_view[:, 0, :], tr_lyt_view[:, j - 1, :], tr_lyt_view[:, j, :])
  * 
  */
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "statmoments/_native.pyx":388
+    /* "statmoments/_native.pyx":412
  * 
  *       # Step 2: Gram multiplication accumulates sums of all combinations of all degrees
  *       if n0 > 0:             # <<<<<<<<<<<<<<
  *         # syrk: acc0 += T0 * T0.T
  *         if tr_lyt.dtype == np.float64:
  */
-    __pyx_t_3 = PyObject_RichCompare(__pyx_v_n0, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 388, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 388, __pyx_L1_error)
+    __pyx_t_3 = PyObject_RichCompare(__pyx_v_n0, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 412, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 412, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_4) {
 
-      /* "statmoments/_native.pyx":390
+      /* "statmoments/_native.pyx":414
  *       if n0 > 0:
  *         # syrk: acc0 += T0 * T0.T
  *         if tr_lyt.dtype == np.float64:             # <<<<<<<<<<<<<<
  *           dsyrk(tr_lyt[:n0], self._accs[i, :-1], b'L')
  *         else:
  */
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_tr_lyt, __pyx_n_s_dtype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 390, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_tr_lyt, __pyx_n_s_dtype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 414, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 390, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 414, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 390, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 414, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyObject_RichCompare(__pyx_t_3, __pyx_t_7, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 390, __pyx_L1_error)
+      __pyx_t_1 = PyObject_RichCompare(__pyx_t_3, __pyx_t_7, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 414, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 390, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 414, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       if (__pyx_t_4) {
 
-        /* "statmoments/_native.pyx":391
+        /* "statmoments/_native.pyx":415
  *         # syrk: acc0 += T0 * T0.T
  *         if tr_lyt.dtype == np.float64:
  *           dsyrk(tr_lyt[:n0], self._accs[i, :-1], b'L')             # <<<<<<<<<<<<<<
  *         else:
  *           ssyrk(tr_lyt[:n0], self._accs[i, :-1], b'L')
  */
-        __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_tr_lyt, 0, 0, NULL, &__pyx_v_n0, NULL, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 391, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_tr_lyt, 0, 0, NULL, &__pyx_v_n0, NULL, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 415, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 391, __pyx_L1_error)
+        __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 415, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 391, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 415, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 391, __pyx_L1_error)
+        __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 415, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_INCREF(__pyx_v_i);
         __Pyx_GIVEREF(__pyx_v_i);
         PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_i);
-        __Pyx_INCREF(__pyx_slice__20);
-        __Pyx_GIVEREF(__pyx_slice__20);
-        PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_slice__20);
-        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 391, __pyx_L1_error)
+        __Pyx_INCREF(__pyx_slice__22);
+        __Pyx_GIVEREF(__pyx_slice__22);
+        PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_slice__22);
+        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 415, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 391, __pyx_L1_error)
+        __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 415, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_f_11statmoments_7_native_dsyrk(__pyx_t_16, __pyx_t_17, 'L', NULL);
         __PYX_XDEC_MEMVIEW(&__pyx_t_16, 1);
         __pyx_t_16.memview = NULL;
         __pyx_t_16.data = NULL;
         __PYX_XDEC_MEMVIEW(&__pyx_t_17, 1);
         __pyx_t_17.memview = NULL;
         __pyx_t_17.data = NULL;
 
-        /* "statmoments/_native.pyx":390
+        /* "statmoments/_native.pyx":414
  *       if n0 > 0:
  *         # syrk: acc0 += T0 * T0.T
  *         if tr_lyt.dtype == np.float64:             # <<<<<<<<<<<<<<
  *           dsyrk(tr_lyt[:n0], self._accs[i, :-1], b'L')
  *         else:
  */
         goto __pyx_L12;
       }
 
-      /* "statmoments/_native.pyx":393
+      /* "statmoments/_native.pyx":417
  *           dsyrk(tr_lyt[:n0], self._accs[i, :-1], b'L')
  *         else:
  *           ssyrk(tr_lyt[:n0], self._accs[i, :-1], b'L')             # <<<<<<<<<<<<<<
  *       if n1 > 0:
  *         # syrk: acc1 += T1 * T1.T
  */
       /*else*/ {
-        __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_tr_lyt, 0, 0, NULL, &__pyx_v_n0, NULL, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 393, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_tr_lyt, 0, 0, NULL, &__pyx_v_n0, NULL, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 417, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_18 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_float(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 393, __pyx_L1_error)
+        __pyx_t_18 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_float(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 417, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 393, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 417, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 393, __pyx_L1_error)
+        __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 417, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_INCREF(__pyx_v_i);
         __Pyx_GIVEREF(__pyx_v_i);
         PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_i);
-        __Pyx_INCREF(__pyx_slice__20);
-        __Pyx_GIVEREF(__pyx_slice__20);
-        PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_slice__20);
-        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 393, __pyx_L1_error)
+        __Pyx_INCREF(__pyx_slice__22);
+        __Pyx_GIVEREF(__pyx_slice__22);
+        PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_slice__22);
+        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 417, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_float(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 393, __pyx_L1_error)
+        __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_float(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 417, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __pyx_f_11statmoments_7_native_ssyrk(__pyx_t_18, __pyx_t_19, 'L', NULL);
         __PYX_XDEC_MEMVIEW(&__pyx_t_18, 1);
         __pyx_t_18.memview = NULL;
         __pyx_t_18.data = NULL;
         __PYX_XDEC_MEMVIEW(&__pyx_t_19, 1);
         __pyx_t_19.memview = NULL;
         __pyx_t_19.data = NULL;
       }
       __pyx_L12:;
 
-      /* "statmoments/_native.pyx":388
+      /* "statmoments/_native.pyx":412
  * 
  *       # Step 2: Gram multiplication accumulates sums of all combinations of all degrees
  *       if n0 > 0:             # <<<<<<<<<<<<<<
  *         # syrk: acc0 += T0 * T0.T
  *         if tr_lyt.dtype == np.float64:
  */
     }
 
-    /* "statmoments/_native.pyx":394
+    /* "statmoments/_native.pyx":418
  *         else:
  *           ssyrk(tr_lyt[:n0], self._accs[i, :-1], b'L')
  *       if n1 > 0:             # <<<<<<<<<<<<<<
  *         # syrk: acc1 += T1 * T1.T
  *         if tr_lyt.dtype == np.float64:
  */
-    __pyx_t_1 = PyObject_RichCompare(__pyx_v_n1, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 394, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 394, __pyx_L1_error)
+    __pyx_t_1 = PyObject_RichCompare(__pyx_v_n1, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 418, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (__pyx_t_4) {
 
-      /* "statmoments/_native.pyx":396
+      /* "statmoments/_native.pyx":420
  *       if n1 > 0:
  *         # syrk: acc1 += T1 * T1.T
  *         if tr_lyt.dtype == np.float64:             # <<<<<<<<<<<<<<
  *           dsyrk(tr_lyt[n0:], self._accs[i, 1:], b'U')
  *         else:
  */
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_tr_lyt, __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 396, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_tr_lyt, __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 420, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 396, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 420, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 396, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 420, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyObject_RichCompare(__pyx_t_1, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 396, __pyx_L1_error)
+      __pyx_t_7 = PyObject_RichCompare(__pyx_t_1, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 420, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 396, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 420, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       if (__pyx_t_4) {
 
-        /* "statmoments/_native.pyx":397
+        /* "statmoments/_native.pyx":421
  *         # syrk: acc1 += T1 * T1.T
  *         if tr_lyt.dtype == np.float64:
  *           dsyrk(tr_lyt[n0:], self._accs[i, 1:], b'U')             # <<<<<<<<<<<<<<
  *         else:
  *           ssyrk(tr_lyt[n0:], self._accs[i, 1:], b'U')
  */
-        __pyx_t_7 = __Pyx_PyObject_GetSlice(__pyx_v_tr_lyt, 0, 0, &__pyx_v_n0, NULL, NULL, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 397, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_GetSlice(__pyx_v_tr_lyt, 0, 0, &__pyx_v_n0, NULL, NULL, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 421, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 397, __pyx_L1_error)
+        __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 421, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 397, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 421, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 397, __pyx_L1_error)
+        __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 421, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_INCREF(__pyx_v_i);
         __Pyx_GIVEREF(__pyx_v_i);
         PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_i);
-        __Pyx_INCREF(__pyx_slice__17);
-        __Pyx_GIVEREF(__pyx_slice__17);
-        PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_slice__17);
-        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_7, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 397, __pyx_L1_error)
+        __Pyx_INCREF(__pyx_slice__19);
+        __Pyx_GIVEREF(__pyx_slice__19);
+        PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_slice__19);
+        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_7, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 421, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 397, __pyx_L1_error)
+        __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 421, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __pyx_f_11statmoments_7_native_dsyrk(__pyx_t_17, __pyx_t_16, 'U', NULL);
         __PYX_XDEC_MEMVIEW(&__pyx_t_17, 1);
         __pyx_t_17.memview = NULL;
         __pyx_t_17.data = NULL;
         __PYX_XDEC_MEMVIEW(&__pyx_t_16, 1);
         __pyx_t_16.memview = NULL;
         __pyx_t_16.data = NULL;
 
-        /* "statmoments/_native.pyx":396
+        /* "statmoments/_native.pyx":420
  *       if n1 > 0:
  *         # syrk: acc1 += T1 * T1.T
  *         if tr_lyt.dtype == np.float64:             # <<<<<<<<<<<<<<
  *           dsyrk(tr_lyt[n0:], self._accs[i, 1:], b'U')
  *         else:
  */
         goto __pyx_L14;
       }
 
-      /* "statmoments/_native.pyx":399
+      /* "statmoments/_native.pyx":423
  *           dsyrk(tr_lyt[n0:], self._accs[i, 1:], b'U')
  *         else:
  *           ssyrk(tr_lyt[n0:], self._accs[i, 1:], b'U')             # <<<<<<<<<<<<<<
  * 
  *   def counts(self, i):
  */
       /*else*/ {
-        __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_tr_lyt, 0, 0, &__pyx_v_n0, NULL, NULL, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 399, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_tr_lyt, 0, 0, &__pyx_v_n0, NULL, NULL, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 423, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_float(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 399, __pyx_L1_error)
+        __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_float(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 423, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 399, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 423, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 399, __pyx_L1_error)
+        __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 423, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_INCREF(__pyx_v_i);
         __Pyx_GIVEREF(__pyx_v_i);
         PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_i);
-        __Pyx_INCREF(__pyx_slice__17);
-        __Pyx_GIVEREF(__pyx_slice__17);
-        PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_slice__17);
-        __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 399, __pyx_L1_error)
+        __Pyx_INCREF(__pyx_slice__19);
+        __Pyx_GIVEREF(__pyx_slice__19);
+        PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_slice__19);
+        __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 423, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __pyx_t_18 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_float(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 399, __pyx_L1_error)
+        __pyx_t_18 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_float(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 423, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __pyx_f_11statmoments_7_native_ssyrk(__pyx_t_19, __pyx_t_18, 'U', NULL);
         __PYX_XDEC_MEMVIEW(&__pyx_t_19, 1);
         __pyx_t_19.memview = NULL;
         __pyx_t_19.data = NULL;
         __PYX_XDEC_MEMVIEW(&__pyx_t_18, 1);
         __pyx_t_18.memview = NULL;
         __pyx_t_18.data = NULL;
       }
       __pyx_L14:;
 
-      /* "statmoments/_native.pyx":394
+      /* "statmoments/_native.pyx":418
  *         else:
  *           ssyrk(tr_lyt[:n0], self._accs[i, :-1], b'L')
  *       if n1 > 0:             # <<<<<<<<<<<<<<
  *         # syrk: acc1 += T1 * T1.T
  *         if tr_lyt.dtype == np.float64:
  */
     }
 
-    /* "statmoments/_native.pyx":372
+    /* "statmoments/_native.pyx":396
  *     tr_lyt[:, 0] = 1
  *     tr_lyt_view = tr_lyt[:, 1:].reshape(batch_cnt, moment, tr_len)
  *     for i in range(cl_len):             # <<<<<<<<<<<<<<
  *       n0, n1 = 0, 0
  *       # Sort traces by classifiers
  */
   }
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":360
+  /* "statmoments/_native.pyx":384
  *     return mem_class + mem_ttest * 8
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     moment, batch_cnt = self.moment, len(traces)
  *     tr_len, cl_len = self.trace_len, self.classifiers_len
  */
 
@@ -12978,15 +13387,15 @@
   __Pyx_XDECREF(__pyx_v_j);
   __Pyx_XDECREF(__pyx_v_tr);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":401
+/* "statmoments/_native.pyx":425
  *           ssyrk(tr_lyt[n0:], self._accs[i, 1:], b'U')
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
  *     accs = self._accs[i]
  *     acc0, acc1 = accs, accs[1:].T
  */
 
@@ -13021,32 +13430,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_i)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, 1); __PYX_ERR(0, 401, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, 1); __PYX_ERR(0, 425, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "counts") < 0)) __PYX_ERR(0, 401, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "counts") < 0)) __PYX_ERR(0, 425, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_i = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 401, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 425, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native._bivar_sum_base.counts", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_15_bivar_sum_base_8counts(__pyx_self, __pyx_v_self, __pyx_v_i);
 
@@ -13065,73 +13474,73 @@
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("counts", 0);
 
-  /* "statmoments/_native.pyx":402
+  /* "statmoments/_native.pyx":426
  * 
  *   def counts(self, i):
  *     accs = self._accs[i]             # <<<<<<<<<<<<<<
  *     acc0, acc1 = accs, accs[1:].T
  *     return acc0[0, 0], acc1[0, 0]
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 402, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 426, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 402, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 426, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_accs = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":403
+  /* "statmoments/_native.pyx":427
  *   def counts(self, i):
  *     accs = self._accs[i]
  *     acc0, acc1 = accs, accs[1:].T             # <<<<<<<<<<<<<<
  *     return acc0[0, 0], acc1[0, 0]
  * 
  */
   __pyx_t_2 = __pyx_v_accs;
   __Pyx_INCREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_accs, 1, 0, NULL, NULL, &__pyx_slice__17, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 403, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_accs, 1, 0, NULL, NULL, &__pyx_slice__19, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 427, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_T); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 403, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_T); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 427, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_acc0 = __pyx_t_2;
   __pyx_t_2 = 0;
   __pyx_v_acc1 = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":404
+  /* "statmoments/_native.pyx":428
  *     accs = self._accs[i]
  *     acc0, acc1 = accs, accs[1:].T
  *     return acc0[0, 0], acc1[0, 0]             # <<<<<<<<<<<<<<
  * 
  *   def _moments(self, moments, normalize):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_acc0, __pyx_tuple__21); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 404, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_acc0, __pyx_tuple__23); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 428, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_acc1, __pyx_tuple__21); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 404, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_acc1, __pyx_tuple__23); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 428, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 404, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 428, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_2);
   __pyx_t_3 = 0;
   __pyx_t_2 = 0;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":401
+  /* "statmoments/_native.pyx":425
  *           ssyrk(tr_lyt[n0:], self._accs[i, 1:], b'U')
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
  *     accs = self._accs[i]
  *     acc0, acc1 = accs, accs[1:].T
  */
 
@@ -13148,15 +13557,15 @@
   __Pyx_XDECREF(__pyx_v_acc1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static PyObject *__pyx_gb_11statmoments_7_native_15_bivar_sum_base_12generator(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "statmoments/_native.pyx":406
+/* "statmoments/_native.pyx":430
  *     return acc0[0, 0], acc1[0, 0]
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     maxm = np.max(moments)
  *     if self.moment * 2 < maxm:
  */
 
@@ -13194,40 +13603,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moments)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 1); __PYX_ERR(0, 406, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 1); __PYX_ERR(0, 430, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_normalize)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 2); __PYX_ERR(0, 406, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 2); __PYX_ERR(0, 430, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_moments") < 0)) __PYX_ERR(0, 406, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_moments") < 0)) __PYX_ERR(0, 430, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_moments = values[1];
     __pyx_v_normalize = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 406, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 430, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native._bivar_sum_base._moments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_15_bivar_sum_base_10_moments(__pyx_self, __pyx_v_self, __pyx_v_moments, __pyx_v_normalize);
 
@@ -13244,29 +13653,29 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_moments", 0);
   __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_2__moments *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_2__moments(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_2__moments, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_2__moments *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 406, __pyx_L1_error)
+    __PYX_ERR(0, 430, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
   __pyx_cur_scope->__pyx_v_moments = __pyx_v_moments;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_moments);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_moments);
   __pyx_cur_scope->__pyx_v_normalize = __pyx_v_normalize;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_normalize);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_normalize);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_15_bivar_sum_base_12generator, __pyx_codeobj__22, (PyObject *) __pyx_cur_scope, __pyx_n_s_moments_2, __pyx_n_s_bivar_sum_base__moments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 406, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_15_bivar_sum_base_12generator, __pyx_codeobj__24, (PyObject *) __pyx_cur_scope, __pyx_n_s_moments_2, __pyx_n_s_bivar_sum_base__moments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 430, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -13289,556 +13698,570 @@
   Py_ssize_t __pyx_t_5;
   PyObject *(*__pyx_t_6)(PyObject *);
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   PyObject *(*__pyx_t_9)(PyObject *);
   PyObject *__pyx_t_10 = NULL;
   int __pyx_t_11;
-  Py_ssize_t __pyx_t_12;
-  PyObject *(*__pyx_t_13)(PyObject *);
-  PyObject *__pyx_t_14 = NULL;
-  int __pyx_t_15;
+  long __pyx_t_12;
+  Py_ssize_t __pyx_t_13;
+  PyObject *(*__pyx_t_14)(PyObject *);
+  PyObject *__pyx_t_15 = NULL;
   long __pyx_t_16;
-  PyObject *__pyx_t_17 = NULL;
+  int __pyx_t_17;
+  PyObject *__pyx_t_18 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("_moments", 0);
   switch (__pyx_generator->resume_label) {
     case 0: goto __pyx_L3_first_run;
-    case 1: goto __pyx_L20_resume_from_yield;
+    case 1: goto __pyx_L21_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 406, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 430, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":407
+  /* "statmoments/_native.pyx":431
  * 
  *   def _moments(self, moments, normalize):
  *     maxm = np.max(moments)             # <<<<<<<<<<<<<<
  *     if self.moment * 2 < maxm:
  *       raise ValueError("The moment should be less or equal than indicated in constructor.")
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 407, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 431, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_max); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 407, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_max); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 431, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_cur_scope->__pyx_v_moments) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_cur_scope->__pyx_v_moments);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 407, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 431, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v_maxm = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":408
+  /* "statmoments/_native.pyx":432
  *   def _moments(self, moments, normalize):
  *     maxm = np.max(moments)
  *     if self.moment * 2 < maxm:             # <<<<<<<<<<<<<<
  *       raise ValueError("The moment should be less or equal than indicated in constructor.")
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 408, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 432, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_int_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 408, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_int_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 432, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyObject_RichCompare(__pyx_t_3, __pyx_cur_scope->__pyx_v_maxm, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 408, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(__pyx_t_3, __pyx_cur_scope->__pyx_v_maxm, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 432, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 408, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 432, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (unlikely(__pyx_t_4)) {
 
-    /* "statmoments/_native.pyx":409
+    /* "statmoments/_native.pyx":433
  *     maxm = np.max(moments)
  *     if self.moment * 2 < maxm:
  *       raise ValueError("The moment should be less or equal than indicated in constructor.")             # <<<<<<<<<<<<<<
  * 
- *     moments = [m-1 for m in moments]
+ *     moments = [m - 1 for m in moments]
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 409, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 433, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 409, __pyx_L1_error)
+    __PYX_ERR(0, 433, __pyx_L1_error)
 
-    /* "statmoments/_native.pyx":408
+    /* "statmoments/_native.pyx":432
  *   def _moments(self, moments, normalize):
  *     maxm = np.max(moments)
  *     if self.moment * 2 < maxm:             # <<<<<<<<<<<<<<
  *       raise ValueError("The moment should be less or equal than indicated in constructor.")
  * 
  */
   }
 
-  /* "statmoments/_native.pyx":411
+  /* "statmoments/_native.pyx":435
  *       raise ValueError("The moment should be less or equal than indicated in constructor.")
  * 
- *     moments = [m-1 for m in moments]             # <<<<<<<<<<<<<<
- *     ma, tr_len, cl_len = self.moment, self.trace_len, self._accs.shape[0]
- *     # 2D stat should return a separate piece of memory to avoid buffer corruption
+ *     moments = [m - 1 for m in moments]             # <<<<<<<<<<<<<<
+ *     ma, min_cnt = self.moment, self.acc_min_count
+ *     tr_len, cl_len = self.trace_len, self._accs.shape[0]
  */
   { /* enter inner scope */
-    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 411, __pyx_L1_error)
+    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 435, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_v_moments)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_moments)) {
       __pyx_t_3 = __pyx_cur_scope->__pyx_v_moments; __Pyx_INCREF(__pyx_t_3); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
     } else {
-      __pyx_t_5 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 411, __pyx_L1_error)
+      __pyx_t_5 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 435, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_6 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 411, __pyx_L1_error)
+      __pyx_t_6 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 435, __pyx_L1_error)
     }
     for (;;) {
       if (likely(!__pyx_t_6)) {
         if (likely(PyList_CheckExact(__pyx_t_3))) {
           if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_3)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 411, __pyx_L1_error)
+          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 435, __pyx_L1_error)
           #else
-          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 411, __pyx_L1_error)
+          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 435, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           #endif
         } else {
           if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 411, __pyx_L1_error)
+          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 435, __pyx_L1_error)
           #else
-          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 411, __pyx_L1_error)
+          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 435, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           #endif
         }
       } else {
         __pyx_t_2 = __pyx_t_6(__pyx_t_3);
         if (unlikely(!__pyx_t_2)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 411, __pyx_L1_error)
+            else __PYX_ERR(0, 435, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_2);
       }
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_8genexpr1__pyx_v_m);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_8genexpr1__pyx_v_m, __pyx_t_2);
       __Pyx_GIVEREF(__pyx_t_2);
       __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_cur_scope->__pyx_8genexpr1__pyx_v_m, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 411, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_cur_scope->__pyx_8genexpr1__pyx_v_m, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 435, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 411, __pyx_L1_error)
+      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 435, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   } /* exit inner scope */
   __Pyx_GOTREF(__pyx_cur_scope->__pyx_v_moments);
   __Pyx_DECREF_SET(__pyx_cur_scope->__pyx_v_moments, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":412
+  /* "statmoments/_native.pyx":436
  * 
- *     moments = [m-1 for m in moments]
- *     ma, tr_len, cl_len = self.moment, self.trace_len, self._accs.shape[0]             # <<<<<<<<<<<<<<
+ *     moments = [m - 1 for m in moments]
+ *     ma, min_cnt = self.moment, self.acc_min_count             # <<<<<<<<<<<<<<
+ *     tr_len, cl_len = self.trace_len, self._accs.shape[0]
  *     # 2D stat should return a separate piece of memory to avoid buffer corruption
- *     # while normalizing coskeweness and higher moments
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 412, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 436, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 412, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_acc_min_count); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 436, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 412, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_shape); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 412, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_7, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 412, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v_ma = __pyx_t_1;
   __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_3);
+  __pyx_cur_scope->__pyx_v_min_cnt = __pyx_t_3;
+  __pyx_t_3 = 0;
+
+  /* "statmoments/_native.pyx":437
+ *     moments = [m - 1 for m in moments]
+ *     ma, min_cnt = self.moment, self.acc_min_count
+ *     tr_len, cl_len = self.trace_len, self._accs.shape[0]             # <<<<<<<<<<<<<<
+ *     # 2D stat should return a separate piece of memory to avoid buffer corruption
+ *     # while normalizing coskeweness and higher moments
+ */
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 437, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 437, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 437, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 437, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_GIVEREF(__pyx_t_3);
   __pyx_cur_scope->__pyx_v_tr_len = __pyx_t_3;
   __pyx_t_3 = 0;
-  __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_cur_scope->__pyx_v_cl_len = __pyx_t_2;
-  __pyx_t_2 = 0;
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_cur_scope->__pyx_v_cl_len = __pyx_t_1;
+  __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":415
+  /* "statmoments/_native.pyx":440
  *     # 2D stat should return a separate piece of memory to avoid buffer corruption
  *     # while normalizing coskeweness and higher moments
  *     cm, buf = np.empty((2, maxm, tr_len), dtype=np.float64), self._buf             # <<<<<<<<<<<<<<
  * 
  *     for ii in range(cl_len):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 415, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 415, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 440, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 440, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 415, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 440, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
-  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_2);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_int_2);
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_maxm);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_maxm);
-  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_cur_scope->__pyx_v_maxm);
+  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_cur_scope->__pyx_v_maxm);
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_tr_len);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_tr_len);
-  PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_cur_scope->__pyx_v_tr_len);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 415, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
-  __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 415, __pyx_L1_error)
+  PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_cur_scope->__pyx_v_tr_len);
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 440, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 415, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
+  __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 440, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 440, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_float64); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 415, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_float64); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 440, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_8) < 0) __PYX_ERR(0, 415, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_8) < 0) __PYX_ERR(0, 440, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 415, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 440, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_buf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 415, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_buf); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 440, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_8);
   __pyx_cur_scope->__pyx_v_cm = __pyx_t_8;
   __pyx_t_8 = 0;
-  __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_cur_scope->__pyx_v_buf = __pyx_t_2;
-  __pyx_t_2 = 0;
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_cur_scope->__pyx_v_buf = __pyx_t_1;
+  __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":417
+  /* "statmoments/_native.pyx":442
  *     cm, buf = np.empty((2, maxm, tr_len), dtype=np.float64), self._buf
  * 
  *     for ii in range(cl_len):             # <<<<<<<<<<<<<<
  *       n0, n1 = self.counts(ii)
- *       acc0, acc1 = self._accs[ii], self._accs[ii, 1:].T
+ * 
  */
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_cur_scope->__pyx_v_cl_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 417, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
-    __pyx_t_8 = __pyx_t_2; __Pyx_INCREF(__pyx_t_8); __pyx_t_5 = 0;
+  __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_cur_scope->__pyx_v_cl_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 442, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
+    __pyx_t_8 = __pyx_t_1; __Pyx_INCREF(__pyx_t_8); __pyx_t_5 = 0;
     __pyx_t_6 = NULL;
   } else {
-    __pyx_t_5 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 417, __pyx_L1_error)
+    __pyx_t_5 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 442, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_6 = Py_TYPE(__pyx_t_8)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 417, __pyx_L1_error)
+    __pyx_t_6 = Py_TYPE(__pyx_t_8)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 442, __pyx_L1_error)
   }
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_6)) {
       if (likely(PyList_CheckExact(__pyx_t_8))) {
         if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_8)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 417, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 442, __pyx_L1_error)
         #else
-        __pyx_t_2 = PySequence_ITEM(__pyx_t_8, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 417, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_8, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 442, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_8)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 417, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 442, __pyx_L1_error)
         #else
-        __pyx_t_2 = PySequence_ITEM(__pyx_t_8, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 417, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_8, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 442, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
-      __pyx_t_2 = __pyx_t_6(__pyx_t_8);
-      if (unlikely(!__pyx_t_2)) {
+      __pyx_t_1 = __pyx_t_6(__pyx_t_8);
+      if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 417, __pyx_L1_error)
+          else __PYX_ERR(0, 442, __pyx_L1_error)
         }
         break;
       }
-      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_ii);
-    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_ii, __pyx_t_2);
-    __Pyx_GIVEREF(__pyx_t_2);
-    __pyx_t_2 = 0;
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_ii, __pyx_t_1);
+    __Pyx_GIVEREF(__pyx_t_1);
+    __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":418
+    /* "statmoments/_native.pyx":443
  * 
  *     for ii in range(cl_len):
  *       n0, n1 = self.counts(ii)             # <<<<<<<<<<<<<<
- *       acc0, acc1 = self._accs[ii], self._accs[ii, 1:].T
  * 
+ *       acc0, acc1 = self._accs[ii], self._accs[ii, 1:].T
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_counts); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 418, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_counts); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 443, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_3 = NULL;
-    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
-      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
+    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
+      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_3)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_1, function);
+        __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
-    __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_3, __pyx_cur_scope->__pyx_v_ii) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_cur_scope->__pyx_v_ii);
+    __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_cur_scope->__pyx_v_ii) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_cur_scope->__pyx_v_ii);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 418, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if ((likely(PyTuple_CheckExact(__pyx_t_2))) || (PyList_CheckExact(__pyx_t_2))) {
-      PyObject* sequence = __pyx_t_2;
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 443, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
+      PyObject* sequence = __pyx_t_1;
       Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
       if (unlikely(size != 2)) {
         if (size > 2) __Pyx_RaiseTooManyValuesError(2);
         else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-        __PYX_ERR(0, 418, __pyx_L1_error)
+        __PYX_ERR(0, 443, __pyx_L1_error)
       }
       #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
       if (likely(PyTuple_CheckExact(sequence))) {
-        __pyx_t_1 = PyTuple_GET_ITEM(sequence, 0); 
+        __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
         __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1); 
       } else {
-        __pyx_t_1 = PyList_GET_ITEM(sequence, 0); 
+        __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
         __pyx_t_3 = PyList_GET_ITEM(sequence, 1); 
       }
-      __Pyx_INCREF(__pyx_t_1);
+      __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       #else
-      __pyx_t_1 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 418, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 418, __pyx_L1_error)
+      __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 443, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_3 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 443, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       #endif
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     } else {
       Py_ssize_t index = -1;
-      __pyx_t_7 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 418, __pyx_L1_error)
+      __pyx_t_7 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 443, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_9 = Py_TYPE(__pyx_t_7)->tp_iternext;
-      index = 0; __pyx_t_1 = __pyx_t_9(__pyx_t_7); if (unlikely(!__pyx_t_1)) goto __pyx_L9_unpacking_failed;
-      __Pyx_GOTREF(__pyx_t_1);
+      index = 0; __pyx_t_2 = __pyx_t_9(__pyx_t_7); if (unlikely(!__pyx_t_2)) goto __pyx_L9_unpacking_failed;
+      __Pyx_GOTREF(__pyx_t_2);
       index = 1; __pyx_t_3 = __pyx_t_9(__pyx_t_7); if (unlikely(!__pyx_t_3)) goto __pyx_L9_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_3);
-      if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_7), 2) < 0) __PYX_ERR(0, 418, __pyx_L1_error)
+      if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_7), 2) < 0) __PYX_ERR(0, 443, __pyx_L1_error)
       __pyx_t_9 = NULL;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       goto __pyx_L10_unpacking_done;
       __pyx_L9_unpacking_failed:;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __pyx_t_9 = NULL;
       if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-      __PYX_ERR(0, 418, __pyx_L1_error)
+      __PYX_ERR(0, 443, __pyx_L1_error)
       __pyx_L10_unpacking_done:;
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_n0);
-    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_n0, __pyx_t_1);
-    __Pyx_GIVEREF(__pyx_t_1);
-    __pyx_t_1 = 0;
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_n0, __pyx_t_2);
+    __Pyx_GIVEREF(__pyx_t_2);
+    __pyx_t_2 = 0;
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_n1);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_n1, __pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "statmoments/_native.pyx":419
- *     for ii in range(cl_len):
+    /* "statmoments/_native.pyx":445
  *       n0, n1 = self.counts(ii)
+ * 
  *       acc0, acc1 = self._accs[ii], self._accs[ii, 1:].T             # <<<<<<<<<<<<<<
  * 
  *       # Convert to double if accumulator is float
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 419, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_cur_scope->__pyx_v_ii); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 419, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 445, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_cur_scope->__pyx_v_ii); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 445, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 419, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 419, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 445, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 445, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_cur_scope->__pyx_v_ii);
     __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_ii);
-    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_cur_scope->__pyx_v_ii);
-    __Pyx_INCREF(__pyx_slice__17);
-    __Pyx_GIVEREF(__pyx_slice__17);
-    PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_slice__17);
-    __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 419, __pyx_L1_error)
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_cur_scope->__pyx_v_ii);
+    __Pyx_INCREF(__pyx_slice__19);
+    __Pyx_GIVEREF(__pyx_slice__19);
+    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_slice__19);
+    __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 445, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_T); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 419, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_T); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 445, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_acc0);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_acc0, __pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_3);
     __pyx_t_3 = 0;
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_acc1);
-    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_acc1, __pyx_t_1);
-    __Pyx_GIVEREF(__pyx_t_1);
-    __pyx_t_1 = 0;
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_acc1, __pyx_t_2);
+    __Pyx_GIVEREF(__pyx_t_2);
+    __pyx_t_2 = 0;
 
-    /* "statmoments/_native.pyx":422
+    /* "statmoments/_native.pyx":448
  * 
  *       # Convert to double if accumulator is float
  *       acc0 = np.asarray(acc0, dtype=np.float64)             # <<<<<<<<<<<<<<
  *       acc1 = np.asarray(acc1, dtype=np.float64)
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 422, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_asarray); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 422, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 448, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_asarray); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 448, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 422, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 448, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_cur_scope->__pyx_v_acc0);
     __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_acc0);
-    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_cur_scope->__pyx_v_acc0);
-    __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 422, __pyx_L1_error)
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_cur_scope->__pyx_v_acc0);
+    __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 448, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 422, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float64); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 422, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 448, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 448, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_10) < 0) __PYX_ERR(0, 422, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_10) < 0) __PYX_ERR(0, 448, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 422, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_2, __pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 448, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_GOTREF(__pyx_cur_scope->__pyx_v_acc0);
     __Pyx_DECREF_SET(__pyx_cur_scope->__pyx_v_acc0, __pyx_t_10);
     __Pyx_GIVEREF(__pyx_t_10);
     __pyx_t_10 = 0;
 
-    /* "statmoments/_native.pyx":423
+    /* "statmoments/_native.pyx":449
  *       # Convert to double if accumulator is float
  *       acc0 = np.asarray(acc0, dtype=np.float64)
  *       acc1 = np.asarray(acc1, dtype=np.float64)             # <<<<<<<<<<<<<<
  * 
  *       # Reshape accumulator to a co-moment tensor
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 423, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 449, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_asarray); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 423, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_asarray); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 449, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 423, __pyx_L1_error)
+    __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 449, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_INCREF(__pyx_cur_scope->__pyx_v_acc1);
     __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_acc1);
     PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_cur_scope->__pyx_v_acc1);
-    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 423, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 423, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 423, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 449, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 449, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 449, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 423, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_10, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 423, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
+    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 449, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_10, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 449, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_GOTREF(__pyx_cur_scope->__pyx_v_acc1);
-    __Pyx_DECREF_SET(__pyx_cur_scope->__pyx_v_acc1, __pyx_t_2);
-    __Pyx_GIVEREF(__pyx_t_2);
-    __pyx_t_2 = 0;
+    __Pyx_DECREF_SET(__pyx_cur_scope->__pyx_v_acc1, __pyx_t_1);
+    __Pyx_GIVEREF(__pyx_t_1);
+    __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":426
+    /* "statmoments/_native.pyx":452
  * 
  *       # Reshape accumulator to a co-moment tensor
- *       raw0 = acc0[1:acc0.shape[0]-1, 1:].reshape(ma, tr_len, ma, tr_len)             # <<<<<<<<<<<<<<
- *       raw1 = acc1[1:acc1.shape[0]-0, 1:].reshape(ma, tr_len, ma, tr_len)
+ *       raw0 = acc0[1:acc0.shape[0] - 1, 1:].reshape(ma, tr_len, ma, tr_len)             # <<<<<<<<<<<<<<
+ *       raw1 = acc1[1:acc1.shape[0] - 0, 1:].reshape(ma, tr_len, ma, tr_len)
  * 
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_acc0, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 426, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_10 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 426, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_acc0, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 452, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_10 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 452, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_t_10, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 426, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_t_10, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 452, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = PySlice_New(__pyx_int_1, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 426, __pyx_L1_error)
+    __pyx_t_10 = PySlice_New(__pyx_int_1, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 452, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 426, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 452, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_10);
-    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_10);
-    __Pyx_INCREF(__pyx_slice__17);
-    __Pyx_GIVEREF(__pyx_slice__17);
-    PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_slice__17);
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_10);
+    __Pyx_INCREF(__pyx_slice__19);
+    __Pyx_GIVEREF(__pyx_slice__19);
+    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_slice__19);
     __pyx_t_10 = 0;
-    __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_acc0, __pyx_t_1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 426, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_acc0, __pyx_t_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 452, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_reshape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 426, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_reshape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 452, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __pyx_t_10 = NULL;
     __pyx_t_11 = 0;
-    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
-      __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_1);
+    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
+      __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_10)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_10);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_1, function);
+        __Pyx_DECREF_SET(__pyx_t_2, function);
         __pyx_t_11 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
-    if (PyFunction_Check(__pyx_t_1)) {
+    if (PyFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[5] = {__pyx_t_10, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len};
-      __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_11, 4+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 426, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_11, 4+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 452, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_GOTREF(__pyx_t_1);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
-    if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
+    if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[5] = {__pyx_t_10, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len};
-      __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_11, 4+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 426, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_11, 4+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 452, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_GOTREF(__pyx_t_1);
     } else
     #endif
     {
-      __pyx_t_7 = PyTuple_New(4+__pyx_t_11); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 426, __pyx_L1_error)
+      __pyx_t_7 = PyTuple_New(4+__pyx_t_11); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 452, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (__pyx_t_10) {
         __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_10); __pyx_t_10 = NULL;
       }
       __Pyx_INCREF(__pyx_cur_scope->__pyx_v_ma);
       __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_ma);
       PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_11, __pyx_cur_scope->__pyx_v_ma);
@@ -13847,86 +14270,86 @@
       PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_11, __pyx_cur_scope->__pyx_v_tr_len);
       __Pyx_INCREF(__pyx_cur_scope->__pyx_v_ma);
       __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_ma);
       PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_11, __pyx_cur_scope->__pyx_v_ma);
       __Pyx_INCREF(__pyx_cur_scope->__pyx_v_tr_len);
       __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_tr_len);
       PyTuple_SET_ITEM(__pyx_t_7, 3+__pyx_t_11, __pyx_cur_scope->__pyx_v_tr_len);
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 426, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 452, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     }
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_raw0);
-    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_raw0, __pyx_t_2);
-    __Pyx_GIVEREF(__pyx_t_2);
-    __pyx_t_2 = 0;
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_raw0, __pyx_t_1);
+    __Pyx_GIVEREF(__pyx_t_1);
+    __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":427
+    /* "statmoments/_native.pyx":453
  *       # Reshape accumulator to a co-moment tensor
- *       raw0 = acc0[1:acc0.shape[0]-1, 1:].reshape(ma, tr_len, ma, tr_len)
- *       raw1 = acc1[1:acc1.shape[0]-0, 1:].reshape(ma, tr_len, ma, tr_len)             # <<<<<<<<<<<<<<
+ *       raw0 = acc0[1:acc0.shape[0] - 1, 1:].reshape(ma, tr_len, ma, tr_len)
+ *       raw1 = acc1[1:acc1.shape[0] - 0, 1:].reshape(ma, tr_len, ma, tr_len)             # <<<<<<<<<<<<<<
  * 
- *       # Get mean
+ *       for _i in range(2):
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_acc1, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 427, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 427, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_acc1, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 453, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 453, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_t_7, __pyx_int_0, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 427, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_t_7, __pyx_int_0, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 453, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PySlice_New(__pyx_int_1, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 427, __pyx_L1_error)
+    __pyx_t_7 = PySlice_New(__pyx_int_1, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 453, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 427, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 453, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_7);
-    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_7);
-    __Pyx_INCREF(__pyx_slice__17);
-    __Pyx_GIVEREF(__pyx_slice__17);
-    PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_slice__17);
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_7);
+    __Pyx_INCREF(__pyx_slice__19);
+    __Pyx_GIVEREF(__pyx_slice__19);
+    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_slice__19);
     __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_acc1, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 427, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_acc1, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 453, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_reshape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 427, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_reshape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 453, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_t_7 = NULL;
     __pyx_t_11 = 0;
-    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
-      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_1);
+    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
+      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_7)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_1, function);
+        __Pyx_DECREF_SET(__pyx_t_2, function);
         __pyx_t_11 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
-    if (PyFunction_Check(__pyx_t_1)) {
+    if (PyFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[5] = {__pyx_t_7, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len};
-      __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_11, 4+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 427, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_11, 4+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 453, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_GOTREF(__pyx_t_1);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
-    if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
+    if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[5] = {__pyx_t_7, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len};
-      __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_11, 4+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 427, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_11, 4+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 453, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_GOTREF(__pyx_t_1);
     } else
     #endif
     {
-      __pyx_t_10 = PyTuple_New(4+__pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 427, __pyx_L1_error)
+      __pyx_t_10 = PyTuple_New(4+__pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 453, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       if (__pyx_t_7) {
         __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_7); __pyx_t_7 = NULL;
       }
       __Pyx_INCREF(__pyx_cur_scope->__pyx_v_ma);
       __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_ma);
       PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_11, __pyx_cur_scope->__pyx_v_ma);
@@ -13935,685 +14358,632 @@
       PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_11, __pyx_cur_scope->__pyx_v_tr_len);
       __Pyx_INCREF(__pyx_cur_scope->__pyx_v_ma);
       __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_ma);
       PyTuple_SET_ITEM(__pyx_t_10, 2+__pyx_t_11, __pyx_cur_scope->__pyx_v_ma);
       __Pyx_INCREF(__pyx_cur_scope->__pyx_v_tr_len);
       __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_tr_len);
       PyTuple_SET_ITEM(__pyx_t_10, 3+__pyx_t_11, __pyx_cur_scope->__pyx_v_tr_len);
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_10, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 427, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_10, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 453, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     }
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_raw1);
-    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_raw1, __pyx_t_2);
-    __Pyx_GIVEREF(__pyx_t_2);
-    __pyx_t_2 = 0;
-
-    /* "statmoments/_native.pyx":430
- * 
- *       # Get mean
- *       cm[0, 0] = acc0[0, 1: 1 + tr_len]             # <<<<<<<<<<<<<<
- *       cm[1, 0] = acc1[0, 1: 1 + tr_len]
- * 
- */
-    __pyx_t_2 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_cur_scope->__pyx_v_tr_len, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 430, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = PySlice_New(__pyx_int_1, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 430, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 430, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_INCREF(__pyx_int_0);
-    __Pyx_GIVEREF(__pyx_int_0);
-    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_0);
+    __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_raw1);
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_raw1, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_1);
-    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1);
     __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_acc0, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 430, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_tuple__21, __pyx_t_1) < 0)) __PYX_ERR(0, 430, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":431
- *       # Get mean
- *       cm[0, 0] = acc0[0, 1: 1 + tr_len]
- *       cm[1, 0] = acc1[0, 1: 1 + tr_len]             # <<<<<<<<<<<<<<
+    /* "statmoments/_native.pyx":455
+ *       raw1 = acc1[1:acc1.shape[0] - 0, 1:].reshape(ma, tr_len, ma, tr_len)
  * 
- *       # and higher raw moments
+ *       for _i in range(2):             # <<<<<<<<<<<<<<
+ *         nn = n0 if _i == 0 else n1
+ *         raw = raw0 if _i == 0 else raw1
  */
-    __pyx_t_1 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_cur_scope->__pyx_v_tr_len, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 431, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = PySlice_New(__pyx_int_1, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 431, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 431, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_INCREF(__pyx_int_0);
-    __Pyx_GIVEREF(__pyx_int_0);
-    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_int_0);
-    __Pyx_GIVEREF(__pyx_t_2);
-    PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_2);
-    __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_acc1, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 431, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_tuple__24, __pyx_t_2) < 0)) __PYX_ERR(0, 431, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    for (__pyx_t_12 = 0; __pyx_t_12 < 2; __pyx_t_12+=1) {
+      __pyx_cur_scope->__pyx_v__i = __pyx_t_12;
 
-    /* "statmoments/_native.pyx":434
+      /* "statmoments/_native.pyx":456
  * 
- *       # and higher raw moments
- *       for i in range(maxm-1):             # <<<<<<<<<<<<<<
- *         cm[0, i+1] = raw0[i//2,:,i//2+i%2,:].diagonal()
- *         cm[1, i+1] = raw1[i//2,:,i//2+i%2,:].diagonal()
- */
-    __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_cur_scope->__pyx_v_maxm, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 434, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 434, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
-      __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_12 = 0;
-      __pyx_t_13 = NULL;
-    } else {
-      __pyx_t_12 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 434, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_13 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 434, __pyx_L1_error)
-    }
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    for (;;) {
-      if (likely(!__pyx_t_13)) {
-        if (likely(PyList_CheckExact(__pyx_t_2))) {
-          if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_2)) break;
-          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_12); __Pyx_INCREF(__pyx_t_1); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 434, __pyx_L1_error)
-          #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 434, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_1);
-          #endif
-        } else {
-          if (__pyx_t_12 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
-          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_12); __Pyx_INCREF(__pyx_t_1); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 434, __pyx_L1_error)
-          #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 434, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_1);
-          #endif
-        }
+ *       for _i in range(2):
+ *         nn = n0 if _i == 0 else n1             # <<<<<<<<<<<<<<
+ *         raw = raw0 if _i == 0 else raw1
+ *         acc = acc0 if _i == 0 else acc1
+ */
+      if (((__pyx_cur_scope->__pyx_v__i == 0) != 0)) {
+        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_n0);
+        __pyx_t_1 = __pyx_cur_scope->__pyx_v_n0;
       } else {
-        __pyx_t_1 = __pyx_t_13(__pyx_t_2);
-        if (unlikely(!__pyx_t_1)) {
-          PyObject* exc_type = PyErr_Occurred();
-          if (exc_type) {
-            if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 434, __pyx_L1_error)
-          }
-          break;
-        }
-        __Pyx_GOTREF(__pyx_t_1);
+        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_n1);
+        __pyx_t_1 = __pyx_cur_scope->__pyx_v_n1;
+      }
+      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_nn);
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_nn, __pyx_t_1);
+      __Pyx_GIVEREF(__pyx_t_1);
+      __pyx_t_1 = 0;
+
+      /* "statmoments/_native.pyx":457
+ *       for _i in range(2):
+ *         nn = n0 if _i == 0 else n1
+ *         raw = raw0 if _i == 0 else raw1             # <<<<<<<<<<<<<<
+ *         acc = acc0 if _i == 0 else acc1
+ *         if nn < min_cnt:
+ */
+      if (((__pyx_cur_scope->__pyx_v__i == 0) != 0)) {
+        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_raw0);
+        __pyx_t_1 = __pyx_cur_scope->__pyx_v_raw0;
+      } else {
+        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_raw1);
+        __pyx_t_1 = __pyx_cur_scope->__pyx_v_raw1;
+      }
+      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_raw);
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_raw, __pyx_t_1);
+      __Pyx_GIVEREF(__pyx_t_1);
+      __pyx_t_1 = 0;
+
+      /* "statmoments/_native.pyx":458
+ *         nn = n0 if _i == 0 else n1
+ *         raw = raw0 if _i == 0 else raw1
+ *         acc = acc0 if _i == 0 else acc1             # <<<<<<<<<<<<<<
+ *         if nn < min_cnt:
+ *           cm[_i, moments] = 0
+ */
+      if (((__pyx_cur_scope->__pyx_v__i == 0) != 0)) {
+        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_acc0);
+        __pyx_t_1 = __pyx_cur_scope->__pyx_v_acc0;
+      } else {
+        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_acc1);
+        __pyx_t_1 = __pyx_cur_scope->__pyx_v_acc1;
       }
-      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_i);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_i, __pyx_t_1);
+      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_acc);
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_acc, __pyx_t_1);
       __Pyx_GIVEREF(__pyx_t_1);
       __pyx_t_1 = 0;
 
-      /* "statmoments/_native.pyx":435
- *       # and higher raw moments
- *       for i in range(maxm-1):
- *         cm[0, i+1] = raw0[i//2,:,i//2+i%2,:].diagonal()             # <<<<<<<<<<<<<<
- *         cm[1, i+1] = raw1[i//2,:,i//2+i%2,:].diagonal()
+      /* "statmoments/_native.pyx":459
+ *         raw = raw0 if _i == 0 else raw1
+ *         acc = acc0 if _i == 0 else acc1
+ *         if nn < min_cnt:             # <<<<<<<<<<<<<<
+ *           cm[_i, moments] = 0
+ *           continue
+ */
+      __pyx_t_1 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_nn, __pyx_cur_scope->__pyx_v_min_cnt, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 459, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 459, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      if (__pyx_t_4) {
+
+        /* "statmoments/_native.pyx":460
+ *         acc = acc0 if _i == 0 else acc1
+ *         if nn < min_cnt:
+ *           cm[_i, moments] = 0             # <<<<<<<<<<<<<<
+ *           continue
  * 
  */
-      __pyx_t_10 = __Pyx_PyInt_FloorDivideObjC(__pyx_cur_scope->__pyx_v_i, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 435, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_7 = __Pyx_PyInt_FloorDivideObjC(__pyx_cur_scope->__pyx_v_i, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 435, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_3 = __Pyx_PyInt_RemainderObjC(__pyx_cur_scope->__pyx_v_i, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 435, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_14 = PyNumber_Add(__pyx_t_7, __pyx_t_3); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 435, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_14);
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 435, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_GIVEREF(__pyx_t_10);
-      PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_10);
-      __Pyx_INCREF(__pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_slice__5);
-      PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_t_14);
-      PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_14);
-      __Pyx_INCREF(__pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_slice__5);
-      PyTuple_SET_ITEM(__pyx_t_3, 3, __pyx_slice__5);
-      __pyx_t_10 = 0;
-      __pyx_t_14 = 0;
-      __pyx_t_14 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_raw0, __pyx_t_3); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 435, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_14);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_diagonal); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 435, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-      __pyx_t_14 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
-        __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_3);
-        if (likely(__pyx_t_14)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-          __Pyx_INCREF(__pyx_t_14);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_3, function);
-        }
+        __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 460, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 460, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_GIVEREF(__pyx_t_1);
+        PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
+        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_moments);
+        __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_moments);
+        PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_cur_scope->__pyx_v_moments);
+        __pyx_t_1 = 0;
+        if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_2, __pyx_int_0) < 0)) __PYX_ERR(0, 460, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+
+        /* "statmoments/_native.pyx":461
+ *         if nn < min_cnt:
+ *           cm[_i, moments] = 0
+ *           continue             # <<<<<<<<<<<<<<
+ * 
+ *         # Get mean
+ */
+        goto __pyx_L11_continue;
+
+        /* "statmoments/_native.pyx":459
+ *         raw = raw0 if _i == 0 else raw1
+ *         acc = acc0 if _i == 0 else acc1
+ *         if nn < min_cnt:             # <<<<<<<<<<<<<<
+ *           cm[_i, moments] = 0
+ *           continue
+ */
       }
-      __pyx_t_1 = (__pyx_t_14) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_14) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
-      __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 435, __pyx_L1_error)
+
+      /* "statmoments/_native.pyx":464
+ * 
+ *         # Get mean
+ *         cm[_i, 0] = acc[0, 1: 1 + tr_len]             # <<<<<<<<<<<<<<
+ * 
+ *         # and higher raw moments
+ */
+      __pyx_t_2 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_cur_scope->__pyx_v_tr_len, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 464, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_1 = PySlice_New(__pyx_int_1, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 464, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_cur_scope->__pyx_v_i, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 435, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_14 = PyTuple_New(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 435, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_14);
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 464, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
-      PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_int_0);
-      __Pyx_GIVEREF(__pyx_t_3);
-      PyTuple_SET_ITEM(__pyx_t_14, 1, __pyx_t_3);
-      __pyx_t_3 = 0;
-      if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_14, __pyx_t_1) < 0)) __PYX_ERR(0, 435, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
+      PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_0);
+      __Pyx_GIVEREF(__pyx_t_1);
+      PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1);
+      __pyx_t_1 = 0;
+      __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_acc, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 464, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 464, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 464, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_10);
+      __Pyx_GIVEREF(__pyx_t_2);
+      PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_2);
+      __Pyx_INCREF(__pyx_int_0);
+      __Pyx_GIVEREF(__pyx_int_0);
+      PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_int_0);
+      __pyx_t_2 = 0;
+      if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_10, __pyx_t_1) < 0)) __PYX_ERR(0, 464, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "statmoments/_native.pyx":436
- *       for i in range(maxm-1):
- *         cm[0, i+1] = raw0[i//2,:,i//2+i%2,:].diagonal()
- *         cm[1, i+1] = raw1[i//2,:,i//2+i%2,:].diagonal()             # <<<<<<<<<<<<<<
+      /* "statmoments/_native.pyx":467
+ * 
+ *         # and higher raw moments
+ *         for i in range(maxm - 1):             # <<<<<<<<<<<<<<
+ *           cm[_i, i + 1] = raw[i // 2, :, i // 2 + i % 2, :].diagonal()
  * 
- *       cm[0] *= 1.0/n0
  */
-      __pyx_t_14 = __Pyx_PyInt_FloorDivideObjC(__pyx_cur_scope->__pyx_v_i, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 436, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_14);
-      __pyx_t_3 = __Pyx_PyInt_FloorDivideObjC(__pyx_cur_scope->__pyx_v_i, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 436, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_10 = __Pyx_PyInt_RemainderObjC(__pyx_cur_scope->__pyx_v_i, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 436, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_7 = PyNumber_Add(__pyx_t_3, __pyx_t_10); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 436, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = PyTuple_New(4); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 436, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __Pyx_GIVEREF(__pyx_t_14);
-      PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_14);
-      __Pyx_INCREF(__pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_slice__5);
-      PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_t_7);
-      PyTuple_SET_ITEM(__pyx_t_10, 2, __pyx_t_7);
-      __Pyx_INCREF(__pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_slice__5);
-      PyTuple_SET_ITEM(__pyx_t_10, 3, __pyx_slice__5);
-      __pyx_t_14 = 0;
-      __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_raw1, __pyx_t_10); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 436, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_diagonal); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 436, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
-        __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_10);
-        if (likely(__pyx_t_7)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
-          __Pyx_INCREF(__pyx_t_7);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_10, function);
-        }
-      }
-      __pyx_t_1 = (__pyx_t_7) ? __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_7) : __Pyx_PyObject_CallNoArg(__pyx_t_10);
-      __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 436, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_cur_scope->__pyx_v_maxm, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 467, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyInt_AddObjC(__pyx_cur_scope->__pyx_v_i, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 436, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 467, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 436, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
-      __Pyx_INCREF(__pyx_int_1);
-      __Pyx_GIVEREF(__pyx_int_1);
-      PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_int_1);
-      __Pyx_GIVEREF(__pyx_t_10);
-      PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_10);
-      __pyx_t_10 = 0;
-      if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_7, __pyx_t_1) < 0)) __PYX_ERR(0, 436, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      if (likely(PyList_CheckExact(__pyx_t_10)) || PyTuple_CheckExact(__pyx_t_10)) {
+        __pyx_t_1 = __pyx_t_10; __Pyx_INCREF(__pyx_t_1); __pyx_t_13 = 0;
+        __pyx_t_14 = NULL;
+      } else {
+        __pyx_t_13 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 467, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __pyx_t_14 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 467, __pyx_L1_error)
+      }
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+      for (;;) {
+        if (likely(!__pyx_t_14)) {
+          if (likely(PyList_CheckExact(__pyx_t_1))) {
+            if (__pyx_t_13 >= PyList_GET_SIZE(__pyx_t_1)) break;
+            #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+            __pyx_t_10 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_13); __Pyx_INCREF(__pyx_t_10); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 467, __pyx_L1_error)
+            #else
+            __pyx_t_10 = PySequence_ITEM(__pyx_t_1, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 467, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_10);
+            #endif
+          } else {
+            if (__pyx_t_13 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
+            #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+            __pyx_t_10 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_13); __Pyx_INCREF(__pyx_t_10); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 467, __pyx_L1_error)
+            #else
+            __pyx_t_10 = PySequence_ITEM(__pyx_t_1, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 467, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_10);
+            #endif
+          }
+        } else {
+          __pyx_t_10 = __pyx_t_14(__pyx_t_1);
+          if (unlikely(!__pyx_t_10)) {
+            PyObject* exc_type = PyErr_Occurred();
+            if (exc_type) {
+              if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
+              else __PYX_ERR(0, 467, __pyx_L1_error)
+            }
+            break;
+          }
+          __Pyx_GOTREF(__pyx_t_10);
+        }
+        __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_i);
+        __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_i, __pyx_t_10);
+        __Pyx_GIVEREF(__pyx_t_10);
+        __pyx_t_10 = 0;
 
-      /* "statmoments/_native.pyx":434
- * 
- *       # and higher raw moments
- *       for i in range(maxm-1):             # <<<<<<<<<<<<<<
- *         cm[0, i+1] = raw0[i//2,:,i//2+i%2,:].diagonal()
- *         cm[1, i+1] = raw1[i//2,:,i//2+i%2,:].diagonal()
- */
-    }
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-
-    /* "statmoments/_native.pyx":438
- *         cm[1, i+1] = raw1[i//2,:,i//2+i%2,:].diagonal()
- * 
- *       cm[0] *= 1.0/n0             # <<<<<<<<<<<<<<
- *       cm[1] *= 1.0/n1
+        /* "statmoments/_native.pyx":468
+ *         # and higher raw moments
+ *         for i in range(maxm - 1):
+ *           cm[_i, i + 1] = raw[i // 2, :, i // 2 + i % 2, :].diagonal()             # <<<<<<<<<<<<<<
  * 
+ *         cm[_i] *= 1.0 / nn
  */
-    __pyx_t_12 = 0;
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_cm, __pyx_t_12, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 438, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_cur_scope->__pyx_v_n0, 1.0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 438, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = PyNumber_InPlaceMultiply(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 438, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(__Pyx_SetItemInt(__pyx_cur_scope->__pyx_v_cm, __pyx_t_12, __pyx_t_7, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0) < 0)) __PYX_ERR(0, 438, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+        __pyx_t_2 = __Pyx_PyInt_FloorDivideObjC(__pyx_cur_scope->__pyx_v_i, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 468, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_7 = __Pyx_PyInt_FloorDivideObjC(__pyx_cur_scope->__pyx_v_i, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 468, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_7);
+        __pyx_t_3 = __Pyx_PyInt_RemainderObjC(__pyx_cur_scope->__pyx_v_i, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 468, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __pyx_t_15 = PyNumber_Add(__pyx_t_7, __pyx_t_3); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 468, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_15);
+        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 468, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_GIVEREF(__pyx_t_2);
+        PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_t_15);
+        PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_15);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_3, 3, __pyx_slice__7);
+        __pyx_t_2 = 0;
+        __pyx_t_15 = 0;
+        __pyx_t_15 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_raw, __pyx_t_3); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 468, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_15);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_15, __pyx_n_s_diagonal); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 468, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
+        __pyx_t_15 = NULL;
+        if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
+          __pyx_t_15 = PyMethod_GET_SELF(__pyx_t_3);
+          if (likely(__pyx_t_15)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+            __Pyx_INCREF(__pyx_t_15);
+            __Pyx_INCREF(function);
+            __Pyx_DECREF_SET(__pyx_t_3, function);
+          }
+        }
+        __pyx_t_10 = (__pyx_t_15) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_15) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
+        __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
+        if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 468, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_10);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 468, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __pyx_t_15 = __Pyx_PyInt_AddObjC(__pyx_cur_scope->__pyx_v_i, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 468, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_15);
+        __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 468, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_GIVEREF(__pyx_t_3);
+        PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
+        __Pyx_GIVEREF(__pyx_t_15);
+        PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_15);
+        __pyx_t_3 = 0;
+        __pyx_t_15 = 0;
+        if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_2, __pyx_t_10) < 0)) __PYX_ERR(0, 468, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-    /* "statmoments/_native.pyx":439
+        /* "statmoments/_native.pyx":467
  * 
- *       cm[0] *= 1.0/n0
- *       cm[1] *= 1.0/n1             # <<<<<<<<<<<<<<
+ *         # and higher raw moments
+ *         for i in range(maxm - 1):             # <<<<<<<<<<<<<<
+ *           cm[_i, i + 1] = raw[i // 2, :, i // 2 + i % 2, :].diagonal()
  * 
- *       _rmoms2cmoms(cm[0], maxm, buf)
  */
-    __pyx_t_12 = 1;
-    __pyx_t_7 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_cm, __pyx_t_12, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 439, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_1 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_cur_scope->__pyx_v_n1, 1.0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 439, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = PyNumber_InPlaceMultiply(__pyx_t_7, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 439, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(__Pyx_SetItemInt(__pyx_cur_scope->__pyx_v_cm, __pyx_t_12, __pyx_t_2, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0) < 0)) __PYX_ERR(0, 439, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      }
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":441
- *       cm[1] *= 1.0/n1
+      /* "statmoments/_native.pyx":470
+ *           cm[_i, i + 1] = raw[i // 2, :, i // 2 + i % 2, :].diagonal()
  * 
- *       _rmoms2cmoms(cm[0], maxm, buf)             # <<<<<<<<<<<<<<
- *       _rmoms2cmoms(cm[1], maxm, buf)
+ *         cm[_i] *= 1.0 / nn             # <<<<<<<<<<<<<<
  * 
+ *         _rmoms2cmoms(cm[_i], maxm, buf)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_rmoms2cmoms); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 441, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_cm, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 441, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_10 = NULL;
-    __pyx_t_11 = 0;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
-      __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_1);
-      if (likely(__pyx_t_10)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
-        __Pyx_INCREF(__pyx_t_10);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_1, function);
-        __pyx_t_11 = 1;
-      }
-    }
-    #if CYTHON_FAST_PYCALL
-    if (PyFunction_Check(__pyx_t_1)) {
-      PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_t_7, __pyx_cur_scope->__pyx_v_maxm, __pyx_cur_scope->__pyx_v_buf};
-      __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 441, __pyx_L1_error)
-      __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    } else
-    #endif
-    #if CYTHON_FAST_PYCCALL
-    if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
-      PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_t_7, __pyx_cur_scope->__pyx_v_maxm, __pyx_cur_scope->__pyx_v_buf};
-      __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 441, __pyx_L1_error)
-      __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    } else
-    #endif
-    {
-      __pyx_t_14 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 441, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_14);
-      if (__pyx_t_10) {
-        __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_t_10); __pyx_t_10 = NULL;
-      }
-      __Pyx_GIVEREF(__pyx_t_7);
-      PyTuple_SET_ITEM(__pyx_t_14, 0+__pyx_t_11, __pyx_t_7);
-      __Pyx_INCREF(__pyx_cur_scope->__pyx_v_maxm);
-      __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_maxm);
-      PyTuple_SET_ITEM(__pyx_t_14, 1+__pyx_t_11, __pyx_cur_scope->__pyx_v_maxm);
-      __Pyx_INCREF(__pyx_cur_scope->__pyx_v_buf);
-      __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_buf);
-      PyTuple_SET_ITEM(__pyx_t_14, 2+__pyx_t_11, __pyx_cur_scope->__pyx_v_buf);
-      __pyx_t_7 = 0;
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_14, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 441, __pyx_L1_error)
+      __pyx_t_16 = __pyx_cur_scope->__pyx_v__i;
+      __pyx_t_1 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_cm, __pyx_t_16, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 470, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_10 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_cur_scope->__pyx_v_nn, 1.0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 470, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_10);
+      __pyx_t_2 = PyNumber_InPlaceMultiply(__pyx_t_1, __pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 470, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    }
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+      if (unlikely(__Pyx_SetItemInt(__pyx_cur_scope->__pyx_v_cm, __pyx_t_16, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) < 0)) __PYX_ERR(0, 470, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "statmoments/_native.pyx":442
+      /* "statmoments/_native.pyx":472
+ *         cm[_i] *= 1.0 / nn
  * 
- *       _rmoms2cmoms(cm[0], maxm, buf)
- *       _rmoms2cmoms(cm[1], maxm, buf)             # <<<<<<<<<<<<<<
+ *         _rmoms2cmoms(cm[_i], maxm, buf)             # <<<<<<<<<<<<<<
  * 
- *       if maxm >= 3 and normalize:
+ *         if maxm >= 3 and normalize:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_rmoms2cmoms); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 442, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_14 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_cm, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 442, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_14);
-    __pyx_t_7 = NULL;
-    __pyx_t_11 = 0;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
-      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_1);
-      if (likely(__pyx_t_7)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
-        __Pyx_INCREF(__pyx_t_7);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_1, function);
-        __pyx_t_11 = 1;
-      }
-    }
-    #if CYTHON_FAST_PYCALL
-    if (PyFunction_Check(__pyx_t_1)) {
-      PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_t_14, __pyx_cur_scope->__pyx_v_maxm, __pyx_cur_scope->__pyx_v_buf};
-      __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 442, __pyx_L1_error)
-      __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    } else
-    #endif
-    #if CYTHON_FAST_PYCCALL
-    if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
-      PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_t_14, __pyx_cur_scope->__pyx_v_maxm, __pyx_cur_scope->__pyx_v_buf};
-      __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 442, __pyx_L1_error)
-      __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    } else
-    #endif
-    {
-      __pyx_t_10 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 442, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_rmoms2cmoms); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 472, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      if (__pyx_t_7) {
-        __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_7); __pyx_t_7 = NULL;
+      __pyx_t_1 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_cm, __pyx_cur_scope->__pyx_v__i, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 472, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_15 = NULL;
+      __pyx_t_11 = 0;
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
+        __pyx_t_15 = PyMethod_GET_SELF(__pyx_t_10);
+        if (likely(__pyx_t_15)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
+          __Pyx_INCREF(__pyx_t_15);
+          __Pyx_INCREF(function);
+          __Pyx_DECREF_SET(__pyx_t_10, function);
+          __pyx_t_11 = 1;
+        }
+      }
+      #if CYTHON_FAST_PYCALL
+      if (PyFunction_Check(__pyx_t_10)) {
+        PyObject *__pyx_temp[4] = {__pyx_t_15, __pyx_t_1, __pyx_cur_scope->__pyx_v_maxm, __pyx_cur_scope->__pyx_v_buf};
+        __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 472, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      } else
+      #endif
+      #if CYTHON_FAST_PYCCALL
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_10)) {
+        PyObject *__pyx_temp[4] = {__pyx_t_15, __pyx_t_1, __pyx_cur_scope->__pyx_v_maxm, __pyx_cur_scope->__pyx_v_buf};
+        __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 472, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      } else
+      #endif
+      {
+        __pyx_t_3 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 472, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        if (__pyx_t_15) {
+          __Pyx_GIVEREF(__pyx_t_15); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_15); __pyx_t_15 = NULL;
+        }
+        __Pyx_GIVEREF(__pyx_t_1);
+        PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_11, __pyx_t_1);
+        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_maxm);
+        __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_maxm);
+        PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_11, __pyx_cur_scope->__pyx_v_maxm);
+        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_buf);
+        __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_buf);
+        PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_11, __pyx_cur_scope->__pyx_v_buf);
+        __pyx_t_1 = 0;
+        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 472, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       }
-      __Pyx_GIVEREF(__pyx_t_14);
-      PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_11, __pyx_t_14);
-      __Pyx_INCREF(__pyx_cur_scope->__pyx_v_maxm);
-      __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_maxm);
-      PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_11, __pyx_cur_scope->__pyx_v_maxm);
-      __Pyx_INCREF(__pyx_cur_scope->__pyx_v_buf);
-      __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_buf);
-      PyTuple_SET_ITEM(__pyx_t_10, 2+__pyx_t_11, __pyx_cur_scope->__pyx_v_buf);
-      __pyx_t_14 = 0;
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_10, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 442, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    }
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-
-    /* "statmoments/_native.pyx":444
- *       _rmoms2cmoms(cm[1], maxm, buf)
- * 
- *       if maxm >= 3 and normalize:             # <<<<<<<<<<<<<<
- *         for _i in range(2):
- *           sd = np.sqrt(cm[_i, 1])
- */
-    __pyx_t_2 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_maxm, __pyx_int_3, Py_GE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 444, __pyx_L1_error)
-    __pyx_t_15 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_15 < 0)) __PYX_ERR(0, 444, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (__pyx_t_15) {
-    } else {
-      __pyx_t_4 = __pyx_t_15;
-      goto __pyx_L14_bool_binop_done;
-    }
-    __pyx_t_15 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_normalize); if (unlikely(__pyx_t_15 < 0)) __PYX_ERR(0, 444, __pyx_L1_error)
-    __pyx_t_4 = __pyx_t_15;
-    __pyx_L14_bool_binop_done:;
-    if (__pyx_t_4) {
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-      /* "statmoments/_native.pyx":445
+      /* "statmoments/_native.pyx":474
+ *         _rmoms2cmoms(cm[_i], maxm, buf)
  * 
- *       if maxm >= 3 and normalize:
- *         for _i in range(2):             # <<<<<<<<<<<<<<
+ *         if maxm >= 3 and normalize:             # <<<<<<<<<<<<<<
  *           sd = np.sqrt(cm[_i, 1])
  *           for i, cmi in enumerate(cm[_i, 2:maxm], 3):
  */
-      for (__pyx_t_16 = 0; __pyx_t_16 < 2; __pyx_t_16+=1) {
-        __pyx_cur_scope->__pyx_v__i = __pyx_t_16;
+      __pyx_t_2 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_maxm, __pyx_int_3, Py_GE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 474, __pyx_L1_error)
+      __pyx_t_17 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_17 < 0)) __PYX_ERR(0, 474, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      if (__pyx_t_17) {
+      } else {
+        __pyx_t_4 = __pyx_t_17;
+        goto __pyx_L17_bool_binop_done;
+      }
+      __pyx_t_17 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_normalize); if (unlikely(__pyx_t_17 < 0)) __PYX_ERR(0, 474, __pyx_L1_error)
+      __pyx_t_4 = __pyx_t_17;
+      __pyx_L17_bool_binop_done:;
+      if (__pyx_t_4) {
 
-        /* "statmoments/_native.pyx":446
- *       if maxm >= 3 and normalize:
- *         for _i in range(2):
+        /* "statmoments/_native.pyx":475
+ * 
+ *         if maxm >= 3 and normalize:
  *           sd = np.sqrt(cm[_i, 1])             # <<<<<<<<<<<<<<
  *           for i, cmi in enumerate(cm[_i, 2:maxm], 3):
  *             cmi[:] /= sd ** i
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 446, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 446, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 475, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 446, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 475, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+        __pyx_t_10 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 475, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_10);
+        __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 475, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_14 = PyTuple_New(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 446, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_14);
-        __Pyx_GIVEREF(__pyx_t_1);
-        PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_t_1);
+        __Pyx_GIVEREF(__pyx_t_10);
+        PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_10);
         __Pyx_INCREF(__pyx_int_1);
         __Pyx_GIVEREF(__pyx_int_1);
-        PyTuple_SET_ITEM(__pyx_t_14, 1, __pyx_int_1);
-        __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_14); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 446, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_1);
-        __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-        __pyx_t_14 = NULL;
-        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
-          __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_10);
-          if (likely(__pyx_t_14)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
-            __Pyx_INCREF(__pyx_t_14);
+        PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_1);
+        __pyx_t_10 = 0;
+        __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 475, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_10);
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        __pyx_t_1 = NULL;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+          __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
+          if (likely(__pyx_t_1)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+            __Pyx_INCREF(__pyx_t_1);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_10, function);
+            __Pyx_DECREF_SET(__pyx_t_3, function);
           }
         }
-        __pyx_t_2 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_14, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_1);
-        __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 446, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_2 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_t_10) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_10);
+        __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 475, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_sd);
         __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_sd, __pyx_t_2);
         __Pyx_GIVEREF(__pyx_t_2);
         __pyx_t_2 = 0;
 
-        /* "statmoments/_native.pyx":447
- *         for _i in range(2):
+        /* "statmoments/_native.pyx":476
+ *         if maxm >= 3 and normalize:
  *           sd = np.sqrt(cm[_i, 1])
  *           for i, cmi in enumerate(cm[_i, 2:maxm], 3):             # <<<<<<<<<<<<<<
  *             cmi[:] /= sd ** i
  * 
  */
         __Pyx_INCREF(__pyx_int_3);
         __pyx_t_2 = __pyx_int_3;
-        __pyx_t_10 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 447, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 476, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __pyx_t_10 = PySlice_New(__pyx_int_2, __pyx_cur_scope->__pyx_v_maxm, Py_None); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 476, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
-        __pyx_t_1 = PySlice_New(__pyx_int_2, __pyx_cur_scope->__pyx_v_maxm, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 447, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 476, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_14 = PyTuple_New(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 447, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_14);
+        __Pyx_GIVEREF(__pyx_t_3);
+        PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
         __Pyx_GIVEREF(__pyx_t_10);
-        PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_t_10);
-        __Pyx_GIVEREF(__pyx_t_1);
-        PyTuple_SET_ITEM(__pyx_t_14, 1, __pyx_t_1);
+        PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_10);
+        __pyx_t_3 = 0;
         __pyx_t_10 = 0;
-        __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_14); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 447, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_1);
-        __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-        if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
-          __pyx_t_14 = __pyx_t_1; __Pyx_INCREF(__pyx_t_14); __pyx_t_12 = 0;
-          __pyx_t_13 = NULL;
+        __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 476, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_10);
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        if (likely(PyList_CheckExact(__pyx_t_10)) || PyTuple_CheckExact(__pyx_t_10)) {
+          __pyx_t_1 = __pyx_t_10; __Pyx_INCREF(__pyx_t_1); __pyx_t_13 = 0;
+          __pyx_t_14 = NULL;
         } else {
-          __pyx_t_12 = -1; __pyx_t_14 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 447, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_14);
-          __pyx_t_13 = Py_TYPE(__pyx_t_14)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 447, __pyx_L1_error)
+          __pyx_t_13 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 476, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_1);
+          __pyx_t_14 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 476, __pyx_L1_error)
         }
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         for (;;) {
-          if (likely(!__pyx_t_13)) {
-            if (likely(PyList_CheckExact(__pyx_t_14))) {
-              if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_14)) break;
+          if (likely(!__pyx_t_14)) {
+            if (likely(PyList_CheckExact(__pyx_t_1))) {
+              if (__pyx_t_13 >= PyList_GET_SIZE(__pyx_t_1)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_1 = PyList_GET_ITEM(__pyx_t_14, __pyx_t_12); __Pyx_INCREF(__pyx_t_1); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 447, __pyx_L1_error)
+              __pyx_t_10 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_13); __Pyx_INCREF(__pyx_t_10); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 476, __pyx_L1_error)
               #else
-              __pyx_t_1 = PySequence_ITEM(__pyx_t_14, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 447, __pyx_L1_error)
-              __Pyx_GOTREF(__pyx_t_1);
+              __pyx_t_10 = PySequence_ITEM(__pyx_t_1, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 476, __pyx_L1_error)
+              __Pyx_GOTREF(__pyx_t_10);
               #endif
             } else {
-              if (__pyx_t_12 >= PyTuple_GET_SIZE(__pyx_t_14)) break;
+              if (__pyx_t_13 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_14, __pyx_t_12); __Pyx_INCREF(__pyx_t_1); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 447, __pyx_L1_error)
+              __pyx_t_10 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_13); __Pyx_INCREF(__pyx_t_10); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 476, __pyx_L1_error)
               #else
-              __pyx_t_1 = PySequence_ITEM(__pyx_t_14, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 447, __pyx_L1_error)
-              __Pyx_GOTREF(__pyx_t_1);
+              __pyx_t_10 = PySequence_ITEM(__pyx_t_1, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 476, __pyx_L1_error)
+              __Pyx_GOTREF(__pyx_t_10);
               #endif
             }
           } else {
-            __pyx_t_1 = __pyx_t_13(__pyx_t_14);
-            if (unlikely(!__pyx_t_1)) {
+            __pyx_t_10 = __pyx_t_14(__pyx_t_1);
+            if (unlikely(!__pyx_t_10)) {
               PyObject* exc_type = PyErr_Occurred();
               if (exc_type) {
                 if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                else __PYX_ERR(0, 447, __pyx_L1_error)
+                else __PYX_ERR(0, 476, __pyx_L1_error)
               }
               break;
             }
-            __Pyx_GOTREF(__pyx_t_1);
+            __Pyx_GOTREF(__pyx_t_10);
           }
           __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_cmi);
-          __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_cmi, __pyx_t_1);
-          __Pyx_GIVEREF(__pyx_t_1);
-          __pyx_t_1 = 0;
+          __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_cmi, __pyx_t_10);
+          __Pyx_GIVEREF(__pyx_t_10);
+          __pyx_t_10 = 0;
           __Pyx_INCREF(__pyx_t_2);
           __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_i);
           __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_i, __pyx_t_2);
           __Pyx_GIVEREF(__pyx_t_2);
-          __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 447, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_1);
+          __pyx_t_10 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 476, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_2);
-          __pyx_t_2 = __pyx_t_1;
-          __pyx_t_1 = 0;
+          __pyx_t_2 = __pyx_t_10;
+          __pyx_t_10 = 0;
 
-          /* "statmoments/_native.pyx":448
+          /* "statmoments/_native.pyx":477
  *           sd = np.sqrt(cm[_i, 1])
  *           for i, cmi in enumerate(cm[_i, 2:maxm], 3):
  *             cmi[:] /= sd ** i             # <<<<<<<<<<<<<<
  * 
  *       yield cm[:, moments]
  */
-          __Pyx_INCREF(__pyx_slice__5);
-          __pyx_t_17 = __pyx_slice__5;
-          __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cmi, __pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 448, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_10 = PyNumber_Power(__pyx_cur_scope->__pyx_v_sd, __pyx_cur_scope->__pyx_v_i, Py_None); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 448, __pyx_L1_error)
+          __Pyx_INCREF(__pyx_slice__7);
+          __pyx_t_18 = __pyx_slice__7;
+          __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cmi, __pyx_t_18); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 477, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
-          __pyx_t_7 = __Pyx_PyNumber_InPlaceDivide(__pyx_t_1, __pyx_t_10); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 448, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_7);
-          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+          __pyx_t_3 = PyNumber_Power(__pyx_cur_scope->__pyx_v_sd, __pyx_cur_scope->__pyx_v_i, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 477, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_3);
+          __pyx_t_15 = __Pyx_PyNumber_InPlaceDivide(__pyx_t_10, __pyx_t_3); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 477, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_15);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-          if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cmi, __pyx_t_17, __pyx_t_7) < 0)) __PYX_ERR(0, 448, __pyx_L1_error)
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cmi, __pyx_t_18, __pyx_t_15) < 0)) __PYX_ERR(0, 477, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
+          __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
-          /* "statmoments/_native.pyx":447
- *         for _i in range(2):
+          /* "statmoments/_native.pyx":476
+ *         if maxm >= 3 and normalize:
  *           sd = np.sqrt(cm[_i, 1])
  *           for i, cmi in enumerate(cm[_i, 2:maxm], 3):             # <<<<<<<<<<<<<<
  *             cmi[:] /= sd ** i
  * 
  */
         }
-        __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      }
 
-      /* "statmoments/_native.pyx":444
- *       _rmoms2cmoms(cm[1], maxm, buf)
+        /* "statmoments/_native.pyx":474
+ *         _rmoms2cmoms(cm[_i], maxm, buf)
  * 
- *       if maxm >= 3 and normalize:             # <<<<<<<<<<<<<<
- *         for _i in range(2):
+ *         if maxm >= 3 and normalize:             # <<<<<<<<<<<<<<
  *           sd = np.sqrt(cm[_i, 1])
+ *           for i, cmi in enumerate(cm[_i, 2:maxm], 3):
  */
+      }
+      __pyx_L11_continue:;
     }
 
-    /* "statmoments/_native.pyx":450
+    /* "statmoments/_native.pyx":479
  *             cmi[:] /= sd ** i
  * 
  *       yield cm[:, moments]             # <<<<<<<<<<<<<<
  * 
  *   def _comoments(self, moments, normalize):
  */
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 450, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 479, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_INCREF(__pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_slice__5);
-    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_slice__5);
+    __Pyx_INCREF(__pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_slice__7);
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_slice__7);
     __Pyx_INCREF(__pyx_cur_scope->__pyx_v_moments);
     __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_moments);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_cur_scope->__pyx_v_moments);
-    __pyx_t_14 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 450, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_14);
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 479, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_r = __pyx_t_14;
-    __pyx_t_14 = 0;
+    __pyx_r = __pyx_t_1;
+    __pyx_t_1 = 0;
     __pyx_cur_scope->__pyx_t_0 = __pyx_t_5;
     __pyx_cur_scope->__pyx_t_1 = __pyx_t_6;
     __Pyx_XGIVEREF(__pyx_t_8);
     __pyx_cur_scope->__pyx_t_2 = __pyx_t_8;
     __Pyx_XGIVEREF(__pyx_r);
     __Pyx_RefNannyFinishContext();
     __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
     /* return from generator, yielding value */
     __pyx_generator->resume_label = 1;
     return __pyx_r;
-    __pyx_L20_resume_from_yield:;
+    __pyx_L21_resume_from_yield:;
     __pyx_t_5 = __pyx_cur_scope->__pyx_t_0;
     __pyx_t_6 = __pyx_cur_scope->__pyx_t_1;
     __pyx_t_8 = __pyx_cur_scope->__pyx_t_2;
     __pyx_cur_scope->__pyx_t_2 = 0;
     __Pyx_XGOTREF(__pyx_t_8);
-    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 450, __pyx_L1_error)
+    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 479, __pyx_L1_error)
 
-    /* "statmoments/_native.pyx":417
+    /* "statmoments/_native.pyx":442
  *     cm, buf = np.empty((2, maxm, tr_len), dtype=np.float64), self._buf
  * 
  *     for ii in range(cl_len):             # <<<<<<<<<<<<<<
  *       n0, n1 = self.counts(ii)
- *       acc0, acc1 = self._accs[ii], self._accs[ii, 1:].T
+ * 
  */
   }
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
-  /* "statmoments/_native.pyx":406
+  /* "statmoments/_native.pyx":430
  *     return acc0[0, 0], acc1[0, 0]
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     maxm = np.max(moments)
  *     if self.moment * 2 < maxm:
  */
 
@@ -14623,30 +14993,30 @@
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_8);
   __Pyx_XDECREF(__pyx_t_10);
-  __Pyx_XDECREF(__pyx_t_14);
-  __Pyx_XDECREF(__pyx_t_17);
+  __Pyx_XDECREF(__pyx_t_15);
+  __Pyx_XDECREF(__pyx_t_18);
   __Pyx_AddTraceback("_moments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_r); __pyx_r = 0;
   #if !CYTHON_USE_EXC_INFO_STACK
   __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static PyObject *__pyx_gb_11statmoments_7_native_15_bivar_sum_base_15generator1(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "statmoments/_native.pyx":452
+/* "statmoments/_native.pyx":481
  *       yield cm[:, moments]
  * 
  *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     retm = self._retm
  *     tr_len, cl_len = self.trace_len, self._accs.shape[0]
  */
 
@@ -14684,40 +15054,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moments)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, 1); __PYX_ERR(0, 452, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, 1); __PYX_ERR(0, 481, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_normalize)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, 2); __PYX_ERR(0, 452, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, 2); __PYX_ERR(0, 481, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_comoments") < 0)) __PYX_ERR(0, 452, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_comoments") < 0)) __PYX_ERR(0, 481, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_moments = values[1];
     __pyx_v_normalize = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 452, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 481, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native._bivar_sum_base._comoments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_15_bivar_sum_base_13_comoments(__pyx_self, __pyx_v_self, __pyx_v_moments, __pyx_v_normalize);
 
@@ -14734,29 +15104,29 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_comoments", 0);
   __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_3__comoments *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_3__comoments(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_3__comoments, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_3__comoments *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 452, __pyx_L1_error)
+    __PYX_ERR(0, 481, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
   __pyx_cur_scope->__pyx_v_moments = __pyx_v_moments;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_moments);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_moments);
   __pyx_cur_scope->__pyx_v_normalize = __pyx_v_normalize;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_normalize);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_normalize);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_15_bivar_sum_base_15generator1, __pyx_codeobj__25, (PyObject *) __pyx_cur_scope, __pyx_n_s_comoments, __pyx_n_s_bivar_sum_base__comoments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 452, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_15_bivar_sum_base_15generator1, __pyx_codeobj__26, (PyObject *) __pyx_cur_scope, __pyx_n_s_comoments, __pyx_n_s_bivar_sum_base__comoments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 481, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -14774,1373 +15144,1229 @@
   PyObject *__pyx_r = NULL;
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   Py_ssize_t __pyx_t_4;
   PyObject *(*__pyx_t_5)(PyObject *);
   PyObject *__pyx_t_6 = NULL;
-  Py_ssize_t __pyx_t_7;
+  PyObject *__pyx_t_7 = NULL;
   PyObject *(*__pyx_t_8)(PyObject *);
   PyObject *__pyx_t_9 = NULL;
-  PyObject *__pyx_t_10 = NULL;
-  PyObject *__pyx_t_11 = NULL;
+  int __pyx_t_10;
+  Py_ssize_t __pyx_t_11;
   PyObject *(*__pyx_t_12)(PyObject *);
   PyObject *__pyx_t_13 = NULL;
-  int __pyx_t_14;
+  long __pyx_t_14;
   Py_ssize_t __pyx_t_15;
   PyObject *(*__pyx_t_16)(PyObject *);
   Py_ssize_t __pyx_t_17;
   Py_ssize_t __pyx_t_18;
-  int __pyx_t_19;
-  double __pyx_t_20;
-  int __pyx_t_21;
-  int __pyx_t_22;
-  PyObject *__pyx_t_23 = NULL;
+  PyObject *__pyx_t_19 = NULL;
+  int __pyx_t_20;
+  PyObject *__pyx_t_21 = NULL;
+  double __pyx_t_22;
+  int __pyx_t_23;
   int __pyx_t_24;
-  long __pyx_t_25;
+  int __pyx_t_25;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("_comoments", 0);
   switch (__pyx_generator->resume_label) {
     case 0: goto __pyx_L3_first_run;
-    case 1: goto __pyx_L23_resume_from_yield;
+    case 1: goto __pyx_L22_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 452, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 481, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":453
+  /* "statmoments/_native.pyx":482
  * 
  *   def _comoments(self, moments, normalize):
  *     retm = self._retm             # <<<<<<<<<<<<<<
  *     tr_len, cl_len = self.trace_len, self._accs.shape[0]
  *     ma, min_cnt = self.moment, self.acc_min_count
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 453, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 482, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v_retm = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":454
+  /* "statmoments/_native.pyx":483
  *   def _comoments(self, moments, normalize):
  *     retm = self._retm
  *     tr_len, cl_len = self.trace_len, self._accs.shape[0]             # <<<<<<<<<<<<<<
  *     ma, min_cnt = self.moment, self.acc_min_count
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 454, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 483, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 454, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 483, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 454, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 483, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 454, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 483, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v_tr_len = __pyx_t_1;
   __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_cur_scope->__pyx_v_cl_len = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":455
+  /* "statmoments/_native.pyx":484
  *     retm = self._retm
  *     tr_len, cl_len = self.trace_len, self._accs.shape[0]
  *     ma, min_cnt = self.moment, self.acc_min_count             # <<<<<<<<<<<<<<
  * 
  *     for ii in range(cl_len):
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 455, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 484, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_acc_min_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 455, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_acc_min_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 484, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_cur_scope->__pyx_v_ma = __pyx_t_2;
   __pyx_t_2 = 0;
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v_min_cnt = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":457
+  /* "statmoments/_native.pyx":486
  *     ma, min_cnt = self.moment, self.acc_min_count
  * 
  *     for ii in range(cl_len):             # <<<<<<<<<<<<<<
- *       # The left and the right degree of the product terms, e.g. xi^1 * xj^3
- *       for jj, (lm, rm) in enumerate(zip(*moments)):
+ *       n0, n1 = self.counts(ii)
+ * 
  */
-  __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_cur_scope->__pyx_v_cl_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 457, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_cur_scope->__pyx_v_cl_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 486, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
     __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_4 = 0;
     __pyx_t_5 = NULL;
   } else {
-    __pyx_t_4 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 457, __pyx_L1_error)
+    __pyx_t_4 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 486, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 457, __pyx_L1_error)
+    __pyx_t_5 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 486, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_5)) {
       if (likely(PyList_CheckExact(__pyx_t_2))) {
         if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 457, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 486, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 457, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 486, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 457, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 486, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 457, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 486, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
       __pyx_t_1 = __pyx_t_5(__pyx_t_2);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 457, __pyx_L1_error)
+          else __PYX_ERR(0, 486, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_ii);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_ii, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":459
+    /* "statmoments/_native.pyx":487
+ * 
  *     for ii in range(cl_len):
+ *       n0, n1 = self.counts(ii)             # <<<<<<<<<<<<<<
+ * 
+ *       # Convert to double if accumulator is float
+ */
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_counts); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 487, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_6 = NULL;
+    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
+      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
+      if (likely(__pyx_t_6)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+        __Pyx_INCREF(__pyx_t_6);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_3, function);
+      }
+    }
+    __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_6, __pyx_cur_scope->__pyx_v_ii) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_cur_scope->__pyx_v_ii);
+    __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 487, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
+      PyObject* sequence = __pyx_t_1;
+      Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
+      if (unlikely(size != 2)) {
+        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
+        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
+        __PYX_ERR(0, 487, __pyx_L1_error)
+      }
+      #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+      if (likely(PyTuple_CheckExact(sequence))) {
+        __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
+        __pyx_t_6 = PyTuple_GET_ITEM(sequence, 1); 
+      } else {
+        __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
+        __pyx_t_6 = PyList_GET_ITEM(sequence, 1); 
+      }
+      __Pyx_INCREF(__pyx_t_3);
+      __Pyx_INCREF(__pyx_t_6);
+      #else
+      __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 487, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_6 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 487, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      #endif
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    } else {
+      Py_ssize_t index = -1;
+      __pyx_t_7 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 487, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_t_8 = Py_TYPE(__pyx_t_7)->tp_iternext;
+      index = 0; __pyx_t_3 = __pyx_t_8(__pyx_t_7); if (unlikely(!__pyx_t_3)) goto __pyx_L6_unpacking_failed;
+      __Pyx_GOTREF(__pyx_t_3);
+      index = 1; __pyx_t_6 = __pyx_t_8(__pyx_t_7); if (unlikely(!__pyx_t_6)) goto __pyx_L6_unpacking_failed;
+      __Pyx_GOTREF(__pyx_t_6);
+      if (__Pyx_IternextUnpackEndCheck(__pyx_t_8(__pyx_t_7), 2) < 0) __PYX_ERR(0, 487, __pyx_L1_error)
+      __pyx_t_8 = NULL;
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      goto __pyx_L7_unpacking_done;
+      __pyx_L6_unpacking_failed:;
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      __pyx_t_8 = NULL;
+      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
+      __PYX_ERR(0, 487, __pyx_L1_error)
+      __pyx_L7_unpacking_done:;
+    }
+    __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_n0);
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_n0, __pyx_t_3);
+    __Pyx_GIVEREF(__pyx_t_3);
+    __pyx_t_3 = 0;
+    __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_n1);
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_n1, __pyx_t_6);
+    __Pyx_GIVEREF(__pyx_t_6);
+    __pyx_t_6 = 0;
+
+    /* "statmoments/_native.pyx":490
+ * 
+ *       # Convert to double if accumulator is float
+ *       acc0 = np.asarray(self._accs[ii],       dtype=np.float64)             # <<<<<<<<<<<<<<
+ *       acc1 = np.asarray(self._accs[ii, 1:].T, dtype=np.float64)
+ * 
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 490, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_asarray); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 490, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 490, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_cur_scope->__pyx_v_ii); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 490, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 490, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_GIVEREF(__pyx_t_3);
+    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
+    __pyx_t_3 = 0;
+    __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 490, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 490, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_float64); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 490, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_9) < 0) __PYX_ERR(0, 490, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+    __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 490, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_acc0);
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_acc0, __pyx_t_9);
+    __Pyx_GIVEREF(__pyx_t_9);
+    __pyx_t_9 = 0;
+
+    /* "statmoments/_native.pyx":491
+ *       # Convert to double if accumulator is float
+ *       acc0 = np.asarray(self._accs[ii],       dtype=np.float64)
+ *       acc1 = np.asarray(self._accs[ii, 1:].T, dtype=np.float64)             # <<<<<<<<<<<<<<
+ * 
+ *       # Reshape accumulator to a 4D co-sum tensor
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 491, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_asarray); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 491, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 491, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 491, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_INCREF(__pyx_cur_scope->__pyx_v_ii);
+    __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_ii);
+    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_cur_scope->__pyx_v_ii);
+    __Pyx_INCREF(__pyx_slice__19);
+    __Pyx_GIVEREF(__pyx_slice__19);
+    PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_slice__19);
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_9, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 491, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_T); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 491, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 491, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_GIVEREF(__pyx_t_1);
+    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1);
+    __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 491, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 491, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_float64); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 491, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 491, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 491, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_acc1);
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_acc1, __pyx_t_7);
+    __Pyx_GIVEREF(__pyx_t_7);
+    __pyx_t_7 = 0;
+
+    /* "statmoments/_native.pyx":494
+ * 
+ *       # Reshape accumulator to a 4D co-sum tensor
+ *       raw0 = acc0[1:acc0.shape[0] - 1, 1:].reshape(ma, tr_len, ma, tr_len)             # <<<<<<<<<<<<<<
+ *       raw1 = acc1[1:acc1.shape[0] - 0, 1:].reshape(ma, tr_len, ma, tr_len)
+ * 
+ */
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_acc0, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 494, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 494, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 494, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PySlice_New(__pyx_int_1, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 494, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 494, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_GIVEREF(__pyx_t_6);
+    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6);
+    __Pyx_INCREF(__pyx_slice__19);
+    __Pyx_GIVEREF(__pyx_slice__19);
+    PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_slice__19);
+    __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_acc0, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 494, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_reshape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 494, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = NULL;
+    __pyx_t_10 = 0;
+    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
+      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
+      if (likely(__pyx_t_6)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+        __Pyx_INCREF(__pyx_t_6);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_1, function);
+        __pyx_t_10 = 1;
+      }
+    }
+    #if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(__pyx_t_1)) {
+      PyObject *__pyx_temp[5] = {__pyx_t_6, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len};
+      __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_10, 4+__pyx_t_10); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 494, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_GOTREF(__pyx_t_7);
+    } else
+    #endif
+    #if CYTHON_FAST_PYCCALL
+    if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
+      PyObject *__pyx_temp[5] = {__pyx_t_6, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len};
+      __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_10, 4+__pyx_t_10); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 494, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_GOTREF(__pyx_t_7);
+    } else
+    #endif
+    {
+      __pyx_t_3 = PyTuple_New(4+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 494, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      if (__pyx_t_6) {
+        __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6); __pyx_t_6 = NULL;
+      }
+      __Pyx_INCREF(__pyx_cur_scope->__pyx_v_ma);
+      __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_ma);
+      PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_10, __pyx_cur_scope->__pyx_v_ma);
+      __Pyx_INCREF(__pyx_cur_scope->__pyx_v_tr_len);
+      __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_tr_len);
+      PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_10, __pyx_cur_scope->__pyx_v_tr_len);
+      __Pyx_INCREF(__pyx_cur_scope->__pyx_v_ma);
+      __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_ma);
+      PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_10, __pyx_cur_scope->__pyx_v_ma);
+      __Pyx_INCREF(__pyx_cur_scope->__pyx_v_tr_len);
+      __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_tr_len);
+      PyTuple_SET_ITEM(__pyx_t_3, 3+__pyx_t_10, __pyx_cur_scope->__pyx_v_tr_len);
+      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 494, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    }
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_raw0);
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_raw0, __pyx_t_7);
+    __Pyx_GIVEREF(__pyx_t_7);
+    __pyx_t_7 = 0;
+
+    /* "statmoments/_native.pyx":495
+ *       # Reshape accumulator to a 4D co-sum tensor
+ *       raw0 = acc0[1:acc0.shape[0] - 1, 1:].reshape(ma, tr_len, ma, tr_len)
+ *       raw1 = acc1[1:acc1.shape[0] - 0, 1:].reshape(ma, tr_len, ma, tr_len)             # <<<<<<<<<<<<<<
+ * 
+ *       # The left and the right degree of the product terms, e.g. xi^1 * xj^3
+ */
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_acc1, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 495, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 495, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_t_3, __pyx_int_0, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 495, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_3 = PySlice_New(__pyx_int_1, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 495, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 495, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_GIVEREF(__pyx_t_3);
+    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
+    __Pyx_INCREF(__pyx_slice__19);
+    __Pyx_GIVEREF(__pyx_slice__19);
+    PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_slice__19);
+    __pyx_t_3 = 0;
+    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_acc1, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 495, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_reshape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 495, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_3 = NULL;
+    __pyx_t_10 = 0;
+    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
+      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
+      if (likely(__pyx_t_3)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+        __Pyx_INCREF(__pyx_t_3);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_1, function);
+        __pyx_t_10 = 1;
+      }
+    }
+    #if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(__pyx_t_1)) {
+      PyObject *__pyx_temp[5] = {__pyx_t_3, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len};
+      __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_10, 4+__pyx_t_10); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 495, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_GOTREF(__pyx_t_7);
+    } else
+    #endif
+    #if CYTHON_FAST_PYCCALL
+    if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
+      PyObject *__pyx_temp[5] = {__pyx_t_3, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len};
+      __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_10, 4+__pyx_t_10); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 495, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_GOTREF(__pyx_t_7);
+    } else
+    #endif
+    {
+      __pyx_t_6 = PyTuple_New(4+__pyx_t_10); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 495, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      if (__pyx_t_3) {
+        __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3); __pyx_t_3 = NULL;
+      }
+      __Pyx_INCREF(__pyx_cur_scope->__pyx_v_ma);
+      __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_ma);
+      PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_10, __pyx_cur_scope->__pyx_v_ma);
+      __Pyx_INCREF(__pyx_cur_scope->__pyx_v_tr_len);
+      __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_tr_len);
+      PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_10, __pyx_cur_scope->__pyx_v_tr_len);
+      __Pyx_INCREF(__pyx_cur_scope->__pyx_v_ma);
+      __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_ma);
+      PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_10, __pyx_cur_scope->__pyx_v_ma);
+      __Pyx_INCREF(__pyx_cur_scope->__pyx_v_tr_len);
+      __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_tr_len);
+      PyTuple_SET_ITEM(__pyx_t_6, 3+__pyx_t_10, __pyx_cur_scope->__pyx_v_tr_len);
+      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 495, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    }
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_raw1);
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_raw1, __pyx_t_7);
+    __Pyx_GIVEREF(__pyx_t_7);
+    __pyx_t_7 = 0;
+
+    /* "statmoments/_native.pyx":498
+ * 
  *       # The left and the right degree of the product terms, e.g. xi^1 * xj^3
  *       for jj, (lm, rm) in enumerate(zip(*moments)):             # <<<<<<<<<<<<<<
- *         n0, n1 = self.counts(ii)
- *         acc0, acc1 = self._accs[ii], self._accs[ii, 1:].T
+ *         for _i in range(2):
+ *           raw = raw0 if _i == 0 else raw1
  */
     __Pyx_INCREF(__pyx_int_0);
-    __pyx_t_1 = __pyx_int_0;
-    __pyx_t_3 = __Pyx_PySequence_Tuple(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 459, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_zip, __pyx_t_3, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 459, __pyx_L1_error)
+    __pyx_t_7 = __pyx_int_0;
+    __pyx_t_1 = __Pyx_PySequence_Tuple(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 498, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_zip, __pyx_t_1, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 498, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (likely(PyList_CheckExact(__pyx_t_6)) || PyTuple_CheckExact(__pyx_t_6)) {
-      __pyx_t_3 = __pyx_t_6; __Pyx_INCREF(__pyx_t_3); __pyx_t_7 = 0;
-      __pyx_t_8 = NULL;
+      __pyx_t_1 = __pyx_t_6; __Pyx_INCREF(__pyx_t_1); __pyx_t_11 = 0;
+      __pyx_t_12 = NULL;
     } else {
-      __pyx_t_7 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 459, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_8 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 459, __pyx_L1_error)
+      __pyx_t_11 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 498, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_12 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 498, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     for (;;) {
-      if (likely(!__pyx_t_8)) {
-        if (likely(PyList_CheckExact(__pyx_t_3))) {
-          if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_3)) break;
+      if (likely(!__pyx_t_12)) {
+        if (likely(PyList_CheckExact(__pyx_t_1))) {
+          if (__pyx_t_11 >= PyList_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_6 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_6); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 459, __pyx_L1_error)
+          __pyx_t_6 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_11); __Pyx_INCREF(__pyx_t_6); __pyx_t_11++; if (unlikely(0 < 0)) __PYX_ERR(0, 498, __pyx_L1_error)
           #else
-          __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 459, __pyx_L1_error)
+          __pyx_t_6 = PySequence_ITEM(__pyx_t_1, __pyx_t_11); __pyx_t_11++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 498, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           #endif
         } else {
-          if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
+          if (__pyx_t_11 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_6); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 459, __pyx_L1_error)
+          __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_11); __Pyx_INCREF(__pyx_t_6); __pyx_t_11++; if (unlikely(0 < 0)) __PYX_ERR(0, 498, __pyx_L1_error)
           #else
-          __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 459, __pyx_L1_error)
+          __pyx_t_6 = PySequence_ITEM(__pyx_t_1, __pyx_t_11); __pyx_t_11++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 498, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           #endif
         }
       } else {
-        __pyx_t_6 = __pyx_t_8(__pyx_t_3);
+        __pyx_t_6 = __pyx_t_12(__pyx_t_1);
         if (unlikely(!__pyx_t_6)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 459, __pyx_L1_error)
+            else __PYX_ERR(0, 498, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_6);
       }
       if ((likely(PyTuple_CheckExact(__pyx_t_6))) || (PyList_CheckExact(__pyx_t_6))) {
         PyObject* sequence = __pyx_t_6;
         Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
         if (unlikely(size != 2)) {
           if (size > 2) __Pyx_RaiseTooManyValuesError(2);
           else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-          __PYX_ERR(0, 459, __pyx_L1_error)
+          __PYX_ERR(0, 498, __pyx_L1_error)
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
         if (likely(PyTuple_CheckExact(sequence))) {
-          __pyx_t_9 = PyTuple_GET_ITEM(sequence, 0); 
-          __pyx_t_10 = PyTuple_GET_ITEM(sequence, 1); 
+          __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
+          __pyx_t_9 = PyTuple_GET_ITEM(sequence, 1); 
         } else {
-          __pyx_t_9 = PyList_GET_ITEM(sequence, 0); 
-          __pyx_t_10 = PyList_GET_ITEM(sequence, 1); 
+          __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
+          __pyx_t_9 = PyList_GET_ITEM(sequence, 1); 
         }
+        __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_9);
-        __Pyx_INCREF(__pyx_t_10);
         #else
-        __pyx_t_9 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 459, __pyx_L1_error)
+        __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 498, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __pyx_t_9 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 498, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
-        __pyx_t_10 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 459, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_10);
         #endif
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       } else {
         Py_ssize_t index = -1;
-        __pyx_t_11 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 459, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
+        __pyx_t_13 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 498, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_13);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_12 = Py_TYPE(__pyx_t_11)->tp_iternext;
-        index = 0; __pyx_t_9 = __pyx_t_12(__pyx_t_11); if (unlikely(!__pyx_t_9)) goto __pyx_L8_unpacking_failed;
+        __pyx_t_8 = Py_TYPE(__pyx_t_13)->tp_iternext;
+        index = 0; __pyx_t_3 = __pyx_t_8(__pyx_t_13); if (unlikely(!__pyx_t_3)) goto __pyx_L10_unpacking_failed;
+        __Pyx_GOTREF(__pyx_t_3);
+        index = 1; __pyx_t_9 = __pyx_t_8(__pyx_t_13); if (unlikely(!__pyx_t_9)) goto __pyx_L10_unpacking_failed;
         __Pyx_GOTREF(__pyx_t_9);
-        index = 1; __pyx_t_10 = __pyx_t_12(__pyx_t_11); if (unlikely(!__pyx_t_10)) goto __pyx_L8_unpacking_failed;
-        __Pyx_GOTREF(__pyx_t_10);
-        if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_11), 2) < 0) __PYX_ERR(0, 459, __pyx_L1_error)
-        __pyx_t_12 = NULL;
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        goto __pyx_L9_unpacking_done;
-        __pyx_L8_unpacking_failed:;
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __pyx_t_12 = NULL;
+        if (__Pyx_IternextUnpackEndCheck(__pyx_t_8(__pyx_t_13), 2) < 0) __PYX_ERR(0, 498, __pyx_L1_error)
+        __pyx_t_8 = NULL;
+        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+        goto __pyx_L11_unpacking_done;
+        __pyx_L10_unpacking_failed:;
+        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+        __pyx_t_8 = NULL;
         if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-        __PYX_ERR(0, 459, __pyx_L1_error)
-        __pyx_L9_unpacking_done:;
+        __PYX_ERR(0, 498, __pyx_L1_error)
+        __pyx_L11_unpacking_done:;
       }
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_lm);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_lm, __pyx_t_9);
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_lm, __pyx_t_3);
+      __Pyx_GIVEREF(__pyx_t_3);
+      __pyx_t_3 = 0;
+      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_rm);
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_rm, __pyx_t_9);
       __Pyx_GIVEREF(__pyx_t_9);
       __pyx_t_9 = 0;
-      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_rm);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_rm, __pyx_t_10);
-      __Pyx_GIVEREF(__pyx_t_10);
-      __pyx_t_10 = 0;
-      __Pyx_INCREF(__pyx_t_1);
+      __Pyx_INCREF(__pyx_t_7);
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_jj);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_jj, __pyx_t_1);
-      __Pyx_GIVEREF(__pyx_t_1);
-      __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 459, __pyx_L1_error)
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_jj, __pyx_t_7);
+      __Pyx_GIVEREF(__pyx_t_7);
+      __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_t_7, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 498, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __Pyx_DECREF(__pyx_t_1);
-      __pyx_t_1 = __pyx_t_6;
+      __Pyx_DECREF(__pyx_t_7);
+      __pyx_t_7 = __pyx_t_6;
       __pyx_t_6 = 0;
 
-      /* "statmoments/_native.pyx":460
+      /* "statmoments/_native.pyx":499
  *       # The left and the right degree of the product terms, e.g. xi^1 * xj^3
  *       for jj, (lm, rm) in enumerate(zip(*moments)):
- *         n0, n1 = self.counts(ii)             # <<<<<<<<<<<<<<
- *         acc0, acc1 = self._accs[ii], self._accs[ii, 1:].T
- * 
+ *         for _i in range(2):             # <<<<<<<<<<<<<<
+ *           raw = raw0 if _i == 0 else raw1
+ *           acc = acc0 if _i == 0 else acc1
  */
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_counts); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 460, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_9 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
-        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_10);
-        if (likely(__pyx_t_9)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
-          __Pyx_INCREF(__pyx_t_9);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_10, function);
-        }
-      }
-      __pyx_t_6 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_9, __pyx_cur_scope->__pyx_v_ii) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_cur_scope->__pyx_v_ii);
-      __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 460, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if ((likely(PyTuple_CheckExact(__pyx_t_6))) || (PyList_CheckExact(__pyx_t_6))) {
-        PyObject* sequence = __pyx_t_6;
-        Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
-        if (unlikely(size != 2)) {
-          if (size > 2) __Pyx_RaiseTooManyValuesError(2);
-          else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-          __PYX_ERR(0, 460, __pyx_L1_error)
-        }
-        #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        if (likely(PyTuple_CheckExact(sequence))) {
-          __pyx_t_10 = PyTuple_GET_ITEM(sequence, 0); 
-          __pyx_t_9 = PyTuple_GET_ITEM(sequence, 1); 
-        } else {
-          __pyx_t_10 = PyList_GET_ITEM(sequence, 0); 
-          __pyx_t_9 = PyList_GET_ITEM(sequence, 1); 
-        }
-        __Pyx_INCREF(__pyx_t_10);
-        __Pyx_INCREF(__pyx_t_9);
-        #else
-        __pyx_t_10 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 460, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_10);
-        __pyx_t_9 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 460, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_9);
-        #endif
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      } else {
-        Py_ssize_t index = -1;
-        __pyx_t_11 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 460, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_12 = Py_TYPE(__pyx_t_11)->tp_iternext;
-        index = 0; __pyx_t_10 = __pyx_t_12(__pyx_t_11); if (unlikely(!__pyx_t_10)) goto __pyx_L10_unpacking_failed;
-        __Pyx_GOTREF(__pyx_t_10);
-        index = 1; __pyx_t_9 = __pyx_t_12(__pyx_t_11); if (unlikely(!__pyx_t_9)) goto __pyx_L10_unpacking_failed;
-        __Pyx_GOTREF(__pyx_t_9);
-        if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_11), 2) < 0) __PYX_ERR(0, 460, __pyx_L1_error)
-        __pyx_t_12 = NULL;
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        goto __pyx_L11_unpacking_done;
-        __pyx_L10_unpacking_failed:;
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __pyx_t_12 = NULL;
-        if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-        __PYX_ERR(0, 460, __pyx_L1_error)
-        __pyx_L11_unpacking_done:;
-      }
-      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_n0);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_n0, __pyx_t_10);
-      __Pyx_GIVEREF(__pyx_t_10);
-      __pyx_t_10 = 0;
-      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_n1);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_n1, __pyx_t_9);
-      __Pyx_GIVEREF(__pyx_t_9);
-      __pyx_t_9 = 0;
+      for (__pyx_t_14 = 0; __pyx_t_14 < 2; __pyx_t_14+=1) {
+        __pyx_cur_scope->__pyx_v__i = __pyx_t_14;
 
-      /* "statmoments/_native.pyx":461
+        /* "statmoments/_native.pyx":500
  *       for jj, (lm, rm) in enumerate(zip(*moments)):
- *         n0, n1 = self.counts(ii)
- *         acc0, acc1 = self._accs[ii], self._accs[ii, 1:].T             # <<<<<<<<<<<<<<
- * 
- *         # Convert to double if accumulator is float
- */
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 461, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_cur_scope->__pyx_v_ii); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 461, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_9);
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 461, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 461, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __Pyx_INCREF(__pyx_cur_scope->__pyx_v_ii);
-      __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_ii);
-      PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_cur_scope->__pyx_v_ii);
-      __Pyx_INCREF(__pyx_slice__17);
-      __Pyx_GIVEREF(__pyx_slice__17);
-      PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_slice__17);
-      __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 461, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_T); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 461, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_acc0);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_acc0, __pyx_t_9);
-      __Pyx_GIVEREF(__pyx_t_9);
-      __pyx_t_9 = 0;
-      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_acc1);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_acc1, __pyx_t_10);
-      __Pyx_GIVEREF(__pyx_t_10);
-      __pyx_t_10 = 0;
-
-      /* "statmoments/_native.pyx":464
- * 
- *         # Convert to double if accumulator is float
- *         acc0 = np.asarray(acc0, dtype=np.float64)             # <<<<<<<<<<<<<<
- *         acc1 = np.asarray(acc1, dtype=np.float64)
- * 
- */
-      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 464, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_asarray); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 464, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_9);
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 464, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __Pyx_INCREF(__pyx_cur_scope->__pyx_v_acc0);
-      __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_acc0);
-      PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_cur_scope->__pyx_v_acc0);
-      __pyx_t_11 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 464, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 464, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 464, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_13);
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_dtype, __pyx_t_13) < 0) __PYX_ERR(0, 464, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-      __pyx_t_13 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_10, __pyx_t_11); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 464, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_13);
-      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __Pyx_GOTREF(__pyx_cur_scope->__pyx_v_acc0);
-      __Pyx_DECREF_SET(__pyx_cur_scope->__pyx_v_acc0, __pyx_t_13);
-      __Pyx_GIVEREF(__pyx_t_13);
-      __pyx_t_13 = 0;
-
-      /* "statmoments/_native.pyx":465
- *         # Convert to double if accumulator is float
- *         acc0 = np.asarray(acc0, dtype=np.float64)
- *         acc1 = np.asarray(acc1, dtype=np.float64)             # <<<<<<<<<<<<<<
- * 
- *         # Reshape accumulator to a 4D co-sum tensor
- */
-      __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 465, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_13);
-      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_asarray); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 465, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-      __pyx_t_13 = PyTuple_New(1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 465, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_13);
-      __Pyx_INCREF(__pyx_cur_scope->__pyx_v_acc1);
-      __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_acc1);
-      PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_cur_scope->__pyx_v_acc1);
-      __pyx_t_10 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 465, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 465, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 465, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 465, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_13, __pyx_t_10); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 465, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __Pyx_GOTREF(__pyx_cur_scope->__pyx_v_acc1);
-      __Pyx_DECREF_SET(__pyx_cur_scope->__pyx_v_acc1, __pyx_t_6);
-      __Pyx_GIVEREF(__pyx_t_6);
-      __pyx_t_6 = 0;
-
-      /* "statmoments/_native.pyx":468
- * 
- *         # Reshape accumulator to a 4D co-sum tensor
- *         raw0 = acc0[1:acc0.shape[0]-1, 1:].reshape(ma, tr_len, ma, tr_len)             # <<<<<<<<<<<<<<
- *         raw1 = acc1[1:acc1.shape[0]-0, 1:].reshape(ma, tr_len, ma, tr_len)
- * 
- */
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_acc0, __pyx_n_s_shape); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 468, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_13 = __Pyx_GetItemInt(__pyx_t_10, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 468, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_13);
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyInt_SubtractObjC(__pyx_t_13, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 468, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-      __pyx_t_13 = PySlice_New(__pyx_int_1, __pyx_t_10, Py_None); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 468, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_13);
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 468, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __Pyx_GIVEREF(__pyx_t_13);
-      PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_13);
-      __Pyx_INCREF(__pyx_slice__17);
-      __Pyx_GIVEREF(__pyx_slice__17);
-      PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_slice__17);
-      __pyx_t_13 = 0;
-      __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_acc0, __pyx_t_10); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 468, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_13);
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_reshape); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 468, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-      __pyx_t_13 = NULL;
-      __pyx_t_14 = 0;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
-        __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_10);
-        if (likely(__pyx_t_13)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
-          __Pyx_INCREF(__pyx_t_13);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_10, function);
-          __pyx_t_14 = 1;
-        }
-      }
-      #if CYTHON_FAST_PYCALL
-      if (PyFunction_Check(__pyx_t_10)) {
-        PyObject *__pyx_temp[5] = {__pyx_t_13, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len};
-        __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_14, 4+__pyx_t_14); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 468, __pyx_L1_error)
-        __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __Pyx_GOTREF(__pyx_t_6);
-      } else
-      #endif
-      #if CYTHON_FAST_PYCCALL
-      if (__Pyx_PyFastCFunction_Check(__pyx_t_10)) {
-        PyObject *__pyx_temp[5] = {__pyx_t_13, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len};
-        __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_14, 4+__pyx_t_14); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 468, __pyx_L1_error)
-        __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __Pyx_GOTREF(__pyx_t_6);
-      } else
-      #endif
-      {
-        __pyx_t_11 = PyTuple_New(4+__pyx_t_14); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 468, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        if (__pyx_t_13) {
-          __Pyx_GIVEREF(__pyx_t_13); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_13); __pyx_t_13 = NULL;
+ *         for _i in range(2):
+ *           raw = raw0 if _i == 0 else raw1             # <<<<<<<<<<<<<<
+ *           acc = acc0 if _i == 0 else acc1
+ *           nn = n0 if _i == 0 else n1
+ */
+        if (((__pyx_cur_scope->__pyx_v__i == 0) != 0)) {
+          __Pyx_INCREF(__pyx_cur_scope->__pyx_v_raw0);
+          __pyx_t_6 = __pyx_cur_scope->__pyx_v_raw0;
+        } else {
+          __Pyx_INCREF(__pyx_cur_scope->__pyx_v_raw1);
+          __pyx_t_6 = __pyx_cur_scope->__pyx_v_raw1;
         }
-        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_ma);
-        __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_ma);
-        PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_14, __pyx_cur_scope->__pyx_v_ma);
-        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_tr_len);
-        __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_tr_len);
-        PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_14, __pyx_cur_scope->__pyx_v_tr_len);
-        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_ma);
-        __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_ma);
-        PyTuple_SET_ITEM(__pyx_t_11, 2+__pyx_t_14, __pyx_cur_scope->__pyx_v_ma);
-        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_tr_len);
-        __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_tr_len);
-        PyTuple_SET_ITEM(__pyx_t_11, 3+__pyx_t_14, __pyx_cur_scope->__pyx_v_tr_len);
-        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_11, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 468, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      }
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_raw0);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_raw0, __pyx_t_6);
-      __Pyx_GIVEREF(__pyx_t_6);
-      __pyx_t_6 = 0;
+        __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_raw);
+        __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_raw, __pyx_t_6);
+        __Pyx_GIVEREF(__pyx_t_6);
+        __pyx_t_6 = 0;
 
-      /* "statmoments/_native.pyx":469
- *         # Reshape accumulator to a 4D co-sum tensor
- *         raw0 = acc0[1:acc0.shape[0]-1, 1:].reshape(ma, tr_len, ma, tr_len)
- *         raw1 = acc1[1:acc1.shape[0]-0, 1:].reshape(ma, tr_len, ma, tr_len)             # <<<<<<<<<<<<<<
+        /* "statmoments/_native.pyx":501
+ *         for _i in range(2):
+ *           raw = raw0 if _i == 0 else raw1
+ *           acc = acc0 if _i == 0 else acc1             # <<<<<<<<<<<<<<
+ *           nn = n0 if _i == 0 else n1
  * 
- *         for i in range(tr_len):
  */
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_acc1, __pyx_n_s_shape); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 469, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_11 = __Pyx_GetItemInt(__pyx_t_10, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 469, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyInt_SubtractObjC(__pyx_t_11, __pyx_int_0, 0, 0, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 469, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_11 = PySlice_New(__pyx_int_1, __pyx_t_10, Py_None); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 469, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 469, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __Pyx_GIVEREF(__pyx_t_11);
-      PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_11);
-      __Pyx_INCREF(__pyx_slice__17);
-      __Pyx_GIVEREF(__pyx_slice__17);
-      PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_slice__17);
-      __pyx_t_11 = 0;
-      __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_acc1, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 469, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_reshape); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 469, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_11 = NULL;
-      __pyx_t_14 = 0;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
-        __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_10);
-        if (likely(__pyx_t_11)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
-          __Pyx_INCREF(__pyx_t_11);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_10, function);
-          __pyx_t_14 = 1;
-        }
-      }
-      #if CYTHON_FAST_PYCALL
-      if (PyFunction_Check(__pyx_t_10)) {
-        PyObject *__pyx_temp[5] = {__pyx_t_11, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len};
-        __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_14, 4+__pyx_t_14); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 469, __pyx_L1_error)
-        __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __Pyx_GOTREF(__pyx_t_6);
-      } else
-      #endif
-      #if CYTHON_FAST_PYCCALL
-      if (__Pyx_PyFastCFunction_Check(__pyx_t_10)) {
-        PyObject *__pyx_temp[5] = {__pyx_t_11, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len, __pyx_cur_scope->__pyx_v_ma, __pyx_cur_scope->__pyx_v_tr_len};
-        __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_14, 4+__pyx_t_14); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 469, __pyx_L1_error)
-        __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __Pyx_GOTREF(__pyx_t_6);
-      } else
-      #endif
-      {
-        __pyx_t_13 = PyTuple_New(4+__pyx_t_14); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 469, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_13);
-        if (__pyx_t_11) {
-          __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_11); __pyx_t_11 = NULL;
+        if (((__pyx_cur_scope->__pyx_v__i == 0) != 0)) {
+          __Pyx_INCREF(__pyx_cur_scope->__pyx_v_acc0);
+          __pyx_t_6 = __pyx_cur_scope->__pyx_v_acc0;
+        } else {
+          __Pyx_INCREF(__pyx_cur_scope->__pyx_v_acc1);
+          __pyx_t_6 = __pyx_cur_scope->__pyx_v_acc1;
         }
-        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_ma);
-        __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_ma);
-        PyTuple_SET_ITEM(__pyx_t_13, 0+__pyx_t_14, __pyx_cur_scope->__pyx_v_ma);
-        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_tr_len);
-        __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_tr_len);
-        PyTuple_SET_ITEM(__pyx_t_13, 1+__pyx_t_14, __pyx_cur_scope->__pyx_v_tr_len);
-        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_ma);
-        __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_ma);
-        PyTuple_SET_ITEM(__pyx_t_13, 2+__pyx_t_14, __pyx_cur_scope->__pyx_v_ma);
-        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_tr_len);
-        __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_tr_len);
-        PyTuple_SET_ITEM(__pyx_t_13, 3+__pyx_t_14, __pyx_cur_scope->__pyx_v_tr_len);
-        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_13, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 469, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-      }
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_raw1);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_raw1, __pyx_t_6);
-      __Pyx_GIVEREF(__pyx_t_6);
-      __pyx_t_6 = 0;
+        __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_acc);
+        __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_acc, __pyx_t_6);
+        __Pyx_GIVEREF(__pyx_t_6);
+        __pyx_t_6 = 0;
 
-      /* "statmoments/_native.pyx":471
- *         raw1 = acc1[1:acc1.shape[0]-0, 1:].reshape(ma, tr_len, ma, tr_len)
- * 
- *         for i in range(tr_len):             # <<<<<<<<<<<<<<
- *           j, k = _block_index(i, tr_len)
- *           if n0 >= min_cnt:
- */
-      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_cur_scope->__pyx_v_tr_len); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 471, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      if (likely(PyList_CheckExact(__pyx_t_6)) || PyTuple_CheckExact(__pyx_t_6)) {
-        __pyx_t_10 = __pyx_t_6; __Pyx_INCREF(__pyx_t_10); __pyx_t_15 = 0;
-        __pyx_t_16 = NULL;
-      } else {
-        __pyx_t_15 = -1; __pyx_t_10 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 471, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_10);
-        __pyx_t_16 = Py_TYPE(__pyx_t_10)->tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 471, __pyx_L1_error)
-      }
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      for (;;) {
-        if (likely(!__pyx_t_16)) {
-          if (likely(PyList_CheckExact(__pyx_t_10))) {
-            if (__pyx_t_15 >= PyList_GET_SIZE(__pyx_t_10)) break;
-            #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_6 = PyList_GET_ITEM(__pyx_t_10, __pyx_t_15); __Pyx_INCREF(__pyx_t_6); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 471, __pyx_L1_error)
-            #else
-            __pyx_t_6 = PySequence_ITEM(__pyx_t_10, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 471, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_6);
-            #endif
-          } else {
-            if (__pyx_t_15 >= PyTuple_GET_SIZE(__pyx_t_10)) break;
-            #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_10, __pyx_t_15); __Pyx_INCREF(__pyx_t_6); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 471, __pyx_L1_error)
-            #else
-            __pyx_t_6 = PySequence_ITEM(__pyx_t_10, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 471, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_6);
-            #endif
-          }
+        /* "statmoments/_native.pyx":502
+ *           raw = raw0 if _i == 0 else raw1
+ *           acc = acc0 if _i == 0 else acc1
+ *           nn = n0 if _i == 0 else n1             # <<<<<<<<<<<<<<
+ * 
+ *           for i in range(tr_len):
+ */
+        if (((__pyx_cur_scope->__pyx_v__i == 0) != 0)) {
+          __Pyx_INCREF(__pyx_cur_scope->__pyx_v_n0);
+          __pyx_t_6 = __pyx_cur_scope->__pyx_v_n0;
         } else {
-          __pyx_t_6 = __pyx_t_16(__pyx_t_10);
-          if (unlikely(!__pyx_t_6)) {
-            PyObject* exc_type = PyErr_Occurred();
-            if (exc_type) {
-              if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-              else __PYX_ERR(0, 471, __pyx_L1_error)
-            }
-            break;
-          }
-          __Pyx_GOTREF(__pyx_t_6);
+          __Pyx_INCREF(__pyx_cur_scope->__pyx_v_n1);
+          __pyx_t_6 = __pyx_cur_scope->__pyx_v_n1;
         }
-        __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_i);
-        __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_i, __pyx_t_6);
+        __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_nn);
+        __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_nn, __pyx_t_6);
         __Pyx_GIVEREF(__pyx_t_6);
         __pyx_t_6 = 0;
 
-        /* "statmoments/_native.pyx":472
+        /* "statmoments/_native.pyx":504
+ *           nn = n0 if _i == 0 else n1
  * 
- *         for i in range(tr_len):
- *           j, k = _block_index(i, tr_len)             # <<<<<<<<<<<<<<
- *           if n0 >= min_cnt:
- *             m10 = 1.0/n0 * acc0[0, 1: 1 + tr_len]
- */
-        __pyx_t_17 = __Pyx_PyIndex_AsSsize_t(__pyx_cur_scope->__pyx_v_i); if (unlikely((__pyx_t_17 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 472, __pyx_L1_error)
-        __pyx_t_18 = __Pyx_PyIndex_AsSsize_t(__pyx_cur_scope->__pyx_v_tr_len); if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 472, __pyx_L1_error)
-        __pyx_t_6 = __pyx_f_11statmoments_7_native__block_index(__pyx_t_17, __pyx_t_18); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 472, __pyx_L1_error)
+ *           for i in range(tr_len):             # <<<<<<<<<<<<<<
+ *             j, k = _block_index(i, tr_len)
+ *             if nn < min_cnt:
+ */
+        __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_cur_scope->__pyx_v_tr_len); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 504, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        if ((likely(PyTuple_CheckExact(__pyx_t_6))) || (PyList_CheckExact(__pyx_t_6))) {
-          PyObject* sequence = __pyx_t_6;
-          Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
-          if (unlikely(size != 2)) {
-            if (size > 2) __Pyx_RaiseTooManyValuesError(2);
-            else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-            __PYX_ERR(0, 472, __pyx_L1_error)
-          }
-          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          if (likely(PyTuple_CheckExact(sequence))) {
-            __pyx_t_13 = PyTuple_GET_ITEM(sequence, 0); 
-            __pyx_t_11 = PyTuple_GET_ITEM(sequence, 1); 
-          } else {
-            __pyx_t_13 = PyList_GET_ITEM(sequence, 0); 
-            __pyx_t_11 = PyList_GET_ITEM(sequence, 1); 
-          }
-          __Pyx_INCREF(__pyx_t_13);
-          __Pyx_INCREF(__pyx_t_11);
-          #else
-          __pyx_t_13 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 472, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_13);
-          __pyx_t_11 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 472, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_11);
-          #endif
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+        if (likely(PyList_CheckExact(__pyx_t_6)) || PyTuple_CheckExact(__pyx_t_6)) {
+          __pyx_t_9 = __pyx_t_6; __Pyx_INCREF(__pyx_t_9); __pyx_t_15 = 0;
+          __pyx_t_16 = NULL;
         } else {
-          Py_ssize_t index = -1;
-          __pyx_t_9 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 472, __pyx_L1_error)
+          __pyx_t_15 = -1; __pyx_t_9 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 504, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __pyx_t_12 = Py_TYPE(__pyx_t_9)->tp_iternext;
-          index = 0; __pyx_t_13 = __pyx_t_12(__pyx_t_9); if (unlikely(!__pyx_t_13)) goto __pyx_L14_unpacking_failed;
-          __Pyx_GOTREF(__pyx_t_13);
-          index = 1; __pyx_t_11 = __pyx_t_12(__pyx_t_9); if (unlikely(!__pyx_t_11)) goto __pyx_L14_unpacking_failed;
-          __Pyx_GOTREF(__pyx_t_11);
-          if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_9), 2) < 0) __PYX_ERR(0, 472, __pyx_L1_error)
-          __pyx_t_12 = NULL;
-          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          goto __pyx_L15_unpacking_done;
-          __pyx_L14_unpacking_failed:;
-          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __pyx_t_12 = NULL;
-          if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-          __PYX_ERR(0, 472, __pyx_L1_error)
-          __pyx_L15_unpacking_done:;
+          __pyx_t_16 = Py_TYPE(__pyx_t_9)->tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 504, __pyx_L1_error)
         }
-        __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_j);
-        __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_j, __pyx_t_13);
-        __Pyx_GIVEREF(__pyx_t_13);
-        __pyx_t_13 = 0;
-        __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_k);
-        __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_k, __pyx_t_11);
-        __Pyx_GIVEREF(__pyx_t_11);
-        __pyx_t_11 = 0;
-
-        /* "statmoments/_native.pyx":473
- *         for i in range(tr_len):
- *           j, k = _block_index(i, tr_len)
- *           if n0 >= min_cnt:             # <<<<<<<<<<<<<<
- *             m10 = 1.0/n0 * acc0[0, 1: 1 + tr_len]
- *             retm[0, jj, k] = calc_central_moments(raw0, m10, n0, lm, rm, i, j)
- */
-        __pyx_t_6 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_n0, __pyx_cur_scope->__pyx_v_min_cnt, Py_GE); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 473, __pyx_L1_error)
-        __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_19 < 0)) __PYX_ERR(0, 473, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        if (__pyx_t_19) {
+        for (;;) {
+          if (likely(!__pyx_t_16)) {
+            if (likely(PyList_CheckExact(__pyx_t_9))) {
+              if (__pyx_t_15 >= PyList_GET_SIZE(__pyx_t_9)) break;
+              #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+              __pyx_t_6 = PyList_GET_ITEM(__pyx_t_9, __pyx_t_15); __Pyx_INCREF(__pyx_t_6); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 504, __pyx_L1_error)
+              #else
+              __pyx_t_6 = PySequence_ITEM(__pyx_t_9, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 504, __pyx_L1_error)
+              __Pyx_GOTREF(__pyx_t_6);
+              #endif
+            } else {
+              if (__pyx_t_15 >= PyTuple_GET_SIZE(__pyx_t_9)) break;
+              #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+              __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_15); __Pyx_INCREF(__pyx_t_6); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 504, __pyx_L1_error)
+              #else
+              __pyx_t_6 = PySequence_ITEM(__pyx_t_9, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 504, __pyx_L1_error)
+              __Pyx_GOTREF(__pyx_t_6);
+              #endif
+            }
+          } else {
+            __pyx_t_6 = __pyx_t_16(__pyx_t_9);
+            if (unlikely(!__pyx_t_6)) {
+              PyObject* exc_type = PyErr_Occurred();
+              if (exc_type) {
+                if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
+                else __PYX_ERR(0, 504, __pyx_L1_error)
+              }
+              break;
+            }
+            __Pyx_GOTREF(__pyx_t_6);
+          }
+          __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_i);
+          __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_i, __pyx_t_6);
+          __Pyx_GIVEREF(__pyx_t_6);
+          __pyx_t_6 = 0;
 
-          /* "statmoments/_native.pyx":474
- *           j, k = _block_index(i, tr_len)
- *           if n0 >= min_cnt:
- *             m10 = 1.0/n0 * acc0[0, 1: 1 + tr_len]             # <<<<<<<<<<<<<<
- *             retm[0, jj, k] = calc_central_moments(raw0, m10, n0, lm, rm, i, j)
- *           else:
- */
-          __pyx_t_6 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_cur_scope->__pyx_v_n0, 1.0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 474, __pyx_L1_error)
+          /* "statmoments/_native.pyx":505
+ * 
+ *           for i in range(tr_len):
+ *             j, k = _block_index(i, tr_len)             # <<<<<<<<<<<<<<
+ *             if nn < min_cnt:
+ *               retm[_i, jj, k] = np.zeros(j.stop - j.start)
+ */
+          __pyx_t_17 = __Pyx_PyIndex_AsSsize_t(__pyx_cur_scope->__pyx_v_i); if (unlikely((__pyx_t_17 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 505, __pyx_L1_error)
+          __pyx_t_18 = __Pyx_PyIndex_AsSsize_t(__pyx_cur_scope->__pyx_v_tr_len); if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 505, __pyx_L1_error)
+          __pyx_t_6 = __pyx_f_11statmoments_7_native__block_index(__pyx_t_17, __pyx_t_18); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 505, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_11 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_cur_scope->__pyx_v_tr_len, 1, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 474, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_11);
-          __pyx_t_13 = PySlice_New(__pyx_int_1, __pyx_t_11, Py_None); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 474, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_13);
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __pyx_t_11 = PyTuple_New(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 474, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_11);
-          __Pyx_INCREF(__pyx_int_0);
-          __Pyx_GIVEREF(__pyx_int_0);
-          PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_int_0);
+          if ((likely(PyTuple_CheckExact(__pyx_t_6))) || (PyList_CheckExact(__pyx_t_6))) {
+            PyObject* sequence = __pyx_t_6;
+            Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
+            if (unlikely(size != 2)) {
+              if (size > 2) __Pyx_RaiseTooManyValuesError(2);
+              else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
+              __PYX_ERR(0, 505, __pyx_L1_error)
+            }
+            #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+            if (likely(PyTuple_CheckExact(sequence))) {
+              __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
+              __pyx_t_13 = PyTuple_GET_ITEM(sequence, 1); 
+            } else {
+              __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
+              __pyx_t_13 = PyList_GET_ITEM(sequence, 1); 
+            }
+            __Pyx_INCREF(__pyx_t_3);
+            __Pyx_INCREF(__pyx_t_13);
+            #else
+            __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 505, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_3);
+            __pyx_t_13 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 505, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_13);
+            #endif
+            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          } else {
+            Py_ssize_t index = -1;
+            __pyx_t_19 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 505, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_19);
+            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+            __pyx_t_8 = Py_TYPE(__pyx_t_19)->tp_iternext;
+            index = 0; __pyx_t_3 = __pyx_t_8(__pyx_t_19); if (unlikely(!__pyx_t_3)) goto __pyx_L16_unpacking_failed;
+            __Pyx_GOTREF(__pyx_t_3);
+            index = 1; __pyx_t_13 = __pyx_t_8(__pyx_t_19); if (unlikely(!__pyx_t_13)) goto __pyx_L16_unpacking_failed;
+            __Pyx_GOTREF(__pyx_t_13);
+            if (__Pyx_IternextUnpackEndCheck(__pyx_t_8(__pyx_t_19), 2) < 0) __PYX_ERR(0, 505, __pyx_L1_error)
+            __pyx_t_8 = NULL;
+            __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
+            goto __pyx_L17_unpacking_done;
+            __pyx_L16_unpacking_failed:;
+            __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
+            __pyx_t_8 = NULL;
+            if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
+            __PYX_ERR(0, 505, __pyx_L1_error)
+            __pyx_L17_unpacking_done:;
+          }
+          __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_j);
+          __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_j, __pyx_t_3);
+          __Pyx_GIVEREF(__pyx_t_3);
+          __pyx_t_3 = 0;
+          __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_k);
+          __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_k, __pyx_t_13);
           __Pyx_GIVEREF(__pyx_t_13);
-          PyTuple_SET_ITEM(__pyx_t_11, 1, __pyx_t_13);
           __pyx_t_13 = 0;
-          __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_acc0, __pyx_t_11); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 474, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_13);
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __pyx_t_11 = PyNumber_Multiply(__pyx_t_6, __pyx_t_13); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 474, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_11);
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_m10);
-          __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_m10, __pyx_t_11);
-          __Pyx_GIVEREF(__pyx_t_11);
-          __pyx_t_11 = 0;
-
-          /* "statmoments/_native.pyx":475
- *           if n0 >= min_cnt:
- *             m10 = 1.0/n0 * acc0[0, 1: 1 + tr_len]
- *             retm[0, jj, k] = calc_central_moments(raw0, m10, n0, lm, rm, i, j)             # <<<<<<<<<<<<<<
- *           else:
- *             retm[0, jj, k] = np.zeros(j.stop-j.start)
- */
-          __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_cur_scope->__pyx_v_n0); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 475, __pyx_L1_error)
-          __pyx_t_14 = __Pyx_PyInt_As_int(__pyx_cur_scope->__pyx_v_lm); if (unlikely((__pyx_t_14 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 475, __pyx_L1_error)
-          __pyx_t_21 = __Pyx_PyInt_As_int(__pyx_cur_scope->__pyx_v_rm); if (unlikely((__pyx_t_21 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 475, __pyx_L1_error)
-          __pyx_t_22 = __Pyx_PyInt_As_int(__pyx_cur_scope->__pyx_v_i); if (unlikely((__pyx_t_22 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 475, __pyx_L1_error)
-          __pyx_t_11 = __pyx_f_11statmoments_7_native_calc_central_moments(__pyx_cur_scope->__pyx_v_raw0, __pyx_cur_scope->__pyx_v_m10, __pyx_t_20, __pyx_t_14, __pyx_t_21, __pyx_t_22, __pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 475, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_11);
-          __pyx_t_13 = PyTuple_New(3); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 475, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_13);
-          __Pyx_INCREF(__pyx_int_0);
-          __Pyx_GIVEREF(__pyx_int_0);
-          PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_int_0);
-          __Pyx_INCREF(__pyx_cur_scope->__pyx_v_jj);
-          __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_jj);
-          PyTuple_SET_ITEM(__pyx_t_13, 1, __pyx_cur_scope->__pyx_v_jj);
-          __Pyx_INCREF(__pyx_cur_scope->__pyx_v_k);
-          __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_k);
-          PyTuple_SET_ITEM(__pyx_t_13, 2, __pyx_cur_scope->__pyx_v_k);
-          if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_13, __pyx_t_11) < 0)) __PYX_ERR(0, 475, __pyx_L1_error)
-          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-          /* "statmoments/_native.pyx":473
- *         for i in range(tr_len):
- *           j, k = _block_index(i, tr_len)
- *           if n0 >= min_cnt:             # <<<<<<<<<<<<<<
- *             m10 = 1.0/n0 * acc0[0, 1: 1 + tr_len]
- *             retm[0, jj, k] = calc_central_moments(raw0, m10, n0, lm, rm, i, j)
+          /* "statmoments/_native.pyx":506
+ *           for i in range(tr_len):
+ *             j, k = _block_index(i, tr_len)
+ *             if nn < min_cnt:             # <<<<<<<<<<<<<<
+ *               retm[_i, jj, k] = np.zeros(j.stop - j.start)
+ *               continue
  */
-          goto __pyx_L16;
-        }
+          __pyx_t_6 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_nn, __pyx_cur_scope->__pyx_v_min_cnt, Py_LT); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 506, __pyx_L1_error)
+          __pyx_t_20 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_20 < 0)) __PYX_ERR(0, 506, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          if (__pyx_t_20) {
 
-        /* "statmoments/_native.pyx":477
- *             retm[0, jj, k] = calc_central_moments(raw0, m10, n0, lm, rm, i, j)
- *           else:
- *             retm[0, jj, k] = np.zeros(j.stop-j.start)             # <<<<<<<<<<<<<<
+            /* "statmoments/_native.pyx":507
+ *             j, k = _block_index(i, tr_len)
+ *             if nn < min_cnt:
+ *               retm[_i, jj, k] = np.zeros(j.stop - j.start)             # <<<<<<<<<<<<<<
+ *               continue
  * 
- *           if n1 >= min_cnt:
  */
-        /*else*/ {
-          __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 477, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_13);
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 477, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_6);
-          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_j, __pyx_n_s_stop); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 477, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_13);
-          __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_j, __pyx_n_s_start); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 477, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_9);
-          __pyx_t_23 = PyNumber_Subtract(__pyx_t_13, __pyx_t_9); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 477, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_23);
-          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __pyx_t_9 = NULL;
-          if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
-            __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_6);
-            if (likely(__pyx_t_9)) {
-              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
-              __Pyx_INCREF(__pyx_t_9);
-              __Pyx_INCREF(function);
-              __Pyx_DECREF_SET(__pyx_t_6, function);
+            __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 507, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_13);
+            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 507, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_3);
+            __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+            __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_j, __pyx_n_s_stop); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 507, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_13);
+            __pyx_t_19 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_j, __pyx_n_s_start); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 507, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_19);
+            __pyx_t_21 = PyNumber_Subtract(__pyx_t_13, __pyx_t_19); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 507, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_21);
+            __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+            __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
+            __pyx_t_19 = NULL;
+            if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+              __pyx_t_19 = PyMethod_GET_SELF(__pyx_t_3);
+              if (likely(__pyx_t_19)) {
+                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+                __Pyx_INCREF(__pyx_t_19);
+                __Pyx_INCREF(function);
+                __Pyx_DECREF_SET(__pyx_t_3, function);
+              }
             }
-          }
-          __pyx_t_11 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_9, __pyx_t_23) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_23);
-          __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
-          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 477, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_11);
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 477, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_6);
-          __Pyx_INCREF(__pyx_int_0);
-          __Pyx_GIVEREF(__pyx_int_0);
-          PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_int_0);
-          __Pyx_INCREF(__pyx_cur_scope->__pyx_v_jj);
-          __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_jj);
-          PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_cur_scope->__pyx_v_jj);
-          __Pyx_INCREF(__pyx_cur_scope->__pyx_v_k);
-          __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_k);
-          PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_cur_scope->__pyx_v_k);
-          if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_6, __pyx_t_11) < 0)) __PYX_ERR(0, 477, __pyx_L1_error)
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        }
-        __pyx_L16:;
+            __pyx_t_6 = (__pyx_t_19) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_19, __pyx_t_21) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_21);
+            __Pyx_XDECREF(__pyx_t_19); __pyx_t_19 = 0;
+            __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
+            if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 507, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_6);
+            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+            __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 507, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_3);
+            __pyx_t_21 = PyTuple_New(3); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 507, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_21);
+            __Pyx_GIVEREF(__pyx_t_3);
+            PyTuple_SET_ITEM(__pyx_t_21, 0, __pyx_t_3);
+            __Pyx_INCREF(__pyx_cur_scope->__pyx_v_jj);
+            __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_jj);
+            PyTuple_SET_ITEM(__pyx_t_21, 1, __pyx_cur_scope->__pyx_v_jj);
+            __Pyx_INCREF(__pyx_cur_scope->__pyx_v_k);
+            __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_k);
+            PyTuple_SET_ITEM(__pyx_t_21, 2, __pyx_cur_scope->__pyx_v_k);
+            __pyx_t_3 = 0;
+            if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_21, __pyx_t_6) < 0)) __PYX_ERR(0, 507, __pyx_L1_error)
+            __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
+            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-        /* "statmoments/_native.pyx":479
- *             retm[0, jj, k] = np.zeros(j.stop-j.start)
- * 
- *           if n1 >= min_cnt:             # <<<<<<<<<<<<<<
- *             m11 = 1.0/n1 * acc1[0, 1: 1 + tr_len]
- *             retm[1, jj, k] = calc_central_moments(raw1, m11, n1, lm, rm, i, j)
+            /* "statmoments/_native.pyx":508
+ *             if nn < min_cnt:
+ *               retm[_i, jj, k] = np.zeros(j.stop - j.start)
+ *               continue             # <<<<<<<<<<<<<<
+ * 
+ *             m1 = 1.0 / nn * acc[0, 1: 1 + tr_len]
+ */
+            goto __pyx_L14_continue;
+
+            /* "statmoments/_native.pyx":506
+ *           for i in range(tr_len):
+ *             j, k = _block_index(i, tr_len)
+ *             if nn < min_cnt:             # <<<<<<<<<<<<<<
+ *               retm[_i, jj, k] = np.zeros(j.stop - j.start)
+ *               continue
  */
-        __pyx_t_11 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_n1, __pyx_cur_scope->__pyx_v_min_cnt, Py_GE); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 479, __pyx_L1_error)
-        __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_11); if (unlikely(__pyx_t_19 < 0)) __PYX_ERR(0, 479, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        if (__pyx_t_19) {
+          }
 
-          /* "statmoments/_native.pyx":480
+          /* "statmoments/_native.pyx":510
+ *               continue
+ * 
+ *             m1 = 1.0 / nn * acc[0, 1: 1 + tr_len]             # <<<<<<<<<<<<<<
+ *             retm[_i, jj, k] = calc_central_moments(raw, m1, nn, lm, rm, i, j)
  * 
- *           if n1 >= min_cnt:
- *             m11 = 1.0/n1 * acc1[0, 1: 1 + tr_len]             # <<<<<<<<<<<<<<
- *             retm[1, jj, k] = calc_central_moments(raw1, m11, n1, lm, rm, i, j)
- *           else:
  */
-          __pyx_t_11 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_cur_scope->__pyx_v_n1, 1.0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 480, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_11);
-          __pyx_t_6 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_cur_scope->__pyx_v_tr_len, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 480, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_23 = PySlice_New(__pyx_int_1, __pyx_t_6, Py_None); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 480, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_23);
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 480, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_cur_scope->__pyx_v_nn, 1.0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 510, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
+          __pyx_t_21 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_cur_scope->__pyx_v_tr_len, 1, 0, 0); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 510, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_21);
+          __pyx_t_3 = PySlice_New(__pyx_int_1, __pyx_t_21, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 510, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_3);
+          __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
+          __pyx_t_21 = PyTuple_New(2); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 510, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_21);
           __Pyx_INCREF(__pyx_int_0);
           __Pyx_GIVEREF(__pyx_int_0);
-          PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_int_0);
-          __Pyx_GIVEREF(__pyx_t_23);
-          PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_23);
-          __pyx_t_23 = 0;
-          __pyx_t_23 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_acc1, __pyx_t_6); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 480, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_23);
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __pyx_t_6 = PyNumber_Multiply(__pyx_t_11, __pyx_t_23); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 480, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_6);
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
-          __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_m11);
-          __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_m11, __pyx_t_6);
-          __Pyx_GIVEREF(__pyx_t_6);
-          __pyx_t_6 = 0;
-
-          /* "statmoments/_native.pyx":481
- *           if n1 >= min_cnt:
- *             m11 = 1.0/n1 * acc1[0, 1: 1 + tr_len]
- *             retm[1, jj, k] = calc_central_moments(raw1, m11, n1, lm, rm, i, j)             # <<<<<<<<<<<<<<
- *           else:
- *             retm[1, jj, k] = np.zeros(j.stop-j.start)
- */
-          __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_cur_scope->__pyx_v_n1); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 481, __pyx_L1_error)
-          __pyx_t_22 = __Pyx_PyInt_As_int(__pyx_cur_scope->__pyx_v_lm); if (unlikely((__pyx_t_22 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 481, __pyx_L1_error)
-          __pyx_t_21 = __Pyx_PyInt_As_int(__pyx_cur_scope->__pyx_v_rm); if (unlikely((__pyx_t_21 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 481, __pyx_L1_error)
-          __pyx_t_14 = __Pyx_PyInt_As_int(__pyx_cur_scope->__pyx_v_i); if (unlikely((__pyx_t_14 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 481, __pyx_L1_error)
-          __pyx_t_6 = __pyx_f_11statmoments_7_native_calc_central_moments(__pyx_cur_scope->__pyx_v_raw1, __pyx_cur_scope->__pyx_v_m11, __pyx_t_20, __pyx_t_22, __pyx_t_21, __pyx_t_14, __pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 481, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_23 = PyTuple_New(3); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 481, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_23);
-          __Pyx_INCREF(__pyx_int_1);
-          __Pyx_GIVEREF(__pyx_int_1);
-          PyTuple_SET_ITEM(__pyx_t_23, 0, __pyx_int_1);
-          __Pyx_INCREF(__pyx_cur_scope->__pyx_v_jj);
-          __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_jj);
-          PyTuple_SET_ITEM(__pyx_t_23, 1, __pyx_cur_scope->__pyx_v_jj);
-          __Pyx_INCREF(__pyx_cur_scope->__pyx_v_k);
-          __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_k);
-          PyTuple_SET_ITEM(__pyx_t_23, 2, __pyx_cur_scope->__pyx_v_k);
-          if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_23, __pyx_t_6) < 0)) __PYX_ERR(0, 481, __pyx_L1_error)
-          __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
+          PyTuple_SET_ITEM(__pyx_t_21, 0, __pyx_int_0);
+          __Pyx_GIVEREF(__pyx_t_3);
+          PyTuple_SET_ITEM(__pyx_t_21, 1, __pyx_t_3);
+          __pyx_t_3 = 0;
+          __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_acc, __pyx_t_21); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 510, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_3);
+          __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
+          __pyx_t_21 = PyNumber_Multiply(__pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 510, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_21);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_m1);
+          __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_m1, __pyx_t_21);
+          __Pyx_GIVEREF(__pyx_t_21);
+          __pyx_t_21 = 0;
 
-          /* "statmoments/_native.pyx":479
- *             retm[0, jj, k] = np.zeros(j.stop-j.start)
+          /* "statmoments/_native.pyx":511
  * 
- *           if n1 >= min_cnt:             # <<<<<<<<<<<<<<
- *             m11 = 1.0/n1 * acc1[0, 1: 1 + tr_len]
- *             retm[1, jj, k] = calc_central_moments(raw1, m11, n1, lm, rm, i, j)
- */
-          goto __pyx_L17;
-        }
-
-        /* "statmoments/_native.pyx":483
- *             retm[1, jj, k] = calc_central_moments(raw1, m11, n1, lm, rm, i, j)
- *           else:
- *             retm[1, jj, k] = np.zeros(j.stop-j.start)             # <<<<<<<<<<<<<<
+ *             m1 = 1.0 / nn * acc[0, 1: 1 + tr_len]
+ *             retm[_i, jj, k] = calc_central_moments(raw, m1, nn, lm, rm, i, j)             # <<<<<<<<<<<<<<
  * 
- *           if (lm + rm) >= 3 and normalize:
+ *             if (lm + rm) >= 3 and normalize:
  */
-        /*else*/ {
-          __Pyx_GetModuleGlobalName(__pyx_t_23, __pyx_n_s_np); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 483, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_23);
-          __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_23, __pyx_n_s_zeros); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 483, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_11);
-          __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
-          __pyx_t_23 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_j, __pyx_n_s_stop); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 483, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_23);
-          __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_j, __pyx_n_s_start); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 483, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_9);
-          __pyx_t_13 = PyNumber_Subtract(__pyx_t_23, __pyx_t_9); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 483, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_13);
-          __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
-          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __pyx_t_9 = NULL;
-          if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
-            __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_11);
-            if (likely(__pyx_t_9)) {
-              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
-              __Pyx_INCREF(__pyx_t_9);
-              __Pyx_INCREF(function);
-              __Pyx_DECREF_SET(__pyx_t_11, function);
-            }
-          }
-          __pyx_t_6 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_9, __pyx_t_13) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_13);
-          __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 483, __pyx_L1_error)
+          __pyx_t_22 = __pyx_PyFloat_AsDouble(__pyx_cur_scope->__pyx_v_nn); if (unlikely((__pyx_t_22 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 511, __pyx_L1_error)
+          __pyx_t_10 = __Pyx_PyInt_As_int(__pyx_cur_scope->__pyx_v_lm); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 511, __pyx_L1_error)
+          __pyx_t_23 = __Pyx_PyInt_As_int(__pyx_cur_scope->__pyx_v_rm); if (unlikely((__pyx_t_23 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 511, __pyx_L1_error)
+          __pyx_t_24 = __Pyx_PyInt_As_int(__pyx_cur_scope->__pyx_v_i); if (unlikely((__pyx_t_24 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 511, __pyx_L1_error)
+          __pyx_t_21 = __pyx_f_11statmoments_7_native_calc_central_moments(__pyx_cur_scope->__pyx_v_raw, __pyx_cur_scope->__pyx_v_m1, __pyx_t_22, __pyx_t_10, __pyx_t_23, __pyx_t_24, __pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 511, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_21);
+          __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 511, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_3);
+          __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 511, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __pyx_t_11 = PyTuple_New(3); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 483, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_11);
-          __Pyx_INCREF(__pyx_int_1);
-          __Pyx_GIVEREF(__pyx_int_1);
-          PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_int_1);
+          __Pyx_GIVEREF(__pyx_t_3);
+          PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
           __Pyx_INCREF(__pyx_cur_scope->__pyx_v_jj);
           __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_jj);
-          PyTuple_SET_ITEM(__pyx_t_11, 1, __pyx_cur_scope->__pyx_v_jj);
+          PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_cur_scope->__pyx_v_jj);
           __Pyx_INCREF(__pyx_cur_scope->__pyx_v_k);
           __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_k);
-          PyTuple_SET_ITEM(__pyx_t_11, 2, __pyx_cur_scope->__pyx_v_k);
-          if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_11, __pyx_t_6) < 0)) __PYX_ERR(0, 483, __pyx_L1_error)
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_cur_scope->__pyx_v_k);
+          __pyx_t_3 = 0;
+          if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_6, __pyx_t_21) < 0)) __PYX_ERR(0, 511, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        }
-        __pyx_L17:;
+          __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
 
-        /* "statmoments/_native.pyx":485
- *             retm[1, jj, k] = np.zeros(j.stop-j.start)
+          /* "statmoments/_native.pyx":513
+ *             retm[_i, jj, k] = calc_central_moments(raw, m1, nn, lm, rm, i, j)
  * 
- *           if (lm + rm) >= 3 and normalize:             # <<<<<<<<<<<<<<
- *             for _i in range(2):
- *               raw = raw0 if _i == 0 else raw1
+ *             if (lm + rm) >= 3 and normalize:             # <<<<<<<<<<<<<<
+ *               m2 = 1.0 / nn * raw[0, :, 0, :].diagonal()
+ *               m1 = 1.0 / nn * acc[0, 1: 1 + tr_len]
  */
-        __pyx_t_6 = PyNumber_Add(__pyx_cur_scope->__pyx_v_lm, __pyx_cur_scope->__pyx_v_rm); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 485, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_11 = PyObject_RichCompare(__pyx_t_6, __pyx_int_3, Py_GE); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 485, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_24 = __Pyx_PyObject_IsTrue(__pyx_t_11); if (unlikely(__pyx_t_24 < 0)) __PYX_ERR(0, 485, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        if (__pyx_t_24) {
-        } else {
-          __pyx_t_19 = __pyx_t_24;
-          goto __pyx_L19_bool_binop_done;
-        }
-        __pyx_t_24 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_normalize); if (unlikely(__pyx_t_24 < 0)) __PYX_ERR(0, 485, __pyx_L1_error)
-        __pyx_t_19 = __pyx_t_24;
-        __pyx_L19_bool_binop_done:;
-        if (__pyx_t_19) {
-
-          /* "statmoments/_native.pyx":486
- * 
- *           if (lm + rm) >= 3 and normalize:
- *             for _i in range(2):             # <<<<<<<<<<<<<<
- *               raw = raw0 if _i == 0 else raw1
- *               acc = acc0 if _i == 0 else acc1
- */
-          for (__pyx_t_25 = 0; __pyx_t_25 < 2; __pyx_t_25+=1) {
-            __pyx_cur_scope->__pyx_v__i = __pyx_t_25;
-
-            /* "statmoments/_native.pyx":487
- *           if (lm + rm) >= 3 and normalize:
- *             for _i in range(2):
- *               raw = raw0 if _i == 0 else raw1             # <<<<<<<<<<<<<<
- *               acc = acc0 if _i == 0 else acc1
- *               nn  = n0   if _i == 0 else n1
- */
-            if (((__pyx_cur_scope->__pyx_v__i == 0) != 0)) {
-              __Pyx_INCREF(__pyx_cur_scope->__pyx_v_raw0);
-              __pyx_t_11 = __pyx_cur_scope->__pyx_v_raw0;
-            } else {
-              __Pyx_INCREF(__pyx_cur_scope->__pyx_v_raw1);
-              __pyx_t_11 = __pyx_cur_scope->__pyx_v_raw1;
-            }
-            __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_raw);
-            __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_raw, __pyx_t_11);
-            __Pyx_GIVEREF(__pyx_t_11);
-            __pyx_t_11 = 0;
-
-            /* "statmoments/_native.pyx":488
- *             for _i in range(2):
- *               raw = raw0 if _i == 0 else raw1
- *               acc = acc0 if _i == 0 else acc1             # <<<<<<<<<<<<<<
- *               nn  = n0   if _i == 0 else n1
- *               m2 = 1.0/nn * raw[0,:,0,:].diagonal()
- */
-            if (((__pyx_cur_scope->__pyx_v__i == 0) != 0)) {
-              __Pyx_INCREF(__pyx_cur_scope->__pyx_v_acc0);
-              __pyx_t_11 = __pyx_cur_scope->__pyx_v_acc0;
-            } else {
-              __Pyx_INCREF(__pyx_cur_scope->__pyx_v_acc1);
-              __pyx_t_11 = __pyx_cur_scope->__pyx_v_acc1;
-            }
-            __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_acc);
-            __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_acc, __pyx_t_11);
-            __Pyx_GIVEREF(__pyx_t_11);
-            __pyx_t_11 = 0;
-
-            /* "statmoments/_native.pyx":489
- *               raw = raw0 if _i == 0 else raw1
- *               acc = acc0 if _i == 0 else acc1
- *               nn  = n0   if _i == 0 else n1             # <<<<<<<<<<<<<<
- *               m2 = 1.0/nn * raw[0,:,0,:].diagonal()
- *               m1 = 1.0/nn * acc[0, 1: 1 + tr_len]
- */
-            if (((__pyx_cur_scope->__pyx_v__i == 0) != 0)) {
-              __Pyx_INCREF(__pyx_cur_scope->__pyx_v_n0);
-              __pyx_t_11 = __pyx_cur_scope->__pyx_v_n0;
-            } else {
-              __Pyx_INCREF(__pyx_cur_scope->__pyx_v_n1);
-              __pyx_t_11 = __pyx_cur_scope->__pyx_v_n1;
-            }
-            __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_nn);
-            __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_nn, __pyx_t_11);
-            __Pyx_GIVEREF(__pyx_t_11);
-            __pyx_t_11 = 0;
-
-            /* "statmoments/_native.pyx":490
- *               acc = acc0 if _i == 0 else acc1
- *               nn  = n0   if _i == 0 else n1
- *               m2 = 1.0/nn * raw[0,:,0,:].diagonal()             # <<<<<<<<<<<<<<
- *               m1 = 1.0/nn * acc[0, 1: 1 + tr_len]
+          __pyx_t_21 = PyNumber_Add(__pyx_cur_scope->__pyx_v_lm, __pyx_cur_scope->__pyx_v_rm); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 513, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_21);
+          __pyx_t_6 = PyObject_RichCompare(__pyx_t_21, __pyx_int_3, Py_GE); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 513, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
+          __pyx_t_25 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_25 < 0)) __PYX_ERR(0, 513, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          if (__pyx_t_25) {
+          } else {
+            __pyx_t_20 = __pyx_t_25;
+            goto __pyx_L20_bool_binop_done;
+          }
+          __pyx_t_25 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_normalize); if (unlikely(__pyx_t_25 < 0)) __PYX_ERR(0, 513, __pyx_L1_error)
+          __pyx_t_20 = __pyx_t_25;
+          __pyx_L20_bool_binop_done:;
+          if (__pyx_t_20) {
+
+            /* "statmoments/_native.pyx":514
+ * 
+ *             if (lm + rm) >= 3 and normalize:
+ *               m2 = 1.0 / nn * raw[0, :, 0, :].diagonal()             # <<<<<<<<<<<<<<
+ *               m1 = 1.0 / nn * acc[0, 1: 1 + tr_len]
  *               sd = np.sqrt(m2 - m1 * m1)
  */
-            __pyx_t_11 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_cur_scope->__pyx_v_nn, 1.0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 490, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_11);
-            __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_raw, __pyx_tuple__6); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 490, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_13);
-            __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_diagonal); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 490, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_9);
-            __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-            __pyx_t_13 = NULL;
-            if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_9))) {
-              __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_9);
-              if (likely(__pyx_t_13)) {
-                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
-                __Pyx_INCREF(__pyx_t_13);
+            __pyx_t_6 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_cur_scope->__pyx_v_nn, 1.0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 514, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_6);
+            __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_raw, __pyx_tuple__8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 514, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_3);
+            __pyx_t_19 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_diagonal); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 514, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_19);
+            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+            __pyx_t_3 = NULL;
+            if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_19))) {
+              __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_19);
+              if (likely(__pyx_t_3)) {
+                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_19);
+                __Pyx_INCREF(__pyx_t_3);
                 __Pyx_INCREF(function);
-                __Pyx_DECREF_SET(__pyx_t_9, function);
+                __Pyx_DECREF_SET(__pyx_t_19, function);
               }
             }
-            __pyx_t_6 = (__pyx_t_13) ? __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_13) : __Pyx_PyObject_CallNoArg(__pyx_t_9);
-            __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
-            if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 490, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_6);
-            __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-            __pyx_t_9 = PyNumber_Multiply(__pyx_t_11, __pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 490, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_9);
-            __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+            __pyx_t_21 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_19, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_19);
+            __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+            if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 514, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_21);
+            __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
+            __pyx_t_19 = PyNumber_Multiply(__pyx_t_6, __pyx_t_21); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 514, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_19);
             __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+            __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
             __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_m2);
-            __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_m2, __pyx_t_9);
-            __Pyx_GIVEREF(__pyx_t_9);
-            __pyx_t_9 = 0;
-
-            /* "statmoments/_native.pyx":491
- *               nn  = n0   if _i == 0 else n1
- *               m2 = 1.0/nn * raw[0,:,0,:].diagonal()
- *               m1 = 1.0/nn * acc[0, 1: 1 + tr_len]             # <<<<<<<<<<<<<<
+            __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_m2, __pyx_t_19);
+            __Pyx_GIVEREF(__pyx_t_19);
+            __pyx_t_19 = 0;
+
+            /* "statmoments/_native.pyx":515
+ *             if (lm + rm) >= 3 and normalize:
+ *               m2 = 1.0 / nn * raw[0, :, 0, :].diagonal()
+ *               m1 = 1.0 / nn * acc[0, 1: 1 + tr_len]             # <<<<<<<<<<<<<<
  *               sd = np.sqrt(m2 - m1 * m1)
  *               retm[_i, jj, k] /= sd[i] ** lm * sd[j] ** rm
  */
-            __pyx_t_9 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_cur_scope->__pyx_v_nn, 1.0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 491, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_9);
-            __pyx_t_6 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_cur_scope->__pyx_v_tr_len, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 491, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_6);
-            __pyx_t_11 = PySlice_New(__pyx_int_1, __pyx_t_6, Py_None); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 491, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_11);
-            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-            __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 491, __pyx_L1_error)
+            __pyx_t_19 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_cur_scope->__pyx_v_nn, 1.0, 0, 1); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 515, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_19);
+            __pyx_t_21 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_cur_scope->__pyx_v_tr_len, 1, 0, 0); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 515, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_21);
+            __pyx_t_6 = PySlice_New(__pyx_int_1, __pyx_t_21, Py_None); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 515, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_6);
+            __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
+            __pyx_t_21 = PyTuple_New(2); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 515, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_21);
             __Pyx_INCREF(__pyx_int_0);
             __Pyx_GIVEREF(__pyx_int_0);
-            PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_int_0);
-            __Pyx_GIVEREF(__pyx_t_11);
-            PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_11);
-            __pyx_t_11 = 0;
-            __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_acc, __pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 491, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_11);
-            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-            __pyx_t_6 = PyNumber_Multiply(__pyx_t_9, __pyx_t_11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 491, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_6);
-            __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-            __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-            __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_m1);
-            __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_m1, __pyx_t_6);
+            PyTuple_SET_ITEM(__pyx_t_21, 0, __pyx_int_0);
             __Pyx_GIVEREF(__pyx_t_6);
+            PyTuple_SET_ITEM(__pyx_t_21, 1, __pyx_t_6);
             __pyx_t_6 = 0;
+            __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_acc, __pyx_t_21); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 515, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_6);
+            __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
+            __pyx_t_21 = PyNumber_Multiply(__pyx_t_19, __pyx_t_6); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 515, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_21);
+            __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
+            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+            __Pyx_GOTREF(__pyx_cur_scope->__pyx_v_m1);
+            __Pyx_DECREF_SET(__pyx_cur_scope->__pyx_v_m1, __pyx_t_21);
+            __Pyx_GIVEREF(__pyx_t_21);
+            __pyx_t_21 = 0;
 
-            /* "statmoments/_native.pyx":492
- *               m2 = 1.0/nn * raw[0,:,0,:].diagonal()
- *               m1 = 1.0/nn * acc[0, 1: 1 + tr_len]
+            /* "statmoments/_native.pyx":516
+ *               m2 = 1.0 / nn * raw[0, :, 0, :].diagonal()
+ *               m1 = 1.0 / nn * acc[0, 1: 1 + tr_len]
  *               sd = np.sqrt(m2 - m1 * m1)             # <<<<<<<<<<<<<<
  *               retm[_i, jj, k] /= sd[i] ** lm * sd[j] ** rm
  * 
  */
-            __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 492, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_11);
-            __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 492, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_9);
-            __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-            __pyx_t_11 = PyNumber_Multiply(__pyx_cur_scope->__pyx_v_m1, __pyx_cur_scope->__pyx_v_m1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 492, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_11);
-            __pyx_t_13 = PyNumber_Subtract(__pyx_cur_scope->__pyx_v_m2, __pyx_t_11); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 492, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_13);
-            __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-            __pyx_t_11 = NULL;
-            if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
-              __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_9);
-              if (likely(__pyx_t_11)) {
-                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
-                __Pyx_INCREF(__pyx_t_11);
+            __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 516, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_6);
+            __pyx_t_19 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 516, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_19);
+            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+            __pyx_t_6 = PyNumber_Multiply(__pyx_cur_scope->__pyx_v_m1, __pyx_cur_scope->__pyx_v_m1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 516, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_6);
+            __pyx_t_3 = PyNumber_Subtract(__pyx_cur_scope->__pyx_v_m2, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 516, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_3);
+            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+            __pyx_t_6 = NULL;
+            if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_19))) {
+              __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_19);
+              if (likely(__pyx_t_6)) {
+                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_19);
+                __Pyx_INCREF(__pyx_t_6);
                 __Pyx_INCREF(function);
-                __Pyx_DECREF_SET(__pyx_t_9, function);
+                __Pyx_DECREF_SET(__pyx_t_19, function);
               }
             }
-            __pyx_t_6 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_11, __pyx_t_13) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_13);
-            __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
-            __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-            if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 492, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_6);
-            __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+            __pyx_t_21 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_19, __pyx_t_6, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_19, __pyx_t_3);
+            __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+            if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 516, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_21);
+            __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
             __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_sd);
-            __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_sd, __pyx_t_6);
-            __Pyx_GIVEREF(__pyx_t_6);
-            __pyx_t_6 = 0;
+            __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_sd, __pyx_t_21);
+            __Pyx_GIVEREF(__pyx_t_21);
+            __pyx_t_21 = 0;
 
-            /* "statmoments/_native.pyx":493
- *               m1 = 1.0/nn * acc[0, 1: 1 + tr_len]
+            /* "statmoments/_native.pyx":517
+ *               m1 = 1.0 / nn * acc[0, 1: 1 + tr_len]
  *               sd = np.sqrt(m2 - m1 * m1)
  *               retm[_i, jj, k] /= sd[i] ** lm * sd[j] ** rm             # <<<<<<<<<<<<<<
  * 
  *       yield self._retm[:, :len(moments[0])]
  */
-            __pyx_t_6 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 493, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_6);
-            __pyx_t_9 = PyTuple_New(3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 493, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_9);
-            __Pyx_GIVEREF(__pyx_t_6);
-            PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_6);
+            __pyx_t_21 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 517, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_21);
+            __pyx_t_19 = PyTuple_New(3); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 517, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_19);
+            __Pyx_GIVEREF(__pyx_t_21);
+            PyTuple_SET_ITEM(__pyx_t_19, 0, __pyx_t_21);
             __Pyx_INCREF(__pyx_cur_scope->__pyx_v_jj);
             __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_jj);
-            PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_cur_scope->__pyx_v_jj);
+            PyTuple_SET_ITEM(__pyx_t_19, 1, __pyx_cur_scope->__pyx_v_jj);
             __Pyx_INCREF(__pyx_cur_scope->__pyx_v_k);
             __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_k);
-            PyTuple_SET_ITEM(__pyx_t_9, 2, __pyx_cur_scope->__pyx_v_k);
-            __pyx_t_6 = 0;
-            __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 493, __pyx_L1_error)
+            PyTuple_SET_ITEM(__pyx_t_19, 2, __pyx_cur_scope->__pyx_v_k);
+            __pyx_t_21 = 0;
+            __pyx_t_21 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_19); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 517, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_21);
+            __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_sd, __pyx_cur_scope->__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 517, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_3);
+            __pyx_t_6 = PyNumber_Power(__pyx_t_3, __pyx_cur_scope->__pyx_v_lm, Py_None); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 517, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_6);
-            __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_sd, __pyx_cur_scope->__pyx_v_i); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 493, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_13);
-            __pyx_t_11 = PyNumber_Power(__pyx_t_13, __pyx_cur_scope->__pyx_v_lm, Py_None); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 493, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_11);
-            __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-            __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_sd, __pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 493, __pyx_L1_error)
+            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+            __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_sd, __pyx_cur_scope->__pyx_v_j); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 517, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_3);
+            __pyx_t_13 = PyNumber_Power(__pyx_t_3, __pyx_cur_scope->__pyx_v_rm, Py_None); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 517, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_13);
-            __pyx_t_23 = PyNumber_Power(__pyx_t_13, __pyx_cur_scope->__pyx_v_rm, Py_None); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 493, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_23);
+            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+            __pyx_t_3 = PyNumber_Multiply(__pyx_t_6, __pyx_t_13); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 517, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_3);
+            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
             __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-            __pyx_t_13 = PyNumber_Multiply(__pyx_t_11, __pyx_t_23); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 493, __pyx_L1_error)
+            __pyx_t_13 = __Pyx_PyNumber_InPlaceDivide(__pyx_t_21, __pyx_t_3); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 517, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_13);
-            __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-            __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
-            __pyx_t_23 = __Pyx_PyNumber_InPlaceDivide(__pyx_t_6, __pyx_t_13); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 493, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_23);
-            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+            __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
+            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+            if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_19, __pyx_t_13) < 0)) __PYX_ERR(0, 517, __pyx_L1_error)
             __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-            if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_9, __pyx_t_23) < 0)) __PYX_ERR(0, 493, __pyx_L1_error)
-            __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
-            __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          }
+            __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
 
-          /* "statmoments/_native.pyx":485
- *             retm[1, jj, k] = np.zeros(j.stop-j.start)
+            /* "statmoments/_native.pyx":513
+ *             retm[_i, jj, k] = calc_central_moments(raw, m1, nn, lm, rm, i, j)
  * 
- *           if (lm + rm) >= 3 and normalize:             # <<<<<<<<<<<<<<
- *             for _i in range(2):
- *               raw = raw0 if _i == 0 else raw1
+ *             if (lm + rm) >= 3 and normalize:             # <<<<<<<<<<<<<<
+ *               m2 = 1.0 / nn * raw[0, :, 0, :].diagonal()
+ *               m1 = 1.0 / nn * acc[0, 1: 1 + tr_len]
  */
-        }
+          }
 
-        /* "statmoments/_native.pyx":471
- *         raw1 = acc1[1:acc1.shape[0]-0, 1:].reshape(ma, tr_len, ma, tr_len)
+          /* "statmoments/_native.pyx":504
+ *           nn = n0 if _i == 0 else n1
  * 
- *         for i in range(tr_len):             # <<<<<<<<<<<<<<
- *           j, k = _block_index(i, tr_len)
- *           if n0 >= min_cnt:
+ *           for i in range(tr_len):             # <<<<<<<<<<<<<<
+ *             j, k = _block_index(i, tr_len)
+ *             if nn < min_cnt:
  */
+          __pyx_L14_continue:;
+        }
+        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       }
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-      /* "statmoments/_native.pyx":459
- *     for ii in range(cl_len):
+      /* "statmoments/_native.pyx":498
+ * 
  *       # The left and the right degree of the product terms, e.g. xi^1 * xj^3
  *       for jj, (lm, rm) in enumerate(zip(*moments)):             # <<<<<<<<<<<<<<
- *         n0, n1 = self.counts(ii)
- *         acc0, acc1 = self._accs[ii], self._accs[ii, 1:].T
+ *         for _i in range(2):
+ *           raw = raw0 if _i == 0 else raw1
  */
     }
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-    /* "statmoments/_native.pyx":495
+    /* "statmoments/_native.pyx":519
  *               retm[_i, jj, k] /= sd[i] ** lm * sd[j] ** rm
  * 
  *       yield self._retm[:, :len(moments[0])]             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 495, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_moments, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 519, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_moments, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 495, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_7 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 495, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 495, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_10 = PySlice_New(Py_None, __pyx_t_3, Py_None); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 495, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_10);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 495, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_INCREF(__pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_slice__5);
-    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_t_10);
-    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_10);
-    __pyx_t_10 = 0;
-    __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 495, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_10);
+    __pyx_t_11 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_11 == ((Py_ssize_t)-1))) __PYX_ERR(0, 519, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_r = __pyx_t_10;
-    __pyx_t_10 = 0;
+    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_9 = PySlice_New(Py_None, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_INCREF(__pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_slice__7);
+    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_t_9);
+    PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_9);
+    __pyx_t_9 = 0;
+    __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_t_7, __pyx_t_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_r = __pyx_t_9;
+    __pyx_t_9 = 0;
     __Pyx_XGIVEREF(__pyx_t_2);
     __pyx_cur_scope->__pyx_t_0 = __pyx_t_2;
     __pyx_cur_scope->__pyx_t_1 = __pyx_t_4;
     __pyx_cur_scope->__pyx_t_2 = __pyx_t_5;
     __Pyx_XGIVEREF(__pyx_r);
     __Pyx_RefNannyFinishContext();
     __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
     /* return from generator, yielding value */
     __pyx_generator->resume_label = 1;
     return __pyx_r;
-    __pyx_L23_resume_from_yield:;
+    __pyx_L22_resume_from_yield:;
     __pyx_t_2 = __pyx_cur_scope->__pyx_t_0;
     __pyx_cur_scope->__pyx_t_0 = 0;
     __Pyx_XGOTREF(__pyx_t_2);
     __pyx_t_4 = __pyx_cur_scope->__pyx_t_1;
     __pyx_t_5 = __pyx_cur_scope->__pyx_t_2;
-    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 495, __pyx_L1_error)
+    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 519, __pyx_L1_error)
 
-    /* "statmoments/_native.pyx":457
+    /* "statmoments/_native.pyx":486
  *     ma, min_cnt = self.moment, self.acc_min_count
  * 
  *     for ii in range(cl_len):             # <<<<<<<<<<<<<<
- *       # The left and the right degree of the product terms, e.g. xi^1 * xj^3
- *       for jj, (lm, rm) in enumerate(zip(*moments)):
+ *       n0, n1 = self.counts(ii)
+ * 
  */
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
-  /* "statmoments/_native.pyx":452
+  /* "statmoments/_native.pyx":481
  *       yield cm[:, moments]
  * 
  *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     retm = self._retm
  *     tr_len, cl_len = self.trace_len, self._accs.shape[0]
  */
 
@@ -16148,32 +16374,32 @@
   PyErr_SetNone(PyExc_StopIteration);
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_9);
-  __Pyx_XDECREF(__pyx_t_10);
-  __Pyx_XDECREF(__pyx_t_11);
   __Pyx_XDECREF(__pyx_t_13);
-  __Pyx_XDECREF(__pyx_t_23);
+  __Pyx_XDECREF(__pyx_t_19);
+  __Pyx_XDECREF(__pyx_t_21);
   __Pyx_AddTraceback("_comoments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_r); __pyx_r = 0;
   #if !CYTHON_USE_EXC_INFO_STACK
   __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":499
+/* "statmoments/_native.pyx":523
  * 
  * class bivar_sum(_bivar_sum_base):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, acctype=np.float64, **kwargs)
  * 
  */
 
@@ -16214,40 +16440,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_trace_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 1); __PYX_ERR(0, 499, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 1); __PYX_ERR(0, 523, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifier_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 2); __PYX_ERR(0, 499, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 2); __PYX_ERR(0, 523, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 499, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 523, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_trace_len = values[1];
     __pyx_v_classifier_len = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 499, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 523, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
   __Pyx_AddTraceback("statmoments._native.bivar_sum.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_9bivar_sum___init__(__pyx_self, __pyx_v_self, __pyx_v_trace_len, __pyx_v_classifier_len, __pyx_v_kwargs);
@@ -16268,66 +16494,66 @@
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "statmoments/_native.pyx":500
+  /* "statmoments/_native.pyx":524
  * class bivar_sum(_bivar_sum_base):
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, acctype=np.float64, **kwargs)             # <<<<<<<<<<<<<<
  * 
- * class bivar_sum_mix(_bivar_sum_base):
+ * 
  */
   __pyx_t_1 = __Pyx_CyFunction_GetClassObj(__pyx_self);
-  if (!__pyx_t_1) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 500, __pyx_L1_error) }
+  if (!__pyx_t_1) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 524, __pyx_L1_error) }
   __Pyx_INCREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 500, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 524, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __Pyx_INCREF(__pyx_v_self);
   __Pyx_GIVEREF(__pyx_v_self);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_self);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 500, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 524, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_init); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 500, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_init); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 524, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 500, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 524, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_trace_len);
   __Pyx_GIVEREF(__pyx_v_trace_len);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_trace_len);
   __Pyx_INCREF(__pyx_v_classifier_len);
   __Pyx_GIVEREF(__pyx_v_classifier_len);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_classifier_len);
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 500, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 524, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 500, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 524, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 500, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 524, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_acctype, __pyx_t_6) < 0) __PYX_ERR(0, 500, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_acctype, __pyx_t_6) < 0) __PYX_ERR(0, 524, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_3 = __pyx_t_4;
   __pyx_t_4 = 0;
-  if (__Pyx_MergeKeywords(__pyx_t_3, __pyx_v_kwargs) < 0) __PYX_ERR(0, 500, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 500, __pyx_L1_error)
+  if (__Pyx_MergeKeywords(__pyx_t_3, __pyx_v_kwargs) < 0) __PYX_ERR(0, 524, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 524, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":499
+  /* "statmoments/_native.pyx":523
  * 
  * class bivar_sum(_bivar_sum_base):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, acctype=np.float64, **kwargs)
  * 
  */
 
@@ -16345,15 +16571,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":503
+/* "statmoments/_native.pyx":528
  * 
  * class bivar_sum_mix(_bivar_sum_base):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, acctype=np.float32, **kwargs)
  * 
  */
 
@@ -16394,40 +16620,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_trace_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 1); __PYX_ERR(0, 503, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 1); __PYX_ERR(0, 528, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifier_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 2); __PYX_ERR(0, 503, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 2); __PYX_ERR(0, 528, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 503, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 528, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_trace_len = values[1];
     __pyx_v_classifier_len = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 503, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 528, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
   __Pyx_AddTraceback("statmoments._native.bivar_sum_mix.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_13bivar_sum_mix___init__(__pyx_self, __pyx_v_self, __pyx_v_trace_len, __pyx_v_classifier_len, __pyx_v_kwargs);
@@ -16448,66 +16674,66 @@
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "statmoments/_native.pyx":504
+  /* "statmoments/_native.pyx":529
  * class bivar_sum_mix(_bivar_sum_base):
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, acctype=np.float32, **kwargs)             # <<<<<<<<<<<<<<
  * 
- * class bivar_sum_detrend(_bivar_sum_base):
+ * 
  */
   __pyx_t_1 = __Pyx_CyFunction_GetClassObj(__pyx_self);
-  if (!__pyx_t_1) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 504, __pyx_L1_error) }
+  if (!__pyx_t_1) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 529, __pyx_L1_error) }
   __Pyx_INCREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 504, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 529, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __Pyx_INCREF(__pyx_v_self);
   __Pyx_GIVEREF(__pyx_v_self);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_self);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 504, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 529, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_init); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 504, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_init); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 529, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 504, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 529, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_trace_len);
   __Pyx_GIVEREF(__pyx_v_trace_len);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_trace_len);
   __Pyx_INCREF(__pyx_v_classifier_len);
   __Pyx_GIVEREF(__pyx_v_classifier_len);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_classifier_len);
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 504, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 529, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 504, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 529, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float32); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 504, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float32); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 529, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_acctype, __pyx_t_6) < 0) __PYX_ERR(0, 504, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_acctype, __pyx_t_6) < 0) __PYX_ERR(0, 529, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_3 = __pyx_t_4;
   __pyx_t_4 = 0;
-  if (__Pyx_MergeKeywords(__pyx_t_3, __pyx_v_kwargs) < 0) __PYX_ERR(0, 504, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 504, __pyx_L1_error)
+  if (__Pyx_MergeKeywords(__pyx_t_3, __pyx_v_kwargs) < 0) __PYX_ERR(0, 529, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 529, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":503
+  /* "statmoments/_native.pyx":528
  * 
  * class bivar_sum_mix(_bivar_sum_base):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, acctype=np.float32, **kwargs)
  * 
  */
 
@@ -16525,15 +16751,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":507
+/* "statmoments/_native.pyx":533
  * 
  * class bivar_sum_detrend(_bivar_sum_base):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  *     self._dbuf = np.zeros((1, self.trace_len), dtype=self._dtype)[1:]
  */
 
@@ -16574,40 +16800,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_trace_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 1); __PYX_ERR(0, 507, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 1); __PYX_ERR(0, 533, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifier_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 2); __PYX_ERR(0, 507, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 2); __PYX_ERR(0, 533, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 507, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 533, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_trace_len = values[1];
     __pyx_v_classifier_len = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 507, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 533, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
   __Pyx_AddTraceback("statmoments._native.bivar_sum_detrend.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_17bivar_sum_detrend___init__(__pyx_self, __pyx_v_self, __pyx_v_trace_len, __pyx_v_classifier_len, __pyx_v_kwargs);
@@ -16627,159 +16853,159 @@
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "statmoments/_native.pyx":508
+  /* "statmoments/_native.pyx":534
  * class bivar_sum_detrend(_bivar_sum_base):
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, **kwargs)             # <<<<<<<<<<<<<<
  *     self._dbuf = np.zeros((1, self.trace_len), dtype=self._dtype)[1:]
- *     self._cbuf = np.asarray([bytearray(b'2') * classifier_len], dtype=np.uint8)[1:] # 2 is non existing element
+ *     self._cbuf = np.asarray([bytearray(b'2') * classifier_len], dtype=np.uint8)[1:]  # 2 is non existing element
  */
   __pyx_t_1 = __Pyx_CyFunction_GetClassObj(__pyx_self);
-  if (!__pyx_t_1) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 508, __pyx_L1_error) }
+  if (!__pyx_t_1) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 534, __pyx_L1_error) }
   __Pyx_INCREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 534, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __Pyx_INCREF(__pyx_v_self);
   __Pyx_GIVEREF(__pyx_v_self);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_self);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 534, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_init); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_init); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 534, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 534, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_trace_len);
   __Pyx_GIVEREF(__pyx_v_trace_len);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_trace_len);
   __Pyx_INCREF(__pyx_v_classifier_len);
   __Pyx_GIVEREF(__pyx_v_classifier_len);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_classifier_len);
-  __pyx_t_3 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __pyx_t_3 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 534, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 534, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":509
+  /* "statmoments/_native.pyx":535
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, **kwargs)
  *     self._dbuf = np.zeros((1, self.trace_len), dtype=self._dtype)[1:]             # <<<<<<<<<<<<<<
- *     self._cbuf = np.asarray([bytearray(b'2') * classifier_len], dtype=np.uint8)[1:] # 2 is non existing element
+ *     self._cbuf = np.asarray([bytearray(b'2') * classifier_len], dtype=np.uint8)[1:]  # 2 is non existing element
  *     self._detrend_cnt = kwargs.pop('detrend_cnt', 10)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 535, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 535, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 535, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 535, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_int_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 535, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 535, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 535, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 509, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 535, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 535, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_t_2, 1, 0, NULL, NULL, &__pyx_slice__17, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_t_2, 1, 0, NULL, NULL, &__pyx_slice__19, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 535, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_dbuf, __pyx_t_1) < 0) __PYX_ERR(0, 509, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_dbuf, __pyx_t_1) < 0) __PYX_ERR(0, 535, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":510
+  /* "statmoments/_native.pyx":536
  *     super().__init__(trace_len, classifier_len, **kwargs)
  *     self._dbuf = np.zeros((1, self.trace_len), dtype=self._dtype)[1:]
- *     self._cbuf = np.asarray([bytearray(b'2') * classifier_len], dtype=np.uint8)[1:] # 2 is non existing element             # <<<<<<<<<<<<<<
+ *     self._cbuf = np.asarray([bytearray(b'2') * classifier_len], dtype=np.uint8)[1:]  # 2 is non existing element             # <<<<<<<<<<<<<<
  *     self._detrend_cnt = kwargs.pop('detrend_cnt', 10)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 510, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_asarray); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 510, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_asarray); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)(&PyByteArray_Type)), __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 510, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)(&PyByteArray_Type)), __pyx_tuple__27, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_v_classifier_len); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 510, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_v_classifier_len); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 510, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 510, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 510, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 510, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 510, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 510, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 510, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_t_5, 1, 0, NULL, NULL, &__pyx_slice__17, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 510, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_t_5, 1, 0, NULL, NULL, &__pyx_slice__19, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_cbuf, __pyx_t_1) < 0) __PYX_ERR(0, 510, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_cbuf, __pyx_t_1) < 0) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":511
+  /* "statmoments/_native.pyx":537
  *     self._dbuf = np.zeros((1, self.trace_len), dtype=self._dtype)[1:]
- *     self._cbuf = np.asarray([bytearray(b'2') * classifier_len], dtype=np.uint8)[1:] # 2 is non existing element
+ *     self._cbuf = np.asarray([bytearray(b'2') * classifier_len], dtype=np.uint8)[1:]  # 2 is non existing element
  *     self._detrend_cnt = kwargs.pop('detrend_cnt', 10)             # <<<<<<<<<<<<<<
  * 
  *   def update(self, traces, classifiers):
  */
-  __pyx_t_1 = __Pyx_PyDict_Pop(__pyx_v_kwargs, __pyx_n_u_detrend_cnt, __pyx_int_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 511, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_Pop(__pyx_v_kwargs, __pyx_n_u_detrend_cnt, __pyx_int_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 537, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2, __pyx_t_1) < 0) __PYX_ERR(0, 511, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2, __pyx_t_1) < 0) __PYX_ERR(0, 537, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":507
+  /* "statmoments/_native.pyx":533
  * 
  * class bivar_sum_detrend(_bivar_sum_base):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  *     self._dbuf = np.zeros((1, self.trace_len), dtype=self._dtype)[1:]
  */
 
@@ -16796,15 +17022,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":513
+/* "statmoments/_native.pyx":539
  *     self._detrend_cnt = kwargs.pop('detrend_cnt', 10)
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     tr_copy = np.asarray(traces, dtype=self._dtype)
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  */
 
@@ -16842,40 +17068,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_traces)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 1); __PYX_ERR(0, 513, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 1); __PYX_ERR(0, 539, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifiers)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 2); __PYX_ERR(0, 513, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 2); __PYX_ERR(0, 539, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update") < 0)) __PYX_ERR(0, 513, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update") < 0)) __PYX_ERR(0, 539, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_traces = values[1];
     __pyx_v_classifiers = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 513, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 539, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native.bivar_sum_detrend.update", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_17bivar_sum_detrend_2update(__pyx_self, __pyx_v_self, __pyx_v_traces, __pyx_v_classifiers);
 
@@ -16900,139 +17126,139 @@
   Py_ssize_t __pyx_t_7;
   int __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("update", 0);
 
-  /* "statmoments/_native.pyx":514
+  /* "statmoments/_native.pyx":540
  * 
  *   def update(self, traces, classifiers):
  *     tr_copy = np.asarray(traces, dtype=self._dtype)             # <<<<<<<<<<<<<<
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 514, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 540, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_asarray); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 514, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_asarray); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 540, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 514, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 540, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_traces);
   __Pyx_GIVEREF(__pyx_v_traces);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_traces);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 514, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 540, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 514, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 540, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 514, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 540, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 514, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 540, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_tr_copy = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":515
+  /* "statmoments/_native.pyx":541
  *   def update(self, traces, classifiers):
  *     tr_copy = np.asarray(traces, dtype=self._dtype)
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)             # <<<<<<<<<<<<<<
  * 
  *     if self._detrend_cnt > 0:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 515, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 541, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_asarray); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 515, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_asarray); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 541, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 515, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 541, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_v_classifiers);
   __Pyx_GIVEREF(__pyx_v_classifiers);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_classifiers);
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 515, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 541, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 515, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 541, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 515, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 541, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 515, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 541, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 515, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 541, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_cl_copy = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":517
+  /* "statmoments/_native.pyx":543
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  * 
  *     if self._detrend_cnt > 0:             # <<<<<<<<<<<<<<
  *       db_part = tr_copy[:self._detrend_cnt]
  *       cl_part = cl_copy[:self._detrend_cnt]
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 517, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 543, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = PyObject_RichCompare(__pyx_t_5, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 517, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(__pyx_t_5, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 543, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 517, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 543, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_6) {
 
-    /* "statmoments/_native.pyx":518
+    /* "statmoments/_native.pyx":544
  * 
  *     if self._detrend_cnt > 0:
  *       db_part = tr_copy[:self._detrend_cnt]             # <<<<<<<<<<<<<<
  *       cl_part = cl_copy[:self._detrend_cnt]
  *       self._dbuf = np.vstack((self._dbuf, db_part))
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 518, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 544, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_v_tr_copy, 0, 0, NULL, &__pyx_t_1, NULL, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 518, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_v_tr_copy, 0, 0, NULL, &__pyx_t_1, NULL, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 544, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_v_db_part = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "statmoments/_native.pyx":519
+    /* "statmoments/_native.pyx":545
  *     if self._detrend_cnt > 0:
  *       db_part = tr_copy[:self._detrend_cnt]
  *       cl_part = cl_copy[:self._detrend_cnt]             # <<<<<<<<<<<<<<
  *       self._dbuf = np.vstack((self._dbuf, db_part))
  *       self._cbuf = np.vstack((self._cbuf, cl_part))
  */
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 545, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_cl_copy, 0, 0, NULL, &__pyx_t_5, NULL, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_cl_copy, 0, 0, NULL, &__pyx_t_5, NULL, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 545, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_v_cl_part = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":520
+    /* "statmoments/_native.pyx":546
  *       db_part = tr_copy[:self._detrend_cnt]
  *       cl_part = cl_copy[:self._detrend_cnt]
  *       self._dbuf = np.vstack((self._dbuf, db_part))             # <<<<<<<<<<<<<<
  *       self._cbuf = np.vstack((self._cbuf, cl_part))
  *       self._detrend_cnt -= len(db_part)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 520, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 546, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_vstack); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 520, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_vstack); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 546, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 520, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 546, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 520, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 546, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
     __Pyx_INCREF(__pyx_v_db_part);
     __Pyx_GIVEREF(__pyx_v_db_part);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_db_part);
     __pyx_t_5 = 0;
@@ -17045,35 +17271,35 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 520, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 546, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_dbuf, __pyx_t_1) < 0) __PYX_ERR(0, 520, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_dbuf, __pyx_t_1) < 0) __PYX_ERR(0, 546, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":521
+    /* "statmoments/_native.pyx":547
  *       cl_part = cl_copy[:self._detrend_cnt]
  *       self._dbuf = np.vstack((self._dbuf, db_part))
  *       self._cbuf = np.vstack((self._cbuf, cl_part))             # <<<<<<<<<<<<<<
  *       self._detrend_cnt -= len(db_part)
  *       if self._detrend_cnt > 0:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 521, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 547, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_vstack); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 521, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_vstack); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 547, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cbuf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 521, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cbuf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 547, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 521, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 547, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
     __Pyx_INCREF(__pyx_v_cl_part);
     __Pyx_GIVEREF(__pyx_v_cl_part);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_cl_part);
     __pyx_t_4 = 0;
@@ -17086,108 +17312,108 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 521, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 547, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_cbuf, __pyx_t_1) < 0) __PYX_ERR(0, 521, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_cbuf, __pyx_t_1) < 0) __PYX_ERR(0, 547, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":522
+    /* "statmoments/_native.pyx":548
  *       self._dbuf = np.vstack((self._dbuf, db_part))
  *       self._cbuf = np.vstack((self._cbuf, cl_part))
  *       self._detrend_cnt -= len(db_part)             # <<<<<<<<<<<<<<
  *       if self._detrend_cnt > 0:
- *         return # Not enough input data for detrending
+ *         return  # Not enough input data for detrending
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 522, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 548, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = PyObject_Length(__pyx_v_db_part); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 522, __pyx_L1_error)
-    __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 522, __pyx_L1_error)
+    __pyx_t_7 = PyObject_Length(__pyx_v_db_part); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 548, __pyx_L1_error)
+    __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 548, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_5 = PyNumber_InPlaceSubtract(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 522, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_InPlaceSubtract(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 548, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2, __pyx_t_5) < 0) __PYX_ERR(0, 522, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2, __pyx_t_5) < 0) __PYX_ERR(0, 548, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "statmoments/_native.pyx":523
+    /* "statmoments/_native.pyx":549
  *       self._cbuf = np.vstack((self._cbuf, cl_part))
  *       self._detrend_cnt -= len(db_part)
  *       if self._detrend_cnt > 0:             # <<<<<<<<<<<<<<
- *         return # Not enough input data for detrending
+ *         return  # Not enough input data for detrending
  *       if self._detrend_cnt == 0:
  */
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 523, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 549, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = PyObject_RichCompare(__pyx_t_5, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 523, __pyx_L1_error)
+    __pyx_t_3 = PyObject_RichCompare(__pyx_t_5, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 549, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 523, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 549, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_6) {
 
-      /* "statmoments/_native.pyx":524
+      /* "statmoments/_native.pyx":550
  *       self._detrend_cnt -= len(db_part)
  *       if self._detrend_cnt > 0:
- *         return # Not enough input data for detrending             # <<<<<<<<<<<<<<
+ *         return  # Not enough input data for detrending             # <<<<<<<<<<<<<<
  *       if self._detrend_cnt == 0:
  *         tr_copy = np.vstack((self._dbuf, tr_copy[len(db_part):]))
  */
       __Pyx_XDECREF(__pyx_r);
       __pyx_r = Py_None; __Pyx_INCREF(Py_None);
       goto __pyx_L0;
 
-      /* "statmoments/_native.pyx":523
+      /* "statmoments/_native.pyx":549
  *       self._cbuf = np.vstack((self._cbuf, cl_part))
  *       self._detrend_cnt -= len(db_part)
  *       if self._detrend_cnt > 0:             # <<<<<<<<<<<<<<
- *         return # Not enough input data for detrending
+ *         return  # Not enough input data for detrending
  *       if self._detrend_cnt == 0:
  */
     }
 
-    /* "statmoments/_native.pyx":525
+    /* "statmoments/_native.pyx":551
  *       if self._detrend_cnt > 0:
- *         return # Not enough input data for detrending
+ *         return  # Not enough input data for detrending
  *       if self._detrend_cnt == 0:             # <<<<<<<<<<<<<<
  *         tr_copy = np.vstack((self._dbuf, tr_copy[len(db_part):]))
  *         cl_copy = np.vstack((self._cbuf, cl_copy[len(cl_part):]))
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 525, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 551, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_t_3, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 525, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_t_3, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 551, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 525, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 551, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     if (__pyx_t_6) {
 
-      /* "statmoments/_native.pyx":526
- *         return # Not enough input data for detrending
+      /* "statmoments/_native.pyx":552
+ *         return  # Not enough input data for detrending
  *       if self._detrend_cnt == 0:
  *         tr_copy = np.vstack((self._dbuf, tr_copy[len(db_part):]))             # <<<<<<<<<<<<<<
  *         cl_copy = np.vstack((self._cbuf, cl_copy[len(cl_part):]))
  *         self._dbuf = np.mean(self._dbuf, axis=0)
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 526, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 552, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_vstack); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 526, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_vstack); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 552, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 526, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 552, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_7 = PyObject_Length(__pyx_v_db_part); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 526, __pyx_L1_error)
-      __pyx_t_4 = __Pyx_PyObject_GetSlice(__pyx_v_tr_copy, __pyx_t_7, 0, NULL, NULL, NULL, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 526, __pyx_L1_error)
+      __pyx_t_7 = PyObject_Length(__pyx_v_db_part); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 552, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetSlice(__pyx_v_tr_copy, __pyx_t_7, 0, NULL, NULL, NULL, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 552, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 526, __pyx_L1_error)
+      __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 552, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_GIVEREF(__pyx_t_3);
       PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
       __Pyx_GIVEREF(__pyx_t_4);
       PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_4);
       __pyx_t_3 = 0;
       __pyx_t_4 = 0;
@@ -17200,38 +17426,38 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
       __pyx_t_5 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_2);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 526, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 552, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF_SET(__pyx_v_tr_copy, __pyx_t_5);
       __pyx_t_5 = 0;
 
-      /* "statmoments/_native.pyx":527
+      /* "statmoments/_native.pyx":553
  *       if self._detrend_cnt == 0:
  *         tr_copy = np.vstack((self._dbuf, tr_copy[len(db_part):]))
  *         cl_copy = np.vstack((self._cbuf, cl_copy[len(cl_part):]))             # <<<<<<<<<<<<<<
  *         self._dbuf = np.mean(self._dbuf, axis=0)
  *         self._cbuf = None
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 527, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 553, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_vstack); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 527, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_vstack); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 553, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cbuf); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 527, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cbuf); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 553, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_7 = PyObject_Length(__pyx_v_cl_part); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 527, __pyx_L1_error)
-      __pyx_t_4 = __Pyx_PyObject_GetSlice(__pyx_v_cl_copy, __pyx_t_7, 0, NULL, NULL, NULL, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 527, __pyx_L1_error)
+      __pyx_t_7 = PyObject_Length(__pyx_v_cl_part); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 553, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetSlice(__pyx_v_cl_copy, __pyx_t_7, 0, NULL, NULL, NULL, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 553, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 527, __pyx_L1_error)
+      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 553, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_GIVEREF(__pyx_t_1);
       PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
       __Pyx_GIVEREF(__pyx_t_4);
       PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
       __pyx_t_1 = 0;
       __pyx_t_4 = 0;
@@ -17244,104 +17470,104 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_2, function);
         }
       }
       __pyx_t_5 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 527, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 553, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF_SET(__pyx_v_cl_copy, __pyx_t_5);
       __pyx_t_5 = 0;
 
-      /* "statmoments/_native.pyx":528
+      /* "statmoments/_native.pyx":554
  *         tr_copy = np.vstack((self._dbuf, tr_copy[len(db_part):]))
  *         cl_copy = np.vstack((self._cbuf, cl_copy[len(cl_part):]))
  *         self._dbuf = np.mean(self._dbuf, axis=0)             # <<<<<<<<<<<<<<
  *         self._cbuf = None
- *     super().update(tr_copy-self._dbuf, cl_copy)
+ *     super().update(tr_copy - self._dbuf, cl_copy)
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 528, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 554, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_mean); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 528, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_mean); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 554, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 528, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 554, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 528, __pyx_L1_error)
+      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 554, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_GIVEREF(__pyx_t_5);
       PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
       __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 528, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 554, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 528, __pyx_L1_error)
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 528, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 554, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 554, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_dbuf, __pyx_t_4) < 0) __PYX_ERR(0, 528, __pyx_L1_error)
+      if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_dbuf, __pyx_t_4) < 0) __PYX_ERR(0, 554, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "statmoments/_native.pyx":529
+      /* "statmoments/_native.pyx":555
  *         cl_copy = np.vstack((self._cbuf, cl_copy[len(cl_part):]))
  *         self._dbuf = np.mean(self._dbuf, axis=0)
  *         self._cbuf = None             # <<<<<<<<<<<<<<
- *     super().update(tr_copy-self._dbuf, cl_copy)
+ *     super().update(tr_copy - self._dbuf, cl_copy)
  * 
  */
-      if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_cbuf, Py_None) < 0) __PYX_ERR(0, 529, __pyx_L1_error)
+      if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_cbuf, Py_None) < 0) __PYX_ERR(0, 555, __pyx_L1_error)
 
-      /* "statmoments/_native.pyx":525
+      /* "statmoments/_native.pyx":551
  *       if self._detrend_cnt > 0:
- *         return # Not enough input data for detrending
+ *         return  # Not enough input data for detrending
  *       if self._detrend_cnt == 0:             # <<<<<<<<<<<<<<
  *         tr_copy = np.vstack((self._dbuf, tr_copy[len(db_part):]))
  *         cl_copy = np.vstack((self._cbuf, cl_copy[len(cl_part):]))
  */
     }
 
-    /* "statmoments/_native.pyx":517
+    /* "statmoments/_native.pyx":543
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  * 
  *     if self._detrend_cnt > 0:             # <<<<<<<<<<<<<<
  *       db_part = tr_copy[:self._detrend_cnt]
  *       cl_part = cl_copy[:self._detrend_cnt]
  */
   }
 
-  /* "statmoments/_native.pyx":530
+  /* "statmoments/_native.pyx":556
  *         self._dbuf = np.mean(self._dbuf, axis=0)
  *         self._cbuf = None
- *     super().update(tr_copy-self._dbuf, cl_copy)             # <<<<<<<<<<<<<<
+ *     super().update(tr_copy - self._dbuf, cl_copy)             # <<<<<<<<<<<<<<
  * 
  *   def _moments(self, moments, normalize):
  */
   __pyx_t_5 = __Pyx_CyFunction_GetClassObj(__pyx_self);
-  if (!__pyx_t_5) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 530, __pyx_L1_error) }
+  if (!__pyx_t_5) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 556, __pyx_L1_error) }
   __Pyx_INCREF(__pyx_t_5);
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 530, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 556, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
   __Pyx_INCREF(__pyx_v_self);
   __Pyx_GIVEREF(__pyx_v_self);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_self);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 530, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 556, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_update); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 530, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_update); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 556, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 530, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 556, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_2 = PyNumber_Subtract(__pyx_v_tr_copy, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 530, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Subtract(__pyx_v_tr_copy, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 556, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   __pyx_t_8 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
@@ -17351,49 +17577,49 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_8 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_2, __pyx_v_cl_copy};
-    __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 530, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 556, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_2, __pyx_v_cl_copy};
-    __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 530, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 556, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else
   #endif
   {
-    __pyx_t_1 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 530, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 556, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     if (__pyx_t_5) {
       __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5); __pyx_t_5 = NULL;
     }
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_8, __pyx_t_2);
     __Pyx_INCREF(__pyx_v_cl_copy);
     __Pyx_GIVEREF(__pyx_v_cl_copy);
     PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_8, __pyx_v_cl_copy);
     __pyx_t_2 = 0;
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 530, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 556, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":513
+  /* "statmoments/_native.pyx":539
  *     self._detrend_cnt = kwargs.pop('detrend_cnt', 10)
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     tr_copy = np.asarray(traces, dtype=self._dtype)
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  */
 
@@ -17415,16 +17641,16 @@
   __Pyx_XDECREF(__pyx_v_cl_part);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static PyObject *__pyx_gb_11statmoments_7_native_17bivar_sum_detrend_6generator2(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "statmoments/_native.pyx":532
- *     super().update(tr_copy-self._dbuf, cl_copy)
+/* "statmoments/_native.pyx":558
+ *     super().update(tr_copy - self._dbuf, cl_copy)
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     m1idx = [i for i, m in enumerate(moments) if m == 1]
  *     has_m1 = len(m1idx) != 0
  */
 
 /* Python wrapper */
@@ -17461,40 +17687,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moments)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 1); __PYX_ERR(0, 532, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 1); __PYX_ERR(0, 558, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_normalize)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 2); __PYX_ERR(0, 532, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 2); __PYX_ERR(0, 558, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_moments") < 0)) __PYX_ERR(0, 532, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_moments") < 0)) __PYX_ERR(0, 558, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_moments = values[1];
     __pyx_v_normalize = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 532, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 558, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native.bivar_sum_detrend._moments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_17bivar_sum_detrend_4_moments(__pyx_self, __pyx_v_self, __pyx_v_moments, __pyx_v_normalize);
 
@@ -17511,29 +17737,29 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_moments", 0);
   __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_4__moments *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_4__moments(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_4__moments, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_4__moments *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 532, __pyx_L1_error)
+    __PYX_ERR(0, 558, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
   __pyx_cur_scope->__pyx_v_moments = __pyx_v_moments;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_moments);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_moments);
   __pyx_cur_scope->__pyx_v_normalize = __pyx_v_normalize;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_normalize);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_normalize);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_17bivar_sum_detrend_6generator2, __pyx_codeobj__27, (PyObject *) __pyx_cur_scope, __pyx_n_s_moments_2, __pyx_n_s_bivar_sum_detrend__moments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 532, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_17bivar_sum_detrend_6generator2, __pyx_codeobj__28, (PyObject *) __pyx_cur_scope, __pyx_n_s_moments_2, __pyx_n_s_bivar_sum_detrend__moments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 558, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     gen->classobj = __Pyx_CyFunction_GetClassObj(__pyx_self);
     __Pyx_INCREF(gen->classobj);
     __Pyx_GIVEREF(gen->classobj);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
@@ -17556,145 +17782,168 @@
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   Py_ssize_t __pyx_t_4;
   PyObject *(*__pyx_t_5)(PyObject *);
   PyObject *__pyx_t_6 = NULL;
   int __pyx_t_7;
   int __pyx_t_8;
-  PyObject *__pyx_t_9 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("_moments", 0);
   switch (__pyx_generator->resume_label) {
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L10_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 532, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 558, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":533
+  /* "statmoments/_native.pyx":559
  * 
  *   def _moments(self, moments, normalize):
  *     m1idx = [i for i, m in enumerate(moments) if m == 1]             # <<<<<<<<<<<<<<
  *     has_m1 = len(m1idx) != 0
- *     for res in super()._moments(moments, normalize):
+ *     dbuf = self._dbuf if len(self._dbuf) > 0 else 0
  */
   { /* enter inner scope */
-    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 533, __pyx_L1_error)
+    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 559, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_int_0);
     __pyx_t_2 = __pyx_int_0;
     if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_v_moments)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_moments)) {
       __pyx_t_3 = __pyx_cur_scope->__pyx_v_moments; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
       __pyx_t_5 = NULL;
     } else {
-      __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 533, __pyx_L1_error)
+      __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 559, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 533, __pyx_L1_error)
+      __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 559, __pyx_L1_error)
     }
     for (;;) {
       if (likely(!__pyx_t_5)) {
         if (likely(PyList_CheckExact(__pyx_t_3))) {
           if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_6 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_6); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 533, __pyx_L1_error)
+          __pyx_t_6 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_6); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 559, __pyx_L1_error)
           #else
-          __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 533, __pyx_L1_error)
+          __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 559, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           #endif
         } else {
           if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_6); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 533, __pyx_L1_error)
+          __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_6); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 559, __pyx_L1_error)
           #else
-          __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 533, __pyx_L1_error)
+          __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 559, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           #endif
         }
       } else {
         __pyx_t_6 = __pyx_t_5(__pyx_t_3);
         if (unlikely(!__pyx_t_6)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 533, __pyx_L1_error)
+            else __PYX_ERR(0, 559, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_6);
       }
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_8genexpr2__pyx_v_m);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_8genexpr2__pyx_v_m, __pyx_t_6);
       __Pyx_GIVEREF(__pyx_t_6);
       __pyx_t_6 = 0;
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_8genexpr2__pyx_v_i);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_8genexpr2__pyx_v_i, __pyx_t_2);
       __Pyx_GIVEREF(__pyx_t_2);
-      __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 533, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 559, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_6;
       __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyInt_EqObjC(__pyx_cur_scope->__pyx_8genexpr2__pyx_v_m, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 533, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_EqObjC(__pyx_cur_scope->__pyx_8genexpr2__pyx_v_m, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 559, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 533, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 559, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       if (__pyx_t_7) {
-        if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_cur_scope->__pyx_8genexpr2__pyx_v_i))) __PYX_ERR(0, 533, __pyx_L1_error)
+        if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_cur_scope->__pyx_8genexpr2__pyx_v_i))) __PYX_ERR(0, 559, __pyx_L1_error)
       }
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } /* exit inner scope */
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v_m1idx = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":534
+  /* "statmoments/_native.pyx":560
  *   def _moments(self, moments, normalize):
  *     m1idx = [i for i, m in enumerate(moments) if m == 1]
  *     has_m1 = len(m1idx) != 0             # <<<<<<<<<<<<<<
+ *     dbuf = self._dbuf if len(self._dbuf) > 0 else 0
  *     for res in super()._moments(moments, normalize):
- *       if has_m1:
  */
-  __pyx_t_4 = PyList_GET_SIZE(__pyx_cur_scope->__pyx_v_m1idx); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 534, __pyx_L1_error)
-  __pyx_t_1 = __Pyx_PyBool_FromLong((__pyx_t_4 != 0)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 534, __pyx_L1_error)
+  __pyx_t_4 = PyList_GET_SIZE(__pyx_cur_scope->__pyx_v_m1idx); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 560, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyBool_FromLong((__pyx_t_4 != 0)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 560, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v_has_m1 = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":535
+  /* "statmoments/_native.pyx":561
  *     m1idx = [i for i, m in enumerate(moments) if m == 1]
  *     has_m1 = len(m1idx) != 0
+ *     dbuf = self._dbuf if len(self._dbuf) > 0 else 0             # <<<<<<<<<<<<<<
+ *     for res in super()._moments(moments, normalize):
+ *       if has_m1:
+ */
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 561, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_4 = PyObject_Length(__pyx_t_2); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 561, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (((__pyx_t_4 > 0) != 0)) {
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 561, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_1 = __pyx_t_2;
+    __pyx_t_2 = 0;
+  } else {
+    __Pyx_INCREF(__pyx_int_0);
+    __pyx_t_1 = __pyx_int_0;
+  }
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_cur_scope->__pyx_v_dbuf = __pyx_t_1;
+  __pyx_t_1 = 0;
+
+  /* "statmoments/_native.pyx":562
+ *     has_m1 = len(m1idx) != 0
+ *     dbuf = self._dbuf if len(self._dbuf) > 0 else 0
  *     for res in super()._moments(moments, normalize):             # <<<<<<<<<<<<<<
  *       if has_m1:
  *         # Restore offset if mean requested
  */
   __pyx_t_2 =  __pyx_generator->classobj;
-  if (!__pyx_t_2) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 535, __pyx_L1_error) }
+  if (!__pyx_t_2) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 562, __pyx_L1_error) }
   __Pyx_INCREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 535, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 562, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_cur_scope->__pyx_v_self);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 535, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 562, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_moments_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 535, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_moments_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 562, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_8 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
@@ -17704,138 +17953,135 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_8 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_cur_scope->__pyx_v_moments, __pyx_cur_scope->__pyx_v_normalize};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 535, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 562, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_cur_scope->__pyx_v_moments, __pyx_cur_scope->__pyx_v_normalize};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 535, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 562, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   {
-    __pyx_t_6 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 535, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 562, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     if (__pyx_t_2) {
       __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_2); __pyx_t_2 = NULL;
     }
     __Pyx_INCREF(__pyx_cur_scope->__pyx_v_moments);
     __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_moments);
     PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_8, __pyx_cur_scope->__pyx_v_moments);
     __Pyx_INCREF(__pyx_cur_scope->__pyx_v_normalize);
     __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_normalize);
     PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_8, __pyx_cur_scope->__pyx_v_normalize);
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 535, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 562, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
     __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
     __pyx_t_5 = NULL;
   } else {
-    __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 535, __pyx_L1_error)
+    __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 562, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 535, __pyx_L1_error)
+    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 562, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_5)) {
       if (likely(PyList_CheckExact(__pyx_t_3))) {
         if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 535, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 562, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 535, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 562, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 535, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 562, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 535, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 562, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
       __pyx_t_1 = __pyx_t_5(__pyx_t_3);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 535, __pyx_L1_error)
+          else __PYX_ERR(0, 562, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_res);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_res, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":536
- *     has_m1 = len(m1idx) != 0
+    /* "statmoments/_native.pyx":563
+ *     dbuf = self._dbuf if len(self._dbuf) > 0 else 0
  *     for res in super()._moments(moments, normalize):
  *       if has_m1:             # <<<<<<<<<<<<<<
  *         # Restore offset if mean requested
- *         res[:, m1idx] += self._dbuf
+ *         res[:, m1idx] += dbuf
  */
-    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_has_m1); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 536, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_has_m1); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 563, __pyx_L1_error)
     if (__pyx_t_7) {
 
-      /* "statmoments/_native.pyx":538
+      /* "statmoments/_native.pyx":565
  *       if has_m1:
  *         # Restore offset if mean requested
- *         res[:, m1idx] += self._dbuf             # <<<<<<<<<<<<<<
+ *         res[:, m1idx] += dbuf             # <<<<<<<<<<<<<<
  *       yield res
  * 
  */
-      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 538, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 565, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_INCREF(__pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_slice__5);
-      PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_slice__5);
+      __Pyx_INCREF(__pyx_slice__7);
+      __Pyx_GIVEREF(__pyx_slice__7);
+      PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_slice__7);
       __Pyx_INCREF(__pyx_cur_scope->__pyx_v_m1idx);
       __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_m1idx);
       PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_cur_scope->__pyx_v_m1idx);
-      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_res, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 538, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_res, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 565, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 538, __pyx_L1_error)
+      __pyx_t_2 = PyNumber_InPlaceAdd(__pyx_t_6, __pyx_cur_scope->__pyx_v_dbuf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 565, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_9 = PyNumber_InPlaceAdd(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 538, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_res, __pyx_t_1, __pyx_t_2) < 0)) __PYX_ERR(0, 565, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_res, __pyx_t_1, __pyx_t_9) < 0)) __PYX_ERR(0, 538, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "statmoments/_native.pyx":536
- *     has_m1 = len(m1idx) != 0
+      /* "statmoments/_native.pyx":563
+ *     dbuf = self._dbuf if len(self._dbuf) > 0 else 0
  *     for res in super()._moments(moments, normalize):
  *       if has_m1:             # <<<<<<<<<<<<<<
  *         # Restore offset if mean requested
- *         res[:, m1idx] += self._dbuf
+ *         res[:, m1idx] += dbuf
  */
     }
 
-    /* "statmoments/_native.pyx":539
+    /* "statmoments/_native.pyx":566
  *         # Restore offset if mean requested
- *         res[:, m1idx] += self._dbuf
+ *         res[:, m1idx] += dbuf
  *       yield res             # <<<<<<<<<<<<<<
  * 
  * 
  */
     __Pyx_INCREF(__pyx_cur_scope->__pyx_v_res);
     __pyx_r = __pyx_cur_scope->__pyx_v_res;
     __Pyx_XGIVEREF(__pyx_t_3);
@@ -17850,79 +18096,78 @@
     return __pyx_r;
     __pyx_L10_resume_from_yield:;
     __pyx_t_3 = __pyx_cur_scope->__pyx_t_0;
     __pyx_cur_scope->__pyx_t_0 = 0;
     __Pyx_XGOTREF(__pyx_t_3);
     __pyx_t_4 = __pyx_cur_scope->__pyx_t_1;
     __pyx_t_5 = __pyx_cur_scope->__pyx_t_2;
-    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 539, __pyx_L1_error)
+    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 566, __pyx_L1_error)
 
-    /* "statmoments/_native.pyx":535
- *     m1idx = [i for i, m in enumerate(moments) if m == 1]
+    /* "statmoments/_native.pyx":562
  *     has_m1 = len(m1idx) != 0
+ *     dbuf = self._dbuf if len(self._dbuf) > 0 else 0
  *     for res in super()._moments(moments, normalize):             # <<<<<<<<<<<<<<
  *       if has_m1:
  *         # Restore offset if mean requested
  */
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
-  /* "statmoments/_native.pyx":532
- *     super().update(tr_copy-self._dbuf, cl_copy)
+  /* "statmoments/_native.pyx":558
+ *     super().update(tr_copy - self._dbuf, cl_copy)
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     m1idx = [i for i, m in enumerate(moments) if m == 1]
  *     has_m1 = len(m1idx) != 0
  */
 
   /* function exit code */
   PyErr_SetNone(PyExc_StopIteration);
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_6);
-  __Pyx_XDECREF(__pyx_t_9);
   __Pyx_AddTraceback("_moments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_r); __pyx_r = 0;
   #if !CYTHON_USE_EXC_INFO_STACK
   __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":542
+/* "statmoments/_native.pyx":569
  * 
  * 
  * def _triuflatten_gen(n):             # <<<<<<<<<<<<<<
  *   _ndx = np.triu_indices_from(np.empty((n, n)))
  *   def _triu(tr2d):
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11statmoments_7_native_5_triuflatten_gen(PyObject *__pyx_self, PyObject *__pyx_v_n); /*proto*/
-static PyMethodDef __pyx_mdef_11statmoments_7_native_5_triuflatten_gen = {"_triuflatten_gen", (PyCFunction)__pyx_pw_11statmoments_7_native_5_triuflatten_gen, METH_O, 0};
-static PyObject *__pyx_pw_11statmoments_7_native_5_triuflatten_gen(PyObject *__pyx_self, PyObject *__pyx_v_n) {
+static PyObject *__pyx_pw_11statmoments_7_native_7_triuflatten_gen(PyObject *__pyx_self, PyObject *__pyx_v_n); /*proto*/
+static PyMethodDef __pyx_mdef_11statmoments_7_native_7_triuflatten_gen = {"_triuflatten_gen", (PyCFunction)__pyx_pw_11statmoments_7_native_7_triuflatten_gen, METH_O, 0};
+static PyObject *__pyx_pw_11statmoments_7_native_7_triuflatten_gen(PyObject *__pyx_self, PyObject *__pyx_v_n) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("_triuflatten_gen (wrapper)", 0);
-  __pyx_r = __pyx_pf_11statmoments_7_native_4_triuflatten_gen(__pyx_self, ((PyObject *)__pyx_v_n));
+  __pyx_r = __pyx_pf_11statmoments_7_native_6_triuflatten_gen(__pyx_self, ((PyObject *)__pyx_v_n));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":544
+/* "statmoments/_native.pyx":571
  * def _triuflatten_gen(n):
  *   _ndx = np.triu_indices_from(np.empty((n, n)))
  *   def _triu(tr2d):             # <<<<<<<<<<<<<<
  *     return tr2d[_ndx]
  *   return _triu
  */
 
@@ -17949,30 +18194,30 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_triu", 0);
   __pyx_outer_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_5__triuflatten_gen *) __Pyx_CyFunction_GetClosure(__pyx_self);
   __pyx_cur_scope = __pyx_outer_scope;
 
-  /* "statmoments/_native.pyx":545
+  /* "statmoments/_native.pyx":572
  *   _ndx = np.triu_indices_from(np.empty((n, n)))
  *   def _triu(tr2d):
  *     return tr2d[_ndx]             # <<<<<<<<<<<<<<
  *   return _triu
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  if (unlikely(!__pyx_cur_scope->__pyx_v__ndx)) { __Pyx_RaiseClosureNameError("_ndx"); __PYX_ERR(0, 545, __pyx_L1_error) }
-  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_tr2d, __pyx_cur_scope->__pyx_v__ndx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 545, __pyx_L1_error)
+  if (unlikely(!__pyx_cur_scope->__pyx_v__ndx)) { __Pyx_RaiseClosureNameError("_ndx"); __PYX_ERR(0, 572, __pyx_L1_error) }
+  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_tr2d, __pyx_cur_scope->__pyx_v__ndx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 572, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":544
+  /* "statmoments/_native.pyx":571
  * def _triuflatten_gen(n):
  *   _ndx = np.triu_indices_from(np.empty((n, n)))
  *   def _triu(tr2d):             # <<<<<<<<<<<<<<
  *     return tr2d[_ndx]
  *   return _triu
  */
 
@@ -17983,23 +18228,23 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":542
+/* "statmoments/_native.pyx":569
  * 
  * 
  * def _triuflatten_gen(n):             # <<<<<<<<<<<<<<
  *   _ndx = np.triu_indices_from(np.empty((n, n)))
  *   def _triu(tr2d):
  */
 
-static PyObject *__pyx_pf_11statmoments_7_native_4_triuflatten_gen(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_n) {
+static PyObject *__pyx_pf_11statmoments_7_native_6_triuflatten_gen(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_n) {
   struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_5__triuflatten_gen *__pyx_cur_scope;
   PyObject *__pyx_v__triu = 0;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
@@ -18010,37 +18255,37 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_triuflatten_gen", 0);
   __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_5__triuflatten_gen *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_5__triuflatten_gen(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_5__triuflatten_gen, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_5__triuflatten_gen *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 542, __pyx_L1_error)
+    __PYX_ERR(0, 569, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
 
-  /* "statmoments/_native.pyx":543
+  /* "statmoments/_native.pyx":570
  * 
  * def _triuflatten_gen(n):
  *   _ndx = np.triu_indices_from(np.empty((n, n)))             # <<<<<<<<<<<<<<
  *   def _triu(tr2d):
  *     return tr2d[_ndx]
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 543, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 570, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_triu_indices_from); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 543, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_triu_indices_from); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 570, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 543, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 570, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_empty); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 543, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_empty); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 570, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 543, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 570, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_v_n);
   __Pyx_GIVEREF(__pyx_v_n);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_n);
   __Pyx_INCREF(__pyx_v_n);
   __Pyx_GIVEREF(__pyx_v_n);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_n);
@@ -18053,15 +18298,15 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_2 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 543, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 570, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -18069,46 +18314,46 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 543, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 570, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v__ndx = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":544
+  /* "statmoments/_native.pyx":571
  * def _triuflatten_gen(n):
  *   _ndx = np.triu_indices_from(np.empty((n, n)))
  *   def _triu(tr2d):             # <<<<<<<<<<<<<<
  *     return tr2d[_ndx]
  *   return _triu
  */
-  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_16_triuflatten_gen_1_triu, 0, __pyx_n_s_triuflatten_gen_locals__triu, ((PyObject*)__pyx_cur_scope), __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__29)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 544, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_16_triuflatten_gen_1_triu, 0, __pyx_n_s_triuflatten_gen_locals__triu, ((PyObject*)__pyx_cur_scope), __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__30)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 571, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v__triu = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":546
+  /* "statmoments/_native.pyx":573
  *   def _triu(tr2d):
  *     return tr2d[_ndx]
  *   return _triu             # <<<<<<<<<<<<<<
  * 
  * def _compute_by_rows(tr_len, f):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v__triu);
   __pyx_r = __pyx_v__triu;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":542
+  /* "statmoments/_native.pyx":569
  * 
  * 
  * def _triuflatten_gen(n):             # <<<<<<<<<<<<<<
  *   _ndx = np.triu_indices_from(np.empty((n, n)))
  *   def _triu(tr2d):
  */
 
@@ -18126,26 +18371,26 @@
   __Pyx_XDECREF(__pyx_v__triu);
   __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":548
+/* "statmoments/_native.pyx":575
  *   return _triu
  * 
  * def _compute_by_rows(tr_len, f):             # <<<<<<<<<<<<<<
  *   # Compute by rows upper triangle part of matrix from function f
  *   # This function is required for optimized memory consumption
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11statmoments_7_native_7_compute_by_rows(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_11statmoments_7_native_7_compute_by_rows = {"_compute_by_rows", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_7_compute_by_rows, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11statmoments_7_native_7_compute_by_rows(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_11statmoments_7_native_9_compute_by_rows(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_11statmoments_7_native_9_compute_by_rows = {"_compute_by_rows", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_9_compute_by_rows, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11statmoments_7_native_9_compute_by_rows(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_tr_len = 0;
   PyObject *__pyx_v_f = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
@@ -18169,45 +18414,45 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr_len)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_f)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_compute_by_rows", 1, 2, 2, 1); __PYX_ERR(0, 548, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_compute_by_rows", 1, 2, 2, 1); __PYX_ERR(0, 575, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_compute_by_rows") < 0)) __PYX_ERR(0, 548, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_compute_by_rows") < 0)) __PYX_ERR(0, 575, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_tr_len = values[0];
     __pyx_v_f = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_compute_by_rows", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 548, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_compute_by_rows", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 575, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native._compute_by_rows", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11statmoments_7_native_6_compute_by_rows(__pyx_self, __pyx_v_tr_len, __pyx_v_f);
+  __pyx_r = __pyx_pf_11statmoments_7_native_8_compute_by_rows(__pyx_self, __pyx_v_tr_len, __pyx_v_f);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11statmoments_7_native_6_compute_by_rows(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tr_len, PyObject *__pyx_v_f) {
+static PyObject *__pyx_pf_11statmoments_7_native_8_compute_by_rows(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tr_len, PyObject *__pyx_v_f) {
   PyObject *__pyx_v_com = NULL;
   PyObject *__pyx_v_i = NULL;
   PyObject *__pyx_v_j = NULL;
   PyObject *__pyx_v_k = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
@@ -18222,171 +18467,171 @@
   PyObject *(*__pyx_t_10)(PyObject *);
   int __pyx_t_11;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_compute_by_rows", 0);
 
-  /* "statmoments/_native.pyx":551
+  /* "statmoments/_native.pyx":578
  *   # Compute by rows upper triangle part of matrix from function f
  *   # This function is required for optimized memory consumption
  *   com = np.empty(tr_len * (tr_len + 1) // 2, dtype=np.float64)             # <<<<<<<<<<<<<<
  *   for i in range(tr_len):
  *     j, k = _block_index(i, tr_len)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 551, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 578, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 551, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 578, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_v_tr_len, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 551, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_v_tr_len, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 578, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_v_tr_len, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 551, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_v_tr_len, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 578, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_3, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 551, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_3, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 578, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 551, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 578, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 551, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 578, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 551, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 578, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 551, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 578, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 551, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 578, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 551, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 578, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_com = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":552
+  /* "statmoments/_native.pyx":579
  *   # This function is required for optimized memory consumption
  *   com = np.empty(tr_len * (tr_len + 1) // 2, dtype=np.float64)
  *   for i in range(tr_len):             # <<<<<<<<<<<<<<
  *     j, k = _block_index(i, tr_len)
  *     com[k] = f(i, j)
  */
-  __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_v_tr_len); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 552, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_v_tr_len); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 579, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
     __pyx_t_1 = __pyx_t_5; __Pyx_INCREF(__pyx_t_1); __pyx_t_6 = 0;
     __pyx_t_7 = NULL;
   } else {
-    __pyx_t_6 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 552, __pyx_L1_error)
+    __pyx_t_6 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 579, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 552, __pyx_L1_error)
+    __pyx_t_7 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 579, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   for (;;) {
     if (likely(!__pyx_t_7)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_6); __Pyx_INCREF(__pyx_t_5); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 552, __pyx_L1_error)
+        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_6); __Pyx_INCREF(__pyx_t_5); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 579, __pyx_L1_error)
         #else
-        __pyx_t_5 = PySequence_ITEM(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 552, __pyx_L1_error)
+        __pyx_t_5 = PySequence_ITEM(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 579, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         #endif
       } else {
         if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_6); __Pyx_INCREF(__pyx_t_5); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 552, __pyx_L1_error)
+        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_6); __Pyx_INCREF(__pyx_t_5); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 579, __pyx_L1_error)
         #else
-        __pyx_t_5 = PySequence_ITEM(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 552, __pyx_L1_error)
+        __pyx_t_5 = PySequence_ITEM(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 579, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         #endif
       }
     } else {
       __pyx_t_5 = __pyx_t_7(__pyx_t_1);
       if (unlikely(!__pyx_t_5)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 552, __pyx_L1_error)
+          else __PYX_ERR(0, 579, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_5);
     }
     __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
     __pyx_t_5 = 0;
 
-    /* "statmoments/_native.pyx":553
+    /* "statmoments/_native.pyx":580
  *   com = np.empty(tr_len * (tr_len + 1) // 2, dtype=np.float64)
  *   for i in range(tr_len):
  *     j, k = _block_index(i, tr_len)             # <<<<<<<<<<<<<<
  *     com[k] = f(i, j)
  *   return com
  */
-    __pyx_t_8 = __Pyx_PyIndex_AsSsize_t(__pyx_v_i); if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 553, __pyx_L1_error)
-    __pyx_t_9 = __Pyx_PyIndex_AsSsize_t(__pyx_v_tr_len); if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 553, __pyx_L1_error)
-    __pyx_t_5 = __pyx_f_11statmoments_7_native__block_index(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 553, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyIndex_AsSsize_t(__pyx_v_i); if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 580, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyIndex_AsSsize_t(__pyx_v_tr_len); if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 580, __pyx_L1_error)
+    __pyx_t_5 = __pyx_f_11statmoments_7_native__block_index(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 580, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     if ((likely(PyTuple_CheckExact(__pyx_t_5))) || (PyList_CheckExact(__pyx_t_5))) {
       PyObject* sequence = __pyx_t_5;
       Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
       if (unlikely(size != 2)) {
         if (size > 2) __Pyx_RaiseTooManyValuesError(2);
         else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-        __PYX_ERR(0, 553, __pyx_L1_error)
+        __PYX_ERR(0, 580, __pyx_L1_error)
       }
       #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
       if (likely(PyTuple_CheckExact(sequence))) {
         __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
         __pyx_t_2 = PyTuple_GET_ITEM(sequence, 1); 
       } else {
         __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
         __pyx_t_2 = PyList_GET_ITEM(sequence, 1); 
       }
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       #else
-      __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 553, __pyx_L1_error)
+      __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 580, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 553, __pyx_L1_error)
+      __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 580, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       #endif
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     } else {
       Py_ssize_t index = -1;
-      __pyx_t_4 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 553, __pyx_L1_error)
+      __pyx_t_4 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 580, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_t_10 = Py_TYPE(__pyx_t_4)->tp_iternext;
       index = 0; __pyx_t_3 = __pyx_t_10(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L5_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_3);
       index = 1; __pyx_t_2 = __pyx_t_10(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L5_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_2);
-      if (__Pyx_IternextUnpackEndCheck(__pyx_t_10(__pyx_t_4), 2) < 0) __PYX_ERR(0, 553, __pyx_L1_error)
+      if (__Pyx_IternextUnpackEndCheck(__pyx_t_10(__pyx_t_4), 2) < 0) __PYX_ERR(0, 580, __pyx_L1_error)
       __pyx_t_10 = NULL;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       goto __pyx_L6_unpacking_done;
       __pyx_L5_unpacking_failed:;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_10 = NULL;
       if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-      __PYX_ERR(0, 553, __pyx_L1_error)
+      __PYX_ERR(0, 580, __pyx_L1_error)
       __pyx_L6_unpacking_done:;
     }
     __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_3);
     __pyx_t_3 = 0;
     __Pyx_XDECREF_SET(__pyx_v_k, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "statmoments/_native.pyx":554
+    /* "statmoments/_native.pyx":581
  *   for i in range(tr_len):
  *     j, k = _block_index(i, tr_len)
  *     com[k] = f(i, j)             # <<<<<<<<<<<<<<
  *   return com
  * 
  */
     __Pyx_INCREF(__pyx_v_f);
@@ -18401,70 +18646,70 @@
         __Pyx_DECREF_SET(__pyx_t_2, function);
         __pyx_t_11 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_i, __pyx_v_j};
-      __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 554, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 581, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_GOTREF(__pyx_t_5);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_i, __pyx_v_j};
-      __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 554, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 581, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_GOTREF(__pyx_t_5);
     } else
     #endif
     {
-      __pyx_t_4 = PyTuple_New(2+__pyx_t_11); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 554, __pyx_L1_error)
+      __pyx_t_4 = PyTuple_New(2+__pyx_t_11); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 581, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       if (__pyx_t_3) {
         __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
       }
       __Pyx_INCREF(__pyx_v_i);
       __Pyx_GIVEREF(__pyx_v_i);
       PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_11, __pyx_v_i);
       __Pyx_INCREF(__pyx_v_j);
       __Pyx_GIVEREF(__pyx_v_j);
       PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_11, __pyx_v_j);
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 554, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 581, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(PyObject_SetItem(__pyx_v_com, __pyx_v_k, __pyx_t_5) < 0)) __PYX_ERR(0, 554, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_v_com, __pyx_v_k, __pyx_t_5) < 0)) __PYX_ERR(0, 581, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "statmoments/_native.pyx":552
+    /* "statmoments/_native.pyx":579
  *   # This function is required for optimized memory consumption
  *   com = np.empty(tr_len * (tr_len + 1) // 2, dtype=np.float64)
  *   for i in range(tr_len):             # <<<<<<<<<<<<<<
  *     j, k = _block_index(i, tr_len)
  *     com[k] = f(i, j)
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":555
+  /* "statmoments/_native.pyx":582
  *     j, k = _block_index(i, tr_len)
  *     com[k] = f(i, j)
  *   return com             # <<<<<<<<<<<<<<
  * 
  * def update_moments(acc2d, acc1d, n1, moment, traces):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_com);
   __pyx_r = __pyx_v_com;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":548
+  /* "statmoments/_native.pyx":575
  *   return _triu
  * 
  * def _compute_by_rows(tr_len, f):             # <<<<<<<<<<<<<<
  *   # Compute by rows upper triangle part of matrix from function f
  *   # This function is required for optimized memory consumption
  */
 
@@ -18483,26 +18728,26 @@
   __Pyx_XDECREF(__pyx_v_j);
   __Pyx_XDECREF(__pyx_v_k);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":557
+/* "statmoments/_native.pyx":584
  *   return com
  * 
  * def update_moments(acc2d, acc1d, n1, moment, traces):             # <<<<<<<<<<<<<<
  *   # The update method:
  *   # x - ave2 = x + (ave1 - ave1) - ave2 = x - ave1 + (ave1 - ave2)
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11statmoments_7_native_9update_moments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_11statmoments_7_native_9update_moments = {"update_moments", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_9update_moments, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11statmoments_7_native_9update_moments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_11statmoments_7_native_11update_moments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_11statmoments_7_native_11update_moments = {"update_moments", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_11update_moments, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11statmoments_7_native_11update_moments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_acc2d = 0;
   PyObject *__pyx_v_acc1d = 0;
   PyObject *__pyx_v_n1 = 0;
   PyObject *__pyx_v_moment = 0;
   PyObject *__pyx_v_traces = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
@@ -18535,37 +18780,37 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_acc2d)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_acc1d)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update_moments", 1, 5, 5, 1); __PYX_ERR(0, 557, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update_moments", 1, 5, 5, 1); __PYX_ERR(0, 584, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_n1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update_moments", 1, 5, 5, 2); __PYX_ERR(0, 557, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update_moments", 1, 5, 5, 2); __PYX_ERR(0, 584, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moment)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update_moments", 1, 5, 5, 3); __PYX_ERR(0, 557, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update_moments", 1, 5, 5, 3); __PYX_ERR(0, 584, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_traces)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update_moments", 1, 5, 5, 4); __PYX_ERR(0, 557, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update_moments", 1, 5, 5, 4); __PYX_ERR(0, 584, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update_moments") < 0)) __PYX_ERR(0, 557, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update_moments") < 0)) __PYX_ERR(0, 584, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 5) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -18576,28 +18821,28 @@
     __pyx_v_acc1d = values[1];
     __pyx_v_n1 = values[2];
     __pyx_v_moment = values[3];
     __pyx_v_traces = values[4];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("update_moments", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 557, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("update_moments", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 584, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native.update_moments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11statmoments_7_native_8update_moments(__pyx_self, __pyx_v_acc2d, __pyx_v_acc1d, __pyx_v_n1, __pyx_v_moment, __pyx_v_traces);
+  __pyx_r = __pyx_pf_11statmoments_7_native_10update_moments(__pyx_self, __pyx_v_acc2d, __pyx_v_acc1d, __pyx_v_n1, __pyx_v_moment, __pyx_v_traces);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11statmoments_7_native_8update_moments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_acc2d, PyObject *__pyx_v_acc1d, PyObject *__pyx_v_n1, PyObject *__pyx_v_moment, PyObject *__pyx_v_traces) {
+static PyObject *__pyx_pf_11statmoments_7_native_10update_moments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_acc2d, PyObject *__pyx_v_acc1d, PyObject *__pyx_v_n1, PyObject *__pyx_v_moment, PyObject *__pyx_v_traces) {
   PyObject *__pyx_v_n2 = NULL;
   PyObject *__pyx_v_delta = NULL;
   PyObject *__pyx_v_j = NULL;
   PyObject *__pyx_v_temp_diag = NULL;
   PyObject *__pyx_v_k = NULL;
   PyObject *__pyx_v_l = NULL;
   PyObject *__pyx_v_p = NULL;
@@ -18633,546 +18878,546 @@
   PyObject *__pyx_t_26 = NULL;
   int __pyx_t_27;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("update_moments", 0);
 
-  /* "statmoments/_native.pyx":570
+  /* "statmoments/_native.pyx":597
  *   # This function is slow and should be vectorized
  * 
  *   n2 = len(traces)             # <<<<<<<<<<<<<<
- *   delta = np.empty_like(acc2d[0, 0])    # 2m x tr_len
+ *   delta = np.empty_like(acc2d[0, 0])  # 2m x tr_len
  *   np.sum(traces, axis=0, out=delta[0])
  */
-  __pyx_t_1 = PyObject_Length(__pyx_v_traces); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 570, __pyx_L1_error)
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 570, __pyx_L1_error)
+  __pyx_t_1 = PyObject_Length(__pyx_v_traces); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 597, __pyx_L1_error)
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 597, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_v_n2 = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":571
+  /* "statmoments/_native.pyx":598
  * 
  *   n2 = len(traces)
- *   delta = np.empty_like(acc2d[0, 0])    # 2m x tr_len             # <<<<<<<<<<<<<<
+ *   delta = np.empty_like(acc2d[0, 0])  # 2m x tr_len             # <<<<<<<<<<<<<<
  *   np.sum(traces, axis=0, out=delta[0])
- *   delta[0] = (acc1d*n2 - delta[0]) / (n1 + n2)
+ *   delta[0] = (acc1d * n2 - delta[0]) / (n1 + n2)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 571, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 598, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_empty_like); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 571, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_empty_like); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 598, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_tuple__21); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 571, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_tuple__23); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 598, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 571, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 598, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_delta = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":572
+  /* "statmoments/_native.pyx":599
  *   n2 = len(traces)
- *   delta = np.empty_like(acc2d[0, 0])    # 2m x tr_len
+ *   delta = np.empty_like(acc2d[0, 0])  # 2m x tr_len
  *   np.sum(traces, axis=0, out=delta[0])             # <<<<<<<<<<<<<<
- *   delta[0] = (acc1d*n2 - delta[0]) / (n1 + n2)
+ *   delta[0] = (acc1d * n2 - delta[0]) / (n1 + n2)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 572, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 599, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sum); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 572, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sum); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 599, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 572, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 599, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_v_traces);
   __Pyx_GIVEREF(__pyx_v_traces);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_traces);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 572, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 599, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 572, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_delta, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 572, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 599, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_delta, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 599, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_out, __pyx_t_5) < 0) __PYX_ERR(0, 572, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_out, __pyx_t_5) < 0) __PYX_ERR(0, 599, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 572, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 599, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":573
- *   delta = np.empty_like(acc2d[0, 0])    # 2m x tr_len
+  /* "statmoments/_native.pyx":600
+ *   delta = np.empty_like(acc2d[0, 0])  # 2m x tr_len
  *   np.sum(traces, axis=0, out=delta[0])
- *   delta[0] = (acc1d*n2 - delta[0]) / (n1 + n2)             # <<<<<<<<<<<<<<
+ *   delta[0] = (acc1d * n2 - delta[0]) / (n1 + n2)             # <<<<<<<<<<<<<<
  * 
  *   for j in range(1, moment):
  */
-  __pyx_t_5 = PyNumber_Multiply(__pyx_v_acc1d, __pyx_v_n2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 573, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Multiply(__pyx_v_acc1d, __pyx_v_n2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 600, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_delta, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 573, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_delta, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 600, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyNumber_Subtract(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 573, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Subtract(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 600, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Add(__pyx_v_n1, __pyx_v_n2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 573, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Add(__pyx_v_n1, __pyx_v_n2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 600, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyNumber_Divide(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 573, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyNumber_Divide(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 600, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_delta, 0, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) < 0)) __PYX_ERR(0, 573, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_delta, 0, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) < 0)) __PYX_ERR(0, 600, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":575
- *   delta[0] = (acc1d*n2 - delta[0]) / (n1 + n2)
+  /* "statmoments/_native.pyx":602
+ *   delta[0] = (acc1d * n2 - delta[0]) / (n1 + n2)
  * 
  *   for j in range(1, moment):             # <<<<<<<<<<<<<<
  *     dsbmv(delta[0], delta[j - 1], delta[j])
  * 
  */
-  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 575, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 602, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_int_1);
   __Pyx_INCREF(__pyx_v_moment);
   __Pyx_GIVEREF(__pyx_v_moment);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_moment);
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_5, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 575, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_5, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 602, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
     __pyx_t_5 = __pyx_t_3; __Pyx_INCREF(__pyx_t_5); __pyx_t_1 = 0;
     __pyx_t_6 = NULL;
   } else {
-    __pyx_t_1 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 575, __pyx_L1_error)
+    __pyx_t_1 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 602, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 575, __pyx_L1_error)
+    __pyx_t_6 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 602, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   for (;;) {
     if (likely(!__pyx_t_6)) {
       if (likely(PyList_CheckExact(__pyx_t_5))) {
         if (__pyx_t_1 >= PyList_GET_SIZE(__pyx_t_5)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_1); __Pyx_INCREF(__pyx_t_3); __pyx_t_1++; if (unlikely(0 < 0)) __PYX_ERR(0, 575, __pyx_L1_error)
+        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_1); __Pyx_INCREF(__pyx_t_3); __pyx_t_1++; if (unlikely(0 < 0)) __PYX_ERR(0, 602, __pyx_L1_error)
         #else
-        __pyx_t_3 = PySequence_ITEM(__pyx_t_5, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 575, __pyx_L1_error)
+        __pyx_t_3 = PySequence_ITEM(__pyx_t_5, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 602, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         #endif
       } else {
         if (__pyx_t_1 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_1); __Pyx_INCREF(__pyx_t_3); __pyx_t_1++; if (unlikely(0 < 0)) __PYX_ERR(0, 575, __pyx_L1_error)
+        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_1); __Pyx_INCREF(__pyx_t_3); __pyx_t_1++; if (unlikely(0 < 0)) __PYX_ERR(0, 602, __pyx_L1_error)
         #else
-        __pyx_t_3 = PySequence_ITEM(__pyx_t_5, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 575, __pyx_L1_error)
+        __pyx_t_3 = PySequence_ITEM(__pyx_t_5, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 602, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         #endif
       }
     } else {
       __pyx_t_3 = __pyx_t_6(__pyx_t_5);
       if (unlikely(!__pyx_t_3)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 575, __pyx_L1_error)
+          else __PYX_ERR(0, 602, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_3);
     }
     __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "statmoments/_native.pyx":576
+    /* "statmoments/_native.pyx":603
  * 
  *   for j in range(1, moment):
  *     dsbmv(delta[0], delta[j - 1], delta[j])             # <<<<<<<<<<<<<<
  * 
  *   acc1d[:] -= delta[0]
  */
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_delta, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 576, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_delta, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 603, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 576, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 603, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_v_j, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 576, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_v_j, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 603, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 576, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 603, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 576, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 603, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_v_j); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 576, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_v_j); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 603, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 576, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 603, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_f_11statmoments_7_native_dsbmv(__pyx_t_7, __pyx_t_8, __pyx_t_9, NULL);
     __PYX_XDEC_MEMVIEW(&__pyx_t_7, 1);
     __pyx_t_7.memview = NULL;
     __pyx_t_7.data = NULL;
     __PYX_XDEC_MEMVIEW(&__pyx_t_8, 1);
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
     __PYX_XDEC_MEMVIEW(&__pyx_t_9, 1);
     __pyx_t_9.memview = NULL;
     __pyx_t_9.data = NULL;
 
-    /* "statmoments/_native.pyx":575
- *   delta[0] = (acc1d*n2 - delta[0]) / (n1 + n2)
+    /* "statmoments/_native.pyx":602
+ *   delta[0] = (acc1d * n2 - delta[0]) / (n1 + n2)
  * 
  *   for j in range(1, moment):             # <<<<<<<<<<<<<<
  *     dsbmv(delta[0], delta[j - 1], delta[j])
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":578
+  /* "statmoments/_native.pyx":605
  *     dsbmv(delta[0], delta[j - 1], delta[j])
  * 
  *   acc1d[:] -= delta[0]             # <<<<<<<<<<<<<<
  *   temp_diag = np.empty_like(acc1d)
  *   for k in range(moment - 1, -1, -1):
  */
-  __Pyx_INCREF(__pyx_slice__5);
-  __pyx_t_10 = __pyx_slice__5;
-  __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_acc1d, __pyx_t_10); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 578, __pyx_L1_error)
+  __Pyx_INCREF(__pyx_slice__7);
+  __pyx_t_10 = __pyx_slice__7;
+  __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_acc1d, __pyx_t_10); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 605, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_delta, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_delta, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 605, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyNumber_InPlaceSubtract(__pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_InPlaceSubtract(__pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 605, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(PyObject_SetItem(__pyx_v_acc1d, __pyx_t_10, __pyx_t_3) < 0)) __PYX_ERR(0, 578, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_acc1d, __pyx_t_10, __pyx_t_3) < 0)) __PYX_ERR(0, 605, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-  /* "statmoments/_native.pyx":579
+  /* "statmoments/_native.pyx":606
  * 
  *   acc1d[:] -= delta[0]
  *   temp_diag = np.empty_like(acc1d)             # <<<<<<<<<<<<<<
  *   for k in range(moment - 1, -1, -1):
  *     for l in range(moment - 1, -1, -1):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 579, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 606, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty_like); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 579, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty_like); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 606, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_2, __pyx_v_acc1d) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_acc1d);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 579, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 606, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_temp_diag = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":580
+  /* "statmoments/_native.pyx":607
  *   acc1d[:] -= delta[0]
  *   temp_diag = np.empty_like(acc1d)
  *   for k in range(moment - 1, -1, -1):             # <<<<<<<<<<<<<<
  *     for l in range(moment - 1, -1, -1):
  * 
  */
-  __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_v_moment, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 580, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_v_moment, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 607, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 580, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 607, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_neg_1);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
   PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_int_neg_1);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_5, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 580, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_5, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 607, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
     __pyx_t_5 = __pyx_t_3; __Pyx_INCREF(__pyx_t_5); __pyx_t_1 = 0;
     __pyx_t_6 = NULL;
   } else {
-    __pyx_t_1 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 580, __pyx_L1_error)
+    __pyx_t_1 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 607, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 580, __pyx_L1_error)
+    __pyx_t_6 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 607, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   for (;;) {
     if (likely(!__pyx_t_6)) {
       if (likely(PyList_CheckExact(__pyx_t_5))) {
         if (__pyx_t_1 >= PyList_GET_SIZE(__pyx_t_5)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_1); __Pyx_INCREF(__pyx_t_3); __pyx_t_1++; if (unlikely(0 < 0)) __PYX_ERR(0, 580, __pyx_L1_error)
+        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_1); __Pyx_INCREF(__pyx_t_3); __pyx_t_1++; if (unlikely(0 < 0)) __PYX_ERR(0, 607, __pyx_L1_error)
         #else
-        __pyx_t_3 = PySequence_ITEM(__pyx_t_5, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 580, __pyx_L1_error)
+        __pyx_t_3 = PySequence_ITEM(__pyx_t_5, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 607, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         #endif
       } else {
         if (__pyx_t_1 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_1); __Pyx_INCREF(__pyx_t_3); __pyx_t_1++; if (unlikely(0 < 0)) __PYX_ERR(0, 580, __pyx_L1_error)
+        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_1); __Pyx_INCREF(__pyx_t_3); __pyx_t_1++; if (unlikely(0 < 0)) __PYX_ERR(0, 607, __pyx_L1_error)
         #else
-        __pyx_t_3 = PySequence_ITEM(__pyx_t_5, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 580, __pyx_L1_error)
+        __pyx_t_3 = PySequence_ITEM(__pyx_t_5, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 607, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         #endif
       }
     } else {
       __pyx_t_3 = __pyx_t_6(__pyx_t_5);
       if (unlikely(!__pyx_t_3)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 580, __pyx_L1_error)
+          else __PYX_ERR(0, 607, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_3);
     }
     __Pyx_XDECREF_SET(__pyx_v_k, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "statmoments/_native.pyx":581
+    /* "statmoments/_native.pyx":608
  *   temp_diag = np.empty_like(acc1d)
  *   for k in range(moment - 1, -1, -1):
  *     for l in range(moment - 1, -1, -1):             # <<<<<<<<<<<<<<
  * 
  *       for p in range(k - 1, -1, -1):
  */
-    __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_v_moment, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 581, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_v_moment, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 608, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 581, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 608, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
     __Pyx_INCREF(__pyx_int_neg_1);
     __Pyx_GIVEREF(__pyx_int_neg_1);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_int_neg_1);
     __Pyx_INCREF(__pyx_int_neg_1);
     __Pyx_GIVEREF(__pyx_int_neg_1);
     PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_int_neg_1);
     __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 581, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 608, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
       __pyx_t_2 = __pyx_t_3; __Pyx_INCREF(__pyx_t_2); __pyx_t_11 = 0;
       __pyx_t_12 = NULL;
     } else {
-      __pyx_t_11 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 581, __pyx_L1_error)
+      __pyx_t_11 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 608, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_12 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 581, __pyx_L1_error)
+      __pyx_t_12 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 608, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     for (;;) {
       if (likely(!__pyx_t_12)) {
         if (likely(PyList_CheckExact(__pyx_t_2))) {
           if (__pyx_t_11 >= PyList_GET_SIZE(__pyx_t_2)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_11); __Pyx_INCREF(__pyx_t_3); __pyx_t_11++; if (unlikely(0 < 0)) __PYX_ERR(0, 581, __pyx_L1_error)
+          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_11); __Pyx_INCREF(__pyx_t_3); __pyx_t_11++; if (unlikely(0 < 0)) __PYX_ERR(0, 608, __pyx_L1_error)
           #else
-          __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_11); __pyx_t_11++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 581, __pyx_L1_error)
+          __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_11); __pyx_t_11++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 608, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
           #endif
         } else {
           if (__pyx_t_11 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_11); __Pyx_INCREF(__pyx_t_3); __pyx_t_11++; if (unlikely(0 < 0)) __PYX_ERR(0, 581, __pyx_L1_error)
+          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_11); __Pyx_INCREF(__pyx_t_3); __pyx_t_11++; if (unlikely(0 < 0)) __PYX_ERR(0, 608, __pyx_L1_error)
           #else
-          __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_11); __pyx_t_11++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 581, __pyx_L1_error)
+          __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_11); __pyx_t_11++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 608, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
           #endif
         }
       } else {
         __pyx_t_3 = __pyx_t_12(__pyx_t_2);
         if (unlikely(!__pyx_t_3)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 581, __pyx_L1_error)
+            else __PYX_ERR(0, 608, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_3);
       }
       __Pyx_XDECREF_SET(__pyx_v_l, __pyx_t_3);
       __pyx_t_3 = 0;
 
-      /* "statmoments/_native.pyx":583
+      /* "statmoments/_native.pyx":610
  *     for l in range(moment - 1, -1, -1):
  * 
  *       for p in range(k - 1, -1, -1):             # <<<<<<<<<<<<<<
  *         for q in range(l - 1, -1, -1):
  *           da = binom(k + 1, p + 1) * binom(l + 1, q + 1)
  */
-      __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_v_k, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 583, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_v_k, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 610, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 583, __pyx_L1_error)
+      __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 610, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_GIVEREF(__pyx_t_3);
       PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
       __Pyx_INCREF(__pyx_int_neg_1);
       __Pyx_GIVEREF(__pyx_int_neg_1);
       PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_neg_1);
       __Pyx_INCREF(__pyx_int_neg_1);
       __Pyx_GIVEREF(__pyx_int_neg_1);
       PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_int_neg_1);
       __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 583, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 610, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
         __pyx_t_4 = __pyx_t_3; __Pyx_INCREF(__pyx_t_4); __pyx_t_13 = 0;
         __pyx_t_14 = NULL;
       } else {
-        __pyx_t_13 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 583, __pyx_L1_error)
+        __pyx_t_13 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 610, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_14 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 583, __pyx_L1_error)
+        __pyx_t_14 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 610, __pyx_L1_error)
       }
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       for (;;) {
         if (likely(!__pyx_t_14)) {
           if (likely(PyList_CheckExact(__pyx_t_4))) {
             if (__pyx_t_13 >= PyList_GET_SIZE(__pyx_t_4)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_13); __Pyx_INCREF(__pyx_t_3); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 583, __pyx_L1_error)
+            __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_13); __Pyx_INCREF(__pyx_t_3); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 610, __pyx_L1_error)
             #else
-            __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 583, __pyx_L1_error)
+            __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 610, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_3);
             #endif
           } else {
             if (__pyx_t_13 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_13); __Pyx_INCREF(__pyx_t_3); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 583, __pyx_L1_error)
+            __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_13); __Pyx_INCREF(__pyx_t_3); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 610, __pyx_L1_error)
             #else
-            __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 583, __pyx_L1_error)
+            __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 610, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_3);
             #endif
           }
         } else {
           __pyx_t_3 = __pyx_t_14(__pyx_t_4);
           if (unlikely(!__pyx_t_3)) {
             PyObject* exc_type = PyErr_Occurred();
             if (exc_type) {
               if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-              else __PYX_ERR(0, 583, __pyx_L1_error)
+              else __PYX_ERR(0, 610, __pyx_L1_error)
             }
             break;
           }
           __Pyx_GOTREF(__pyx_t_3);
         }
         __Pyx_XDECREF_SET(__pyx_v_p, __pyx_t_3);
         __pyx_t_3 = 0;
 
-        /* "statmoments/_native.pyx":584
+        /* "statmoments/_native.pyx":611
  * 
  *       for p in range(k - 1, -1, -1):
  *         for q in range(l - 1, -1, -1):             # <<<<<<<<<<<<<<
  *           da = binom(k + 1, p + 1) * binom(l + 1, q + 1)
  *           acc2d[k, :, l, :] += da * acc2d[p, :, q, :] * np.outer(delta[k - p - 1], delta[l - q - 1])
  */
-        __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_v_l, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 584, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_v_l, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 611, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_15 = PyTuple_New(3); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 584, __pyx_L1_error)
+        __pyx_t_15 = PyTuple_New(3); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 611, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_15);
         __Pyx_GIVEREF(__pyx_t_3);
         PyTuple_SET_ITEM(__pyx_t_15, 0, __pyx_t_3);
         __Pyx_INCREF(__pyx_int_neg_1);
         __Pyx_GIVEREF(__pyx_int_neg_1);
         PyTuple_SET_ITEM(__pyx_t_15, 1, __pyx_int_neg_1);
         __Pyx_INCREF(__pyx_int_neg_1);
         __Pyx_GIVEREF(__pyx_int_neg_1);
         PyTuple_SET_ITEM(__pyx_t_15, 2, __pyx_int_neg_1);
         __pyx_t_3 = 0;
-        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_15, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 584, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_15, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 611, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
         if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
           __pyx_t_15 = __pyx_t_3; __Pyx_INCREF(__pyx_t_15); __pyx_t_16 = 0;
           __pyx_t_17 = NULL;
         } else {
-          __pyx_t_16 = -1; __pyx_t_15 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 584, __pyx_L1_error)
+          __pyx_t_16 = -1; __pyx_t_15 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 611, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_15);
-          __pyx_t_17 = Py_TYPE(__pyx_t_15)->tp_iternext; if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 584, __pyx_L1_error)
+          __pyx_t_17 = Py_TYPE(__pyx_t_15)->tp_iternext; if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 611, __pyx_L1_error)
         }
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         for (;;) {
           if (likely(!__pyx_t_17)) {
             if (likely(PyList_CheckExact(__pyx_t_15))) {
               if (__pyx_t_16 >= PyList_GET_SIZE(__pyx_t_15)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_3 = PyList_GET_ITEM(__pyx_t_15, __pyx_t_16); __Pyx_INCREF(__pyx_t_3); __pyx_t_16++; if (unlikely(0 < 0)) __PYX_ERR(0, 584, __pyx_L1_error)
+              __pyx_t_3 = PyList_GET_ITEM(__pyx_t_15, __pyx_t_16); __Pyx_INCREF(__pyx_t_3); __pyx_t_16++; if (unlikely(0 < 0)) __PYX_ERR(0, 611, __pyx_L1_error)
               #else
-              __pyx_t_3 = PySequence_ITEM(__pyx_t_15, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 584, __pyx_L1_error)
+              __pyx_t_3 = PySequence_ITEM(__pyx_t_15, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 611, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_3);
               #endif
             } else {
               if (__pyx_t_16 >= PyTuple_GET_SIZE(__pyx_t_15)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_15, __pyx_t_16); __Pyx_INCREF(__pyx_t_3); __pyx_t_16++; if (unlikely(0 < 0)) __PYX_ERR(0, 584, __pyx_L1_error)
+              __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_15, __pyx_t_16); __Pyx_INCREF(__pyx_t_3); __pyx_t_16++; if (unlikely(0 < 0)) __PYX_ERR(0, 611, __pyx_L1_error)
               #else
-              __pyx_t_3 = PySequence_ITEM(__pyx_t_15, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 584, __pyx_L1_error)
+              __pyx_t_3 = PySequence_ITEM(__pyx_t_15, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 611, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_3);
               #endif
             }
           } else {
             __pyx_t_3 = __pyx_t_17(__pyx_t_15);
             if (unlikely(!__pyx_t_3)) {
               PyObject* exc_type = PyErr_Occurred();
               if (exc_type) {
                 if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                else __PYX_ERR(0, 584, __pyx_L1_error)
+                else __PYX_ERR(0, 611, __pyx_L1_error)
               }
               break;
             }
             __Pyx_GOTREF(__pyx_t_3);
           }
           __Pyx_XDECREF_SET(__pyx_v_q, __pyx_t_3);
           __pyx_t_3 = 0;
 
-          /* "statmoments/_native.pyx":585
+          /* "statmoments/_native.pyx":612
  *       for p in range(k - 1, -1, -1):
  *         for q in range(l - 1, -1, -1):
  *           da = binom(k + 1, p + 1) * binom(l + 1, q + 1)             # <<<<<<<<<<<<<<
  *           acc2d[k, :, l, :] += da * acc2d[p, :, q, :] * np.outer(delta[k - p - 1], delta[l - q - 1])
  * 
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_18, __pyx_n_s_binom); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 585, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_18, __pyx_n_s_binom); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 612, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_18);
-          __pyx_t_19 = __Pyx_PyInt_AddObjC(__pyx_v_k, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 585, __pyx_L1_error)
+          __pyx_t_19 = __Pyx_PyInt_AddObjC(__pyx_v_k, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 612, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_19);
-          __pyx_t_20 = __Pyx_PyInt_AddObjC(__pyx_v_p, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 585, __pyx_L1_error)
+          __pyx_t_20 = __Pyx_PyInt_AddObjC(__pyx_v_p, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 612, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_20);
           __pyx_t_21 = NULL;
           __pyx_t_22 = 0;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_18))) {
             __pyx_t_21 = PyMethod_GET_SELF(__pyx_t_18);
             if (likely(__pyx_t_21)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_18);
@@ -19181,53 +19426,53 @@
               __Pyx_DECREF_SET(__pyx_t_18, function);
               __pyx_t_22 = 1;
             }
           }
           #if CYTHON_FAST_PYCALL
           if (PyFunction_Check(__pyx_t_18)) {
             PyObject *__pyx_temp[3] = {__pyx_t_21, __pyx_t_19, __pyx_t_20};
-            __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_18, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 585, __pyx_L1_error)
+            __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_18, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 612, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_21); __pyx_t_21 = 0;
             __Pyx_GOTREF(__pyx_t_3);
             __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
             __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
           } else
           #endif
           #if CYTHON_FAST_PYCCALL
           if (__Pyx_PyFastCFunction_Check(__pyx_t_18)) {
             PyObject *__pyx_temp[3] = {__pyx_t_21, __pyx_t_19, __pyx_t_20};
-            __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_18, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 585, __pyx_L1_error)
+            __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_18, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 612, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_21); __pyx_t_21 = 0;
             __Pyx_GOTREF(__pyx_t_3);
             __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
             __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
           } else
           #endif
           {
-            __pyx_t_23 = PyTuple_New(2+__pyx_t_22); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 585, __pyx_L1_error)
+            __pyx_t_23 = PyTuple_New(2+__pyx_t_22); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 612, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_23);
             if (__pyx_t_21) {
               __Pyx_GIVEREF(__pyx_t_21); PyTuple_SET_ITEM(__pyx_t_23, 0, __pyx_t_21); __pyx_t_21 = NULL;
             }
             __Pyx_GIVEREF(__pyx_t_19);
             PyTuple_SET_ITEM(__pyx_t_23, 0+__pyx_t_22, __pyx_t_19);
             __Pyx_GIVEREF(__pyx_t_20);
             PyTuple_SET_ITEM(__pyx_t_23, 1+__pyx_t_22, __pyx_t_20);
             __pyx_t_19 = 0;
             __pyx_t_20 = 0;
-            __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_18, __pyx_t_23, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 585, __pyx_L1_error)
+            __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_18, __pyx_t_23, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 612, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_3);
             __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
           }
           __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-          __Pyx_GetModuleGlobalName(__pyx_t_23, __pyx_n_s_binom); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 585, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_23, __pyx_n_s_binom); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 612, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_23);
-          __pyx_t_20 = __Pyx_PyInt_AddObjC(__pyx_v_l, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 585, __pyx_L1_error)
+          __pyx_t_20 = __Pyx_PyInt_AddObjC(__pyx_v_l, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 612, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_20);
-          __pyx_t_19 = __Pyx_PyInt_AddObjC(__pyx_v_q, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 585, __pyx_L1_error)
+          __pyx_t_19 = __Pyx_PyInt_AddObjC(__pyx_v_q, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 612, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_19);
           __pyx_t_21 = NULL;
           __pyx_t_22 = 0;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_23))) {
             __pyx_t_21 = PyMethod_GET_SELF(__pyx_t_23);
             if (likely(__pyx_t_21)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_23);
@@ -19236,117 +19481,117 @@
               __Pyx_DECREF_SET(__pyx_t_23, function);
               __pyx_t_22 = 1;
             }
           }
           #if CYTHON_FAST_PYCALL
           if (PyFunction_Check(__pyx_t_23)) {
             PyObject *__pyx_temp[3] = {__pyx_t_21, __pyx_t_20, __pyx_t_19};
-            __pyx_t_18 = __Pyx_PyFunction_FastCall(__pyx_t_23, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 585, __pyx_L1_error)
+            __pyx_t_18 = __Pyx_PyFunction_FastCall(__pyx_t_23, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 612, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_21); __pyx_t_21 = 0;
             __Pyx_GOTREF(__pyx_t_18);
             __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
             __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
           } else
           #endif
           #if CYTHON_FAST_PYCCALL
           if (__Pyx_PyFastCFunction_Check(__pyx_t_23)) {
             PyObject *__pyx_temp[3] = {__pyx_t_21, __pyx_t_20, __pyx_t_19};
-            __pyx_t_18 = __Pyx_PyCFunction_FastCall(__pyx_t_23, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 585, __pyx_L1_error)
+            __pyx_t_18 = __Pyx_PyCFunction_FastCall(__pyx_t_23, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 612, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_21); __pyx_t_21 = 0;
             __Pyx_GOTREF(__pyx_t_18);
             __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
             __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
           } else
           #endif
           {
-            __pyx_t_24 = PyTuple_New(2+__pyx_t_22); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 585, __pyx_L1_error)
+            __pyx_t_24 = PyTuple_New(2+__pyx_t_22); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 612, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_24);
             if (__pyx_t_21) {
               __Pyx_GIVEREF(__pyx_t_21); PyTuple_SET_ITEM(__pyx_t_24, 0, __pyx_t_21); __pyx_t_21 = NULL;
             }
             __Pyx_GIVEREF(__pyx_t_20);
             PyTuple_SET_ITEM(__pyx_t_24, 0+__pyx_t_22, __pyx_t_20);
             __Pyx_GIVEREF(__pyx_t_19);
             PyTuple_SET_ITEM(__pyx_t_24, 1+__pyx_t_22, __pyx_t_19);
             __pyx_t_20 = 0;
             __pyx_t_19 = 0;
-            __pyx_t_18 = __Pyx_PyObject_Call(__pyx_t_23, __pyx_t_24, NULL); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 585, __pyx_L1_error)
+            __pyx_t_18 = __Pyx_PyObject_Call(__pyx_t_23, __pyx_t_24, NULL); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 612, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_18);
             __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
           }
           __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
-          __pyx_t_23 = PyNumber_Multiply(__pyx_t_3, __pyx_t_18); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 585, __pyx_L1_error)
+          __pyx_t_23 = PyNumber_Multiply(__pyx_t_3, __pyx_t_18); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 612, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_23);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
           __Pyx_XDECREF_SET(__pyx_v_da, __pyx_t_23);
           __pyx_t_23 = 0;
 
-          /* "statmoments/_native.pyx":586
+          /* "statmoments/_native.pyx":613
  *         for q in range(l - 1, -1, -1):
  *           da = binom(k + 1, p + 1) * binom(l + 1, q + 1)
  *           acc2d[k, :, l, :] += da * acc2d[p, :, q, :] * np.outer(delta[k - p - 1], delta[l - q - 1])             # <<<<<<<<<<<<<<
  * 
  *       for p in range(k - 1, -1, -1):
  */
-          __pyx_t_23 = PyTuple_New(4); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 586, __pyx_L1_error)
+          __pyx_t_23 = PyTuple_New(4); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 613, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_23);
           __Pyx_INCREF(__pyx_v_k);
           __Pyx_GIVEREF(__pyx_v_k);
           PyTuple_SET_ITEM(__pyx_t_23, 0, __pyx_v_k);
-          __Pyx_INCREF(__pyx_slice__5);
-          __Pyx_GIVEREF(__pyx_slice__5);
-          PyTuple_SET_ITEM(__pyx_t_23, 1, __pyx_slice__5);
+          __Pyx_INCREF(__pyx_slice__7);
+          __Pyx_GIVEREF(__pyx_slice__7);
+          PyTuple_SET_ITEM(__pyx_t_23, 1, __pyx_slice__7);
           __Pyx_INCREF(__pyx_v_l);
           __Pyx_GIVEREF(__pyx_v_l);
           PyTuple_SET_ITEM(__pyx_t_23, 2, __pyx_v_l);
-          __Pyx_INCREF(__pyx_slice__5);
-          __Pyx_GIVEREF(__pyx_slice__5);
-          PyTuple_SET_ITEM(__pyx_t_23, 3, __pyx_slice__5);
-          __pyx_t_18 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_23); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 586, __pyx_L1_error)
+          __Pyx_INCREF(__pyx_slice__7);
+          __Pyx_GIVEREF(__pyx_slice__7);
+          PyTuple_SET_ITEM(__pyx_t_23, 3, __pyx_slice__7);
+          __pyx_t_18 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_23); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 613, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_18);
-          __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 586, __pyx_L1_error)
+          __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 613, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_INCREF(__pyx_v_p);
           __Pyx_GIVEREF(__pyx_v_p);
           PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_p);
-          __Pyx_INCREF(__pyx_slice__5);
-          __Pyx_GIVEREF(__pyx_slice__5);
-          PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_slice__5);
+          __Pyx_INCREF(__pyx_slice__7);
+          __Pyx_GIVEREF(__pyx_slice__7);
+          PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_slice__7);
           __Pyx_INCREF(__pyx_v_q);
           __Pyx_GIVEREF(__pyx_v_q);
           PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_v_q);
-          __Pyx_INCREF(__pyx_slice__5);
-          __Pyx_GIVEREF(__pyx_slice__5);
-          PyTuple_SET_ITEM(__pyx_t_3, 3, __pyx_slice__5);
-          __pyx_t_24 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_3); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 586, __pyx_L1_error)
+          __Pyx_INCREF(__pyx_slice__7);
+          __Pyx_GIVEREF(__pyx_slice__7);
+          PyTuple_SET_ITEM(__pyx_t_3, 3, __pyx_slice__7);
+          __pyx_t_24 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_3); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 613, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_24);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __pyx_t_3 = PyNumber_Multiply(__pyx_v_da, __pyx_t_24); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 586, __pyx_L1_error)
+          __pyx_t_3 = PyNumber_Multiply(__pyx_v_da, __pyx_t_24); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 613, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
-          __Pyx_GetModuleGlobalName(__pyx_t_19, __pyx_n_s_np); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 586, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_19, __pyx_n_s_np); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 613, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_19);
-          __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_t_19, __pyx_n_s_outer); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 586, __pyx_L1_error)
+          __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_t_19, __pyx_n_s_outer); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 613, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_20);
           __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
-          __pyx_t_19 = PyNumber_Subtract(__pyx_v_k, __pyx_v_p); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 586, __pyx_L1_error)
+          __pyx_t_19 = PyNumber_Subtract(__pyx_v_k, __pyx_v_p); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 613, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_19);
-          __pyx_t_21 = __Pyx_PyInt_SubtractObjC(__pyx_t_19, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 586, __pyx_L1_error)
+          __pyx_t_21 = __Pyx_PyInt_SubtractObjC(__pyx_t_19, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 613, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_21);
           __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
-          __pyx_t_19 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_t_21); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 586, __pyx_L1_error)
+          __pyx_t_19 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_t_21); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 613, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_19);
           __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
-          __pyx_t_21 = PyNumber_Subtract(__pyx_v_l, __pyx_v_q); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 586, __pyx_L1_error)
+          __pyx_t_21 = PyNumber_Subtract(__pyx_v_l, __pyx_v_q); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 613, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_21);
-          __pyx_t_25 = __Pyx_PyInt_SubtractObjC(__pyx_t_21, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 586, __pyx_L1_error)
+          __pyx_t_25 = __Pyx_PyInt_SubtractObjC(__pyx_t_21, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 613, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_25);
           __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
-          __pyx_t_21 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_t_25); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 586, __pyx_L1_error)
+          __pyx_t_21 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_t_25); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 613, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_21);
           __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
           __pyx_t_25 = NULL;
           __pyx_t_22 = 0;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_20))) {
             __pyx_t_25 = PyMethod_GET_SELF(__pyx_t_20);
             if (likely(__pyx_t_25)) {
@@ -19356,191 +19601,191 @@
               __Pyx_DECREF_SET(__pyx_t_20, function);
               __pyx_t_22 = 1;
             }
           }
           #if CYTHON_FAST_PYCALL
           if (PyFunction_Check(__pyx_t_20)) {
             PyObject *__pyx_temp[3] = {__pyx_t_25, __pyx_t_19, __pyx_t_21};
-            __pyx_t_24 = __Pyx_PyFunction_FastCall(__pyx_t_20, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 586, __pyx_L1_error)
+            __pyx_t_24 = __Pyx_PyFunction_FastCall(__pyx_t_20, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 613, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_25); __pyx_t_25 = 0;
             __Pyx_GOTREF(__pyx_t_24);
             __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
             __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
           } else
           #endif
           #if CYTHON_FAST_PYCCALL
           if (__Pyx_PyFastCFunction_Check(__pyx_t_20)) {
             PyObject *__pyx_temp[3] = {__pyx_t_25, __pyx_t_19, __pyx_t_21};
-            __pyx_t_24 = __Pyx_PyCFunction_FastCall(__pyx_t_20, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 586, __pyx_L1_error)
+            __pyx_t_24 = __Pyx_PyCFunction_FastCall(__pyx_t_20, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 613, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_25); __pyx_t_25 = 0;
             __Pyx_GOTREF(__pyx_t_24);
             __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
             __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
           } else
           #endif
           {
-            __pyx_t_26 = PyTuple_New(2+__pyx_t_22); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 586, __pyx_L1_error)
+            __pyx_t_26 = PyTuple_New(2+__pyx_t_22); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 613, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_26);
             if (__pyx_t_25) {
               __Pyx_GIVEREF(__pyx_t_25); PyTuple_SET_ITEM(__pyx_t_26, 0, __pyx_t_25); __pyx_t_25 = NULL;
             }
             __Pyx_GIVEREF(__pyx_t_19);
             PyTuple_SET_ITEM(__pyx_t_26, 0+__pyx_t_22, __pyx_t_19);
             __Pyx_GIVEREF(__pyx_t_21);
             PyTuple_SET_ITEM(__pyx_t_26, 1+__pyx_t_22, __pyx_t_21);
             __pyx_t_19 = 0;
             __pyx_t_21 = 0;
-            __pyx_t_24 = __Pyx_PyObject_Call(__pyx_t_20, __pyx_t_26, NULL); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 586, __pyx_L1_error)
+            __pyx_t_24 = __Pyx_PyObject_Call(__pyx_t_20, __pyx_t_26, NULL); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 613, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_24);
             __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
           }
           __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-          __pyx_t_20 = PyNumber_Multiply(__pyx_t_3, __pyx_t_24); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 586, __pyx_L1_error)
+          __pyx_t_20 = PyNumber_Multiply(__pyx_t_3, __pyx_t_24); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 613, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_20);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
-          __pyx_t_24 = PyNumber_InPlaceAdd(__pyx_t_18, __pyx_t_20); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 586, __pyx_L1_error)
+          __pyx_t_24 = PyNumber_InPlaceAdd(__pyx_t_18, __pyx_t_20); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 613, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_24);
           __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
           __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-          if (unlikely(PyObject_SetItem(__pyx_v_acc2d, __pyx_t_23, __pyx_t_24) < 0)) __PYX_ERR(0, 586, __pyx_L1_error)
+          if (unlikely(PyObject_SetItem(__pyx_v_acc2d, __pyx_t_23, __pyx_t_24) < 0)) __PYX_ERR(0, 613, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
           __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
 
-          /* "statmoments/_native.pyx":584
+          /* "statmoments/_native.pyx":611
  * 
  *       for p in range(k - 1, -1, -1):
  *         for q in range(l - 1, -1, -1):             # <<<<<<<<<<<<<<
  *           da = binom(k + 1, p + 1) * binom(l + 1, q + 1)
  *           acc2d[k, :, l, :] += da * acc2d[p, :, q, :] * np.outer(delta[k - p - 1], delta[l - q - 1])
  */
         }
         __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
 
-        /* "statmoments/_native.pyx":583
+        /* "statmoments/_native.pyx":610
  *     for l in range(moment - 1, -1, -1):
  * 
  *       for p in range(k - 1, -1, -1):             # <<<<<<<<<<<<<<
  *         for q in range(l - 1, -1, -1):
  *           da = binom(k + 1, p + 1) * binom(l + 1, q + 1)
  */
       }
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "statmoments/_native.pyx":588
+      /* "statmoments/_native.pyx":615
  *           acc2d[k, :, l, :] += da * acc2d[p, :, q, :] * np.outer(delta[k - p - 1], delta[l - q - 1])
  * 
  *       for p in range(k - 1, -1, -1):             # <<<<<<<<<<<<<<
  *         acc2d[k, :, l, :] += acc2d[p, :, l, :] * (binom(k + 1, p + 1) * delta[k - p - 1, :, np.newaxis])
  *       for q in range(l - 1, -1, -1):
  */
-      __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_v_k, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 588, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_v_k, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 615, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_15 = PyTuple_New(3); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 588, __pyx_L1_error)
+      __pyx_t_15 = PyTuple_New(3); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 615, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_15);
       __Pyx_GIVEREF(__pyx_t_4);
       PyTuple_SET_ITEM(__pyx_t_15, 0, __pyx_t_4);
       __Pyx_INCREF(__pyx_int_neg_1);
       __Pyx_GIVEREF(__pyx_int_neg_1);
       PyTuple_SET_ITEM(__pyx_t_15, 1, __pyx_int_neg_1);
       __Pyx_INCREF(__pyx_int_neg_1);
       __Pyx_GIVEREF(__pyx_int_neg_1);
       PyTuple_SET_ITEM(__pyx_t_15, 2, __pyx_int_neg_1);
       __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_15, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 588, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_15, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 615, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
       if (likely(PyList_CheckExact(__pyx_t_4)) || PyTuple_CheckExact(__pyx_t_4)) {
         __pyx_t_15 = __pyx_t_4; __Pyx_INCREF(__pyx_t_15); __pyx_t_13 = 0;
         __pyx_t_14 = NULL;
       } else {
-        __pyx_t_13 = -1; __pyx_t_15 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 588, __pyx_L1_error)
+        __pyx_t_13 = -1; __pyx_t_15 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 615, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_15);
-        __pyx_t_14 = Py_TYPE(__pyx_t_15)->tp_iternext; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 588, __pyx_L1_error)
+        __pyx_t_14 = Py_TYPE(__pyx_t_15)->tp_iternext; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 615, __pyx_L1_error)
       }
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       for (;;) {
         if (likely(!__pyx_t_14)) {
           if (likely(PyList_CheckExact(__pyx_t_15))) {
             if (__pyx_t_13 >= PyList_GET_SIZE(__pyx_t_15)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_4 = PyList_GET_ITEM(__pyx_t_15, __pyx_t_13); __Pyx_INCREF(__pyx_t_4); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 588, __pyx_L1_error)
+            __pyx_t_4 = PyList_GET_ITEM(__pyx_t_15, __pyx_t_13); __Pyx_INCREF(__pyx_t_4); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 615, __pyx_L1_error)
             #else
-            __pyx_t_4 = PySequence_ITEM(__pyx_t_15, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 588, __pyx_L1_error)
+            __pyx_t_4 = PySequence_ITEM(__pyx_t_15, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 615, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_4);
             #endif
           } else {
             if (__pyx_t_13 >= PyTuple_GET_SIZE(__pyx_t_15)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_15, __pyx_t_13); __Pyx_INCREF(__pyx_t_4); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 588, __pyx_L1_error)
+            __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_15, __pyx_t_13); __Pyx_INCREF(__pyx_t_4); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 615, __pyx_L1_error)
             #else
-            __pyx_t_4 = PySequence_ITEM(__pyx_t_15, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 588, __pyx_L1_error)
+            __pyx_t_4 = PySequence_ITEM(__pyx_t_15, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 615, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_4);
             #endif
           }
         } else {
           __pyx_t_4 = __pyx_t_14(__pyx_t_15);
           if (unlikely(!__pyx_t_4)) {
             PyObject* exc_type = PyErr_Occurred();
             if (exc_type) {
               if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-              else __PYX_ERR(0, 588, __pyx_L1_error)
+              else __PYX_ERR(0, 615, __pyx_L1_error)
             }
             break;
           }
           __Pyx_GOTREF(__pyx_t_4);
         }
         __Pyx_XDECREF_SET(__pyx_v_p, __pyx_t_4);
         __pyx_t_4 = 0;
 
-        /* "statmoments/_native.pyx":589
+        /* "statmoments/_native.pyx":616
  * 
  *       for p in range(k - 1, -1, -1):
  *         acc2d[k, :, l, :] += acc2d[p, :, l, :] * (binom(k + 1, p + 1) * delta[k - p - 1, :, np.newaxis])             # <<<<<<<<<<<<<<
  *       for q in range(l - 1, -1, -1):
  *         acc2d[k, :, l, :] += acc2d[k, :, q, :] * (binom(l + 1, q + 1) * delta[l - q - 1, np.newaxis, :])
  */
-        __pyx_t_4 = PyTuple_New(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 589, __pyx_L1_error)
+        __pyx_t_4 = PyTuple_New(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 616, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_INCREF(__pyx_v_k);
         __Pyx_GIVEREF(__pyx_v_k);
         PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_k);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_slice__5);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_slice__7);
         __Pyx_INCREF(__pyx_v_l);
         __Pyx_GIVEREF(__pyx_v_l);
         PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_v_l);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_4, 3, __pyx_slice__5);
-        __pyx_t_23 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_4); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 589, __pyx_L1_error)
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_4, 3, __pyx_slice__7);
+        __pyx_t_23 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_4); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 616, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_23);
-        __pyx_t_24 = PyTuple_New(4); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 589, __pyx_L1_error)
+        __pyx_t_24 = PyTuple_New(4); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 616, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_24);
         __Pyx_INCREF(__pyx_v_p);
         __Pyx_GIVEREF(__pyx_v_p);
         PyTuple_SET_ITEM(__pyx_t_24, 0, __pyx_v_p);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_24, 1, __pyx_slice__5);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_24, 1, __pyx_slice__7);
         __Pyx_INCREF(__pyx_v_l);
         __Pyx_GIVEREF(__pyx_v_l);
         PyTuple_SET_ITEM(__pyx_t_24, 2, __pyx_v_l);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_24, 3, __pyx_slice__5);
-        __pyx_t_20 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_24); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 589, __pyx_L1_error)
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_24, 3, __pyx_slice__7);
+        __pyx_t_20 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_24); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 616, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
         __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
-        __Pyx_GetModuleGlobalName(__pyx_t_18, __pyx_n_s_binom); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 589, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_18, __pyx_n_s_binom); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 616, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_18);
-        __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_k, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 589, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_k, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 616, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_26 = __Pyx_PyInt_AddObjC(__pyx_v_p, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 589, __pyx_L1_error)
+        __pyx_t_26 = __Pyx_PyInt_AddObjC(__pyx_v_p, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 616, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_26);
         __pyx_t_21 = NULL;
         __pyx_t_22 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_18))) {
           __pyx_t_21 = PyMethod_GET_SELF(__pyx_t_18);
           if (likely(__pyx_t_21)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_18);
@@ -19549,209 +19794,209 @@
             __Pyx_DECREF_SET(__pyx_t_18, function);
             __pyx_t_22 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_18)) {
           PyObject *__pyx_temp[3] = {__pyx_t_21, __pyx_t_3, __pyx_t_26};
-          __pyx_t_24 = __Pyx_PyFunction_FastCall(__pyx_t_18, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 589, __pyx_L1_error)
+          __pyx_t_24 = __Pyx_PyFunction_FastCall(__pyx_t_18, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 616, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_21); __pyx_t_21 = 0;
           __Pyx_GOTREF(__pyx_t_24);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_18)) {
           PyObject *__pyx_temp[3] = {__pyx_t_21, __pyx_t_3, __pyx_t_26};
-          __pyx_t_24 = __Pyx_PyCFunction_FastCall(__pyx_t_18, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 589, __pyx_L1_error)
+          __pyx_t_24 = __Pyx_PyCFunction_FastCall(__pyx_t_18, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 616, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_21); __pyx_t_21 = 0;
           __Pyx_GOTREF(__pyx_t_24);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
         } else
         #endif
         {
-          __pyx_t_19 = PyTuple_New(2+__pyx_t_22); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 589, __pyx_L1_error)
+          __pyx_t_19 = PyTuple_New(2+__pyx_t_22); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 616, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_19);
           if (__pyx_t_21) {
             __Pyx_GIVEREF(__pyx_t_21); PyTuple_SET_ITEM(__pyx_t_19, 0, __pyx_t_21); __pyx_t_21 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_3);
           PyTuple_SET_ITEM(__pyx_t_19, 0+__pyx_t_22, __pyx_t_3);
           __Pyx_GIVEREF(__pyx_t_26);
           PyTuple_SET_ITEM(__pyx_t_19, 1+__pyx_t_22, __pyx_t_26);
           __pyx_t_3 = 0;
           __pyx_t_26 = 0;
-          __pyx_t_24 = __Pyx_PyObject_Call(__pyx_t_18, __pyx_t_19, NULL); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 589, __pyx_L1_error)
+          __pyx_t_24 = __Pyx_PyObject_Call(__pyx_t_18, __pyx_t_19, NULL); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 616, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_24);
           __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
         }
         __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-        __pyx_t_18 = PyNumber_Subtract(__pyx_v_k, __pyx_v_p); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 589, __pyx_L1_error)
+        __pyx_t_18 = PyNumber_Subtract(__pyx_v_k, __pyx_v_p); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 616, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_18);
-        __pyx_t_19 = __Pyx_PyInt_SubtractObjC(__pyx_t_18, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 589, __pyx_L1_error)
+        __pyx_t_19 = __Pyx_PyInt_SubtractObjC(__pyx_t_18, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 616, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_19);
         __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-        __Pyx_GetModuleGlobalName(__pyx_t_18, __pyx_n_s_np); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 589, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_18, __pyx_n_s_np); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 616, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_18);
-        __pyx_t_26 = __Pyx_PyObject_GetAttrStr(__pyx_t_18, __pyx_n_s_newaxis); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 589, __pyx_L1_error)
+        __pyx_t_26 = __Pyx_PyObject_GetAttrStr(__pyx_t_18, __pyx_n_s_newaxis); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 616, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_26);
         __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-        __pyx_t_18 = PyTuple_New(3); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 589, __pyx_L1_error)
+        __pyx_t_18 = PyTuple_New(3); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 616, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_18);
         __Pyx_GIVEREF(__pyx_t_19);
         PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_19);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_18, 1, __pyx_slice__5);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_18, 1, __pyx_slice__7);
         __Pyx_GIVEREF(__pyx_t_26);
         PyTuple_SET_ITEM(__pyx_t_18, 2, __pyx_t_26);
         __pyx_t_19 = 0;
         __pyx_t_26 = 0;
-        __pyx_t_26 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_t_18); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 589, __pyx_L1_error)
+        __pyx_t_26 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_t_18); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 616, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_26);
         __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-        __pyx_t_18 = PyNumber_Multiply(__pyx_t_24, __pyx_t_26); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 589, __pyx_L1_error)
+        __pyx_t_18 = PyNumber_Multiply(__pyx_t_24, __pyx_t_26); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 616, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_18);
         __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
         __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
-        __pyx_t_26 = PyNumber_Multiply(__pyx_t_20, __pyx_t_18); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 589, __pyx_L1_error)
+        __pyx_t_26 = PyNumber_Multiply(__pyx_t_20, __pyx_t_18); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 616, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_26);
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
         __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-        __pyx_t_18 = PyNumber_InPlaceAdd(__pyx_t_23, __pyx_t_26); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 589, __pyx_L1_error)
+        __pyx_t_18 = PyNumber_InPlaceAdd(__pyx_t_23, __pyx_t_26); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 616, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_18);
         __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
         __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
-        if (unlikely(PyObject_SetItem(__pyx_v_acc2d, __pyx_t_4, __pyx_t_18) < 0)) __PYX_ERR(0, 589, __pyx_L1_error)
+        if (unlikely(PyObject_SetItem(__pyx_v_acc2d, __pyx_t_4, __pyx_t_18) < 0)) __PYX_ERR(0, 616, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-        /* "statmoments/_native.pyx":588
+        /* "statmoments/_native.pyx":615
  *           acc2d[k, :, l, :] += da * acc2d[p, :, q, :] * np.outer(delta[k - p - 1], delta[l - q - 1])
  * 
  *       for p in range(k - 1, -1, -1):             # <<<<<<<<<<<<<<
  *         acc2d[k, :, l, :] += acc2d[p, :, l, :] * (binom(k + 1, p + 1) * delta[k - p - 1, :, np.newaxis])
  *       for q in range(l - 1, -1, -1):
  */
       }
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
 
-      /* "statmoments/_native.pyx":590
+      /* "statmoments/_native.pyx":617
  *       for p in range(k - 1, -1, -1):
  *         acc2d[k, :, l, :] += acc2d[p, :, l, :] * (binom(k + 1, p + 1) * delta[k - p - 1, :, np.newaxis])
  *       for q in range(l - 1, -1, -1):             # <<<<<<<<<<<<<<
  *         acc2d[k, :, l, :] += acc2d[k, :, q, :] * (binom(l + 1, q + 1) * delta[l - q - 1, np.newaxis, :])
  * 
  */
-      __pyx_t_15 = __Pyx_PyInt_SubtractObjC(__pyx_v_l, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 590, __pyx_L1_error)
+      __pyx_t_15 = __Pyx_PyInt_SubtractObjC(__pyx_v_l, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 617, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_15);
-      __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 590, __pyx_L1_error)
+      __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 617, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_GIVEREF(__pyx_t_15);
       PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_15);
       __Pyx_INCREF(__pyx_int_neg_1);
       __Pyx_GIVEREF(__pyx_int_neg_1);
       PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_neg_1);
       __Pyx_INCREF(__pyx_int_neg_1);
       __Pyx_GIVEREF(__pyx_int_neg_1);
       PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_int_neg_1);
       __pyx_t_15 = 0;
-      __pyx_t_15 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_4, NULL); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 590, __pyx_L1_error)
+      __pyx_t_15 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_4, NULL); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 617, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_15);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       if (likely(PyList_CheckExact(__pyx_t_15)) || PyTuple_CheckExact(__pyx_t_15)) {
         __pyx_t_4 = __pyx_t_15; __Pyx_INCREF(__pyx_t_4); __pyx_t_13 = 0;
         __pyx_t_14 = NULL;
       } else {
-        __pyx_t_13 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_15); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 590, __pyx_L1_error)
+        __pyx_t_13 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_15); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 617, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_14 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 590, __pyx_L1_error)
+        __pyx_t_14 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 617, __pyx_L1_error)
       }
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
       for (;;) {
         if (likely(!__pyx_t_14)) {
           if (likely(PyList_CheckExact(__pyx_t_4))) {
             if (__pyx_t_13 >= PyList_GET_SIZE(__pyx_t_4)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_15 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_13); __Pyx_INCREF(__pyx_t_15); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 590, __pyx_L1_error)
+            __pyx_t_15 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_13); __Pyx_INCREF(__pyx_t_15); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 617, __pyx_L1_error)
             #else
-            __pyx_t_15 = PySequence_ITEM(__pyx_t_4, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 590, __pyx_L1_error)
+            __pyx_t_15 = PySequence_ITEM(__pyx_t_4, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 617, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_15);
             #endif
           } else {
             if (__pyx_t_13 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_15 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_13); __Pyx_INCREF(__pyx_t_15); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 590, __pyx_L1_error)
+            __pyx_t_15 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_13); __Pyx_INCREF(__pyx_t_15); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 617, __pyx_L1_error)
             #else
-            __pyx_t_15 = PySequence_ITEM(__pyx_t_4, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 590, __pyx_L1_error)
+            __pyx_t_15 = PySequence_ITEM(__pyx_t_4, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 617, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_15);
             #endif
           }
         } else {
           __pyx_t_15 = __pyx_t_14(__pyx_t_4);
           if (unlikely(!__pyx_t_15)) {
             PyObject* exc_type = PyErr_Occurred();
             if (exc_type) {
               if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-              else __PYX_ERR(0, 590, __pyx_L1_error)
+              else __PYX_ERR(0, 617, __pyx_L1_error)
             }
             break;
           }
           __Pyx_GOTREF(__pyx_t_15);
         }
         __Pyx_XDECREF_SET(__pyx_v_q, __pyx_t_15);
         __pyx_t_15 = 0;
 
-        /* "statmoments/_native.pyx":591
+        /* "statmoments/_native.pyx":618
  *         acc2d[k, :, l, :] += acc2d[p, :, l, :] * (binom(k + 1, p + 1) * delta[k - p - 1, :, np.newaxis])
  *       for q in range(l - 1, -1, -1):
  *         acc2d[k, :, l, :] += acc2d[k, :, q, :] * (binom(l + 1, q + 1) * delta[l - q - 1, np.newaxis, :])             # <<<<<<<<<<<<<<
  * 
  *       if k > 0:
  */
-        __pyx_t_15 = PyTuple_New(4); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 591, __pyx_L1_error)
+        __pyx_t_15 = PyTuple_New(4); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 618, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_15);
         __Pyx_INCREF(__pyx_v_k);
         __Pyx_GIVEREF(__pyx_v_k);
         PyTuple_SET_ITEM(__pyx_t_15, 0, __pyx_v_k);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_15, 1, __pyx_slice__5);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_15, 1, __pyx_slice__7);
         __Pyx_INCREF(__pyx_v_l);
         __Pyx_GIVEREF(__pyx_v_l);
         PyTuple_SET_ITEM(__pyx_t_15, 2, __pyx_v_l);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_15, 3, __pyx_slice__5);
-        __pyx_t_18 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_15); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 591, __pyx_L1_error)
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_15, 3, __pyx_slice__7);
+        __pyx_t_18 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_15); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 618, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_18);
-        __pyx_t_26 = PyTuple_New(4); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 591, __pyx_L1_error)
+        __pyx_t_26 = PyTuple_New(4); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 618, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_26);
         __Pyx_INCREF(__pyx_v_k);
         __Pyx_GIVEREF(__pyx_v_k);
         PyTuple_SET_ITEM(__pyx_t_26, 0, __pyx_v_k);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_26, 1, __pyx_slice__5);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_26, 1, __pyx_slice__7);
         __Pyx_INCREF(__pyx_v_q);
         __Pyx_GIVEREF(__pyx_v_q);
         PyTuple_SET_ITEM(__pyx_t_26, 2, __pyx_v_q);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_26, 3, __pyx_slice__5);
-        __pyx_t_23 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_26); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 591, __pyx_L1_error)
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_26, 3, __pyx_slice__7);
+        __pyx_t_23 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_26); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 618, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_23);
         __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
-        __Pyx_GetModuleGlobalName(__pyx_t_20, __pyx_n_s_binom); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 591, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_20, __pyx_n_s_binom); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 618, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
-        __pyx_t_24 = __Pyx_PyInt_AddObjC(__pyx_v_l, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 591, __pyx_L1_error)
+        __pyx_t_24 = __Pyx_PyInt_AddObjC(__pyx_v_l, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 618, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_24);
-        __pyx_t_19 = __Pyx_PyInt_AddObjC(__pyx_v_q, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 591, __pyx_L1_error)
+        __pyx_t_19 = __Pyx_PyInt_AddObjC(__pyx_v_q, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 618, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_19);
         __pyx_t_3 = NULL;
         __pyx_t_22 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_20))) {
           __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_20);
           if (likely(__pyx_t_3)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_20);
@@ -19760,139 +20005,139 @@
             __Pyx_DECREF_SET(__pyx_t_20, function);
             __pyx_t_22 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_20)) {
           PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_t_24, __pyx_t_19};
-          __pyx_t_26 = __Pyx_PyFunction_FastCall(__pyx_t_20, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 591, __pyx_L1_error)
+          __pyx_t_26 = __Pyx_PyFunction_FastCall(__pyx_t_20, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 618, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_GOTREF(__pyx_t_26);
           __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
           __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_20)) {
           PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_t_24, __pyx_t_19};
-          __pyx_t_26 = __Pyx_PyCFunction_FastCall(__pyx_t_20, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 591, __pyx_L1_error)
+          __pyx_t_26 = __Pyx_PyCFunction_FastCall(__pyx_t_20, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 618, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_GOTREF(__pyx_t_26);
           __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
           __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
         } else
         #endif
         {
-          __pyx_t_21 = PyTuple_New(2+__pyx_t_22); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 591, __pyx_L1_error)
+          __pyx_t_21 = PyTuple_New(2+__pyx_t_22); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 618, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_21);
           if (__pyx_t_3) {
             __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_21, 0, __pyx_t_3); __pyx_t_3 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_24);
           PyTuple_SET_ITEM(__pyx_t_21, 0+__pyx_t_22, __pyx_t_24);
           __Pyx_GIVEREF(__pyx_t_19);
           PyTuple_SET_ITEM(__pyx_t_21, 1+__pyx_t_22, __pyx_t_19);
           __pyx_t_24 = 0;
           __pyx_t_19 = 0;
-          __pyx_t_26 = __Pyx_PyObject_Call(__pyx_t_20, __pyx_t_21, NULL); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 591, __pyx_L1_error)
+          __pyx_t_26 = __Pyx_PyObject_Call(__pyx_t_20, __pyx_t_21, NULL); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 618, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_26);
           __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
         }
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-        __pyx_t_20 = PyNumber_Subtract(__pyx_v_l, __pyx_v_q); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 591, __pyx_L1_error)
+        __pyx_t_20 = PyNumber_Subtract(__pyx_v_l, __pyx_v_q); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 618, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
-        __pyx_t_21 = __Pyx_PyInt_SubtractObjC(__pyx_t_20, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 591, __pyx_L1_error)
+        __pyx_t_21 = __Pyx_PyInt_SubtractObjC(__pyx_t_20, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 618, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_21);
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-        __Pyx_GetModuleGlobalName(__pyx_t_20, __pyx_n_s_np); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 591, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_20, __pyx_n_s_np); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 618, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
-        __pyx_t_19 = __Pyx_PyObject_GetAttrStr(__pyx_t_20, __pyx_n_s_newaxis); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 591, __pyx_L1_error)
+        __pyx_t_19 = __Pyx_PyObject_GetAttrStr(__pyx_t_20, __pyx_n_s_newaxis); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 618, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_19);
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-        __pyx_t_20 = PyTuple_New(3); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 591, __pyx_L1_error)
+        __pyx_t_20 = PyTuple_New(3); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 618, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
         __Pyx_GIVEREF(__pyx_t_21);
         PyTuple_SET_ITEM(__pyx_t_20, 0, __pyx_t_21);
         __Pyx_GIVEREF(__pyx_t_19);
         PyTuple_SET_ITEM(__pyx_t_20, 1, __pyx_t_19);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_20, 2, __pyx_slice__5);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_20, 2, __pyx_slice__7);
         __pyx_t_21 = 0;
         __pyx_t_19 = 0;
-        __pyx_t_19 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_t_20); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 591, __pyx_L1_error)
+        __pyx_t_19 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_t_20); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 618, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_19);
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-        __pyx_t_20 = PyNumber_Multiply(__pyx_t_26, __pyx_t_19); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 591, __pyx_L1_error)
+        __pyx_t_20 = PyNumber_Multiply(__pyx_t_26, __pyx_t_19); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 618, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
         __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
         __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
-        __pyx_t_19 = PyNumber_Multiply(__pyx_t_23, __pyx_t_20); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 591, __pyx_L1_error)
+        __pyx_t_19 = PyNumber_Multiply(__pyx_t_23, __pyx_t_20); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 618, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_19);
         __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-        __pyx_t_20 = PyNumber_InPlaceAdd(__pyx_t_18, __pyx_t_19); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 591, __pyx_L1_error)
+        __pyx_t_20 = PyNumber_InPlaceAdd(__pyx_t_18, __pyx_t_19); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 618, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
         __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
         __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
-        if (unlikely(PyObject_SetItem(__pyx_v_acc2d, __pyx_t_15, __pyx_t_20) < 0)) __PYX_ERR(0, 591, __pyx_L1_error)
+        if (unlikely(PyObject_SetItem(__pyx_v_acc2d, __pyx_t_15, __pyx_t_20) < 0)) __PYX_ERR(0, 618, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
         __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
 
-        /* "statmoments/_native.pyx":590
+        /* "statmoments/_native.pyx":617
  *       for p in range(k - 1, -1, -1):
  *         acc2d[k, :, l, :] += acc2d[p, :, l, :] * (binom(k + 1, p + 1) * delta[k - p - 1, :, np.newaxis])
  *       for q in range(l - 1, -1, -1):             # <<<<<<<<<<<<<<
  *         acc2d[k, :, l, :] += acc2d[k, :, q, :] * (binom(l + 1, q + 1) * delta[l - q - 1, np.newaxis, :])
  * 
  */
       }
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "statmoments/_native.pyx":593
+      /* "statmoments/_native.pyx":620
  *         acc2d[k, :, l, :] += acc2d[k, :, q, :] * (binom(l + 1, q + 1) * delta[l - q - 1, np.newaxis, :])
  * 
  *       if k > 0:             # <<<<<<<<<<<<<<
  *         temp_diag[:] = np.diag(acc2d[k - 1, :, 0, :])
  *         for p in range(k - 1, 0, -1):
  */
-      __pyx_t_4 = PyObject_RichCompare(__pyx_v_k, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 593, __pyx_L1_error)
-      __pyx_t_27 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_27 < 0)) __PYX_ERR(0, 593, __pyx_L1_error)
+      __pyx_t_4 = PyObject_RichCompare(__pyx_v_k, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 620, __pyx_L1_error)
+      __pyx_t_27 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_27 < 0)) __PYX_ERR(0, 620, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       if (__pyx_t_27) {
 
-        /* "statmoments/_native.pyx":594
+        /* "statmoments/_native.pyx":621
  * 
  *       if k > 0:
  *         temp_diag[:] = np.diag(acc2d[k - 1, :, 0, :])             # <<<<<<<<<<<<<<
  *         for p in range(k - 1, 0, -1):
  *           temp_diag += np.diag(acc2d[p - 1, :, 0, :]) * (binom(k + 1, p + 1) * delta[k - p - 1])
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_15, __pyx_n_s_np); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 594, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_15, __pyx_n_s_np); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 621, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_15);
-        __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_t_15, __pyx_n_s_diag); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 594, __pyx_L1_error)
+        __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_t_15, __pyx_n_s_diag); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 621, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
         __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-        __pyx_t_15 = __Pyx_PyInt_SubtractObjC(__pyx_v_k, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 594, __pyx_L1_error)
+        __pyx_t_15 = __Pyx_PyInt_SubtractObjC(__pyx_v_k, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 621, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_15);
-        __pyx_t_19 = PyTuple_New(4); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 594, __pyx_L1_error)
+        __pyx_t_19 = PyTuple_New(4); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 621, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_19);
         __Pyx_GIVEREF(__pyx_t_15);
         PyTuple_SET_ITEM(__pyx_t_19, 0, __pyx_t_15);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_19, 1, __pyx_slice__5);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_19, 1, __pyx_slice__7);
         __Pyx_INCREF(__pyx_int_0);
         __Pyx_GIVEREF(__pyx_int_0);
         PyTuple_SET_ITEM(__pyx_t_19, 2, __pyx_int_0);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_19, 3, __pyx_slice__5);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_19, 3, __pyx_slice__7);
         __pyx_t_15 = 0;
-        __pyx_t_15 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_19); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 594, __pyx_L1_error)
+        __pyx_t_15 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_19); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 621, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_15);
         __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
         __pyx_t_19 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_20))) {
           __pyx_t_19 = PyMethod_GET_SELF(__pyx_t_20);
           if (likely(__pyx_t_19)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_20);
@@ -19900,115 +20145,115 @@
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_20, function);
           }
         }
         __pyx_t_4 = (__pyx_t_19) ? __Pyx_PyObject_Call2Args(__pyx_t_20, __pyx_t_19, __pyx_t_15) : __Pyx_PyObject_CallOneArg(__pyx_t_20, __pyx_t_15);
         __Pyx_XDECREF(__pyx_t_19); __pyx_t_19 = 0;
         __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-        if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 594, __pyx_L1_error)
+        if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 621, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-        if (__Pyx_PyObject_SetSlice(__pyx_v_temp_diag, __pyx_t_4, 0, 0, NULL, NULL, &__pyx_slice__5, 0, 0, 0) < 0) __PYX_ERR(0, 594, __pyx_L1_error)
+        if (__Pyx_PyObject_SetSlice(__pyx_v_temp_diag, __pyx_t_4, 0, 0, NULL, NULL, &__pyx_slice__7, 0, 0, 0) < 0) __PYX_ERR(0, 621, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-        /* "statmoments/_native.pyx":595
+        /* "statmoments/_native.pyx":622
  *       if k > 0:
  *         temp_diag[:] = np.diag(acc2d[k - 1, :, 0, :])
  *         for p in range(k - 1, 0, -1):             # <<<<<<<<<<<<<<
  *           temp_diag += np.diag(acc2d[p - 1, :, 0, :]) * (binom(k + 1, p + 1) * delta[k - p - 1])
  *         acc2d[k, :, l, :] += np.outer(temp_diag, delta[l])
  */
-        __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_v_k, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 595, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_v_k, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 622, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_20 = PyTuple_New(3); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 595, __pyx_L1_error)
+        __pyx_t_20 = PyTuple_New(3); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 622, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
         __Pyx_GIVEREF(__pyx_t_4);
         PyTuple_SET_ITEM(__pyx_t_20, 0, __pyx_t_4);
         __Pyx_INCREF(__pyx_int_0);
         __Pyx_GIVEREF(__pyx_int_0);
         PyTuple_SET_ITEM(__pyx_t_20, 1, __pyx_int_0);
         __Pyx_INCREF(__pyx_int_neg_1);
         __Pyx_GIVEREF(__pyx_int_neg_1);
         PyTuple_SET_ITEM(__pyx_t_20, 2, __pyx_int_neg_1);
         __pyx_t_4 = 0;
-        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_20, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 595, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_20, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 622, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
         if (likely(PyList_CheckExact(__pyx_t_4)) || PyTuple_CheckExact(__pyx_t_4)) {
           __pyx_t_20 = __pyx_t_4; __Pyx_INCREF(__pyx_t_20); __pyx_t_13 = 0;
           __pyx_t_14 = NULL;
         } else {
-          __pyx_t_13 = -1; __pyx_t_20 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 595, __pyx_L1_error)
+          __pyx_t_13 = -1; __pyx_t_20 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 622, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_20);
-          __pyx_t_14 = Py_TYPE(__pyx_t_20)->tp_iternext; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 595, __pyx_L1_error)
+          __pyx_t_14 = Py_TYPE(__pyx_t_20)->tp_iternext; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 622, __pyx_L1_error)
         }
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         for (;;) {
           if (likely(!__pyx_t_14)) {
             if (likely(PyList_CheckExact(__pyx_t_20))) {
               if (__pyx_t_13 >= PyList_GET_SIZE(__pyx_t_20)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_4 = PyList_GET_ITEM(__pyx_t_20, __pyx_t_13); __Pyx_INCREF(__pyx_t_4); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 595, __pyx_L1_error)
+              __pyx_t_4 = PyList_GET_ITEM(__pyx_t_20, __pyx_t_13); __Pyx_INCREF(__pyx_t_4); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 622, __pyx_L1_error)
               #else
-              __pyx_t_4 = PySequence_ITEM(__pyx_t_20, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 595, __pyx_L1_error)
+              __pyx_t_4 = PySequence_ITEM(__pyx_t_20, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 622, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_4);
               #endif
             } else {
               if (__pyx_t_13 >= PyTuple_GET_SIZE(__pyx_t_20)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_20, __pyx_t_13); __Pyx_INCREF(__pyx_t_4); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 595, __pyx_L1_error)
+              __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_20, __pyx_t_13); __Pyx_INCREF(__pyx_t_4); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 622, __pyx_L1_error)
               #else
-              __pyx_t_4 = PySequence_ITEM(__pyx_t_20, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 595, __pyx_L1_error)
+              __pyx_t_4 = PySequence_ITEM(__pyx_t_20, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 622, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_4);
               #endif
             }
           } else {
             __pyx_t_4 = __pyx_t_14(__pyx_t_20);
             if (unlikely(!__pyx_t_4)) {
               PyObject* exc_type = PyErr_Occurred();
               if (exc_type) {
                 if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                else __PYX_ERR(0, 595, __pyx_L1_error)
+                else __PYX_ERR(0, 622, __pyx_L1_error)
               }
               break;
             }
             __Pyx_GOTREF(__pyx_t_4);
           }
           __Pyx_XDECREF_SET(__pyx_v_p, __pyx_t_4);
           __pyx_t_4 = 0;
 
-          /* "statmoments/_native.pyx":596
+          /* "statmoments/_native.pyx":623
  *         temp_diag[:] = np.diag(acc2d[k - 1, :, 0, :])
  *         for p in range(k - 1, 0, -1):
  *           temp_diag += np.diag(acc2d[p - 1, :, 0, :]) * (binom(k + 1, p + 1) * delta[k - p - 1])             # <<<<<<<<<<<<<<
  *         acc2d[k, :, l, :] += np.outer(temp_diag, delta[l])
  * 
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_15, __pyx_n_s_np); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 596, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_15, __pyx_n_s_np); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 623, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_15);
-          __pyx_t_19 = __Pyx_PyObject_GetAttrStr(__pyx_t_15, __pyx_n_s_diag); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 596, __pyx_L1_error)
+          __pyx_t_19 = __Pyx_PyObject_GetAttrStr(__pyx_t_15, __pyx_n_s_diag); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 623, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_19);
           __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-          __pyx_t_15 = __Pyx_PyInt_SubtractObjC(__pyx_v_p, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 596, __pyx_L1_error)
+          __pyx_t_15 = __Pyx_PyInt_SubtractObjC(__pyx_v_p, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 623, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_15);
-          __pyx_t_18 = PyTuple_New(4); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 596, __pyx_L1_error)
+          __pyx_t_18 = PyTuple_New(4); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 623, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_18);
           __Pyx_GIVEREF(__pyx_t_15);
           PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_15);
-          __Pyx_INCREF(__pyx_slice__5);
-          __Pyx_GIVEREF(__pyx_slice__5);
-          PyTuple_SET_ITEM(__pyx_t_18, 1, __pyx_slice__5);
+          __Pyx_INCREF(__pyx_slice__7);
+          __Pyx_GIVEREF(__pyx_slice__7);
+          PyTuple_SET_ITEM(__pyx_t_18, 1, __pyx_slice__7);
           __Pyx_INCREF(__pyx_int_0);
           __Pyx_GIVEREF(__pyx_int_0);
           PyTuple_SET_ITEM(__pyx_t_18, 2, __pyx_int_0);
-          __Pyx_INCREF(__pyx_slice__5);
-          __Pyx_GIVEREF(__pyx_slice__5);
-          PyTuple_SET_ITEM(__pyx_t_18, 3, __pyx_slice__5);
+          __Pyx_INCREF(__pyx_slice__7);
+          __Pyx_GIVEREF(__pyx_slice__7);
+          PyTuple_SET_ITEM(__pyx_t_18, 3, __pyx_slice__7);
           __pyx_t_15 = 0;
-          __pyx_t_15 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_18); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 596, __pyx_L1_error)
+          __pyx_t_15 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_18); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 623, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_15);
           __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
           __pyx_t_18 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_19))) {
             __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_19);
             if (likely(__pyx_t_18)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_19);
@@ -20016,22 +20261,22 @@
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_19, function);
             }
           }
           __pyx_t_4 = (__pyx_t_18) ? __Pyx_PyObject_Call2Args(__pyx_t_19, __pyx_t_18, __pyx_t_15) : __Pyx_PyObject_CallOneArg(__pyx_t_19, __pyx_t_15);
           __Pyx_XDECREF(__pyx_t_18); __pyx_t_18 = 0;
           __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-          if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 596, __pyx_L1_error)
+          if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 623, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
-          __Pyx_GetModuleGlobalName(__pyx_t_15, __pyx_n_s_binom); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 596, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_15, __pyx_n_s_binom); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 623, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_15);
-          __pyx_t_18 = __Pyx_PyInt_AddObjC(__pyx_v_k, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 596, __pyx_L1_error)
+          __pyx_t_18 = __Pyx_PyInt_AddObjC(__pyx_v_k, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 623, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_18);
-          __pyx_t_23 = __Pyx_PyInt_AddObjC(__pyx_v_p, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 596, __pyx_L1_error)
+          __pyx_t_23 = __Pyx_PyInt_AddObjC(__pyx_v_p, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 623, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_23);
           __pyx_t_26 = NULL;
           __pyx_t_22 = 0;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_15))) {
             __pyx_t_26 = PyMethod_GET_SELF(__pyx_t_15);
             if (likely(__pyx_t_26)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_15);
@@ -20040,109 +20285,109 @@
               __Pyx_DECREF_SET(__pyx_t_15, function);
               __pyx_t_22 = 1;
             }
           }
           #if CYTHON_FAST_PYCALL
           if (PyFunction_Check(__pyx_t_15)) {
             PyObject *__pyx_temp[3] = {__pyx_t_26, __pyx_t_18, __pyx_t_23};
-            __pyx_t_19 = __Pyx_PyFunction_FastCall(__pyx_t_15, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 596, __pyx_L1_error)
+            __pyx_t_19 = __Pyx_PyFunction_FastCall(__pyx_t_15, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 623, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_26); __pyx_t_26 = 0;
             __Pyx_GOTREF(__pyx_t_19);
             __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
             __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
           } else
           #endif
           #if CYTHON_FAST_PYCCALL
           if (__Pyx_PyFastCFunction_Check(__pyx_t_15)) {
             PyObject *__pyx_temp[3] = {__pyx_t_26, __pyx_t_18, __pyx_t_23};
-            __pyx_t_19 = __Pyx_PyCFunction_FastCall(__pyx_t_15, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 596, __pyx_L1_error)
+            __pyx_t_19 = __Pyx_PyCFunction_FastCall(__pyx_t_15, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 623, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_26); __pyx_t_26 = 0;
             __Pyx_GOTREF(__pyx_t_19);
             __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
             __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
           } else
           #endif
           {
-            __pyx_t_21 = PyTuple_New(2+__pyx_t_22); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 596, __pyx_L1_error)
+            __pyx_t_21 = PyTuple_New(2+__pyx_t_22); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 623, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_21);
             if (__pyx_t_26) {
               __Pyx_GIVEREF(__pyx_t_26); PyTuple_SET_ITEM(__pyx_t_21, 0, __pyx_t_26); __pyx_t_26 = NULL;
             }
             __Pyx_GIVEREF(__pyx_t_18);
             PyTuple_SET_ITEM(__pyx_t_21, 0+__pyx_t_22, __pyx_t_18);
             __Pyx_GIVEREF(__pyx_t_23);
             PyTuple_SET_ITEM(__pyx_t_21, 1+__pyx_t_22, __pyx_t_23);
             __pyx_t_18 = 0;
             __pyx_t_23 = 0;
-            __pyx_t_19 = __Pyx_PyObject_Call(__pyx_t_15, __pyx_t_21, NULL); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 596, __pyx_L1_error)
+            __pyx_t_19 = __Pyx_PyObject_Call(__pyx_t_15, __pyx_t_21, NULL); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 623, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_19);
             __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
           }
           __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-          __pyx_t_15 = PyNumber_Subtract(__pyx_v_k, __pyx_v_p); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 596, __pyx_L1_error)
+          __pyx_t_15 = PyNumber_Subtract(__pyx_v_k, __pyx_v_p); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 623, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_15);
-          __pyx_t_21 = __Pyx_PyInt_SubtractObjC(__pyx_t_15, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 596, __pyx_L1_error)
+          __pyx_t_21 = __Pyx_PyInt_SubtractObjC(__pyx_t_15, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 623, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_21);
           __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-          __pyx_t_15 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_t_21); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 596, __pyx_L1_error)
+          __pyx_t_15 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_t_21); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 623, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_15);
           __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
-          __pyx_t_21 = PyNumber_Multiply(__pyx_t_19, __pyx_t_15); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 596, __pyx_L1_error)
+          __pyx_t_21 = PyNumber_Multiply(__pyx_t_19, __pyx_t_15); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 623, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_21);
           __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
           __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-          __pyx_t_15 = PyNumber_Multiply(__pyx_t_4, __pyx_t_21); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 596, __pyx_L1_error)
+          __pyx_t_15 = PyNumber_Multiply(__pyx_t_4, __pyx_t_21); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 623, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_15);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
-          __pyx_t_21 = PyNumber_InPlaceAdd(__pyx_v_temp_diag, __pyx_t_15); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 596, __pyx_L1_error)
+          __pyx_t_21 = PyNumber_InPlaceAdd(__pyx_v_temp_diag, __pyx_t_15); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 623, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_21);
           __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
           __Pyx_DECREF_SET(__pyx_v_temp_diag, __pyx_t_21);
           __pyx_t_21 = 0;
 
-          /* "statmoments/_native.pyx":595
+          /* "statmoments/_native.pyx":622
  *       if k > 0:
  *         temp_diag[:] = np.diag(acc2d[k - 1, :, 0, :])
  *         for p in range(k - 1, 0, -1):             # <<<<<<<<<<<<<<
  *           temp_diag += np.diag(acc2d[p - 1, :, 0, :]) * (binom(k + 1, p + 1) * delta[k - p - 1])
  *         acc2d[k, :, l, :] += np.outer(temp_diag, delta[l])
  */
         }
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
 
-        /* "statmoments/_native.pyx":597
+        /* "statmoments/_native.pyx":624
  *         for p in range(k - 1, 0, -1):
  *           temp_diag += np.diag(acc2d[p - 1, :, 0, :]) * (binom(k + 1, p + 1) * delta[k - p - 1])
  *         acc2d[k, :, l, :] += np.outer(temp_diag, delta[l])             # <<<<<<<<<<<<<<
  * 
  *       if l > 0:
  */
-        __pyx_t_20 = PyTuple_New(4); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 597, __pyx_L1_error)
+        __pyx_t_20 = PyTuple_New(4); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 624, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
         __Pyx_INCREF(__pyx_v_k);
         __Pyx_GIVEREF(__pyx_v_k);
         PyTuple_SET_ITEM(__pyx_t_20, 0, __pyx_v_k);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_20, 1, __pyx_slice__5);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_20, 1, __pyx_slice__7);
         __Pyx_INCREF(__pyx_v_l);
         __Pyx_GIVEREF(__pyx_v_l);
         PyTuple_SET_ITEM(__pyx_t_20, 2, __pyx_v_l);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_20, 3, __pyx_slice__5);
-        __pyx_t_21 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_20); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 597, __pyx_L1_error)
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_20, 3, __pyx_slice__7);
+        __pyx_t_21 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_20); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 624, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_21);
-        __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 597, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 624, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_19 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_outer); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 597, __pyx_L1_error)
+        __pyx_t_19 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_outer); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 624, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_19);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_v_l); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 597, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_v_l); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 624, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __pyx_t_23 = NULL;
         __pyx_t_22 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_19))) {
           __pyx_t_23 = PyMethod_GET_SELF(__pyx_t_19);
           if (likely(__pyx_t_23)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_19);
@@ -20151,104 +20396,104 @@
             __Pyx_DECREF_SET(__pyx_t_19, function);
             __pyx_t_22 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_19)) {
           PyObject *__pyx_temp[3] = {__pyx_t_23, __pyx_v_temp_diag, __pyx_t_4};
-          __pyx_t_15 = __Pyx_PyFunction_FastCall(__pyx_t_19, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 597, __pyx_L1_error)
+          __pyx_t_15 = __Pyx_PyFunction_FastCall(__pyx_t_19, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 624, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_23); __pyx_t_23 = 0;
           __Pyx_GOTREF(__pyx_t_15);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_19)) {
           PyObject *__pyx_temp[3] = {__pyx_t_23, __pyx_v_temp_diag, __pyx_t_4};
-          __pyx_t_15 = __Pyx_PyCFunction_FastCall(__pyx_t_19, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 597, __pyx_L1_error)
+          __pyx_t_15 = __Pyx_PyCFunction_FastCall(__pyx_t_19, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 624, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_23); __pyx_t_23 = 0;
           __Pyx_GOTREF(__pyx_t_15);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         } else
         #endif
         {
-          __pyx_t_18 = PyTuple_New(2+__pyx_t_22); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 597, __pyx_L1_error)
+          __pyx_t_18 = PyTuple_New(2+__pyx_t_22); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 624, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_18);
           if (__pyx_t_23) {
             __Pyx_GIVEREF(__pyx_t_23); PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_23); __pyx_t_23 = NULL;
           }
           __Pyx_INCREF(__pyx_v_temp_diag);
           __Pyx_GIVEREF(__pyx_v_temp_diag);
           PyTuple_SET_ITEM(__pyx_t_18, 0+__pyx_t_22, __pyx_v_temp_diag);
           __Pyx_GIVEREF(__pyx_t_4);
           PyTuple_SET_ITEM(__pyx_t_18, 1+__pyx_t_22, __pyx_t_4);
           __pyx_t_4 = 0;
-          __pyx_t_15 = __Pyx_PyObject_Call(__pyx_t_19, __pyx_t_18, NULL); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 597, __pyx_L1_error)
+          __pyx_t_15 = __Pyx_PyObject_Call(__pyx_t_19, __pyx_t_18, NULL); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 624, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_15);
           __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
         }
         __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
-        __pyx_t_19 = PyNumber_InPlaceAdd(__pyx_t_21, __pyx_t_15); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 597, __pyx_L1_error)
+        __pyx_t_19 = PyNumber_InPlaceAdd(__pyx_t_21, __pyx_t_15); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 624, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_19);
         __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
         __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-        if (unlikely(PyObject_SetItem(__pyx_v_acc2d, __pyx_t_20, __pyx_t_19) < 0)) __PYX_ERR(0, 597, __pyx_L1_error)
+        if (unlikely(PyObject_SetItem(__pyx_v_acc2d, __pyx_t_20, __pyx_t_19) < 0)) __PYX_ERR(0, 624, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
 
-        /* "statmoments/_native.pyx":593
+        /* "statmoments/_native.pyx":620
  *         acc2d[k, :, l, :] += acc2d[k, :, q, :] * (binom(l + 1, q + 1) * delta[l - q - 1, np.newaxis, :])
  * 
  *       if k > 0:             # <<<<<<<<<<<<<<
  *         temp_diag[:] = np.diag(acc2d[k - 1, :, 0, :])
  *         for p in range(k - 1, 0, -1):
  */
       }
 
-      /* "statmoments/_native.pyx":599
+      /* "statmoments/_native.pyx":626
  *         acc2d[k, :, l, :] += np.outer(temp_diag, delta[l])
  * 
  *       if l > 0:             # <<<<<<<<<<<<<<
  *         temp_diag[:] = np.diag(acc2d[0, :, l - 1, :])
  *         for q in range(l - 1, 0, -1):
  */
-      __pyx_t_20 = PyObject_RichCompare(__pyx_v_l, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_20); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 599, __pyx_L1_error)
-      __pyx_t_27 = __Pyx_PyObject_IsTrue(__pyx_t_20); if (unlikely(__pyx_t_27 < 0)) __PYX_ERR(0, 599, __pyx_L1_error)
+      __pyx_t_20 = PyObject_RichCompare(__pyx_v_l, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_20); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 626, __pyx_L1_error)
+      __pyx_t_27 = __Pyx_PyObject_IsTrue(__pyx_t_20); if (unlikely(__pyx_t_27 < 0)) __PYX_ERR(0, 626, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
       if (__pyx_t_27) {
 
-        /* "statmoments/_native.pyx":600
+        /* "statmoments/_native.pyx":627
  * 
  *       if l > 0:
  *         temp_diag[:] = np.diag(acc2d[0, :, l - 1, :])             # <<<<<<<<<<<<<<
  *         for q in range(l - 1, 0, -1):
  *           temp_diag += np.diag(acc2d[0, :, q - 1, :]) * (binom(l + 1, q + 1) * delta[l - q - 1])
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_19, __pyx_n_s_np); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 600, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_19, __pyx_n_s_np); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 627, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_19);
-        __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_19, __pyx_n_s_diag); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 600, __pyx_L1_error)
+        __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_19, __pyx_n_s_diag); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 627, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_15);
         __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
-        __pyx_t_19 = __Pyx_PyInt_SubtractObjC(__pyx_v_l, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 600, __pyx_L1_error)
+        __pyx_t_19 = __Pyx_PyInt_SubtractObjC(__pyx_v_l, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 627, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_19);
-        __pyx_t_21 = PyTuple_New(4); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 600, __pyx_L1_error)
+        __pyx_t_21 = PyTuple_New(4); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 627, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_21);
         __Pyx_INCREF(__pyx_int_0);
         __Pyx_GIVEREF(__pyx_int_0);
         PyTuple_SET_ITEM(__pyx_t_21, 0, __pyx_int_0);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_21, 1, __pyx_slice__5);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_21, 1, __pyx_slice__7);
         __Pyx_GIVEREF(__pyx_t_19);
         PyTuple_SET_ITEM(__pyx_t_21, 2, __pyx_t_19);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_21, 3, __pyx_slice__5);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_21, 3, __pyx_slice__7);
         __pyx_t_19 = 0;
-        __pyx_t_19 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_21); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 600, __pyx_L1_error)
+        __pyx_t_19 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_21); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 627, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_19);
         __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
         __pyx_t_21 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_15))) {
           __pyx_t_21 = PyMethod_GET_SELF(__pyx_t_15);
           if (likely(__pyx_t_21)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_15);
@@ -20256,115 +20501,115 @@
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_15, function);
           }
         }
         __pyx_t_20 = (__pyx_t_21) ? __Pyx_PyObject_Call2Args(__pyx_t_15, __pyx_t_21, __pyx_t_19) : __Pyx_PyObject_CallOneArg(__pyx_t_15, __pyx_t_19);
         __Pyx_XDECREF(__pyx_t_21); __pyx_t_21 = 0;
         __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
-        if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 600, __pyx_L1_error)
+        if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 627, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
         __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-        if (__Pyx_PyObject_SetSlice(__pyx_v_temp_diag, __pyx_t_20, 0, 0, NULL, NULL, &__pyx_slice__5, 0, 0, 0) < 0) __PYX_ERR(0, 600, __pyx_L1_error)
+        if (__Pyx_PyObject_SetSlice(__pyx_v_temp_diag, __pyx_t_20, 0, 0, NULL, NULL, &__pyx_slice__7, 0, 0, 0) < 0) __PYX_ERR(0, 627, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
 
-        /* "statmoments/_native.pyx":601
+        /* "statmoments/_native.pyx":628
  *       if l > 0:
  *         temp_diag[:] = np.diag(acc2d[0, :, l - 1, :])
  *         for q in range(l - 1, 0, -1):             # <<<<<<<<<<<<<<
  *           temp_diag += np.diag(acc2d[0, :, q - 1, :]) * (binom(l + 1, q + 1) * delta[l - q - 1])
  *         acc2d[k, :, l, :] += np.outer(delta[k], temp_diag)
  */
-        __pyx_t_20 = __Pyx_PyInt_SubtractObjC(__pyx_v_l, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 601, __pyx_L1_error)
+        __pyx_t_20 = __Pyx_PyInt_SubtractObjC(__pyx_v_l, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 628, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
-        __pyx_t_15 = PyTuple_New(3); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 601, __pyx_L1_error)
+        __pyx_t_15 = PyTuple_New(3); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 628, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_15);
         __Pyx_GIVEREF(__pyx_t_20);
         PyTuple_SET_ITEM(__pyx_t_15, 0, __pyx_t_20);
         __Pyx_INCREF(__pyx_int_0);
         __Pyx_GIVEREF(__pyx_int_0);
         PyTuple_SET_ITEM(__pyx_t_15, 1, __pyx_int_0);
         __Pyx_INCREF(__pyx_int_neg_1);
         __Pyx_GIVEREF(__pyx_int_neg_1);
         PyTuple_SET_ITEM(__pyx_t_15, 2, __pyx_int_neg_1);
         __pyx_t_20 = 0;
-        __pyx_t_20 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_15, NULL); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 601, __pyx_L1_error)
+        __pyx_t_20 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_15, NULL); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 628, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
         __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
         if (likely(PyList_CheckExact(__pyx_t_20)) || PyTuple_CheckExact(__pyx_t_20)) {
           __pyx_t_15 = __pyx_t_20; __Pyx_INCREF(__pyx_t_15); __pyx_t_13 = 0;
           __pyx_t_14 = NULL;
         } else {
-          __pyx_t_13 = -1; __pyx_t_15 = PyObject_GetIter(__pyx_t_20); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 601, __pyx_L1_error)
+          __pyx_t_13 = -1; __pyx_t_15 = PyObject_GetIter(__pyx_t_20); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 628, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_15);
-          __pyx_t_14 = Py_TYPE(__pyx_t_15)->tp_iternext; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 601, __pyx_L1_error)
+          __pyx_t_14 = Py_TYPE(__pyx_t_15)->tp_iternext; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 628, __pyx_L1_error)
         }
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
         for (;;) {
           if (likely(!__pyx_t_14)) {
             if (likely(PyList_CheckExact(__pyx_t_15))) {
               if (__pyx_t_13 >= PyList_GET_SIZE(__pyx_t_15)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_20 = PyList_GET_ITEM(__pyx_t_15, __pyx_t_13); __Pyx_INCREF(__pyx_t_20); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 601, __pyx_L1_error)
+              __pyx_t_20 = PyList_GET_ITEM(__pyx_t_15, __pyx_t_13); __Pyx_INCREF(__pyx_t_20); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 628, __pyx_L1_error)
               #else
-              __pyx_t_20 = PySequence_ITEM(__pyx_t_15, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 601, __pyx_L1_error)
+              __pyx_t_20 = PySequence_ITEM(__pyx_t_15, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 628, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_20);
               #endif
             } else {
               if (__pyx_t_13 >= PyTuple_GET_SIZE(__pyx_t_15)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_20 = PyTuple_GET_ITEM(__pyx_t_15, __pyx_t_13); __Pyx_INCREF(__pyx_t_20); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 601, __pyx_L1_error)
+              __pyx_t_20 = PyTuple_GET_ITEM(__pyx_t_15, __pyx_t_13); __Pyx_INCREF(__pyx_t_20); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 628, __pyx_L1_error)
               #else
-              __pyx_t_20 = PySequence_ITEM(__pyx_t_15, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 601, __pyx_L1_error)
+              __pyx_t_20 = PySequence_ITEM(__pyx_t_15, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 628, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_20);
               #endif
             }
           } else {
             __pyx_t_20 = __pyx_t_14(__pyx_t_15);
             if (unlikely(!__pyx_t_20)) {
               PyObject* exc_type = PyErr_Occurred();
               if (exc_type) {
                 if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                else __PYX_ERR(0, 601, __pyx_L1_error)
+                else __PYX_ERR(0, 628, __pyx_L1_error)
               }
               break;
             }
             __Pyx_GOTREF(__pyx_t_20);
           }
           __Pyx_XDECREF_SET(__pyx_v_q, __pyx_t_20);
           __pyx_t_20 = 0;
 
-          /* "statmoments/_native.pyx":602
+          /* "statmoments/_native.pyx":629
  *         temp_diag[:] = np.diag(acc2d[0, :, l - 1, :])
  *         for q in range(l - 1, 0, -1):
  *           temp_diag += np.diag(acc2d[0, :, q - 1, :]) * (binom(l + 1, q + 1) * delta[l - q - 1])             # <<<<<<<<<<<<<<
  *         acc2d[k, :, l, :] += np.outer(delta[k], temp_diag)
  * 
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_19, __pyx_n_s_np); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 602, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_19, __pyx_n_s_np); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 629, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_19);
-          __pyx_t_21 = __Pyx_PyObject_GetAttrStr(__pyx_t_19, __pyx_n_s_diag); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 602, __pyx_L1_error)
+          __pyx_t_21 = __Pyx_PyObject_GetAttrStr(__pyx_t_19, __pyx_n_s_diag); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 629, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_21);
           __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
-          __pyx_t_19 = __Pyx_PyInt_SubtractObjC(__pyx_v_q, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 602, __pyx_L1_error)
+          __pyx_t_19 = __Pyx_PyInt_SubtractObjC(__pyx_v_q, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 629, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_19);
-          __pyx_t_18 = PyTuple_New(4); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 602, __pyx_L1_error)
+          __pyx_t_18 = PyTuple_New(4); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 629, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_18);
           __Pyx_INCREF(__pyx_int_0);
           __Pyx_GIVEREF(__pyx_int_0);
           PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_int_0);
-          __Pyx_INCREF(__pyx_slice__5);
-          __Pyx_GIVEREF(__pyx_slice__5);
-          PyTuple_SET_ITEM(__pyx_t_18, 1, __pyx_slice__5);
+          __Pyx_INCREF(__pyx_slice__7);
+          __Pyx_GIVEREF(__pyx_slice__7);
+          PyTuple_SET_ITEM(__pyx_t_18, 1, __pyx_slice__7);
           __Pyx_GIVEREF(__pyx_t_19);
           PyTuple_SET_ITEM(__pyx_t_18, 2, __pyx_t_19);
-          __Pyx_INCREF(__pyx_slice__5);
-          __Pyx_GIVEREF(__pyx_slice__5);
-          PyTuple_SET_ITEM(__pyx_t_18, 3, __pyx_slice__5);
+          __Pyx_INCREF(__pyx_slice__7);
+          __Pyx_GIVEREF(__pyx_slice__7);
+          PyTuple_SET_ITEM(__pyx_t_18, 3, __pyx_slice__7);
           __pyx_t_19 = 0;
-          __pyx_t_19 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_18); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 602, __pyx_L1_error)
+          __pyx_t_19 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_18); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 629, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_19);
           __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
           __pyx_t_18 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_21))) {
             __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_21);
             if (likely(__pyx_t_18)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_21);
@@ -20372,22 +20617,22 @@
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_21, function);
             }
           }
           __pyx_t_20 = (__pyx_t_18) ? __Pyx_PyObject_Call2Args(__pyx_t_21, __pyx_t_18, __pyx_t_19) : __Pyx_PyObject_CallOneArg(__pyx_t_21, __pyx_t_19);
           __Pyx_XDECREF(__pyx_t_18); __pyx_t_18 = 0;
           __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
-          if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 602, __pyx_L1_error)
+          if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 629, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_20);
           __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
-          __Pyx_GetModuleGlobalName(__pyx_t_19, __pyx_n_s_binom); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 602, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_19, __pyx_n_s_binom); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 629, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_19);
-          __pyx_t_18 = __Pyx_PyInt_AddObjC(__pyx_v_l, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 602, __pyx_L1_error)
+          __pyx_t_18 = __Pyx_PyInt_AddObjC(__pyx_v_l, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 629, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_18);
-          __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_v_q, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 602, __pyx_L1_error)
+          __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_v_q, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 629, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
           __pyx_t_23 = NULL;
           __pyx_t_22 = 0;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_19))) {
             __pyx_t_23 = PyMethod_GET_SELF(__pyx_t_19);
             if (likely(__pyx_t_23)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_19);
@@ -20396,109 +20641,109 @@
               __Pyx_DECREF_SET(__pyx_t_19, function);
               __pyx_t_22 = 1;
             }
           }
           #if CYTHON_FAST_PYCALL
           if (PyFunction_Check(__pyx_t_19)) {
             PyObject *__pyx_temp[3] = {__pyx_t_23, __pyx_t_18, __pyx_t_4};
-            __pyx_t_21 = __Pyx_PyFunction_FastCall(__pyx_t_19, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 602, __pyx_L1_error)
+            __pyx_t_21 = __Pyx_PyFunction_FastCall(__pyx_t_19, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 629, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_23); __pyx_t_23 = 0;
             __Pyx_GOTREF(__pyx_t_21);
             __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           } else
           #endif
           #if CYTHON_FAST_PYCCALL
           if (__Pyx_PyFastCFunction_Check(__pyx_t_19)) {
             PyObject *__pyx_temp[3] = {__pyx_t_23, __pyx_t_18, __pyx_t_4};
-            __pyx_t_21 = __Pyx_PyCFunction_FastCall(__pyx_t_19, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 602, __pyx_L1_error)
+            __pyx_t_21 = __Pyx_PyCFunction_FastCall(__pyx_t_19, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 629, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_23); __pyx_t_23 = 0;
             __Pyx_GOTREF(__pyx_t_21);
             __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           } else
           #endif
           {
-            __pyx_t_26 = PyTuple_New(2+__pyx_t_22); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 602, __pyx_L1_error)
+            __pyx_t_26 = PyTuple_New(2+__pyx_t_22); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 629, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_26);
             if (__pyx_t_23) {
               __Pyx_GIVEREF(__pyx_t_23); PyTuple_SET_ITEM(__pyx_t_26, 0, __pyx_t_23); __pyx_t_23 = NULL;
             }
             __Pyx_GIVEREF(__pyx_t_18);
             PyTuple_SET_ITEM(__pyx_t_26, 0+__pyx_t_22, __pyx_t_18);
             __Pyx_GIVEREF(__pyx_t_4);
             PyTuple_SET_ITEM(__pyx_t_26, 1+__pyx_t_22, __pyx_t_4);
             __pyx_t_18 = 0;
             __pyx_t_4 = 0;
-            __pyx_t_21 = __Pyx_PyObject_Call(__pyx_t_19, __pyx_t_26, NULL); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 602, __pyx_L1_error)
+            __pyx_t_21 = __Pyx_PyObject_Call(__pyx_t_19, __pyx_t_26, NULL); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 629, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_21);
             __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
           }
           __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
-          __pyx_t_19 = PyNumber_Subtract(__pyx_v_l, __pyx_v_q); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 602, __pyx_L1_error)
+          __pyx_t_19 = PyNumber_Subtract(__pyx_v_l, __pyx_v_q); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 629, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_19);
-          __pyx_t_26 = __Pyx_PyInt_SubtractObjC(__pyx_t_19, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 602, __pyx_L1_error)
+          __pyx_t_26 = __Pyx_PyInt_SubtractObjC(__pyx_t_19, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 629, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_26);
           __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
-          __pyx_t_19 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_t_26); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 602, __pyx_L1_error)
+          __pyx_t_19 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_t_26); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 629, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_19);
           __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
-          __pyx_t_26 = PyNumber_Multiply(__pyx_t_21, __pyx_t_19); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 602, __pyx_L1_error)
+          __pyx_t_26 = PyNumber_Multiply(__pyx_t_21, __pyx_t_19); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 629, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_26);
           __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
           __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
-          __pyx_t_19 = PyNumber_Multiply(__pyx_t_20, __pyx_t_26); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 602, __pyx_L1_error)
+          __pyx_t_19 = PyNumber_Multiply(__pyx_t_20, __pyx_t_26); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 629, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_19);
           __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
           __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
-          __pyx_t_26 = PyNumber_InPlaceAdd(__pyx_v_temp_diag, __pyx_t_19); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 602, __pyx_L1_error)
+          __pyx_t_26 = PyNumber_InPlaceAdd(__pyx_v_temp_diag, __pyx_t_19); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 629, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_26);
           __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
           __Pyx_DECREF_SET(__pyx_v_temp_diag, __pyx_t_26);
           __pyx_t_26 = 0;
 
-          /* "statmoments/_native.pyx":601
+          /* "statmoments/_native.pyx":628
  *       if l > 0:
  *         temp_diag[:] = np.diag(acc2d[0, :, l - 1, :])
  *         for q in range(l - 1, 0, -1):             # <<<<<<<<<<<<<<
  *           temp_diag += np.diag(acc2d[0, :, q - 1, :]) * (binom(l + 1, q + 1) * delta[l - q - 1])
  *         acc2d[k, :, l, :] += np.outer(delta[k], temp_diag)
  */
         }
         __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
 
-        /* "statmoments/_native.pyx":603
+        /* "statmoments/_native.pyx":630
  *         for q in range(l - 1, 0, -1):
  *           temp_diag += np.diag(acc2d[0, :, q - 1, :]) * (binom(l + 1, q + 1) * delta[l - q - 1])
  *         acc2d[k, :, l, :] += np.outer(delta[k], temp_diag)             # <<<<<<<<<<<<<<
  * 
  *       acc2d[k, :, l, :] += n1 * np.outer(delta[k], delta[l])
  */
-        __pyx_t_15 = PyTuple_New(4); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 603, __pyx_L1_error)
+        __pyx_t_15 = PyTuple_New(4); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 630, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_15);
         __Pyx_INCREF(__pyx_v_k);
         __Pyx_GIVEREF(__pyx_v_k);
         PyTuple_SET_ITEM(__pyx_t_15, 0, __pyx_v_k);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_15, 1, __pyx_slice__5);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_15, 1, __pyx_slice__7);
         __Pyx_INCREF(__pyx_v_l);
         __Pyx_GIVEREF(__pyx_v_l);
         PyTuple_SET_ITEM(__pyx_t_15, 2, __pyx_v_l);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_15, 3, __pyx_slice__5);
-        __pyx_t_26 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_15); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 603, __pyx_L1_error)
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_15, 3, __pyx_slice__7);
+        __pyx_t_26 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_15); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 630, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_26);
-        __Pyx_GetModuleGlobalName(__pyx_t_20, __pyx_n_s_np); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 603, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_20, __pyx_n_s_np); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 630, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
-        __pyx_t_21 = __Pyx_PyObject_GetAttrStr(__pyx_t_20, __pyx_n_s_outer); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 603, __pyx_L1_error)
+        __pyx_t_21 = __Pyx_PyObject_GetAttrStr(__pyx_t_20, __pyx_n_s_outer); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 630, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_21);
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-        __pyx_t_20 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_v_k); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 603, __pyx_L1_error)
+        __pyx_t_20 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_v_k); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 630, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
         __pyx_t_4 = NULL;
         __pyx_t_22 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_21))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_21);
           if (likely(__pyx_t_4)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_21);
@@ -20507,94 +20752,94 @@
             __Pyx_DECREF_SET(__pyx_t_21, function);
             __pyx_t_22 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_21)) {
           PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_20, __pyx_v_temp_diag};
-          __pyx_t_19 = __Pyx_PyFunction_FastCall(__pyx_t_21, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 603, __pyx_L1_error)
+          __pyx_t_19 = __Pyx_PyFunction_FastCall(__pyx_t_21, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 630, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_GOTREF(__pyx_t_19);
           __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_21)) {
           PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_20, __pyx_v_temp_diag};
-          __pyx_t_19 = __Pyx_PyCFunction_FastCall(__pyx_t_21, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 603, __pyx_L1_error)
+          __pyx_t_19 = __Pyx_PyCFunction_FastCall(__pyx_t_21, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 630, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_GOTREF(__pyx_t_19);
           __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
         } else
         #endif
         {
-          __pyx_t_18 = PyTuple_New(2+__pyx_t_22); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 603, __pyx_L1_error)
+          __pyx_t_18 = PyTuple_New(2+__pyx_t_22); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 630, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_18);
           if (__pyx_t_4) {
             __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_4); __pyx_t_4 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_20);
           PyTuple_SET_ITEM(__pyx_t_18, 0+__pyx_t_22, __pyx_t_20);
           __Pyx_INCREF(__pyx_v_temp_diag);
           __Pyx_GIVEREF(__pyx_v_temp_diag);
           PyTuple_SET_ITEM(__pyx_t_18, 1+__pyx_t_22, __pyx_v_temp_diag);
           __pyx_t_20 = 0;
-          __pyx_t_19 = __Pyx_PyObject_Call(__pyx_t_21, __pyx_t_18, NULL); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 603, __pyx_L1_error)
+          __pyx_t_19 = __Pyx_PyObject_Call(__pyx_t_21, __pyx_t_18, NULL); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 630, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_19);
           __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
         }
         __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
-        __pyx_t_21 = PyNumber_InPlaceAdd(__pyx_t_26, __pyx_t_19); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 603, __pyx_L1_error)
+        __pyx_t_21 = PyNumber_InPlaceAdd(__pyx_t_26, __pyx_t_19); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 630, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_21);
         __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
         __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
-        if (unlikely(PyObject_SetItem(__pyx_v_acc2d, __pyx_t_15, __pyx_t_21) < 0)) __PYX_ERR(0, 603, __pyx_L1_error)
+        if (unlikely(PyObject_SetItem(__pyx_v_acc2d, __pyx_t_15, __pyx_t_21) < 0)) __PYX_ERR(0, 630, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
         __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
 
-        /* "statmoments/_native.pyx":599
+        /* "statmoments/_native.pyx":626
  *         acc2d[k, :, l, :] += np.outer(temp_diag, delta[l])
  * 
  *       if l > 0:             # <<<<<<<<<<<<<<
  *         temp_diag[:] = np.diag(acc2d[0, :, l - 1, :])
  *         for q in range(l - 1, 0, -1):
  */
       }
 
-      /* "statmoments/_native.pyx":605
+      /* "statmoments/_native.pyx":632
  *         acc2d[k, :, l, :] += np.outer(delta[k], temp_diag)
  * 
  *       acc2d[k, :, l, :] += n1 * np.outer(delta[k], delta[l])             # <<<<<<<<<<<<<<
  * 
  * def _calc_comoments(MM, lm, rm, normalize):
  */
-      __pyx_t_15 = PyTuple_New(4); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 605, __pyx_L1_error)
+      __pyx_t_15 = PyTuple_New(4); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 632, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_15);
       __Pyx_INCREF(__pyx_v_k);
       __Pyx_GIVEREF(__pyx_v_k);
       PyTuple_SET_ITEM(__pyx_t_15, 0, __pyx_v_k);
-      __Pyx_INCREF(__pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_slice__5);
-      PyTuple_SET_ITEM(__pyx_t_15, 1, __pyx_slice__5);
+      __Pyx_INCREF(__pyx_slice__7);
+      __Pyx_GIVEREF(__pyx_slice__7);
+      PyTuple_SET_ITEM(__pyx_t_15, 1, __pyx_slice__7);
       __Pyx_INCREF(__pyx_v_l);
       __Pyx_GIVEREF(__pyx_v_l);
       PyTuple_SET_ITEM(__pyx_t_15, 2, __pyx_v_l);
-      __Pyx_INCREF(__pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_slice__5);
-      PyTuple_SET_ITEM(__pyx_t_15, 3, __pyx_slice__5);
-      __pyx_t_21 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_15); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 605, __pyx_L1_error)
+      __Pyx_INCREF(__pyx_slice__7);
+      __Pyx_GIVEREF(__pyx_slice__7);
+      PyTuple_SET_ITEM(__pyx_t_15, 3, __pyx_slice__7);
+      __pyx_t_21 = __Pyx_PyObject_GetItem(__pyx_v_acc2d, __pyx_t_15); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 632, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_21);
-      __Pyx_GetModuleGlobalName(__pyx_t_26, __pyx_n_s_np); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 605, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_26, __pyx_n_s_np); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 632, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_26);
-      __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_t_26, __pyx_n_s_outer); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 605, __pyx_L1_error)
+      __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_t_26, __pyx_n_s_outer); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 632, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_18);
       __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
-      __pyx_t_26 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_v_k); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 605, __pyx_L1_error)
+      __pyx_t_26 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_v_k); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 632, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_26);
-      __pyx_t_20 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_v_l); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 605, __pyx_L1_error)
+      __pyx_t_20 = __Pyx_PyObject_GetItem(__pyx_v_delta, __pyx_v_l); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 632, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_20);
       __pyx_t_4 = NULL;
       __pyx_t_22 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_18))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_18);
         if (likely(__pyx_t_4)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_18);
@@ -20603,80 +20848,80 @@
           __Pyx_DECREF_SET(__pyx_t_18, function);
           __pyx_t_22 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_18)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_26, __pyx_t_20};
-        __pyx_t_19 = __Pyx_PyFunction_FastCall(__pyx_t_18, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 605, __pyx_L1_error)
+        __pyx_t_19 = __Pyx_PyFunction_FastCall(__pyx_t_18, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 632, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_19);
         __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_18)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_26, __pyx_t_20};
-        __pyx_t_19 = __Pyx_PyCFunction_FastCall(__pyx_t_18, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 605, __pyx_L1_error)
+        __pyx_t_19 = __Pyx_PyCFunction_FastCall(__pyx_t_18, __pyx_temp+1-__pyx_t_22, 2+__pyx_t_22); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 632, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_19);
         __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
       } else
       #endif
       {
-        __pyx_t_23 = PyTuple_New(2+__pyx_t_22); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 605, __pyx_L1_error)
+        __pyx_t_23 = PyTuple_New(2+__pyx_t_22); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 632, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_23);
         if (__pyx_t_4) {
           __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_23, 0, __pyx_t_4); __pyx_t_4 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_26);
         PyTuple_SET_ITEM(__pyx_t_23, 0+__pyx_t_22, __pyx_t_26);
         __Pyx_GIVEREF(__pyx_t_20);
         PyTuple_SET_ITEM(__pyx_t_23, 1+__pyx_t_22, __pyx_t_20);
         __pyx_t_26 = 0;
         __pyx_t_20 = 0;
-        __pyx_t_19 = __Pyx_PyObject_Call(__pyx_t_18, __pyx_t_23, NULL); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 605, __pyx_L1_error)
+        __pyx_t_19 = __Pyx_PyObject_Call(__pyx_t_18, __pyx_t_23, NULL); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 632, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_19);
         __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
       }
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-      __pyx_t_18 = PyNumber_Multiply(__pyx_v_n1, __pyx_t_19); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 605, __pyx_L1_error)
+      __pyx_t_18 = PyNumber_Multiply(__pyx_v_n1, __pyx_t_19); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 632, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_18);
       __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
-      __pyx_t_19 = PyNumber_InPlaceAdd(__pyx_t_21, __pyx_t_18); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 605, __pyx_L1_error)
+      __pyx_t_19 = PyNumber_InPlaceAdd(__pyx_t_21, __pyx_t_18); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 632, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_19);
       __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-      if (unlikely(PyObject_SetItem(__pyx_v_acc2d, __pyx_t_15, __pyx_t_19) < 0)) __PYX_ERR(0, 605, __pyx_L1_error)
+      if (unlikely(PyObject_SetItem(__pyx_v_acc2d, __pyx_t_15, __pyx_t_19) < 0)) __PYX_ERR(0, 632, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
 
-      /* "statmoments/_native.pyx":581
+      /* "statmoments/_native.pyx":608
  *   temp_diag = np.empty_like(acc1d)
  *   for k in range(moment - 1, -1, -1):
  *     for l in range(moment - 1, -1, -1):             # <<<<<<<<<<<<<<
  * 
  *       for p in range(k - 1, -1, -1):
  */
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "statmoments/_native.pyx":580
+    /* "statmoments/_native.pyx":607
  *   acc1d[:] -= delta[0]
  *   temp_diag = np.empty_like(acc1d)
  *   for k in range(moment - 1, -1, -1):             # <<<<<<<<<<<<<<
  *     for l in range(moment - 1, -1, -1):
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":557
+  /* "statmoments/_native.pyx":584
  *   return com
  * 
  * def update_moments(acc2d, acc1d, n1, moment, traces):             # <<<<<<<<<<<<<<
  *   # The update method:
  *   # x - ave2 = x + (ave1 - ave1) - ave2 = x - ave1 + (ave1 - ave2)
  */
 
@@ -20714,26 +20959,26 @@
   __Pyx_XDECREF(__pyx_v_q);
   __Pyx_XDECREF(__pyx_v_da);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":607
+/* "statmoments/_native.pyx":634
  *       acc2d[k, :, l, :] += n1 * np.outer(delta[k], delta[l])
  * 
  * def _calc_comoments(MM, lm, rm, normalize):             # <<<<<<<<<<<<<<
  *   # Find the coefficients with the required degree for the left part and the right part
  *   # lm - left_moment, rm - right_moment
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11statmoments_7_native_11_calc_comoments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_11statmoments_7_native_11_calc_comoments = {"_calc_comoments", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_11_calc_comoments, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11statmoments_7_native_11_calc_comoments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_11statmoments_7_native_13_calc_comoments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_11statmoments_7_native_13_calc_comoments = {"_calc_comoments", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_13_calc_comoments, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11statmoments_7_native_13_calc_comoments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_MM = 0;
   PyObject *__pyx_v_lm = 0;
   PyObject *__pyx_v_rm = 0;
   PyObject *__pyx_v_normalize = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
@@ -20763,31 +21008,31 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_MM)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_lm)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_calc_comoments", 1, 4, 4, 1); __PYX_ERR(0, 607, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_calc_comoments", 1, 4, 4, 1); __PYX_ERR(0, 634, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_rm)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_calc_comoments", 1, 4, 4, 2); __PYX_ERR(0, 607, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_calc_comoments", 1, 4, 4, 2); __PYX_ERR(0, 634, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_normalize)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_calc_comoments", 1, 4, 4, 3); __PYX_ERR(0, 607, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_calc_comoments", 1, 4, 4, 3); __PYX_ERR(0, 634, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_calc_comoments") < 0)) __PYX_ERR(0, 607, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_calc_comoments") < 0)) __PYX_ERR(0, 634, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -20796,28 +21041,28 @@
     __pyx_v_MM = values[0];
     __pyx_v_lm = values[1];
     __pyx_v_rm = values[2];
     __pyx_v_normalize = values[3];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_calc_comoments", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 607, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_calc_comoments", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 634, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native._calc_comoments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11statmoments_7_native_10_calc_comoments(__pyx_self, __pyx_v_MM, __pyx_v_lm, __pyx_v_rm, __pyx_v_normalize);
+  __pyx_r = __pyx_pf_11statmoments_7_native_12_calc_comoments(__pyx_self, __pyx_v_MM, __pyx_v_lm, __pyx_v_rm, __pyx_v_normalize);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11statmoments_7_native_10_calc_comoments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_MM, PyObject *__pyx_v_lm, PyObject *__pyx_v_rm, PyObject *__pyx_v_normalize) {
+static PyObject *__pyx_pf_11statmoments_7_native_12_calc_comoments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_MM, PyObject *__pyx_v_lm, PyObject *__pyx_v_rm, PyObject *__pyx_v_normalize) {
   PyObject *__pyx_v_m = NULL;
   PyObject *__pyx_v_sd = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
@@ -20828,101 +21073,101 @@
   PyObject *__pyx_t_8 = NULL;
   int __pyx_t_9;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_calc_comoments", 0);
 
-  /* "statmoments/_native.pyx":610
+  /* "statmoments/_native.pyx":637
  *   # Find the coefficients with the required degree for the left part and the right part
  *   # lm - left_moment, rm - right_moment
  *   m = MM[lm - 1, :, rm - 1, :]             # <<<<<<<<<<<<<<
  *   if (lm + rm) >= 3 and normalize:
  *     sd = np.sqrt(np.diag(MM[0, :, 0, :]))
  */
-  __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_v_lm, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 610, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_v_lm, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 637, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_v_rm, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 610, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_v_rm, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 637, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 610, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 637, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
-  __Pyx_INCREF(__pyx_slice__5);
-  __Pyx_GIVEREF(__pyx_slice__5);
-  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_slice__5);
+  __Pyx_INCREF(__pyx_slice__7);
+  __Pyx_GIVEREF(__pyx_slice__7);
+  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_slice__7);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_2);
-  __Pyx_INCREF(__pyx_slice__5);
-  __Pyx_GIVEREF(__pyx_slice__5);
-  PyTuple_SET_ITEM(__pyx_t_3, 3, __pyx_slice__5);
+  __Pyx_INCREF(__pyx_slice__7);
+  __Pyx_GIVEREF(__pyx_slice__7);
+  PyTuple_SET_ITEM(__pyx_t_3, 3, __pyx_slice__7);
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_MM, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 610, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_MM, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 637, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_m = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":611
+  /* "statmoments/_native.pyx":638
  *   # lm - left_moment, rm - right_moment
  *   m = MM[lm - 1, :, rm - 1, :]
  *   if (lm + rm) >= 3 and normalize:             # <<<<<<<<<<<<<<
  *     sd = np.sqrt(np.diag(MM[0, :, 0, :]))
  *     m /= np.outer(sd ** lm, sd ** rm)
  */
-  __pyx_t_2 = PyNumber_Add(__pyx_v_lm, __pyx_v_rm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 611, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Add(__pyx_v_lm, __pyx_v_rm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 638, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, __pyx_int_3, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 611, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, __pyx_int_3, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 638, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 611, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 638, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_5) {
   } else {
     __pyx_t_4 = __pyx_t_5;
     goto __pyx_L4_bool_binop_done;
   }
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_v_normalize); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 611, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_v_normalize); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 638, __pyx_L1_error)
   __pyx_t_4 = __pyx_t_5;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_4) {
 
-    /* "statmoments/_native.pyx":612
+    /* "statmoments/_native.pyx":639
  *   m = MM[lm - 1, :, rm - 1, :]
  *   if (lm + rm) >= 3 and normalize:
  *     sd = np.sqrt(np.diag(MM[0, :, 0, :]))             # <<<<<<<<<<<<<<
  *     m /= np.outer(sd ** lm, sd ** rm)
  *   return m
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 612, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 639, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 612, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 639, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 612, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 639, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_diag); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 612, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_diag); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 639, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_MM, __pyx_tuple__6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 612, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_MM, __pyx_tuple__8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 639, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_8 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_8)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_8);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_2 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_8, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_6);
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 612, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 639, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
@@ -20930,35 +21175,35 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_3 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_7, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_2);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 612, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 639, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_v_sd = __pyx_t_3;
     __pyx_t_3 = 0;
 
-    /* "statmoments/_native.pyx":613
+    /* "statmoments/_native.pyx":640
  *   if (lm + rm) >= 3 and normalize:
  *     sd = np.sqrt(np.diag(MM[0, :, 0, :]))
  *     m /= np.outer(sd ** lm, sd ** rm)             # <<<<<<<<<<<<<<
  *   return m
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 613, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 640, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_outer); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 613, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_outer); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 640, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Power(__pyx_v_sd, __pyx_v_lm, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 613, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Power(__pyx_v_sd, __pyx_v_lm, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 640, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = PyNumber_Power(__pyx_v_sd, __pyx_v_rm, Py_None); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 613, __pyx_L1_error)
+    __pyx_t_7 = PyNumber_Power(__pyx_v_sd, __pyx_v_rm, Py_None); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 640, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_6 = NULL;
     __pyx_t_9 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -20967,76 +21212,76 @@
         __Pyx_DECREF_SET(__pyx_t_2, function);
         __pyx_t_9 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_t_1, __pyx_t_7};
-      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 613, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 640, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_t_1, __pyx_t_7};
-      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 613, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 640, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     {
-      __pyx_t_8 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 613, __pyx_L1_error)
+      __pyx_t_8 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 640, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       if (__pyx_t_6) {
         __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_1);
       PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_9, __pyx_t_1);
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_9, __pyx_t_7);
       __pyx_t_1 = 0;
       __pyx_t_7 = 0;
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_8, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 613, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_8, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 640, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyNumber_InPlaceDivide(__pyx_v_m, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 613, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyNumber_InPlaceDivide(__pyx_v_m, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 640, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF_SET(__pyx_v_m, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "statmoments/_native.pyx":611
+    /* "statmoments/_native.pyx":638
  *   # lm - left_moment, rm - right_moment
  *   m = MM[lm - 1, :, rm - 1, :]
  *   if (lm + rm) >= 3 and normalize:             # <<<<<<<<<<<<<<
  *     sd = np.sqrt(np.diag(MM[0, :, 0, :]))
  *     m /= np.outer(sd ** lm, sd ** rm)
  */
   }
 
-  /* "statmoments/_native.pyx":614
+  /* "statmoments/_native.pyx":641
  *     sd = np.sqrt(np.diag(MM[0, :, 0, :]))
  *     m /= np.outer(sd ** lm, sd ** rm)
  *   return m             # <<<<<<<<<<<<<<
  * 
- * class bivar_cntr(_AccBase):
+ * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_m);
   __pyx_r = __pyx_v_m;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":607
+  /* "statmoments/_native.pyx":634
  *       acc2d[k, :, l, :] += n1 * np.outer(delta[k], delta[l])
  * 
  * def _calc_comoments(MM, lm, rm, normalize):             # <<<<<<<<<<<<<<
  *   # Find the coefficients with the required degree for the left part and the right part
  *   # lm - left_moment, rm - right_moment
  */
 
@@ -21054,15 +21299,15 @@
   __Pyx_XDECREF(__pyx_v_m);
   __Pyx_XDECREF(__pyx_v_sd);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":618
+/* "statmoments/_native.pyx":646
  * class bivar_cntr(_AccBase):
  *   """A class, working with 2D accs, which track central moments"""
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  * 
  */
 
@@ -21103,40 +21348,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_trace_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 1); __PYX_ERR(0, 618, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 1); __PYX_ERR(0, 646, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifier_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 2); __PYX_ERR(0, 618, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 2); __PYX_ERR(0, 646, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 618, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 646, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_trace_len = values[1];
     __pyx_v_classifier_len = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 618, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 646, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
   __Pyx_AddTraceback("statmoments._native.bivar_cntr.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_10bivar_cntr___init__(__pyx_self, __pyx_v_self, __pyx_v_trace_len, __pyx_v_classifier_len, __pyx_v_kwargs);
@@ -21159,125 +21404,125 @@
   int __pyx_t_6;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "statmoments/_native.pyx":619
+  /* "statmoments/_native.pyx":647
  *   """A class, working with 2D accs, which track central moments"""
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, **kwargs)             # <<<<<<<<<<<<<<
  * 
  *     # Accumulators, storing full rectangles
  */
   __pyx_t_1 = __Pyx_CyFunction_GetClassObj(__pyx_self);
-  if (!__pyx_t_1) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 619, __pyx_L1_error) }
+  if (!__pyx_t_1) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 647, __pyx_L1_error) }
   __Pyx_INCREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 619, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 647, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __Pyx_INCREF(__pyx_v_self);
   __Pyx_GIVEREF(__pyx_v_self);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_self);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 619, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 647, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_init); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 619, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_init); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 647, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 619, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 647, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_trace_len);
   __Pyx_GIVEREF(__pyx_v_trace_len);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_trace_len);
   __Pyx_INCREF(__pyx_v_classifier_len);
   __Pyx_GIVEREF(__pyx_v_classifier_len);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_classifier_len);
-  __pyx_t_3 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 619, __pyx_L1_error)
+  __pyx_t_3 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 647, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 619, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 647, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":622
+  /* "statmoments/_native.pyx":650
  * 
  *     # Accumulators, storing full rectangles
  *     moment = self.moment             # <<<<<<<<<<<<<<
  *     self._accs1d = np.zeros((classifier_len, 2, trace_len), dtype=np.float64)
  *     self._accs2d = np.zeros((classifier_len, 2, moment, trace_len, moment, trace_len), dtype=np.float64)
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 622, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 650, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_v_moment = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":623
+  /* "statmoments/_native.pyx":651
  *     # Accumulators, storing full rectangles
  *     moment = self.moment
  *     self._accs1d = np.zeros((classifier_len, 2, trace_len), dtype=np.float64)             # <<<<<<<<<<<<<<
  *     self._accs2d = np.zeros((classifier_len, 2, moment, trace_len, moment, trace_len), dtype=np.float64)
- *     self._layout = np.empty((10, moment, trace_len), dtype=np.float64)
+ *     self._layout = np.empty((50, moment, trace_len), dtype=np.float64)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 651, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 651, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 651, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_v_classifier_len);
   __Pyx_GIVEREF(__pyx_v_classifier_len);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_classifier_len);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_2);
   __Pyx_INCREF(__pyx_v_trace_len);
   __Pyx_GIVEREF(__pyx_v_trace_len);
   PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_v_trace_len);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 651, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 651, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 651, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 651, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 623, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 651, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 651, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_accs1d, __pyx_t_5) < 0) __PYX_ERR(0, 623, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_accs1d, __pyx_t_5) < 0) __PYX_ERR(0, 651, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":624
+  /* "statmoments/_native.pyx":652
  *     moment = self.moment
  *     self._accs1d = np.zeros((classifier_len, 2, trace_len), dtype=np.float64)
  *     self._accs2d = np.zeros((classifier_len, 2, moment, trace_len, moment, trace_len), dtype=np.float64)             # <<<<<<<<<<<<<<
- *     self._layout = np.empty((10, moment, trace_len), dtype=np.float64)
+ *     self._layout = np.empty((50, moment, trace_len), dtype=np.float64)
  *     self._cls_count = np.zeros((classifier_len, 2), np.uint32)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 624, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 652, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 624, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 652, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyTuple_New(6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 624, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 652, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(__pyx_v_classifier_len);
   __Pyx_GIVEREF(__pyx_v_classifier_len);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_classifier_len);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_2);
@@ -21289,104 +21534,104 @@
   PyTuple_SET_ITEM(__pyx_t_5, 3, __pyx_v_trace_len);
   __Pyx_INCREF(__pyx_v_moment);
   __Pyx_GIVEREF(__pyx_v_moment);
   PyTuple_SET_ITEM(__pyx_t_5, 4, __pyx_v_moment);
   __Pyx_INCREF(__pyx_v_trace_len);
   __Pyx_GIVEREF(__pyx_v_trace_len);
   PyTuple_SET_ITEM(__pyx_t_5, 5, __pyx_v_trace_len);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 624, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 652, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 624, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 652, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 624, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 652, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 624, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 652, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 624, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 652, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 624, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 652, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_accs2d, __pyx_t_2) < 0) __PYX_ERR(0, 624, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_accs2d, __pyx_t_2) < 0) __PYX_ERR(0, 652, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":625
+  /* "statmoments/_native.pyx":653
  *     self._accs1d = np.zeros((classifier_len, 2, trace_len), dtype=np.float64)
  *     self._accs2d = np.zeros((classifier_len, 2, moment, trace_len, moment, trace_len), dtype=np.float64)
- *     self._layout = np.empty((10, moment, trace_len), dtype=np.float64)             # <<<<<<<<<<<<<<
+ *     self._layout = np.empty((50, moment, trace_len), dtype=np.float64)             # <<<<<<<<<<<<<<
  *     self._cls_count = np.zeros((classifier_len, 2), np.uint32)
- *     self._retm  = np.empty((2, 2, trace_len * (trace_len + 1) // 2))
+ *     self._retm = np.empty((2, 2, trace_len * (trace_len + 1) // 2))
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 625, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 653, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 625, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 653, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 625, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 653, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_INCREF(__pyx_int_10);
-  __Pyx_GIVEREF(__pyx_int_10);
-  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_10);
+  __Pyx_INCREF(__pyx_int_50);
+  __Pyx_GIVEREF(__pyx_int_50);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_50);
   __Pyx_INCREF(__pyx_v_moment);
   __Pyx_GIVEREF(__pyx_v_moment);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_moment);
   __Pyx_INCREF(__pyx_v_trace_len);
   __Pyx_GIVEREF(__pyx_v_trace_len);
   PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_trace_len);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 625, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 653, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 625, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 653, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 625, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 653, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 625, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 653, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 625, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 653, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 625, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 653, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_layout, __pyx_t_3) < 0) __PYX_ERR(0, 625, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_layout, __pyx_t_3) < 0) __PYX_ERR(0, 653, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":626
+  /* "statmoments/_native.pyx":654
  *     self._accs2d = np.zeros((classifier_len, 2, moment, trace_len, moment, trace_len), dtype=np.float64)
- *     self._layout = np.empty((10, moment, trace_len), dtype=np.float64)
+ *     self._layout = np.empty((50, moment, trace_len), dtype=np.float64)
  *     self._cls_count = np.zeros((classifier_len, 2), np.uint32)             # <<<<<<<<<<<<<<
- *     self._retm  = np.empty((2, 2, trace_len * (trace_len + 1) // 2))
+ *     self._retm = np.empty((2, 2, trace_len * (trace_len + 1) // 2))
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 626, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 654, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 626, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 654, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 626, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 654, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_v_classifier_len);
   __Pyx_GIVEREF(__pyx_v_classifier_len);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_classifier_len);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_int_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 626, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 654, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_uint32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 626, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_uint32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 654, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   __pyx_t_6 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
     if (likely(__pyx_t_5)) {
@@ -21396,72 +21641,72 @@
       __Pyx_DECREF_SET(__pyx_t_1, function);
       __pyx_t_6 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_1)) {
     PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_2, __pyx_t_4};
-    __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 626, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 654, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
     PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_2, __pyx_t_4};
-    __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 626, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 654, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   } else
   #endif
   {
-    __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 626, __pyx_L1_error)
+    __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 654, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     if (__pyx_t_5) {
       __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
     }
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_t_4);
     __pyx_t_2 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 626, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 654, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_cls_count, __pyx_t_3) < 0) __PYX_ERR(0, 626, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_cls_count, __pyx_t_3) < 0) __PYX_ERR(0, 654, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":627
- *     self._layout = np.empty((10, moment, trace_len), dtype=np.float64)
+  /* "statmoments/_native.pyx":655
+ *     self._layout = np.empty((50, moment, trace_len), dtype=np.float64)
  *     self._cls_count = np.zeros((classifier_len, 2), np.uint32)
- *     self._retm  = np.empty((2, 2, trace_len * (trace_len + 1) // 2))             # <<<<<<<<<<<<<<
+ *     self._retm = np.empty((2, 2, trace_len * (trace_len + 1) // 2))             # <<<<<<<<<<<<<<
  * 
  *   @staticmethod
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 627, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 655, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 627, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 655, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_v_trace_len, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 627, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_v_trace_len, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 655, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_v_trace_len, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 627, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_v_trace_len, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 655, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_4, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 627, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_4, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 655, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 627, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 655, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_int_2);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_2);
@@ -21477,21 +21722,21 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_7, function);
     }
   }
   __pyx_t_3 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_1, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 627, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 655, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_retm, __pyx_t_3) < 0) __PYX_ERR(0, 627, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_retm, __pyx_t_3) < 0) __PYX_ERR(0, 655, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":618
+  /* "statmoments/_native.pyx":646
  * class bivar_cntr(_AccBase):
  *   """A class, working with 2D accs, which track central moments"""
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  * 
  */
 
@@ -21510,37 +21755,37 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_moment);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":630
+/* "statmoments/_native.pyx":658
  * 
  *   @staticmethod
- *   def estimate_mem_size(tr_len, classifier_len=1, moment=2):             # <<<<<<<<<<<<<<
- *     #                   layout          acc_count                    accs1d                                             accs2d
- *     mem_class = 10*moment*tr_len + classifier_len*2 + classifier_len*2*tr_len + classifier_len*2*moment*tr_len*moment*tr_len
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *     exp_traces = 50  # Expected number of traces in the input batch
+ *     acc_dtype  = np.float64
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_11statmoments_7_native_10bivar_cntr_3estimate_mem_size(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_11statmoments_7_native_10bivar_cntr_3estimate_mem_size = {"estimate_mem_size", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_10bivar_cntr_3estimate_mem_size, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_11statmoments_7_native_10bivar_cntr_3estimate_mem_size(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_tr_len = 0;
-  PyObject *__pyx_v_classifier_len = 0;
+  PyObject *__pyx_v_cl_len = 0;
   PyObject *__pyx_v_moment = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("estimate_mem_size (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_tr_len,&__pyx_n_s_classifier_len,&__pyx_n_s_moment,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_tr_len,&__pyx_n_s_cl_len,&__pyx_n_s_moment,0};
     PyObject* values[3] = {0,0,0};
     values[1] = ((PyObject *)((PyObject *)__pyx_int_1));
     values[2] = ((PyObject *)((PyObject *)__pyx_int_2));
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
@@ -21557,162 +21802,310 @@
       switch (pos_args) {
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr_len)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifier_len);
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_cl_len);
           if (value) { values[1] = value; kw_args--; }
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moment);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "estimate_mem_size") < 0)) __PYX_ERR(0, 630, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "estimate_mem_size") < 0)) __PYX_ERR(0, 658, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_tr_len = values[0];
-    __pyx_v_classifier_len = values[1];
+    __pyx_v_cl_len = values[1];
     __pyx_v_moment = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("estimate_mem_size", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 630, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("estimate_mem_size", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 658, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native.bivar_cntr.estimate_mem_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11statmoments_7_native_10bivar_cntr_2estimate_mem_size(__pyx_self, __pyx_v_tr_len, __pyx_v_classifier_len, __pyx_v_moment);
+  __pyx_r = __pyx_pf_11statmoments_7_native_10bivar_cntr_2estimate_mem_size(__pyx_self, __pyx_v_tr_len, __pyx_v_cl_len, __pyx_v_moment);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11statmoments_7_native_10bivar_cntr_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tr_len, PyObject *__pyx_v_classifier_len, PyObject *__pyx_v_moment) {
-  PyObject *__pyx_v_mem_class = NULL;
+static PyObject *__pyx_pf_11statmoments_7_native_10bivar_cntr_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tr_len, PyObject *__pyx_v_cl_len, PyObject *__pyx_v_moment) {
+  PyObject *__pyx_v_exp_traces = NULL;
+  PyObject *__pyx_v_acc_dtype = NULL;
+  PyObject *__pyx_v_lytsz = NULL;
+  PyObject *__pyx_v_accs1dsz = NULL;
+  PyObject *__pyx_v_accs2dsz = NULL;
+  PyObject *__pyx_v_ttsz = NULL;
+  PyObject *__pyx_v_clssz = NULL;
+  PyObject *__pyx_v_ttstdsz = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
+  int __pyx_t_4;
+  PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("estimate_mem_size", 0);
 
-  /* "statmoments/_native.pyx":632
- *   def estimate_mem_size(tr_len, classifier_len=1, moment=2):
- *     #                   layout          acc_count                    accs1d                                             accs2d
- *     mem_class = 10*moment*tr_len + classifier_len*2 + classifier_len*2*tr_len + classifier_len*2*moment*tr_len*moment*tr_len             # <<<<<<<<<<<<<<
- *     return mem_class * classifier_len * 8
- * 
+  /* "statmoments/_native.pyx":659
+ *   @staticmethod
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):
+ *     exp_traces = 50  # Expected number of traces in the input batch             # <<<<<<<<<<<<<<
+ *     acc_dtype  = np.float64
+ *     lytsz      = exp_traces * moment * tr_len
  */
-  __pyx_t_1 = PyNumber_Multiply(__pyx_int_10, __pyx_v_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __Pyx_INCREF(__pyx_int_50);
+  __pyx_v_exp_traces = __pyx_int_50;
+
+  /* "statmoments/_native.pyx":660
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):
+ *     exp_traces = 50  # Expected number of traces in the input batch
+ *     acc_dtype  = np.float64             # <<<<<<<<<<<<<<
+ *     lytsz      = exp_traces * moment * tr_len
+ *     accs1dsz   = cl_len * 2 * tr_len
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 660, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyNumber_Multiply(__pyx_t_1, __pyx_v_tr_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 660, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Multiply(__pyx_v_classifier_len, __pyx_int_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_v_acc_dtype = __pyx_t_2;
+  __pyx_t_2 = 0;
+
+  /* "statmoments/_native.pyx":661
+ *     exp_traces = 50  # Expected number of traces in the input batch
+ *     acc_dtype  = np.float64
+ *     lytsz      = exp_traces * moment * tr_len             # <<<<<<<<<<<<<<
+ *     accs1dsz   = cl_len * 2 * tr_len
+ *     accs2dsz   = cl_len * 2 * (moment * tr_len) ** 2
+ */
+  __pyx_t_2 = PyNumber_Multiply(__pyx_v_exp_traces, __pyx_v_moment); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 661, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_2, __pyx_v_tr_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 661, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Add(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 632, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Multiply(__pyx_v_classifier_len, __pyx_int_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_v_lytsz = __pyx_t_1;
+  __pyx_t_1 = 0;
+
+  /* "statmoments/_native.pyx":662
+ *     acc_dtype  = np.float64
+ *     lytsz      = exp_traces * moment * tr_len
+ *     accs1dsz   = cl_len * 2 * tr_len             # <<<<<<<<<<<<<<
+ *     accs2dsz   = cl_len * 2 * (moment * tr_len) ** 2
+ *     ttsz       = 2 * 2 * tr_len * (tr_len + 1) // 2
+ */
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_cl_len, __pyx_int_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 662, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyNumber_Multiply(__pyx_t_1, __pyx_v_tr_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_t_1, __pyx_v_tr_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 662, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Add(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 632, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyNumber_Multiply(__pyx_v_classifier_len, __pyx_int_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_v_accs1dsz = __pyx_t_2;
+  __pyx_t_2 = 0;
+
+  /* "statmoments/_native.pyx":663
+ *     lytsz      = exp_traces * moment * tr_len
+ *     accs1dsz   = cl_len * 2 * tr_len
+ *     accs2dsz   = cl_len * 2 * (moment * tr_len) ** 2             # <<<<<<<<<<<<<<
+ *     ttsz       = 2 * 2 * tr_len * (tr_len + 1) // 2
+ *     clssz      = cl_len * 2
+ */
+  __pyx_t_2 = PyNumber_Multiply(__pyx_v_cl_len, __pyx_int_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 663, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_2, __pyx_v_moment); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_moment, __pyx_v_tr_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 663, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = PyNumber_Power(__pyx_t_1, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 663, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 663, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyNumber_Multiply(__pyx_t_3, __pyx_v_tr_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 632, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_2, __pyx_v_moment); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_v_accs2dsz = __pyx_t_1;
+  __pyx_t_1 = 0;
+
+  /* "statmoments/_native.pyx":664
+ *     accs1dsz   = cl_len * 2 * tr_len
+ *     accs2dsz   = cl_len * 2 * (moment * tr_len) ** 2
+ *     ttsz       = 2 * 2 * tr_len * (tr_len + 1) // 2             # <<<<<<<<<<<<<<
+ *     clssz      = cl_len * 2
+ *     # One additional square for std normalization for moments > 2
+ */
+  __pyx_t_1 = PyNumber_Multiply(__pyx_int_4, __pyx_v_tr_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 664, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_tr_len, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 664, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyNumber_Multiply(__pyx_t_3, __pyx_v_tr_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 664, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_2, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 664, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_v_mem_class = __pyx_t_3;
+  __pyx_v_ttsz = __pyx_t_3;
+  __pyx_t_3 = 0;
+
+  /* "statmoments/_native.pyx":665
+ *     accs2dsz   = cl_len * 2 * (moment * tr_len) ** 2
+ *     ttsz       = 2 * 2 * tr_len * (tr_len + 1) // 2
+ *     clssz      = cl_len * 2             # <<<<<<<<<<<<<<
+ *     # One additional square for std normalization for moments > 2
+ *     ttstdsz    = 0  if moment < 3 else tr_len + tr_len ** 2
+ */
+  __pyx_t_3 = PyNumber_Multiply(__pyx_v_cl_len, __pyx_int_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 665, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_v_clssz = __pyx_t_3;
+  __pyx_t_3 = 0;
+
+  /* "statmoments/_native.pyx":667
+ *     clssz      = cl_len * 2
+ *     # One additional square for std normalization for moments > 2
+ *     ttstdsz    = 0  if moment < 3 else tr_len + tr_len ** 2             # <<<<<<<<<<<<<<
+ *     return (lytsz + accs1dsz + accs2dsz) * np.finfo(acc_dtype).bits // 8 + (ttsz + ttstdsz) * 8 + clssz * 4
+ * 
+ */
+  __pyx_t_2 = PyObject_RichCompare(__pyx_v_moment, __pyx_int_3, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 667, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 667, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (__pyx_t_4) {
+    __Pyx_INCREF(__pyx_int_0);
+    __pyx_t_3 = __pyx_int_0;
+  } else {
+    __pyx_t_2 = PyNumber_Power(__pyx_v_tr_len, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 667, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_1 = PyNumber_Add(__pyx_v_tr_len, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 667, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_3 = __pyx_t_1;
+    __pyx_t_1 = 0;
+  }
+  __pyx_v_ttstdsz = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":633
- *     #                   layout          acc_count                    accs1d                                             accs2d
- *     mem_class = 10*moment*tr_len + classifier_len*2 + classifier_len*2*tr_len + classifier_len*2*moment*tr_len*moment*tr_len
- *     return mem_class * classifier_len * 8             # <<<<<<<<<<<<<<
+  /* "statmoments/_native.pyx":668
+ *     # One additional square for std normalization for moments > 2
+ *     ttstdsz    = 0  if moment < 3 else tr_len + tr_len ** 2
+ *     return (lytsz + accs1dsz + accs2dsz) * np.finfo(acc_dtype).bits // 8 + (ttsz + ttstdsz) * 8 + clssz * 4             # <<<<<<<<<<<<<<
  * 
  *   def memory_size(self):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_v_mem_class, __pyx_v_classifier_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 633, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Add(__pyx_v_lytsz, __pyx_v_accs1dsz); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 668, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyNumber_Multiply(__pyx_t_3, __pyx_int_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 633, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Add(__pyx_t_3, __pyx_v_accs2dsz); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 668, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 668, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_finfo); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 668, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = NULL;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
+    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
+    if (likely(__pyx_t_2)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
+      __Pyx_INCREF(__pyx_t_2);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_5, function);
+    }
+  }
+  __pyx_t_3 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_2, __pyx_v_acc_dtype) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_acc_dtype);
+  __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 668, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bits); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 668, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_r = __pyx_t_2;
-  __pyx_t_2 = 0;
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 668, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_3, __pyx_int_8, 8, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 668, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = PyNumber_Add(__pyx_v_ttsz, __pyx_v_ttstdsz); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 668, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_3, __pyx_int_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 668, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = PyNumber_Add(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 668, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_clssz, __pyx_int_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 668, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_5 = PyNumber_Add(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 668, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_r = __pyx_t_5;
+  __pyx_t_5 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":630
+  /* "statmoments/_native.pyx":658
  * 
  *   @staticmethod
- *   def estimate_mem_size(tr_len, classifier_len=1, moment=2):             # <<<<<<<<<<<<<<
- *     #                   layout          acc_count                    accs1d                                             accs2d
- *     mem_class = 10*moment*tr_len + classifier_len*2 + classifier_len*2*tr_len + classifier_len*2*moment*tr_len*moment*tr_len
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *     exp_traces = 50  # Expected number of traces in the input batch
+ *     acc_dtype  = np.float64
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_5);
   __Pyx_AddTraceback("statmoments._native.bivar_cntr.estimate_mem_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
-  __Pyx_XDECREF(__pyx_v_mem_class);
+  __Pyx_XDECREF(__pyx_v_exp_traces);
+  __Pyx_XDECREF(__pyx_v_acc_dtype);
+  __Pyx_XDECREF(__pyx_v_lytsz);
+  __Pyx_XDECREF(__pyx_v_accs1dsz);
+  __Pyx_XDECREF(__pyx_v_accs2dsz);
+  __Pyx_XDECREF(__pyx_v_ttsz);
+  __Pyx_XDECREF(__pyx_v_clssz);
+  __Pyx_XDECREF(__pyx_v_ttstdsz);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":635
- *     return mem_class * classifier_len * 8
+/* "statmoments/_native.pyx":670
+ *     return (lytsz + accs1dsz + accs2dsz) * np.finfo(acc_dtype).bits // 8 + (ttsz + ttstdsz) * 8 + clssz * 4
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
- *     mem_ttest = self._accs1d.shape[2] ** 2 // 2 * 4
+ *     # ttest memory included in mem_class or one additional square for std normalization
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_11statmoments_7_native_10bivar_cntr_5memory_size(PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
 static PyMethodDef __pyx_mdef_11statmoments_7_native_10bivar_cntr_5memory_size = {"memory_size", (PyCFunction)__pyx_pw_11statmoments_7_native_10bivar_cntr_5memory_size, METH_O, 0};
 static PyObject *__pyx_pw_11statmoments_7_native_10bivar_cntr_5memory_size(PyObject *__pyx_self, PyObject *__pyx_v_self) {
   PyObject *__pyx_r = 0;
@@ -21722,43 +22115,43 @@
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static PyObject *__pyx_gb_11statmoments_7_native_10bivar_cntr_11memory_size_2generator13(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "statmoments/_native.pyx":636
+/* "statmoments/_native.pyx":671
  * 
  *   def memory_size(self):
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))             # <<<<<<<<<<<<<<
- *     mem_ttest = self._accs1d.shape[2] ** 2 // 2 * 4
- *     return mem_class + mem_ttest * 8
+ *     # ttest memory included in mem_class or one additional square for std normalization
+ *     mem_ttest = 0  if self.moment < 3 else self.trace_len + self.trace_len ** 2
  */
 
 static PyObject *__pyx_pf_11statmoments_7_native_10bivar_cntr_11memory_size_genexpr(PyObject *__pyx_self) {
   struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_7_genexpr *__pyx_cur_scope;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("genexpr", 0);
   __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_7_genexpr *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_7_genexpr(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_7_genexpr, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_7_genexpr *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 636, __pyx_L1_error)
+    __PYX_ERR(0, 671, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_6_memory_size *) __pyx_self;
   __Pyx_INCREF(((PyObject *)__pyx_cur_scope->__pyx_outer_scope));
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_outer_scope);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_10bivar_cntr_11memory_size_2generator13, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_bivar_cntr_memory_size_locals_ge, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 636, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_10bivar_cntr_11memory_size_2generator13, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_bivar_cntr_memory_size_locals_ge, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 671, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -21792,48 +22185,48 @@
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L7_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 636, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 671, __pyx_L1_error)
   __pyx_t_2 = 0;
-  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_self)) { __Pyx_RaiseClosureNameError("self"); __PYX_ERR(0, 636, __pyx_L1_error) }
-  __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_vars, __pyx_cur_scope->__pyx_outer_scope->__pyx_v_self); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 636, __pyx_L1_error)
+  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_self)) { __Pyx_RaiseClosureNameError("self"); __PYX_ERR(0, 671, __pyx_L1_error) }
+  __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_vars, __pyx_cur_scope->__pyx_outer_scope->__pyx_v_self); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 671, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   if (unlikely(__pyx_t_5 == Py_None)) {
     PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "values");
-    __PYX_ERR(0, 636, __pyx_L1_error)
+    __PYX_ERR(0, 671, __pyx_L1_error)
   }
-  __pyx_t_6 = __Pyx_dict_iterator(__pyx_t_5, 0, __pyx_n_s_values, (&__pyx_t_3), (&__pyx_t_4)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 636, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_dict_iterator(__pyx_t_5, 0, __pyx_n_s_values, (&__pyx_t_3), (&__pyx_t_4)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 671, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_XDECREF(__pyx_t_1);
   __pyx_t_1 = __pyx_t_6;
   __pyx_t_6 = 0;
   while (1) {
     __pyx_t_7 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_3, &__pyx_t_2, NULL, &__pyx_t_6, NULL, __pyx_t_4);
     if (unlikely(__pyx_t_7 == 0)) break;
-    if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 636, __pyx_L1_error)
+    if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 671, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_v);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_v, __pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_6);
     __pyx_t_6 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 636, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 671, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_ndarray); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 636, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_ndarray); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 671, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_8 = PyObject_IsInstance(__pyx_cur_scope->__pyx_v_v, __pyx_t_5); if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 636, __pyx_L1_error)
+    __pyx_t_8 = PyObject_IsInstance(__pyx_cur_scope->__pyx_v_v, __pyx_t_5); if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 671, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_9 = (__pyx_t_8 != 0);
     if (__pyx_t_9) {
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_v, __pyx_n_s_nbytes); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 636, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_v, __pyx_n_s_nbytes); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 671, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __pyx_r = __pyx_t_5;
       __pyx_t_5 = 0;
       __Pyx_XGIVEREF(__pyx_t_1);
       __pyx_cur_scope->__pyx_t_0 = __pyx_t_1;
       __pyx_cur_scope->__pyx_t_1 = __pyx_t_2;
       __pyx_cur_scope->__pyx_t_2 = __pyx_t_3;
@@ -21847,15 +22240,15 @@
       __pyx_L7_resume_from_yield:;
       __pyx_t_1 = __pyx_cur_scope->__pyx_t_0;
       __pyx_cur_scope->__pyx_t_0 = 0;
       __Pyx_XGOTREF(__pyx_t_1);
       __pyx_t_2 = __pyx_cur_scope->__pyx_t_1;
       __pyx_t_3 = __pyx_cur_scope->__pyx_t_2;
       __pyx_t_4 = __pyx_cur_scope->__pyx_t_3;
-      if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 636, __pyx_L1_error)
+      if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 671, __pyx_L1_error)
     }
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
   /* function exit code */
   PyErr_SetNone(PyExc_StopIteration);
@@ -21872,131 +22265,143 @@
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":635
- *     return mem_class * classifier_len * 8
+/* "statmoments/_native.pyx":670
+ *     return (lytsz + accs1dsz + accs2dsz) * np.finfo(acc_dtype).bits // 8 + (ttsz + ttstdsz) * 8 + clssz * 4
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
- *     mem_ttest = self._accs1d.shape[2] ** 2 // 2 * 4
+ *     # ttest memory included in mem_class or one additional square for std normalization
  */
 
 static PyObject *__pyx_pf_11statmoments_7_native_10bivar_cntr_4memory_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
   struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_6_memory_size *__pyx_cur_scope;
   PyObject *__pyx_v_mem_class = NULL;
   PyObject *__pyx_v_mem_ttest = NULL;
   PyObject *__pyx_gb_11statmoments_7_native_10bivar_cntr_11memory_size_2generator13 = 0;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  int __pyx_t_4;
+  PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("memory_size", 0);
   __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_6_memory_size *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_6_memory_size(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_6_memory_size, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_6_memory_size *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 635, __pyx_L1_error)
+    __PYX_ERR(0, 670, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
 
-  /* "statmoments/_native.pyx":636
+  /* "statmoments/_native.pyx":671
  * 
  *   def memory_size(self):
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))             # <<<<<<<<<<<<<<
- *     mem_ttest = self._accs1d.shape[2] ** 2 // 2 * 4
- *     return mem_class + mem_ttest * 8
+ *     # ttest memory included in mem_class or one additional square for std normalization
+ *     mem_ttest = 0  if self.moment < 3 else self.trace_len + self.trace_len ** 2
  */
-  __pyx_t_1 = __pyx_pf_11statmoments_7_native_10bivar_cntr_11memory_size_genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 636, __pyx_L1_error)
+  __pyx_t_1 = __pyx_pf_11statmoments_7_native_10bivar_cntr_11memory_size_genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 671, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_sum, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 636, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_sum, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 671, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_mem_class = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":637
- *   def memory_size(self):
+  /* "statmoments/_native.pyx":673
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
- *     mem_ttest = self._accs1d.shape[2] ** 2 // 2 * 4             # <<<<<<<<<<<<<<
+ *     # ttest memory included in mem_class or one additional square for std normalization
+ *     mem_ttest = 0  if self.moment < 3 else self.trace_len + self.trace_len ** 2             # <<<<<<<<<<<<<<
  *     return mem_class + mem_ttest * 8
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs1d); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 637, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 637, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 673, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 637, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = PyObject_RichCompare(__pyx_t_1, __pyx_int_3, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 673, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Power(__pyx_t_2, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 637, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_1, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 637, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Multiply(__pyx_t_2, __pyx_int_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 637, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_v_mem_ttest = __pyx_t_1;
-  __pyx_t_1 = 0;
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 673, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (__pyx_t_4) {
+    __Pyx_INCREF(__pyx_int_0);
+    __pyx_t_2 = __pyx_int_0;
+  } else {
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 673, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 673, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_5 = PyNumber_Power(__pyx_t_1, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 673, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = PyNumber_Add(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 673, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_2 = __pyx_t_1;
+    __pyx_t_1 = 0;
+  }
+  __pyx_v_mem_ttest = __pyx_t_2;
+  __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":638
- *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
- *     mem_ttest = self._accs1d.shape[2] ** 2 // 2 * 4
+  /* "statmoments/_native.pyx":674
+ *     # ttest memory included in mem_class or one additional square for std normalization
+ *     mem_ttest = 0  if self.moment < 3 else self.trace_len + self.trace_len ** 2
  *     return mem_class + mem_ttest * 8             # <<<<<<<<<<<<<<
  * 
  *   def update(self, traces, classifiers):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_v_mem_ttest, __pyx_int_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 638, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyNumber_Add(__pyx_v_mem_class, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 638, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_v_mem_ttest, __pyx_int_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 674, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_r = __pyx_t_2;
-  __pyx_t_2 = 0;
+  __pyx_t_1 = PyNumber_Add(__pyx_v_mem_class, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 674, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":635
- *     return mem_class * classifier_len * 8
+  /* "statmoments/_native.pyx":670
+ *     return (lytsz + accs1dsz + accs2dsz) * np.finfo(acc_dtype).bits // 8 + (ttsz + ttstdsz) * 8 + clssz * 4
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
- *     mem_ttest = self._accs1d.shape[2] ** 2 // 2 * 4
+ *     # ttest memory included in mem_class or one additional square for std normalization
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_5);
   __Pyx_AddTraceback("statmoments._native.bivar_cntr.memory_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_mem_class);
   __Pyx_XDECREF(__pyx_v_mem_ttest);
   __Pyx_XDECREF(__pyx_gb_11statmoments_7_native_10bivar_cntr_11memory_size_2generator13);
   __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":640
+/* "statmoments/_native.pyx":676
  *     return mem_class + mem_ttest * 8
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     moment, batch_cnt = self.moment, len(traces)
  *     tr_len, cl_len = self.trace_len, len(classifiers[0])
  */
 
@@ -22034,40 +22439,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_traces)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 1); __PYX_ERR(0, 640, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 1); __PYX_ERR(0, 676, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifiers)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 2); __PYX_ERR(0, 640, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 2); __PYX_ERR(0, 676, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update") < 0)) __PYX_ERR(0, 640, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update") < 0)) __PYX_ERR(0, 676, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_traces = values[1];
     __pyx_v_classifiers = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 640, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 676, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native.bivar_cntr.update", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_10bivar_cntr_6update(__pyx_self, __pyx_v_self, __pyx_v_traces, __pyx_v_classifiers);
 
@@ -22112,172 +22517,172 @@
   __Pyx_memviewslice __pyx_t_19 = { 0, 0, { 0 }, { 0 }, { 0 } };
   struct __pyx_opt_args_11statmoments_7_native_dgemm __pyx_t_20;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("update", 0);
 
-  /* "statmoments/_native.pyx":641
+  /* "statmoments/_native.pyx":677
  * 
  *   def update(self, traces, classifiers):
  *     moment, batch_cnt = self.moment, len(traces)             # <<<<<<<<<<<<<<
  *     tr_len, cl_len = self.trace_len, len(classifiers[0])
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 641, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 677, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_Length(__pyx_v_traces); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 641, __pyx_L1_error)
-  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 641, __pyx_L1_error)
+  __pyx_t_2 = PyObject_Length(__pyx_v_traces); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 677, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 677, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_v_moment = __pyx_t_1;
   __pyx_t_1 = 0;
   __pyx_v_batch_cnt = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":642
+  /* "statmoments/_native.pyx":678
  *   def update(self, traces, classifiers):
  *     moment, batch_cnt = self.moment, len(traces)
  *     tr_len, cl_len = self.trace_len, len(classifiers[0])             # <<<<<<<<<<<<<<
  * 
  *     self.total_count += batch_cnt
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 642, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 678, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_classifiers, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 642, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_classifiers, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 678, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 642, __pyx_L1_error)
+  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 678, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_tr_len = __pyx_t_3;
   __pyx_t_3 = 0;
   __pyx_v_cl_len = __pyx_t_2;
 
-  /* "statmoments/_native.pyx":644
+  /* "statmoments/_native.pyx":680
  *     tr_len, cl_len = self.trace_len, len(classifiers[0])
  * 
  *     self.total_count += batch_cnt             # <<<<<<<<<<<<<<
  * 
  *     if len(self._layout) < batch_cnt:
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_total_count); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 644, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_total_count); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 680, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyNumber_InPlaceAdd(__pyx_t_3, __pyx_v_batch_cnt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 644, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_InPlaceAdd(__pyx_t_3, __pyx_v_batch_cnt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 680, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_total_count, __pyx_t_1) < 0) __PYX_ERR(0, 644, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_total_count, __pyx_t_1) < 0) __PYX_ERR(0, 680, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":646
+  /* "statmoments/_native.pyx":682
  *     self.total_count += batch_cnt
  * 
  *     if len(self._layout) < batch_cnt:             # <<<<<<<<<<<<<<
- *         self._layout = np.empty((batch_cnt, moment, self._accs1d.shape[2]), dtype=np.float64)
+ *       self._layout = np.empty((batch_cnt, moment, self._accs1d.shape[2]), dtype=np.float64)
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_layout); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 646, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_layout); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 682, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 646, __pyx_L1_error)
+  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 682, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 646, __pyx_L1_error)
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 682, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyObject_RichCompare(__pyx_t_1, __pyx_v_batch_cnt, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 646, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_t_1, __pyx_v_batch_cnt, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 682, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 646, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 682, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "statmoments/_native.pyx":647
+    /* "statmoments/_native.pyx":683
  * 
  *     if len(self._layout) < batch_cnt:
- *         self._layout = np.empty((batch_cnt, moment, self._accs1d.shape[2]), dtype=np.float64)             # <<<<<<<<<<<<<<
+ *       self._layout = np.empty((batch_cnt, moment, self._accs1d.shape[2]), dtype=np.float64)             # <<<<<<<<<<<<<<
  * 
  *     tr_layout = self._layout[:batch_cnt]
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 647, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 647, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs1d); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 647, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs1d); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 647, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_5, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 647, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_5, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 647, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_INCREF(__pyx_v_batch_cnt);
     __Pyx_GIVEREF(__pyx_v_batch_cnt);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_batch_cnt);
     __Pyx_INCREF(__pyx_v_moment);
     __Pyx_GIVEREF(__pyx_v_moment);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_moment);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_t_3);
     __pyx_t_3 = 0;
-    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 647, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
     __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 647, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 647, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 647, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 647, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 647, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_layout, __pyx_t_7) < 0) __PYX_ERR(0, 647, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_layout, __pyx_t_7) < 0) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-    /* "statmoments/_native.pyx":646
+    /* "statmoments/_native.pyx":682
  *     self.total_count += batch_cnt
  * 
  *     if len(self._layout) < batch_cnt:             # <<<<<<<<<<<<<<
- *         self._layout = np.empty((batch_cnt, moment, self._accs1d.shape[2]), dtype=np.float64)
+ *       self._layout = np.empty((batch_cnt, moment, self._accs1d.shape[2]), dtype=np.float64)
  * 
  */
   }
 
-  /* "statmoments/_native.pyx":649
- *         self._layout = np.empty((batch_cnt, moment, self._accs1d.shape[2]), dtype=np.float64)
+  /* "statmoments/_native.pyx":685
+ *       self._layout = np.empty((batch_cnt, moment, self._accs1d.shape[2]), dtype=np.float64)
  * 
  *     tr_layout = self._layout[:batch_cnt]             # <<<<<<<<<<<<<<
  *     for i in range(cl_len):
  *       n0, n1 = 0, 0
  */
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_layout); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 649, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_layout); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 685, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_t_7, 0, 0, NULL, &__pyx_v_batch_cnt, NULL, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 649, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_t_7, 0, 0, NULL, &__pyx_v_batch_cnt, NULL, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 685, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_v_tr_layout = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":650
+  /* "statmoments/_native.pyx":686
  * 
  *     tr_layout = self._layout[:batch_cnt]
  *     for i in range(cl_len):             # <<<<<<<<<<<<<<
  *       n0, n1 = 0, 0
  *       # Sort traces by classifiers
  */
   __pyx_t_2 = __pyx_v_cl_len;
   __pyx_t_8 = __pyx_t_2;
   for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
     __pyx_v_i = __pyx_t_9;
 
-    /* "statmoments/_native.pyx":651
+    /* "statmoments/_native.pyx":687
  *     tr_layout = self._layout[:batch_cnt]
  *     for i in range(cl_len):
  *       n0, n1 = 0, 0             # <<<<<<<<<<<<<<
  *       # Sort traces by classifiers
  *       for tr, cl in zip(traces, classifiers):
  */
     __pyx_t_5 = __pyx_int_0;
@@ -22285,310 +22690,310 @@
     __pyx_t_7 = __pyx_int_0;
     __Pyx_INCREF(__pyx_t_7);
     __Pyx_XDECREF_SET(__pyx_v_n0, __pyx_t_5);
     __pyx_t_5 = 0;
     __Pyx_XDECREF_SET(__pyx_v_n1, __pyx_t_7);
     __pyx_t_7 = 0;
 
-    /* "statmoments/_native.pyx":653
+    /* "statmoments/_native.pyx":689
  *       n0, n1 = 0, 0
  *       # Sort traces by classifiers
  *       for tr, cl in zip(traces, classifiers):             # <<<<<<<<<<<<<<
  *         if cl[i]:
  *           tr_layout[batch_cnt - n1 - 1, 0, :] = tr
  */
-    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 653, __pyx_L1_error)
+    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 689, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_INCREF(__pyx_v_traces);
     __Pyx_GIVEREF(__pyx_v_traces);
     PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_traces);
     __Pyx_INCREF(__pyx_v_classifiers);
     __Pyx_GIVEREF(__pyx_v_classifiers);
     PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_v_classifiers);
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_zip, __pyx_t_7, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 653, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_zip, __pyx_t_7, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 689, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
       __pyx_t_7 = __pyx_t_5; __Pyx_INCREF(__pyx_t_7); __pyx_t_10 = 0;
       __pyx_t_11 = NULL;
     } else {
-      __pyx_t_10 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 653, __pyx_L1_error)
+      __pyx_t_10 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 689, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_11 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 653, __pyx_L1_error)
+      __pyx_t_11 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 689, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     for (;;) {
       if (likely(!__pyx_t_11)) {
         if (likely(PyList_CheckExact(__pyx_t_7))) {
           if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_7)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_5 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_10); __Pyx_INCREF(__pyx_t_5); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 653, __pyx_L1_error)
+          __pyx_t_5 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_10); __Pyx_INCREF(__pyx_t_5); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 689, __pyx_L1_error)
           #else
-          __pyx_t_5 = PySequence_ITEM(__pyx_t_7, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 653, __pyx_L1_error)
+          __pyx_t_5 = PySequence_ITEM(__pyx_t_7, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 689, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
           #endif
         } else {
           if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_10); __Pyx_INCREF(__pyx_t_5); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 653, __pyx_L1_error)
+          __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_10); __Pyx_INCREF(__pyx_t_5); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 689, __pyx_L1_error)
           #else
-          __pyx_t_5 = PySequence_ITEM(__pyx_t_7, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 653, __pyx_L1_error)
+          __pyx_t_5 = PySequence_ITEM(__pyx_t_7, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 689, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
           #endif
         }
       } else {
         __pyx_t_5 = __pyx_t_11(__pyx_t_7);
         if (unlikely(!__pyx_t_5)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 653, __pyx_L1_error)
+            else __PYX_ERR(0, 689, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_5);
       }
       if ((likely(PyTuple_CheckExact(__pyx_t_5))) || (PyList_CheckExact(__pyx_t_5))) {
         PyObject* sequence = __pyx_t_5;
         Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
         if (unlikely(size != 2)) {
           if (size > 2) __Pyx_RaiseTooManyValuesError(2);
           else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-          __PYX_ERR(0, 653, __pyx_L1_error)
+          __PYX_ERR(0, 689, __pyx_L1_error)
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
         if (likely(PyTuple_CheckExact(sequence))) {
           __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
           __pyx_t_1 = PyTuple_GET_ITEM(sequence, 1); 
         } else {
           __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
           __pyx_t_1 = PyList_GET_ITEM(sequence, 1); 
         }
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_1);
         #else
-        __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 653, __pyx_L1_error)
+        __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 689, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_1 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 653, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 689, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       } else {
         Py_ssize_t index = -1;
-        __pyx_t_6 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 653, __pyx_L1_error)
+        __pyx_t_6 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 689, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         __pyx_t_12 = Py_TYPE(__pyx_t_6)->tp_iternext;
         index = 0; __pyx_t_3 = __pyx_t_12(__pyx_t_6); if (unlikely(!__pyx_t_3)) goto __pyx_L8_unpacking_failed;
         __Pyx_GOTREF(__pyx_t_3);
         index = 1; __pyx_t_1 = __pyx_t_12(__pyx_t_6); if (unlikely(!__pyx_t_1)) goto __pyx_L8_unpacking_failed;
         __Pyx_GOTREF(__pyx_t_1);
-        if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_6), 2) < 0) __PYX_ERR(0, 653, __pyx_L1_error)
+        if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_6), 2) < 0) __PYX_ERR(0, 689, __pyx_L1_error)
         __pyx_t_12 = NULL;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         goto __pyx_L9_unpacking_done;
         __pyx_L8_unpacking_failed:;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __pyx_t_12 = NULL;
         if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-        __PYX_ERR(0, 653, __pyx_L1_error)
+        __PYX_ERR(0, 689, __pyx_L1_error)
         __pyx_L9_unpacking_done:;
       }
       __Pyx_XDECREF_SET(__pyx_v_tr, __pyx_t_3);
       __pyx_t_3 = 0;
       __Pyx_XDECREF_SET(__pyx_v_cl, __pyx_t_1);
       __pyx_t_1 = 0;
 
-      /* "statmoments/_native.pyx":654
+      /* "statmoments/_native.pyx":690
  *       # Sort traces by classifiers
  *       for tr, cl in zip(traces, classifiers):
  *         if cl[i]:             # <<<<<<<<<<<<<<
  *           tr_layout[batch_cnt - n1 - 1, 0, :] = tr
  *           n1 += 1
  */
-      __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_cl, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 654, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_cl, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 690, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 654, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 690, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_4) {
 
-        /* "statmoments/_native.pyx":655
+        /* "statmoments/_native.pyx":691
  *       for tr, cl in zip(traces, classifiers):
  *         if cl[i]:
  *           tr_layout[batch_cnt - n1 - 1, 0, :] = tr             # <<<<<<<<<<<<<<
  *           n1 += 1
  *         else:
  */
-        __pyx_t_5 = PyNumber_Subtract(__pyx_v_batch_cnt, __pyx_v_n1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 655, __pyx_L1_error)
+        __pyx_t_5 = PyNumber_Subtract(__pyx_v_batch_cnt, __pyx_v_n1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 691, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_t_5, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 655, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_t_5, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 691, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 655, __pyx_L1_error)
+        __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 691, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_GIVEREF(__pyx_t_1);
         PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
         __Pyx_INCREF(__pyx_int_0);
         __Pyx_GIVEREF(__pyx_int_0);
         PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_0);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_slice__5);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_slice__7);
         __pyx_t_1 = 0;
-        if (unlikely(PyObject_SetItem(__pyx_v_tr_layout, __pyx_t_5, __pyx_v_tr) < 0)) __PYX_ERR(0, 655, __pyx_L1_error)
+        if (unlikely(PyObject_SetItem(__pyx_v_tr_layout, __pyx_t_5, __pyx_v_tr) < 0)) __PYX_ERR(0, 691, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-        /* "statmoments/_native.pyx":656
+        /* "statmoments/_native.pyx":692
  *         if cl[i]:
  *           tr_layout[batch_cnt - n1 - 1, 0, :] = tr
  *           n1 += 1             # <<<<<<<<<<<<<<
  *         else:
  *           tr_layout[n0, 0, :] = tr
  */
-        __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_v_n1, __pyx_int_1, 1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 656, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_v_n1, __pyx_int_1, 1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 692, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF_SET(__pyx_v_n1, __pyx_t_5);
         __pyx_t_5 = 0;
 
-        /* "statmoments/_native.pyx":654
+        /* "statmoments/_native.pyx":690
  *       # Sort traces by classifiers
  *       for tr, cl in zip(traces, classifiers):
  *         if cl[i]:             # <<<<<<<<<<<<<<
  *           tr_layout[batch_cnt - n1 - 1, 0, :] = tr
  *           n1 += 1
  */
         goto __pyx_L10;
       }
 
-      /* "statmoments/_native.pyx":658
+      /* "statmoments/_native.pyx":694
  *           n1 += 1
  *         else:
  *           tr_layout[n0, 0, :] = tr             # <<<<<<<<<<<<<<
  *           n0 += 1
  * 
  */
       /*else*/ {
-        __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 658, __pyx_L1_error)
+        __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 694, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_INCREF(__pyx_v_n0);
         __Pyx_GIVEREF(__pyx_v_n0);
         PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_n0);
         __Pyx_INCREF(__pyx_int_0);
         __Pyx_GIVEREF(__pyx_int_0);
         PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_0);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_slice__5);
-        if (unlikely(PyObject_SetItem(__pyx_v_tr_layout, __pyx_t_5, __pyx_v_tr) < 0)) __PYX_ERR(0, 658, __pyx_L1_error)
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_slice__7);
+        if (unlikely(PyObject_SetItem(__pyx_v_tr_layout, __pyx_t_5, __pyx_v_tr) < 0)) __PYX_ERR(0, 694, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-        /* "statmoments/_native.pyx":659
+        /* "statmoments/_native.pyx":695
  *         else:
  *           tr_layout[n0, 0, :] = tr
  *           n0 += 1             # <<<<<<<<<<<<<<
  * 
  *       if n0 > 0:
  */
-        __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_v_n0, __pyx_int_1, 1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 659, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_v_n0, __pyx_int_1, 1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 695, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF_SET(__pyx_v_n0, __pyx_t_5);
         __pyx_t_5 = 0;
       }
       __pyx_L10:;
 
-      /* "statmoments/_native.pyx":653
+      /* "statmoments/_native.pyx":689
  *       n0, n1 = 0, 0
  *       # Sort traces by classifiers
  *       for tr, cl in zip(traces, classifiers):             # <<<<<<<<<<<<<<
  *         if cl[i]:
  *           tr_layout[batch_cnt - n1 - 1, 0, :] = tr
  */
     }
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-    /* "statmoments/_native.pyx":661
+    /* "statmoments/_native.pyx":697
  *           n0 += 1
  * 
  *       if n0 > 0:             # <<<<<<<<<<<<<<
  *         update_moments(self._accs2d[i, 0], self._accs1d[i, 0], self._cls_count[i, 0], moment, tr_layout[:n0, 0])
  *       if n1 > 0:
  */
-    __pyx_t_7 = PyObject_RichCompare(__pyx_v_n0, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 661, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 661, __pyx_L1_error)
+    __pyx_t_7 = PyObject_RichCompare(__pyx_v_n0, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 697, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 697, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     if (__pyx_t_4) {
 
-      /* "statmoments/_native.pyx":662
+      /* "statmoments/_native.pyx":698
  * 
  *       if n0 > 0:
  *         update_moments(self._accs2d[i, 0], self._accs1d[i, 0], self._cls_count[i, 0], moment, tr_layout[:n0, 0])             # <<<<<<<<<<<<<<
  *       if n1 > 0:
  *         update_moments(self._accs2d[i, 1], self._accs1d[i, 1], self._cls_count[i, 1], moment, tr_layout[n0:, 0])
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_update_moments); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_update_moments); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 698, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs2d); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs2d); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 698, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 698, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GIVEREF(__pyx_t_3);
       PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
       PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_0);
       __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 698, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs1d); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs1d); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 698, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_13 = PyTuple_New(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_13 = PyTuple_New(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 698, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_13);
       __Pyx_GIVEREF(__pyx_t_1);
       PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_1);
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
       PyTuple_SET_ITEM(__pyx_t_13, 1, __pyx_int_0);
       __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_t_13); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_t_13); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-      __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cls_count); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cls_count); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 698, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_13);
-      __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 698, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_14 = PyTuple_New(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_14 = PyTuple_New(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 698, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_14);
       __Pyx_GIVEREF(__pyx_t_6);
       PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_t_6);
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
       PyTuple_SET_ITEM(__pyx_t_14, 1, __pyx_int_0);
       __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_13, __pyx_t_14); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_13, __pyx_t_14); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 698, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-      __pyx_t_14 = PySlice_New(Py_None, __pyx_v_n0, Py_None); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_14 = PySlice_New(Py_None, __pyx_v_n0, Py_None); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 698, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_14);
-      __pyx_t_13 = PyTuple_New(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_13 = PyTuple_New(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 698, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_13);
       __Pyx_GIVEREF(__pyx_t_14);
       PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_14);
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
       PyTuple_SET_ITEM(__pyx_t_13, 1, __pyx_int_0);
       __pyx_t_14 = 0;
-      __pyx_t_14 = __Pyx_PyObject_GetItem(__pyx_v_tr_layout, __pyx_t_13); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_14 = __Pyx_PyObject_GetItem(__pyx_v_tr_layout, __pyx_t_13); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 698, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_14);
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
       __pyx_t_13 = NULL;
       __pyx_t_15 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
         __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_5);
         if (likely(__pyx_t_13)) {
@@ -22598,37 +23003,37 @@
           __Pyx_DECREF_SET(__pyx_t_5, function);
           __pyx_t_15 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_5)) {
         PyObject *__pyx_temp[6] = {__pyx_t_13, __pyx_t_3, __pyx_t_1, __pyx_t_6, __pyx_v_moment, __pyx_t_14};
-        __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_15, 5+__pyx_t_15); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 662, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_15, 5+__pyx_t_15); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 698, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
         PyObject *__pyx_temp[6] = {__pyx_t_13, __pyx_t_3, __pyx_t_1, __pyx_t_6, __pyx_v_moment, __pyx_t_14};
-        __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_15, 5+__pyx_t_15); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 662, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_15, 5+__pyx_t_15); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 698, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
       } else
       #endif
       {
-        __pyx_t_16 = PyTuple_New(5+__pyx_t_15); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 662, __pyx_L1_error)
+        __pyx_t_16 = PyTuple_New(5+__pyx_t_15); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 698, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_16);
         if (__pyx_t_13) {
           __Pyx_GIVEREF(__pyx_t_13); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_13); __pyx_t_13 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_3);
         PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_15, __pyx_t_3);
         __Pyx_GIVEREF(__pyx_t_1);
@@ -22640,110 +23045,110 @@
         PyTuple_SET_ITEM(__pyx_t_16, 3+__pyx_t_15, __pyx_v_moment);
         __Pyx_GIVEREF(__pyx_t_14);
         PyTuple_SET_ITEM(__pyx_t_16, 4+__pyx_t_15, __pyx_t_14);
         __pyx_t_3 = 0;
         __pyx_t_1 = 0;
         __pyx_t_6 = 0;
         __pyx_t_14 = 0;
-        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_16, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 662, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_16, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 698, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
       }
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "statmoments/_native.pyx":661
+      /* "statmoments/_native.pyx":697
  *           n0 += 1
  * 
  *       if n0 > 0:             # <<<<<<<<<<<<<<
  *         update_moments(self._accs2d[i, 0], self._accs1d[i, 0], self._cls_count[i, 0], moment, tr_layout[:n0, 0])
  *       if n1 > 0:
  */
     }
 
-    /* "statmoments/_native.pyx":663
+    /* "statmoments/_native.pyx":699
  *       if n0 > 0:
  *         update_moments(self._accs2d[i, 0], self._accs1d[i, 0], self._cls_count[i, 0], moment, tr_layout[:n0, 0])
  *       if n1 > 0:             # <<<<<<<<<<<<<<
  *         update_moments(self._accs2d[i, 1], self._accs1d[i, 1], self._cls_count[i, 1], moment, tr_layout[n0:, 0])
  * 
  */
-    __pyx_t_7 = PyObject_RichCompare(__pyx_v_n1, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 663, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 663, __pyx_L1_error)
+    __pyx_t_7 = PyObject_RichCompare(__pyx_v_n1, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 699, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 699, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     if (__pyx_t_4) {
 
-      /* "statmoments/_native.pyx":664
+      /* "statmoments/_native.pyx":700
  *         update_moments(self._accs2d[i, 0], self._accs1d[i, 0], self._cls_count[i, 0], moment, tr_layout[:n0, 0])
  *       if n1 > 0:
  *         update_moments(self._accs2d[i, 1], self._accs1d[i, 1], self._cls_count[i, 1], moment, tr_layout[n0:, 0])             # <<<<<<<<<<<<<<
  * 
  *       self._cls_count[i, 0] += n0
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_update_moments); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 664, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_update_moments); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 700, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_16 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs2d); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 664, __pyx_L1_error)
+      __pyx_t_16 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs2d); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 700, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_16);
-      __pyx_t_14 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 664, __pyx_L1_error)
+      __pyx_t_14 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 700, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_14);
-      __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 664, __pyx_L1_error)
+      __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 700, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GIVEREF(__pyx_t_14);
       PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_14);
       __Pyx_INCREF(__pyx_int_1);
       __Pyx_GIVEREF(__pyx_int_1);
       PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_1);
       __pyx_t_14 = 0;
-      __pyx_t_14 = __Pyx_PyObject_GetItem(__pyx_t_16, __pyx_t_6); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 664, __pyx_L1_error)
+      __pyx_t_14 = __Pyx_PyObject_GetItem(__pyx_t_16, __pyx_t_6); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 700, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_14);
       __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs1d); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 664, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs1d); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 700, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_16 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 664, __pyx_L1_error)
+      __pyx_t_16 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 700, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_16);
-      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 664, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 700, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_GIVEREF(__pyx_t_16);
       PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_16);
       __Pyx_INCREF(__pyx_int_1);
       __Pyx_GIVEREF(__pyx_int_1);
       PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_1);
       __pyx_t_16 = 0;
-      __pyx_t_16 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 664, __pyx_L1_error)
+      __pyx_t_16 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 700, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_16);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cls_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 664, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cls_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 700, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 664, __pyx_L1_error)
+      __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 700, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 664, __pyx_L1_error)
+      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 700, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_GIVEREF(__pyx_t_6);
       PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
       __Pyx_INCREF(__pyx_int_1);
       __Pyx_GIVEREF(__pyx_int_1);
       PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_1);
       __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 664, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 700, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PySlice_New(__pyx_v_n0, Py_None, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 664, __pyx_L1_error)
+      __pyx_t_3 = PySlice_New(__pyx_v_n0, Py_None, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 700, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 664, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 700, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_GIVEREF(__pyx_t_3);
       PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
       PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_0);
       __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_tr_layout, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 664, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_tr_layout, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 700, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_1 = NULL;
       __pyx_t_15 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
         if (likely(__pyx_t_1)) {
@@ -22753,37 +23158,37 @@
           __Pyx_DECREF_SET(__pyx_t_5, function);
           __pyx_t_15 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_5)) {
         PyObject *__pyx_temp[6] = {__pyx_t_1, __pyx_t_14, __pyx_t_16, __pyx_t_6, __pyx_v_moment, __pyx_t_3};
-        __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_15, 5+__pyx_t_15); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 664, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_15, 5+__pyx_t_15); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 700, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
         __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
         PyObject *__pyx_temp[6] = {__pyx_t_1, __pyx_t_14, __pyx_t_16, __pyx_t_6, __pyx_v_moment, __pyx_t_3};
-        __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_15, 5+__pyx_t_15); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 664, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_15, 5+__pyx_t_15); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 700, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
         __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else
       #endif
       {
-        __pyx_t_13 = PyTuple_New(5+__pyx_t_15); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 664, __pyx_L1_error)
+        __pyx_t_13 = PyTuple_New(5+__pyx_t_15); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 700, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_13);
         if (__pyx_t_1) {
           __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_1); __pyx_t_1 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_14);
         PyTuple_SET_ITEM(__pyx_t_13, 0+__pyx_t_15, __pyx_t_14);
         __Pyx_GIVEREF(__pyx_t_16);
@@ -22795,277 +23200,277 @@
         PyTuple_SET_ITEM(__pyx_t_13, 3+__pyx_t_15, __pyx_v_moment);
         __Pyx_GIVEREF(__pyx_t_3);
         PyTuple_SET_ITEM(__pyx_t_13, 4+__pyx_t_15, __pyx_t_3);
         __pyx_t_14 = 0;
         __pyx_t_16 = 0;
         __pyx_t_6 = 0;
         __pyx_t_3 = 0;
-        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_13, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 664, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_13, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 700, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
       }
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "statmoments/_native.pyx":663
+      /* "statmoments/_native.pyx":699
  *       if n0 > 0:
  *         update_moments(self._accs2d[i, 0], self._accs1d[i, 0], self._cls_count[i, 0], moment, tr_layout[:n0, 0])
  *       if n1 > 0:             # <<<<<<<<<<<<<<
  *         update_moments(self._accs2d[i, 1], self._accs1d[i, 1], self._cls_count[i, 1], moment, tr_layout[n0:, 0])
  * 
  */
     }
 
-    /* "statmoments/_native.pyx":666
+    /* "statmoments/_native.pyx":702
  *         update_moments(self._accs2d[i, 1], self._accs1d[i, 1], self._cls_count[i, 1], moment, tr_layout[n0:, 0])
  * 
  *       self._cls_count[i, 0] += n0             # <<<<<<<<<<<<<<
  *       self._cls_count[i, 1] += n1
  * 
  */
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cls_count); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 666, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cls_count); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 702, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 666, __pyx_L1_error)
+    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 702, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_13 = PyTuple_New(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 666, __pyx_L1_error)
+    __pyx_t_13 = PyTuple_New(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 702, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_5);
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_13, 1, __pyx_int_0);
     __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_7, __pyx_t_13); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 666, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_7, __pyx_t_13); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 702, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_t_5, __pyx_v_n0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 666, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_t_5, __pyx_v_n0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 702, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(PyObject_SetItem(__pyx_t_7, __pyx_t_13, __pyx_t_3) < 0)) __PYX_ERR(0, 666, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_t_7, __pyx_t_13, __pyx_t_3) < 0)) __PYX_ERR(0, 702, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-    /* "statmoments/_native.pyx":667
+    /* "statmoments/_native.pyx":703
  * 
  *       self._cls_count[i, 0] += n0
  *       self._cls_count[i, 1] += n1             # <<<<<<<<<<<<<<
  * 
  *       tr_layout[:n0, 0] -= self._accs1d[i, 0]
  */
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cls_count); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 667, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cls_count); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 703, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_13 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 667, __pyx_L1_error)
+    __pyx_t_13 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 703, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 667, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 703, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_13);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_13);
     __Pyx_INCREF(__pyx_int_1);
     __Pyx_GIVEREF(__pyx_int_1);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_1);
     __pyx_t_13 = 0;
-    __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_t_7, __pyx_t_3); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 667, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_t_7, __pyx_t_3); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 703, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
-    __pyx_t_5 = PyNumber_InPlaceAdd(__pyx_t_13, __pyx_v_n1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 667, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_InPlaceAdd(__pyx_t_13, __pyx_v_n1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 703, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-    if (unlikely(PyObject_SetItem(__pyx_t_7, __pyx_t_3, __pyx_t_5) < 0)) __PYX_ERR(0, 667, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_t_7, __pyx_t_3, __pyx_t_5) < 0)) __PYX_ERR(0, 703, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-    /* "statmoments/_native.pyx":669
+    /* "statmoments/_native.pyx":705
  *       self._cls_count[i, 1] += n1
  * 
  *       tr_layout[:n0, 0] -= self._accs1d[i, 0]             # <<<<<<<<<<<<<<
  *       tr_layout[n0:, 0] -= self._accs1d[i, 1]
  *       for j in range(1, moment):
  */
-    __pyx_t_7 = PySlice_New(Py_None, __pyx_v_n0, Py_None); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 669, __pyx_L1_error)
+    __pyx_t_7 = PySlice_New(Py_None, __pyx_v_n0, Py_None); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 705, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 669, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 705, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_7);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_7);
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_0);
     __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_tr_layout, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 669, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_tr_layout, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 705, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs1d); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 669, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs1d); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 705, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_13 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 669, __pyx_L1_error)
+    __pyx_t_13 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 705, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
-    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 669, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 705, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_13);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_13);
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_0);
     __pyx_t_13 = 0;
-    __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 669, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 705, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyNumber_InPlaceSubtract(__pyx_t_7, __pyx_t_13); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 669, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_InPlaceSubtract(__pyx_t_7, __pyx_t_13); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 705, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-    if (unlikely(PyObject_SetItem(__pyx_v_tr_layout, __pyx_t_3, __pyx_t_6) < 0)) __PYX_ERR(0, 669, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_v_tr_layout, __pyx_t_3, __pyx_t_6) < 0)) __PYX_ERR(0, 705, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "statmoments/_native.pyx":670
+    /* "statmoments/_native.pyx":706
  * 
  *       tr_layout[:n0, 0] -= self._accs1d[i, 0]
  *       tr_layout[n0:, 0] -= self._accs1d[i, 1]             # <<<<<<<<<<<<<<
  *       for j in range(1, moment):
  *         np.multiply(tr_layout[:, 0, :], tr_layout[:, j - 1, :], tr_layout[:, j, :])
  */
-    __pyx_t_3 = PySlice_New(__pyx_v_n0, Py_None, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 670, __pyx_L1_error)
+    __pyx_t_3 = PySlice_New(__pyx_v_n0, Py_None, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 706, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 670, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 706, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_0);
     __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_tr_layout, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 670, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_tr_layout, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 706, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs1d); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 670, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs1d); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 706, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
-    __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 670, __pyx_L1_error)
+    __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 706, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 670, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 706, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_7);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_7);
     __Pyx_INCREF(__pyx_int_1);
     __Pyx_GIVEREF(__pyx_int_1);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_1);
     __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_t_13, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 670, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_t_13, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 706, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_InPlaceSubtract(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 670, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_InPlaceSubtract(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 706, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (unlikely(PyObject_SetItem(__pyx_v_tr_layout, __pyx_t_6, __pyx_t_5) < 0)) __PYX_ERR(0, 670, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_v_tr_layout, __pyx_t_6, __pyx_t_5) < 0)) __PYX_ERR(0, 706, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":671
+    /* "statmoments/_native.pyx":707
  *       tr_layout[:n0, 0] -= self._accs1d[i, 0]
  *       tr_layout[n0:, 0] -= self._accs1d[i, 1]
  *       for j in range(1, moment):             # <<<<<<<<<<<<<<
  *         np.multiply(tr_layout[:, 0, :], tr_layout[:, j - 1, :], tr_layout[:, j, :])
  * 
  */
-    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 671, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 707, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_INCREF(__pyx_int_1);
     __Pyx_GIVEREF(__pyx_int_1);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_int_1);
     __Pyx_INCREF(__pyx_v_moment);
     __Pyx_GIVEREF(__pyx_v_moment);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_v_moment);
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 671, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 707, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
       __pyx_t_6 = __pyx_t_5; __Pyx_INCREF(__pyx_t_6); __pyx_t_10 = 0;
       __pyx_t_11 = NULL;
     } else {
-      __pyx_t_10 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 671, __pyx_L1_error)
+      __pyx_t_10 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 707, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_11 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 671, __pyx_L1_error)
+      __pyx_t_11 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 707, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     for (;;) {
       if (likely(!__pyx_t_11)) {
         if (likely(PyList_CheckExact(__pyx_t_6))) {
           if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_6)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_5 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_10); __Pyx_INCREF(__pyx_t_5); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 671, __pyx_L1_error)
+          __pyx_t_5 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_10); __Pyx_INCREF(__pyx_t_5); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 707, __pyx_L1_error)
           #else
-          __pyx_t_5 = PySequence_ITEM(__pyx_t_6, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 671, __pyx_L1_error)
+          __pyx_t_5 = PySequence_ITEM(__pyx_t_6, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 707, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
           #endif
         } else {
           if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_6)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_10); __Pyx_INCREF(__pyx_t_5); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 671, __pyx_L1_error)
+          __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_10); __Pyx_INCREF(__pyx_t_5); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 707, __pyx_L1_error)
           #else
-          __pyx_t_5 = PySequence_ITEM(__pyx_t_6, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 671, __pyx_L1_error)
+          __pyx_t_5 = PySequence_ITEM(__pyx_t_6, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 707, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
           #endif
         }
       } else {
         __pyx_t_5 = __pyx_t_11(__pyx_t_6);
         if (unlikely(!__pyx_t_5)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 671, __pyx_L1_error)
+            else __PYX_ERR(0, 707, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_5);
       }
       __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_5);
       __pyx_t_5 = 0;
 
-      /* "statmoments/_native.pyx":672
+      /* "statmoments/_native.pyx":708
  *       tr_layout[n0:, 0] -= self._accs1d[i, 1]
  *       for j in range(1, moment):
  *         np.multiply(tr_layout[:, 0, :], tr_layout[:, j - 1, :], tr_layout[:, j, :])             # <<<<<<<<<<<<<<
  * 
  *       ar_len = tr_layout.shape[1] * tr_layout.shape[2]
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 672, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 708, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_multiply); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 672, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_multiply); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 708, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_tr_layout, __pyx_tuple__19); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 672, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_tr_layout, __pyx_tuple__21); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 708, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_13 = __Pyx_PyInt_SubtractObjC(__pyx_v_j, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 672, __pyx_L1_error)
+      __pyx_t_13 = __Pyx_PyInt_SubtractObjC(__pyx_v_j, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 708, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_13);
-      __pyx_t_16 = PyTuple_New(3); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 672, __pyx_L1_error)
+      __pyx_t_16 = PyTuple_New(3); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 708, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_16);
-      __Pyx_INCREF(__pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_slice__5);
-      PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_slice__5);
+      __Pyx_INCREF(__pyx_slice__7);
+      __Pyx_GIVEREF(__pyx_slice__7);
+      PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_slice__7);
       __Pyx_GIVEREF(__pyx_t_13);
       PyTuple_SET_ITEM(__pyx_t_16, 1, __pyx_t_13);
-      __Pyx_INCREF(__pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_slice__5);
-      PyTuple_SET_ITEM(__pyx_t_16, 2, __pyx_slice__5);
+      __Pyx_INCREF(__pyx_slice__7);
+      __Pyx_GIVEREF(__pyx_slice__7);
+      PyTuple_SET_ITEM(__pyx_t_16, 2, __pyx_slice__7);
       __pyx_t_13 = 0;
-      __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_v_tr_layout, __pyx_t_16); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 672, __pyx_L1_error)
+      __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_v_tr_layout, __pyx_t_16); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 708, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_13);
       __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-      __pyx_t_16 = PyTuple_New(3); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 672, __pyx_L1_error)
+      __pyx_t_16 = PyTuple_New(3); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 708, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_16);
-      __Pyx_INCREF(__pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_slice__5);
-      PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_slice__5);
+      __Pyx_INCREF(__pyx_slice__7);
+      __Pyx_GIVEREF(__pyx_slice__7);
+      PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_slice__7);
       __Pyx_INCREF(__pyx_v_j);
       __Pyx_GIVEREF(__pyx_v_j);
       PyTuple_SET_ITEM(__pyx_t_16, 1, __pyx_v_j);
-      __Pyx_INCREF(__pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_slice__5);
-      PyTuple_SET_ITEM(__pyx_t_16, 2, __pyx_slice__5);
-      __pyx_t_14 = __Pyx_PyObject_GetItem(__pyx_v_tr_layout, __pyx_t_16); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 672, __pyx_L1_error)
+      __Pyx_INCREF(__pyx_slice__7);
+      __Pyx_GIVEREF(__pyx_slice__7);
+      PyTuple_SET_ITEM(__pyx_t_16, 2, __pyx_slice__7);
+      __pyx_t_14 = __Pyx_PyObject_GetItem(__pyx_v_tr_layout, __pyx_t_16); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 708, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_14);
       __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
       __pyx_t_16 = NULL;
       __pyx_t_15 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
         __pyx_t_16 = PyMethod_GET_SELF(__pyx_t_3);
         if (likely(__pyx_t_16)) {
@@ -23075,114 +23480,114 @@
           __Pyx_DECREF_SET(__pyx_t_3, function);
           __pyx_t_15 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_3)) {
         PyObject *__pyx_temp[4] = {__pyx_t_16, __pyx_t_7, __pyx_t_13, __pyx_t_14};
-        __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_15, 3+__pyx_t_15); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 672, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_15, 3+__pyx_t_15); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 708, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_16); __pyx_t_16 = 0;
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
         PyObject *__pyx_temp[4] = {__pyx_t_16, __pyx_t_7, __pyx_t_13, __pyx_t_14};
-        __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_15, 3+__pyx_t_15); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 672, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_15, 3+__pyx_t_15); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 708, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_16); __pyx_t_16 = 0;
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
       } else
       #endif
       {
-        __pyx_t_1 = PyTuple_New(3+__pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 672, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_New(3+__pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 708, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         if (__pyx_t_16) {
           __Pyx_GIVEREF(__pyx_t_16); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_16); __pyx_t_16 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_7);
         PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_15, __pyx_t_7);
         __Pyx_GIVEREF(__pyx_t_13);
         PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_15, __pyx_t_13);
         __Pyx_GIVEREF(__pyx_t_14);
         PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_15, __pyx_t_14);
         __pyx_t_7 = 0;
         __pyx_t_13 = 0;
         __pyx_t_14 = 0;
-        __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 672, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 708, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       }
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-      /* "statmoments/_native.pyx":671
+      /* "statmoments/_native.pyx":707
  *       tr_layout[:n0, 0] -= self._accs1d[i, 0]
  *       tr_layout[n0:, 0] -= self._accs1d[i, 1]
  *       for j in range(1, moment):             # <<<<<<<<<<<<<<
  *         np.multiply(tr_layout[:, 0, :], tr_layout[:, j - 1, :], tr_layout[:, j, :])
  * 
  */
     }
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":674
+    /* "statmoments/_native.pyx":710
  *         np.multiply(tr_layout[:, 0, :], tr_layout[:, j - 1, :], tr_layout[:, j, :])
  * 
  *       ar_len = tr_layout.shape[1] * tr_layout.shape[2]             # <<<<<<<<<<<<<<
  *       if n0 > 0:
- *         dgemm(tr_layout[:n0].reshape((-1, ar_len)), tr_layout[:n0].reshape((-1, ar_len)), self._accs2d[i, 0].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
+ *         dgemm(tr_layout[:n0].reshape((-1, ar_len)), tr_layout[:n0].reshape((-1, ar_len)),
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_tr_layout, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 674, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_tr_layout, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 710, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_6, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 674, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_6, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 710, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_tr_layout, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 674, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_tr_layout, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 710, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_6, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 674, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_6, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 710, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyNumber_Multiply(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 674, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Multiply(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 710, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_XDECREF_SET(__pyx_v_ar_len, __pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":675
+    /* "statmoments/_native.pyx":711
  * 
  *       ar_len = tr_layout.shape[1] * tr_layout.shape[2]
  *       if n0 > 0:             # <<<<<<<<<<<<<<
- *         dgemm(tr_layout[:n0].reshape((-1, ar_len)), tr_layout[:n0].reshape((-1, ar_len)), self._accs2d[i, 0].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
- *       if n1 > 0:
+ *         dgemm(tr_layout[:n0].reshape((-1, ar_len)), tr_layout[:n0].reshape((-1, ar_len)),
+ *               self._accs2d[i, 0].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
  */
-    __pyx_t_6 = PyObject_RichCompare(__pyx_v_n0, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 675, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 675, __pyx_L1_error)
+    __pyx_t_6 = PyObject_RichCompare(__pyx_v_n0, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 711, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 711, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     if (__pyx_t_4) {
 
-      /* "statmoments/_native.pyx":676
+      /* "statmoments/_native.pyx":712
  *       ar_len = tr_layout.shape[1] * tr_layout.shape[2]
  *       if n0 > 0:
- *         dgemm(tr_layout[:n0].reshape((-1, ar_len)), tr_layout[:n0].reshape((-1, ar_len)), self._accs2d[i, 0].reshape(ar_len, ar_len), transa=b'N', transb=b'T')             # <<<<<<<<<<<<<<
+ *         dgemm(tr_layout[:n0].reshape((-1, ar_len)), tr_layout[:n0].reshape((-1, ar_len)),             # <<<<<<<<<<<<<<
+ *               self._accs2d[i, 0].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
  *       if n1 > 0:
- *         dgemm(tr_layout[n0:].reshape((-1, ar_len)), tr_layout[n0:].reshape((-1, ar_len)), self._accs2d[i, 1].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
  */
-      __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_tr_layout, 0, 0, NULL, &__pyx_v_n0, NULL, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 676, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_tr_layout, 0, 0, NULL, &__pyx_v_n0, NULL, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 712, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_reshape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 676, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_reshape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 676, __pyx_L1_error)
+      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 712, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_INCREF(__pyx_int_neg_1);
       __Pyx_GIVEREF(__pyx_int_neg_1);
       PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_int_neg_1);
       __Pyx_INCREF(__pyx_v_ar_len);
       __Pyx_GIVEREF(__pyx_v_ar_len);
       PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_ar_len);
@@ -23195,25 +23600,25 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_5, function);
         }
       }
       __pyx_t_6 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_1, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_3);
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 676, __pyx_L1_error)
+      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 712, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 676, __pyx_L1_error)
+      __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 712, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_v_tr_layout, 0, 0, NULL, &__pyx_v_n0, NULL, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 676, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_v_tr_layout, 0, 0, NULL, &__pyx_v_n0, NULL, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_reshape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 676, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_reshape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 712, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 676, __pyx_L1_error)
+      __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_INCREF(__pyx_int_neg_1);
       __Pyx_GIVEREF(__pyx_int_neg_1);
       PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_int_neg_1);
       __Pyx_INCREF(__pyx_v_ar_len);
       __Pyx_GIVEREF(__pyx_v_ar_len);
       PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_ar_len);
@@ -23226,36 +23631,44 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_3, function);
         }
       }
       __pyx_t_6 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5);
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 676, __pyx_L1_error)
+      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 712, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_18 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 676, __pyx_L1_error)
+      __pyx_t_18 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 712, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs2d); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 676, __pyx_L1_error)
+
+      /* "statmoments/_native.pyx":713
+ *       if n0 > 0:
+ *         dgemm(tr_layout[:n0].reshape((-1, ar_len)), tr_layout[:n0].reshape((-1, ar_len)),
+ *               self._accs2d[i, 0].reshape(ar_len, ar_len), transa=b'N', transb=b'T')             # <<<<<<<<<<<<<<
+ *       if n1 > 0:
+ *         dgemm(tr_layout[n0:].reshape((-1, ar_len)), tr_layout[n0:].reshape((-1, ar_len)),
+ */
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs2d); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 713, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 676, __pyx_L1_error)
+      __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 713, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 676, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 713, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_GIVEREF(__pyx_t_5);
       PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
       PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_0);
       __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 676, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 713, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_reshape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 676, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_reshape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 713, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_t_5 = NULL;
       __pyx_t_15 = 0;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_5)) {
@@ -23265,94 +23678,102 @@
           __Pyx_DECREF_SET(__pyx_t_1, function);
           __pyx_t_15 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_ar_len, __pyx_v_ar_len};
-        __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 676, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 713, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_GOTREF(__pyx_t_6);
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_ar_len, __pyx_v_ar_len};
-        __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 676, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 713, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_GOTREF(__pyx_t_6);
       } else
       #endif
       {
-        __pyx_t_3 = PyTuple_New(2+__pyx_t_15); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 676, __pyx_L1_error)
+        __pyx_t_3 = PyTuple_New(2+__pyx_t_15); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 713, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         if (__pyx_t_5) {
           __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
         }
         __Pyx_INCREF(__pyx_v_ar_len);
         __Pyx_GIVEREF(__pyx_v_ar_len);
         PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_15, __pyx_v_ar_len);
         __Pyx_INCREF(__pyx_v_ar_len);
         __Pyx_GIVEREF(__pyx_v_ar_len);
         PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_15, __pyx_v_ar_len);
-        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 676, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 713, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       }
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 676, __pyx_L1_error)
+      __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 713, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+
+      /* "statmoments/_native.pyx":712
+ *       ar_len = tr_layout.shape[1] * tr_layout.shape[2]
+ *       if n0 > 0:
+ *         dgemm(tr_layout[:n0].reshape((-1, ar_len)), tr_layout[:n0].reshape((-1, ar_len)),             # <<<<<<<<<<<<<<
+ *               self._accs2d[i, 0].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
+ *       if n1 > 0:
+ */
       __pyx_t_20.__pyx_n = 2;
       __pyx_t_20.transa = 'N';
       __pyx_t_20.transb = 'T';
       __pyx_f_11statmoments_7_native_dgemm(__pyx_t_17, __pyx_t_18, __pyx_t_19, &__pyx_t_20); 
       __PYX_XDEC_MEMVIEW(&__pyx_t_17, 1);
       __pyx_t_17.memview = NULL;
       __pyx_t_17.data = NULL;
       __PYX_XDEC_MEMVIEW(&__pyx_t_18, 1);
       __pyx_t_18.memview = NULL;
       __pyx_t_18.data = NULL;
       __PYX_XDEC_MEMVIEW(&__pyx_t_19, 1);
       __pyx_t_19.memview = NULL;
       __pyx_t_19.data = NULL;
 
-      /* "statmoments/_native.pyx":675
+      /* "statmoments/_native.pyx":711
  * 
  *       ar_len = tr_layout.shape[1] * tr_layout.shape[2]
  *       if n0 > 0:             # <<<<<<<<<<<<<<
- *         dgemm(tr_layout[:n0].reshape((-1, ar_len)), tr_layout[:n0].reshape((-1, ar_len)), self._accs2d[i, 0].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
- *       if n1 > 0:
+ *         dgemm(tr_layout[:n0].reshape((-1, ar_len)), tr_layout[:n0].reshape((-1, ar_len)),
+ *               self._accs2d[i, 0].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
  */
     }
 
-    /* "statmoments/_native.pyx":677
- *       if n0 > 0:
- *         dgemm(tr_layout[:n0].reshape((-1, ar_len)), tr_layout[:n0].reshape((-1, ar_len)), self._accs2d[i, 0].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
+    /* "statmoments/_native.pyx":714
+ *         dgemm(tr_layout[:n0].reshape((-1, ar_len)), tr_layout[:n0].reshape((-1, ar_len)),
+ *               self._accs2d[i, 0].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
  *       if n1 > 0:             # <<<<<<<<<<<<<<
- *         dgemm(tr_layout[n0:].reshape((-1, ar_len)), tr_layout[n0:].reshape((-1, ar_len)), self._accs2d[i, 1].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
- * 
+ *         dgemm(tr_layout[n0:].reshape((-1, ar_len)), tr_layout[n0:].reshape((-1, ar_len)),
+ *               self._accs2d[i, 1].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
  */
-    __pyx_t_6 = PyObject_RichCompare(__pyx_v_n1, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 677, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 677, __pyx_L1_error)
+    __pyx_t_6 = PyObject_RichCompare(__pyx_v_n1, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 714, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 714, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     if (__pyx_t_4) {
 
-      /* "statmoments/_native.pyx":678
- *         dgemm(tr_layout[:n0].reshape((-1, ar_len)), tr_layout[:n0].reshape((-1, ar_len)), self._accs2d[i, 0].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
+      /* "statmoments/_native.pyx":715
+ *               self._accs2d[i, 0].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
  *       if n1 > 0:
- *         dgemm(tr_layout[n0:].reshape((-1, ar_len)), tr_layout[n0:].reshape((-1, ar_len)), self._accs2d[i, 1].reshape(ar_len, ar_len), transa=b'N', transb=b'T')             # <<<<<<<<<<<<<<
+ *         dgemm(tr_layout[n0:].reshape((-1, ar_len)), tr_layout[n0:].reshape((-1, ar_len)),             # <<<<<<<<<<<<<<
+ *               self._accs2d[i, 1].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
  * 
- *   def counts(self, i):
  */
-      __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_tr_layout, 0, 0, &__pyx_v_n0, NULL, NULL, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 678, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_tr_layout, 0, 0, &__pyx_v_n0, NULL, NULL, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 715, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_reshape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 678, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_reshape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 715, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 678, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 715, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_INCREF(__pyx_int_neg_1);
       __Pyx_GIVEREF(__pyx_int_neg_1);
       PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_int_neg_1);
       __Pyx_INCREF(__pyx_v_ar_len);
       __Pyx_GIVEREF(__pyx_v_ar_len);
       PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_ar_len);
@@ -23365,25 +23786,25 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_3, function);
         }
       }
       __pyx_t_6 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 678, __pyx_L1_error)
+      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 715, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 678, __pyx_L1_error)
+      __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 715, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_tr_layout, 0, 0, &__pyx_v_n0, NULL, NULL, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 678, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_tr_layout, 0, 0, &__pyx_v_n0, NULL, NULL, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 715, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_reshape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 678, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_reshape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 715, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 678, __pyx_L1_error)
+      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 715, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_INCREF(__pyx_int_neg_1);
       __Pyx_GIVEREF(__pyx_int_neg_1);
       PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_int_neg_1);
       __Pyx_INCREF(__pyx_v_ar_len);
       __Pyx_GIVEREF(__pyx_v_ar_len);
       PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_ar_len);
@@ -23396,36 +23817,44 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
       __pyx_t_6 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_5, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_3);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 678, __pyx_L1_error)
+      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 715, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_18 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 678, __pyx_L1_error)
+      __pyx_t_18 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 715, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs2d); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 678, __pyx_L1_error)
+
+      /* "statmoments/_native.pyx":716
+ *       if n1 > 0:
+ *         dgemm(tr_layout[n0:].reshape((-1, ar_len)), tr_layout[n0:].reshape((-1, ar_len)),
+ *               self._accs2d[i, 1].reshape(ar_len, ar_len), transa=b'N', transb=b'T')             # <<<<<<<<<<<<<<
+ * 
+ *   def counts(self, i):
+ */
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs2d); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 716, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 678, __pyx_L1_error)
+      __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 716, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 678, __pyx_L1_error)
+      __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 716, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GIVEREF(__pyx_t_3);
       PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
       __Pyx_INCREF(__pyx_int_1);
       __Pyx_GIVEREF(__pyx_int_1);
       PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_1);
       __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 678, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 716, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_reshape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 678, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_reshape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 716, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_t_3 = NULL;
       __pyx_t_15 = 0;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
         __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
         if (likely(__pyx_t_3)) {
@@ -23435,71 +23864,79 @@
           __Pyx_DECREF_SET(__pyx_t_5, function);
           __pyx_t_15 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_5)) {
         PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_ar_len, __pyx_v_ar_len};
-        __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 678, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 716, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_GOTREF(__pyx_t_6);
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
         PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_ar_len, __pyx_v_ar_len};
-        __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 678, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 716, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_GOTREF(__pyx_t_6);
       } else
       #endif
       {
-        __pyx_t_1 = PyTuple_New(2+__pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 678, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_New(2+__pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 716, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         if (__pyx_t_3) {
           __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3); __pyx_t_3 = NULL;
         }
         __Pyx_INCREF(__pyx_v_ar_len);
         __Pyx_GIVEREF(__pyx_v_ar_len);
         PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_15, __pyx_v_ar_len);
         __Pyx_INCREF(__pyx_v_ar_len);
         __Pyx_GIVEREF(__pyx_v_ar_len);
         PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_15, __pyx_v_ar_len);
-        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 678, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 716, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       }
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 678, __pyx_L1_error)
+      __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 716, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+
+      /* "statmoments/_native.pyx":715
+ *               self._accs2d[i, 0].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
+ *       if n1 > 0:
+ *         dgemm(tr_layout[n0:].reshape((-1, ar_len)), tr_layout[n0:].reshape((-1, ar_len)),             # <<<<<<<<<<<<<<
+ *               self._accs2d[i, 1].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
+ * 
+ */
       __pyx_t_20.__pyx_n = 2;
       __pyx_t_20.transa = 'N';
       __pyx_t_20.transb = 'T';
       __pyx_f_11statmoments_7_native_dgemm(__pyx_t_19, __pyx_t_18, __pyx_t_17, &__pyx_t_20); 
       __PYX_XDEC_MEMVIEW(&__pyx_t_19, 1);
       __pyx_t_19.memview = NULL;
       __pyx_t_19.data = NULL;
       __PYX_XDEC_MEMVIEW(&__pyx_t_18, 1);
       __pyx_t_18.memview = NULL;
       __pyx_t_18.data = NULL;
       __PYX_XDEC_MEMVIEW(&__pyx_t_17, 1);
       __pyx_t_17.memview = NULL;
       __pyx_t_17.data = NULL;
 
-      /* "statmoments/_native.pyx":677
- *       if n0 > 0:
- *         dgemm(tr_layout[:n0].reshape((-1, ar_len)), tr_layout[:n0].reshape((-1, ar_len)), self._accs2d[i, 0].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
+      /* "statmoments/_native.pyx":714
+ *         dgemm(tr_layout[:n0].reshape((-1, ar_len)), tr_layout[:n0].reshape((-1, ar_len)),
+ *               self._accs2d[i, 0].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
  *       if n1 > 0:             # <<<<<<<<<<<<<<
- *         dgemm(tr_layout[n0:].reshape((-1, ar_len)), tr_layout[n0:].reshape((-1, ar_len)), self._accs2d[i, 1].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
- * 
+ *         dgemm(tr_layout[n0:].reshape((-1, ar_len)), tr_layout[n0:].reshape((-1, ar_len)),
+ *               self._accs2d[i, 1].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
  */
     }
   }
 
-  /* "statmoments/_native.pyx":640
+  /* "statmoments/_native.pyx":676
  *     return mem_class + mem_ttest * 8
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     moment, batch_cnt = self.moment, len(traces)
  *     tr_len, cl_len = self.trace_len, len(classifiers[0])
  */
 
@@ -23532,16 +23969,16 @@
   __Pyx_XDECREF(__pyx_v_j);
   __Pyx_XDECREF(__pyx_v_ar_len);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":680
- *         dgemm(tr_layout[n0:].reshape((-1, ar_len)), tr_layout[n0:].reshape((-1, ar_len)), self._accs2d[i, 1].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
+/* "statmoments/_native.pyx":718
+ *               self._accs2d[i, 1].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
  *     return self._cls_count[i]
  * 
  */
 
 /* Python wrapper */
@@ -23575,32 +24012,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_i)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, 1); __PYX_ERR(0, 680, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, 1); __PYX_ERR(0, 718, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "counts") < 0)) __PYX_ERR(0, 680, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "counts") < 0)) __PYX_ERR(0, 718, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_i = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 680, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 718, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native.bivar_cntr.counts", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_10bivar_cntr_8counts(__pyx_self, __pyx_v_self, __pyx_v_i);
 
@@ -23615,33 +24052,33 @@
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("counts", 0);
 
-  /* "statmoments/_native.pyx":681
+  /* "statmoments/_native.pyx":719
  * 
  *   def counts(self, i):
  *     return self._cls_count[i]             # <<<<<<<<<<<<<<
  * 
  *   def _moments(self, moments, normalize):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cls_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 681, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cls_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 719, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 681, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 719, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":680
- *         dgemm(tr_layout[n0:].reshape((-1, ar_len)), tr_layout[n0:].reshape((-1, ar_len)), self._accs2d[i, 1].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
+  /* "statmoments/_native.pyx":718
+ *               self._accs2d[i, 1].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
  *     return self._cls_count[i]
  * 
  */
 
   /* function exit code */
@@ -23653,19 +24090,19 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static PyObject *__pyx_gb_11statmoments_7_native_10bivar_cntr_12generator3(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "statmoments/_native.pyx":683
+/* "statmoments/_native.pyx":721
  *     return self._cls_count[i]
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
- *     maxm = np.max(moments)
+ *     maxm, min_cnt = np.max(moments), self.acc_min_count
  *     if self.moment * 2 < maxm:
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_11statmoments_7_native_10bivar_cntr_11_moments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_11statmoments_7_native_10bivar_cntr_11_moments = {"_moments", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_10bivar_cntr_11_moments, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_11statmoments_7_native_10bivar_cntr_11_moments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
@@ -23699,40 +24136,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moments)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 1); __PYX_ERR(0, 683, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 1); __PYX_ERR(0, 721, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_normalize)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 2); __PYX_ERR(0, 683, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 2); __PYX_ERR(0, 721, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_moments") < 0)) __PYX_ERR(0, 683, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_moments") < 0)) __PYX_ERR(0, 721, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_moments = values[1];
     __pyx_v_normalize = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 683, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 721, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native.bivar_cntr._moments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_10bivar_cntr_10_moments(__pyx_self, __pyx_v_self, __pyx_v_moments, __pyx_v_normalize);
 
@@ -23749,29 +24186,29 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_moments", 0);
   __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_8__moments *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_8__moments(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_8__moments, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_8__moments *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 683, __pyx_L1_error)
+    __PYX_ERR(0, 721, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
   __pyx_cur_scope->__pyx_v_moments = __pyx_v_moments;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_moments);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_moments);
   __pyx_cur_scope->__pyx_v_normalize = __pyx_v_normalize;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_normalize);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_normalize);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_10bivar_cntr_12generator3, __pyx_codeobj__30, (PyObject *) __pyx_cur_scope, __pyx_n_s_moments_2, __pyx_n_s_bivar_cntr__moments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 683, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_10bivar_cntr_12generator3, __pyx_codeobj__31, (PyObject *) __pyx_cur_scope, __pyx_n_s_moments_2, __pyx_n_s_bivar_cntr__moments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 721, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -23808,658 +24245,736 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("_moments", 0);
   switch (__pyx_generator->resume_label) {
     case 0: goto __pyx_L3_first_run;
-    case 1: goto __pyx_L17_resume_from_yield;
+    case 1: goto __pyx_L10_resume_from_yield;
+    case 2: goto __pyx_L19_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 683, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 721, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":684
+  /* "statmoments/_native.pyx":722
  * 
  *   def _moments(self, moments, normalize):
- *     maxm = np.max(moments)             # <<<<<<<<<<<<<<
+ *     maxm, min_cnt = np.max(moments), self.acc_min_count             # <<<<<<<<<<<<<<
  *     if self.moment * 2 < maxm:
  *       raise ValueError("The moment should be less or equal than indicated in constructor.")
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 684, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_max); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 684, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_max); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_cur_scope->__pyx_v_moments) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_cur_scope->__pyx_v_moments);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 684, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_acc_min_count); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 722, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v_maxm = __pyx_t_1;
   __pyx_t_1 = 0;
+  __Pyx_GIVEREF(__pyx_t_3);
+  __pyx_cur_scope->__pyx_v_min_cnt = __pyx_t_3;
+  __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":685
+  /* "statmoments/_native.pyx":723
  *   def _moments(self, moments, normalize):
- *     maxm = np.max(moments)
+ *     maxm, min_cnt = np.max(moments), self.acc_min_count
  *     if self.moment * 2 < maxm:             # <<<<<<<<<<<<<<
  *       raise ValueError("The moment should be less or equal than indicated in constructor.")
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 685, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_int_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 685, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 723, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyObject_RichCompare(__pyx_t_3, __pyx_cur_scope->__pyx_v_maxm, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 685, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_3, __pyx_int_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 723, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 685, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_t_1, __pyx_cur_scope->__pyx_v_maxm, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 723, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 723, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (unlikely(__pyx_t_4)) {
 
-    /* "statmoments/_native.pyx":686
- *     maxm = np.max(moments)
+    /* "statmoments/_native.pyx":724
+ *     maxm, min_cnt = np.max(moments), self.acc_min_count
  *     if self.moment * 2 < maxm:
  *       raise ValueError("The moment should be less or equal than indicated in constructor.")             # <<<<<<<<<<<<<<
  * 
- *     moments = [m-2 for m in moments]
+ *     moments = [m - 2 for m in moments]
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 686, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 686, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 724, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __PYX_ERR(0, 724, __pyx_L1_error)
 
-    /* "statmoments/_native.pyx":685
+    /* "statmoments/_native.pyx":723
  *   def _moments(self, moments, normalize):
- *     maxm = np.max(moments)
+ *     maxm, min_cnt = np.max(moments), self.acc_min_count
  *     if self.moment * 2 < maxm:             # <<<<<<<<<<<<<<
  *       raise ValueError("The moment should be less or equal than indicated in constructor.")
  * 
  */
   }
 
-  /* "statmoments/_native.pyx":688
+  /* "statmoments/_native.pyx":726
  *       raise ValueError("The moment should be less or equal than indicated in constructor.")
  * 
- *     moments = [m-2 for m in moments]             # <<<<<<<<<<<<<<
+ *     moments = [m - 2 for m in moments]             # <<<<<<<<<<<<<<
  *     tr_len, cl_len = self.trace_len, self._accs2d.shape[0]
  * 
  */
   { /* enter inner scope */
-    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 688, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 726, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
     if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_v_moments)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_moments)) {
-      __pyx_t_3 = __pyx_cur_scope->__pyx_v_moments; __Pyx_INCREF(__pyx_t_3); __pyx_t_5 = 0;
+      __pyx_t_1 = __pyx_cur_scope->__pyx_v_moments; __Pyx_INCREF(__pyx_t_1); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
     } else {
-      __pyx_t_5 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 688, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_6 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 688, __pyx_L1_error)
+      __pyx_t_5 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 726, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_6 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 726, __pyx_L1_error)
     }
     for (;;) {
       if (likely(!__pyx_t_6)) {
-        if (likely(PyList_CheckExact(__pyx_t_3))) {
-          if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_3)) break;
+        if (likely(PyList_CheckExact(__pyx_t_1))) {
+          if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 688, __pyx_L1_error)
+          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 726, __pyx_L1_error)
           #else
-          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 688, __pyx_L1_error)
+          __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 726, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           #endif
         } else {
-          if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
+          if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 688, __pyx_L1_error)
+          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 726, __pyx_L1_error)
           #else
-          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 688, __pyx_L1_error)
+          __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 726, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           #endif
         }
       } else {
-        __pyx_t_2 = __pyx_t_6(__pyx_t_3);
+        __pyx_t_2 = __pyx_t_6(__pyx_t_1);
         if (unlikely(!__pyx_t_2)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 688, __pyx_L1_error)
+            else __PYX_ERR(0, 726, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_2);
       }
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_8genexpr4__pyx_v_m);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_8genexpr4__pyx_v_m, __pyx_t_2);
       __Pyx_GIVEREF(__pyx_t_2);
       __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_cur_scope->__pyx_8genexpr4__pyx_v_m, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 688, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_cur_scope->__pyx_8genexpr4__pyx_v_m, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 726, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 688, __pyx_L1_error)
+      if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 726, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   } /* exit inner scope */
   __Pyx_GOTREF(__pyx_cur_scope->__pyx_v_moments);
-  __Pyx_DECREF_SET(__pyx_cur_scope->__pyx_v_moments, __pyx_t_1);
-  __Pyx_GIVEREF(__pyx_t_1);
-  __pyx_t_1 = 0;
+  __Pyx_DECREF_SET(__pyx_cur_scope->__pyx_v_moments, __pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_3);
+  __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":689
+  /* "statmoments/_native.pyx":727
  * 
- *     moments = [m-2 for m in moments]
+ *     moments = [m - 2 for m in moments]
  *     tr_len, cl_len = self.trace_len, self._accs2d.shape[0]             # <<<<<<<<<<<<<<
  * 
  *     # 2D stat should return a separate piece of memory to avoid buffer corruption
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 689, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs2d); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 689, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 727, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 689, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs2d); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 727, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 727, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 689, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 727, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __Pyx_GIVEREF(__pyx_t_1);
-  __pyx_cur_scope->__pyx_v_tr_len = __pyx_t_1;
-  __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_3);
-  __pyx_cur_scope->__pyx_v_cl_len = __pyx_t_3;
+  __pyx_cur_scope->__pyx_v_tr_len = __pyx_t_3;
   __pyx_t_3 = 0;
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_cur_scope->__pyx_v_cl_len = __pyx_t_1;
+  __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":693
+  /* "statmoments/_native.pyx":731
  *     # 2D stat should return a separate piece of memory to avoid buffer corruption
  *     # while normalizing coskeweness and higher moments
- *     retm  = np.empty((2, len(moments), tr_len), dtype=np.float64)             # <<<<<<<<<<<<<<
+ *     retm = np.empty((2, len(moments), tr_len), dtype=np.float64)             # <<<<<<<<<<<<<<
  * 
  *     for ii in range(cl_len):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 693, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 693, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 731, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = PyObject_Length(__pyx_cur_scope->__pyx_v_moments); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 693, __pyx_L1_error)
-  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 693, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 731, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 693, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_5 = PyObject_Length(__pyx_cur_scope->__pyx_v_moments); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 731, __pyx_L1_error)
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 731, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 731, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_2);
-  __Pyx_GIVEREF(__pyx_t_3);
-  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1);
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_tr_len);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_tr_len);
   PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_cur_scope->__pyx_v_tr_len);
-  __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 693, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = 0;
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 731, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 693, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 731, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 693, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 731, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_float64); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 693, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_float64); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 731, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_8) < 0) __PYX_ERR(0, 693, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_8) < 0) __PYX_ERR(0, 731, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 693, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 731, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_GIVEREF(__pyx_t_8);
   __pyx_cur_scope->__pyx_v_retm = __pyx_t_8;
   __pyx_t_8 = 0;
 
-  /* "statmoments/_native.pyx":695
- *     retm  = np.empty((2, len(moments), tr_len), dtype=np.float64)
+  /* "statmoments/_native.pyx":733
+ *     retm = np.empty((2, len(moments), tr_len), dtype=np.float64)
  * 
  *     for ii in range(cl_len):             # <<<<<<<<<<<<<<
- *       for _i in range(2):
- *         cm = retm[_i]
+ *       nn = self._cls_count[ii]
+ *       if min(nn) < min_cnt:
  */
-  __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_cur_scope->__pyx_v_cl_len); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 695, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_cur_scope->__pyx_v_cl_len); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 733, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   if (likely(PyList_CheckExact(__pyx_t_8)) || PyTuple_CheckExact(__pyx_t_8)) {
     __pyx_t_2 = __pyx_t_8; __Pyx_INCREF(__pyx_t_2); __pyx_t_5 = 0;
     __pyx_t_6 = NULL;
   } else {
-    __pyx_t_5 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 695, __pyx_L1_error)
+    __pyx_t_5 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 733, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_6 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 695, __pyx_L1_error)
+    __pyx_t_6 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 733, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   for (;;) {
     if (likely(!__pyx_t_6)) {
       if (likely(PyList_CheckExact(__pyx_t_2))) {
         if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_8 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_8); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 695, __pyx_L1_error)
+        __pyx_t_8 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_8); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 733, __pyx_L1_error)
         #else
-        __pyx_t_8 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 695, __pyx_L1_error)
+        __pyx_t_8 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 733, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         #endif
       } else {
         if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_8); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 695, __pyx_L1_error)
+        __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_8); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 733, __pyx_L1_error)
         #else
-        __pyx_t_8 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 695, __pyx_L1_error)
+        __pyx_t_8 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 733, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         #endif
       }
     } else {
       __pyx_t_8 = __pyx_t_6(__pyx_t_2);
       if (unlikely(!__pyx_t_8)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 695, __pyx_L1_error)
+          else __PYX_ERR(0, 733, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_8);
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_ii);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_ii, __pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_8);
     __pyx_t_8 = 0;
 
-    /* "statmoments/_native.pyx":696
+    /* "statmoments/_native.pyx":734
+ * 
+ *     for ii in range(cl_len):
+ *       nn = self._cls_count[ii]             # <<<<<<<<<<<<<<
+ *       if min(nn) < min_cnt:
+ *         retm[:] = 0
+ */
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_cls_count); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 734, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_8);
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_8, __pyx_cur_scope->__pyx_v_ii); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 734, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+    __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_nn);
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_nn, __pyx_t_1);
+    __Pyx_GIVEREF(__pyx_t_1);
+    __pyx_t_1 = 0;
+
+    /* "statmoments/_native.pyx":735
+ *     for ii in range(cl_len):
+ *       nn = self._cls_count[ii]
+ *       if min(nn) < min_cnt:             # <<<<<<<<<<<<<<
+ *         retm[:] = 0
+ *         yield retm
+ */
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_min, __pyx_cur_scope->__pyx_v_nn); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 735, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_8 = PyObject_RichCompare(__pyx_t_1, __pyx_cur_scope->__pyx_v_min_cnt, Py_LT); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 735, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 735, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+    if (__pyx_t_4) {
+
+      /* "statmoments/_native.pyx":736
+ *       nn = self._cls_count[ii]
+ *       if min(nn) < min_cnt:
+ *         retm[:] = 0             # <<<<<<<<<<<<<<
+ *         yield retm
+ *         continue
+ */
+      if (__Pyx_PyObject_SetSlice(__pyx_cur_scope->__pyx_v_retm, __pyx_int_0, 0, 0, NULL, NULL, &__pyx_slice__7, 0, 0, 0) < 0) __PYX_ERR(0, 736, __pyx_L1_error)
+
+      /* "statmoments/_native.pyx":737
+ *       if min(nn) < min_cnt:
+ *         retm[:] = 0
+ *         yield retm             # <<<<<<<<<<<<<<
+ *         continue
+ * 
+ */
+      __Pyx_INCREF(__pyx_cur_scope->__pyx_v_retm);
+      __pyx_r = __pyx_cur_scope->__pyx_v_retm;
+      __Pyx_XGIVEREF(__pyx_t_2);
+      __pyx_cur_scope->__pyx_t_0 = __pyx_t_2;
+      __pyx_cur_scope->__pyx_t_1 = __pyx_t_5;
+      __pyx_cur_scope->__pyx_t_2 = __pyx_t_6;
+      __Pyx_XGIVEREF(__pyx_r);
+      __Pyx_RefNannyFinishContext();
+      __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
+      /* return from generator, yielding value */
+      __pyx_generator->resume_label = 1;
+      return __pyx_r;
+      __pyx_L10_resume_from_yield:;
+      __pyx_t_2 = __pyx_cur_scope->__pyx_t_0;
+      __pyx_cur_scope->__pyx_t_0 = 0;
+      __Pyx_XGOTREF(__pyx_t_2);
+      __pyx_t_5 = __pyx_cur_scope->__pyx_t_1;
+      __pyx_t_6 = __pyx_cur_scope->__pyx_t_2;
+      if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 737, __pyx_L1_error)
+
+      /* "statmoments/_native.pyx":738
+ *         retm[:] = 0
+ *         yield retm
+ *         continue             # <<<<<<<<<<<<<<
  * 
+ *       for _i in range(2):
+ */
+      goto __pyx_L7_continue;
+
+      /* "statmoments/_native.pyx":735
  *     for ii in range(cl_len):
+ *       nn = self._cls_count[ii]
+ *       if min(nn) < min_cnt:             # <<<<<<<<<<<<<<
+ *         retm[:] = 0
+ *         yield retm
+ */
+    }
+
+    /* "statmoments/_native.pyx":740
+ *         continue
+ * 
  *       for _i in range(2):             # <<<<<<<<<<<<<<
  *         cm = retm[_i]
  *         for jj, m in enumerate(moments):
  */
     for (__pyx_t_9 = 0; __pyx_t_9 < 2; __pyx_t_9+=1) {
       __pyx_cur_scope->__pyx_v__i = __pyx_t_9;
 
-      /* "statmoments/_native.pyx":697
- *     for ii in range(cl_len):
+      /* "statmoments/_native.pyx":741
+ * 
  *       for _i in range(2):
  *         cm = retm[_i]             # <<<<<<<<<<<<<<
  *         for jj, m in enumerate(moments):
  *           if m == -1:
  */
-      __pyx_t_8 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_retm, __pyx_cur_scope->__pyx_v__i, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 697, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_retm, __pyx_cur_scope->__pyx_v__i, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 741, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_cm);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_cm, __pyx_t_8);
       __Pyx_GIVEREF(__pyx_t_8);
       __pyx_t_8 = 0;
 
-      /* "statmoments/_native.pyx":698
+      /* "statmoments/_native.pyx":742
  *       for _i in range(2):
  *         cm = retm[_i]
  *         for jj, m in enumerate(moments):             # <<<<<<<<<<<<<<
  *           if m == -1:
  *             cm[jj] = self._accs1d[ii][_i]
  */
       __Pyx_INCREF(__pyx_int_0);
       __pyx_t_8 = __pyx_int_0;
       if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_v_moments)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_moments)) {
-        __pyx_t_3 = __pyx_cur_scope->__pyx_v_moments; __Pyx_INCREF(__pyx_t_3); __pyx_t_10 = 0;
+        __pyx_t_1 = __pyx_cur_scope->__pyx_v_moments; __Pyx_INCREF(__pyx_t_1); __pyx_t_10 = 0;
         __pyx_t_11 = NULL;
       } else {
-        __pyx_t_10 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 698, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_11 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 698, __pyx_L1_error)
+        __pyx_t_10 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 742, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __pyx_t_11 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 742, __pyx_L1_error)
       }
       for (;;) {
         if (likely(!__pyx_t_11)) {
-          if (likely(PyList_CheckExact(__pyx_t_3))) {
-            if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_3)) break;
+          if (likely(PyList_CheckExact(__pyx_t_1))) {
+            if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_1)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_10); __Pyx_INCREF(__pyx_t_1); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 698, __pyx_L1_error)
+            __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_10); __Pyx_INCREF(__pyx_t_3); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 742, __pyx_L1_error)
             #else
-            __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_1);
+            __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 742, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_3);
             #endif
           } else {
-            if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
+            if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_10); __Pyx_INCREF(__pyx_t_1); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 698, __pyx_L1_error)
+            __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_10); __Pyx_INCREF(__pyx_t_3); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 742, __pyx_L1_error)
             #else
-            __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_1);
+            __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 742, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_3);
             #endif
           }
         } else {
-          __pyx_t_1 = __pyx_t_11(__pyx_t_3);
-          if (unlikely(!__pyx_t_1)) {
+          __pyx_t_3 = __pyx_t_11(__pyx_t_1);
+          if (unlikely(!__pyx_t_3)) {
             PyObject* exc_type = PyErr_Occurred();
             if (exc_type) {
               if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-              else __PYX_ERR(0, 698, __pyx_L1_error)
+              else __PYX_ERR(0, 742, __pyx_L1_error)
             }
             break;
           }
-          __Pyx_GOTREF(__pyx_t_1);
+          __Pyx_GOTREF(__pyx_t_3);
         }
         __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_m);
-        __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_m, __pyx_t_1);
-        __Pyx_GIVEREF(__pyx_t_1);
-        __pyx_t_1 = 0;
+        __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_m, __pyx_t_3);
+        __Pyx_GIVEREF(__pyx_t_3);
+        __pyx_t_3 = 0;
         __Pyx_INCREF(__pyx_t_8);
         __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_jj);
         __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_jj, __pyx_t_8);
         __Pyx_GIVEREF(__pyx_t_8);
-        __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_t_8, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_1);
+        __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_t_8, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 742, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_8);
-        __pyx_t_8 = __pyx_t_1;
-        __pyx_t_1 = 0;
+        __pyx_t_8 = __pyx_t_3;
+        __pyx_t_3 = 0;
 
-        /* "statmoments/_native.pyx":699
+        /* "statmoments/_native.pyx":743
  *         cm = retm[_i]
  *         for jj, m in enumerate(moments):
  *           if m == -1:             # <<<<<<<<<<<<<<
  *             cm[jj] = self._accs1d[ii][_i]
  *           else:
  */
-        __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_cur_scope->__pyx_v_m, __pyx_int_neg_1, -1L, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 699, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 699, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_cur_scope->__pyx_v_m, __pyx_int_neg_1, -1L, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 743, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 743, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         if (__pyx_t_4) {
 
-          /* "statmoments/_native.pyx":700
+          /* "statmoments/_native.pyx":744
  *         for jj, m in enumerate(moments):
  *           if m == -1:
  *             cm[jj] = self._accs1d[ii][_i]             # <<<<<<<<<<<<<<
  *           else:
- *             nn = self._cls_count[ii][_i]
+ *             cm[jj] = 1 / nn[_i] * self._accs2d[ii][_i, m // 2, :, m // 2 + m % 2, :].diagonal()
  */
-          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs1d); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 700, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_cur_scope->__pyx_v_ii); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 700, __pyx_L1_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs1d); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 744, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_3);
+          __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_cur_scope->__pyx_v_ii); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 744, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
-          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-          __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_7, __pyx_cur_scope->__pyx_v__i, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 700, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_1);
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_7, __pyx_cur_scope->__pyx_v__i, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 744, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_cur_scope->__pyx_v_jj, __pyx_t_1) < 0)) __PYX_ERR(0, 700, __pyx_L1_error)
-          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+          if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_cur_scope->__pyx_v_jj, __pyx_t_3) < 0)) __PYX_ERR(0, 744, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-          /* "statmoments/_native.pyx":699
+          /* "statmoments/_native.pyx":743
  *         cm = retm[_i]
  *         for jj, m in enumerate(moments):
  *           if m == -1:             # <<<<<<<<<<<<<<
  *             cm[jj] = self._accs1d[ii][_i]
  *           else:
  */
-          goto __pyx_L13;
+          goto __pyx_L15;
         }
 
-        /* "statmoments/_native.pyx":702
+        /* "statmoments/_native.pyx":746
  *             cm[jj] = self._accs1d[ii][_i]
  *           else:
- *             nn = self._cls_count[ii][_i]             # <<<<<<<<<<<<<<
- *             cm[jj] = 1/nn * self._accs2d[ii][_i, m//2, :, m//2+m%2, :].diagonal()
+ *             cm[jj] = 1 / nn[_i] * self._accs2d[ii][_i, m // 2, :, m // 2 + m % 2, :].diagonal()             # <<<<<<<<<<<<<<
  * 
+ *             if m >= 1 and normalize:
  */
         /*else*/ {
-          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_cls_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 702, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_cur_scope->__pyx_v_ii); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 702, __pyx_L1_error)
+          __pyx_t_3 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_nn, __pyx_cur_scope->__pyx_v__i, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 746, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_3);
+          __pyx_t_7 = __Pyx_PyNumber_Divide(__pyx_int_1, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 746, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
-          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-          __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_7, __pyx_cur_scope->__pyx_v__i, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 702, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_1);
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_nn);
-          __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_nn, __pyx_t_1);
-          __Pyx_GIVEREF(__pyx_t_1);
-          __pyx_t_1 = 0;
-
-          /* "statmoments/_native.pyx":703
- *           else:
- *             nn = self._cls_count[ii][_i]
- *             cm[jj] = 1/nn * self._accs2d[ii][_i, m//2, :, m//2+m%2, :].diagonal()             # <<<<<<<<<<<<<<
- * 
- *             if m >= 1 and normalize:
- */
-          __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_int_1, __pyx_cur_scope->__pyx_v_nn); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 703, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs2d); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 703, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs2d); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 746, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
-          __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_t_12, __pyx_cur_scope->__pyx_v_ii); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 703, __pyx_L1_error)
+          __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_t_12, __pyx_cur_scope->__pyx_v_ii); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 746, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_13);
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-          __pyx_t_12 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 703, __pyx_L1_error)
+          __pyx_t_12 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 746, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
-          __pyx_t_14 = __Pyx_PyInt_FloorDivideObjC(__pyx_cur_scope->__pyx_v_m, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 703, __pyx_L1_error)
+          __pyx_t_14 = __Pyx_PyInt_FloorDivideObjC(__pyx_cur_scope->__pyx_v_m, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 746, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_14);
-          __pyx_t_15 = __Pyx_PyInt_FloorDivideObjC(__pyx_cur_scope->__pyx_v_m, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 703, __pyx_L1_error)
+          __pyx_t_15 = __Pyx_PyInt_FloorDivideObjC(__pyx_cur_scope->__pyx_v_m, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 746, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_15);
-          __pyx_t_16 = __Pyx_PyInt_RemainderObjC(__pyx_cur_scope->__pyx_v_m, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 703, __pyx_L1_error)
+          __pyx_t_16 = __Pyx_PyInt_RemainderObjC(__pyx_cur_scope->__pyx_v_m, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 746, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_16);
-          __pyx_t_17 = PyNumber_Add(__pyx_t_15, __pyx_t_16); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 703, __pyx_L1_error)
+          __pyx_t_17 = PyNumber_Add(__pyx_t_15, __pyx_t_16); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 746, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_17);
           __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
           __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-          __pyx_t_16 = PyTuple_New(5); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 703, __pyx_L1_error)
+          __pyx_t_16 = PyTuple_New(5); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 746, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_16);
           __Pyx_GIVEREF(__pyx_t_12);
           PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_12);
           __Pyx_GIVEREF(__pyx_t_14);
           PyTuple_SET_ITEM(__pyx_t_16, 1, __pyx_t_14);
-          __Pyx_INCREF(__pyx_slice__5);
-          __Pyx_GIVEREF(__pyx_slice__5);
-          PyTuple_SET_ITEM(__pyx_t_16, 2, __pyx_slice__5);
+          __Pyx_INCREF(__pyx_slice__7);
+          __Pyx_GIVEREF(__pyx_slice__7);
+          PyTuple_SET_ITEM(__pyx_t_16, 2, __pyx_slice__7);
           __Pyx_GIVEREF(__pyx_t_17);
           PyTuple_SET_ITEM(__pyx_t_16, 3, __pyx_t_17);
-          __Pyx_INCREF(__pyx_slice__5);
-          __Pyx_GIVEREF(__pyx_slice__5);
-          PyTuple_SET_ITEM(__pyx_t_16, 4, __pyx_slice__5);
+          __Pyx_INCREF(__pyx_slice__7);
+          __Pyx_GIVEREF(__pyx_slice__7);
+          PyTuple_SET_ITEM(__pyx_t_16, 4, __pyx_slice__7);
           __pyx_t_12 = 0;
           __pyx_t_14 = 0;
           __pyx_t_17 = 0;
-          __pyx_t_17 = __Pyx_PyObject_GetItem(__pyx_t_13, __pyx_t_16); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 703, __pyx_L1_error)
+          __pyx_t_17 = __Pyx_PyObject_GetItem(__pyx_t_13, __pyx_t_16); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 746, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_17);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
           __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-          __pyx_t_16 = __Pyx_PyObject_GetAttrStr(__pyx_t_17, __pyx_n_s_diagonal); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 703, __pyx_L1_error)
+          __pyx_t_16 = __Pyx_PyObject_GetAttrStr(__pyx_t_17, __pyx_n_s_diagonal); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 746, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_16);
           __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
           __pyx_t_17 = NULL;
           if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_16))) {
             __pyx_t_17 = PyMethod_GET_SELF(__pyx_t_16);
             if (likely(__pyx_t_17)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_16);
               __Pyx_INCREF(__pyx_t_17);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_16, function);
             }
           }
-          __pyx_t_7 = (__pyx_t_17) ? __Pyx_PyObject_CallOneArg(__pyx_t_16, __pyx_t_17) : __Pyx_PyObject_CallNoArg(__pyx_t_16);
+          __pyx_t_3 = (__pyx_t_17) ? __Pyx_PyObject_CallOneArg(__pyx_t_16, __pyx_t_17) : __Pyx_PyObject_CallNoArg(__pyx_t_16);
           __Pyx_XDECREF(__pyx_t_17); __pyx_t_17 = 0;
-          if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 703, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_7);
+          if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 746, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-          __pyx_t_16 = PyNumber_Multiply(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 703, __pyx_L1_error)
+          __pyx_t_16 = PyNumber_Multiply(__pyx_t_7, __pyx_t_3); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 746, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_16);
-          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_cur_scope->__pyx_v_jj, __pyx_t_16) < 0)) __PYX_ERR(0, 703, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_cur_scope->__pyx_v_jj, __pyx_t_16) < 0)) __PYX_ERR(0, 746, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
 
-          /* "statmoments/_native.pyx":705
- *             cm[jj] = 1/nn * self._accs2d[ii][_i, m//2, :, m//2+m%2, :].diagonal()
+          /* "statmoments/_native.pyx":748
+ *             cm[jj] = 1 / nn[_i] * self._accs2d[ii][_i, m // 2, :, m // 2 + m % 2, :].diagonal()
  * 
  *             if m >= 1 and normalize:             # <<<<<<<<<<<<<<
- *               sd = np.sqrt(1/nn * self._accs2d[ii][_i, 0, :, 0, :].diagonal())
+ *               sd = np.sqrt(1 / nn[_i] * self._accs2d[ii][_i, 0, :, 0, :].diagonal())
  *               cm[jj] /= sd ** (m + 2)
  */
-          __pyx_t_16 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_m, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_16); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 705, __pyx_L1_error)
-          __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_t_16); if (unlikely(__pyx_t_18 < 0)) __PYX_ERR(0, 705, __pyx_L1_error)
+          __pyx_t_16 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_m, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_16); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 748, __pyx_L1_error)
+          __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_t_16); if (unlikely(__pyx_t_18 < 0)) __PYX_ERR(0, 748, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
           if (__pyx_t_18) {
           } else {
             __pyx_t_4 = __pyx_t_18;
-            goto __pyx_L15_bool_binop_done;
+            goto __pyx_L17_bool_binop_done;
           }
-          __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_normalize); if (unlikely(__pyx_t_18 < 0)) __PYX_ERR(0, 705, __pyx_L1_error)
+          __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_normalize); if (unlikely(__pyx_t_18 < 0)) __PYX_ERR(0, 748, __pyx_L1_error)
           __pyx_t_4 = __pyx_t_18;
-          __pyx_L15_bool_binop_done:;
+          __pyx_L17_bool_binop_done:;
           if (__pyx_t_4) {
 
-            /* "statmoments/_native.pyx":706
+            /* "statmoments/_native.pyx":749
  * 
  *             if m >= 1 and normalize:
- *               sd = np.sqrt(1/nn * self._accs2d[ii][_i, 0, :, 0, :].diagonal())             # <<<<<<<<<<<<<<
+ *               sd = np.sqrt(1 / nn[_i] * self._accs2d[ii][_i, 0, :, 0, :].diagonal())             # <<<<<<<<<<<<<<
  *               cm[jj] /= sd ** (m + 2)
  * 
  */
-            __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 706, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_7);
-            __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 706, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_1);
-            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-            __pyx_t_7 = __Pyx_PyNumber_Divide(__pyx_int_1, __pyx_cur_scope->__pyx_v_nn); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 706, __pyx_L1_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 749, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_3);
+            __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 749, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_7);
-            __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs2d); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 706, __pyx_L1_error)
+            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+            __pyx_t_3 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_nn, __pyx_cur_scope->__pyx_v__i, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 749, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_3);
+            __pyx_t_17 = __Pyx_PyNumber_Divide(__pyx_int_1, __pyx_t_3); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 749, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_17);
+            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+            __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs2d); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 749, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_13);
-            __pyx_t_14 = __Pyx_PyObject_GetItem(__pyx_t_13, __pyx_cur_scope->__pyx_v_ii); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 706, __pyx_L1_error)
+            __pyx_t_14 = __Pyx_PyObject_GetItem(__pyx_t_13, __pyx_cur_scope->__pyx_v_ii); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 749, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_14);
             __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-            __pyx_t_13 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 706, __pyx_L1_error)
+            __pyx_t_13 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 749, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_13);
-            __pyx_t_12 = PyTuple_New(5); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 706, __pyx_L1_error)
+            __pyx_t_12 = PyTuple_New(5); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 749, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_12);
             __Pyx_GIVEREF(__pyx_t_13);
             PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_13);
             __Pyx_INCREF(__pyx_int_0);
             __Pyx_GIVEREF(__pyx_int_0);
             PyTuple_SET_ITEM(__pyx_t_12, 1, __pyx_int_0);
-            __Pyx_INCREF(__pyx_slice__5);
-            __Pyx_GIVEREF(__pyx_slice__5);
-            PyTuple_SET_ITEM(__pyx_t_12, 2, __pyx_slice__5);
+            __Pyx_INCREF(__pyx_slice__7);
+            __Pyx_GIVEREF(__pyx_slice__7);
+            PyTuple_SET_ITEM(__pyx_t_12, 2, __pyx_slice__7);
             __Pyx_INCREF(__pyx_int_0);
             __Pyx_GIVEREF(__pyx_int_0);
             PyTuple_SET_ITEM(__pyx_t_12, 3, __pyx_int_0);
-            __Pyx_INCREF(__pyx_slice__5);
-            __Pyx_GIVEREF(__pyx_slice__5);
-            PyTuple_SET_ITEM(__pyx_t_12, 4, __pyx_slice__5);
+            __Pyx_INCREF(__pyx_slice__7);
+            __Pyx_GIVEREF(__pyx_slice__7);
+            PyTuple_SET_ITEM(__pyx_t_12, 4, __pyx_slice__7);
             __pyx_t_13 = 0;
-            __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_t_14, __pyx_t_12); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 706, __pyx_L1_error)
+            __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_t_14, __pyx_t_12); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 749, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_13);
             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
             __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-            __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_diagonal); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 706, __pyx_L1_error)
+            __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_diagonal); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 749, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_12);
             __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
             __pyx_t_13 = NULL;
             if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_12))) {
               __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_12);
               if (likely(__pyx_t_13)) {
                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_12);
                 __Pyx_INCREF(__pyx_t_13);
                 __Pyx_INCREF(function);
                 __Pyx_DECREF_SET(__pyx_t_12, function);
               }
             }
-            __pyx_t_17 = (__pyx_t_13) ? __Pyx_PyObject_CallOneArg(__pyx_t_12, __pyx_t_13) : __Pyx_PyObject_CallNoArg(__pyx_t_12);
+            __pyx_t_3 = (__pyx_t_13) ? __Pyx_PyObject_CallOneArg(__pyx_t_12, __pyx_t_13) : __Pyx_PyObject_CallNoArg(__pyx_t_12);
             __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
-            if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 706, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_17);
+            if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 749, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_3);
             __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-            __pyx_t_12 = PyNumber_Multiply(__pyx_t_7, __pyx_t_17); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 706, __pyx_L1_error)
+            __pyx_t_12 = PyNumber_Multiply(__pyx_t_17, __pyx_t_3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 749, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_12);
-            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
             __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
-            __pyx_t_17 = NULL;
-            if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
-              __pyx_t_17 = PyMethod_GET_SELF(__pyx_t_1);
-              if (likely(__pyx_t_17)) {
-                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
-                __Pyx_INCREF(__pyx_t_17);
+            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+            __pyx_t_3 = NULL;
+            if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
+              __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_7);
+              if (likely(__pyx_t_3)) {
+                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
+                __Pyx_INCREF(__pyx_t_3);
                 __Pyx_INCREF(function);
-                __Pyx_DECREF_SET(__pyx_t_1, function);
+                __Pyx_DECREF_SET(__pyx_t_7, function);
               }
             }
-            __pyx_t_16 = (__pyx_t_17) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_17, __pyx_t_12) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_12);
-            __Pyx_XDECREF(__pyx_t_17); __pyx_t_17 = 0;
+            __pyx_t_16 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_3, __pyx_t_12) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_12);
+            __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
             __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-            if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 706, __pyx_L1_error)
+            if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 749, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_16);
-            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
             __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_sd);
             __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_sd, __pyx_t_16);
             __Pyx_GIVEREF(__pyx_t_16);
             __pyx_t_16 = 0;
 
-            /* "statmoments/_native.pyx":707
+            /* "statmoments/_native.pyx":750
  *             if m >= 1 and normalize:
- *               sd = np.sqrt(1/nn * self._accs2d[ii][_i, 0, :, 0, :].diagonal())
+ *               sd = np.sqrt(1 / nn[_i] * self._accs2d[ii][_i, 0, :, 0, :].diagonal())
  *               cm[jj] /= sd ** (m + 2)             # <<<<<<<<<<<<<<
  * 
  *       yield retm
  */
             __Pyx_INCREF(__pyx_cur_scope->__pyx_v_jj);
             __pyx_t_16 = __pyx_cur_scope->__pyx_v_jj;
-            __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_16); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 707, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_1);
-            __pyx_t_12 = __Pyx_PyInt_AddObjC(__pyx_cur_scope->__pyx_v_m, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 707, __pyx_L1_error)
+            __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_16); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 750, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_7);
+            __pyx_t_12 = __Pyx_PyInt_AddObjC(__pyx_cur_scope->__pyx_v_m, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 750, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_12);
-            __pyx_t_17 = PyNumber_Power(__pyx_cur_scope->__pyx_v_sd, __pyx_t_12, Py_None); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 707, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_17);
+            __pyx_t_3 = PyNumber_Power(__pyx_cur_scope->__pyx_v_sd, __pyx_t_12, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 750, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_3);
             __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-            __pyx_t_12 = __Pyx_PyNumber_InPlaceDivide(__pyx_t_1, __pyx_t_17); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 707, __pyx_L1_error)
+            __pyx_t_12 = __Pyx_PyNumber_InPlaceDivide(__pyx_t_7, __pyx_t_3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 750, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_12);
-            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-            __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
-            if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_16, __pyx_t_12) < 0)) __PYX_ERR(0, 707, __pyx_L1_error)
+            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+            if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_16, __pyx_t_12) < 0)) __PYX_ERR(0, 750, __pyx_L1_error)
             __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
             __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
 
-            /* "statmoments/_native.pyx":705
- *             cm[jj] = 1/nn * self._accs2d[ii][_i, m//2, :, m//2+m%2, :].diagonal()
+            /* "statmoments/_native.pyx":748
+ *             cm[jj] = 1 / nn[_i] * self._accs2d[ii][_i, m // 2, :, m // 2 + m % 2, :].diagonal()
  * 
  *             if m >= 1 and normalize:             # <<<<<<<<<<<<<<
- *               sd = np.sqrt(1/nn * self._accs2d[ii][_i, 0, :, 0, :].diagonal())
+ *               sd = np.sqrt(1 / nn[_i] * self._accs2d[ii][_i, 0, :, 0, :].diagonal())
  *               cm[jj] /= sd ** (m + 2)
  */
           }
         }
-        __pyx_L13:;
+        __pyx_L15:;
 
-        /* "statmoments/_native.pyx":698
+        /* "statmoments/_native.pyx":742
  *       for _i in range(2):
  *         cm = retm[_i]
  *         for jj, m in enumerate(moments):             # <<<<<<<<<<<<<<
  *           if m == -1:
  *             cm[jj] = self._accs1d[ii][_i]
  */
       }
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     }
 
-    /* "statmoments/_native.pyx":709
+    /* "statmoments/_native.pyx":752
  *               cm[jj] /= sd ** (m + 2)
  * 
  *       yield retm             # <<<<<<<<<<<<<<
  * 
  *   def _comoments(self, moments, normalize):
  */
     __Pyx_INCREF(__pyx_cur_scope->__pyx_v_retm);
@@ -24468,40 +24983,41 @@
     __pyx_cur_scope->__pyx_t_0 = __pyx_t_2;
     __pyx_cur_scope->__pyx_t_1 = __pyx_t_5;
     __pyx_cur_scope->__pyx_t_2 = __pyx_t_6;
     __Pyx_XGIVEREF(__pyx_r);
     __Pyx_RefNannyFinishContext();
     __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
     /* return from generator, yielding value */
-    __pyx_generator->resume_label = 1;
+    __pyx_generator->resume_label = 2;
     return __pyx_r;
-    __pyx_L17_resume_from_yield:;
+    __pyx_L19_resume_from_yield:;
     __pyx_t_2 = __pyx_cur_scope->__pyx_t_0;
     __pyx_cur_scope->__pyx_t_0 = 0;
     __Pyx_XGOTREF(__pyx_t_2);
     __pyx_t_5 = __pyx_cur_scope->__pyx_t_1;
     __pyx_t_6 = __pyx_cur_scope->__pyx_t_2;
-    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 709, __pyx_L1_error)
+    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 752, __pyx_L1_error)
 
-    /* "statmoments/_native.pyx":695
- *     retm  = np.empty((2, len(moments), tr_len), dtype=np.float64)
+    /* "statmoments/_native.pyx":733
+ *     retm = np.empty((2, len(moments), tr_len), dtype=np.float64)
  * 
  *     for ii in range(cl_len):             # <<<<<<<<<<<<<<
- *       for _i in range(2):
- *         cm = retm[_i]
+ *       nn = self._cls_count[ii]
+ *       if min(nn) < min_cnt:
  */
+    __pyx_L7_continue:;
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
-  /* "statmoments/_native.pyx":683
+  /* "statmoments/_native.pyx":721
  *     return self._cls_count[i]
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
- *     maxm = np.max(moments)
+ *     maxm, min_cnt = np.max(moments), self.acc_min_count
  *     if self.moment * 2 < maxm:
  */
 
   /* function exit code */
   PyErr_SetNone(PyExc_StopIteration);
   goto __pyx_L0;
   __pyx_L1_error:;
@@ -24525,20 +25041,20 @@
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static PyObject *__pyx_gb_11statmoments_7_native_10bivar_cntr_15generator4(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "statmoments/_native.pyx":711
+/* "statmoments/_native.pyx":754
  *       yield retm
  * 
  *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
- * #    self._retm[:] = 0  # TODO: Check if needed
  *     retm = self._retm
+ *     tr_len, min_cnt = self.trace_len, self.acc_min_count
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_11statmoments_7_native_10bivar_cntr_14_comoments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_11statmoments_7_native_10bivar_cntr_14_comoments = {"_comoments", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_10bivar_cntr_14_comoments, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_11statmoments_7_native_10bivar_cntr_14_comoments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
@@ -24571,40 +25087,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moments)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, 1); __PYX_ERR(0, 711, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, 1); __PYX_ERR(0, 754, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_normalize)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, 2); __PYX_ERR(0, 711, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, 2); __PYX_ERR(0, 754, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_comoments") < 0)) __PYX_ERR(0, 711, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_comoments") < 0)) __PYX_ERR(0, 754, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_moments = values[1];
     __pyx_v_normalize = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 711, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 754, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native.bivar_cntr._comoments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_10bivar_cntr_13_comoments(__pyx_self, __pyx_v_self, __pyx_v_moments, __pyx_v_normalize);
 
@@ -24621,29 +25137,29 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_comoments", 0);
   __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_9__comoments *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_9__comoments(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_9__comoments, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_9__comoments *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 711, __pyx_L1_error)
+    __PYX_ERR(0, 754, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
   __pyx_cur_scope->__pyx_v_moments = __pyx_v_moments;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_moments);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_moments);
   __pyx_cur_scope->__pyx_v_normalize = __pyx_v_normalize;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_normalize);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_normalize);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_10bivar_cntr_15generator4, __pyx_codeobj__31, (PyObject *) __pyx_cur_scope, __pyx_n_s_comoments, __pyx_n_s_bivar_cntr__comoments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 711, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_10bivar_cntr_15generator4, __pyx_codeobj__32, (PyObject *) __pyx_cur_scope, __pyx_n_s_comoments, __pyx_n_s_bivar_cntr__comoments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 754, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -24683,396 +25199,396 @@
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L16_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 711, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 754, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":713
+  /* "statmoments/_native.pyx":755
+ * 
  *   def _comoments(self, moments, normalize):
- * #    self._retm[:] = 0  # TODO: Check if needed
  *     retm = self._retm             # <<<<<<<<<<<<<<
  *     tr_len, min_cnt = self.trace_len, self.acc_min_count
  *     triuflatten = _triuflatten_gen(tr_len)
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 713, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 755, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v_retm = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":714
- * #    self._retm[:] = 0  # TODO: Check if needed
+  /* "statmoments/_native.pyx":756
+ *   def _comoments(self, moments, normalize):
  *     retm = self._retm
  *     tr_len, min_cnt = self.trace_len, self.acc_min_count             # <<<<<<<<<<<<<<
  *     triuflatten = _triuflatten_gen(tr_len)
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 756, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_acc_min_count); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_acc_min_count); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 756, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v_tr_len = __pyx_t_1;
   __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_cur_scope->__pyx_v_min_cnt = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":715
+  /* "statmoments/_native.pyx":757
  *     retm = self._retm
  *     tr_len, min_cnt = self.trace_len, self.acc_min_count
  *     triuflatten = _triuflatten_gen(tr_len)             # <<<<<<<<<<<<<<
  * 
  *     for accs2d, accs_count in zip(self._accs2d, self._cls_count):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_triuflatten_gen); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 715, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_triuflatten_gen); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 757, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_1, function);
     }
   }
   __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_3, __pyx_cur_scope->__pyx_v_tr_len) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_cur_scope->__pyx_v_tr_len);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 715, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 757, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_cur_scope->__pyx_v_triuflatten = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":717
+  /* "statmoments/_native.pyx":759
  *     triuflatten = _triuflatten_gen(tr_len)
  * 
  *     for accs2d, accs_count in zip(self._accs2d, self._cls_count):             # <<<<<<<<<<<<<<
  *       n0, n1 = accs_count
  *       for jj, (lm, rm) in enumerate(zip(*moments)):
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs2d); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 717, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs2d); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 759, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_cls_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 717, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_cls_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 759, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 717, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 759, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_1);
   __pyx_t_2 = 0;
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_zip, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 717, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_zip, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 759, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
     __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
     __pyx_t_5 = NULL;
   } else {
-    __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 717, __pyx_L1_error)
+    __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 759, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 717, __pyx_L1_error)
+    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 759, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_5)) {
       if (likely(PyList_CheckExact(__pyx_t_3))) {
         if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 717, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 759, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 717, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 759, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 717, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 759, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 717, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 759, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
       __pyx_t_1 = __pyx_t_5(__pyx_t_3);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 717, __pyx_L1_error)
+          else __PYX_ERR(0, 759, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
       PyObject* sequence = __pyx_t_1;
       Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
       if (unlikely(size != 2)) {
         if (size > 2) __Pyx_RaiseTooManyValuesError(2);
         else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-        __PYX_ERR(0, 717, __pyx_L1_error)
+        __PYX_ERR(0, 759, __pyx_L1_error)
       }
       #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
       if (likely(PyTuple_CheckExact(sequence))) {
         __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
         __pyx_t_6 = PyTuple_GET_ITEM(sequence, 1); 
       } else {
         __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
         __pyx_t_6 = PyList_GET_ITEM(sequence, 1); 
       }
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_6);
       #else
-      __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 717, __pyx_L1_error)
+      __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 759, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_6 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 717, __pyx_L1_error)
+      __pyx_t_6 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 759, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     } else {
       Py_ssize_t index = -1;
-      __pyx_t_7 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 717, __pyx_L1_error)
+      __pyx_t_7 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 759, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_8 = Py_TYPE(__pyx_t_7)->tp_iternext;
       index = 0; __pyx_t_2 = __pyx_t_8(__pyx_t_7); if (unlikely(!__pyx_t_2)) goto __pyx_L6_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_2);
       index = 1; __pyx_t_6 = __pyx_t_8(__pyx_t_7); if (unlikely(!__pyx_t_6)) goto __pyx_L6_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_6);
-      if (__Pyx_IternextUnpackEndCheck(__pyx_t_8(__pyx_t_7), 2) < 0) __PYX_ERR(0, 717, __pyx_L1_error)
+      if (__Pyx_IternextUnpackEndCheck(__pyx_t_8(__pyx_t_7), 2) < 0) __PYX_ERR(0, 759, __pyx_L1_error)
       __pyx_t_8 = NULL;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       goto __pyx_L7_unpacking_done;
       __pyx_L6_unpacking_failed:;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __pyx_t_8 = NULL;
       if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-      __PYX_ERR(0, 717, __pyx_L1_error)
+      __PYX_ERR(0, 759, __pyx_L1_error)
       __pyx_L7_unpacking_done:;
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_accs2d);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_accs2d, __pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_2);
     __pyx_t_2 = 0;
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_accs_count);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_accs_count, __pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":718
+    /* "statmoments/_native.pyx":760
  * 
  *     for accs2d, accs_count in zip(self._accs2d, self._cls_count):
  *       n0, n1 = accs_count             # <<<<<<<<<<<<<<
  *       for jj, (lm, rm) in enumerate(zip(*moments)):
  *         if n0 >= min_cnt:
  */
     if ((likely(PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_accs_count))) || (PyList_CheckExact(__pyx_cur_scope->__pyx_v_accs_count))) {
       PyObject* sequence = __pyx_cur_scope->__pyx_v_accs_count;
       Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
       if (unlikely(size != 2)) {
         if (size > 2) __Pyx_RaiseTooManyValuesError(2);
         else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-        __PYX_ERR(0, 718, __pyx_L1_error)
+        __PYX_ERR(0, 760, __pyx_L1_error)
       }
       #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
       if (likely(PyTuple_CheckExact(sequence))) {
         __pyx_t_1 = PyTuple_GET_ITEM(sequence, 0); 
         __pyx_t_6 = PyTuple_GET_ITEM(sequence, 1); 
       } else {
         __pyx_t_1 = PyList_GET_ITEM(sequence, 0); 
         __pyx_t_6 = PyList_GET_ITEM(sequence, 1); 
       }
       __Pyx_INCREF(__pyx_t_1);
       __Pyx_INCREF(__pyx_t_6);
       #else
-      __pyx_t_1 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 718, __pyx_L1_error)
+      __pyx_t_1 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 760, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 718, __pyx_L1_error)
+      __pyx_t_6 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 760, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       #endif
     } else {
       Py_ssize_t index = -1;
-      __pyx_t_2 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_accs_count); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 718, __pyx_L1_error)
+      __pyx_t_2 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_accs_count); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 760, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __pyx_t_8 = Py_TYPE(__pyx_t_2)->tp_iternext;
       index = 0; __pyx_t_1 = __pyx_t_8(__pyx_t_2); if (unlikely(!__pyx_t_1)) goto __pyx_L8_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_1);
       index = 1; __pyx_t_6 = __pyx_t_8(__pyx_t_2); if (unlikely(!__pyx_t_6)) goto __pyx_L8_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_6);
-      if (__Pyx_IternextUnpackEndCheck(__pyx_t_8(__pyx_t_2), 2) < 0) __PYX_ERR(0, 718, __pyx_L1_error)
+      if (__Pyx_IternextUnpackEndCheck(__pyx_t_8(__pyx_t_2), 2) < 0) __PYX_ERR(0, 760, __pyx_L1_error)
       __pyx_t_8 = NULL;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       goto __pyx_L9_unpacking_done;
       __pyx_L8_unpacking_failed:;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_t_8 = NULL;
       if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-      __PYX_ERR(0, 718, __pyx_L1_error)
+      __PYX_ERR(0, 760, __pyx_L1_error)
       __pyx_L9_unpacking_done:;
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_n0);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_n0, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_1);
     __pyx_t_1 = 0;
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_n1);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_n1, __pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":719
+    /* "statmoments/_native.pyx":761
  *     for accs2d, accs_count in zip(self._accs2d, self._cls_count):
  *       n0, n1 = accs_count
  *       for jj, (lm, rm) in enumerate(zip(*moments)):             # <<<<<<<<<<<<<<
  *         if n0 >= min_cnt:
- *           C = _calc_comoments(1.0/n0 * accs2d[0], lm, rm, normalize)
+ *           C = _calc_comoments(1.0 / n0 * accs2d[0], lm, rm, normalize)
  */
     __Pyx_INCREF(__pyx_int_0);
     __pyx_t_6 = __pyx_int_0;
-    __pyx_t_1 = __Pyx_PySequence_Tuple(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 719, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PySequence_Tuple(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 761, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_zip, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 719, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_zip, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 761, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
       __pyx_t_1 = __pyx_t_2; __Pyx_INCREF(__pyx_t_1); __pyx_t_9 = 0;
       __pyx_t_10 = NULL;
     } else {
-      __pyx_t_9 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 719, __pyx_L1_error)
+      __pyx_t_9 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 761, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_10 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 719, __pyx_L1_error)
+      __pyx_t_10 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 761, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     for (;;) {
       if (likely(!__pyx_t_10)) {
         if (likely(PyList_CheckExact(__pyx_t_1))) {
           if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_9); __Pyx_INCREF(__pyx_t_2); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 719, __pyx_L1_error)
+          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_9); __Pyx_INCREF(__pyx_t_2); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 761, __pyx_L1_error)
           #else
-          __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 719, __pyx_L1_error)
+          __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 761, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           #endif
         } else {
           if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_9); __Pyx_INCREF(__pyx_t_2); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 719, __pyx_L1_error)
+          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_9); __Pyx_INCREF(__pyx_t_2); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 761, __pyx_L1_error)
           #else
-          __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 719, __pyx_L1_error)
+          __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 761, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           #endif
         }
       } else {
         __pyx_t_2 = __pyx_t_10(__pyx_t_1);
         if (unlikely(!__pyx_t_2)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 719, __pyx_L1_error)
+            else __PYX_ERR(0, 761, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_2);
       }
       if ((likely(PyTuple_CheckExact(__pyx_t_2))) || (PyList_CheckExact(__pyx_t_2))) {
         PyObject* sequence = __pyx_t_2;
         Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
         if (unlikely(size != 2)) {
           if (size > 2) __Pyx_RaiseTooManyValuesError(2);
           else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-          __PYX_ERR(0, 719, __pyx_L1_error)
+          __PYX_ERR(0, 761, __pyx_L1_error)
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
         if (likely(PyTuple_CheckExact(sequence))) {
           __pyx_t_7 = PyTuple_GET_ITEM(sequence, 0); 
           __pyx_t_11 = PyTuple_GET_ITEM(sequence, 1); 
         } else {
           __pyx_t_7 = PyList_GET_ITEM(sequence, 0); 
           __pyx_t_11 = PyList_GET_ITEM(sequence, 1); 
         }
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_11);
         #else
-        __pyx_t_7 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 719, __pyx_L1_error)
+        __pyx_t_7 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 761, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_11 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 719, __pyx_L1_error)
+        __pyx_t_11 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 761, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
         #endif
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       } else {
         Py_ssize_t index = -1;
-        __pyx_t_12 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 719, __pyx_L1_error)
+        __pyx_t_12 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 761, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_12);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __pyx_t_8 = Py_TYPE(__pyx_t_12)->tp_iternext;
         index = 0; __pyx_t_7 = __pyx_t_8(__pyx_t_12); if (unlikely(!__pyx_t_7)) goto __pyx_L12_unpacking_failed;
         __Pyx_GOTREF(__pyx_t_7);
         index = 1; __pyx_t_11 = __pyx_t_8(__pyx_t_12); if (unlikely(!__pyx_t_11)) goto __pyx_L12_unpacking_failed;
         __Pyx_GOTREF(__pyx_t_11);
-        if (__Pyx_IternextUnpackEndCheck(__pyx_t_8(__pyx_t_12), 2) < 0) __PYX_ERR(0, 719, __pyx_L1_error)
+        if (__Pyx_IternextUnpackEndCheck(__pyx_t_8(__pyx_t_12), 2) < 0) __PYX_ERR(0, 761, __pyx_L1_error)
         __pyx_t_8 = NULL;
         __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         goto __pyx_L13_unpacking_done;
         __pyx_L12_unpacking_failed:;
         __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         __pyx_t_8 = NULL;
         if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-        __PYX_ERR(0, 719, __pyx_L1_error)
+        __PYX_ERR(0, 761, __pyx_L1_error)
         __pyx_L13_unpacking_done:;
       }
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_lm);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_lm, __pyx_t_7);
       __Pyx_GIVEREF(__pyx_t_7);
       __pyx_t_7 = 0;
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_rm);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_rm, __pyx_t_11);
       __Pyx_GIVEREF(__pyx_t_11);
       __pyx_t_11 = 0;
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_jj);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_jj, __pyx_t_6);
       __Pyx_GIVEREF(__pyx_t_6);
-      __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 719, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 761, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_6);
       __pyx_t_6 = __pyx_t_2;
       __pyx_t_2 = 0;
 
-      /* "statmoments/_native.pyx":720
+      /* "statmoments/_native.pyx":762
  *       n0, n1 = accs_count
  *       for jj, (lm, rm) in enumerate(zip(*moments)):
  *         if n0 >= min_cnt:             # <<<<<<<<<<<<<<
- *           C = _calc_comoments(1.0/n0 * accs2d[0], lm, rm, normalize)
+ *           C = _calc_comoments(1.0 / n0 * accs2d[0], lm, rm, normalize)
  *           retm[0, jj] = triuflatten(C)
  */
-      __pyx_t_2 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_n0, __pyx_cur_scope->__pyx_v_min_cnt, Py_GE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 720, __pyx_L1_error)
-      __pyx_t_13 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 720, __pyx_L1_error)
+      __pyx_t_2 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_n0, __pyx_cur_scope->__pyx_v_min_cnt, Py_GE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 762, __pyx_L1_error)
+      __pyx_t_13 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 762, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       if (__pyx_t_13) {
 
-        /* "statmoments/_native.pyx":721
+        /* "statmoments/_native.pyx":763
  *       for jj, (lm, rm) in enumerate(zip(*moments)):
  *         if n0 >= min_cnt:
- *           C = _calc_comoments(1.0/n0 * accs2d[0], lm, rm, normalize)             # <<<<<<<<<<<<<<
+ *           C = _calc_comoments(1.0 / n0 * accs2d[0], lm, rm, normalize)             # <<<<<<<<<<<<<<
  *           retm[0, jj] = triuflatten(C)
- *         if n1 >= min_cnt:
+ *         else:
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_calc_comoments); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 721, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_calc_comoments); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 763, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_7 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_cur_scope->__pyx_v_n0, 1.0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 721, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_cur_scope->__pyx_v_n0, 1.0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 763, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_12 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_accs2d, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 721, __pyx_L1_error)
+        __pyx_t_12 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_accs2d, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 763, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_12);
-        __pyx_t_14 = PyNumber_Multiply(__pyx_t_7, __pyx_t_12); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 721, __pyx_L1_error)
+        __pyx_t_14 = PyNumber_Multiply(__pyx_t_7, __pyx_t_12); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 763, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_14);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         __pyx_t_12 = NULL;
         __pyx_t_15 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
           __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_11);
@@ -25083,31 +25599,31 @@
             __Pyx_DECREF_SET(__pyx_t_11, function);
             __pyx_t_15 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_11)) {
           PyObject *__pyx_temp[5] = {__pyx_t_12, __pyx_t_14, __pyx_cur_scope->__pyx_v_lm, __pyx_cur_scope->__pyx_v_rm, __pyx_cur_scope->__pyx_v_normalize};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_15, 4+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 721, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_15, 4+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 763, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_11)) {
           PyObject *__pyx_temp[5] = {__pyx_t_12, __pyx_t_14, __pyx_cur_scope->__pyx_v_lm, __pyx_cur_scope->__pyx_v_rm, __pyx_cur_scope->__pyx_v_normalize};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_15, 4+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 721, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_15, 4+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 763, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
         } else
         #endif
         {
-          __pyx_t_7 = PyTuple_New(4+__pyx_t_15); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 721, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_New(4+__pyx_t_15); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 763, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           if (__pyx_t_12) {
             __Pyx_GIVEREF(__pyx_t_12); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_12); __pyx_t_12 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_14);
           PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_15, __pyx_t_14);
           __Pyx_INCREF(__pyx_cur_scope->__pyx_v_lm);
@@ -25116,94 +25632,116 @@
           __Pyx_INCREF(__pyx_cur_scope->__pyx_v_rm);
           __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_rm);
           PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_15, __pyx_cur_scope->__pyx_v_rm);
           __Pyx_INCREF(__pyx_cur_scope->__pyx_v_normalize);
           __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_normalize);
           PyTuple_SET_ITEM(__pyx_t_7, 3+__pyx_t_15, __pyx_cur_scope->__pyx_v_normalize);
           __pyx_t_14 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 721, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 763, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         }
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_C);
         __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_C, __pyx_t_2);
         __Pyx_GIVEREF(__pyx_t_2);
         __pyx_t_2 = 0;
 
-        /* "statmoments/_native.pyx":722
+        /* "statmoments/_native.pyx":764
  *         if n0 >= min_cnt:
- *           C = _calc_comoments(1.0/n0 * accs2d[0], lm, rm, normalize)
+ *           C = _calc_comoments(1.0 / n0 * accs2d[0], lm, rm, normalize)
  *           retm[0, jj] = triuflatten(C)             # <<<<<<<<<<<<<<
- *         if n1 >= min_cnt:
- *           C = _calc_comoments(1.0/n1 * accs2d[1], lm, rm, normalize)
+ *         else:
+ *           retm[0, jj] = 0
  */
         __Pyx_INCREF(__pyx_cur_scope->__pyx_v_triuflatten);
         __pyx_t_11 = __pyx_cur_scope->__pyx_v_triuflatten; __pyx_t_7 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
           __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_11);
           if (likely(__pyx_t_7)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
             __Pyx_INCREF(__pyx_t_7);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_11, function);
           }
         }
         __pyx_t_2 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_7, __pyx_cur_scope->__pyx_v_C) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_cur_scope->__pyx_v_C);
         __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 722, __pyx_L1_error)
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 764, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __pyx_t_11 = PyTuple_New(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 722, __pyx_L1_error)
+        __pyx_t_11 = PyTuple_New(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 764, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
         __Pyx_INCREF(__pyx_int_0);
         __Pyx_GIVEREF(__pyx_int_0);
         PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_int_0);
         __Pyx_INCREF(__pyx_cur_scope->__pyx_v_jj);
         __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_jj);
         PyTuple_SET_ITEM(__pyx_t_11, 1, __pyx_cur_scope->__pyx_v_jj);
-        if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_11, __pyx_t_2) < 0)) __PYX_ERR(0, 722, __pyx_L1_error)
+        if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_11, __pyx_t_2) < 0)) __PYX_ERR(0, 764, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-        /* "statmoments/_native.pyx":720
+        /* "statmoments/_native.pyx":762
  *       n0, n1 = accs_count
  *       for jj, (lm, rm) in enumerate(zip(*moments)):
  *         if n0 >= min_cnt:             # <<<<<<<<<<<<<<
- *           C = _calc_comoments(1.0/n0 * accs2d[0], lm, rm, normalize)
+ *           C = _calc_comoments(1.0 / n0 * accs2d[0], lm, rm, normalize)
  *           retm[0, jj] = triuflatten(C)
  */
+        goto __pyx_L14;
       }
 
-      /* "statmoments/_native.pyx":723
- *           C = _calc_comoments(1.0/n0 * accs2d[0], lm, rm, normalize)
+      /* "statmoments/_native.pyx":766
  *           retm[0, jj] = triuflatten(C)
+ *         else:
+ *           retm[0, jj] = 0             # <<<<<<<<<<<<<<
+ *         if n1 >= min_cnt:
+ *           C = _calc_comoments(1.0 / n1 * accs2d[1], lm, rm, normalize)
+ */
+      /*else*/ {
+        __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 766, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_INCREF(__pyx_int_0);
+        __Pyx_GIVEREF(__pyx_int_0);
+        PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_0);
+        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_jj);
+        __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_jj);
+        PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_cur_scope->__pyx_v_jj);
+        if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_2, __pyx_int_0) < 0)) __PYX_ERR(0, 766, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      }
+      __pyx_L14:;
+
+      /* "statmoments/_native.pyx":767
+ *         else:
+ *           retm[0, jj] = 0
  *         if n1 >= min_cnt:             # <<<<<<<<<<<<<<
- *           C = _calc_comoments(1.0/n1 * accs2d[1], lm, rm, normalize)
+ *           C = _calc_comoments(1.0 / n1 * accs2d[1], lm, rm, normalize)
  *           retm[1, jj] = triuflatten(C)
  */
-      __pyx_t_2 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_n1, __pyx_cur_scope->__pyx_v_min_cnt, Py_GE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 723, __pyx_L1_error)
-      __pyx_t_13 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 723, __pyx_L1_error)
+      __pyx_t_2 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_n1, __pyx_cur_scope->__pyx_v_min_cnt, Py_GE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 767, __pyx_L1_error)
+      __pyx_t_13 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 767, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       if (__pyx_t_13) {
 
-        /* "statmoments/_native.pyx":724
- *           retm[0, jj] = triuflatten(C)
+        /* "statmoments/_native.pyx":768
+ *           retm[0, jj] = 0
  *         if n1 >= min_cnt:
- *           C = _calc_comoments(1.0/n1 * accs2d[1], lm, rm, normalize)             # <<<<<<<<<<<<<<
+ *           C = _calc_comoments(1.0 / n1 * accs2d[1], lm, rm, normalize)             # <<<<<<<<<<<<<<
  *           retm[1, jj] = triuflatten(C)
- *       yield self._retm[:, :len(moments[0])]
+ *         else:
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_calc_comoments); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 724, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_calc_comoments); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 768, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_7 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_cur_scope->__pyx_v_n1, 1.0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 724, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_cur_scope->__pyx_v_n1, 1.0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 768, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_14 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_accs2d, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 724, __pyx_L1_error)
+        __pyx_t_14 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_accs2d, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 768, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_14);
-        __pyx_t_12 = PyNumber_Multiply(__pyx_t_7, __pyx_t_14); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 724, __pyx_L1_error)
+        __pyx_t_12 = PyNumber_Multiply(__pyx_t_7, __pyx_t_14); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 768, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_12);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
         __pyx_t_14 = NULL;
         __pyx_t_15 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
           __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_11);
@@ -25214,31 +25752,31 @@
             __Pyx_DECREF_SET(__pyx_t_11, function);
             __pyx_t_15 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_11)) {
           PyObject *__pyx_temp[5] = {__pyx_t_14, __pyx_t_12, __pyx_cur_scope->__pyx_v_lm, __pyx_cur_scope->__pyx_v_rm, __pyx_cur_scope->__pyx_v_normalize};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_15, 4+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 724, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_15, 4+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 768, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_11)) {
           PyObject *__pyx_temp[5] = {__pyx_t_14, __pyx_t_12, __pyx_cur_scope->__pyx_v_lm, __pyx_cur_scope->__pyx_v_rm, __pyx_cur_scope->__pyx_v_normalize};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_15, 4+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 724, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_15, 4+__pyx_t_15); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 768, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         } else
         #endif
         {
-          __pyx_t_7 = PyTuple_New(4+__pyx_t_15); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 724, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_New(4+__pyx_t_15); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 768, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           if (__pyx_t_14) {
             __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_14); __pyx_t_14 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_12);
           PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_15, __pyx_t_12);
           __Pyx_INCREF(__pyx_cur_scope->__pyx_v_lm);
@@ -25247,106 +25785,128 @@
           __Pyx_INCREF(__pyx_cur_scope->__pyx_v_rm);
           __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_rm);
           PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_15, __pyx_cur_scope->__pyx_v_rm);
           __Pyx_INCREF(__pyx_cur_scope->__pyx_v_normalize);
           __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_normalize);
           PyTuple_SET_ITEM(__pyx_t_7, 3+__pyx_t_15, __pyx_cur_scope->__pyx_v_normalize);
           __pyx_t_12 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 724, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 768, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         }
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_C);
         __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_C, __pyx_t_2);
         __Pyx_GIVEREF(__pyx_t_2);
         __pyx_t_2 = 0;
 
-        /* "statmoments/_native.pyx":725
+        /* "statmoments/_native.pyx":769
  *         if n1 >= min_cnt:
- *           C = _calc_comoments(1.0/n1 * accs2d[1], lm, rm, normalize)
+ *           C = _calc_comoments(1.0 / n1 * accs2d[1], lm, rm, normalize)
  *           retm[1, jj] = triuflatten(C)             # <<<<<<<<<<<<<<
- *       yield self._retm[:, :len(moments[0])]
- * 
+ *         else:
+ *           retm[1, jj] = 0
  */
         __Pyx_INCREF(__pyx_cur_scope->__pyx_v_triuflatten);
         __pyx_t_11 = __pyx_cur_scope->__pyx_v_triuflatten; __pyx_t_7 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
           __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_11);
           if (likely(__pyx_t_7)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
             __Pyx_INCREF(__pyx_t_7);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_11, function);
           }
         }
         __pyx_t_2 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_7, __pyx_cur_scope->__pyx_v_C) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_cur_scope->__pyx_v_C);
         __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 725, __pyx_L1_error)
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 769, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __pyx_t_11 = PyTuple_New(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 725, __pyx_L1_error)
+        __pyx_t_11 = PyTuple_New(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 769, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
         __Pyx_INCREF(__pyx_int_1);
         __Pyx_GIVEREF(__pyx_int_1);
         PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_int_1);
         __Pyx_INCREF(__pyx_cur_scope->__pyx_v_jj);
         __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_jj);
         PyTuple_SET_ITEM(__pyx_t_11, 1, __pyx_cur_scope->__pyx_v_jj);
-        if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_11, __pyx_t_2) < 0)) __PYX_ERR(0, 725, __pyx_L1_error)
+        if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_11, __pyx_t_2) < 0)) __PYX_ERR(0, 769, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-        /* "statmoments/_native.pyx":723
- *           C = _calc_comoments(1.0/n0 * accs2d[0], lm, rm, normalize)
- *           retm[0, jj] = triuflatten(C)
+        /* "statmoments/_native.pyx":767
+ *         else:
+ *           retm[0, jj] = 0
  *         if n1 >= min_cnt:             # <<<<<<<<<<<<<<
- *           C = _calc_comoments(1.0/n1 * accs2d[1], lm, rm, normalize)
+ *           C = _calc_comoments(1.0 / n1 * accs2d[1], lm, rm, normalize)
  *           retm[1, jj] = triuflatten(C)
  */
+        goto __pyx_L15;
+      }
+
+      /* "statmoments/_native.pyx":771
+ *           retm[1, jj] = triuflatten(C)
+ *         else:
+ *           retm[1, jj] = 0             # <<<<<<<<<<<<<<
+ *       yield self._retm[:, :len(moments[0])]
+ * 
+ */
+      /*else*/ {
+        __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 771, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_INCREF(__pyx_int_1);
+        __Pyx_GIVEREF(__pyx_int_1);
+        PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_1);
+        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_jj);
+        __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_jj);
+        PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_cur_scope->__pyx_v_jj);
+        if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_2, __pyx_int_0) < 0)) __PYX_ERR(0, 771, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       }
+      __pyx_L15:;
 
-      /* "statmoments/_native.pyx":719
+      /* "statmoments/_native.pyx":761
  *     for accs2d, accs_count in zip(self._accs2d, self._cls_count):
  *       n0, n1 = accs_count
  *       for jj, (lm, rm) in enumerate(zip(*moments)):             # <<<<<<<<<<<<<<
  *         if n0 >= min_cnt:
- *           C = _calc_comoments(1.0/n0 * accs2d[0], lm, rm, normalize)
+ *           C = _calc_comoments(1.0 / n0 * accs2d[0], lm, rm, normalize)
  */
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":726
- *           C = _calc_comoments(1.0/n1 * accs2d[1], lm, rm, normalize)
- *           retm[1, jj] = triuflatten(C)
+    /* "statmoments/_native.pyx":772
+ *         else:
+ *           retm[1, jj] = 0
  *       yield self._retm[:, :len(moments[0])]             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 726, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 772, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_moments, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 726, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_moments, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 772, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_9 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 726, __pyx_L1_error)
+    __pyx_t_9 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 772, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 726, __pyx_L1_error)
+    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 772, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = PySlice_New(Py_None, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 726, __pyx_L1_error)
+    __pyx_t_2 = PySlice_New(Py_None, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 772, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 726, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 772, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_INCREF(__pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_slice__5);
-    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_slice__5);
+    __Pyx_INCREF(__pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_slice__7);
+    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_slice__7);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_2);
     __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 726, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 772, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
     __Pyx_XGIVEREF(__pyx_t_3);
     __pyx_cur_scope->__pyx_t_0 = __pyx_t_3;
@@ -25360,33 +25920,33 @@
     return __pyx_r;
     __pyx_L16_resume_from_yield:;
     __pyx_t_3 = __pyx_cur_scope->__pyx_t_0;
     __pyx_cur_scope->__pyx_t_0 = 0;
     __Pyx_XGOTREF(__pyx_t_3);
     __pyx_t_4 = __pyx_cur_scope->__pyx_t_1;
     __pyx_t_5 = __pyx_cur_scope->__pyx_t_2;
-    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 726, __pyx_L1_error)
+    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 772, __pyx_L1_error)
 
-    /* "statmoments/_native.pyx":717
+    /* "statmoments/_native.pyx":759
  *     triuflatten = _triuflatten_gen(tr_len)
  * 
  *     for accs2d, accs_count in zip(self._accs2d, self._cls_count):             # <<<<<<<<<<<<<<
  *       n0, n1 = accs_count
  *       for jj, (lm, rm) in enumerate(zip(*moments)):
  */
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
-  /* "statmoments/_native.pyx":711
+  /* "statmoments/_native.pyx":754
  *       yield retm
  * 
  *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
- * #    self._retm[:] = 0  # TODO: Check if needed
  *     retm = self._retm
+ *     tr_len, min_cnt = self.trace_len, self.acc_min_count
  */
 
   /* function exit code */
   PyErr_SetNone(PyExc_StopIteration);
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
@@ -25405,86 +25965,86 @@
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":730
+/* "statmoments/_native.pyx":776
  * 
  * ########################## BIVAR 2pass and text book ##########################
  * def _std_normalize(arr):             # <<<<<<<<<<<<<<
- *     return arr / np.std(arr, axis=0)
+ *   return arr / np.std(arr, axis=0)
  * 
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11statmoments_7_native_13_std_normalize(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
-static PyMethodDef __pyx_mdef_11statmoments_7_native_13_std_normalize = {"_std_normalize", (PyCFunction)__pyx_pw_11statmoments_7_native_13_std_normalize, METH_O, 0};
-static PyObject *__pyx_pw_11statmoments_7_native_13_std_normalize(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
+static PyObject *__pyx_pw_11statmoments_7_native_15_std_normalize(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
+static PyMethodDef __pyx_mdef_11statmoments_7_native_15_std_normalize = {"_std_normalize", (PyCFunction)__pyx_pw_11statmoments_7_native_15_std_normalize, METH_O, 0};
+static PyObject *__pyx_pw_11statmoments_7_native_15_std_normalize(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("_std_normalize (wrapper)", 0);
-  __pyx_r = __pyx_pf_11statmoments_7_native_12_std_normalize(__pyx_self, ((PyObject *)__pyx_v_arr));
+  __pyx_r = __pyx_pf_11statmoments_7_native_14_std_normalize(__pyx_self, ((PyObject *)__pyx_v_arr));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11statmoments_7_native_12_std_normalize(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_arr) {
+static PyObject *__pyx_pf_11statmoments_7_native_14_std_normalize(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_std_normalize", 0);
 
-  /* "statmoments/_native.pyx":731
+  /* "statmoments/_native.pyx":777
  * ########################## BIVAR 2pass and text book ##########################
  * def _std_normalize(arr):
- *     return arr / np.std(arr, axis=0)             # <<<<<<<<<<<<<<
+ *   return arr / np.std(arr, axis=0)             # <<<<<<<<<<<<<<
  * 
  * def _sort_meanfree(ret, normalize=False):
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 731, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_std); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 731, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_std); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 731, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_arr);
   __Pyx_GIVEREF(__pyx_v_arr);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_arr);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 731, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 731, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 731, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 777, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_v_arr, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 731, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_v_arr, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":730
+  /* "statmoments/_native.pyx":776
  * 
  * ########################## BIVAR 2pass and text book ##########################
  * def _std_normalize(arr):             # <<<<<<<<<<<<<<
- *     return arr / np.std(arr, axis=0)
+ *   return arr / np.std(arr, axis=0)
  * 
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
@@ -25494,26 +26054,26 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":733
- *     return arr / np.std(arr, axis=0)
+/* "statmoments/_native.pyx":779
+ *   return arr / np.std(arr, axis=0)
  * 
  * def _sort_meanfree(ret, normalize=False):             # <<<<<<<<<<<<<<
- *   ret[:] -= np.mean(ret, axis=0)
- *   if normalize:
+ *   if len(ret) < 1:
+ *     return ret
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11statmoments_7_native_15_sort_meanfree(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_11statmoments_7_native_15_sort_meanfree = {"_sort_meanfree", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_15_sort_meanfree, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11statmoments_7_native_15_sort_meanfree(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_11statmoments_7_native_17_sort_meanfree(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_11statmoments_7_native_17_sort_meanfree = {"_sort_meanfree", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_17_sort_meanfree, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11statmoments_7_native_17_sort_meanfree(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_ret = 0;
   PyObject *__pyx_v_normalize = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
@@ -25542,15 +26102,15 @@
         case  1:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_normalize);
           if (value) { values[1] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_sort_meanfree") < 0)) __PYX_ERR(0, 733, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_sort_meanfree") < 0)) __PYX_ERR(0, 779, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
@@ -25558,171 +26118,204 @@
       }
     }
     __pyx_v_ret = values[0];
     __pyx_v_normalize = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_sort_meanfree", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 733, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_sort_meanfree", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 779, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native._sort_meanfree", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11statmoments_7_native_14_sort_meanfree(__pyx_self, __pyx_v_ret, __pyx_v_normalize);
+  __pyx_r = __pyx_pf_11statmoments_7_native_16_sort_meanfree(__pyx_self, __pyx_v_ret, __pyx_v_normalize);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11statmoments_7_native_14_sort_meanfree(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ret, PyObject *__pyx_v_normalize) {
+static PyObject *__pyx_pf_11statmoments_7_native_16_sort_meanfree(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ret, PyObject *__pyx_v_normalize) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
-  PyObject *__pyx_t_1 = NULL;
-  PyObject *__pyx_t_2 = NULL;
+  Py_ssize_t __pyx_t_1;
+  int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
-  int __pyx_t_7;
+  PyObject *__pyx_t_7 = NULL;
+  PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_sort_meanfree", 0);
 
-  /* "statmoments/_native.pyx":734
+  /* "statmoments/_native.pyx":780
+ * 
+ * def _sort_meanfree(ret, normalize=False):
+ *   if len(ret) < 1:             # <<<<<<<<<<<<<<
+ *     return ret
+ *   ret[:] -= np.mean(ret, axis=0)
+ */
+  __pyx_t_1 = PyObject_Length(__pyx_v_ret); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 780, __pyx_L1_error)
+  __pyx_t_2 = ((__pyx_t_1 < 1) != 0);
+  if (__pyx_t_2) {
+
+    /* "statmoments/_native.pyx":781
+ * def _sort_meanfree(ret, normalize=False):
+ *   if len(ret) < 1:
+ *     return ret             # <<<<<<<<<<<<<<
+ *   ret[:] -= np.mean(ret, axis=0)
+ *   if normalize:
+ */
+    __Pyx_XDECREF(__pyx_r);
+    __Pyx_INCREF(__pyx_v_ret);
+    __pyx_r = __pyx_v_ret;
+    goto __pyx_L0;
+
+    /* "statmoments/_native.pyx":780
  * 
  * def _sort_meanfree(ret, normalize=False):
+ *   if len(ret) < 1:             # <<<<<<<<<<<<<<
+ *     return ret
+ *   ret[:] -= np.mean(ret, axis=0)
+ */
+  }
+
+  /* "statmoments/_native.pyx":782
+ *   if len(ret) < 1:
+ *     return ret
  *   ret[:] -= np.mean(ret, axis=0)             # <<<<<<<<<<<<<<
  *   if normalize:
  *     ret[:] = (ret / np.std(ret, axis=0))
  */
-  __Pyx_INCREF(__pyx_slice__5);
-  __pyx_t_1 = __pyx_slice__5;
-  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_ret, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 734, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 734, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_mean); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 734, __pyx_L1_error)
+  __Pyx_INCREF(__pyx_slice__7);
+  __pyx_t_3 = __pyx_slice__7;
+  __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_ret, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 782, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 734, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_INCREF(__pyx_v_ret);
-  __Pyx_GIVEREF(__pyx_v_ret);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_ret);
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 734, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 782, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 734, __pyx_L1_error)
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 734, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_mean); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 782, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyNumber_InPlaceSubtract(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 734, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 782, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_INCREF(__pyx_v_ret);
+  __Pyx_GIVEREF(__pyx_v_ret);
+  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_ret);
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 782, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 782, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 782, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(PyObject_SetItem(__pyx_v_ret, __pyx_t_1, __pyx_t_5) < 0)) __PYX_ERR(0, 734, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __pyx_t_7 = PyNumber_InPlaceSubtract(__pyx_t_4, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 782, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+  if (unlikely(PyObject_SetItem(__pyx_v_ret, __pyx_t_3, __pyx_t_7) < 0)) __PYX_ERR(0, 782, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":735
- * def _sort_meanfree(ret, normalize=False):
+  /* "statmoments/_native.pyx":783
+ *     return ret
  *   ret[:] -= np.mean(ret, axis=0)
  *   if normalize:             # <<<<<<<<<<<<<<
  *     ret[:] = (ret / np.std(ret, axis=0))
  *   return ret
  */
-  __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_v_normalize); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 735, __pyx_L1_error)
-  if (__pyx_t_7) {
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_normalize); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 783, __pyx_L1_error)
+  if (__pyx_t_2) {
 
-    /* "statmoments/_native.pyx":736
+    /* "statmoments/_native.pyx":784
  *   ret[:] -= np.mean(ret, axis=0)
  *   if normalize:
  *     ret[:] = (ret / np.std(ret, axis=0))             # <<<<<<<<<<<<<<
  *   return ret
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 736, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_std); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 736, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 736, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_std); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_8);
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
     __Pyx_INCREF(__pyx_v_ret);
     __Pyx_GIVEREF(__pyx_v_ret);
-    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_ret);
-    __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 736, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 736, __pyx_L1_error)
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 736, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_ret);
+    __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 784, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_7, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_v_ret, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_v_ret, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 736, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (__Pyx_PyObject_SetSlice(__pyx_v_ret, __pyx_t_2, 0, 0, NULL, NULL, &__pyx_slice__5, 0, 0, 0) < 0) __PYX_ERR(0, 736, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if (__Pyx_PyObject_SetSlice(__pyx_v_ret, __pyx_t_4, 0, 0, NULL, NULL, &__pyx_slice__7, 0, 0, 0) < 0) __PYX_ERR(0, 784, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "statmoments/_native.pyx":735
- * def _sort_meanfree(ret, normalize=False):
+    /* "statmoments/_native.pyx":783
+ *     return ret
  *   ret[:] -= np.mean(ret, axis=0)
  *   if normalize:             # <<<<<<<<<<<<<<
  *     ret[:] = (ret / np.std(ret, axis=0))
  *   return ret
  */
   }
 
-  /* "statmoments/_native.pyx":737
+  /* "statmoments/_native.pyx":785
  *   if normalize:
  *     ret[:] = (ret / np.std(ret, axis=0))
  *   return ret             # <<<<<<<<<<<<<<
  * 
  * @cython.cfunc
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_ret);
   __pyx_r = __pyx_v_ret;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":733
- *     return arr / np.std(arr, axis=0)
+  /* "statmoments/_native.pyx":779
+ *   return arr / np.std(arr, axis=0)
  * 
  * def _sort_meanfree(ret, normalize=False):             # <<<<<<<<<<<<<<
- *   ret[:] -= np.mean(ret, axis=0)
- *   if normalize:
+ *   if len(ret) < 1:
+ *     return ret
  */
 
   /* function exit code */
   __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_8);
   __Pyx_AddTraceback("statmoments._native._sort_meanfree", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":742
+/* "statmoments/_native.pyx":790
  * @cython.returns('double[:,::1]')
- * @cython.locals(tmp = 'double[:,::1]', m1 = cython.int, m2 = cython.int)
+ * @cython.locals(tmp='double[:,::1]', m1=cython.int, m2=cython.int)
  * def _uni2bivar(traces, tmp, ret, m1, m2):             # <<<<<<<<<<<<<<
  *   # 2D traces for equal l-and r-moments
- *   cython.declare(m = cython.Py_ssize_t, n = cython.Py_ssize_t)
+ *   cython.declare(m=cython.Py_ssize_t, n=cython.Py_ssize_t)
  */
 
 static __Pyx_memviewslice __pyx_f_11statmoments_7_native__uni2bivar(PyObject *__pyx_v_traces, __Pyx_memviewslice __pyx_v_tmp, PyObject *__pyx_v_ret, int __pyx_v_m1, CYTHON_UNUSED int __pyx_v_m2) {
   Py_ssize_t __pyx_v_m;
   Py_ssize_t __pyx_v_n;
   __Pyx_memviewslice __pyx_v_C = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_triuflatten = NULL;
@@ -25741,155 +26334,155 @@
   struct __pyx_opt_args_11statmoments_7_native_dsyrk __pyx_t_10;
   int __pyx_t_11;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_uni2bivar", 0);
 
-  /* "statmoments/_native.pyx":746
- *   cython.declare(m = cython.Py_ssize_t, n = cython.Py_ssize_t)
- *   cython.declare(C = 'double[:,::1]')
+  /* "statmoments/_native.pyx":794
+ *   cython.declare(m=cython.Py_ssize_t, n=cython.Py_ssize_t)
+ *   cython.declare(C='double[:,::1]')
  *   m = cython.cast(cython.int, traces.shape[0])             # <<<<<<<<<<<<<<
  *   n = cython.cast(cython.int, traces.shape[1])
  *   triuflatten, C = _triuflatten_gen(n), tmp
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_traces, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 746, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_traces, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 794, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 746, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 794, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 746, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 794, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_m = ((int)__pyx_t_3);
 
-  /* "statmoments/_native.pyx":747
- *   cython.declare(C = 'double[:,::1]')
+  /* "statmoments/_native.pyx":795
+ *   cython.declare(C='double[:,::1]')
  *   m = cython.cast(cython.int, traces.shape[0])
  *   n = cython.cast(cython.int, traces.shape[1])             # <<<<<<<<<<<<<<
  *   triuflatten, C = _triuflatten_gen(n), tmp
  *   for j in range(m):
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_traces, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 747, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_traces, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 795, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 747, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 795, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_3 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 747, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 795, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_n = ((int)__pyx_t_3);
 
-  /* "statmoments/_native.pyx":748
+  /* "statmoments/_native.pyx":796
  *   m = cython.cast(cython.int, traces.shape[0])
  *   n = cython.cast(cython.int, traces.shape[1])
  *   triuflatten, C = _triuflatten_gen(n), tmp             # <<<<<<<<<<<<<<
  *   for j in range(m):
- *     dsyrk(traces[j, np.newaxis]**m1, C, b'L', b'N', 1.0, 0.0)                             # m1 == m2
+ *     dsyrk(traces[j, np.newaxis] ** m1, C, b'L', b'N', 1.0, 0.0)                               # m1 == m2
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_triuflatten_gen); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 748, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_triuflatten_gen); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 796, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_n); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 748, __pyx_L1_error)
+  __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_n); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 796, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 748, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 796, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_6 = __pyx_v_tmp;
   __PYX_INC_MEMVIEW(&__pyx_t_6, 1);
   __pyx_v_triuflatten = __pyx_t_1;
   __pyx_t_1 = 0;
   __pyx_v_C = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "statmoments/_native.pyx":749
+  /* "statmoments/_native.pyx":797
  *   n = cython.cast(cython.int, traces.shape[1])
  *   triuflatten, C = _triuflatten_gen(n), tmp
  *   for j in range(m):             # <<<<<<<<<<<<<<
- *     dsyrk(traces[j, np.newaxis]**m1, C, b'L', b'N', 1.0, 0.0)                             # m1 == m2
+ *     dsyrk(traces[j, np.newaxis] ** m1, C, b'L', b'N', 1.0, 0.0)                               # m1 == m2
  *     if cython.compiled:
  */
   __pyx_t_7 = __pyx_v_m;
   __pyx_t_8 = __pyx_t_7;
   for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
     __pyx_v_j = __pyx_t_9;
 
-    /* "statmoments/_native.pyx":750
+    /* "statmoments/_native.pyx":798
  *   triuflatten, C = _triuflatten_gen(n), tmp
  *   for j in range(m):
- *     dsyrk(traces[j, np.newaxis]**m1, C, b'L', b'N', 1.0, 0.0)                             # m1 == m2             # <<<<<<<<<<<<<<
+ *     dsyrk(traces[j, np.newaxis] ** m1, C, b'L', b'N', 1.0, 0.0)                               # m1 == m2             # <<<<<<<<<<<<<<
  *     if cython.compiled:
  *       ret[j, :] = triuflatten(C.base)
  */
-    __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_j); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_j); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 798, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 798, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_newaxis); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_newaxis); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 798, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 798, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_4);
     __pyx_t_1 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_traces, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_traces, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 798, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_m1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_m1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 798, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = PyNumber_Power(__pyx_t_4, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Power(__pyx_t_4, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 798, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 798, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_10.__pyx_n = 3;
     __pyx_t_10.trans = 'N';
     __pyx_t_10.alpha = 1.0;
     __pyx_t_10.beta = 0.0;
     __pyx_f_11statmoments_7_native_dsyrk(__pyx_t_6, __pyx_v_C, 'L', &__pyx_t_10); 
     __PYX_XDEC_MEMVIEW(&__pyx_t_6, 1);
     __pyx_t_6.memview = NULL;
     __pyx_t_6.data = NULL;
 
-    /* "statmoments/_native.pyx":751
+    /* "statmoments/_native.pyx":799
  *   for j in range(m):
- *     dsyrk(traces[j, np.newaxis]**m1, C, b'L', b'N', 1.0, 0.0)                             # m1 == m2
+ *     dsyrk(traces[j, np.newaxis] ** m1, C, b'L', b'N', 1.0, 0.0)                               # m1 == m2
  *     if cython.compiled:             # <<<<<<<<<<<<<<
  *       ret[j, :] = triuflatten(C.base)
  *     else:
  */
     __pyx_t_11 = (1 != 0);
     if (__pyx_t_11) {
 
-      /* "statmoments/_native.pyx":752
- *     dsyrk(traces[j, np.newaxis]**m1, C, b'L', b'N', 1.0, 0.0)                             # m1 == m2
+      /* "statmoments/_native.pyx":800
+ *     dsyrk(traces[j, np.newaxis] ** m1, C, b'L', b'N', 1.0, 0.0)                               # m1 == m2
  *     if cython.compiled:
  *       ret[j, :] = triuflatten(C.base)             # <<<<<<<<<<<<<<
  *     else:
  *       ret[j, :] = triuflatten(C)
  */
-      __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_C, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 752, __pyx_L1_error)
+      __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_C, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 800, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_base); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 752, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_base); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 800, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_INCREF(__pyx_v_triuflatten);
       __pyx_t_2 = __pyx_v_triuflatten; __pyx_t_5 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
         if (likely(__pyx_t_5)) {
@@ -25898,50 +26491,50 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_2, function);
         }
       }
       __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 752, __pyx_L1_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 800, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_j); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 752, __pyx_L1_error)
+      __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_j); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 800, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 752, __pyx_L1_error)
+      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 800, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_GIVEREF(__pyx_t_2);
       PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
-      __Pyx_INCREF(__pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_slice__5);
-      PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_slice__5);
+      __Pyx_INCREF(__pyx_slice__7);
+      __Pyx_GIVEREF(__pyx_slice__7);
+      PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_slice__7);
       __pyx_t_2 = 0;
-      if (unlikely(PyObject_SetItem(__pyx_v_ret, __pyx_t_4, __pyx_t_1) < 0)) __PYX_ERR(0, 752, __pyx_L1_error)
+      if (unlikely(PyObject_SetItem(__pyx_v_ret, __pyx_t_4, __pyx_t_1) < 0)) __PYX_ERR(0, 800, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "statmoments/_native.pyx":751
+      /* "statmoments/_native.pyx":799
  *   for j in range(m):
- *     dsyrk(traces[j, np.newaxis]**m1, C, b'L', b'N', 1.0, 0.0)                             # m1 == m2
+ *     dsyrk(traces[j, np.newaxis] ** m1, C, b'L', b'N', 1.0, 0.0)                               # m1 == m2
  *     if cython.compiled:             # <<<<<<<<<<<<<<
  *       ret[j, :] = triuflatten(C.base)
  *     else:
  */
       goto __pyx_L5;
     }
 
-    /* "statmoments/_native.pyx":754
+    /* "statmoments/_native.pyx":802
  *       ret[j, :] = triuflatten(C.base)
  *     else:
  *       ret[j, :] = triuflatten(C)             # <<<<<<<<<<<<<<
  *   return ret
  * 
  */
     /*else*/ {
-      __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_C, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 754, __pyx_L1_error)
+      __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_C, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 802, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_INCREF(__pyx_v_triuflatten);
       __pyx_t_2 = __pyx_v_triuflatten; __pyx_t_5 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
         if (likely(__pyx_t_5)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -25949,53 +26542,53 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_2, function);
         }
       }
       __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 754, __pyx_L1_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 802, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_j); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 754, __pyx_L1_error)
+      __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_j); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 802, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 754, __pyx_L1_error)
+      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 802, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_GIVEREF(__pyx_t_2);
       PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
-      __Pyx_INCREF(__pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_slice__5);
-      PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_slice__5);
+      __Pyx_INCREF(__pyx_slice__7);
+      __Pyx_GIVEREF(__pyx_slice__7);
+      PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_slice__7);
       __pyx_t_2 = 0;
-      if (unlikely(PyObject_SetItem(__pyx_v_ret, __pyx_t_4, __pyx_t_1) < 0)) __PYX_ERR(0, 754, __pyx_L1_error)
+      if (unlikely(PyObject_SetItem(__pyx_v_ret, __pyx_t_4, __pyx_t_1) < 0)) __PYX_ERR(0, 802, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
     __pyx_L5:;
   }
 
-  /* "statmoments/_native.pyx":755
+  /* "statmoments/_native.pyx":803
  *     else:
  *       ret[j, :] = triuflatten(C)
  *   return ret             # <<<<<<<<<<<<<<
  * 
  * @cython.cfunc
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_v_ret, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 755, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_v_ret, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 803, __pyx_L1_error)
   __pyx_r = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":742
+  /* "statmoments/_native.pyx":790
  * @cython.returns('double[:,::1]')
- * @cython.locals(tmp = 'double[:,::1]', m1 = cython.int, m2 = cython.int)
+ * @cython.locals(tmp='double[:,::1]', m1=cython.int, m2=cython.int)
  * def _uni2bivar(traces, tmp, ret, m1, m2):             # <<<<<<<<<<<<<<
  *   # 2D traces for equal l-and r-moments
- *   cython.declare(m = cython.Py_ssize_t, n = cython.Py_ssize_t)
+ *   cython.declare(m=cython.Py_ssize_t, n=cython.Py_ssize_t)
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4);
@@ -26012,20 +26605,20 @@
   __pyx_L2:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_C, 1);
   __Pyx_XDECREF(__pyx_v_triuflatten);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":760
+/* "statmoments/_native.pyx":808
  * @cython.returns('double[:,::1]')
- * @cython.locals(tmp = 'double[:,::1]', m1 = cython.int, m2 = cython.int)
+ * @cython.locals(tmp='double[:,::1]', m1=cython.int, m2=cython.int)
  * def _uni2bivar_neq(traces, tmp, ret, m1, m2):             # <<<<<<<<<<<<<<
  *   # 2D traces for non-equal l-and r-moments
- *   cython.declare(m = cython.Py_ssize_t, n = cython.Py_ssize_t)
+ *   cython.declare(m=cython.Py_ssize_t, n=cython.Py_ssize_t)
  */
 
 static __Pyx_memviewslice __pyx_f_11statmoments_7_native__uni2bivar_neq(PyObject *__pyx_v_traces, __Pyx_memviewslice __pyx_v_tmp, PyObject *__pyx_v_ret, int __pyx_v_m1, int __pyx_v_m2) {
   Py_ssize_t __pyx_v_m;
   Py_ssize_t __pyx_v_n;
   __Pyx_memviewslice __pyx_v_C = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_triuflatten = NULL;
@@ -26045,185 +26638,185 @@
   struct __pyx_opt_args_11statmoments_7_native_dgemm __pyx_t_11;
   int __pyx_t_12;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_uni2bivar_neq", 0);
 
-  /* "statmoments/_native.pyx":764
- *   cython.declare(m = cython.Py_ssize_t, n = cython.Py_ssize_t)
- *   cython.declare(C = 'double[:,::1]')
+  /* "statmoments/_native.pyx":812
+ *   cython.declare(m=cython.Py_ssize_t, n=cython.Py_ssize_t)
+ *   cython.declare(C='double[:,::1]')
  *   m = cython.cast(cython.int, traces.shape[0])             # <<<<<<<<<<<<<<
  *   n = cython.cast(cython.int, traces.shape[1])
  *   triuflatten, C = _triuflatten_gen(n), tmp
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_traces, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 764, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_traces, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 812, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 764, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 812, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 764, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 812, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_m = ((int)__pyx_t_3);
 
-  /* "statmoments/_native.pyx":765
- *   cython.declare(C = 'double[:,::1]')
+  /* "statmoments/_native.pyx":813
+ *   cython.declare(C='double[:,::1]')
  *   m = cython.cast(cython.int, traces.shape[0])
  *   n = cython.cast(cython.int, traces.shape[1])             # <<<<<<<<<<<<<<
  *   triuflatten, C = _triuflatten_gen(n), tmp
  *   for j in range(m):
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_traces, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 765, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_traces, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 813, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 765, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 813, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_3 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 765, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 813, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_n = ((int)__pyx_t_3);
 
-  /* "statmoments/_native.pyx":766
+  /* "statmoments/_native.pyx":814
  *   m = cython.cast(cython.int, traces.shape[0])
  *   n = cython.cast(cython.int, traces.shape[1])
  *   triuflatten, C = _triuflatten_gen(n), tmp             # <<<<<<<<<<<<<<
  *   for j in range(m):
- *     dgemm(traces[j, np.newaxis]**m2, traces[j, np.newaxis]**m1, C, b'N', b'T', 1.0, 0.0)  # m1 != m2
+ *     dgemm(traces[j, np.newaxis] ** m2, traces[j, np.newaxis] ** m1, C, b'N', b'T', 1.0, 0.0)  # m1 != m2
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_triuflatten_gen); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 766, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_triuflatten_gen); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_n); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 766, __pyx_L1_error)
+  __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_n); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 766, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_6 = __pyx_v_tmp;
   __PYX_INC_MEMVIEW(&__pyx_t_6, 1);
   __pyx_v_triuflatten = __pyx_t_1;
   __pyx_t_1 = 0;
   __pyx_v_C = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "statmoments/_native.pyx":767
+  /* "statmoments/_native.pyx":815
  *   n = cython.cast(cython.int, traces.shape[1])
  *   triuflatten, C = _triuflatten_gen(n), tmp
  *   for j in range(m):             # <<<<<<<<<<<<<<
- *     dgemm(traces[j, np.newaxis]**m2, traces[j, np.newaxis]**m1, C, b'N', b'T', 1.0, 0.0)  # m1 != m2
+ *     dgemm(traces[j, np.newaxis] ** m2, traces[j, np.newaxis] ** m1, C, b'N', b'T', 1.0, 0.0)  # m1 != m2
  *     if cython.compiled:
  */
   __pyx_t_7 = __pyx_v_m;
   __pyx_t_8 = __pyx_t_7;
   for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
     __pyx_v_j = __pyx_t_9;
 
-    /* "statmoments/_native.pyx":768
+    /* "statmoments/_native.pyx":816
  *   triuflatten, C = _triuflatten_gen(n), tmp
  *   for j in range(m):
- *     dgemm(traces[j, np.newaxis]**m2, traces[j, np.newaxis]**m1, C, b'N', b'T', 1.0, 0.0)  # m1 != m2             # <<<<<<<<<<<<<<
+ *     dgemm(traces[j, np.newaxis] ** m2, traces[j, np.newaxis] ** m1, C, b'N', b'T', 1.0, 0.0)  # m1 != m2             # <<<<<<<<<<<<<<
  *     if cython.compiled:
  *       ret[j, :] = triuflatten(C.base)
  */
-    __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_j); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 768, __pyx_L1_error)
+    __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_j); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 768, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_newaxis); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 768, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_newaxis); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 768, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_4);
     __pyx_t_1 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_traces, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 768, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_traces, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_m2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 768, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_m2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = PyNumber_Power(__pyx_t_4, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 768, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Power(__pyx_t_4, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 768, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_j); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 768, __pyx_L1_error)
+    __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_j); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 768, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_newaxis); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 768, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_newaxis); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 768, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_4);
     __pyx_t_1 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_traces, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 768, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_traces, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_m1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 768, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_m1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = PyNumber_Power(__pyx_t_4, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 768, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Power(__pyx_t_4, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 768, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 816, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_11.__pyx_n = 4;
     __pyx_t_11.transa = 'N';
     __pyx_t_11.transb = 'T';
     __pyx_t_11.alpha = 1.0;
     __pyx_t_11.beta = 0.0;
     __pyx_f_11statmoments_7_native_dgemm(__pyx_t_6, __pyx_t_10, __pyx_v_C, &__pyx_t_11); 
     __PYX_XDEC_MEMVIEW(&__pyx_t_6, 1);
     __pyx_t_6.memview = NULL;
     __pyx_t_6.data = NULL;
     __PYX_XDEC_MEMVIEW(&__pyx_t_10, 1);
     __pyx_t_10.memview = NULL;
     __pyx_t_10.data = NULL;
 
-    /* "statmoments/_native.pyx":769
+    /* "statmoments/_native.pyx":817
  *   for j in range(m):
- *     dgemm(traces[j, np.newaxis]**m2, traces[j, np.newaxis]**m1, C, b'N', b'T', 1.0, 0.0)  # m1 != m2
+ *     dgemm(traces[j, np.newaxis] ** m2, traces[j, np.newaxis] ** m1, C, b'N', b'T', 1.0, 0.0)  # m1 != m2
  *     if cython.compiled:             # <<<<<<<<<<<<<<
  *       ret[j, :] = triuflatten(C.base)
  *     else:
  */
     __pyx_t_12 = (1 != 0);
     if (__pyx_t_12) {
 
-      /* "statmoments/_native.pyx":770
- *     dgemm(traces[j, np.newaxis]**m2, traces[j, np.newaxis]**m1, C, b'N', b'T', 1.0, 0.0)  # m1 != m2
+      /* "statmoments/_native.pyx":818
+ *     dgemm(traces[j, np.newaxis] ** m2, traces[j, np.newaxis] ** m1, C, b'N', b'T', 1.0, 0.0)  # m1 != m2
  *     if cython.compiled:
  *       ret[j, :] = triuflatten(C.base)             # <<<<<<<<<<<<<<
  *     else:
  *       ret[j, :] = triuflatten(C)
  */
-      __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_C, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 770, __pyx_L1_error)
+      __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_C, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 818, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_base); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 770, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_base); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 818, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_INCREF(__pyx_v_triuflatten);
       __pyx_t_2 = __pyx_v_triuflatten; __pyx_t_5 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
         if (likely(__pyx_t_5)) {
@@ -26232,50 +26825,50 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_2, function);
         }
       }
       __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 770, __pyx_L1_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 818, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_j); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 770, __pyx_L1_error)
+      __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_j); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 818, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 770, __pyx_L1_error)
+      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 818, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_GIVEREF(__pyx_t_2);
       PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
-      __Pyx_INCREF(__pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_slice__5);
-      PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_slice__5);
+      __Pyx_INCREF(__pyx_slice__7);
+      __Pyx_GIVEREF(__pyx_slice__7);
+      PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_slice__7);
       __pyx_t_2 = 0;
-      if (unlikely(PyObject_SetItem(__pyx_v_ret, __pyx_t_4, __pyx_t_1) < 0)) __PYX_ERR(0, 770, __pyx_L1_error)
+      if (unlikely(PyObject_SetItem(__pyx_v_ret, __pyx_t_4, __pyx_t_1) < 0)) __PYX_ERR(0, 818, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "statmoments/_native.pyx":769
+      /* "statmoments/_native.pyx":817
  *   for j in range(m):
- *     dgemm(traces[j, np.newaxis]**m2, traces[j, np.newaxis]**m1, C, b'N', b'T', 1.0, 0.0)  # m1 != m2
+ *     dgemm(traces[j, np.newaxis] ** m2, traces[j, np.newaxis] ** m1, C, b'N', b'T', 1.0, 0.0)  # m1 != m2
  *     if cython.compiled:             # <<<<<<<<<<<<<<
  *       ret[j, :] = triuflatten(C.base)
  *     else:
  */
       goto __pyx_L5;
     }
 
-    /* "statmoments/_native.pyx":772
+    /* "statmoments/_native.pyx":820
  *       ret[j, :] = triuflatten(C.base)
  *     else:
  *       ret[j, :] = triuflatten(C)             # <<<<<<<<<<<<<<
  *   return ret
  *   # np.vstack and np.outer are 3x slower
  */
     /*else*/ {
-      __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_C, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 772, __pyx_L1_error)
+      __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_C, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 820, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_INCREF(__pyx_v_triuflatten);
       __pyx_t_2 = __pyx_v_triuflatten; __pyx_t_5 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
         if (likely(__pyx_t_5)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -26283,53 +26876,53 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_2, function);
         }
       }
       __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 772, __pyx_L1_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 820, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_j); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 772, __pyx_L1_error)
+      __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_j); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 820, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 772, __pyx_L1_error)
+      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 820, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_GIVEREF(__pyx_t_2);
       PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
-      __Pyx_INCREF(__pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_slice__5);
-      PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_slice__5);
+      __Pyx_INCREF(__pyx_slice__7);
+      __Pyx_GIVEREF(__pyx_slice__7);
+      PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_slice__7);
       __pyx_t_2 = 0;
-      if (unlikely(PyObject_SetItem(__pyx_v_ret, __pyx_t_4, __pyx_t_1) < 0)) __PYX_ERR(0, 772, __pyx_L1_error)
+      if (unlikely(PyObject_SetItem(__pyx_v_ret, __pyx_t_4, __pyx_t_1) < 0)) __PYX_ERR(0, 820, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
     __pyx_L5:;
   }
 
-  /* "statmoments/_native.pyx":773
+  /* "statmoments/_native.pyx":821
  *     else:
  *       ret[j, :] = triuflatten(C)
  *   return ret             # <<<<<<<<<<<<<<
  *   # np.vstack and np.outer are 3x slower
  *   # return np.vstack(list(triuflatten(np.outer(tr**m1, tr**m2)) for tr in traces)) # 3x slower
  */
-  __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_v_ret, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 773, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_v_ret, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 821, __pyx_L1_error)
   __pyx_r = __pyx_t_10;
   __pyx_t_10.memview = NULL;
   __pyx_t_10.data = NULL;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":760
+  /* "statmoments/_native.pyx":808
  * @cython.returns('double[:,::1]')
- * @cython.locals(tmp = 'double[:,::1]', m1 = cython.int, m2 = cython.int)
+ * @cython.locals(tmp='double[:,::1]', m1=cython.int, m2=cython.int)
  * def _uni2bivar_neq(traces, tmp, ret, m1, m2):             # <<<<<<<<<<<<<<
  *   # 2D traces for non-equal l-and r-moments
- *   cython.declare(m = cython.Py_ssize_t, n = cython.Py_ssize_t)
+ *   cython.declare(m=cython.Py_ssize_t, n=cython.Py_ssize_t)
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4);
@@ -26347,15 +26940,15 @@
   __pyx_L2:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_C, 1);
   __Pyx_XDECREF(__pyx_v_triuflatten);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":778
+/* "statmoments/_native.pyx":827
  * 
  * class _BivarNpassBase(_AccBase):
  *   def __init__(self, tr_len, cl_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(tr_len, cl_len, **kwargs)
  *     self.traces = np.empty((1, tr_len))[1:]
  */
 
@@ -26396,40 +26989,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 1); __PYX_ERR(0, 778, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 1); __PYX_ERR(0, 827, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_cl_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 2); __PYX_ERR(0, 778, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 2); __PYX_ERR(0, 827, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 778, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 827, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_tr_len = values[1];
     __pyx_v_cl_len = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 778, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 827, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
   __Pyx_AddTraceback("statmoments._native._BivarNpassBase.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_15_BivarNpassBase___init__(__pyx_self, __pyx_v_self, __pyx_v_tr_len, __pyx_v_cl_len, __pyx_v_kwargs);
@@ -26449,68 +27042,68 @@
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "statmoments/_native.pyx":779
+  /* "statmoments/_native.pyx":828
  * class _BivarNpassBase(_AccBase):
  *   def __init__(self, tr_len, cl_len, **kwargs):
  *     super().__init__(tr_len, cl_len, **kwargs)             # <<<<<<<<<<<<<<
  *     self.traces = np.empty((1, tr_len))[1:]
- *     self.cls    = np.asarray([bytearray(b'2')], dtype=np.uint8)[1:] # 2 is non existing element
+ *     self.cls    = np.asarray([bytearray(b'2' * cl_len)], dtype=np.uint8)[1:]  # 2 is non existing element
  */
   __pyx_t_1 = __Pyx_CyFunction_GetClassObj(__pyx_self);
-  if (!__pyx_t_1) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 779, __pyx_L1_error) }
+  if (!__pyx_t_1) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 828, __pyx_L1_error) }
   __Pyx_INCREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 779, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 828, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __Pyx_INCREF(__pyx_v_self);
   __Pyx_GIVEREF(__pyx_v_self);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_self);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 779, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 828, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_init); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 779, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_init); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 828, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 779, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 828, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_tr_len);
   __Pyx_GIVEREF(__pyx_v_tr_len);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_tr_len);
   __Pyx_INCREF(__pyx_v_cl_len);
   __Pyx_GIVEREF(__pyx_v_cl_len);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_cl_len);
-  __pyx_t_3 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 779, __pyx_L1_error)
+  __pyx_t_3 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 828, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 779, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 828, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":780
+  /* "statmoments/_native.pyx":829
  *   def __init__(self, tr_len, cl_len, **kwargs):
  *     super().__init__(tr_len, cl_len, **kwargs)
  *     self.traces = np.empty((1, tr_len))[1:]             # <<<<<<<<<<<<<<
- *     self.cls    = np.asarray([bytearray(b'2')], dtype=np.uint8)[1:] # 2 is non existing element
+ *     self.cls    = np.asarray([bytearray(b'2' * cl_len)], dtype=np.uint8)[1:]  # 2 is non existing element
  *     self._tmpsq = np.empty((tr_len, tr_len))  # Has to be square for syrk
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 780, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 829, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 780, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 829, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 780, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 829, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_int_1);
   __Pyx_INCREF(__pyx_v_tr_len);
   __Pyx_GIVEREF(__pyx_v_tr_len);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_tr_len);
@@ -26523,157 +27116,160 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_1, function);
     }
   }
   __pyx_t_4 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_2, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 780, __pyx_L1_error)
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 829, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_t_4, 1, 0, NULL, NULL, &__pyx_slice__17, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 780, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_t_4, 1, 0, NULL, NULL, &__pyx_slice__19, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 829, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_traces, __pyx_t_1) < 0) __PYX_ERR(0, 780, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_traces, __pyx_t_1) < 0) __PYX_ERR(0, 829, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":781
+  /* "statmoments/_native.pyx":830
  *     super().__init__(tr_len, cl_len, **kwargs)
  *     self.traces = np.empty((1, tr_len))[1:]
- *     self.cls    = np.asarray([bytearray(b'2')], dtype=np.uint8)[1:] # 2 is non existing element             # <<<<<<<<<<<<<<
+ *     self.cls    = np.asarray([bytearray(b'2' * cl_len)], dtype=np.uint8)[1:]  # 2 is non existing element             # <<<<<<<<<<<<<<
  *     self._tmpsq = np.empty((tr_len, tr_len))  # Has to be square for syrk
  *     self._retm  = np.empty((2, 2, tr_len * (tr_len + 1) // 2))
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 781, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 830, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_asarray); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 781, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_asarray); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 830, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)(&PyByteArray_Type)), __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 781, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_kp_b_2, __pyx_v_cl_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 830, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 781, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyByteArray_Type)), __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 830, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_1);
-  PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
-  __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 781, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 830, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
-  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
+  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 781, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 830, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 781, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
+  __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 830, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 830, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 781, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 830, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 781, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 830, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 781, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 830, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_t_5, 1, 0, NULL, NULL, &__pyx_slice__17, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 781, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_t_5, 1, 0, NULL, NULL, &__pyx_slice__19, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 830, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_cls, __pyx_t_3) < 0) __PYX_ERR(0, 781, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_cls, __pyx_t_1) < 0) __PYX_ERR(0, 830, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":782
+  /* "statmoments/_native.pyx":831
  *     self.traces = np.empty((1, tr_len))[1:]
- *     self.cls    = np.asarray([bytearray(b'2')], dtype=np.uint8)[1:] # 2 is non existing element
+ *     self.cls    = np.asarray([bytearray(b'2' * cl_len)], dtype=np.uint8)[1:]  # 2 is non existing element
  *     self._tmpsq = np.empty((tr_len, tr_len))  # Has to be square for syrk             # <<<<<<<<<<<<<<
  *     self._retm  = np.empty((2, 2, tr_len * (tr_len + 1) // 2))
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 782, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 831, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 782, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 831, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 782, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 831, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(__pyx_v_tr_len);
   __Pyx_GIVEREF(__pyx_v_tr_len);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_tr_len);
   __Pyx_INCREF(__pyx_v_tr_len);
   __Pyx_GIVEREF(__pyx_v_tr_len);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_tr_len);
   __pyx_t_4 = NULL;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
-    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_1, function);
+      __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
-  __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_5);
+  __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 782, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_tmpsq, __pyx_t_3) < 0) __PYX_ERR(0, 782, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 831, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_tmpsq, __pyx_t_1) < 0) __PYX_ERR(0, 831, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":783
- *     self.cls    = np.asarray([bytearray(b'2')], dtype=np.uint8)[1:] # 2 is non existing element
+  /* "statmoments/_native.pyx":832
+ *     self.cls    = np.asarray([bytearray(b'2' * cl_len)], dtype=np.uint8)[1:]  # 2 is non existing element
  *     self._tmpsq = np.empty((tr_len, tr_len))  # Has to be square for syrk
  *     self._retm  = np.empty((2, 2, tr_len * (tr_len + 1) // 2))             # <<<<<<<<<<<<<<
  * 
  *   @staticmethod
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 783, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 783, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 832, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_empty); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 832, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_v_tr_len, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 783, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_v_tr_len, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 783, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_tr_len, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 832, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_4 = PyNumber_Multiply(__pyx_v_tr_len, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 832, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_4, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 783, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_4, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 832, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 783, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 832, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_int_2);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_2);
-  __Pyx_GIVEREF(__pyx_t_1);
-  PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_1);
-  __pyx_t_1 = 0;
-  __pyx_t_1 = NULL;
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_3);
+  __pyx_t_3 = 0;
+  __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
-    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
-    if (likely(__pyx_t_1)) {
+    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
+    if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
-      __Pyx_INCREF(__pyx_t_1);
+      __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
-  __pyx_t_3 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_1, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 783, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 832, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_retm, __pyx_t_3) < 0) __PYX_ERR(0, 783, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_retm, __pyx_t_1) < 0) __PYX_ERR(0, 832, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":778
+  /* "statmoments/_native.pyx":827
  * 
  * class _BivarNpassBase(_AccBase):
  *   def __init__(self, tr_len, cl_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(tr_len, cl_len, **kwargs)
  *     self.traces = np.empty((1, tr_len))[1:]
  */
 
@@ -26690,37 +27286,37 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":786
+/* "statmoments/_native.pyx":835
  * 
  *   @staticmethod
- *   def estimate_mem_size(trace_len, classifier_len=1, moment=2):             # <<<<<<<<<<<<<<
- *     mem_class = trace_len * trace_len + 4 * trace_len * (trace_len+1) // 2
- *     return mem_class * 8 * classifier_len
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *     mem_class = tr_len * tr_len + 2 * 2 * tr_len * (tr_len + 1) // 2
+ *     return mem_class * 8
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_11statmoments_7_native_15_BivarNpassBase_3estimate_mem_size(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_11statmoments_7_native_15_BivarNpassBase_3estimate_mem_size = {"estimate_mem_size", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_15_BivarNpassBase_3estimate_mem_size, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_11statmoments_7_native_15_BivarNpassBase_3estimate_mem_size(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyObject *__pyx_v_trace_len = 0;
-  PyObject *__pyx_v_classifier_len = 0;
+  PyObject *__pyx_v_tr_len = 0;
+  CYTHON_UNUSED PyObject *__pyx_v_cl_len = 0;
   CYTHON_UNUSED PyObject *__pyx_v_moment = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("estimate_mem_size (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_trace_len,&__pyx_n_s_classifier_len,&__pyx_n_s_moment,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_tr_len,&__pyx_n_s_cl_len,&__pyx_n_s_moment,0};
     PyObject* values[3] = {0,0,0};
     values[1] = ((PyObject *)((PyObject *)__pyx_int_1));
     values[2] = ((PyObject *)((PyObject *)__pyx_int_2));
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
@@ -26732,125 +27328,122 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_trace_len)) != 0)) kw_args--;
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr_len)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifier_len);
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_cl_len);
           if (value) { values[1] = value; kw_args--; }
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moment);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "estimate_mem_size") < 0)) __PYX_ERR(0, 786, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "estimate_mem_size") < 0)) __PYX_ERR(0, 835, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
-    __pyx_v_trace_len = values[0];
-    __pyx_v_classifier_len = values[1];
+    __pyx_v_tr_len = values[0];
+    __pyx_v_cl_len = values[1];
     __pyx_v_moment = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("estimate_mem_size", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 786, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("estimate_mem_size", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 835, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native._BivarNpassBase.estimate_mem_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11statmoments_7_native_15_BivarNpassBase_2estimate_mem_size(__pyx_self, __pyx_v_trace_len, __pyx_v_classifier_len, __pyx_v_moment);
+  __pyx_r = __pyx_pf_11statmoments_7_native_15_BivarNpassBase_2estimate_mem_size(__pyx_self, __pyx_v_tr_len, __pyx_v_cl_len, __pyx_v_moment);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11statmoments_7_native_15_BivarNpassBase_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_trace_len, PyObject *__pyx_v_classifier_len, CYTHON_UNUSED PyObject *__pyx_v_moment) {
+static PyObject *__pyx_pf_11statmoments_7_native_15_BivarNpassBase_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tr_len, CYTHON_UNUSED PyObject *__pyx_v_cl_len, CYTHON_UNUSED PyObject *__pyx_v_moment) {
   PyObject *__pyx_v_mem_class = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("estimate_mem_size", 0);
 
-  /* "statmoments/_native.pyx":787
+  /* "statmoments/_native.pyx":836
  *   @staticmethod
- *   def estimate_mem_size(trace_len, classifier_len=1, moment=2):
- *     mem_class = trace_len * trace_len + 4 * trace_len * (trace_len+1) // 2             # <<<<<<<<<<<<<<
- *     return mem_class * 8 * classifier_len
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):
+ *     mem_class = tr_len * tr_len + 2 * 2 * tr_len * (tr_len + 1) // 2             # <<<<<<<<<<<<<<
+ *     return mem_class * 8
  * 
  */
-  __pyx_t_1 = PyNumber_Multiply(__pyx_v_trace_len, __pyx_v_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 787, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_tr_len, __pyx_v_tr_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 836, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyNumber_Multiply(__pyx_int_4, __pyx_v_trace_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 787, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_int_4, __pyx_v_tr_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 836, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_trace_len, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 787, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_tr_len, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 836, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 787, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 836, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_4, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 787, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_4, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 836, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyNumber_Add(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 787, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Add(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 836, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_mem_class = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":788
- *   def estimate_mem_size(trace_len, classifier_len=1, moment=2):
- *     mem_class = trace_len * trace_len + 4 * trace_len * (trace_len+1) // 2
- *     return mem_class * 8 * classifier_len             # <<<<<<<<<<<<<<
+  /* "statmoments/_native.pyx":837
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):
+ *     mem_class = tr_len * tr_len + 2 * 2 * tr_len * (tr_len + 1) // 2
+ *     return mem_class * 8             # <<<<<<<<<<<<<<
  * 
  *   def memory_size(self):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_v_mem_class, __pyx_int_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 788, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_v_mem_class, __pyx_int_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 837, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_4, __pyx_v_classifier_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 788, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_r = __pyx_t_3;
-  __pyx_t_3 = 0;
+  __pyx_r = __pyx_t_4;
+  __pyx_t_4 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":786
+  /* "statmoments/_native.pyx":835
  * 
  *   @staticmethod
- *   def estimate_mem_size(trace_len, classifier_len=1, moment=2):             # <<<<<<<<<<<<<<
- *     mem_class = trace_len * trace_len + 4 * trace_len * (trace_len+1) // 2
- *     return mem_class * 8 * classifier_len
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *     mem_class = tr_len * tr_len + 2 * 2 * tr_len * (tr_len + 1) // 2
+ *     return mem_class * 8
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
@@ -26860,20 +27453,20 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_mem_class);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":790
- *     return mem_class * 8 * classifier_len
+/* "statmoments/_native.pyx":839
+ *     return mem_class * 8
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
- *     def _sz_helper(inst):
- *       return sum(v.nbytes for v in inst if isinstance(v, np.ndarray))
+ *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
+ *     return mem_class
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_11statmoments_7_native_15_BivarNpassBase_5memory_size(PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
 static PyMethodDef __pyx_mdef_11statmoments_7_native_15_BivarNpassBase_5memory_size = {"memory_size", (PyCFunction)__pyx_pw_11statmoments_7_native_15_BivarNpassBase_5memory_size, METH_O, 0};
 static PyObject *__pyx_pw_11statmoments_7_native_15_BivarNpassBase_5memory_size(PyObject *__pyx_self, PyObject *__pyx_v_self) {
   PyObject *__pyx_r = 0;
@@ -26881,411 +27474,250 @@
   __Pyx_RefNannySetupContext("memory_size (wrapper)", 0);
   __pyx_r = __pyx_pf_11statmoments_7_native_15_BivarNpassBase_4memory_size(__pyx_self, ((PyObject *)__pyx_v_self));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
+static PyObject *__pyx_gb_11statmoments_7_native_15_BivarNpassBase_11memory_size_2generator14(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "statmoments/_native.pyx":791
+/* "statmoments/_native.pyx":840
  * 
  *   def memory_size(self):
- *     def _sz_helper(inst):             # <<<<<<<<<<<<<<
- *       return sum(v.nbytes for v in inst if isinstance(v, np.ndarray))
- *     mem_class =  sum(map(_sz_helper, [vars(self).values()]))
- */
-
-/* Python wrapper */
-static PyObject *__pyx_pw_11statmoments_7_native_15_BivarNpassBase_11memory_size_1_sz_helper(PyObject *__pyx_self, PyObject *__pyx_v_inst); /*proto*/
-static PyMethodDef __pyx_mdef_11statmoments_7_native_15_BivarNpassBase_11memory_size_1_sz_helper = {"_sz_helper", (PyCFunction)__pyx_pw_11statmoments_7_native_15_BivarNpassBase_11memory_size_1_sz_helper, METH_O, 0};
-static PyObject *__pyx_pw_11statmoments_7_native_15_BivarNpassBase_11memory_size_1_sz_helper(PyObject *__pyx_self, PyObject *__pyx_v_inst) {
-  PyObject *__pyx_r = 0;
-  __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("_sz_helper (wrapper)", 0);
-  __pyx_r = __pyx_pf_11statmoments_7_native_15_BivarNpassBase_11memory_size__sz_helper(__pyx_self, ((PyObject *)__pyx_v_inst));
-
-  /* function exit code */
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-static PyObject *__pyx_gb_11statmoments_7_native_15_BivarNpassBase_11memory_size_10_sz_helper_2generator14(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
-
-/* "statmoments/_native.pyx":792
- *   def memory_size(self):
- *     def _sz_helper(inst):
- *       return sum(v.nbytes for v in inst if isinstance(v, np.ndarray))             # <<<<<<<<<<<<<<
- *     mem_class =  sum(map(_sz_helper, [vars(self).values()]))
- *     mem_ttest = 0  # included in mem_class
+ *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))             # <<<<<<<<<<<<<<
+ *     return mem_class
+ * 
  */
 
-static PyObject *__pyx_pf_11statmoments_7_native_15_BivarNpassBase_11memory_size_10_sz_helper_genexpr(PyObject *__pyx_self) {
+static PyObject *__pyx_pf_11statmoments_7_native_15_BivarNpassBase_11memory_size_genexpr(PyObject *__pyx_self) {
   struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_11_genexpr *__pyx_cur_scope;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("genexpr", 0);
   __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_11_genexpr *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_11_genexpr(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_11_genexpr, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_11_genexpr *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 792, __pyx_L1_error)
+    __PYX_ERR(0, 840, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
-  __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10__sz_helper *) __pyx_self;
+  __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10_memory_size *) __pyx_self;
   __Pyx_INCREF(((PyObject *)__pyx_cur_scope->__pyx_outer_scope));
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_outer_scope);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_15_BivarNpassBase_11memory_size_10_sz_helper_2generator14, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_BivarNpassBase_memory_size_loca, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 792, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_15_BivarNpassBase_11memory_size_2generator14, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_BivarNpassBase_memory_size_loca, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 840, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
-  __Pyx_AddTraceback("statmoments._native._BivarNpassBase.memory_size._sz_helper.genexpr", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("statmoments._native._BivarNpassBase.memory_size.genexpr", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_gb_11statmoments_7_native_15_BivarNpassBase_11memory_size_10_sz_helper_2generator14(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
+static PyObject *__pyx_gb_11statmoments_7_native_15_BivarNpassBase_11memory_size_2generator14(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
 {
   struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_11_genexpr *__pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_11_genexpr *)__pyx_generator->closure);
   PyObject *__pyx_r = NULL;
   PyObject *__pyx_t_1 = NULL;
   Py_ssize_t __pyx_t_2;
-  PyObject *(*__pyx_t_3)(PyObject *);
-  PyObject *__pyx_t_4 = NULL;
+  Py_ssize_t __pyx_t_3;
+  int __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
-  int __pyx_t_6;
+  PyObject *__pyx_t_6 = NULL;
   int __pyx_t_7;
+  int __pyx_t_8;
+  int __pyx_t_9;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("genexpr", 0);
   switch (__pyx_generator->resume_label) {
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L7_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 792, __pyx_L1_error)
-  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_inst)) { __Pyx_RaiseClosureNameError("inst"); __PYX_ERR(0, 792, __pyx_L1_error) }
-  if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_inst)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_inst)) {
-    __pyx_t_1 = __pyx_cur_scope->__pyx_outer_scope->__pyx_v_inst; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
-    __pyx_t_3 = NULL;
-  } else {
-    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_inst); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 792, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 792, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 840, __pyx_L1_error)
+  __pyx_t_2 = 0;
+  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_self)) { __Pyx_RaiseClosureNameError("self"); __PYX_ERR(0, 840, __pyx_L1_error) }
+  __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_vars, __pyx_cur_scope->__pyx_outer_scope->__pyx_v_self); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 840, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  if (unlikely(__pyx_t_5 == Py_None)) {
+    PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "values");
+    __PYX_ERR(0, 840, __pyx_L1_error)
   }
-  for (;;) {
-    if (likely(!__pyx_t_3)) {
-      if (likely(PyList_CheckExact(__pyx_t_1))) {
-        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
-        #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 792, __pyx_L1_error)
-        #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 792, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_4);
-        #endif
-      } else {
-        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
-        #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 792, __pyx_L1_error)
-        #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 792, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_4);
-        #endif
-      }
-    } else {
-      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
-      if (unlikely(!__pyx_t_4)) {
-        PyObject* exc_type = PyErr_Occurred();
-        if (exc_type) {
-          if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 792, __pyx_L1_error)
-        }
-        break;
-      }
-      __Pyx_GOTREF(__pyx_t_4);
-    }
+  __pyx_t_6 = __Pyx_dict_iterator(__pyx_t_5, 0, __pyx_n_s_values, (&__pyx_t_3), (&__pyx_t_4)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 840, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_6);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __Pyx_XDECREF(__pyx_t_1);
+  __pyx_t_1 = __pyx_t_6;
+  __pyx_t_6 = 0;
+  while (1) {
+    __pyx_t_7 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_3, &__pyx_t_2, NULL, &__pyx_t_6, NULL, __pyx_t_4);
+    if (unlikely(__pyx_t_7 == 0)) break;
+    if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 840, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_v);
-    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_v, __pyx_t_4);
-    __Pyx_GIVEREF(__pyx_t_4);
-    __pyx_t_4 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 792, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_ndarray); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 792, __pyx_L1_error)
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_v, __pyx_t_6);
+    __Pyx_GIVEREF(__pyx_t_6);
+    __pyx_t_6 = 0;
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 840, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_ndarray); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 840, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_6 = PyObject_IsInstance(__pyx_cur_scope->__pyx_v_v, __pyx_t_5); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 792, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_8 = PyObject_IsInstance(__pyx_cur_scope->__pyx_v_v, __pyx_t_5); if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 840, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_7 = (__pyx_t_6 != 0);
-    if (__pyx_t_7) {
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_v, __pyx_n_s_nbytes); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 792, __pyx_L1_error)
+    __pyx_t_9 = (__pyx_t_8 != 0);
+    if (__pyx_t_9) {
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_v, __pyx_n_s_nbytes); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 840, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __pyx_r = __pyx_t_5;
       __pyx_t_5 = 0;
       __Pyx_XGIVEREF(__pyx_t_1);
       __pyx_cur_scope->__pyx_t_0 = __pyx_t_1;
       __pyx_cur_scope->__pyx_t_1 = __pyx_t_2;
       __pyx_cur_scope->__pyx_t_2 = __pyx_t_3;
+      __pyx_cur_scope->__pyx_t_3 = __pyx_t_4;
       __Pyx_XGIVEREF(__pyx_r);
       __Pyx_RefNannyFinishContext();
       __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
       /* return from generator, yielding value */
       __pyx_generator->resume_label = 1;
       return __pyx_r;
       __pyx_L7_resume_from_yield:;
       __pyx_t_1 = __pyx_cur_scope->__pyx_t_0;
       __pyx_cur_scope->__pyx_t_0 = 0;
       __Pyx_XGOTREF(__pyx_t_1);
       __pyx_t_2 = __pyx_cur_scope->__pyx_t_1;
       __pyx_t_3 = __pyx_cur_scope->__pyx_t_2;
-      if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 792, __pyx_L1_error)
+      __pyx_t_4 = __pyx_cur_scope->__pyx_t_3;
+      if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 840, __pyx_L1_error)
     }
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
   /* function exit code */
   PyErr_SetNone(PyExc_StopIteration);
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
   __Pyx_AddTraceback("genexpr", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_r); __pyx_r = 0;
   #if !CYTHON_USE_EXC_INFO_STACK
   __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":791
+/* "statmoments/_native.pyx":839
+ *     return mem_class * 8
  * 
- *   def memory_size(self):
- *     def _sz_helper(inst):             # <<<<<<<<<<<<<<
- *       return sum(v.nbytes for v in inst if isinstance(v, np.ndarray))
- *     mem_class =  sum(map(_sz_helper, [vars(self).values()]))
+ *   def memory_size(self):             # <<<<<<<<<<<<<<
+ *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
+ *     return mem_class
  */
 
-static PyObject *__pyx_pf_11statmoments_7_native_15_BivarNpassBase_11memory_size__sz_helper(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_inst) {
-  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10__sz_helper *__pyx_cur_scope;
-  PyObject *__pyx_gb_11statmoments_7_native_15_BivarNpassBase_11memory_size_10_sz_helper_2generator14 = 0;
+static PyObject *__pyx_pf_11statmoments_7_native_15_BivarNpassBase_4memory_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
+  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10_memory_size *__pyx_cur_scope;
+  PyObject *__pyx_v_mem_class = NULL;
+  PyObject *__pyx_gb_11statmoments_7_native_15_BivarNpassBase_11memory_size_2generator14 = 0;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("_sz_helper", 0);
-  __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10__sz_helper *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_10__sz_helper(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_10__sz_helper, __pyx_empty_tuple, NULL);
+  __Pyx_RefNannySetupContext("memory_size", 0);
+  __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10_memory_size *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_10_memory_size(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_10_memory_size, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
-    __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10__sz_helper *)Py_None);
+    __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10_memory_size *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 791, __pyx_L1_error)
+    __PYX_ERR(0, 839, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
-  __pyx_cur_scope->__pyx_v_inst = __pyx_v_inst;
-  __Pyx_INCREF(__pyx_cur_scope->__pyx_v_inst);
-  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_inst);
-
-  /* "statmoments/_native.pyx":792
- *   def memory_size(self):
- *     def _sz_helper(inst):
- *       return sum(v.nbytes for v in inst if isinstance(v, np.ndarray))             # <<<<<<<<<<<<<<
- *     mem_class =  sum(map(_sz_helper, [vars(self).values()]))
- *     mem_ttest = 0  # included in mem_class
- */
-  __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_pf_11statmoments_7_native_15_BivarNpassBase_11memory_size_10_sz_helper_genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 792, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_sum, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 792, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_r = __pyx_t_2;
-  __pyx_t_2 = 0;
-  goto __pyx_L0;
+  __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
+  __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
+  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
 
-  /* "statmoments/_native.pyx":791
+  /* "statmoments/_native.pyx":840
  * 
  *   def memory_size(self):
- *     def _sz_helper(inst):             # <<<<<<<<<<<<<<
- *       return sum(v.nbytes for v in inst if isinstance(v, np.ndarray))
- *     mem_class =  sum(map(_sz_helper, [vars(self).values()]))
- */
-
-  /* function exit code */
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_AddTraceback("statmoments._native._BivarNpassBase.memory_size._sz_helper", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __pyx_r = NULL;
-  __pyx_L0:;
-  __Pyx_XDECREF(__pyx_gb_11statmoments_7_native_15_BivarNpassBase_11memory_size_10_sz_helper_2generator14);
-  __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "statmoments/_native.pyx":790
- *     return mem_class * 8 * classifier_len
- * 
- *   def memory_size(self):             # <<<<<<<<<<<<<<
- *     def _sz_helper(inst):
- *       return sum(v.nbytes for v in inst if isinstance(v, np.ndarray))
- */
-
-static PyObject *__pyx_pf_11statmoments_7_native_15_BivarNpassBase_4memory_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
-  PyObject *__pyx_v__sz_helper = 0;
-  PyObject *__pyx_v_mem_class = NULL;
-  PyObject *__pyx_v_mem_ttest = NULL;
-  PyObject *__pyx_r = NULL;
-  __Pyx_RefNannyDeclarations
-  PyObject *__pyx_t_1 = NULL;
-  PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("memory_size", 0);
-
-  /* "statmoments/_native.pyx":791
+ *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))             # <<<<<<<<<<<<<<
+ *     return mem_class
  * 
- *   def memory_size(self):
- *     def _sz_helper(inst):             # <<<<<<<<<<<<<<
- *       return sum(v.nbytes for v in inst if isinstance(v, np.ndarray))
- *     mem_class =  sum(map(_sz_helper, [vars(self).values()]))
  */
-  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_BivarNpassBase_11memory_size_1_sz_helper, 0, __pyx_n_s_BivarNpassBase_memory_size_loca_2, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__33)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 791, __pyx_L1_error)
+  __pyx_t_1 = __pyx_pf_11statmoments_7_native_15_BivarNpassBase_11memory_size_genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 840, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_v__sz_helper = __pyx_t_1;
-  __pyx_t_1 = 0;
-
-  /* "statmoments/_native.pyx":793
- *     def _sz_helper(inst):
- *       return sum(v.nbytes for v in inst if isinstance(v, np.ndarray))
- *     mem_class =  sum(map(_sz_helper, [vars(self).values()]))             # <<<<<<<<<<<<<<
- *     mem_ttest = 0  # included in mem_class
- *     return mem_class + mem_ttest * 8
- */
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_vars, __pyx_v_self); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 793, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_sum, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 840, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_values); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 793, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = NULL;
-  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
-    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
-    if (likely(__pyx_t_2)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-      __Pyx_INCREF(__pyx_t_2);
-      __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_3, function);
-    }
-  }
-  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 793, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 793, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_1);
-  PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
-  __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 793, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_INCREF(__pyx_v__sz_helper);
-  __Pyx_GIVEREF(__pyx_v__sz_helper);
-  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v__sz_helper);
-  __Pyx_GIVEREF(__pyx_t_3);
-  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_3);
-  __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_map, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 793, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_sum, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 793, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_v_mem_class = __pyx_t_1;
-  __pyx_t_1 = 0;
-
-  /* "statmoments/_native.pyx":794
- *       return sum(v.nbytes for v in inst if isinstance(v, np.ndarray))
- *     mem_class =  sum(map(_sz_helper, [vars(self).values()]))
- *     mem_ttest = 0  # included in mem_class             # <<<<<<<<<<<<<<
- *     return mem_class + mem_ttest * 8
- * 
- */
-  __Pyx_INCREF(__pyx_int_0);
-  __pyx_v_mem_ttest = __pyx_int_0;
+  __pyx_v_mem_class = __pyx_t_2;
+  __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":795
- *     mem_class =  sum(map(_sz_helper, [vars(self).values()]))
- *     mem_ttest = 0  # included in mem_class
- *     return mem_class + mem_ttest * 8             # <<<<<<<<<<<<<<
+  /* "statmoments/_native.pyx":841
+ *   def memory_size(self):
+ *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
+ *     return mem_class             # <<<<<<<<<<<<<<
  * 
  *   def update(self, traces, classifiers):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_v_mem_ttest, __pyx_int_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 795, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Add(__pyx_v_mem_class, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 795, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_r = __pyx_t_3;
-  __pyx_t_3 = 0;
+  __Pyx_INCREF(__pyx_v_mem_class);
+  __pyx_r = __pyx_v_mem_class;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":790
- *     return mem_class * 8 * classifier_len
+  /* "statmoments/_native.pyx":839
+ *     return mem_class * 8
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
- *     def _sz_helper(inst):
- *       return sum(v.nbytes for v in inst if isinstance(v, np.ndarray))
+ *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
+ *     return mem_class
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
   __Pyx_AddTraceback("statmoments._native._BivarNpassBase.memory_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
-  __Pyx_XDECREF(__pyx_v__sz_helper);
   __Pyx_XDECREF(__pyx_v_mem_class);
-  __Pyx_XDECREF(__pyx_v_mem_ttest);
+  __Pyx_XDECREF(__pyx_gb_11statmoments_7_native_15_BivarNpassBase_11memory_size_2generator14);
+  __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":797
- *     return mem_class + mem_ttest * 8
+/* "statmoments/_native.pyx":843
+ *     return mem_class
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     self.total_count += len(traces)
  * 
  */
 
 /* Python wrapper */
@@ -27322,40 +27754,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_traces)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 1); __PYX_ERR(0, 797, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 1); __PYX_ERR(0, 843, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifiers)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 2); __PYX_ERR(0, 797, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 2); __PYX_ERR(0, 843, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update") < 0)) __PYX_ERR(0, 797, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update") < 0)) __PYX_ERR(0, 843, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_traces = values[1];
     __pyx_v_classifiers = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 797, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 843, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native._BivarNpassBase.update", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_15_BivarNpassBase_6update(__pyx_self, __pyx_v_self, __pyx_v_traces, __pyx_v_classifiers);
 
@@ -27376,116 +27808,116 @@
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("update", 0);
 
-  /* "statmoments/_native.pyx":798
+  /* "statmoments/_native.pyx":844
  * 
  *   def update(self, traces, classifiers):
  *     self.total_count += len(traces)             # <<<<<<<<<<<<<<
  * 
- *     tr_copy  = np.asarray(traces, dtype=np.float64)
+ *     tr_copy = np.asarray(traces, dtype=np.float64)
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_total_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 798, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_total_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 844, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_Length(__pyx_v_traces); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 798, __pyx_L1_error)
-  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 798, __pyx_L1_error)
+  __pyx_t_2 = PyObject_Length(__pyx_v_traces); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 844, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 844, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyNumber_InPlaceAdd(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 798, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_InPlaceAdd(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 844, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_total_count, __pyx_t_4) < 0) __PYX_ERR(0, 798, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_total_count, __pyx_t_4) < 0) __PYX_ERR(0, 844, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":800
+  /* "statmoments/_native.pyx":846
  *     self.total_count += len(traces)
  * 
- *     tr_copy  = np.asarray(traces, dtype=np.float64)             # <<<<<<<<<<<<<<
- *     cl_copy  = np.asarray(classifiers, dtype=np.uint8)
+ *     tr_copy = np.asarray(traces, dtype=np.float64)             # <<<<<<<<<<<<<<
+ *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  *     self.traces = np.vstack((self.traces, tr_copy))
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 800, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 846, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_asarray); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 800, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_asarray); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 846, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 800, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 846, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_v_traces);
   __Pyx_GIVEREF(__pyx_v_traces);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_traces);
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 800, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 846, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 800, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 846, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 800, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 846, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 800, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 846, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 800, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 846, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_tr_copy = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "statmoments/_native.pyx":801
+  /* "statmoments/_native.pyx":847
  * 
- *     tr_copy  = np.asarray(traces, dtype=np.float64)
- *     cl_copy  = np.asarray(classifiers, dtype=np.uint8)             # <<<<<<<<<<<<<<
+ *     tr_copy = np.asarray(traces, dtype=np.float64)
+ *     cl_copy = np.asarray(classifiers, dtype=np.uint8)             # <<<<<<<<<<<<<<
  *     self.traces = np.vstack((self.traces, tr_copy))
  *     self.cls    = np.vstack((self.cls, cl_copy))
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 847, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_asarray); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_asarray); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 847, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 847, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(__pyx_v_classifiers);
   __Pyx_GIVEREF(__pyx_v_classifiers);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_classifiers);
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 847, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 847, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 847, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 801, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 847, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 847, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_cl_copy = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":802
- *     tr_copy  = np.asarray(traces, dtype=np.float64)
- *     cl_copy  = np.asarray(classifiers, dtype=np.uint8)
+  /* "statmoments/_native.pyx":848
+ *     tr_copy = np.asarray(traces, dtype=np.float64)
+ *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  *     self.traces = np.vstack((self.traces, tr_copy))             # <<<<<<<<<<<<<<
  *     self.cls    = np.vstack((self.cls, cl_copy))
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 802, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 848, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_vstack); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 802, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_vstack); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 848, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_traces); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 802, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_traces); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 848, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 802, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 848, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __Pyx_INCREF(__pyx_v_tr_copy);
   __Pyx_GIVEREF(__pyx_v_tr_copy);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_tr_copy);
   __pyx_t_4 = 0;
@@ -27498,35 +27930,35 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_5 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_4, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 802, __pyx_L1_error)
+  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 848, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_traces, __pyx_t_5) < 0) __PYX_ERR(0, 802, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_traces, __pyx_t_5) < 0) __PYX_ERR(0, 848, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":803
- *     cl_copy  = np.asarray(classifiers, dtype=np.uint8)
+  /* "statmoments/_native.pyx":849
+ *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  *     self.traces = np.vstack((self.traces, tr_copy))
  *     self.cls    = np.vstack((self.cls, cl_copy))             # <<<<<<<<<<<<<<
  * 
  *   def counts(self, i):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 803, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 849, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_vstack); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 803, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_vstack); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 849, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cls); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 803, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cls); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 849, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 803, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 849, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_6);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
   __Pyx_INCREF(__pyx_v_cl_copy);
   __Pyx_GIVEREF(__pyx_v_cl_copy);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_cl_copy);
   __pyx_t_6 = 0;
@@ -27539,22 +27971,22 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_1, function);
     }
   }
   __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_6, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 803, __pyx_L1_error)
+  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 849, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_cls, __pyx_t_5) < 0) __PYX_ERR(0, 803, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_cls, __pyx_t_5) < 0) __PYX_ERR(0, 849, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":797
- *     return mem_class + mem_ttest * 8
+  /* "statmoments/_native.pyx":843
+ *     return mem_class
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     self.total_count += len(traces)
  * 
  */
 
   /* function exit code */
@@ -27572,15 +28004,15 @@
   __Pyx_XDECREF(__pyx_v_tr_copy);
   __Pyx_XDECREF(__pyx_v_cl_copy);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":805
+/* "statmoments/_native.pyx":851
  *     self.cls    = np.vstack((self.cls, cl_copy))
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
  *     c1 = sum(self.cls[:, i])
  *     return self.total_count - c1, c1
  */
 
@@ -27615,32 +28047,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_i)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, 1); __PYX_ERR(0, 805, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, 1); __PYX_ERR(0, 851, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "counts") < 0)) __PYX_ERR(0, 805, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "counts") < 0)) __PYX_ERR(0, 851, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_i = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 805, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 851, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native._BivarNpassBase.counts", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_15_BivarNpassBase_8counts(__pyx_self, __pyx_v_self, __pyx_v_i);
 
@@ -27657,67 +28089,67 @@
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("counts", 0);
 
-  /* "statmoments/_native.pyx":806
+  /* "statmoments/_native.pyx":852
  * 
  *   def counts(self, i):
  *     c1 = sum(self.cls[:, i])             # <<<<<<<<<<<<<<
  *     return self.total_count - c1, c1
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cls); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 806, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cls); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 806, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_INCREF(__pyx_slice__5);
-  __Pyx_GIVEREF(__pyx_slice__5);
-  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_slice__5);
+  __Pyx_INCREF(__pyx_slice__7);
+  __Pyx_GIVEREF(__pyx_slice__7);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_slice__7);
   __Pyx_INCREF(__pyx_v_i);
   __Pyx_GIVEREF(__pyx_v_i);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_i);
-  __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 806, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_sum, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 806, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_sum, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_c1 = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":807
+  /* "statmoments/_native.pyx":853
  *   def counts(self, i):
  *     c1 = sum(self.cls[:, i])
  *     return self.total_count - c1, c1             # <<<<<<<<<<<<<<
  * 
  *   def _moments(self, moments, normalize):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_total_count); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 807, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_total_count); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 853, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyNumber_Subtract(__pyx_t_2, __pyx_v_c1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 807, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Subtract(__pyx_t_2, __pyx_v_c1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 853, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 807, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 853, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
   __Pyx_INCREF(__pyx_v_c1);
   __Pyx_GIVEREF(__pyx_v_c1);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_c1);
   __pyx_t_3 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":805
+  /* "statmoments/_native.pyx":851
  *     self.cls    = np.vstack((self.cls, cl_copy))
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
  *     c1 = sum(self.cls[:, i])
  *     return self.total_count - c1, c1
  */
 
@@ -27732,20 +28164,20 @@
   __Pyx_XDECREF(__pyx_v_c1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static PyObject *__pyx_gb_11statmoments_7_native_15_BivarNpassBase_12generator5(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "statmoments/_native.pyx":809
+/* "statmoments/_native.pyx":855
  *     return self.total_count - c1, c1
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
+ *     min_cnt = self.acc_min_count
  *     tr_len, cl_len = self.trace_len, self.classifiers_len
- * 
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_11statmoments_7_native_15_BivarNpassBase_11_moments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_11statmoments_7_native_15_BivarNpassBase_11_moments = {"_moments", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_15_BivarNpassBase_11_moments, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_11statmoments_7_native_15_BivarNpassBase_11_moments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
@@ -27778,40 +28210,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moments)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 1); __PYX_ERR(0, 809, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 1); __PYX_ERR(0, 855, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_normalize)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 2); __PYX_ERR(0, 809, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 2); __PYX_ERR(0, 855, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_moments") < 0)) __PYX_ERR(0, 809, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_moments") < 0)) __PYX_ERR(0, 855, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_moments = values[1];
     __pyx_v_normalize = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 809, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 855, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native._BivarNpassBase._moments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_15_BivarNpassBase_10_moments(__pyx_self, __pyx_v_self, __pyx_v_moments, __pyx_v_normalize);
 
@@ -27828,29 +28260,29 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_moments", 0);
   __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_12__moments *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_12__moments(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_12__moments, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_12__moments *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 809, __pyx_L1_error)
+    __PYX_ERR(0, 855, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
   __pyx_cur_scope->__pyx_v_moments = __pyx_v_moments;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_moments);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_moments);
   __pyx_cur_scope->__pyx_v_normalize = __pyx_v_normalize;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_normalize);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_normalize);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_15_BivarNpassBase_12generator5, __pyx_codeobj__34, (PyObject *) __pyx_cur_scope, __pyx_n_s_moments_2, __pyx_n_s_BivarNpassBase__moments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 809, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_15_BivarNpassBase_12generator5, __pyx_codeobj__33, (PyObject *) __pyx_cur_scope, __pyx_n_s_moments_2, __pyx_n_s_BivarNpassBase__moments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 855, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -27869,690 +28301,1223 @@
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   Py_ssize_t __pyx_t_3;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   PyObject *(*__pyx_t_7)(PyObject *);
-  long __pyx_t_8;
+  Py_ssize_t __pyx_t_8;
   Py_ssize_t __pyx_t_9;
-  PyObject *(*__pyx_t_10)(PyObject *);
+  long __pyx_t_10;
   int __pyx_t_11;
-  PyObject *__pyx_t_12 = NULL;
+  PyObject *(*__pyx_t_12)(PyObject *);
   PyObject *__pyx_t_13 = NULL;
-  double __pyx_t_14;
-  __Pyx_memviewslice __pyx_t_15 = { 0, 0, { 0 }, { 0 }, { 0 } };
-  int __pyx_t_16;
+  PyObject *__pyx_t_14 = NULL;
+  double __pyx_t_15;
+  __Pyx_memviewslice __pyx_t_16 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_t_17;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("_moments", 0);
   switch (__pyx_generator->resume_label) {
     case 0: goto __pyx_L3_first_run;
-    case 1: goto __pyx_L14_resume_from_yield;
+    case 1: goto __pyx_L17_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 809, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 855, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":810
+  /* "statmoments/_native.pyx":856
+ * 
+ *   def _moments(self, moments, normalize):
+ *     min_cnt = self.acc_min_count             # <<<<<<<<<<<<<<
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len
  * 
+ */
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_acc_min_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 856, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_cur_scope->__pyx_v_min_cnt = __pyx_t_1;
+  __pyx_t_1 = 0;
+
+  /* "statmoments/_native.pyx":857
  *   def _moments(self, moments, normalize):
+ *     min_cnt = self.acc_min_count
  *     tr_len, cl_len = self.trace_len, self.classifiers_len             # <<<<<<<<<<<<<<
  * 
  *     # 2D stat should return a separate piece of memory to avoid buffer corruption
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 810, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 857, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_classifiers_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 810, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_classifiers_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 857, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v_tr_len = __pyx_t_1;
   __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_cur_scope->__pyx_v_cl_len = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":814
+  /* "statmoments/_native.pyx":861
  *     # 2D stat should return a separate piece of memory to avoid buffer corruption
  *     # while normalizing coskeweness and higher moments
  *     retm = np.empty((2, len(moments), tr_len), dtype=np.float64)             # <<<<<<<<<<<<<<
  * 
  *     for ii in range(cl_len):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 814, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 861, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 814, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 861, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_3 = PyObject_Length(__pyx_cur_scope->__pyx_v_moments); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 814, __pyx_L1_error)
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 814, __pyx_L1_error)
+  __pyx_t_3 = PyObject_Length(__pyx_cur_scope->__pyx_v_moments); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 861, __pyx_L1_error)
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 861, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 814, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 861, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_int_2);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_2);
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_tr_len);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_tr_len);
   PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_cur_scope->__pyx_v_tr_len);
   __pyx_t_2 = 0;
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 814, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 861, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 814, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 861, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 814, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 861, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 814, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 861, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 814, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 861, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 814, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 861, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_GIVEREF(__pyx_t_6);
   __pyx_cur_scope->__pyx_v_retm = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "statmoments/_native.pyx":816
+  /* "statmoments/_native.pyx":863
  *     retm = np.empty((2, len(moments), tr_len), dtype=np.float64)
  * 
  *     for ii in range(cl_len):             # <<<<<<<<<<<<<<
- *       cls0 = (self.cls[:,ii] == 0)
+ *       cls0 = (self.cls[:, ii] == 0)
  *       traces_cl = [self.traces[cls0], self.traces[~cls0]]
  */
-  __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_cur_scope->__pyx_v_cl_len); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 816, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_cur_scope->__pyx_v_cl_len); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 863, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   if (likely(PyList_CheckExact(__pyx_t_6)) || PyTuple_CheckExact(__pyx_t_6)) {
     __pyx_t_4 = __pyx_t_6; __Pyx_INCREF(__pyx_t_4); __pyx_t_3 = 0;
     __pyx_t_7 = NULL;
   } else {
-    __pyx_t_3 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 816, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 863, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_7 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 816, __pyx_L1_error)
+    __pyx_t_7 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 863, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   for (;;) {
     if (likely(!__pyx_t_7)) {
       if (likely(PyList_CheckExact(__pyx_t_4))) {
         if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_4)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_6 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_3); __Pyx_INCREF(__pyx_t_6); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 816, __pyx_L1_error)
+        __pyx_t_6 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_3); __Pyx_INCREF(__pyx_t_6); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 863, __pyx_L1_error)
         #else
-        __pyx_t_6 = PySequence_ITEM(__pyx_t_4, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 816, __pyx_L1_error)
+        __pyx_t_6 = PySequence_ITEM(__pyx_t_4, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 863, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         #endif
       } else {
         if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_3); __Pyx_INCREF(__pyx_t_6); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 816, __pyx_L1_error)
+        __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_3); __Pyx_INCREF(__pyx_t_6); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 863, __pyx_L1_error)
         #else
-        __pyx_t_6 = PySequence_ITEM(__pyx_t_4, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 816, __pyx_L1_error)
+        __pyx_t_6 = PySequence_ITEM(__pyx_t_4, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 863, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         #endif
       }
     } else {
       __pyx_t_6 = __pyx_t_7(__pyx_t_4);
       if (unlikely(!__pyx_t_6)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 816, __pyx_L1_error)
+          else __PYX_ERR(0, 863, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_6);
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_ii);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_ii, __pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":817
+    /* "statmoments/_native.pyx":864
  * 
  *     for ii in range(cl_len):
- *       cls0 = (self.cls[:,ii] == 0)             # <<<<<<<<<<<<<<
+ *       cls0 = (self.cls[:, ii] == 0)             # <<<<<<<<<<<<<<
  *       traces_cl = [self.traces[cls0], self.traces[~cls0]]
- *       for _i in range(2):
+ *       n0, n1 = [len(ts) for ts in traces_cl]
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_cls); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 817, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_cls); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 864, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 817, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_INCREF(__pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_slice__5);
-    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_slice__5);
+    __Pyx_INCREF(__pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_slice__7);
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_slice__7);
     __Pyx_INCREF(__pyx_cur_scope->__pyx_v_ii);
     __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_ii);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_cur_scope->__pyx_v_ii);
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 817, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 864, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyInt_EqObjC(__pyx_t_1, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 817, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_EqObjC(__pyx_t_1, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_cls0);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_cls0, __pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "statmoments/_native.pyx":818
+    /* "statmoments/_native.pyx":865
  *     for ii in range(cl_len):
- *       cls0 = (self.cls[:,ii] == 0)
+ *       cls0 = (self.cls[:, ii] == 0)
  *       traces_cl = [self.traces[cls0], self.traces[~cls0]]             # <<<<<<<<<<<<<<
- *       for _i in range(2):
- *         tr_set = traces_cl[_i]
+ *       n0, n1 = [len(ts) for ts in traces_cl]
+ * 
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_traces); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 818, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_traces); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 865, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_cur_scope->__pyx_v_cls0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 818, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_cur_scope->__pyx_v_cls0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 865, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_traces); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 818, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_traces); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 865, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_6 = PyNumber_Invert(__pyx_cur_scope->__pyx_v_cls0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 818, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Invert(__pyx_cur_scope->__pyx_v_cls0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 865, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 818, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 865, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyList_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 818, __pyx_L1_error)
+    __pyx_t_6 = PyList_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 865, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_1);
     PyList_SET_ITEM(__pyx_t_6, 0, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_5);
     PyList_SET_ITEM(__pyx_t_6, 1, __pyx_t_5);
     __pyx_t_1 = 0;
     __pyx_t_5 = 0;
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_traces_cl);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_traces_cl, ((PyObject*)__pyx_t_6));
     __Pyx_GIVEREF(__pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":819
- *       cls0 = (self.cls[:,ii] == 0)
+    /* "statmoments/_native.pyx":866
+ *       cls0 = (self.cls[:, ii] == 0)
  *       traces_cl = [self.traces[cls0], self.traces[~cls0]]
+ *       n0, n1 = [len(ts) for ts in traces_cl]             # <<<<<<<<<<<<<<
+ * 
+ *       for _i in range(2):
+ */
+    { /* enter inner scope */
+      __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 866, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      __pyx_t_5 = __pyx_cur_scope->__pyx_v_traces_cl; __Pyx_INCREF(__pyx_t_5); __pyx_t_8 = 0;
+      for (;;) {
+        if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_5)) break;
+        #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_8); __Pyx_INCREF(__pyx_t_1); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 866, __pyx_L1_error)
+        #else
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 866, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        #endif
+        __Pyx_XGOTREF(__pyx_cur_scope->__pyx_8genexpr6__pyx_v_ts);
+        __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_8genexpr6__pyx_v_ts, __pyx_t_1);
+        __Pyx_GIVEREF(__pyx_t_1);
+        __pyx_t_1 = 0;
+        __pyx_t_9 = PyObject_Length(__pyx_cur_scope->__pyx_8genexpr6__pyx_v_ts); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 866, __pyx_L1_error)
+        __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 866, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        if (unlikely(__Pyx_ListComp_Append(__pyx_t_6, (PyObject*)__pyx_t_1))) __PYX_ERR(0, 866, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      }
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    } /* exit inner scope */
+    if (1) {
+      PyObject* sequence = __pyx_t_6;
+      Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
+      if (unlikely(size != 2)) {
+        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
+        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
+        __PYX_ERR(0, 866, __pyx_L1_error)
+      }
+      #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+      __pyx_t_5 = PyList_GET_ITEM(sequence, 0); 
+      __pyx_t_1 = PyList_GET_ITEM(sequence, 1); 
+      __Pyx_INCREF(__pyx_t_5);
+      __Pyx_INCREF(__pyx_t_1);
+      #else
+      __pyx_t_5 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 866, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_1 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 866, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      #endif
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    }
+    __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_n0);
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_n0, __pyx_t_5);
+    __Pyx_GIVEREF(__pyx_t_5);
+    __pyx_t_5 = 0;
+    __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_n1);
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_n1, __pyx_t_1);
+    __Pyx_GIVEREF(__pyx_t_1);
+    __pyx_t_1 = 0;
+
+    /* "statmoments/_native.pyx":868
+ *       n0, n1 = [len(ts) for ts in traces_cl]
+ * 
  *       for _i in range(2):             # <<<<<<<<<<<<<<
  *         tr_set = traces_cl[_i]
- *         n, cm = len(tr_set), retm[_i]
+ *         nn = n0 if _i == 0 else n1
  */
-    for (__pyx_t_8 = 0; __pyx_t_8 < 2; __pyx_t_8+=1) {
-      __pyx_cur_scope->__pyx_v__i = __pyx_t_8;
+    for (__pyx_t_10 = 0; __pyx_t_10 < 2; __pyx_t_10+=1) {
+      __pyx_cur_scope->__pyx_v__i = __pyx_t_10;
 
-      /* "statmoments/_native.pyx":820
- *       traces_cl = [self.traces[cls0], self.traces[~cls0]]
+      /* "statmoments/_native.pyx":869
+ * 
  *       for _i in range(2):
  *         tr_set = traces_cl[_i]             # <<<<<<<<<<<<<<
- *         n, cm = len(tr_set), retm[_i]
- *         tr_set_mean = np.mean(tr_set, axis=0)
+ *         nn = n0 if _i == 0 else n1
+ *         if nn < min_cnt:
  */
       __pyx_t_6 = PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_traces_cl, __pyx_cur_scope->__pyx_v__i);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_tr_set);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_tr_set, __pyx_t_6);
       __Pyx_GIVEREF(__pyx_t_6);
       __pyx_t_6 = 0;
 
-      /* "statmoments/_native.pyx":821
+      /* "statmoments/_native.pyx":870
  *       for _i in range(2):
  *         tr_set = traces_cl[_i]
- *         n, cm = len(tr_set), retm[_i]             # <<<<<<<<<<<<<<
- *         tr_set_mean = np.mean(tr_set, axis=0)
- * 
- */
-      __pyx_t_9 = PyObject_Length(__pyx_cur_scope->__pyx_v_tr_set); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 821, __pyx_L1_error)
-      __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 821, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_5 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_retm, __pyx_cur_scope->__pyx_v__i, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 821, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_n);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_n, __pyx_t_6);
+ *         nn = n0 if _i == 0 else n1             # <<<<<<<<<<<<<<
+ *         if nn < min_cnt:
+ *           retm[_i, :len(moments)] = 0
+ */
+      if (((__pyx_cur_scope->__pyx_v__i == 0) != 0)) {
+        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_n0);
+        __pyx_t_6 = __pyx_cur_scope->__pyx_v_n0;
+      } else {
+        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_n1);
+        __pyx_t_6 = __pyx_cur_scope->__pyx_v_n1;
+      }
+      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_nn);
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_nn, __pyx_t_6);
       __Pyx_GIVEREF(__pyx_t_6);
       __pyx_t_6 = 0;
-      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_cm);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_cm, __pyx_t_5);
-      __Pyx_GIVEREF(__pyx_t_5);
-      __pyx_t_5 = 0;
 
-      /* "statmoments/_native.pyx":822
+      /* "statmoments/_native.pyx":871
  *         tr_set = traces_cl[_i]
- *         n, cm = len(tr_set), retm[_i]
- *         tr_set_mean = np.mean(tr_set, axis=0)             # <<<<<<<<<<<<<<
+ *         nn = n0 if _i == 0 else n1
+ *         if nn < min_cnt:             # <<<<<<<<<<<<<<
+ *           retm[_i, :len(moments)] = 0
+ *           continue
+ */
+      __pyx_t_6 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_nn, __pyx_cur_scope->__pyx_v_min_cnt, Py_LT); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 871, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 871, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      if (__pyx_t_11) {
+
+        /* "statmoments/_native.pyx":872
+ *         nn = n0 if _i == 0 else n1
+ *         if nn < min_cnt:
+ *           retm[_i, :len(moments)] = 0             # <<<<<<<<<<<<<<
+ *           continue
  * 
+ */
+        __pyx_t_6 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 872, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_6);
+        __pyx_t_8 = PyObject_Length(__pyx_cur_scope->__pyx_v_moments); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 872, __pyx_L1_error)
+        __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 872, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __pyx_t_5 = PySlice_New(Py_None, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 872, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 872, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __Pyx_GIVEREF(__pyx_t_6);
+        PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6);
+        __Pyx_GIVEREF(__pyx_t_5);
+        PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_5);
+        __pyx_t_6 = 0;
+        __pyx_t_5 = 0;
+        if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_1, __pyx_int_0) < 0)) __PYX_ERR(0, 872, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+
+        /* "statmoments/_native.pyx":873
+ *         if nn < min_cnt:
+ *           retm[_i, :len(moments)] = 0
+ *           continue             # <<<<<<<<<<<<<<
+ * 
+ *         cm = retm[_i]
+ */
+        goto __pyx_L8_continue;
+
+        /* "statmoments/_native.pyx":871
+ *         tr_set = traces_cl[_i]
+ *         nn = n0 if _i == 0 else n1
+ *         if nn < min_cnt:             # <<<<<<<<<<<<<<
+ *           retm[_i, :len(moments)] = 0
+ *           continue
+ */
+      }
+
+      /* "statmoments/_native.pyx":875
+ *           continue
+ * 
+ *         cm = retm[_i]             # <<<<<<<<<<<<<<
+ *         raw = np.mean(tr_set, axis=0)
  *         for jj, m in enumerate(moments):
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 822, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_mean); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 822, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 822, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_retm, __pyx_cur_scope->__pyx_v__i, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 875, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_cm);
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_cm, __pyx_t_1);
+      __Pyx_GIVEREF(__pyx_t_1);
+      __pyx_t_1 = 0;
+
+      /* "statmoments/_native.pyx":876
+ * 
+ *         cm = retm[_i]
+ *         raw = np.mean(tr_set, axis=0)             # <<<<<<<<<<<<<<
+ *         for jj, m in enumerate(moments):
+ *           if m == 1:
+ */
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 876, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_mean); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 876, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 876, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
       __Pyx_INCREF(__pyx_cur_scope->__pyx_v_tr_set);
       __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_tr_set);
-      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_cur_scope->__pyx_v_tr_set);
-      __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 822, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 822, __pyx_L1_error)
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 822, __pyx_L1_error)
+      PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_cur_scope->__pyx_v_tr_set);
+      __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 876, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 876, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 876, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_tr_set_mean);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_tr_set_mean, __pyx_t_2);
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_raw);
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_raw, __pyx_t_2);
       __Pyx_GIVEREF(__pyx_t_2);
       __pyx_t_2 = 0;
 
-      /* "statmoments/_native.pyx":824
- *         tr_set_mean = np.mean(tr_set, axis=0)
- * 
+      /* "statmoments/_native.pyx":877
+ *         cm = retm[_i]
+ *         raw = np.mean(tr_set, axis=0)
  *         for jj, m in enumerate(moments):             # <<<<<<<<<<<<<<
  *           if m == 1:
- *             cm[jj] = tr_set_mean
+ *             cm[jj] = raw
  */
       __Pyx_INCREF(__pyx_int_0);
       __pyx_t_2 = __pyx_int_0;
       if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_v_moments)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_moments)) {
-        __pyx_t_1 = __pyx_cur_scope->__pyx_v_moments; __Pyx_INCREF(__pyx_t_1); __pyx_t_9 = 0;
-        __pyx_t_10 = NULL;
+        __pyx_t_6 = __pyx_cur_scope->__pyx_v_moments; __Pyx_INCREF(__pyx_t_6); __pyx_t_8 = 0;
+        __pyx_t_12 = NULL;
       } else {
-        __pyx_t_9 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 824, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_10 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 824, __pyx_L1_error)
+        __pyx_t_8 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 877, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_6);
+        __pyx_t_12 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 877, __pyx_L1_error)
       }
       for (;;) {
-        if (likely(!__pyx_t_10)) {
-          if (likely(PyList_CheckExact(__pyx_t_1))) {
-            if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_1)) break;
+        if (likely(!__pyx_t_12)) {
+          if (likely(PyList_CheckExact(__pyx_t_6))) {
+            if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_6)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_5 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_9); __Pyx_INCREF(__pyx_t_5); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 824, __pyx_L1_error)
+            __pyx_t_1 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_8); __Pyx_INCREF(__pyx_t_1); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 877, __pyx_L1_error)
             #else
-            __pyx_t_5 = PySequence_ITEM(__pyx_t_1, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 824, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_5);
+            __pyx_t_1 = PySequence_ITEM(__pyx_t_6, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 877, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_1);
             #endif
           } else {
-            if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
+            if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_6)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_9); __Pyx_INCREF(__pyx_t_5); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 824, __pyx_L1_error)
+            __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_8); __Pyx_INCREF(__pyx_t_1); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 877, __pyx_L1_error)
             #else
-            __pyx_t_5 = PySequence_ITEM(__pyx_t_1, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 824, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_5);
+            __pyx_t_1 = PySequence_ITEM(__pyx_t_6, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 877, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_1);
             #endif
           }
         } else {
-          __pyx_t_5 = __pyx_t_10(__pyx_t_1);
-          if (unlikely(!__pyx_t_5)) {
+          __pyx_t_1 = __pyx_t_12(__pyx_t_6);
+          if (unlikely(!__pyx_t_1)) {
             PyObject* exc_type = PyErr_Occurred();
             if (exc_type) {
               if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-              else __PYX_ERR(0, 824, __pyx_L1_error)
+              else __PYX_ERR(0, 877, __pyx_L1_error)
             }
             break;
           }
-          __Pyx_GOTREF(__pyx_t_5);
+          __Pyx_GOTREF(__pyx_t_1);
         }
         __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_m);
-        __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_m, __pyx_t_5);
-        __Pyx_GIVEREF(__pyx_t_5);
-        __pyx_t_5 = 0;
+        __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_m, __pyx_t_1);
+        __Pyx_GIVEREF(__pyx_t_1);
+        __pyx_t_1 = 0;
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_jj);
         __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_jj, __pyx_t_2);
         __Pyx_GIVEREF(__pyx_t_2);
-        __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 824, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 877, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_2);
-        __pyx_t_2 = __pyx_t_5;
-        __pyx_t_5 = 0;
+        __pyx_t_2 = __pyx_t_1;
+        __pyx_t_1 = 0;
 
-        /* "statmoments/_native.pyx":825
- * 
+        /* "statmoments/_native.pyx":878
+ *         raw = np.mean(tr_set, axis=0)
  *         for jj, m in enumerate(moments):
  *           if m == 1:             # <<<<<<<<<<<<<<
- *             cm[jj] = tr_set_mean
+ *             cm[jj] = raw
  *           else:
  */
-        __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_cur_scope->__pyx_v_m, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 825, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 825, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_cur_scope->__pyx_v_m, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 878, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 878, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         if (__pyx_t_11) {
 
-          /* "statmoments/_native.pyx":826
+          /* "statmoments/_native.pyx":879
  *         for jj, m in enumerate(moments):
  *           if m == 1:
- *             cm[jj] = tr_set_mean             # <<<<<<<<<<<<<<
+ *             cm[jj] = raw             # <<<<<<<<<<<<<<
  *           else:
- *             np.sum((tr_set - tr_set_mean)**m, axis=0, out=cm[jj])
+ *             np.sum((tr_set - raw) ** m, axis=0, out=cm[jj])
  */
-          if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_cur_scope->__pyx_v_jj, __pyx_cur_scope->__pyx_v_tr_set_mean) < 0)) __PYX_ERR(0, 826, __pyx_L1_error)
+          if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_cur_scope->__pyx_v_jj, __pyx_cur_scope->__pyx_v_raw) < 0)) __PYX_ERR(0, 879, __pyx_L1_error)
 
-          /* "statmoments/_native.pyx":825
- * 
+          /* "statmoments/_native.pyx":878
+ *         raw = np.mean(tr_set, axis=0)
  *         for jj, m in enumerate(moments):
  *           if m == 1:             # <<<<<<<<<<<<<<
- *             cm[jj] = tr_set_mean
+ *             cm[jj] = raw
  *           else:
  */
-          goto __pyx_L10;
+          goto __pyx_L13;
         }
 
-        /* "statmoments/_native.pyx":828
- *             cm[jj] = tr_set_mean
+        /* "statmoments/_native.pyx":881
+ *             cm[jj] = raw
  *           else:
- *             np.sum((tr_set - tr_set_mean)**m, axis=0, out=cm[jj])             # <<<<<<<<<<<<<<
- *             dscal(1.0/n, cm[jj])
+ *             np.sum((tr_set - raw) ** m, axis=0, out=cm[jj])             # <<<<<<<<<<<<<<
+ *             dscal(1.0 / nn, cm[jj])
  *             if m >= 3 and normalize:
  */
         /*else*/ {
-          __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 828, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_5);
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sum); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 828, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_6);
-          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __pyx_t_5 = PyNumber_Subtract(__pyx_cur_scope->__pyx_v_tr_set, __pyx_cur_scope->__pyx_v_tr_set_mean); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 828, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_5);
-          __pyx_t_12 = PyNumber_Power(__pyx_t_5, __pyx_cur_scope->__pyx_v_m, Py_None); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 828, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_12);
-          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 828, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 881, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_1);
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 881, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
-          __Pyx_GIVEREF(__pyx_t_12);
-          PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_12);
-          __pyx_t_12 = 0;
-          __pyx_t_12 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 828, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_12);
-          if (PyDict_SetItem(__pyx_t_12, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 828, __pyx_L1_error)
-          __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_cur_scope->__pyx_v_jj); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 828, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+          __pyx_t_1 = PyNumber_Subtract(__pyx_cur_scope->__pyx_v_tr_set, __pyx_cur_scope->__pyx_v_raw); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 881, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_1);
+          __pyx_t_13 = PyNumber_Power(__pyx_t_1, __pyx_cur_scope->__pyx_v_m, Py_None); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 881, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_13);
-          if (PyDict_SetItem(__pyx_t_12, __pyx_n_s_out, __pyx_t_13) < 0) __PYX_ERR(0, 828, __pyx_L1_error)
-          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          __pyx_t_13 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_5, __pyx_t_12); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 828, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+          __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 881, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_1);
+          __Pyx_GIVEREF(__pyx_t_13);
+          PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_13);
+          __pyx_t_13 = 0;
+          __pyx_t_13 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 881, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_13);
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          if (PyDict_SetItem(__pyx_t_13, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 881, __pyx_L1_error)
+          __pyx_t_14 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_cur_scope->__pyx_v_jj); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 881, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_14);
+          if (PyDict_SetItem(__pyx_t_13, __pyx_n_s_out, __pyx_t_14) < 0) __PYX_ERR(0, 881, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
+          __pyx_t_14 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_13); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 881, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_14);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+          __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
 
-          /* "statmoments/_native.pyx":829
+          /* "statmoments/_native.pyx":882
  *           else:
- *             np.sum((tr_set - tr_set_mean)**m, axis=0, out=cm[jj])
- *             dscal(1.0/n, cm[jj])             # <<<<<<<<<<<<<<
+ *             np.sum((tr_set - raw) ** m, axis=0, out=cm[jj])
+ *             dscal(1.0 / nn, cm[jj])             # <<<<<<<<<<<<<<
  *             if m >= 3 and normalize:
- *               sd = np.sum((tr_set - tr_set_mean)**2, axis=0)
+ *               sd = np.sum((tr_set - raw) ** 2, axis=0)
  */
-          __pyx_t_13 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_cur_scope->__pyx_v_n, 1.0, 0, 1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 829, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_13);
-          __pyx_t_14 = __pyx_PyFloat_AsDouble(__pyx_t_13); if (unlikely((__pyx_t_14 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 829, __pyx_L1_error)
-          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_cur_scope->__pyx_v_jj); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 829, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_13);
-          __pyx_t_15 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_13, PyBUF_WRITABLE); if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 829, __pyx_L1_error)
-          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          __pyx_f_11statmoments_7_native_dscal(__pyx_t_14, __pyx_t_15);
-          __PYX_XDEC_MEMVIEW(&__pyx_t_15, 1);
-          __pyx_t_15.memview = NULL;
-          __pyx_t_15.data = NULL;
-
-          /* "statmoments/_native.pyx":830
- *             np.sum((tr_set - tr_set_mean)**m, axis=0, out=cm[jj])
- *             dscal(1.0/n, cm[jj])
+          __pyx_t_14 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_cur_scope->__pyx_v_nn, 1.0, 0, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 882, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_14);
+          __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_14); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 882, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
+          __pyx_t_14 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_cur_scope->__pyx_v_jj); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 882, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_14);
+          __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_14, PyBUF_WRITABLE); if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 882, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
+          __pyx_f_11statmoments_7_native_dscal(__pyx_t_15, __pyx_t_16);
+          __PYX_XDEC_MEMVIEW(&__pyx_t_16, 1);
+          __pyx_t_16.memview = NULL;
+          __pyx_t_16.data = NULL;
+
+          /* "statmoments/_native.pyx":883
+ *             np.sum((tr_set - raw) ** m, axis=0, out=cm[jj])
+ *             dscal(1.0 / nn, cm[jj])
  *             if m >= 3 and normalize:             # <<<<<<<<<<<<<<
- *               sd = np.sum((tr_set - tr_set_mean)**2, axis=0)
- *               dscal(1.0/n, sd)
+ *               sd = np.sum((tr_set - raw) ** 2, axis=0)
+ *               dscal(1.0 / nn, sd)
  */
-          __pyx_t_13 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_m, __pyx_int_3, Py_GE); __Pyx_XGOTREF(__pyx_t_13); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 830, __pyx_L1_error)
-          __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_13); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 830, __pyx_L1_error)
-          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          if (__pyx_t_16) {
+          __pyx_t_14 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_m, __pyx_int_3, Py_GE); __Pyx_XGOTREF(__pyx_t_14); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 883, __pyx_L1_error)
+          __pyx_t_17 = __Pyx_PyObject_IsTrue(__pyx_t_14); if (unlikely(__pyx_t_17 < 0)) __PYX_ERR(0, 883, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
+          if (__pyx_t_17) {
           } else {
-            __pyx_t_11 = __pyx_t_16;
-            goto __pyx_L12_bool_binop_done;
+            __pyx_t_11 = __pyx_t_17;
+            goto __pyx_L15_bool_binop_done;
           }
-          __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_normalize); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 830, __pyx_L1_error)
-          __pyx_t_11 = __pyx_t_16;
-          __pyx_L12_bool_binop_done:;
+          __pyx_t_17 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_normalize); if (unlikely(__pyx_t_17 < 0)) __PYX_ERR(0, 883, __pyx_L1_error)
+          __pyx_t_11 = __pyx_t_17;
+          __pyx_L15_bool_binop_done:;
           if (__pyx_t_11) {
 
-            /* "statmoments/_native.pyx":831
- *             dscal(1.0/n, cm[jj])
+            /* "statmoments/_native.pyx":884
+ *             dscal(1.0 / nn, cm[jj])
  *             if m >= 3 and normalize:
- *               sd = np.sum((tr_set - tr_set_mean)**2, axis=0)             # <<<<<<<<<<<<<<
- *               dscal(1.0/n, sd)
+ *               sd = np.sum((tr_set - raw) ** 2, axis=0)             # <<<<<<<<<<<<<<
+ *               dscal(1.0 / nn, sd)
  *               np.sqrt(sd, out=sd)
  */
-            __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 831, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_13);
-            __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_sum); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 831, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_12);
-            __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-            __pyx_t_13 = PyNumber_Subtract(__pyx_cur_scope->__pyx_v_tr_set, __pyx_cur_scope->__pyx_v_tr_set_mean); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 831, __pyx_L1_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 884, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_14);
+            __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_sum); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 884, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_13);
-            __pyx_t_5 = PyNumber_Power(__pyx_t_13, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 831, __pyx_L1_error)
+            __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
+            __pyx_t_14 = PyNumber_Subtract(__pyx_cur_scope->__pyx_v_tr_set, __pyx_cur_scope->__pyx_v_raw); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 884, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_14);
+            __pyx_t_1 = PyNumber_Power(__pyx_t_14, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 884, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_1);
+            __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
+            __pyx_t_14 = PyTuple_New(1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 884, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_14);
+            __Pyx_GIVEREF(__pyx_t_1);
+            PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_t_1);
+            __pyx_t_1 = 0;
+            __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 884, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_1);
+            if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 884, __pyx_L1_error)
+            __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_14, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 884, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-            __pyx_t_13 = PyTuple_New(1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 831, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_13);
+            __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
+            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+            __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_sd);
+            __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_sd, __pyx_t_5);
             __Pyx_GIVEREF(__pyx_t_5);
-            PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_5);
             __pyx_t_5 = 0;
-            __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 831, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_5);
-            if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 831, __pyx_L1_error)
-            __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_t_13, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 831, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_6);
-            __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-            __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-            __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-            __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_sd);
-            __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_sd, __pyx_t_6);
-            __Pyx_GIVEREF(__pyx_t_6);
-            __pyx_t_6 = 0;
 
-            /* "statmoments/_native.pyx":832
+            /* "statmoments/_native.pyx":885
  *             if m >= 3 and normalize:
- *               sd = np.sum((tr_set - tr_set_mean)**2, axis=0)
- *               dscal(1.0/n, sd)             # <<<<<<<<<<<<<<
+ *               sd = np.sum((tr_set - raw) ** 2, axis=0)
+ *               dscal(1.0 / nn, sd)             # <<<<<<<<<<<<<<
  *               np.sqrt(sd, out=sd)
  *               cm[jj] /= sd ** m
  */
-            __pyx_t_6 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_cur_scope->__pyx_v_n, 1.0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 832, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_6);
-            __pyx_t_14 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_14 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 832, __pyx_L1_error)
-            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-            __pyx_t_15 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_cur_scope->__pyx_v_sd, PyBUF_WRITABLE); if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 832, __pyx_L1_error)
-            __pyx_f_11statmoments_7_native_dscal(__pyx_t_14, __pyx_t_15);
-            __PYX_XDEC_MEMVIEW(&__pyx_t_15, 1);
-            __pyx_t_15.memview = NULL;
-            __pyx_t_15.data = NULL;
-
-            /* "statmoments/_native.pyx":833
- *               sd = np.sum((tr_set - tr_set_mean)**2, axis=0)
- *               dscal(1.0/n, sd)
+            __pyx_t_5 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_cur_scope->__pyx_v_nn, 1.0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 885, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_5);
+            __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_5); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 885, __pyx_L1_error)
+            __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+            __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_cur_scope->__pyx_v_sd, PyBUF_WRITABLE); if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 885, __pyx_L1_error)
+            __pyx_f_11statmoments_7_native_dscal(__pyx_t_15, __pyx_t_16);
+            __PYX_XDEC_MEMVIEW(&__pyx_t_16, 1);
+            __pyx_t_16.memview = NULL;
+            __pyx_t_16.data = NULL;
+
+            /* "statmoments/_native.pyx":886
+ *               sd = np.sum((tr_set - raw) ** 2, axis=0)
+ *               dscal(1.0 / nn, sd)
  *               np.sqrt(sd, out=sd)             # <<<<<<<<<<<<<<
  *               cm[jj] /= sd ** m
  * 
  */
-            __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 833, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_6);
-            __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 833, __pyx_L1_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 886, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_5);
+            __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 886, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_1);
+            __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+            __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 886, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_5);
-            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-            __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 833, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_6);
             __Pyx_INCREF(__pyx_cur_scope->__pyx_v_sd);
             __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_sd);
-            PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_cur_scope->__pyx_v_sd);
-            __pyx_t_13 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 833, __pyx_L1_error)
+            PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_cur_scope->__pyx_v_sd);
+            __pyx_t_14 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 886, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_14);
+            if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_out, __pyx_cur_scope->__pyx_v_sd) < 0) __PYX_ERR(0, 886, __pyx_L1_error)
+            __pyx_t_13 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_5, __pyx_t_14); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 886, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_13);
-            if (PyDict_SetItem(__pyx_t_13, __pyx_n_s_out, __pyx_cur_scope->__pyx_v_sd) < 0) __PYX_ERR(0, 833, __pyx_L1_error)
-            __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_6, __pyx_t_13); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 833, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_12);
+            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+            __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
             __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-            __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-            /* "statmoments/_native.pyx":834
- *               dscal(1.0/n, sd)
+            /* "statmoments/_native.pyx":887
+ *               dscal(1.0 / nn, sd)
  *               np.sqrt(sd, out=sd)
  *               cm[jj] /= sd ** m             # <<<<<<<<<<<<<<
  * 
  *       yield retm[:, :len(moments)]
  */
             __Pyx_INCREF(__pyx_cur_scope->__pyx_v_jj);
-            __pyx_t_12 = __pyx_cur_scope->__pyx_v_jj;
-            __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_12); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 834, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_13);
-            __pyx_t_6 = PyNumber_Power(__pyx_cur_scope->__pyx_v_sd, __pyx_cur_scope->__pyx_v_m, Py_None); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 834, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_6);
-            __pyx_t_5 = __Pyx_PyNumber_InPlaceDivide(__pyx_t_13, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 834, __pyx_L1_error)
+            __pyx_t_13 = __pyx_cur_scope->__pyx_v_jj;
+            __pyx_t_14 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_13); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 887, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_14);
+            __pyx_t_5 = PyNumber_Power(__pyx_cur_scope->__pyx_v_sd, __pyx_cur_scope->__pyx_v_m, Py_None); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 887, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_5);
-            __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-            if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_12, __pyx_t_5) < 0)) __PYX_ERR(0, 834, __pyx_L1_error)
+            __pyx_t_1 = __Pyx_PyNumber_InPlaceDivide(__pyx_t_14, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 887, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_1);
+            __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-            __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+            if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_13, __pyx_t_1) < 0)) __PYX_ERR(0, 887, __pyx_L1_error)
+            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+            __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
 
-            /* "statmoments/_native.pyx":830
- *             np.sum((tr_set - tr_set_mean)**m, axis=0, out=cm[jj])
- *             dscal(1.0/n, cm[jj])
+            /* "statmoments/_native.pyx":883
+ *             np.sum((tr_set - raw) ** m, axis=0, out=cm[jj])
+ *             dscal(1.0 / nn, cm[jj])
  *             if m >= 3 and normalize:             # <<<<<<<<<<<<<<
- *               sd = np.sum((tr_set - tr_set_mean)**2, axis=0)
- *               dscal(1.0/n, sd)
+ *               sd = np.sum((tr_set - raw) ** 2, axis=0)
+ *               dscal(1.0 / nn, sd)
  */
           }
         }
-        __pyx_L10:;
+        __pyx_L13:;
+
+        /* "statmoments/_native.pyx":877
+ *         cm = retm[_i]
+ *         raw = np.mean(tr_set, axis=0)
+ *         for jj, m in enumerate(moments):             # <<<<<<<<<<<<<<
+ *           if m == 1:
+ *             cm[jj] = raw
+ */
+      }
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_L8_continue:;
+    }
+
+    /* "statmoments/_native.pyx":889
+ *               cm[jj] /= sd ** m
+ * 
+ *       yield retm[:, :len(moments)]             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+    __pyx_t_8 = PyObject_Length(__pyx_cur_scope->__pyx_v_moments); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 889, __pyx_L1_error)
+    __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 889, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_6 = PySlice_New(Py_None, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 889, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 889, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_INCREF(__pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_slice__7);
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_t_6);
+    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_6);
+    __pyx_t_6 = 0;
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 889, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_r = __pyx_t_6;
+    __pyx_t_6 = 0;
+    __pyx_cur_scope->__pyx_t_0 = __pyx_t_3;
+    __Pyx_XGIVEREF(__pyx_t_4);
+    __pyx_cur_scope->__pyx_t_1 = __pyx_t_4;
+    __pyx_cur_scope->__pyx_t_2 = __pyx_t_7;
+    __Pyx_XGIVEREF(__pyx_r);
+    __Pyx_RefNannyFinishContext();
+    __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
+    /* return from generator, yielding value */
+    __pyx_generator->resume_label = 1;
+    return __pyx_r;
+    __pyx_L17_resume_from_yield:;
+    __pyx_t_3 = __pyx_cur_scope->__pyx_t_0;
+    __pyx_t_4 = __pyx_cur_scope->__pyx_t_1;
+    __pyx_cur_scope->__pyx_t_1 = 0;
+    __Pyx_XGOTREF(__pyx_t_4);
+    __pyx_t_7 = __pyx_cur_scope->__pyx_t_2;
+    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 889, __pyx_L1_error)
+
+    /* "statmoments/_native.pyx":863
+ *     retm = np.empty((2, len(moments), tr_len), dtype=np.float64)
+ * 
+ *     for ii in range(cl_len):             # <<<<<<<<<<<<<<
+ *       cls0 = (self.cls[:, ii] == 0)
+ *       traces_cl = [self.traces[cls0], self.traces[~cls0]]
+ */
+  }
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
+
+  /* "statmoments/_native.pyx":855
+ *     return self.total_count - c1, c1
+ * 
+ *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
+ *     min_cnt = self.acc_min_count
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len
+ */
+
+  /* function exit code */
+  PyErr_SetNone(PyExc_StopIteration);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_13);
+  __Pyx_XDECREF(__pyx_t_14);
+  __PYX_XDEC_MEMVIEW(&__pyx_t_16, 1);
+  __Pyx_AddTraceback("_moments", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_L0:;
+  __Pyx_XDECREF(__pyx_r); __pyx_r = 0;
+  #if !CYTHON_USE_EXC_INFO_STACK
+  __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
+  #endif
+  __pyx_generator->resume_label = -1;
+  __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "statmoments/_native.pyx":894
+ * class bivar_2pass(_BivarNpassBase):
+ *   @staticmethod
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *     mem_base  = _BivarNpassBase.estimate_mem_size(tr_len, cl_len, moment)
+ *     # One additional square for std normalization for moments > 2
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_11statmoments_7_native_11bivar_2pass_1estimate_mem_size(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_11statmoments_7_native_11bivar_2pass_1estimate_mem_size = {"estimate_mem_size", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_11bivar_2pass_1estimate_mem_size, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11statmoments_7_native_11bivar_2pass_1estimate_mem_size(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyObject *__pyx_v_tr_len = 0;
+  PyObject *__pyx_v_cl_len = 0;
+  PyObject *__pyx_v_moment = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("estimate_mem_size (wrapper)", 0);
+  {
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_tr_len,&__pyx_n_s_cl_len,&__pyx_n_s_moment,0};
+    PyObject* values[3] = {0,0,0};
+    values[1] = ((PyObject *)((PyObject *)__pyx_int_1));
+    values[2] = ((PyObject *)((PyObject *)__pyx_int_2));
+    if (unlikely(__pyx_kwds)) {
+      Py_ssize_t kw_args;
+      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
+      switch (pos_args) {
+        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+        CYTHON_FALLTHROUGH;
+        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+        CYTHON_FALLTHROUGH;
+        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        CYTHON_FALLTHROUGH;
+        case  0: break;
+        default: goto __pyx_L5_argtuple_error;
+      }
+      kw_args = PyDict_Size(__pyx_kwds);
+      switch (pos_args) {
+        case  0:
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr_len)) != 0)) kw_args--;
+        else goto __pyx_L5_argtuple_error;
+        CYTHON_FALLTHROUGH;
+        case  1:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_cl_len);
+          if (value) { values[1] = value; kw_args--; }
+        }
+        CYTHON_FALLTHROUGH;
+        case  2:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moment);
+          if (value) { values[2] = value; kw_args--; }
+        }
+      }
+      if (unlikely(kw_args > 0)) {
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "estimate_mem_size") < 0)) __PYX_ERR(0, 894, __pyx_L3_error)
+      }
+    } else {
+      switch (PyTuple_GET_SIZE(__pyx_args)) {
+        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+        CYTHON_FALLTHROUGH;
+        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+        CYTHON_FALLTHROUGH;
+        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        break;
+        default: goto __pyx_L5_argtuple_error;
+      }
+    }
+    __pyx_v_tr_len = values[0];
+    __pyx_v_cl_len = values[1];
+    __pyx_v_moment = values[2];
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("estimate_mem_size", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 894, __pyx_L3_error)
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("statmoments._native.bivar_2pass.estimate_mem_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __pyx_r = __pyx_pf_11statmoments_7_native_11bivar_2pass_estimate_mem_size(__pyx_self, __pyx_v_tr_len, __pyx_v_cl_len, __pyx_v_moment);
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_11statmoments_7_native_11bivar_2pass_estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tr_len, PyObject *__pyx_v_cl_len, PyObject *__pyx_v_moment) {
+  PyObject *__pyx_v_mem_base = NULL;
+  PyObject *__pyx_v_mem_ttstd = NULL;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  int __pyx_t_4;
+  PyObject *__pyx_t_5 = NULL;
+  int __pyx_t_6;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("estimate_mem_size", 0);
+
+  /* "statmoments/_native.pyx":895
+ *   @staticmethod
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):
+ *     mem_base  = _BivarNpassBase.estimate_mem_size(tr_len, cl_len, moment)             # <<<<<<<<<<<<<<
+ *     # One additional square for std normalization for moments > 2
+ *     mem_ttstd = 0  if moment < 3 else tr_len + tr_len ** 2
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BivarNpassBase); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 895, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_estimate_mem_size); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 895, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = NULL;
+  __pyx_t_4 = 0;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
+    if (likely(__pyx_t_2)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+      __Pyx_INCREF(__pyx_t_2);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_3, function);
+      __pyx_t_4 = 1;
+    }
+  }
+  #if CYTHON_FAST_PYCALL
+  if (PyFunction_Check(__pyx_t_3)) {
+    PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_v_tr_len, __pyx_v_cl_len, __pyx_v_moment};
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 895, __pyx_L1_error)
+    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_GOTREF(__pyx_t_1);
+  } else
+  #endif
+  #if CYTHON_FAST_PYCCALL
+  if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
+    PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_v_tr_len, __pyx_v_cl_len, __pyx_v_moment};
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 895, __pyx_L1_error)
+    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_GOTREF(__pyx_t_1);
+  } else
+  #endif
+  {
+    __pyx_t_5 = PyTuple_New(3+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 895, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    if (__pyx_t_2) {
+      __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
+    }
+    __Pyx_INCREF(__pyx_v_tr_len);
+    __Pyx_GIVEREF(__pyx_v_tr_len);
+    PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_4, __pyx_v_tr_len);
+    __Pyx_INCREF(__pyx_v_cl_len);
+    __Pyx_GIVEREF(__pyx_v_cl_len);
+    PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_4, __pyx_v_cl_len);
+    __Pyx_INCREF(__pyx_v_moment);
+    __Pyx_GIVEREF(__pyx_v_moment);
+    PyTuple_SET_ITEM(__pyx_t_5, 2+__pyx_t_4, __pyx_v_moment);
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 895, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  }
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_mem_base = __pyx_t_1;
+  __pyx_t_1 = 0;
+
+  /* "statmoments/_native.pyx":897
+ *     mem_base  = _BivarNpassBase.estimate_mem_size(tr_len, cl_len, moment)
+ *     # One additional square for std normalization for moments > 2
+ *     mem_ttstd = 0  if moment < 3 else tr_len + tr_len ** 2             # <<<<<<<<<<<<<<
+ *     return mem_base + mem_ttstd * 8
+ * 
+ */
+  __pyx_t_3 = PyObject_RichCompare(__pyx_v_moment, __pyx_int_3, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 897, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 897, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (__pyx_t_6) {
+    __Pyx_INCREF(__pyx_int_0);
+    __pyx_t_1 = __pyx_int_0;
+  } else {
+    __pyx_t_3 = PyNumber_Power(__pyx_v_tr_len, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 897, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_5 = PyNumber_Add(__pyx_v_tr_len, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 897, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_1 = __pyx_t_5;
+    __pyx_t_5 = 0;
+  }
+  __pyx_v_mem_ttstd = __pyx_t_1;
+  __pyx_t_1 = 0;
+
+  /* "statmoments/_native.pyx":898
+ *     # One additional square for std normalization for moments > 2
+ *     mem_ttstd = 0  if moment < 3 else tr_len + tr_len ** 2
+ *     return mem_base + mem_ttstd * 8             # <<<<<<<<<<<<<<
+ * 
+ *   def memory_size(self):
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_mem_ttstd, __pyx_int_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 898, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_5 = PyNumber_Add(__pyx_v_mem_base, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 898, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_r = __pyx_t_5;
+  __pyx_t_5 = 0;
+  goto __pyx_L0;
+
+  /* "statmoments/_native.pyx":894
+ * class bivar_2pass(_BivarNpassBase):
+ *   @staticmethod
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *     mem_base  = _BivarNpassBase.estimate_mem_size(tr_len, cl_len, moment)
+ *     # One additional square for std normalization for moments > 2
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_AddTraceback("statmoments._native.bivar_2pass.estimate_mem_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XDECREF(__pyx_v_mem_base);
+  __Pyx_XDECREF(__pyx_v_mem_ttstd);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "statmoments/_native.pyx":900
+ *     return mem_base + mem_ttstd * 8
+ * 
+ *   def memory_size(self):             # <<<<<<<<<<<<<<
+ *     mem_base = super().memory_size()
+ *     # One additional square for std normalization for moments > 2
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_11statmoments_7_native_11bivar_2pass_3memory_size(PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
+static PyMethodDef __pyx_mdef_11statmoments_7_native_11bivar_2pass_3memory_size = {"memory_size", (PyCFunction)__pyx_pw_11statmoments_7_native_11bivar_2pass_3memory_size, METH_O, 0};
+static PyObject *__pyx_pw_11statmoments_7_native_11bivar_2pass_3memory_size(PyObject *__pyx_self, PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("memory_size (wrapper)", 0);
+  __pyx_r = __pyx_pf_11statmoments_7_native_11bivar_2pass_2memory_size(__pyx_self, ((PyObject *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_11statmoments_7_native_11bivar_2pass_2memory_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
+  PyObject *__pyx_v_mem_base = NULL;
+  PyObject *__pyx_v_mem_ttstd = NULL;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  int __pyx_t_4;
+  PyObject *__pyx_t_5 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("memory_size", 0);
 
-        /* "statmoments/_native.pyx":824
- *         tr_set_mean = np.mean(tr_set, axis=0)
+  /* "statmoments/_native.pyx":901
  * 
- *         for jj, m in enumerate(moments):             # <<<<<<<<<<<<<<
- *           if m == 1:
- *             cm[jj] = tr_set_mean
+ *   def memory_size(self):
+ *     mem_base = super().memory_size()             # <<<<<<<<<<<<<<
+ *     # One additional square for std normalization for moments > 2
+ *     mem_ttstd = 0  if self.moment < 3 else self.trace_len + self.trace_len ** 2
  */
-      }
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_CyFunction_GetClassObj(__pyx_self);
+  if (!__pyx_t_2) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 901, __pyx_L1_error) }
+  __Pyx_INCREF(__pyx_t_2);
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 901, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
+  __Pyx_INCREF(__pyx_v_self);
+  __Pyx_GIVEREF(__pyx_v_self);
+  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_self);
+  __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 901, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_memory_size); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 901, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = NULL;
+  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
+    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
+    if (likely(__pyx_t_2)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+      __Pyx_INCREF(__pyx_t_2);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_3, function);
     }
+  }
+  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 901, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_mem_base = __pyx_t_1;
+  __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":836
- *               cm[jj] /= sd ** m
+  /* "statmoments/_native.pyx":903
+ *     mem_base = super().memory_size()
+ *     # One additional square for std normalization for moments > 2
+ *     mem_ttstd = 0  if self.moment < 3 else self.trace_len + self.trace_len ** 2             # <<<<<<<<<<<<<<
+ *     return mem_base + mem_ttstd * 8
  * 
- *       yield retm[:, :len(moments)]             # <<<<<<<<<<<<<<
- * 
- * class bivar_2pass(_BivarNpassBase):
  */
-    __pyx_t_9 = PyObject_Length(__pyx_cur_scope->__pyx_v_moments); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 836, __pyx_L1_error)
-    __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 836, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = PySlice_New(Py_None, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 836, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 836, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 903, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = PyObject_RichCompare(__pyx_t_3, __pyx_int_3, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 903, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (__pyx_t_4) {
+    __Pyx_INCREF(__pyx_int_0);
+    __pyx_t_1 = __pyx_int_0;
+  } else {
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_INCREF(__pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_slice__5);
-    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_t_1);
-    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1);
-    __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 836, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 903, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_5 = PyNumber_Power(__pyx_t_3, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 903, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_3 = PyNumber_Add(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 903, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_r = __pyx_t_1;
-    __pyx_t_1 = 0;
-    __pyx_cur_scope->__pyx_t_0 = __pyx_t_3;
-    __Pyx_XGIVEREF(__pyx_t_4);
-    __pyx_cur_scope->__pyx_t_1 = __pyx_t_4;
-    __pyx_cur_scope->__pyx_t_2 = __pyx_t_7;
-    __Pyx_XGIVEREF(__pyx_r);
-    __Pyx_RefNannyFinishContext();
-    __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
-    /* return from generator, yielding value */
-    __pyx_generator->resume_label = 1;
-    return __pyx_r;
-    __pyx_L14_resume_from_yield:;
-    __pyx_t_3 = __pyx_cur_scope->__pyx_t_0;
-    __pyx_t_4 = __pyx_cur_scope->__pyx_t_1;
-    __pyx_cur_scope->__pyx_t_1 = 0;
-    __Pyx_XGOTREF(__pyx_t_4);
-    __pyx_t_7 = __pyx_cur_scope->__pyx_t_2;
-    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 836, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_1 = __pyx_t_3;
+    __pyx_t_3 = 0;
+  }
+  __pyx_v_mem_ttstd = __pyx_t_1;
+  __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":816
- *     retm = np.empty((2, len(moments), tr_len), dtype=np.float64)
+  /* "statmoments/_native.pyx":904
+ *     # One additional square for std normalization for moments > 2
+ *     mem_ttstd = 0  if self.moment < 3 else self.trace_len + self.trace_len ** 2
+ *     return mem_base + mem_ttstd * 8             # <<<<<<<<<<<<<<
  * 
- *     for ii in range(cl_len):             # <<<<<<<<<<<<<<
- *       cls0 = (self.cls[:,ii] == 0)
- *       traces_cl = [self.traces[cls0], self.traces[~cls0]]
+ *   def _comoments(self, moments, normalize):
  */
-  }
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_mem_ttstd, __pyx_int_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 904, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = PyNumber_Add(__pyx_v_mem_base, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 904, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_r = __pyx_t_3;
+  __pyx_t_3 = 0;
+  goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":809
- *     return self.total_count - c1, c1
- * 
- *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
- *     tr_len, cl_len = self.trace_len, self.classifiers_len
+  /* "statmoments/_native.pyx":900
+ *     return mem_base + mem_ttstd * 8
  * 
+ *   def memory_size(self):             # <<<<<<<<<<<<<<
+ *     mem_base = super().memory_size()
+ *     # One additional square for std normalization for moments > 2
  */
 
   /* function exit code */
-  PyErr_SetNone(PyExc_StopIteration);
-  goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_6);
-  __Pyx_XDECREF(__pyx_t_12);
-  __Pyx_XDECREF(__pyx_t_13);
-  __PYX_XDEC_MEMVIEW(&__pyx_t_15, 1);
-  __Pyx_AddTraceback("_moments", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("statmoments._native.bivar_2pass.memory_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
   __pyx_L0:;
-  __Pyx_XDECREF(__pyx_r); __pyx_r = 0;
-  #if !CYTHON_USE_EXC_INFO_STACK
-  __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
-  #endif
-  __pyx_generator->resume_label = -1;
-  __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
+  __Pyx_XDECREF(__pyx_v_mem_base);
+  __Pyx_XDECREF(__pyx_v_mem_ttstd);
+  __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
-static PyObject *__pyx_gb_11statmoments_7_native_11bivar_2pass_2generator6(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
+static PyObject *__pyx_gb_11statmoments_7_native_11bivar_2pass_6generator6(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "statmoments/_native.pyx":839
+/* "statmoments/_native.pyx":906
+ *     return mem_base + mem_ttstd * 8
  * 
- * class bivar_2pass(_BivarNpassBase):
  *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
- *     C = self._tmpsq
- *     tr_len, cl_len = self.trace_len, self.cls.shape[1]
+ *     min_cnt, C = self.acc_min_count, self._tmpsq
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11statmoments_7_native_11bivar_2pass_1_comoments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_11statmoments_7_native_11bivar_2pass_1_comoments = {"_comoments", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_11bivar_2pass_1_comoments, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11statmoments_7_native_11bivar_2pass_1_comoments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_11statmoments_7_native_11bivar_2pass_5_comoments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_11statmoments_7_native_11bivar_2pass_5_comoments = {"_comoments", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_11bivar_2pass_5_comoments, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11statmoments_7_native_11bivar_2pass_5_comoments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_moments = 0;
   PyObject *__pyx_v_normalize = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
@@ -28579,79 +29544,79 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moments)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, 1); __PYX_ERR(0, 839, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, 1); __PYX_ERR(0, 906, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_normalize)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, 2); __PYX_ERR(0, 839, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, 2); __PYX_ERR(0, 906, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_comoments") < 0)) __PYX_ERR(0, 839, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_comoments") < 0)) __PYX_ERR(0, 906, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_moments = values[1];
     __pyx_v_normalize = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 839, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 906, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native.bivar_2pass._comoments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11statmoments_7_native_11bivar_2pass__comoments(__pyx_self, __pyx_v_self, __pyx_v_moments, __pyx_v_normalize);
+  __pyx_r = __pyx_pf_11statmoments_7_native_11bivar_2pass_4_comoments(__pyx_self, __pyx_v_self, __pyx_v_moments, __pyx_v_normalize);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11statmoments_7_native_11bivar_2pass__comoments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize) {
+static PyObject *__pyx_pf_11statmoments_7_native_11bivar_2pass_4_comoments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize) {
   struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_13__comoments *__pyx_cur_scope;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_comoments", 0);
   __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_13__comoments *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_13__comoments(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_13__comoments, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_13__comoments *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 839, __pyx_L1_error)
+    __PYX_ERR(0, 906, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
   __pyx_cur_scope->__pyx_v_moments = __pyx_v_moments;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_moments);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_moments);
   __pyx_cur_scope->__pyx_v_normalize = __pyx_v_normalize;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_normalize);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_normalize);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_11bivar_2pass_2generator6, __pyx_codeobj__35, (PyObject *) __pyx_cur_scope, __pyx_n_s_comoments, __pyx_n_s_bivar_2pass__comoments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 839, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_11bivar_2pass_6generator6, __pyx_codeobj__34, (PyObject *) __pyx_cur_scope, __pyx_n_s_comoments, __pyx_n_s_bivar_2pass__comoments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 906, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -28659,33 +29624,33 @@
   __pyx_r = NULL;
   __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_gb_11statmoments_7_native_11bivar_2pass_2generator6(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
+static PyObject *__pyx_gb_11statmoments_7_native_11bivar_2pass_6generator6(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
 {
   struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_13__comoments *__pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_13__comoments *)__pyx_generator->closure);
   PyObject *__pyx_r = NULL;
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
-  Py_ssize_t __pyx_t_4;
-  PyObject *(*__pyx_t_5)(PyObject *);
-  long __pyx_t_6;
+  Py_ssize_t __pyx_t_3;
+  PyObject *(*__pyx_t_4)(PyObject *);
+  long __pyx_t_5;
+  PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
   PyObject *__pyx_t_10 = NULL;
   int __pyx_t_11;
   PyObject *(*__pyx_t_12)(PyObject *);
-  Py_ssize_t __pyx_t_13;
-  PyObject *(*__pyx_t_14)(PyObject *);
-  int __pyx_t_15;
+  int __pyx_t_13;
+  Py_ssize_t __pyx_t_14;
+  PyObject *(*__pyx_t_15)(PyObject *);
   __Pyx_memviewslice __pyx_t_16 = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_t_17 = { 0, 0, { 0 }, { 0 }, { 0 } };
   struct __pyx_opt_args_11statmoments_7_native_dsyrk __pyx_t_18;
   __Pyx_memviewslice __pyx_t_19 = { 0, 0, { 0 }, { 0 }, { 0 } };
   struct __pyx_opt_args_11statmoments_7_native_dgemm __pyx_t_20;
   int __pyx_t_21;
   PyObject *__pyx_t_22 = NULL;
@@ -28696,500 +29661,538 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("_comoments", 0);
   switch (__pyx_generator->resume_label) {
     case 0: goto __pyx_L3_first_run;
-    case 1: goto __pyx_L18_resume_from_yield;
+    case 1: goto __pyx_L19_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 839, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 906, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":840
- * class bivar_2pass(_BivarNpassBase):
+  /* "statmoments/_native.pyx":907
+ * 
  *   def _comoments(self, moments, normalize):
- *     C = self._tmpsq             # <<<<<<<<<<<<<<
- *     tr_len, cl_len = self.trace_len, self.cls.shape[1]
+ *     min_cnt, C = self.acc_min_count, self._tmpsq             # <<<<<<<<<<<<<<
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len
  *     for ii in range(cl_len):
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_tmpsq); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 840, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_acc_min_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 907, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_tmpsq); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 907, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
-  __pyx_cur_scope->__pyx_v_C = __pyx_t_1;
+  __pyx_cur_scope->__pyx_v_min_cnt = __pyx_t_1;
   __pyx_t_1 = 0;
+  __Pyx_GIVEREF(__pyx_t_2);
+  __pyx_cur_scope->__pyx_v_C = __pyx_t_2;
+  __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":841
+  /* "statmoments/_native.pyx":908
  *   def _comoments(self, moments, normalize):
- *     C = self._tmpsq
- *     tr_len, cl_len = self.trace_len, self.cls.shape[1]             # <<<<<<<<<<<<<<
+ *     min_cnt, C = self.acc_min_count, self._tmpsq
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len             # <<<<<<<<<<<<<<
  *     for ii in range(cl_len):
  *       for _i in range(2):
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 841, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_cls); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 841, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 841, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 841, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_GIVEREF(__pyx_t_1);
-  __pyx_cur_scope->__pyx_v_tr_len = __pyx_t_1;
-  __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_classifiers_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_cur_scope->__pyx_v_cl_len = __pyx_t_2;
+  __pyx_cur_scope->__pyx_v_tr_len = __pyx_t_2;
   __pyx_t_2 = 0;
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_cur_scope->__pyx_v_cl_len = __pyx_t_1;
+  __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":842
- *     C = self._tmpsq
- *     tr_len, cl_len = self.trace_len, self.cls.shape[1]
+  /* "statmoments/_native.pyx":909
+ *     min_cnt, C = self.acc_min_count, self._tmpsq
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len
  *     for ii in range(cl_len):             # <<<<<<<<<<<<<<
  *       for _i in range(2):
- *         mft = _sort_meanfree(self.traces[self.cls[:,ii] == _i], False)
+ *         mft = _sort_meanfree(self.traces[self.cls[:, ii] == _i], False)
  */
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_cur_scope->__pyx_v_cl_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 842, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
-    __pyx_t_1 = __pyx_t_2; __Pyx_INCREF(__pyx_t_1); __pyx_t_4 = 0;
-    __pyx_t_5 = NULL;
+  __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_cur_scope->__pyx_v_cl_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 909, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
+    __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
+    __pyx_t_4 = NULL;
   } else {
-    __pyx_t_4 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 842, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 842, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 909, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 909, __pyx_L1_error)
   }
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
-    if (likely(!__pyx_t_5)) {
-      if (likely(PyList_CheckExact(__pyx_t_1))) {
-        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_1)) break;
+    if (likely(!__pyx_t_4)) {
+      if (likely(PyList_CheckExact(__pyx_t_2))) {
+        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 842, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 909, __pyx_L1_error)
         #else
-        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 842, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 909, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
-        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
+        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 842, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 909, __pyx_L1_error)
         #else
-        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 842, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 909, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
-      __pyx_t_2 = __pyx_t_5(__pyx_t_1);
-      if (unlikely(!__pyx_t_2)) {
+      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
+      if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 842, __pyx_L1_error)
+          else __PYX_ERR(0, 909, __pyx_L1_error)
         }
         break;
       }
-      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_ii);
-    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_ii, __pyx_t_2);
-    __Pyx_GIVEREF(__pyx_t_2);
-    __pyx_t_2 = 0;
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_ii, __pyx_t_1);
+    __Pyx_GIVEREF(__pyx_t_1);
+    __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":843
- *     tr_len, cl_len = self.trace_len, self.cls.shape[1]
+    /* "statmoments/_native.pyx":910
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len
  *     for ii in range(cl_len):
  *       for _i in range(2):             # <<<<<<<<<<<<<<
- *         mft = _sort_meanfree(self.traces[self.cls[:,ii] == _i], False)
+ *         mft = _sort_meanfree(self.traces[self.cls[:, ii] == _i], False)
  *         m, n = mft.shape
  */
-    for (__pyx_t_6 = 0; __pyx_t_6 < 2; __pyx_t_6+=1) {
-      __pyx_cur_scope->__pyx_v__i = __pyx_t_6;
+    for (__pyx_t_5 = 0; __pyx_t_5 < 2; __pyx_t_5+=1) {
+      __pyx_cur_scope->__pyx_v__i = __pyx_t_5;
 
-      /* "statmoments/_native.pyx":844
+      /* "statmoments/_native.pyx":911
  *     for ii in range(cl_len):
  *       for _i in range(2):
- *         mft = _sort_meanfree(self.traces[self.cls[:,ii] == _i], False)             # <<<<<<<<<<<<<<
+ *         mft = _sort_meanfree(self.traces[self.cls[:, ii] == _i], False)             # <<<<<<<<<<<<<<
  *         m, n = mft.shape
- *         triuflatten = _triuflatten_gen(n)
+ *         retm = self._retm[_i]
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_sort_meanfree); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 844, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_traces); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 844, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_sort_meanfree); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 911, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_traces); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 911, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_cls); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 844, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_cls); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 911, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
-      __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 844, __pyx_L1_error)
+      __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 911, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __Pyx_INCREF(__pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_slice__5);
-      PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_slice__5);
+      __Pyx_INCREF(__pyx_slice__7);
+      __Pyx_GIVEREF(__pyx_slice__7);
+      PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_slice__7);
       __Pyx_INCREF(__pyx_cur_scope->__pyx_v_ii);
       __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_ii);
       PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_cur_scope->__pyx_v_ii);
-      __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 844, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 911, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 844, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 911, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_8 = PyObject_RichCompare(__pyx_t_10, __pyx_t_9, Py_EQ); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 844, __pyx_L1_error)
+      __pyx_t_8 = PyObject_RichCompare(__pyx_t_10, __pyx_t_9, Py_EQ); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 911, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 844, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 911, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __pyx_t_8 = NULL;
       __pyx_t_11 = 0;
-      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
-        __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_3);
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
+        __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_6);
         if (likely(__pyx_t_8)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
           __Pyx_INCREF(__pyx_t_8);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_3, function);
+          __Pyx_DECREF_SET(__pyx_t_6, function);
           __pyx_t_11 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
-      if (PyFunction_Check(__pyx_t_3)) {
+      if (PyFunction_Check(__pyx_t_6)) {
         PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_t_9, Py_False};
-        __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 844, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 911, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
-      if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_6)) {
         PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_t_9, Py_False};
-        __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 844, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 911, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       } else
       #endif
       {
-        __pyx_t_7 = PyTuple_New(2+__pyx_t_11); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 844, __pyx_L1_error)
+        __pyx_t_7 = PyTuple_New(2+__pyx_t_11); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 911, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         if (__pyx_t_8) {
           __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_8); __pyx_t_8 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_9);
         PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_11, __pyx_t_9);
         __Pyx_INCREF(Py_False);
         __Pyx_GIVEREF(Py_False);
         PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_11, Py_False);
         __pyx_t_9 = 0;
-        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 844, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 911, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       }
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_mft);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_mft, __pyx_t_2);
-      __Pyx_GIVEREF(__pyx_t_2);
-      __pyx_t_2 = 0;
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_mft, __pyx_t_1);
+      __Pyx_GIVEREF(__pyx_t_1);
+      __pyx_t_1 = 0;
 
-      /* "statmoments/_native.pyx":845
+      /* "statmoments/_native.pyx":912
  *       for _i in range(2):
- *         mft = _sort_meanfree(self.traces[self.cls[:,ii] == _i], False)
+ *         mft = _sort_meanfree(self.traces[self.cls[:, ii] == _i], False)
  *         m, n = mft.shape             # <<<<<<<<<<<<<<
- *         triuflatten = _triuflatten_gen(n)
  *         retm = self._retm[_i]
+ *         triuflatten = _triuflatten_gen(n)
  */
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_mft, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 845, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      if ((likely(PyTuple_CheckExact(__pyx_t_2))) || (PyList_CheckExact(__pyx_t_2))) {
-        PyObject* sequence = __pyx_t_2;
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_mft, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 912, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
+        PyObject* sequence = __pyx_t_1;
         Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
         if (unlikely(size != 2)) {
           if (size > 2) __Pyx_RaiseTooManyValuesError(2);
           else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-          __PYX_ERR(0, 845, __pyx_L1_error)
+          __PYX_ERR(0, 912, __pyx_L1_error)
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
         if (likely(PyTuple_CheckExact(sequence))) {
-          __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
+          __pyx_t_6 = PyTuple_GET_ITEM(sequence, 0); 
           __pyx_t_7 = PyTuple_GET_ITEM(sequence, 1); 
         } else {
-          __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
+          __pyx_t_6 = PyList_GET_ITEM(sequence, 0); 
           __pyx_t_7 = PyList_GET_ITEM(sequence, 1); 
         }
-        __Pyx_INCREF(__pyx_t_3);
+        __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_7);
         #else
-        __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 845, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_7 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 845, __pyx_L1_error)
+        __pyx_t_6 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 912, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_6);
+        __pyx_t_7 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 912, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         #endif
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       } else {
         Py_ssize_t index = -1;
-        __pyx_t_9 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 845, __pyx_L1_error)
+        __pyx_t_9 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 912, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __pyx_t_12 = Py_TYPE(__pyx_t_9)->tp_iternext;
-        index = 0; __pyx_t_3 = __pyx_t_12(__pyx_t_9); if (unlikely(!__pyx_t_3)) goto __pyx_L8_unpacking_failed;
-        __Pyx_GOTREF(__pyx_t_3);
+        index = 0; __pyx_t_6 = __pyx_t_12(__pyx_t_9); if (unlikely(!__pyx_t_6)) goto __pyx_L8_unpacking_failed;
+        __Pyx_GOTREF(__pyx_t_6);
         index = 1; __pyx_t_7 = __pyx_t_12(__pyx_t_9); if (unlikely(!__pyx_t_7)) goto __pyx_L8_unpacking_failed;
         __Pyx_GOTREF(__pyx_t_7);
-        if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_9), 2) < 0) __PYX_ERR(0, 845, __pyx_L1_error)
+        if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_9), 2) < 0) __PYX_ERR(0, 912, __pyx_L1_error)
         __pyx_t_12 = NULL;
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         goto __pyx_L9_unpacking_done;
         __pyx_L8_unpacking_failed:;
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         __pyx_t_12 = NULL;
         if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-        __PYX_ERR(0, 845, __pyx_L1_error)
+        __PYX_ERR(0, 912, __pyx_L1_error)
         __pyx_L9_unpacking_done:;
       }
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_m);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_m, __pyx_t_3);
-      __Pyx_GIVEREF(__pyx_t_3);
-      __pyx_t_3 = 0;
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_m, __pyx_t_6);
+      __Pyx_GIVEREF(__pyx_t_6);
+      __pyx_t_6 = 0;
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_n);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_n, __pyx_t_7);
       __Pyx_GIVEREF(__pyx_t_7);
       __pyx_t_7 = 0;
 
-      /* "statmoments/_native.pyx":846
- *         mft = _sort_meanfree(self.traces[self.cls[:,ii] == _i], False)
+      /* "statmoments/_native.pyx":913
+ *         mft = _sort_meanfree(self.traces[self.cls[:, ii] == _i], False)
  *         m, n = mft.shape
- *         triuflatten = _triuflatten_gen(n)             # <<<<<<<<<<<<<<
- *         retm = self._retm[_i]
- * 
+ *         retm = self._retm[_i]             # <<<<<<<<<<<<<<
+ *         triuflatten = _triuflatten_gen(n)
+ *         if m < min_cnt:
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_triuflatten_gen); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 846, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 913, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_1, __pyx_cur_scope->__pyx_v__i, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 913, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_3 = NULL;
-      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
-        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_7);
-        if (likely(__pyx_t_3)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
-          __Pyx_INCREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_retm);
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_retm, __pyx_t_7);
+      __Pyx_GIVEREF(__pyx_t_7);
+      __pyx_t_7 = 0;
+
+      /* "statmoments/_native.pyx":914
+ *         m, n = mft.shape
+ *         retm = self._retm[_i]
+ *         triuflatten = _triuflatten_gen(n)             # <<<<<<<<<<<<<<
+ *         if m < min_cnt:
+ *           retm[:] = 0
+ */
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_triuflatten_gen); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 914, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_6 = NULL;
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
+        __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
+        if (likely(__pyx_t_6)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+          __Pyx_INCREF(__pyx_t_6);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_7, function);
+          __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
-      __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_3, __pyx_cur_scope->__pyx_v_n) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_cur_scope->__pyx_v_n);
-      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 846, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      __pyx_t_7 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_6, __pyx_cur_scope->__pyx_v_n) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_cur_scope->__pyx_v_n);
+      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+      if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 914, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_triuflatten);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_triuflatten, __pyx_t_2);
-      __Pyx_GIVEREF(__pyx_t_2);
-      __pyx_t_2 = 0;
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_triuflatten, __pyx_t_7);
+      __Pyx_GIVEREF(__pyx_t_7);
+      __pyx_t_7 = 0;
 
-      /* "statmoments/_native.pyx":847
- *         m, n = mft.shape
+      /* "statmoments/_native.pyx":915
+ *         retm = self._retm[_i]
  *         triuflatten = _triuflatten_gen(n)
- *         retm = self._retm[_i]             # <<<<<<<<<<<<<<
+ *         if m < min_cnt:             # <<<<<<<<<<<<<<
+ *           retm[:] = 0
+ *           continue
+ */
+      __pyx_t_7 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_m, __pyx_cur_scope->__pyx_v_min_cnt, Py_LT); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 915, __pyx_L1_error)
+      __pyx_t_13 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 915, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      if (__pyx_t_13) {
+
+        /* "statmoments/_native.pyx":916
+ *         triuflatten = _triuflatten_gen(n)
+ *         if m < min_cnt:
+ *           retm[:] = 0             # <<<<<<<<<<<<<<
+ *           continue
+ * 
+ */
+        if (__Pyx_PyObject_SetSlice(__pyx_cur_scope->__pyx_v_retm, __pyx_int_0, 0, 0, NULL, NULL, &__pyx_slice__7, 0, 0, 0) < 0) __PYX_ERR(0, 916, __pyx_L1_error)
+
+        /* "statmoments/_native.pyx":917
+ *         if m < min_cnt:
+ *           retm[:] = 0
+ *           continue             # <<<<<<<<<<<<<<
  * 
  *         for jj, (lm, rm) in enumerate(zip(*moments)):
  */
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 847, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_2, __pyx_cur_scope->__pyx_v__i, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 847, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_retm);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_retm, __pyx_t_7);
-      __Pyx_GIVEREF(__pyx_t_7);
-      __pyx_t_7 = 0;
+        goto __pyx_L6_continue;
 
-      /* "statmoments/_native.pyx":849
+        /* "statmoments/_native.pyx":915
  *         retm = self._retm[_i]
+ *         triuflatten = _triuflatten_gen(n)
+ *         if m < min_cnt:             # <<<<<<<<<<<<<<
+ *           retm[:] = 0
+ *           continue
+ */
+      }
+
+      /* "statmoments/_native.pyx":919
+ *           continue
  * 
  *         for jj, (lm, rm) in enumerate(zip(*moments)):             # <<<<<<<<<<<<<<
  *           if lm == rm:
- *             dsyrk(mft**lm,          C, b'L', b'N', 1.0, 0.0)
+ *             dsyrk(mft ** lm,            C, b'L', b'N', 1.0, 0.0)
  */
       __Pyx_INCREF(__pyx_int_0);
       __pyx_t_7 = __pyx_int_0;
-      __pyx_t_2 = __Pyx_PySequence_Tuple(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 849, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_zip, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 849, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
-        __pyx_t_2 = __pyx_t_3; __Pyx_INCREF(__pyx_t_2); __pyx_t_13 = 0;
-        __pyx_t_14 = NULL;
+      __pyx_t_1 = __Pyx_PySequence_Tuple(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 919, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_zip, __pyx_t_1, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 919, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      if (likely(PyList_CheckExact(__pyx_t_6)) || PyTuple_CheckExact(__pyx_t_6)) {
+        __pyx_t_1 = __pyx_t_6; __Pyx_INCREF(__pyx_t_1); __pyx_t_14 = 0;
+        __pyx_t_15 = NULL;
       } else {
-        __pyx_t_13 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 849, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_14 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 849, __pyx_L1_error)
+        __pyx_t_14 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 919, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __pyx_t_15 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 919, __pyx_L1_error)
       }
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       for (;;) {
-        if (likely(!__pyx_t_14)) {
-          if (likely(PyList_CheckExact(__pyx_t_2))) {
-            if (__pyx_t_13 >= PyList_GET_SIZE(__pyx_t_2)) break;
+        if (likely(!__pyx_t_15)) {
+          if (likely(PyList_CheckExact(__pyx_t_1))) {
+            if (__pyx_t_14 >= PyList_GET_SIZE(__pyx_t_1)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_3 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_13); __Pyx_INCREF(__pyx_t_3); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 849, __pyx_L1_error)
+            __pyx_t_6 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_14); __Pyx_INCREF(__pyx_t_6); __pyx_t_14++; if (unlikely(0 < 0)) __PYX_ERR(0, 919, __pyx_L1_error)
             #else
-            __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 849, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_3);
+            __pyx_t_6 = PySequence_ITEM(__pyx_t_1, __pyx_t_14); __pyx_t_14++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 919, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_6);
             #endif
           } else {
-            if (__pyx_t_13 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
+            if (__pyx_t_14 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_13); __Pyx_INCREF(__pyx_t_3); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 849, __pyx_L1_error)
+            __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_14); __Pyx_INCREF(__pyx_t_6); __pyx_t_14++; if (unlikely(0 < 0)) __PYX_ERR(0, 919, __pyx_L1_error)
             #else
-            __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 849, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_3);
+            __pyx_t_6 = PySequence_ITEM(__pyx_t_1, __pyx_t_14); __pyx_t_14++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 919, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_6);
             #endif
           }
         } else {
-          __pyx_t_3 = __pyx_t_14(__pyx_t_2);
-          if (unlikely(!__pyx_t_3)) {
+          __pyx_t_6 = __pyx_t_15(__pyx_t_1);
+          if (unlikely(!__pyx_t_6)) {
             PyObject* exc_type = PyErr_Occurred();
             if (exc_type) {
               if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-              else __PYX_ERR(0, 849, __pyx_L1_error)
+              else __PYX_ERR(0, 919, __pyx_L1_error)
             }
             break;
           }
-          __Pyx_GOTREF(__pyx_t_3);
+          __Pyx_GOTREF(__pyx_t_6);
         }
-        if ((likely(PyTuple_CheckExact(__pyx_t_3))) || (PyList_CheckExact(__pyx_t_3))) {
-          PyObject* sequence = __pyx_t_3;
+        if ((likely(PyTuple_CheckExact(__pyx_t_6))) || (PyList_CheckExact(__pyx_t_6))) {
+          PyObject* sequence = __pyx_t_6;
           Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
           if (unlikely(size != 2)) {
             if (size > 2) __Pyx_RaiseTooManyValuesError(2);
             else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-            __PYX_ERR(0, 849, __pyx_L1_error)
+            __PYX_ERR(0, 919, __pyx_L1_error)
           }
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
           if (likely(PyTuple_CheckExact(sequence))) {
             __pyx_t_9 = PyTuple_GET_ITEM(sequence, 0); 
             __pyx_t_8 = PyTuple_GET_ITEM(sequence, 1); 
           } else {
             __pyx_t_9 = PyList_GET_ITEM(sequence, 0); 
             __pyx_t_8 = PyList_GET_ITEM(sequence, 1); 
           }
           __Pyx_INCREF(__pyx_t_9);
           __Pyx_INCREF(__pyx_t_8);
           #else
-          __pyx_t_9 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 849, __pyx_L1_error)
+          __pyx_t_9 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 919, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
-          __pyx_t_8 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 849, __pyx_L1_error)
+          __pyx_t_8 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 919, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
           #endif
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         } else {
           Py_ssize_t index = -1;
-          __pyx_t_10 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 849, __pyx_L1_error)
+          __pyx_t_10 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 919, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_12 = Py_TYPE(__pyx_t_10)->tp_iternext;
-          index = 0; __pyx_t_9 = __pyx_t_12(__pyx_t_10); if (unlikely(!__pyx_t_9)) goto __pyx_L12_unpacking_failed;
+          index = 0; __pyx_t_9 = __pyx_t_12(__pyx_t_10); if (unlikely(!__pyx_t_9)) goto __pyx_L13_unpacking_failed;
           __Pyx_GOTREF(__pyx_t_9);
-          index = 1; __pyx_t_8 = __pyx_t_12(__pyx_t_10); if (unlikely(!__pyx_t_8)) goto __pyx_L12_unpacking_failed;
+          index = 1; __pyx_t_8 = __pyx_t_12(__pyx_t_10); if (unlikely(!__pyx_t_8)) goto __pyx_L13_unpacking_failed;
           __Pyx_GOTREF(__pyx_t_8);
-          if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_10), 2) < 0) __PYX_ERR(0, 849, __pyx_L1_error)
+          if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_10), 2) < 0) __PYX_ERR(0, 919, __pyx_L1_error)
           __pyx_t_12 = NULL;
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-          goto __pyx_L13_unpacking_done;
-          __pyx_L12_unpacking_failed:;
+          goto __pyx_L14_unpacking_done;
+          __pyx_L13_unpacking_failed:;
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
           __pyx_t_12 = NULL;
           if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-          __PYX_ERR(0, 849, __pyx_L1_error)
-          __pyx_L13_unpacking_done:;
+          __PYX_ERR(0, 919, __pyx_L1_error)
+          __pyx_L14_unpacking_done:;
         }
         __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_lm);
         __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_lm, __pyx_t_9);
         __Pyx_GIVEREF(__pyx_t_9);
         __pyx_t_9 = 0;
         __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_rm);
         __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_rm, __pyx_t_8);
         __Pyx_GIVEREF(__pyx_t_8);
         __pyx_t_8 = 0;
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_jj);
         __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_jj, __pyx_t_7);
         __Pyx_GIVEREF(__pyx_t_7);
-        __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_t_7, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 849, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
+        __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_t_7, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 919, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_7);
-        __pyx_t_7 = __pyx_t_3;
-        __pyx_t_3 = 0;
+        __pyx_t_7 = __pyx_t_6;
+        __pyx_t_6 = 0;
 
-        /* "statmoments/_native.pyx":850
+        /* "statmoments/_native.pyx":920
  * 
  *         for jj, (lm, rm) in enumerate(zip(*moments)):
  *           if lm == rm:             # <<<<<<<<<<<<<<
- *             dsyrk(mft**lm,          C, b'L', b'N', 1.0, 0.0)
+ *             dsyrk(mft ** lm,            C, b'L', b'N', 1.0, 0.0)
  *           else:
  */
-        __pyx_t_3 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_lm, __pyx_cur_scope->__pyx_v_rm, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 850, __pyx_L1_error)
-        __pyx_t_15 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_15 < 0)) __PYX_ERR(0, 850, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        if (__pyx_t_15) {
+        __pyx_t_6 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_lm, __pyx_cur_scope->__pyx_v_rm, Py_EQ); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 920, __pyx_L1_error)
+        __pyx_t_13 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 920, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+        if (__pyx_t_13) {
 
-          /* "statmoments/_native.pyx":851
+          /* "statmoments/_native.pyx":921
  *         for jj, (lm, rm) in enumerate(zip(*moments)):
  *           if lm == rm:
- *             dsyrk(mft**lm,          C, b'L', b'N', 1.0, 0.0)             # <<<<<<<<<<<<<<
+ *             dsyrk(mft ** lm,            C, b'L', b'N', 1.0, 0.0)             # <<<<<<<<<<<<<<
  *           else:
- *             dgemm(mft**rm, mft**lm, C, b'N', b'T', 1.0, 0.0)
+ *             dgemm(mft ** rm, mft ** lm, C, b'N', b'T', 1.0, 0.0)
  */
-          __pyx_t_3 = PyNumber_Power(__pyx_cur_scope->__pyx_v_mft, __pyx_cur_scope->__pyx_v_lm, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 851, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 851, __pyx_L1_error)
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_cur_scope->__pyx_v_C, PyBUF_WRITABLE); if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_6 = PyNumber_Power(__pyx_cur_scope->__pyx_v_mft, __pyx_cur_scope->__pyx_v_lm, Py_None); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 921, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_6);
+          __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 921, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_cur_scope->__pyx_v_C, PyBUF_WRITABLE); if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 921, __pyx_L1_error)
           __pyx_t_18.__pyx_n = 3;
           __pyx_t_18.trans = 'N';
           __pyx_t_18.alpha = 1.0;
           __pyx_t_18.beta = 0.0;
           __pyx_f_11statmoments_7_native_dsyrk(__pyx_t_16, __pyx_t_17, 'L', &__pyx_t_18); 
           __PYX_XDEC_MEMVIEW(&__pyx_t_16, 1);
           __pyx_t_16.memview = NULL;
           __pyx_t_16.data = NULL;
           __PYX_XDEC_MEMVIEW(&__pyx_t_17, 1);
           __pyx_t_17.memview = NULL;
           __pyx_t_17.data = NULL;
 
-          /* "statmoments/_native.pyx":850
+          /* "statmoments/_native.pyx":920
  * 
  *         for jj, (lm, rm) in enumerate(zip(*moments)):
  *           if lm == rm:             # <<<<<<<<<<<<<<
- *             dsyrk(mft**lm,          C, b'L', b'N', 1.0, 0.0)
+ *             dsyrk(mft ** lm,            C, b'L', b'N', 1.0, 0.0)
  *           else:
  */
-          goto __pyx_L14;
+          goto __pyx_L15;
         }
 
-        /* "statmoments/_native.pyx":853
- *             dsyrk(mft**lm,          C, b'L', b'N', 1.0, 0.0)
+        /* "statmoments/_native.pyx":923
+ *             dsyrk(mft ** lm,            C, b'L', b'N', 1.0, 0.0)
  *           else:
- *             dgemm(mft**rm, mft**lm, C, b'N', b'T', 1.0, 0.0)             # <<<<<<<<<<<<<<
+ *             dgemm(mft ** rm, mft ** lm, C, b'N', b'T', 1.0, 0.0)             # <<<<<<<<<<<<<<
  *           retm[jj] = triuflatten(C) / m
  *           if (lm + rm >= 3) and normalize:
  */
         /*else*/ {
-          __pyx_t_3 = PyNumber_Power(__pyx_cur_scope->__pyx_v_mft, __pyx_cur_scope->__pyx_v_rm, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 853, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 853, __pyx_L1_error)
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __pyx_t_3 = PyNumber_Power(__pyx_cur_scope->__pyx_v_mft, __pyx_cur_scope->__pyx_v_lm, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 853, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 853, __pyx_L1_error)
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_cur_scope->__pyx_v_C, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 853, __pyx_L1_error)
+          __pyx_t_6 = PyNumber_Power(__pyx_cur_scope->__pyx_v_mft, __pyx_cur_scope->__pyx_v_rm, Py_None); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 923, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_6);
+          __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 923, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          __pyx_t_6 = PyNumber_Power(__pyx_cur_scope->__pyx_v_mft, __pyx_cur_scope->__pyx_v_lm, Py_None); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 923, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_6);
+          __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 923, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_cur_scope->__pyx_v_C, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 923, __pyx_L1_error)
           __pyx_t_20.__pyx_n = 4;
           __pyx_t_20.transa = 'N';
           __pyx_t_20.transb = 'T';
           __pyx_t_20.alpha = 1.0;
           __pyx_t_20.beta = 0.0;
           __pyx_f_11statmoments_7_native_dgemm(__pyx_t_17, __pyx_t_16, __pyx_t_19, &__pyx_t_20); 
           __PYX_XDEC_MEMVIEW(&__pyx_t_17, 1);
@@ -29198,19 +30201,19 @@
           __PYX_XDEC_MEMVIEW(&__pyx_t_16, 1);
           __pyx_t_16.memview = NULL;
           __pyx_t_16.data = NULL;
           __PYX_XDEC_MEMVIEW(&__pyx_t_19, 1);
           __pyx_t_19.memview = NULL;
           __pyx_t_19.data = NULL;
         }
-        __pyx_L14:;
+        __pyx_L15:;
 
-        /* "statmoments/_native.pyx":854
+        /* "statmoments/_native.pyx":924
  *           else:
- *             dgemm(mft**rm, mft**lm, C, b'N', b'T', 1.0, 0.0)
+ *             dgemm(mft ** rm, mft ** lm, C, b'N', b'T', 1.0, 0.0)
  *           retm[jj] = triuflatten(C) / m             # <<<<<<<<<<<<<<
  *           if (lm + rm >= 3) and normalize:
  *             triuflatten = _triuflatten_gen(tr_len)
  */
         __Pyx_INCREF(__pyx_cur_scope->__pyx_v_triuflatten);
         __pyx_t_8 = __pyx_cur_scope->__pyx_v_triuflatten; __pyx_t_9 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
@@ -29218,126 +30221,126 @@
           if (likely(__pyx_t_9)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
             __Pyx_INCREF(__pyx_t_9);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_8, function);
           }
         }
-        __pyx_t_3 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_9, __pyx_cur_scope->__pyx_v_C) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_cur_scope->__pyx_v_C);
+        __pyx_t_6 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_9, __pyx_cur_scope->__pyx_v_C) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_cur_scope->__pyx_v_C);
         __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 854, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
+        if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 924, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_cur_scope->__pyx_v_m); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 854, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_t_6, __pyx_cur_scope->__pyx_v_m); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 924, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_cur_scope->__pyx_v_jj, __pyx_t_8) < 0)) __PYX_ERR(0, 854, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+        if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_cur_scope->__pyx_v_jj, __pyx_t_8) < 0)) __PYX_ERR(0, 924, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-        /* "statmoments/_native.pyx":855
- *             dgemm(mft**rm, mft**lm, C, b'N', b'T', 1.0, 0.0)
+        /* "statmoments/_native.pyx":925
+ *             dgemm(mft ** rm, mft ** lm, C, b'N', b'T', 1.0, 0.0)
  *           retm[jj] = triuflatten(C) / m
  *           if (lm + rm >= 3) and normalize:             # <<<<<<<<<<<<<<
  *             triuflatten = _triuflatten_gen(tr_len)
  *             sd = np.std(mft, axis=0)
  */
-        __pyx_t_8 = PyNumber_Add(__pyx_cur_scope->__pyx_v_lm, __pyx_cur_scope->__pyx_v_rm); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 855, __pyx_L1_error)
+        __pyx_t_8 = PyNumber_Add(__pyx_cur_scope->__pyx_v_lm, __pyx_cur_scope->__pyx_v_rm); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 925, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_3 = PyObject_RichCompare(__pyx_t_8, __pyx_int_3, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 855, __pyx_L1_error)
+        __pyx_t_6 = PyObject_RichCompare(__pyx_t_8, __pyx_int_3, Py_GE); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 925, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 855, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 925, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         if (__pyx_t_21) {
         } else {
-          __pyx_t_15 = __pyx_t_21;
-          goto __pyx_L16_bool_binop_done;
+          __pyx_t_13 = __pyx_t_21;
+          goto __pyx_L17_bool_binop_done;
         }
-        __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_normalize); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 855, __pyx_L1_error)
-        __pyx_t_15 = __pyx_t_21;
-        __pyx_L16_bool_binop_done:;
-        if (__pyx_t_15) {
+        __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_normalize); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 925, __pyx_L1_error)
+        __pyx_t_13 = __pyx_t_21;
+        __pyx_L17_bool_binop_done:;
+        if (__pyx_t_13) {
 
-          /* "statmoments/_native.pyx":856
+          /* "statmoments/_native.pyx":926
  *           retm[jj] = triuflatten(C) / m
  *           if (lm + rm >= 3) and normalize:
  *             triuflatten = _triuflatten_gen(tr_len)             # <<<<<<<<<<<<<<
  *             sd = np.std(mft, axis=0)
  *             retm[jj] /= triuflatten(np.outer(sd ** lm, sd ** rm))
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_triuflatten_gen); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 856, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_triuflatten_gen); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 926, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
           __pyx_t_9 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
             __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_8);
             if (likely(__pyx_t_9)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
               __Pyx_INCREF(__pyx_t_9);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_8, function);
             }
           }
-          __pyx_t_3 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_9, __pyx_cur_scope->__pyx_v_tr_len) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_cur_scope->__pyx_v_tr_len);
+          __pyx_t_6 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_9, __pyx_cur_scope->__pyx_v_tr_len) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_cur_scope->__pyx_v_tr_len);
           __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-          if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 856, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
+          if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 926, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_6);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
           __Pyx_GOTREF(__pyx_cur_scope->__pyx_v_triuflatten);
-          __Pyx_DECREF_SET(__pyx_cur_scope->__pyx_v_triuflatten, __pyx_t_3);
-          __Pyx_GIVEREF(__pyx_t_3);
-          __pyx_t_3 = 0;
+          __Pyx_DECREF_SET(__pyx_cur_scope->__pyx_v_triuflatten, __pyx_t_6);
+          __Pyx_GIVEREF(__pyx_t_6);
+          __pyx_t_6 = 0;
 
-          /* "statmoments/_native.pyx":857
+          /* "statmoments/_native.pyx":927
  *           if (lm + rm >= 3) and normalize:
  *             triuflatten = _triuflatten_gen(tr_len)
  *             sd = np.std(mft, axis=0)             # <<<<<<<<<<<<<<
  *             retm[jj] /= triuflatten(np.outer(sd ** lm, sd ** rm))
  * 
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 857, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_std); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 857, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 927, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_6);
+          __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_std); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 927, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 857, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 927, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_6);
           __Pyx_INCREF(__pyx_cur_scope->__pyx_v_mft);
           __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_mft);
-          PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_cur_scope->__pyx_v_mft);
-          __pyx_t_9 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 857, __pyx_L1_error)
+          PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_cur_scope->__pyx_v_mft);
+          __pyx_t_9 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 927, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
-          if (PyDict_SetItem(__pyx_t_9, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 857, __pyx_L1_error)
-          __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_3, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 857, __pyx_L1_error)
+          if (PyDict_SetItem(__pyx_t_9, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 927, __pyx_L1_error)
+          __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_6, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 927, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
           __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_sd);
           __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_sd, __pyx_t_10);
           __Pyx_GIVEREF(__pyx_t_10);
           __pyx_t_10 = 0;
 
-          /* "statmoments/_native.pyx":858
+          /* "statmoments/_native.pyx":928
  *             triuflatten = _triuflatten_gen(tr_len)
  *             sd = np.std(mft, axis=0)
  *             retm[jj] /= triuflatten(np.outer(sd ** lm, sd ** rm))             # <<<<<<<<<<<<<<
  * 
- *     yield self._retm[:, :len(moments[0])]
+ *       yield self._retm[:, :len(moments[0])]
  */
           __Pyx_INCREF(__pyx_cur_scope->__pyx_v_jj);
           __pyx_t_10 = __pyx_cur_scope->__pyx_v_jj;
-          __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 858, __pyx_L1_error)
+          __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 928, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
-          __Pyx_GetModuleGlobalName(__pyx_t_22, __pyx_n_s_np); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 858, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_22, __pyx_n_s_np); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 928, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_22);
-          __pyx_t_23 = __Pyx_PyObject_GetAttrStr(__pyx_t_22, __pyx_n_s_outer); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 858, __pyx_L1_error)
+          __pyx_t_23 = __Pyx_PyObject_GetAttrStr(__pyx_t_22, __pyx_n_s_outer); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 928, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_23);
           __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
-          __pyx_t_22 = PyNumber_Power(__pyx_cur_scope->__pyx_v_sd, __pyx_cur_scope->__pyx_v_lm, Py_None); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 858, __pyx_L1_error)
+          __pyx_t_22 = PyNumber_Power(__pyx_cur_scope->__pyx_v_sd, __pyx_cur_scope->__pyx_v_lm, Py_None); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 928, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_22);
-          __pyx_t_24 = PyNumber_Power(__pyx_cur_scope->__pyx_v_sd, __pyx_cur_scope->__pyx_v_rm, Py_None); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 858, __pyx_L1_error)
+          __pyx_t_24 = PyNumber_Power(__pyx_cur_scope->__pyx_v_sd, __pyx_cur_scope->__pyx_v_rm, Py_None); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 928, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_24);
           __pyx_t_25 = NULL;
           __pyx_t_11 = 0;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_23))) {
             __pyx_t_25 = PyMethod_GET_SELF(__pyx_t_23);
             if (likely(__pyx_t_25)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_23);
@@ -29346,44 +30349,44 @@
               __Pyx_DECREF_SET(__pyx_t_23, function);
               __pyx_t_11 = 1;
             }
           }
           #if CYTHON_FAST_PYCALL
           if (PyFunction_Check(__pyx_t_23)) {
             PyObject *__pyx_temp[3] = {__pyx_t_25, __pyx_t_22, __pyx_t_24};
-            __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_23, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 858, __pyx_L1_error)
+            __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_23, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 928, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_25); __pyx_t_25 = 0;
             __Pyx_GOTREF(__pyx_t_8);
             __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
             __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
           } else
           #endif
           #if CYTHON_FAST_PYCCALL
           if (__Pyx_PyFastCFunction_Check(__pyx_t_23)) {
             PyObject *__pyx_temp[3] = {__pyx_t_25, __pyx_t_22, __pyx_t_24};
-            __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_23, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 858, __pyx_L1_error)
+            __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_23, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 928, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_25); __pyx_t_25 = 0;
             __Pyx_GOTREF(__pyx_t_8);
             __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
             __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
           } else
           #endif
           {
-            __pyx_t_26 = PyTuple_New(2+__pyx_t_11); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 858, __pyx_L1_error)
+            __pyx_t_26 = PyTuple_New(2+__pyx_t_11); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 928, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_26);
             if (__pyx_t_25) {
               __Pyx_GIVEREF(__pyx_t_25); PyTuple_SET_ITEM(__pyx_t_26, 0, __pyx_t_25); __pyx_t_25 = NULL;
             }
             __Pyx_GIVEREF(__pyx_t_22);
             PyTuple_SET_ITEM(__pyx_t_26, 0+__pyx_t_11, __pyx_t_22);
             __Pyx_GIVEREF(__pyx_t_24);
             PyTuple_SET_ITEM(__pyx_t_26, 1+__pyx_t_11, __pyx_t_24);
             __pyx_t_22 = 0;
             __pyx_t_24 = 0;
-            __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_23, __pyx_t_26, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 858, __pyx_L1_error)
+            __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_23, __pyx_t_26, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 928, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_8);
             __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
           }
           __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
           __Pyx_INCREF(__pyx_cur_scope->__pyx_v_triuflatten);
           __pyx_t_23 = __pyx_cur_scope->__pyx_v_triuflatten; __pyx_t_26 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_23))) {
@@ -29391,116 +30394,126 @@
             if (likely(__pyx_t_26)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_23);
               __Pyx_INCREF(__pyx_t_26);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_23, function);
             }
           }
-          __pyx_t_3 = (__pyx_t_26) ? __Pyx_PyObject_Call2Args(__pyx_t_23, __pyx_t_26, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_23, __pyx_t_8);
+          __pyx_t_6 = (__pyx_t_26) ? __Pyx_PyObject_Call2Args(__pyx_t_23, __pyx_t_26, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_23, __pyx_t_8);
           __Pyx_XDECREF(__pyx_t_26); __pyx_t_26 = 0;
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-          if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 858, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
+          if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 928, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_6);
           __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
-          __pyx_t_23 = __Pyx_PyNumber_InPlaceDivide(__pyx_t_9, __pyx_t_3); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 858, __pyx_L1_error)
+          __pyx_t_23 = __Pyx_PyNumber_InPlaceDivide(__pyx_t_9, __pyx_t_6); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 928, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_23);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_10, __pyx_t_23) < 0)) __PYX_ERR(0, 858, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_10, __pyx_t_23) < 0)) __PYX_ERR(0, 928, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-          /* "statmoments/_native.pyx":855
- *             dgemm(mft**rm, mft**lm, C, b'N', b'T', 1.0, 0.0)
+          /* "statmoments/_native.pyx":925
+ *             dgemm(mft ** rm, mft ** lm, C, b'N', b'T', 1.0, 0.0)
  *           retm[jj] = triuflatten(C) / m
  *           if (lm + rm >= 3) and normalize:             # <<<<<<<<<<<<<<
  *             triuflatten = _triuflatten_gen(tr_len)
  *             sd = np.std(mft, axis=0)
  */
         }
 
-        /* "statmoments/_native.pyx":849
- *         retm = self._retm[_i]
+        /* "statmoments/_native.pyx":919
+ *           continue
  * 
  *         for jj, (lm, rm) in enumerate(zip(*moments)):             # <<<<<<<<<<<<<<
  *           if lm == rm:
- *             dsyrk(mft**lm,          C, b'L', b'N', 1.0, 0.0)
+ *             dsyrk(mft ** lm,            C, b'L', b'N', 1.0, 0.0)
  */
       }
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      __pyx_L6_continue:;
     }
 
-    /* "statmoments/_native.pyx":842
- *     C = self._tmpsq
- *     tr_len, cl_len = self.trace_len, self.cls.shape[1]
- *     for ii in range(cl_len):             # <<<<<<<<<<<<<<
- *       for _i in range(2):
- *         mft = _sort_meanfree(self.traces[self.cls[:,ii] == _i], False)
- */
-  }
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-
-  /* "statmoments/_native.pyx":860
+    /* "statmoments/_native.pyx":930
  *             retm[jj] /= triuflatten(np.outer(sd ** lm, sd ** rm))
  * 
- *     yield self._retm[:, :len(moments[0])]             # <<<<<<<<<<<<<<
+ *       yield self._retm[:, :len(moments[0])]             # <<<<<<<<<<<<<<
+ * 
  * 
- * class bivar_txtbk(_BivarNpassBase):
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 860, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_7 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_moments, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 860, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = PyObject_Length(__pyx_t_7); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 860, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 860, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_2 = PySlice_New(Py_None, __pyx_t_7, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 860, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 860, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_INCREF(__pyx_slice__5);
-  __Pyx_GIVEREF(__pyx_slice__5);
-  PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_slice__5);
-  __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_2);
-  __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 860, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_r = __pyx_t_2;
-  __pyx_t_2 = 0;
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
-  /* return from generator, yielding value */
-  __pyx_generator->resume_label = 1;
-  return __pyx_r;
-  __pyx_L18_resume_from_yield:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 860, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 930, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_moments, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 930, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_14 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_14 == ((Py_ssize_t)-1))) __PYX_ERR(0, 930, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_14); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 930, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_10 = PySlice_New(Py_None, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 930, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_10);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 930, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_INCREF(__pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_slice__7);
+    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_t_10);
+    PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_10);
+    __pyx_t_10 = 0;
+    __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_7, __pyx_t_1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 930, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_10);
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_r = __pyx_t_10;
+    __pyx_t_10 = 0;
+    __Pyx_XGIVEREF(__pyx_t_2);
+    __pyx_cur_scope->__pyx_t_0 = __pyx_t_2;
+    __pyx_cur_scope->__pyx_t_1 = __pyx_t_3;
+    __pyx_cur_scope->__pyx_t_2 = __pyx_t_4;
+    __Pyx_XGIVEREF(__pyx_r);
+    __Pyx_RefNannyFinishContext();
+    __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
+    /* return from generator, yielding value */
+    __pyx_generator->resume_label = 1;
+    return __pyx_r;
+    __pyx_L19_resume_from_yield:;
+    __pyx_t_2 = __pyx_cur_scope->__pyx_t_0;
+    __pyx_cur_scope->__pyx_t_0 = 0;
+    __Pyx_XGOTREF(__pyx_t_2);
+    __pyx_t_3 = __pyx_cur_scope->__pyx_t_1;
+    __pyx_t_4 = __pyx_cur_scope->__pyx_t_2;
+    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 930, __pyx_L1_error)
+
+    /* "statmoments/_native.pyx":909
+ *     min_cnt, C = self.acc_min_count, self._tmpsq
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len
+ *     for ii in range(cl_len):             # <<<<<<<<<<<<<<
+ *       for _i in range(2):
+ *         mft = _sort_meanfree(self.traces[self.cls[:, ii] == _i], False)
+ */
+  }
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
-  /* "statmoments/_native.pyx":839
+  /* "statmoments/_native.pyx":906
+ *     return mem_base + mem_ttstd * 8
  * 
- * class bivar_2pass(_BivarNpassBase):
  *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
- *     C = self._tmpsq
- *     tr_len, cl_len = self.trace_len, self.cls.shape[1]
+ *     min_cnt, C = self.acc_min_count, self._tmpsq
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len
  */
 
   /* function exit code */
   PyErr_SetNone(PyExc_StopIteration);
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_6);
   __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_8);
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_XDECREF(__pyx_t_10);
   __PYX_XDEC_MEMVIEW(&__pyx_t_16, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_t_17, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_t_19, 1);
@@ -29517,15 +30530,15 @@
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":863
+/* "statmoments/_native.pyx":934
  * 
  * class bivar_txtbk(_BivarNpassBase):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  *     m, n = self.acc_min_count, trace_len
  */
 
@@ -29566,40 +30579,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_trace_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 1); __PYX_ERR(0, 863, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 1); __PYX_ERR(0, 934, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifier_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 2); __PYX_ERR(0, 863, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 2); __PYX_ERR(0, 934, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 863, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 934, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_trace_len = values[1];
     __pyx_v_classifier_len = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 863, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 934, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
   __Pyx_AddTraceback("statmoments._native.bivar_txtbk.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_11bivar_txtbk___init__(__pyx_self, __pyx_v_self, __pyx_v_trace_len, __pyx_v_classifier_len, __pyx_v_kwargs);
@@ -29620,92 +30633,92 @@
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "statmoments/_native.pyx":864
+  /* "statmoments/_native.pyx":935
  * class bivar_txtbk(_BivarNpassBase):
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, **kwargs)             # <<<<<<<<<<<<<<
  *     m, n = self.acc_min_count, trace_len
- *     self._tri  = np.empty((m, n * (n+1)//2))   # Handle the triangle dynamically
+ *     self._tri = np.empty((m, n * (n + 1) // 2))  # Handle the triangle dynamically
  */
   __pyx_t_1 = __Pyx_CyFunction_GetClassObj(__pyx_self);
-  if (!__pyx_t_1) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 864, __pyx_L1_error) }
+  if (!__pyx_t_1) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 935, __pyx_L1_error) }
   __Pyx_INCREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 935, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __Pyx_INCREF(__pyx_v_self);
   __Pyx_GIVEREF(__pyx_v_self);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_self);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 935, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_init); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_init); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 935, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 935, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_trace_len);
   __Pyx_GIVEREF(__pyx_v_trace_len);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_trace_len);
   __Pyx_INCREF(__pyx_v_classifier_len);
   __Pyx_GIVEREF(__pyx_v_classifier_len);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_classifier_len);
-  __pyx_t_3 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_3 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 935, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 935, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":865
+  /* "statmoments/_native.pyx":936
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, **kwargs)
  *     m, n = self.acc_min_count, trace_len             # <<<<<<<<<<<<<<
- *     self._tri  = np.empty((m, n * (n+1)//2))   # Handle the triangle dynamically
+ *     self._tri = np.empty((m, n * (n + 1) // 2))  # Handle the triangle dynamically
  * 
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_acc_min_count); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 865, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_acc_min_count); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 936, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_3 = __pyx_v_trace_len;
   __Pyx_INCREF(__pyx_t_3);
   __pyx_v_m = __pyx_t_4;
   __pyx_t_4 = 0;
   __pyx_v_n = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":866
+  /* "statmoments/_native.pyx":937
  *     super().__init__(trace_len, classifier_len, **kwargs)
  *     m, n = self.acc_min_count, trace_len
- *     self._tri  = np.empty((m, n * (n+1)//2))   # Handle the triangle dynamically             # <<<<<<<<<<<<<<
+ *     self._tri = np.empty((m, n * (n + 1) // 2))  # Handle the triangle dynamically             # <<<<<<<<<<<<<<
  * 
- *   def _realloc_tri(self, m):
+ *   @staticmethod
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 866, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 937, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 866, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 937, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_v_n, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 866, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_v_n, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 937, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = PyNumber_Multiply(__pyx_v_n, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 866, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_v_n, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 937, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_2, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 866, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_2, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 937, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 866, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 937, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_v_m);
   __Pyx_GIVEREF(__pyx_v_m);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_m);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_4);
   __pyx_t_4 = 0;
@@ -29718,21 +30731,21 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_1, function);
     }
   }
   __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 866, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 937, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_tri, __pyx_t_3) < 0) __PYX_ERR(0, 866, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_tri, __pyx_t_3) < 0) __PYX_ERR(0, 937, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":863
+  /* "statmoments/_native.pyx":934
  * 
  * class bivar_txtbk(_BivarNpassBase):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  *     m, n = self.acc_min_count, trace_len
  */
 
@@ -29750,26 +30763,453 @@
   __Pyx_XDECREF(__pyx_v_m);
   __Pyx_XDECREF(__pyx_v_n);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":868
- *     self._tri  = np.empty((m, n * (n+1)//2))   # Handle the triangle dynamically
+/* "statmoments/_native.pyx":940
+ * 
+ *   @staticmethod
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *     exp_traces = 10  # Expected number of traces in the input batch
+ *     mem_base  = _BivarNpassBase.estimate_mem_size(tr_len, cl_len, moment)
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_11statmoments_7_native_11bivar_txtbk_3estimate_mem_size(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_11statmoments_7_native_11bivar_txtbk_3estimate_mem_size = {"estimate_mem_size", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_11bivar_txtbk_3estimate_mem_size, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11statmoments_7_native_11bivar_txtbk_3estimate_mem_size(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyObject *__pyx_v_tr_len = 0;
+  PyObject *__pyx_v_cl_len = 0;
+  PyObject *__pyx_v_moment = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("estimate_mem_size (wrapper)", 0);
+  {
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_tr_len,&__pyx_n_s_cl_len,&__pyx_n_s_moment,0};
+    PyObject* values[3] = {0,0,0};
+    values[1] = ((PyObject *)((PyObject *)__pyx_int_1));
+    values[2] = ((PyObject *)((PyObject *)__pyx_int_2));
+    if (unlikely(__pyx_kwds)) {
+      Py_ssize_t kw_args;
+      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
+      switch (pos_args) {
+        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+        CYTHON_FALLTHROUGH;
+        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+        CYTHON_FALLTHROUGH;
+        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        CYTHON_FALLTHROUGH;
+        case  0: break;
+        default: goto __pyx_L5_argtuple_error;
+      }
+      kw_args = PyDict_Size(__pyx_kwds);
+      switch (pos_args) {
+        case  0:
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr_len)) != 0)) kw_args--;
+        else goto __pyx_L5_argtuple_error;
+        CYTHON_FALLTHROUGH;
+        case  1:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_cl_len);
+          if (value) { values[1] = value; kw_args--; }
+        }
+        CYTHON_FALLTHROUGH;
+        case  2:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moment);
+          if (value) { values[2] = value; kw_args--; }
+        }
+      }
+      if (unlikely(kw_args > 0)) {
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "estimate_mem_size") < 0)) __PYX_ERR(0, 940, __pyx_L3_error)
+      }
+    } else {
+      switch (PyTuple_GET_SIZE(__pyx_args)) {
+        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+        CYTHON_FALLTHROUGH;
+        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+        CYTHON_FALLTHROUGH;
+        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        break;
+        default: goto __pyx_L5_argtuple_error;
+      }
+    }
+    __pyx_v_tr_len = values[0];
+    __pyx_v_cl_len = values[1];
+    __pyx_v_moment = values[2];
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("estimate_mem_size", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 940, __pyx_L3_error)
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("statmoments._native.bivar_txtbk.estimate_mem_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __pyx_r = __pyx_pf_11statmoments_7_native_11bivar_txtbk_2estimate_mem_size(__pyx_self, __pyx_v_tr_len, __pyx_v_cl_len, __pyx_v_moment);
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_11statmoments_7_native_11bivar_txtbk_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tr_len, PyObject *__pyx_v_cl_len, PyObject *__pyx_v_moment) {
+  PyObject *__pyx_v_exp_traces = NULL;
+  PyObject *__pyx_v_mem_base = NULL;
+  PyObject *__pyx_v_mem_tri = NULL;
+  PyObject *__pyx_v_mem_ttstd = NULL;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  int __pyx_t_4;
+  PyObject *__pyx_t_5 = NULL;
+  int __pyx_t_6;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("estimate_mem_size", 0);
+
+  /* "statmoments/_native.pyx":941
+ *   @staticmethod
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):
+ *     exp_traces = 10  # Expected number of traces in the input batch             # <<<<<<<<<<<<<<
+ *     mem_base  = _BivarNpassBase.estimate_mem_size(tr_len, cl_len, moment)
+ *     mem_tri   = exp_traces * tr_len * (tr_len + 1) // 2
+ */
+  __Pyx_INCREF(__pyx_int_10);
+  __pyx_v_exp_traces = __pyx_int_10;
+
+  /* "statmoments/_native.pyx":942
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):
+ *     exp_traces = 10  # Expected number of traces in the input batch
+ *     mem_base  = _BivarNpassBase.estimate_mem_size(tr_len, cl_len, moment)             # <<<<<<<<<<<<<<
+ *     mem_tri   = exp_traces * tr_len * (tr_len + 1) // 2
+ *     mem_ttstd = 0  if moment < 3 else tr_len + tr_len ** 2
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BivarNpassBase); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 942, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_estimate_mem_size); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 942, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = NULL;
+  __pyx_t_4 = 0;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
+    if (likely(__pyx_t_2)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+      __Pyx_INCREF(__pyx_t_2);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_3, function);
+      __pyx_t_4 = 1;
+    }
+  }
+  #if CYTHON_FAST_PYCALL
+  if (PyFunction_Check(__pyx_t_3)) {
+    PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_v_tr_len, __pyx_v_cl_len, __pyx_v_moment};
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 942, __pyx_L1_error)
+    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_GOTREF(__pyx_t_1);
+  } else
+  #endif
+  #if CYTHON_FAST_PYCCALL
+  if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
+    PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_v_tr_len, __pyx_v_cl_len, __pyx_v_moment};
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 942, __pyx_L1_error)
+    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_GOTREF(__pyx_t_1);
+  } else
+  #endif
+  {
+    __pyx_t_5 = PyTuple_New(3+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 942, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    if (__pyx_t_2) {
+      __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
+    }
+    __Pyx_INCREF(__pyx_v_tr_len);
+    __Pyx_GIVEREF(__pyx_v_tr_len);
+    PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_4, __pyx_v_tr_len);
+    __Pyx_INCREF(__pyx_v_cl_len);
+    __Pyx_GIVEREF(__pyx_v_cl_len);
+    PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_4, __pyx_v_cl_len);
+    __Pyx_INCREF(__pyx_v_moment);
+    __Pyx_GIVEREF(__pyx_v_moment);
+    PyTuple_SET_ITEM(__pyx_t_5, 2+__pyx_t_4, __pyx_v_moment);
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 942, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  }
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_mem_base = __pyx_t_1;
+  __pyx_t_1 = 0;
+
+  /* "statmoments/_native.pyx":943
+ *     exp_traces = 10  # Expected number of traces in the input batch
+ *     mem_base  = _BivarNpassBase.estimate_mem_size(tr_len, cl_len, moment)
+ *     mem_tri   = exp_traces * tr_len * (tr_len + 1) // 2             # <<<<<<<<<<<<<<
+ *     mem_ttstd = 0  if moment < 3 else tr_len + tr_len ** 2
+ *     return mem_base + (mem_tri  + mem_ttstd)* 8
+ */
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_exp_traces, __pyx_v_tr_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 943, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_tr_len, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 943, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_5 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 943, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_5, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 943, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_v_mem_tri = __pyx_t_3;
+  __pyx_t_3 = 0;
+
+  /* "statmoments/_native.pyx":944
+ *     mem_base  = _BivarNpassBase.estimate_mem_size(tr_len, cl_len, moment)
+ *     mem_tri   = exp_traces * tr_len * (tr_len + 1) // 2
+ *     mem_ttstd = 0  if moment < 3 else tr_len + tr_len ** 2             # <<<<<<<<<<<<<<
+ *     return mem_base + (mem_tri  + mem_ttstd)* 8
+ * 
+ */
+  __pyx_t_5 = PyObject_RichCompare(__pyx_v_moment, __pyx_int_3, Py_LT); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (__pyx_t_6) {
+    __Pyx_INCREF(__pyx_int_0);
+    __pyx_t_3 = __pyx_int_0;
+  } else {
+    __pyx_t_5 = PyNumber_Power(__pyx_v_tr_len, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 944, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_1 = PyNumber_Add(__pyx_v_tr_len, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 944, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_3 = __pyx_t_1;
+    __pyx_t_1 = 0;
+  }
+  __pyx_v_mem_ttstd = __pyx_t_3;
+  __pyx_t_3 = 0;
+
+  /* "statmoments/_native.pyx":945
+ *     mem_tri   = exp_traces * tr_len * (tr_len + 1) // 2
+ *     mem_ttstd = 0  if moment < 3 else tr_len + tr_len ** 2
+ *     return mem_base + (mem_tri  + mem_ttstd)* 8             # <<<<<<<<<<<<<<
+ * 
+ *   def memory_size(self):
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_3 = PyNumber_Add(__pyx_v_mem_tri, __pyx_v_mem_ttstd); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 945, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_3, __pyx_int_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 945, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = PyNumber_Add(__pyx_v_mem_base, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 945, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_r = __pyx_t_3;
+  __pyx_t_3 = 0;
+  goto __pyx_L0;
+
+  /* "statmoments/_native.pyx":940
+ * 
+ *   @staticmethod
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *     exp_traces = 10  # Expected number of traces in the input batch
+ *     mem_base  = _BivarNpassBase.estimate_mem_size(tr_len, cl_len, moment)
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_AddTraceback("statmoments._native.bivar_txtbk.estimate_mem_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XDECREF(__pyx_v_exp_traces);
+  __Pyx_XDECREF(__pyx_v_mem_base);
+  __Pyx_XDECREF(__pyx_v_mem_tri);
+  __Pyx_XDECREF(__pyx_v_mem_ttstd);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "statmoments/_native.pyx":947
+ *     return mem_base + (mem_tri  + mem_ttstd)* 8
+ * 
+ *   def memory_size(self):             # <<<<<<<<<<<<<<
+ *     mem_base = super().memory_size()
+ *     # One additional square for std normalization for moments > 2
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_11statmoments_7_native_11bivar_txtbk_5memory_size(PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
+static PyMethodDef __pyx_mdef_11statmoments_7_native_11bivar_txtbk_5memory_size = {"memory_size", (PyCFunction)__pyx_pw_11statmoments_7_native_11bivar_txtbk_5memory_size, METH_O, 0};
+static PyObject *__pyx_pw_11statmoments_7_native_11bivar_txtbk_5memory_size(PyObject *__pyx_self, PyObject *__pyx_v_self) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("memory_size (wrapper)", 0);
+  __pyx_r = __pyx_pf_11statmoments_7_native_11bivar_txtbk_4memory_size(__pyx_self, ((PyObject *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_11statmoments_7_native_11bivar_txtbk_4memory_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
+  PyObject *__pyx_v_mem_base = NULL;
+  PyObject *__pyx_v_mem_ttstd = NULL;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  int __pyx_t_4;
+  PyObject *__pyx_t_5 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("memory_size", 0);
+
+  /* "statmoments/_native.pyx":948
+ * 
+ *   def memory_size(self):
+ *     mem_base = super().memory_size()             # <<<<<<<<<<<<<<
+ *     # One additional square for std normalization for moments > 2
+ *     mem_ttstd = 0  if self.moment < 3 else self.trace_len + self.trace_len ** 2
+ */
+  __pyx_t_2 = __Pyx_CyFunction_GetClassObj(__pyx_self);
+  if (!__pyx_t_2) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 948, __pyx_L1_error) }
+  __Pyx_INCREF(__pyx_t_2);
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
+  __Pyx_INCREF(__pyx_v_self);
+  __Pyx_GIVEREF(__pyx_v_self);
+  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_self);
+  __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_memory_size); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = NULL;
+  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
+    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
+    if (likely(__pyx_t_2)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+      __Pyx_INCREF(__pyx_t_2);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_3, function);
+    }
+  }
+  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_mem_base = __pyx_t_1;
+  __pyx_t_1 = 0;
+
+  /* "statmoments/_native.pyx":950
+ *     mem_base = super().memory_size()
+ *     # One additional square for std normalization for moments > 2
+ *     mem_ttstd = 0  if self.moment < 3 else self.trace_len + self.trace_len ** 2             # <<<<<<<<<<<<<<
+ *     return mem_base + mem_ttstd * 8
+ * 
+ */
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 950, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = PyObject_RichCompare(__pyx_t_3, __pyx_int_3, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 950, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 950, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (__pyx_t_4) {
+    __Pyx_INCREF(__pyx_int_0);
+    __pyx_t_1 = __pyx_int_0;
+  } else {
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 950, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 950, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_5 = PyNumber_Power(__pyx_t_3, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 950, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_3 = PyNumber_Add(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 950, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_1 = __pyx_t_3;
+    __pyx_t_3 = 0;
+  }
+  __pyx_v_mem_ttstd = __pyx_t_1;
+  __pyx_t_1 = 0;
+
+  /* "statmoments/_native.pyx":951
+ *     # One additional square for std normalization for moments > 2
+ *     mem_ttstd = 0  if self.moment < 3 else self.trace_len + self.trace_len ** 2
+ *     return mem_base + mem_ttstd * 8             # <<<<<<<<<<<<<<
+ * 
+ *   def _realloc_tri(self, m):
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_mem_ttstd, __pyx_int_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 951, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = PyNumber_Add(__pyx_v_mem_base, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 951, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_r = __pyx_t_3;
+  __pyx_t_3 = 0;
+  goto __pyx_L0;
+
+  /* "statmoments/_native.pyx":947
+ *     return mem_base + (mem_tri  + mem_ttstd)* 8
+ * 
+ *   def memory_size(self):             # <<<<<<<<<<<<<<
+ *     mem_base = super().memory_size()
+ *     # One additional square for std normalization for moments > 2
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_AddTraceback("statmoments._native.bivar_txtbk.memory_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XDECREF(__pyx_v_mem_base);
+  __Pyx_XDECREF(__pyx_v_mem_ttstd);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "statmoments/_native.pyx":953
+ *     return mem_base + mem_ttstd * 8
  * 
  *   def _realloc_tri(self, m):             # <<<<<<<<<<<<<<
  *     if len(self._tri) < m:
- *       self._tri = None                         # Dealloc previous memory
+ *       # Greater batch received, dealloc the previous triangle and alloc new one
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11statmoments_7_native_11bivar_txtbk_3_realloc_tri(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_11statmoments_7_native_11bivar_txtbk_3_realloc_tri = {"_realloc_tri", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_11bivar_txtbk_3_realloc_tri, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11statmoments_7_native_11bivar_txtbk_3_realloc_tri(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_11statmoments_7_native_11bivar_txtbk_7_realloc_tri(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_11statmoments_7_native_11bivar_txtbk_7_realloc_tri = {"_realloc_tri", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_11bivar_txtbk_7_realloc_tri, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11statmoments_7_native_11bivar_txtbk_7_realloc_tri(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_m = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
@@ -29793,126 +31233,126 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_realloc_tri", 1, 2, 2, 1); __PYX_ERR(0, 868, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_realloc_tri", 1, 2, 2, 1); __PYX_ERR(0, 953, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_realloc_tri") < 0)) __PYX_ERR(0, 868, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_realloc_tri") < 0)) __PYX_ERR(0, 953, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_m = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_realloc_tri", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 868, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_realloc_tri", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 953, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native.bivar_txtbk._realloc_tri", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11statmoments_7_native_11bivar_txtbk_2_realloc_tri(__pyx_self, __pyx_v_self, __pyx_v_m);
+  __pyx_r = __pyx_pf_11statmoments_7_native_11bivar_txtbk_6_realloc_tri(__pyx_self, __pyx_v_self, __pyx_v_m);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11statmoments_7_native_11bivar_txtbk_2_realloc_tri(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_m) {
+static PyObject *__pyx_pf_11statmoments_7_native_11bivar_txtbk_6_realloc_tri(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_m) {
   PyObject *__pyx_v_n = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   Py_ssize_t __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_realloc_tri", 0);
 
-  /* "statmoments/_native.pyx":869
+  /* "statmoments/_native.pyx":954
  * 
  *   def _realloc_tri(self, m):
  *     if len(self._tri) < m:             # <<<<<<<<<<<<<<
- *       self._tri = None                         # Dealloc previous memory
+ *       # Greater batch received, dealloc the previous triangle and alloc new one
  *       n = self.traces.shape[1]
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_tri); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 869, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_tri); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 954, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 869, __pyx_L1_error)
+  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 954, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 869, __pyx_L1_error)
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 954, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyObject_RichCompare(__pyx_t_1, __pyx_v_m, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 869, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_t_1, __pyx_v_m, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 954, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 869, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 954, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "statmoments/_native.pyx":870
- *   def _realloc_tri(self, m):
- *     if len(self._tri) < m:
- *       self._tri = None                         # Dealloc previous memory             # <<<<<<<<<<<<<<
- *       n = self.traces.shape[1]
- *       self._tri = np.empty((m, n * (n+1)//2))  # Alloc new triangle dynamically
- */
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_tri, Py_None) < 0) __PYX_ERR(0, 870, __pyx_L1_error)
-
-    /* "statmoments/_native.pyx":871
+    /* "statmoments/_native.pyx":956
  *     if len(self._tri) < m:
- *       self._tri = None                         # Dealloc previous memory
+ *       # Greater batch received, dealloc the previous triangle and alloc new one
  *       n = self.traces.shape[1]             # <<<<<<<<<<<<<<
- *       self._tri = np.empty((m, n * (n+1)//2))  # Alloc new triangle dynamically
- *     return self._tri[:m]
+ *       self._tri = None
+ *       self._tri = np.empty((m, n * (n + 1) // 2))
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_traces); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 871, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_traces); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 956, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 871, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 956, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 871, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 956, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_v_n = __pyx_t_3;
     __pyx_t_3 = 0;
 
-    /* "statmoments/_native.pyx":872
- *       self._tri = None                         # Dealloc previous memory
+    /* "statmoments/_native.pyx":957
+ *       # Greater batch received, dealloc the previous triangle and alloc new one
  *       n = self.traces.shape[1]
- *       self._tri = np.empty((m, n * (n+1)//2))  # Alloc new triangle dynamically             # <<<<<<<<<<<<<<
+ *       self._tri = None             # <<<<<<<<<<<<<<
+ *       self._tri = np.empty((m, n * (n + 1) // 2))
+ *     return self._tri[:m]
+ */
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_tri, Py_None) < 0) __PYX_ERR(0, 957, __pyx_L1_error)
+
+    /* "statmoments/_native.pyx":958
+ *       n = self.traces.shape[1]
+ *       self._tri = None
+ *       self._tri = np.empty((m, n * (n + 1) // 2))             # <<<<<<<<<<<<<<
  *     return self._tri[:m]
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 872, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 958, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 872, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 958, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_v_n, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 872, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_v_n, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 958, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = PyNumber_Multiply(__pyx_v_n, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 872, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Multiply(__pyx_v_n, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 958, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_6, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 872, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_6, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 958, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 872, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 958, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_INCREF(__pyx_v_m);
     __Pyx_GIVEREF(__pyx_v_m);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_m);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_1);
     __pyx_t_1 = 0;
@@ -29925,52 +31365,52 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_3 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_1, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 872, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 958, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_tri, __pyx_t_3) < 0) __PYX_ERR(0, 872, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_tri, __pyx_t_3) < 0) __PYX_ERR(0, 958, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "statmoments/_native.pyx":869
+    /* "statmoments/_native.pyx":954
  * 
  *   def _realloc_tri(self, m):
  *     if len(self._tri) < m:             # <<<<<<<<<<<<<<
- *       self._tri = None                         # Dealloc previous memory
+ *       # Greater batch received, dealloc the previous triangle and alloc new one
  *       n = self.traces.shape[1]
  */
   }
 
-  /* "statmoments/_native.pyx":873
- *       n = self.traces.shape[1]
- *       self._tri = np.empty((m, n * (n+1)//2))  # Alloc new triangle dynamically
+  /* "statmoments/_native.pyx":959
+ *       self._tri = None
+ *       self._tri = np.empty((m, n * (n + 1) // 2))
  *     return self._tri[:m]             # <<<<<<<<<<<<<<
  * 
  *   def _comoments(self, moments, normalize):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_tri); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 873, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_tri); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 959, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_t_3, 0, 0, NULL, &__pyx_v_m, NULL, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 873, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_t_3, 0, 0, NULL, &__pyx_v_m, NULL, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 959, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_r = __pyx_t_5;
   __pyx_t_5 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":868
- *     self._tri  = np.empty((m, n * (n+1)//2))   # Handle the triangle dynamically
+  /* "statmoments/_native.pyx":953
+ *     return mem_base + mem_ttstd * 8
  * 
  *   def _realloc_tri(self, m):             # <<<<<<<<<<<<<<
  *     if len(self._tri) < m:
- *       self._tri = None                         # Dealloc previous memory
+ *       # Greater batch received, dealloc the previous triangle and alloc new one
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_5);
@@ -29979,28 +31419,28 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_n);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
-static PyObject *__pyx_gb_11statmoments_7_native_11bivar_txtbk_6generator7(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
+static PyObject *__pyx_gb_11statmoments_7_native_11bivar_txtbk_10generator7(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "statmoments/_native.pyx":875
+/* "statmoments/_native.pyx":961
  *     return self._tri[:m]
  * 
  *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
- *     C = self._tmpsq
- *     tr_len, cl_len = self.trace_len, self.cls.shape[1]
+ *     min_cnt, C = self.acc_min_count, self._tmpsq
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11statmoments_7_native_11bivar_txtbk_5_comoments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_11statmoments_7_native_11bivar_txtbk_5_comoments = {"_comoments", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_11bivar_txtbk_5_comoments, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11statmoments_7_native_11bivar_txtbk_5_comoments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_11statmoments_7_native_11bivar_txtbk_9_comoments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_11statmoments_7_native_11bivar_txtbk_9_comoments = {"_comoments", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_11bivar_txtbk_9_comoments, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11statmoments_7_native_11bivar_txtbk_9_comoments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_moments = 0;
   PyObject *__pyx_v_normalize = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
@@ -30027,79 +31467,79 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moments)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, 1); __PYX_ERR(0, 875, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, 1); __PYX_ERR(0, 961, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_normalize)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, 2); __PYX_ERR(0, 875, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, 2); __PYX_ERR(0, 961, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_comoments") < 0)) __PYX_ERR(0, 875, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_comoments") < 0)) __PYX_ERR(0, 961, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_moments = values[1];
     __pyx_v_normalize = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 875, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 961, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native.bivar_txtbk._comoments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11statmoments_7_native_11bivar_txtbk_4_comoments(__pyx_self, __pyx_v_self, __pyx_v_moments, __pyx_v_normalize);
+  __pyx_r = __pyx_pf_11statmoments_7_native_11bivar_txtbk_8_comoments(__pyx_self, __pyx_v_self, __pyx_v_moments, __pyx_v_normalize);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11statmoments_7_native_11bivar_txtbk_4_comoments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize) {
+static PyObject *__pyx_pf_11statmoments_7_native_11bivar_txtbk_8_comoments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize) {
   struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_14__comoments *__pyx_cur_scope;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_comoments", 0);
   __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_14__comoments *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_14__comoments(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_14__comoments, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_14__comoments *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 875, __pyx_L1_error)
+    __PYX_ERR(0, 961, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
   __pyx_cur_scope->__pyx_v_moments = __pyx_v_moments;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_moments);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_moments);
   __pyx_cur_scope->__pyx_v_normalize = __pyx_v_normalize;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_normalize);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_normalize);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_11bivar_txtbk_6generator7, __pyx_codeobj__36, (PyObject *) __pyx_cur_scope, __pyx_n_s_comoments, __pyx_n_s_bivar_txtbk__comoments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 875, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_11bivar_txtbk_10generator7, __pyx_codeobj__35, (PyObject *) __pyx_cur_scope, __pyx_n_s_comoments, __pyx_n_s_bivar_txtbk__comoments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 961, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -30107,34 +31547,34 @@
   __pyx_r = NULL;
   __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_gb_11statmoments_7_native_11bivar_txtbk_6generator7(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
+static PyObject *__pyx_gb_11statmoments_7_native_11bivar_txtbk_10generator7(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
 {
   struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_14__comoments *__pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_14__comoments *)__pyx_generator->closure);
   PyObject *__pyx_r = NULL;
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
-  Py_ssize_t __pyx_t_4;
-  PyObject *(*__pyx_t_5)(PyObject *);
+  Py_ssize_t __pyx_t_3;
+  PyObject *(*__pyx_t_4)(PyObject *);
+  PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   int __pyx_t_7;
   long __pyx_t_8;
   PyObject *__pyx_t_9 = NULL;
   int __pyx_t_10;
   PyObject *__pyx_t_11 = NULL;
   PyObject *(*__pyx_t_12)(PyObject *);
   Py_ssize_t __pyx_t_13;
-  PyObject *(*__pyx_t_14)(PyObject *);
-  PyObject *__pyx_t_15 = NULL;
-  int __pyx_t_16;
+  int __pyx_t_14;
+  PyObject *(*__pyx_t_15)(PyObject *);
+  PyObject *__pyx_t_16 = NULL;
   __Pyx_memviewslice __pyx_t_17 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_t_18;
   __Pyx_memviewslice __pyx_t_19 = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_t_20 = NULL;
   int __pyx_t_21;
   PyObject *__pyx_t_22 = NULL;
   PyObject *__pyx_t_23 = NULL;
@@ -30143,740 +31583,778 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("_comoments", 0);
   switch (__pyx_generator->resume_label) {
     case 0: goto __pyx_L3_first_run;
-    case 1: goto __pyx_L17_resume_from_yield;
+    case 1: goto __pyx_L18_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 875, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 961, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":876
+  /* "statmoments/_native.pyx":962
  * 
  *   def _comoments(self, moments, normalize):
- *     C = self._tmpsq             # <<<<<<<<<<<<<<
- *     tr_len, cl_len = self.trace_len, self.cls.shape[1]
+ *     min_cnt, C = self.acc_min_count, self._tmpsq             # <<<<<<<<<<<<<<
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len
  *     for ii in range(cl_len):
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_tmpsq); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 876, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_acc_min_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 962, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_tmpsq); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 962, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
-  __pyx_cur_scope->__pyx_v_C = __pyx_t_1;
+  __pyx_cur_scope->__pyx_v_min_cnt = __pyx_t_1;
   __pyx_t_1 = 0;
+  __Pyx_GIVEREF(__pyx_t_2);
+  __pyx_cur_scope->__pyx_v_C = __pyx_t_2;
+  __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":877
+  /* "statmoments/_native.pyx":963
  *   def _comoments(self, moments, normalize):
- *     C = self._tmpsq
- *     tr_len, cl_len = self.trace_len, self.cls.shape[1]             # <<<<<<<<<<<<<<
+ *     min_cnt, C = self.acc_min_count, self._tmpsq
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len             # <<<<<<<<<<<<<<
  *     for ii in range(cl_len):
- *       cl_set = [(self.cls[:,ii] == 0)]
+ *       cl_set = [(self.cls[:, ii] == 0)]
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 877, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_cls); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 877, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 877, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 877, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 963, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_GIVEREF(__pyx_t_1);
-  __pyx_cur_scope->__pyx_v_tr_len = __pyx_t_1;
-  __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_classifiers_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 963, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_cur_scope->__pyx_v_cl_len = __pyx_t_2;
+  __pyx_cur_scope->__pyx_v_tr_len = __pyx_t_2;
   __pyx_t_2 = 0;
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_cur_scope->__pyx_v_cl_len = __pyx_t_1;
+  __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":878
- *     C = self._tmpsq
- *     tr_len, cl_len = self.trace_len, self.cls.shape[1]
+  /* "statmoments/_native.pyx":964
+ *     min_cnt, C = self.acc_min_count, self._tmpsq
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len
  *     for ii in range(cl_len):             # <<<<<<<<<<<<<<
- *       cl_set = [(self.cls[:,ii] == 0)]
+ *       cl_set = [(self.cls[:, ii] == 0)]
  *       cl_set.append(~(cl_set[0]))
  */
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_cur_scope->__pyx_v_cl_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 878, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
-    __pyx_t_1 = __pyx_t_2; __Pyx_INCREF(__pyx_t_1); __pyx_t_4 = 0;
-    __pyx_t_5 = NULL;
+  __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_cur_scope->__pyx_v_cl_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 964, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
+    __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
+    __pyx_t_4 = NULL;
   } else {
-    __pyx_t_4 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 878, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 878, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 964, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 964, __pyx_L1_error)
   }
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
-    if (likely(!__pyx_t_5)) {
-      if (likely(PyList_CheckExact(__pyx_t_1))) {
-        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_1)) break;
+    if (likely(!__pyx_t_4)) {
+      if (likely(PyList_CheckExact(__pyx_t_2))) {
+        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 878, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 964, __pyx_L1_error)
         #else
-        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 878, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 964, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
-        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
+        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 878, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 964, __pyx_L1_error)
         #else
-        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 878, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 964, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
-      __pyx_t_2 = __pyx_t_5(__pyx_t_1);
-      if (unlikely(!__pyx_t_2)) {
+      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
+      if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 878, __pyx_L1_error)
+          else __PYX_ERR(0, 964, __pyx_L1_error)
         }
         break;
       }
-      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_ii);
-    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_ii, __pyx_t_2);
-    __Pyx_GIVEREF(__pyx_t_2);
-    __pyx_t_2 = 0;
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_ii, __pyx_t_1);
+    __Pyx_GIVEREF(__pyx_t_1);
+    __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":879
- *     tr_len, cl_len = self.trace_len, self.cls.shape[1]
+    /* "statmoments/_native.pyx":965
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len
  *     for ii in range(cl_len):
- *       cl_set = [(self.cls[:,ii] == 0)]             # <<<<<<<<<<<<<<
+ *       cl_set = [(self.cls[:, ii] == 0)]             # <<<<<<<<<<<<<<
  *       cl_set.append(~(cl_set[0]))
  *       for _i in range(2):
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_cls); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 879, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 879, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_INCREF(__pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_slice__5);
-    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_slice__5);
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_cls); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 965, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 965, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_INCREF(__pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_slice__7);
+    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_slice__7);
     __Pyx_INCREF(__pyx_cur_scope->__pyx_v_ii);
     __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_ii);
-    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_cur_scope->__pyx_v_ii);
-    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 879, __pyx_L1_error)
+    PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_cur_scope->__pyx_v_ii);
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 965, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_t_6, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 879, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_t_6, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 965, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyList_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 879, __pyx_L1_error)
+    __pyx_t_6 = PyList_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 965, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_GIVEREF(__pyx_t_3);
-    PyList_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
-    __pyx_t_3 = 0;
+    __Pyx_GIVEREF(__pyx_t_5);
+    PyList_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
+    __pyx_t_5 = 0;
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_cl_set);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_cl_set, ((PyObject*)__pyx_t_6));
     __Pyx_GIVEREF(__pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":880
+    /* "statmoments/_native.pyx":966
  *     for ii in range(cl_len):
- *       cl_set = [(self.cls[:,ii] == 0)]
+ *       cl_set = [(self.cls[:, ii] == 0)]
  *       cl_set.append(~(cl_set[0]))             # <<<<<<<<<<<<<<
  *       for _i in range(2):
- *         mft = _sort_meanfree(self.traces[cl_set[_i]], False)
+ *         mft  = _sort_meanfree(self.traces[cl_set[_i]], False)
  */
-    __pyx_t_6 = PyNumber_Invert(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_cl_set, 0)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 880, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Invert(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_cl_set, 0)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 966, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = __Pyx_PyList_Append(__pyx_cur_scope->__pyx_v_cl_set, __pyx_t_6); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 880, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyList_Append(__pyx_cur_scope->__pyx_v_cl_set, __pyx_t_6); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 966, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":881
- *       cl_set = [(self.cls[:,ii] == 0)]
+    /* "statmoments/_native.pyx":967
+ *       cl_set = [(self.cls[:, ii] == 0)]
  *       cl_set.append(~(cl_set[0]))
  *       for _i in range(2):             # <<<<<<<<<<<<<<
- *         mft = _sort_meanfree(self.traces[cl_set[_i]], False)
+ *         mft  = _sort_meanfree(self.traces[cl_set[_i]], False)
  *         m, n = mft.shape
  */
     for (__pyx_t_8 = 0; __pyx_t_8 < 2; __pyx_t_8+=1) {
       __pyx_cur_scope->__pyx_v__i = __pyx_t_8;
 
-      /* "statmoments/_native.pyx":882
+      /* "statmoments/_native.pyx":968
  *       cl_set.append(~(cl_set[0]))
  *       for _i in range(2):
- *         mft = _sort_meanfree(self.traces[cl_set[_i]], False)             # <<<<<<<<<<<<<<
+ *         mft  = _sort_meanfree(self.traces[cl_set[_i]], False)             # <<<<<<<<<<<<<<
  *         m, n = mft.shape
- * 
+ *         retm = self._retm[_i]
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_sort_meanfree); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 882, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_traces); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 882, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_t_2, PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_cl_set, __pyx_cur_scope->__pyx_v__i)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 882, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sort_meanfree); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 968, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_traces); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 968, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_t_1, PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_cl_set, __pyx_cur_scope->__pyx_v__i)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 968, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = NULL;
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_t_1 = NULL;
       __pyx_t_10 = 0;
-      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
-        __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
-        if (likely(__pyx_t_2)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-          __Pyx_INCREF(__pyx_t_2);
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
+        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
+        if (likely(__pyx_t_1)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
+          __Pyx_INCREF(__pyx_t_1);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_3, function);
+          __Pyx_DECREF_SET(__pyx_t_5, function);
           __pyx_t_10 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
-      if (PyFunction_Check(__pyx_t_3)) {
-        PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_9, Py_False};
-        __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 882, __pyx_L1_error)
-        __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+      if (PyFunction_Check(__pyx_t_5)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_9, Py_False};
+        __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 968, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
-      if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
-        PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_9, Py_False};
-        __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 882, __pyx_L1_error)
-        __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_9, Py_False};
+        __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 968, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       } else
       #endif
       {
-        __pyx_t_11 = PyTuple_New(2+__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 882, __pyx_L1_error)
+        __pyx_t_11 = PyTuple_New(2+__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 968, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
-        if (__pyx_t_2) {
-          __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_2); __pyx_t_2 = NULL;
+        if (__pyx_t_1) {
+          __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_1); __pyx_t_1 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_9);
         PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_10, __pyx_t_9);
         __Pyx_INCREF(Py_False);
         __Pyx_GIVEREF(Py_False);
         PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_10, Py_False);
         __pyx_t_9 = 0;
-        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_11, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 882, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_11, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 968, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       }
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_mft);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_mft, __pyx_t_6);
       __Pyx_GIVEREF(__pyx_t_6);
       __pyx_t_6 = 0;
 
-      /* "statmoments/_native.pyx":883
+      /* "statmoments/_native.pyx":969
  *       for _i in range(2):
- *         mft = _sort_meanfree(self.traces[cl_set[_i]], False)
+ *         mft  = _sort_meanfree(self.traces[cl_set[_i]], False)
  *         m, n = mft.shape             # <<<<<<<<<<<<<<
- * 
  *         retm = self._retm[_i]
+ *         tri  = self._realloc_tri(len(mft))
  */
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_mft, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 883, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_mft, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 969, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       if ((likely(PyTuple_CheckExact(__pyx_t_6))) || (PyList_CheckExact(__pyx_t_6))) {
         PyObject* sequence = __pyx_t_6;
         Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
         if (unlikely(size != 2)) {
           if (size > 2) __Pyx_RaiseTooManyValuesError(2);
           else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-          __PYX_ERR(0, 883, __pyx_L1_error)
+          __PYX_ERR(0, 969, __pyx_L1_error)
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
         if (likely(PyTuple_CheckExact(sequence))) {
-          __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
+          __pyx_t_5 = PyTuple_GET_ITEM(sequence, 0); 
           __pyx_t_11 = PyTuple_GET_ITEM(sequence, 1); 
         } else {
-          __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
+          __pyx_t_5 = PyList_GET_ITEM(sequence, 0); 
           __pyx_t_11 = PyList_GET_ITEM(sequence, 1); 
         }
-        __Pyx_INCREF(__pyx_t_3);
+        __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_11);
         #else
-        __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 883, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_11 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 883, __pyx_L1_error)
+        __pyx_t_5 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 969, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_11 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 969, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
         #endif
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       } else {
         Py_ssize_t index = -1;
-        __pyx_t_9 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 883, __pyx_L1_error)
+        __pyx_t_9 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 969, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __pyx_t_12 = Py_TYPE(__pyx_t_9)->tp_iternext;
-        index = 0; __pyx_t_3 = __pyx_t_12(__pyx_t_9); if (unlikely(!__pyx_t_3)) goto __pyx_L8_unpacking_failed;
-        __Pyx_GOTREF(__pyx_t_3);
+        index = 0; __pyx_t_5 = __pyx_t_12(__pyx_t_9); if (unlikely(!__pyx_t_5)) goto __pyx_L8_unpacking_failed;
+        __Pyx_GOTREF(__pyx_t_5);
         index = 1; __pyx_t_11 = __pyx_t_12(__pyx_t_9); if (unlikely(!__pyx_t_11)) goto __pyx_L8_unpacking_failed;
         __Pyx_GOTREF(__pyx_t_11);
-        if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_9), 2) < 0) __PYX_ERR(0, 883, __pyx_L1_error)
+        if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_9), 2) < 0) __PYX_ERR(0, 969, __pyx_L1_error)
         __pyx_t_12 = NULL;
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         goto __pyx_L9_unpacking_done;
         __pyx_L8_unpacking_failed:;
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         __pyx_t_12 = NULL;
         if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-        __PYX_ERR(0, 883, __pyx_L1_error)
+        __PYX_ERR(0, 969, __pyx_L1_error)
         __pyx_L9_unpacking_done:;
       }
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_m);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_m, __pyx_t_3);
-      __Pyx_GIVEREF(__pyx_t_3);
-      __pyx_t_3 = 0;
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_m, __pyx_t_5);
+      __Pyx_GIVEREF(__pyx_t_5);
+      __pyx_t_5 = 0;
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_n);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_n, __pyx_t_11);
       __Pyx_GIVEREF(__pyx_t_11);
       __pyx_t_11 = 0;
 
-      /* "statmoments/_native.pyx":885
+      /* "statmoments/_native.pyx":970
+ *         mft  = _sort_meanfree(self.traces[cl_set[_i]], False)
  *         m, n = mft.shape
- * 
  *         retm = self._retm[_i]             # <<<<<<<<<<<<<<
- *         tri = self._realloc_tri(len(mft))
- * 
+ *         tri  = self._realloc_tri(len(mft))
+ *         if m < min_cnt:
  */
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 885, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 970, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_11 = __Pyx_GetItemInt(__pyx_t_6, __pyx_cur_scope->__pyx_v__i, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 885, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_GetItemInt(__pyx_t_6, __pyx_cur_scope->__pyx_v__i, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 970, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_retm);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_retm, __pyx_t_11);
       __Pyx_GIVEREF(__pyx_t_11);
       __pyx_t_11 = 0;
 
-      /* "statmoments/_native.pyx":886
- * 
+      /* "statmoments/_native.pyx":971
+ *         m, n = mft.shape
  *         retm = self._retm[_i]
- *         tri = self._realloc_tri(len(mft))             # <<<<<<<<<<<<<<
- * 
- *         for jj, (lm, rm) in enumerate(zip(*moments)):
+ *         tri  = self._realloc_tri(len(mft))             # <<<<<<<<<<<<<<
+ *         if m < min_cnt:
+ *           retm[:] = 0
  */
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_realloc_tri); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 886, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_realloc_tri); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 971, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_13 = PyObject_Length(__pyx_cur_scope->__pyx_v_mft); if (unlikely(__pyx_t_13 == ((Py_ssize_t)-1))) __PYX_ERR(0, 886, __pyx_L1_error)
-      __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_13); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 886, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_13 = PyObject_Length(__pyx_cur_scope->__pyx_v_mft); if (unlikely(__pyx_t_13 == ((Py_ssize_t)-1))) __PYX_ERR(0, 971, __pyx_L1_error)
+      __pyx_t_5 = PyInt_FromSsize_t(__pyx_t_13); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 971, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
       __pyx_t_9 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
         __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_6);
         if (likely(__pyx_t_9)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
           __Pyx_INCREF(__pyx_t_9);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_6, function);
         }
       }
-      __pyx_t_11 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_9, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_3);
+      __pyx_t_11 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_9, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_5);
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 886, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 971, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_tri);
       __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_tri, __pyx_t_11);
       __Pyx_GIVEREF(__pyx_t_11);
       __pyx_t_11 = 0;
 
-      /* "statmoments/_native.pyx":888
- *         tri = self._realloc_tri(len(mft))
+      /* "statmoments/_native.pyx":972
+ *         retm = self._retm[_i]
+ *         tri  = self._realloc_tri(len(mft))
+ *         if m < min_cnt:             # <<<<<<<<<<<<<<
+ *           retm[:] = 0
+ *           continue
+ */
+      __pyx_t_11 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_m, __pyx_cur_scope->__pyx_v_min_cnt, Py_LT); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 972, __pyx_L1_error)
+      __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_t_11); if (unlikely(__pyx_t_14 < 0)) __PYX_ERR(0, 972, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      if (__pyx_t_14) {
+
+        /* "statmoments/_native.pyx":973
+ *         tri  = self._realloc_tri(len(mft))
+ *         if m < min_cnt:
+ *           retm[:] = 0             # <<<<<<<<<<<<<<
+ *           continue
+ * 
+ */
+        if (__Pyx_PyObject_SetSlice(__pyx_cur_scope->__pyx_v_retm, __pyx_int_0, 0, 0, NULL, NULL, &__pyx_slice__7, 0, 0, 0) < 0) __PYX_ERR(0, 973, __pyx_L1_error)
+
+        /* "statmoments/_native.pyx":974
+ *         if m < min_cnt:
+ *           retm[:] = 0
+ *           continue             # <<<<<<<<<<<<<<
+ * 
+ *         for jj, (lm, rm) in enumerate(zip(*moments)):
+ */
+        goto __pyx_L6_continue;
+
+        /* "statmoments/_native.pyx":972
+ *         retm = self._retm[_i]
+ *         tri  = self._realloc_tri(len(mft))
+ *         if m < min_cnt:             # <<<<<<<<<<<<<<
+ *           retm[:] = 0
+ *           continue
+ */
+      }
+
+      /* "statmoments/_native.pyx":976
+ *           continue
  * 
  *         for jj, (lm, rm) in enumerate(zip(*moments)):             # <<<<<<<<<<<<<<
  *           tri = _uni2bivar(mft, C, tri, lm, rm) if lm == rm else _uni2bivar_neq(mft, C, tri, lm, rm)
  *           # Cut two-fold, to fit into memory
  */
       __Pyx_INCREF(__pyx_int_0);
       __pyx_t_11 = __pyx_int_0;
-      __pyx_t_6 = __Pyx_PySequence_Tuple(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 888, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PySequence_Tuple(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 976, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_zip, __pyx_t_6, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 888, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_zip, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 976, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
-        __pyx_t_6 = __pyx_t_3; __Pyx_INCREF(__pyx_t_6); __pyx_t_13 = 0;
-        __pyx_t_14 = NULL;
+      if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
+        __pyx_t_6 = __pyx_t_5; __Pyx_INCREF(__pyx_t_6); __pyx_t_13 = 0;
+        __pyx_t_15 = NULL;
       } else {
-        __pyx_t_13 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 888, __pyx_L1_error)
+        __pyx_t_13 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 976, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_14 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 888, __pyx_L1_error)
+        __pyx_t_15 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 976, __pyx_L1_error)
       }
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       for (;;) {
-        if (likely(!__pyx_t_14)) {
+        if (likely(!__pyx_t_15)) {
           if (likely(PyList_CheckExact(__pyx_t_6))) {
             if (__pyx_t_13 >= PyList_GET_SIZE(__pyx_t_6)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_3 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_13); __Pyx_INCREF(__pyx_t_3); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 888, __pyx_L1_error)
+            __pyx_t_5 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_13); __Pyx_INCREF(__pyx_t_5); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 976, __pyx_L1_error)
             #else
-            __pyx_t_3 = PySequence_ITEM(__pyx_t_6, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 888, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_3);
+            __pyx_t_5 = PySequence_ITEM(__pyx_t_6, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 976, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_5);
             #endif
           } else {
             if (__pyx_t_13 >= PyTuple_GET_SIZE(__pyx_t_6)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_13); __Pyx_INCREF(__pyx_t_3); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 888, __pyx_L1_error)
+            __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_13); __Pyx_INCREF(__pyx_t_5); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 976, __pyx_L1_error)
             #else
-            __pyx_t_3 = PySequence_ITEM(__pyx_t_6, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 888, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_3);
+            __pyx_t_5 = PySequence_ITEM(__pyx_t_6, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 976, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_5);
             #endif
           }
         } else {
-          __pyx_t_3 = __pyx_t_14(__pyx_t_6);
-          if (unlikely(!__pyx_t_3)) {
+          __pyx_t_5 = __pyx_t_15(__pyx_t_6);
+          if (unlikely(!__pyx_t_5)) {
             PyObject* exc_type = PyErr_Occurred();
             if (exc_type) {
               if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-              else __PYX_ERR(0, 888, __pyx_L1_error)
+              else __PYX_ERR(0, 976, __pyx_L1_error)
             }
             break;
           }
-          __Pyx_GOTREF(__pyx_t_3);
+          __Pyx_GOTREF(__pyx_t_5);
         }
-        if ((likely(PyTuple_CheckExact(__pyx_t_3))) || (PyList_CheckExact(__pyx_t_3))) {
-          PyObject* sequence = __pyx_t_3;
+        if ((likely(PyTuple_CheckExact(__pyx_t_5))) || (PyList_CheckExact(__pyx_t_5))) {
+          PyObject* sequence = __pyx_t_5;
           Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
           if (unlikely(size != 2)) {
             if (size > 2) __Pyx_RaiseTooManyValuesError(2);
             else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-            __PYX_ERR(0, 888, __pyx_L1_error)
+            __PYX_ERR(0, 976, __pyx_L1_error)
           }
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
           if (likely(PyTuple_CheckExact(sequence))) {
             __pyx_t_9 = PyTuple_GET_ITEM(sequence, 0); 
-            __pyx_t_2 = PyTuple_GET_ITEM(sequence, 1); 
+            __pyx_t_1 = PyTuple_GET_ITEM(sequence, 1); 
           } else {
             __pyx_t_9 = PyList_GET_ITEM(sequence, 0); 
-            __pyx_t_2 = PyList_GET_ITEM(sequence, 1); 
+            __pyx_t_1 = PyList_GET_ITEM(sequence, 1); 
           }
           __Pyx_INCREF(__pyx_t_9);
-          __Pyx_INCREF(__pyx_t_2);
+          __Pyx_INCREF(__pyx_t_1);
           #else
-          __pyx_t_9 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 888, __pyx_L1_error)
+          __pyx_t_9 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 976, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
-          __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 888, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_2);
+          __pyx_t_1 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 976, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_1);
           #endif
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         } else {
           Py_ssize_t index = -1;
-          __pyx_t_15 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 888, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_15);
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __pyx_t_12 = Py_TYPE(__pyx_t_15)->tp_iternext;
-          index = 0; __pyx_t_9 = __pyx_t_12(__pyx_t_15); if (unlikely(!__pyx_t_9)) goto __pyx_L12_unpacking_failed;
+          __pyx_t_16 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 976, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_16);
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+          __pyx_t_12 = Py_TYPE(__pyx_t_16)->tp_iternext;
+          index = 0; __pyx_t_9 = __pyx_t_12(__pyx_t_16); if (unlikely(!__pyx_t_9)) goto __pyx_L13_unpacking_failed;
           __Pyx_GOTREF(__pyx_t_9);
-          index = 1; __pyx_t_2 = __pyx_t_12(__pyx_t_15); if (unlikely(!__pyx_t_2)) goto __pyx_L12_unpacking_failed;
-          __Pyx_GOTREF(__pyx_t_2);
-          if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_15), 2) < 0) __PYX_ERR(0, 888, __pyx_L1_error)
+          index = 1; __pyx_t_1 = __pyx_t_12(__pyx_t_16); if (unlikely(!__pyx_t_1)) goto __pyx_L13_unpacking_failed;
+          __Pyx_GOTREF(__pyx_t_1);
+          if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_16), 2) < 0) __PYX_ERR(0, 976, __pyx_L1_error)
           __pyx_t_12 = NULL;
-          __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-          goto __pyx_L13_unpacking_done;
-          __pyx_L12_unpacking_failed:;
-          __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
+          __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
+          goto __pyx_L14_unpacking_done;
+          __pyx_L13_unpacking_failed:;
+          __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
           __pyx_t_12 = NULL;
           if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-          __PYX_ERR(0, 888, __pyx_L1_error)
-          __pyx_L13_unpacking_done:;
+          __PYX_ERR(0, 976, __pyx_L1_error)
+          __pyx_L14_unpacking_done:;
         }
         __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_lm);
         __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_lm, __pyx_t_9);
         __Pyx_GIVEREF(__pyx_t_9);
         __pyx_t_9 = 0;
         __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_rm);
-        __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_rm, __pyx_t_2);
-        __Pyx_GIVEREF(__pyx_t_2);
-        __pyx_t_2 = 0;
+        __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_rm, __pyx_t_1);
+        __Pyx_GIVEREF(__pyx_t_1);
+        __pyx_t_1 = 0;
         __Pyx_INCREF(__pyx_t_11);
         __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_jj);
         __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_jj, __pyx_t_11);
         __Pyx_GIVEREF(__pyx_t_11);
-        __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_t_11, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 888, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
+        __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_t_11, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 976, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_11);
-        __pyx_t_11 = __pyx_t_3;
-        __pyx_t_3 = 0;
+        __pyx_t_11 = __pyx_t_5;
+        __pyx_t_5 = 0;
 
-        /* "statmoments/_native.pyx":889
+        /* "statmoments/_native.pyx":977
  * 
  *         for jj, (lm, rm) in enumerate(zip(*moments)):
  *           tri = _uni2bivar(mft, C, tri, lm, rm) if lm == rm else _uni2bivar_neq(mft, C, tri, lm, rm)             # <<<<<<<<<<<<<<
  *           # Cut two-fold, to fit into memory
- *           np.mean(tri[:, :n//2], 0, out=retm[jj, :n//2])
+ *           np.mean(tri[:, :n // 2], 0, out=retm[jj, :n // 2])
  */
-        __pyx_t_2 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_lm, __pyx_cur_scope->__pyx_v_rm, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 889, __pyx_L1_error)
-        __pyx_t_16 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 889, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        if (__pyx_t_16) {
-          __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_cur_scope->__pyx_v_C, PyBUF_WRITABLE); if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 889, __pyx_L1_error)
-          __pyx_t_10 = __Pyx_PyInt_As_int(__pyx_cur_scope->__pyx_v_lm); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 889, __pyx_L1_error)
-          __pyx_t_18 = __Pyx_PyInt_As_int(__pyx_cur_scope->__pyx_v_rm); if (unlikely((__pyx_t_18 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 889, __pyx_L1_error)
-          __pyx_t_19 = __pyx_f_11statmoments_7_native__uni2bivar(__pyx_cur_scope->__pyx_v_mft, __pyx_t_17, __pyx_cur_scope->__pyx_v_tri, __pyx_t_10, __pyx_t_18); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 889, __pyx_L1_error)
+        __pyx_t_1 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_lm, __pyx_cur_scope->__pyx_v_rm, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 977, __pyx_L1_error)
+        __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_14 < 0)) __PYX_ERR(0, 977, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        if (__pyx_t_14) {
+          __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_cur_scope->__pyx_v_C, PyBUF_WRITABLE); if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 977, __pyx_L1_error)
+          __pyx_t_10 = __Pyx_PyInt_As_int(__pyx_cur_scope->__pyx_v_lm); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 977, __pyx_L1_error)
+          __pyx_t_18 = __Pyx_PyInt_As_int(__pyx_cur_scope->__pyx_v_rm); if (unlikely((__pyx_t_18 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 977, __pyx_L1_error)
+          __pyx_t_19 = __pyx_f_11statmoments_7_native__uni2bivar(__pyx_cur_scope->__pyx_v_mft, __pyx_t_17, __pyx_cur_scope->__pyx_v_tri, __pyx_t_10, __pyx_t_18); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 977, __pyx_L1_error)
           __PYX_XDEC_MEMVIEW(&__pyx_t_17, 1);
           __pyx_t_17.memview = NULL;
           __pyx_t_17.data = NULL;
-          __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_19, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 889, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_2);
+          __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_t_19, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 977, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_1);
           __PYX_XDEC_MEMVIEW(&__pyx_t_19, 1);
           __pyx_t_19.memview = NULL;
           __pyx_t_19.data = NULL;
-          __pyx_t_3 = __pyx_t_2;
-          __pyx_t_2 = 0;
+          __pyx_t_5 = __pyx_t_1;
+          __pyx_t_1 = 0;
         } else {
-          __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_cur_scope->__pyx_v_C, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 889, __pyx_L1_error)
-          __pyx_t_18 = __Pyx_PyInt_As_int(__pyx_cur_scope->__pyx_v_lm); if (unlikely((__pyx_t_18 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 889, __pyx_L1_error)
-          __pyx_t_10 = __Pyx_PyInt_As_int(__pyx_cur_scope->__pyx_v_rm); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 889, __pyx_L1_error)
-          __pyx_t_17 = __pyx_f_11statmoments_7_native__uni2bivar_neq(__pyx_cur_scope->__pyx_v_mft, __pyx_t_19, __pyx_cur_scope->__pyx_v_tri, __pyx_t_18, __pyx_t_10); if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 889, __pyx_L1_error)
+          __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_cur_scope->__pyx_v_C, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 977, __pyx_L1_error)
+          __pyx_t_18 = __Pyx_PyInt_As_int(__pyx_cur_scope->__pyx_v_lm); if (unlikely((__pyx_t_18 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 977, __pyx_L1_error)
+          __pyx_t_10 = __Pyx_PyInt_As_int(__pyx_cur_scope->__pyx_v_rm); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 977, __pyx_L1_error)
+          __pyx_t_17 = __pyx_f_11statmoments_7_native__uni2bivar_neq(__pyx_cur_scope->__pyx_v_mft, __pyx_t_19, __pyx_cur_scope->__pyx_v_tri, __pyx_t_18, __pyx_t_10); if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 977, __pyx_L1_error)
           __PYX_XDEC_MEMVIEW(&__pyx_t_19, 1);
           __pyx_t_19.memview = NULL;
           __pyx_t_19.data = NULL;
-          __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_17, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 889, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_2);
+          __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_t_17, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 977, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_1);
           __PYX_XDEC_MEMVIEW(&__pyx_t_17, 1);
           __pyx_t_17.memview = NULL;
           __pyx_t_17.data = NULL;
-          __pyx_t_3 = __pyx_t_2;
-          __pyx_t_2 = 0;
+          __pyx_t_5 = __pyx_t_1;
+          __pyx_t_1 = 0;
         }
         __Pyx_GOTREF(__pyx_cur_scope->__pyx_v_tri);
-        __Pyx_DECREF_SET(__pyx_cur_scope->__pyx_v_tri, __pyx_t_3);
-        __Pyx_GIVEREF(__pyx_t_3);
-        __pyx_t_3 = 0;
+        __Pyx_DECREF_SET(__pyx_cur_scope->__pyx_v_tri, __pyx_t_5);
+        __Pyx_GIVEREF(__pyx_t_5);
+        __pyx_t_5 = 0;
 
-        /* "statmoments/_native.pyx":891
+        /* "statmoments/_native.pyx":979
  *           tri = _uni2bivar(mft, C, tri, lm, rm) if lm == rm else _uni2bivar_neq(mft, C, tri, lm, rm)
  *           # Cut two-fold, to fit into memory
- *           np.mean(tri[:, :n//2], 0, out=retm[jj, :n//2])             # <<<<<<<<<<<<<<
- *           np.mean(tri[:, n//2:], 0, out=retm[jj, n//2:])
+ *           np.mean(tri[:, :n // 2], 0, out=retm[jj, :n // 2])             # <<<<<<<<<<<<<<
+ *           np.mean(tri[:, n // 2:], 0, out=retm[jj, n // 2:])
  *           if (lm + rm >= 3) and normalize:
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 891, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_mean); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 891, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __pyx_t_3 = __Pyx_PyInt_FloorDivideObjC(__pyx_cur_scope->__pyx_v_n, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 891, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_9 = PySlice_New(Py_None, __pyx_t_3, Py_None); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 891, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 979, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_mean); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 979, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __pyx_t_5 = __Pyx_PyInt_FloorDivideObjC(__pyx_cur_scope->__pyx_v_n, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 979, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_9 = PySlice_New(Py_None, __pyx_t_5, Py_None); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 979, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 891, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_slice__5);
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 979, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_slice__7);
         __Pyx_GIVEREF(__pyx_t_9);
-        PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_9);
+        PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_9);
         __pyx_t_9 = 0;
-        __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_tri, __pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 891, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_tri, __pyx_t_5); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 979, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 891, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 979, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
         __Pyx_GIVEREF(__pyx_t_9);
-        PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_9);
+        PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_9);
         __Pyx_INCREF(__pyx_int_0);
         __Pyx_GIVEREF(__pyx_int_0);
-        PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_0);
+        PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_0);
         __pyx_t_9 = 0;
-        __pyx_t_9 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 891, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 979, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
-        __pyx_t_15 = __Pyx_PyInt_FloorDivideObjC(__pyx_cur_scope->__pyx_v_n, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 891, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_15);
-        __pyx_t_20 = PySlice_New(Py_None, __pyx_t_15, Py_None); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 891, __pyx_L1_error)
+        __pyx_t_16 = __Pyx_PyInt_FloorDivideObjC(__pyx_cur_scope->__pyx_v_n, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 979, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_16);
+        __pyx_t_20 = PySlice_New(Py_None, __pyx_t_16, Py_None); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 979, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
-        __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-        __pyx_t_15 = PyTuple_New(2); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 891, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_15);
+        __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
+        __pyx_t_16 = PyTuple_New(2); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 979, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_16);
         __Pyx_INCREF(__pyx_cur_scope->__pyx_v_jj);
         __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_jj);
-        PyTuple_SET_ITEM(__pyx_t_15, 0, __pyx_cur_scope->__pyx_v_jj);
+        PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_cur_scope->__pyx_v_jj);
         __Pyx_GIVEREF(__pyx_t_20);
-        PyTuple_SET_ITEM(__pyx_t_15, 1, __pyx_t_20);
+        PyTuple_SET_ITEM(__pyx_t_16, 1, __pyx_t_20);
         __pyx_t_20 = 0;
-        __pyx_t_20 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_15); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 891, __pyx_L1_error)
+        __pyx_t_20 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_16); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 979, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
-        __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-        if (PyDict_SetItem(__pyx_t_9, __pyx_n_s_out, __pyx_t_20) < 0) __PYX_ERR(0, 891, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
+        if (PyDict_SetItem(__pyx_t_9, __pyx_n_s_out, __pyx_t_20) < 0) __PYX_ERR(0, 979, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-        __pyx_t_20 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_9); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 891, __pyx_L1_error)
+        __pyx_t_20 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_5, __pyx_t_9); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 979, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
 
-        /* "statmoments/_native.pyx":892
+        /* "statmoments/_native.pyx":980
  *           # Cut two-fold, to fit into memory
- *           np.mean(tri[:, :n//2], 0, out=retm[jj, :n//2])
- *           np.mean(tri[:, n//2:], 0, out=retm[jj, n//2:])             # <<<<<<<<<<<<<<
+ *           np.mean(tri[:, :n // 2], 0, out=retm[jj, :n // 2])
+ *           np.mean(tri[:, n // 2:], 0, out=retm[jj, n // 2:])             # <<<<<<<<<<<<<<
  *           if (lm + rm >= 3) and normalize:
  *             triuflatten = _triuflatten_gen(tr_len)
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_20, __pyx_n_s_np); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 892, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_20, __pyx_n_s_np); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 980, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
-        __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_20, __pyx_n_s_mean); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 892, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_20, __pyx_n_s_mean); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 980, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-        __pyx_t_20 = __Pyx_PyInt_FloorDivideObjC(__pyx_cur_scope->__pyx_v_n, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 892, __pyx_L1_error)
+        __pyx_t_20 = __Pyx_PyInt_FloorDivideObjC(__pyx_cur_scope->__pyx_v_n, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 980, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
-        __pyx_t_3 = PySlice_New(__pyx_t_20, Py_None, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 892, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
+        __pyx_t_5 = PySlice_New(__pyx_t_20, Py_None, Py_None); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 980, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-        __pyx_t_20 = PyTuple_New(2); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 892, __pyx_L1_error)
+        __pyx_t_20 = PyTuple_New(2); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 980, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_20, 0, __pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_t_3);
-        PyTuple_SET_ITEM(__pyx_t_20, 1, __pyx_t_3);
-        __pyx_t_3 = 0;
-        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_tri, __pyx_t_20); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 892, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyTuple_SET_ITEM(__pyx_t_20, 0, __pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_t_5);
+        PyTuple_SET_ITEM(__pyx_t_20, 1, __pyx_t_5);
+        __pyx_t_5 = 0;
+        __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_tri, __pyx_t_20); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 980, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-        __pyx_t_20 = PyTuple_New(2); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 892, __pyx_L1_error)
+        __pyx_t_20 = PyTuple_New(2); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 980, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_20);
-        __Pyx_GIVEREF(__pyx_t_3);
-        PyTuple_SET_ITEM(__pyx_t_20, 0, __pyx_t_3);
+        __Pyx_GIVEREF(__pyx_t_5);
+        PyTuple_SET_ITEM(__pyx_t_20, 0, __pyx_t_5);
         __Pyx_INCREF(__pyx_int_0);
         __Pyx_GIVEREF(__pyx_int_0);
         PyTuple_SET_ITEM(__pyx_t_20, 1, __pyx_int_0);
-        __pyx_t_3 = 0;
-        __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 892, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_2 = __Pyx_PyInt_FloorDivideObjC(__pyx_cur_scope->__pyx_v_n, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 892, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_15 = PySlice_New(__pyx_t_2, Py_None, Py_None); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 892, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_15);
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 892, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_5 = 0;
+        __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 980, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_1 = __Pyx_PyInt_FloorDivideObjC(__pyx_cur_scope->__pyx_v_n, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 980, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __pyx_t_16 = PySlice_New(__pyx_t_1, Py_None, Py_None); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 980, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_16);
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 980, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
         __Pyx_INCREF(__pyx_cur_scope->__pyx_v_jj);
         __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_jj);
-        PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_cur_scope->__pyx_v_jj);
-        __Pyx_GIVEREF(__pyx_t_15);
-        PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_15);
-        __pyx_t_15 = 0;
-        __pyx_t_15 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_2); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 892, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_15);
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_out, __pyx_t_15) < 0) __PYX_ERR(0, 892, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-        __pyx_t_15 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_20, __pyx_t_3); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 892, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_15);
+        PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_cur_scope->__pyx_v_jj);
+        __Pyx_GIVEREF(__pyx_t_16);
+        PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_16);
+        __pyx_t_16 = 0;
+        __pyx_t_16 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 980, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_16);
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_out, __pyx_t_16) < 0) __PYX_ERR(0, 980, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
+        __pyx_t_16 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_20, __pyx_t_5); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 980, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_16);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
 
-        /* "statmoments/_native.pyx":893
- *           np.mean(tri[:, :n//2], 0, out=retm[jj, :n//2])
- *           np.mean(tri[:, n//2:], 0, out=retm[jj, n//2:])
+        /* "statmoments/_native.pyx":981
+ *           np.mean(tri[:, :n // 2], 0, out=retm[jj, :n // 2])
+ *           np.mean(tri[:, n // 2:], 0, out=retm[jj, n // 2:])
  *           if (lm + rm >= 3) and normalize:             # <<<<<<<<<<<<<<
  *             triuflatten = _triuflatten_gen(tr_len)
  *             sd = np.std(mft, axis=0)
  */
-        __pyx_t_15 = PyNumber_Add(__pyx_cur_scope->__pyx_v_lm, __pyx_cur_scope->__pyx_v_rm); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 893, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_15);
-        __pyx_t_3 = PyObject_RichCompare(__pyx_t_15, __pyx_int_3, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 893, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-        __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 893, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __pyx_t_16 = PyNumber_Add(__pyx_cur_scope->__pyx_v_lm, __pyx_cur_scope->__pyx_v_rm); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 981, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_16);
+        __pyx_t_5 = PyObject_RichCompare(__pyx_t_16, __pyx_int_3, Py_GE); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 981, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
+        __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 981, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         if (__pyx_t_21) {
         } else {
-          __pyx_t_16 = __pyx_t_21;
-          goto __pyx_L15_bool_binop_done;
+          __pyx_t_14 = __pyx_t_21;
+          goto __pyx_L16_bool_binop_done;
         }
-        __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_normalize); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 893, __pyx_L1_error)
-        __pyx_t_16 = __pyx_t_21;
-        __pyx_L15_bool_binop_done:;
-        if (__pyx_t_16) {
+        __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_normalize); if (unlikely(__pyx_t_21 < 0)) __PYX_ERR(0, 981, __pyx_L1_error)
+        __pyx_t_14 = __pyx_t_21;
+        __pyx_L16_bool_binop_done:;
+        if (__pyx_t_14) {
 
-          /* "statmoments/_native.pyx":894
- *           np.mean(tri[:, n//2:], 0, out=retm[jj, n//2:])
+          /* "statmoments/_native.pyx":982
+ *           np.mean(tri[:, n // 2:], 0, out=retm[jj, n // 2:])
  *           if (lm + rm >= 3) and normalize:
  *             triuflatten = _triuflatten_gen(tr_len)             # <<<<<<<<<<<<<<
  *             sd = np.std(mft, axis=0)
  *             retm[jj] /= triuflatten(np.outer(sd ** lm, sd ** rm))
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_15, __pyx_n_s_triuflatten_gen); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 894, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_15);
+          __Pyx_GetModuleGlobalName(__pyx_t_16, __pyx_n_s_triuflatten_gen); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 982, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_16);
           __pyx_t_20 = NULL;
-          if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_15))) {
-            __pyx_t_20 = PyMethod_GET_SELF(__pyx_t_15);
+          if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_16))) {
+            __pyx_t_20 = PyMethod_GET_SELF(__pyx_t_16);
             if (likely(__pyx_t_20)) {
-              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_15);
+              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_16);
               __Pyx_INCREF(__pyx_t_20);
               __Pyx_INCREF(function);
-              __Pyx_DECREF_SET(__pyx_t_15, function);
+              __Pyx_DECREF_SET(__pyx_t_16, function);
             }
           }
-          __pyx_t_3 = (__pyx_t_20) ? __Pyx_PyObject_Call2Args(__pyx_t_15, __pyx_t_20, __pyx_cur_scope->__pyx_v_tr_len) : __Pyx_PyObject_CallOneArg(__pyx_t_15, __pyx_cur_scope->__pyx_v_tr_len);
+          __pyx_t_5 = (__pyx_t_20) ? __Pyx_PyObject_Call2Args(__pyx_t_16, __pyx_t_20, __pyx_cur_scope->__pyx_v_tr_len) : __Pyx_PyObject_CallOneArg(__pyx_t_16, __pyx_cur_scope->__pyx_v_tr_len);
           __Pyx_XDECREF(__pyx_t_20); __pyx_t_20 = 0;
-          if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 894, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
-          __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
+          if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 982, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_5);
+          __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
           __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_triuflatten);
-          __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_triuflatten, __pyx_t_3);
-          __Pyx_GIVEREF(__pyx_t_3);
-          __pyx_t_3 = 0;
+          __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_triuflatten, __pyx_t_5);
+          __Pyx_GIVEREF(__pyx_t_5);
+          __pyx_t_5 = 0;
 
-          /* "statmoments/_native.pyx":895
+          /* "statmoments/_native.pyx":983
  *           if (lm + rm >= 3) and normalize:
  *             triuflatten = _triuflatten_gen(tr_len)
  *             sd = np.std(mft, axis=0)             # <<<<<<<<<<<<<<
  *             retm[jj] /= triuflatten(np.outer(sd ** lm, sd ** rm))
  * 
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 895, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_std); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 895, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_15);
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 895, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
+          __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 983, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_5);
+          __pyx_t_16 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_std); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 983, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_16);
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+          __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 983, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_5);
           __Pyx_INCREF(__pyx_cur_scope->__pyx_v_mft);
           __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_mft);
-          PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_cur_scope->__pyx_v_mft);
-          __pyx_t_20 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 895, __pyx_L1_error)
+          PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_cur_scope->__pyx_v_mft);
+          __pyx_t_20 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 983, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_20);
-          if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 895, __pyx_L1_error)
-          __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_15, __pyx_t_3, __pyx_t_20); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 895, __pyx_L1_error)
+          if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 983, __pyx_L1_error)
+          __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_16, __pyx_t_5, __pyx_t_20); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 983, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
-          __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
           __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_sd);
           __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_sd, __pyx_t_9);
           __Pyx_GIVEREF(__pyx_t_9);
           __pyx_t_9 = 0;
 
-          /* "statmoments/_native.pyx":896
+          /* "statmoments/_native.pyx":984
  *             triuflatten = _triuflatten_gen(tr_len)
  *             sd = np.std(mft, axis=0)
  *             retm[jj] /= triuflatten(np.outer(sd ** lm, sd ** rm))             # <<<<<<<<<<<<<<
  * 
- *     # Outdated code below, but still gives a hint how to ensure the results
+ *       yield self._retm[:, :len(moments[0])]
  */
           __Pyx_INCREF(__pyx_cur_scope->__pyx_v_jj);
           __pyx_t_9 = __pyx_cur_scope->__pyx_v_jj;
-          __pyx_t_20 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_9); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 896, __pyx_L1_error)
+          __pyx_t_20 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_9); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 984, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_20);
-          __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 896, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_2);
-          __pyx_t_22 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_outer); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 896, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 984, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_1);
+          __pyx_t_22 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_outer); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 984, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_22);
-          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-          __pyx_t_2 = PyNumber_Power(__pyx_cur_scope->__pyx_v_sd, __pyx_cur_scope->__pyx_v_lm, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 896, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_2);
-          __pyx_t_23 = PyNumber_Power(__pyx_cur_scope->__pyx_v_sd, __pyx_cur_scope->__pyx_v_rm, Py_None); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 896, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+          __pyx_t_1 = PyNumber_Power(__pyx_cur_scope->__pyx_v_sd, __pyx_cur_scope->__pyx_v_lm, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 984, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_1);
+          __pyx_t_23 = PyNumber_Power(__pyx_cur_scope->__pyx_v_sd, __pyx_cur_scope->__pyx_v_rm, Py_None); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 984, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_23);
           __pyx_t_24 = NULL;
           __pyx_t_10 = 0;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_22))) {
             __pyx_t_24 = PyMethod_GET_SELF(__pyx_t_22);
             if (likely(__pyx_t_24)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_22);
@@ -30884,166 +32362,176 @@
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_22, function);
               __pyx_t_10 = 1;
             }
           }
           #if CYTHON_FAST_PYCALL
           if (PyFunction_Check(__pyx_t_22)) {
-            PyObject *__pyx_temp[3] = {__pyx_t_24, __pyx_t_2, __pyx_t_23};
-            __pyx_t_15 = __Pyx_PyFunction_FastCall(__pyx_t_22, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 896, __pyx_L1_error)
+            PyObject *__pyx_temp[3] = {__pyx_t_24, __pyx_t_1, __pyx_t_23};
+            __pyx_t_16 = __Pyx_PyFunction_FastCall(__pyx_t_22, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 984, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_24); __pyx_t_24 = 0;
-            __Pyx_GOTREF(__pyx_t_15);
-            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+            __Pyx_GOTREF(__pyx_t_16);
+            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
             __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
           } else
           #endif
           #if CYTHON_FAST_PYCCALL
           if (__Pyx_PyFastCFunction_Check(__pyx_t_22)) {
-            PyObject *__pyx_temp[3] = {__pyx_t_24, __pyx_t_2, __pyx_t_23};
-            __pyx_t_15 = __Pyx_PyCFunction_FastCall(__pyx_t_22, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 896, __pyx_L1_error)
+            PyObject *__pyx_temp[3] = {__pyx_t_24, __pyx_t_1, __pyx_t_23};
+            __pyx_t_16 = __Pyx_PyCFunction_FastCall(__pyx_t_22, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 984, __pyx_L1_error)
             __Pyx_XDECREF(__pyx_t_24); __pyx_t_24 = 0;
-            __Pyx_GOTREF(__pyx_t_15);
-            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+            __Pyx_GOTREF(__pyx_t_16);
+            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
             __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
           } else
           #endif
           {
-            __pyx_t_25 = PyTuple_New(2+__pyx_t_10); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 896, __pyx_L1_error)
+            __pyx_t_25 = PyTuple_New(2+__pyx_t_10); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 984, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_25);
             if (__pyx_t_24) {
               __Pyx_GIVEREF(__pyx_t_24); PyTuple_SET_ITEM(__pyx_t_25, 0, __pyx_t_24); __pyx_t_24 = NULL;
             }
-            __Pyx_GIVEREF(__pyx_t_2);
-            PyTuple_SET_ITEM(__pyx_t_25, 0+__pyx_t_10, __pyx_t_2);
+            __Pyx_GIVEREF(__pyx_t_1);
+            PyTuple_SET_ITEM(__pyx_t_25, 0+__pyx_t_10, __pyx_t_1);
             __Pyx_GIVEREF(__pyx_t_23);
             PyTuple_SET_ITEM(__pyx_t_25, 1+__pyx_t_10, __pyx_t_23);
-            __pyx_t_2 = 0;
+            __pyx_t_1 = 0;
             __pyx_t_23 = 0;
-            __pyx_t_15 = __Pyx_PyObject_Call(__pyx_t_22, __pyx_t_25, NULL); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 896, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_15);
+            __pyx_t_16 = __Pyx_PyObject_Call(__pyx_t_22, __pyx_t_25, NULL); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 984, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_16);
             __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
           }
           __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
           __Pyx_INCREF(__pyx_cur_scope->__pyx_v_triuflatten);
           __pyx_t_22 = __pyx_cur_scope->__pyx_v_triuflatten; __pyx_t_25 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_22))) {
             __pyx_t_25 = PyMethod_GET_SELF(__pyx_t_22);
             if (likely(__pyx_t_25)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_22);
               __Pyx_INCREF(__pyx_t_25);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_22, function);
             }
           }
-          __pyx_t_3 = (__pyx_t_25) ? __Pyx_PyObject_Call2Args(__pyx_t_22, __pyx_t_25, __pyx_t_15) : __Pyx_PyObject_CallOneArg(__pyx_t_22, __pyx_t_15);
+          __pyx_t_5 = (__pyx_t_25) ? __Pyx_PyObject_Call2Args(__pyx_t_22, __pyx_t_25, __pyx_t_16) : __Pyx_PyObject_CallOneArg(__pyx_t_22, __pyx_t_16);
           __Pyx_XDECREF(__pyx_t_25); __pyx_t_25 = 0;
-          __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-          if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 896, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
+          __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
+          if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 984, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
-          __pyx_t_22 = __Pyx_PyNumber_InPlaceDivide(__pyx_t_20, __pyx_t_3); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 896, __pyx_L1_error)
+          __pyx_t_22 = __Pyx_PyNumber_InPlaceDivide(__pyx_t_20, __pyx_t_5); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 984, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_22);
           __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_9, __pyx_t_22) < 0)) __PYX_ERR(0, 896, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+          if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_9, __pyx_t_22) < 0)) __PYX_ERR(0, 984, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-          /* "statmoments/_native.pyx":893
- *           np.mean(tri[:, :n//2], 0, out=retm[jj, :n//2])
- *           np.mean(tri[:, n//2:], 0, out=retm[jj, n//2:])
+          /* "statmoments/_native.pyx":981
+ *           np.mean(tri[:, :n // 2], 0, out=retm[jj, :n // 2])
+ *           np.mean(tri[:, n // 2:], 0, out=retm[jj, n // 2:])
  *           if (lm + rm >= 3) and normalize:             # <<<<<<<<<<<<<<
  *             triuflatten = _triuflatten_gen(tr_len)
  *             sd = np.std(mft, axis=0)
  */
         }
 
-        /* "statmoments/_native.pyx":888
- *         tri = self._realloc_tri(len(mft))
+        /* "statmoments/_native.pyx":976
+ *           continue
  * 
  *         for jj, (lm, rm) in enumerate(zip(*moments)):             # <<<<<<<<<<<<<<
  *           tri = _uni2bivar(mft, C, tri, lm, rm) if lm == rm else _uni2bivar_neq(mft, C, tri, lm, rm)
  *           # Cut two-fold, to fit into memory
  */
       }
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      __pyx_L6_continue:;
     }
 
-    /* "statmoments/_native.pyx":878
- *     C = self._tmpsq
- *     tr_len, cl_len = self.trace_len, self.cls.shape[1]
- *     for ii in range(cl_len):             # <<<<<<<<<<<<<<
- *       cl_set = [(self.cls[:,ii] == 0)]
- *       cl_set.append(~(cl_set[0]))
- */
-  }
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-
-  /* "statmoments/_native.pyx":909
- *     # return tstat
+    /* "statmoments/_native.pyx":986
+ *             retm[jj] /= triuflatten(np.outer(sd ** lm, sd ** rm))
  * 
- *     yield self._retm[:, :len(moments[0])]             # <<<<<<<<<<<<<<
+ *       yield self._retm[:, :len(moments[0])]             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 909, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_11 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_moments, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 909, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_11);
-  __pyx_t_4 = PyObject_Length(__pyx_t_11); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 909, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_11 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 909, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_11);
-  __pyx_t_6 = PySlice_New(Py_None, __pyx_t_11, Py_None); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 909, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_11 = PyTuple_New(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 909, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_11);
-  __Pyx_INCREF(__pyx_slice__5);
-  __Pyx_GIVEREF(__pyx_slice__5);
-  PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_slice__5);
-  __Pyx_GIVEREF(__pyx_t_6);
-  PyTuple_SET_ITEM(__pyx_t_11, 1, __pyx_t_6);
-  __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 909, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_r = __pyx_t_6;
-  __pyx_t_6 = 0;
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
-  /* return from generator, yielding value */
-  __pyx_generator->resume_label = 1;
-  return __pyx_r;
-  __pyx_L17_resume_from_yield:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 909, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 986, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_11);
+    __pyx_t_6 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_moments, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 986, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_13 = PyObject_Length(__pyx_t_6); if (unlikely(__pyx_t_13 == ((Py_ssize_t)-1))) __PYX_ERR(0, 986, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_13); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 986, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_9 = PySlice_New(Py_None, __pyx_t_6, Py_None); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 986, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 986, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_INCREF(__pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_slice__7);
+    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_t_9);
+    PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_9);
+    __pyx_t_9 = 0;
+    __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_t_11, __pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 986, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
+    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_r = __pyx_t_9;
+    __pyx_t_9 = 0;
+    __Pyx_XGIVEREF(__pyx_t_2);
+    __pyx_cur_scope->__pyx_t_0 = __pyx_t_2;
+    __pyx_cur_scope->__pyx_t_1 = __pyx_t_3;
+    __pyx_cur_scope->__pyx_t_2 = __pyx_t_4;
+    __Pyx_XGIVEREF(__pyx_r);
+    __Pyx_RefNannyFinishContext();
+    __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
+    /* return from generator, yielding value */
+    __pyx_generator->resume_label = 1;
+    return __pyx_r;
+    __pyx_L18_resume_from_yield:;
+    __pyx_t_2 = __pyx_cur_scope->__pyx_t_0;
+    __pyx_cur_scope->__pyx_t_0 = 0;
+    __Pyx_XGOTREF(__pyx_t_2);
+    __pyx_t_3 = __pyx_cur_scope->__pyx_t_1;
+    __pyx_t_4 = __pyx_cur_scope->__pyx_t_2;
+    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 986, __pyx_L1_error)
+
+    /* "statmoments/_native.pyx":964
+ *     min_cnt, C = self.acc_min_count, self._tmpsq
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len
+ *     for ii in range(cl_len):             # <<<<<<<<<<<<<<
+ *       cl_set = [(self.cls[:, ii] == 0)]
+ *       cl_set.append(~(cl_set[0]))
+ */
+  }
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
-  /* "statmoments/_native.pyx":875
+  /* "statmoments/_native.pyx":961
  *     return self._tri[:m]
  * 
  *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
- *     C = self._tmpsq
- *     tr_len, cl_len = self.trace_len, self.cls.shape[1]
+ *     min_cnt, C = self.acc_min_count, self._tmpsq
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len
  */
 
   /* function exit code */
   PyErr_SetNone(PyExc_StopIteration);
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6);
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_XDECREF(__pyx_t_11);
-  __Pyx_XDECREF(__pyx_t_15);
+  __Pyx_XDECREF(__pyx_t_16);
   __PYX_XDEC_MEMVIEW(&__pyx_t_17, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_t_19, 1);
   __Pyx_XDECREF(__pyx_t_20);
   __Pyx_XDECREF(__pyx_t_22);
   __Pyx_XDECREF(__pyx_t_23);
   __Pyx_XDECREF(__pyx_t_24);
   __Pyx_XDECREF(__pyx_t_25);
@@ -31055,41 +32543,41 @@
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":920
+/* "statmoments/_native.pyx":998
  * class bivar_vtk(object):
  *   """A class, using vtk multivariate kernel. Covariance ONLY!!!"""
- *   def __init__(self, trace_len, classifier_len, moment=2, **kwargs):             # <<<<<<<<<<<<<<
- *     self.moment = moment
- *     self.trace_len = trace_len
+ *   def __init__(self, tr_len, classifier_len, moment=2, **kwargs):             # <<<<<<<<<<<<<<
+ *     self.moment = moment # In fact, only 1
+ *     self.trace_len = tr_len
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_11statmoments_7_native_9bivar_vtk_1__init__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_11statmoments_7_native_9bivar_vtk_1__init__ = {"__init__", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_9bivar_vtk_1__init__, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_11statmoments_7_native_9bivar_vtk_1__init__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
-  PyObject *__pyx_v_trace_len = 0;
+  PyObject *__pyx_v_tr_len = 0;
   PyObject *__pyx_v_classifier_len = 0;
   PyObject *__pyx_v_moment = 0;
   PyObject *__pyx_v_kwargs = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
   __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
   __Pyx_GOTREF(__pyx_v_kwargs);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_trace_len,&__pyx_n_s_classifier_len,&__pyx_n_s_moment,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_tr_len,&__pyx_n_s_classifier_len,&__pyx_n_s_moment,0};
     PyObject* values[4] = {0,0,0,0};
     values[3] = ((PyObject *)((PyObject *)__pyx_int_2));
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
@@ -31106,73 +32594,73 @@
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_trace_len)) != 0)) kw_args--;
+        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 3, 4, 1); __PYX_ERR(0, 920, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 3, 4, 1); __PYX_ERR(0, 998, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifier_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 3, 4, 2); __PYX_ERR(0, 920, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 3, 4, 2); __PYX_ERR(0, 998, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moment);
           if (value) { values[3] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 920, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 998, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_self = values[0];
-    __pyx_v_trace_len = values[1];
+    __pyx_v_tr_len = values[1];
     __pyx_v_classifier_len = values[2];
     __pyx_v_moment = values[3];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 0, 3, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 920, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 0, 3, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 998, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
   __Pyx_AddTraceback("statmoments._native.bivar_vtk.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11statmoments_7_native_9bivar_vtk___init__(__pyx_self, __pyx_v_self, __pyx_v_trace_len, __pyx_v_classifier_len, __pyx_v_moment, __pyx_v_kwargs);
+  __pyx_r = __pyx_pf_11statmoments_7_native_9bivar_vtk___init__(__pyx_self, __pyx_v_self, __pyx_v_tr_len, __pyx_v_classifier_len, __pyx_v_moment, __pyx_v_kwargs);
 
   /* function exit code */
   __Pyx_XDECREF(__pyx_v_kwargs);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11statmoments_7_native_9bivar_vtk___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_trace_len, PyObject *__pyx_v_classifier_len, PyObject *__pyx_v_moment, PyObject *__pyx_v_kwargs) {
+static PyObject *__pyx_pf_11statmoments_7_native_9bivar_vtk___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_tr_len, PyObject *__pyx_v_classifier_len, PyObject *__pyx_v_moment, PyObject *__pyx_v_kwargs) {
   PyObject *__pyx_v_mcss = NULL;
   PyObject *__pyx_v_mcs = NULL;
-  CYTHON_UNUSED PyObject *__pyx_8genexpr6__pyx_v__ = NULL;
-  CYTHON_UNUSED long __pyx_8genexpr7__pyx_v_i;
-  CYTHON_UNUSED PyObject *__pyx_8genexpr8__pyx_v_i = NULL;
+  CYTHON_UNUSED PyObject *__pyx_8genexpr7__pyx_v__ = NULL;
+  CYTHON_UNUSED long __pyx_8genexpr8__pyx_v_i;
+  CYTHON_UNUSED PyObject *__pyx_8genexpr9__pyx_v_i = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   Py_ssize_t __pyx_t_4;
   PyObject *(*__pyx_t_5)(PyObject *);
@@ -31183,448 +32671,507 @@
   Py_ssize_t __pyx_t_10;
   PyObject *(*__pyx_t_11)(PyObject *);
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "statmoments/_native.pyx":921
+  /* "statmoments/_native.pyx":999
  *   """A class, using vtk multivariate kernel. Covariance ONLY!!!"""
- *   def __init__(self, trace_len, classifier_len, moment=2, **kwargs):
- *     self.moment = moment             # <<<<<<<<<<<<<<
- *     self.trace_len = trace_len
+ *   def __init__(self, tr_len, classifier_len, moment=2, **kwargs):
+ *     self.moment = moment # In fact, only 1             # <<<<<<<<<<<<<<
+ *     self.trace_len = tr_len
+ *     self.classifiers_len = classifier_len
+ */
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_moment, __pyx_v_moment) < 0) __PYX_ERR(0, 999, __pyx_L1_error)
+
+  /* "statmoments/_native.pyx":1000
+ *   def __init__(self, tr_len, classifier_len, moment=2, **kwargs):
+ *     self.moment = moment # In fact, only 1
+ *     self.trace_len = tr_len             # <<<<<<<<<<<<<<
+ *     self.classifiers_len = classifier_len
  *     self.acc_min_count = kwargs.pop('acc_min_count', 10)
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_moment, __pyx_v_moment) < 0) __PYX_ERR(0, 921, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_trace_len, __pyx_v_tr_len) < 0) __PYX_ERR(0, 1000, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":922
- *   def __init__(self, trace_len, classifier_len, moment=2, **kwargs):
- *     self.moment = moment
- *     self.trace_len = trace_len             # <<<<<<<<<<<<<<
+  /* "statmoments/_native.pyx":1001
+ *     self.moment = moment # In fact, only 1
+ *     self.trace_len = tr_len
+ *     self.classifiers_len = classifier_len             # <<<<<<<<<<<<<<
  *     self.acc_min_count = kwargs.pop('acc_min_count', 10)
  *     self._stats = [[vtk.vtkMultiCorrelativeStatistics() for i in range(2)] for _ in range(classifier_len)]
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_trace_len, __pyx_v_trace_len) < 0) __PYX_ERR(0, 922, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_classifiers_len, __pyx_v_classifier_len) < 0) __PYX_ERR(0, 1001, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":923
- *     self.moment = moment
- *     self.trace_len = trace_len
+  /* "statmoments/_native.pyx":1002
+ *     self.trace_len = tr_len
+ *     self.classifiers_len = classifier_len
  *     self.acc_min_count = kwargs.pop('acc_min_count', 10)             # <<<<<<<<<<<<<<
  *     self._stats = [[vtk.vtkMultiCorrelativeStatistics() for i in range(2)] for _ in range(classifier_len)]
- *     self._counts = [[0,0] for i in range(classifier_len)]
+ *     self._counts = [[0, 0] for i in range(classifier_len)]
  */
-  __pyx_t_1 = __Pyx_PyDict_Pop(__pyx_v_kwargs, __pyx_n_u_acc_min_count, __pyx_int_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 923, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_Pop(__pyx_v_kwargs, __pyx_n_u_acc_min_count, __pyx_int_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1002, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_acc_min_count, __pyx_t_1) < 0) __PYX_ERR(0, 923, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_acc_min_count, __pyx_t_1) < 0) __PYX_ERR(0, 1002, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":924
- *     self.trace_len = trace_len
+  /* "statmoments/_native.pyx":1003
+ *     self.classifiers_len = classifier_len
  *     self.acc_min_count = kwargs.pop('acc_min_count', 10)
  *     self._stats = [[vtk.vtkMultiCorrelativeStatistics() for i in range(2)] for _ in range(classifier_len)]             # <<<<<<<<<<<<<<
- *     self._counts = [[0,0] for i in range(classifier_len)]
- *     for mcss in self._stats:
+ *     self._counts = [[0, 0] for i in range(classifier_len)]
+ *     self._retm   = np.empty((2, 2, tr_len * (tr_len + 1) // 2))
  */
   { /* enter inner scope */
-    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 924, __pyx_L5_error)
+    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1003, __pyx_L5_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_v_classifier_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 924, __pyx_L5_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_v_classifier_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1003, __pyx_L5_error)
     __Pyx_GOTREF(__pyx_t_2);
     if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
       __pyx_t_3 = __pyx_t_2; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
       __pyx_t_5 = NULL;
     } else {
-      __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 924, __pyx_L5_error)
+      __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1003, __pyx_L5_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 924, __pyx_L5_error)
+      __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1003, __pyx_L5_error)
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     for (;;) {
       if (likely(!__pyx_t_5)) {
         if (likely(PyList_CheckExact(__pyx_t_3))) {
           if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 924, __pyx_L5_error)
+          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1003, __pyx_L5_error)
           #else
-          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 924, __pyx_L5_error)
+          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1003, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_2);
           #endif
         } else {
           if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 924, __pyx_L5_error)
+          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1003, __pyx_L5_error)
           #else
-          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 924, __pyx_L5_error)
+          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1003, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_2);
           #endif
         }
       } else {
         __pyx_t_2 = __pyx_t_5(__pyx_t_3);
         if (unlikely(!__pyx_t_2)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 924, __pyx_L5_error)
+            else __PYX_ERR(0, 1003, __pyx_L5_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_2);
       }
-      __Pyx_XDECREF_SET(__pyx_8genexpr6__pyx_v__, __pyx_t_2);
+      __Pyx_XDECREF_SET(__pyx_8genexpr7__pyx_v__, __pyx_t_2);
       __pyx_t_2 = 0;
       { /* enter inner scope */
-        __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 924, __pyx_L5_error)
+        __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1003, __pyx_L5_error)
         __Pyx_GOTREF(__pyx_t_2);
         for (__pyx_t_6 = 0; __pyx_t_6 < 2; __pyx_t_6+=1) {
-          __pyx_8genexpr7__pyx_v_i = __pyx_t_6;
-          __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_vtk); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 924, __pyx_L5_error)
+          __pyx_8genexpr8__pyx_v_i = __pyx_t_6;
+          __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_vtk); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1003, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_8);
-          __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_vtkMultiCorrelativeStatistics); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 924, __pyx_L5_error)
+          __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_vtkMultiCorrelativeStatistics); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1003, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_9);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
           __pyx_t_8 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
             __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_9);
             if (likely(__pyx_t_8)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
               __Pyx_INCREF(__pyx_t_8);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_9, function);
             }
           }
           __pyx_t_7 = (__pyx_t_8) ? __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_8) : __Pyx_PyObject_CallNoArg(__pyx_t_9);
           __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-          if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 924, __pyx_L5_error)
+          if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1003, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_7);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 924, __pyx_L5_error)
+          if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 1003, __pyx_L5_error)
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         }
       } /* exit inner scope */
-      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 924, __pyx_L5_error)
+      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 1003, __pyx_L5_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_XDECREF(__pyx_8genexpr6__pyx_v__); __pyx_8genexpr6__pyx_v__ = 0;
+    __Pyx_XDECREF(__pyx_8genexpr7__pyx_v__); __pyx_8genexpr7__pyx_v__ = 0;
     goto __pyx_L10_exit_scope;
     __pyx_L5_error:;
-    __Pyx_XDECREF(__pyx_8genexpr6__pyx_v__); __pyx_8genexpr6__pyx_v__ = 0;
+    __Pyx_XDECREF(__pyx_8genexpr7__pyx_v__); __pyx_8genexpr7__pyx_v__ = 0;
     goto __pyx_L1_error;
     __pyx_L10_exit_scope:;
   } /* exit inner scope */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_stats, __pyx_t_1) < 0) __PYX_ERR(0, 924, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_stats, __pyx_t_1) < 0) __PYX_ERR(0, 1003, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":925
+  /* "statmoments/_native.pyx":1004
  *     self.acc_min_count = kwargs.pop('acc_min_count', 10)
  *     self._stats = [[vtk.vtkMultiCorrelativeStatistics() for i in range(2)] for _ in range(classifier_len)]
- *     self._counts = [[0,0] for i in range(classifier_len)]             # <<<<<<<<<<<<<<
+ *     self._counts = [[0, 0] for i in range(classifier_len)]             # <<<<<<<<<<<<<<
+ *     self._retm   = np.empty((2, 2, tr_len * (tr_len + 1) // 2))
  *     for mcss in self._stats:
- *       for mcs in mcss:
  */
   { /* enter inner scope */
-    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 925, __pyx_L13_error)
+    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1004, __pyx_L13_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_v_classifier_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 925, __pyx_L13_error)
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_v_classifier_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1004, __pyx_L13_error)
     __Pyx_GOTREF(__pyx_t_3);
     if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
       __pyx_t_2 = __pyx_t_3; __Pyx_INCREF(__pyx_t_2); __pyx_t_4 = 0;
       __pyx_t_5 = NULL;
     } else {
-      __pyx_t_4 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 925, __pyx_L13_error)
+      __pyx_t_4 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1004, __pyx_L13_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_5 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 925, __pyx_L13_error)
+      __pyx_t_5 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1004, __pyx_L13_error)
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     for (;;) {
       if (likely(!__pyx_t_5)) {
         if (likely(PyList_CheckExact(__pyx_t_2))) {
           if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_2)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 925, __pyx_L13_error)
+          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1004, __pyx_L13_error)
           #else
-          __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 925, __pyx_L13_error)
+          __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1004, __pyx_L13_error)
           __Pyx_GOTREF(__pyx_t_3);
           #endif
         } else {
           if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 925, __pyx_L13_error)
+          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1004, __pyx_L13_error)
           #else
-          __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 925, __pyx_L13_error)
+          __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1004, __pyx_L13_error)
           __Pyx_GOTREF(__pyx_t_3);
           #endif
         }
       } else {
         __pyx_t_3 = __pyx_t_5(__pyx_t_2);
         if (unlikely(!__pyx_t_3)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 925, __pyx_L13_error)
+            else __PYX_ERR(0, 1004, __pyx_L13_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_3);
       }
-      __Pyx_XDECREF_SET(__pyx_8genexpr8__pyx_v_i, __pyx_t_3);
+      __Pyx_XDECREF_SET(__pyx_8genexpr9__pyx_v_i, __pyx_t_3);
       __pyx_t_3 = 0;
-      __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 925, __pyx_L13_error)
+      __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1004, __pyx_L13_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
       PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_0);
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
       PyList_SET_ITEM(__pyx_t_3, 1, __pyx_int_0);
-      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 925, __pyx_L13_error)
+      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 1004, __pyx_L13_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_XDECREF(__pyx_8genexpr8__pyx_v_i); __pyx_8genexpr8__pyx_v_i = 0;
+    __Pyx_XDECREF(__pyx_8genexpr9__pyx_v_i); __pyx_8genexpr9__pyx_v_i = 0;
     goto __pyx_L16_exit_scope;
     __pyx_L13_error:;
-    __Pyx_XDECREF(__pyx_8genexpr8__pyx_v_i); __pyx_8genexpr8__pyx_v_i = 0;
+    __Pyx_XDECREF(__pyx_8genexpr9__pyx_v_i); __pyx_8genexpr9__pyx_v_i = 0;
     goto __pyx_L1_error;
     __pyx_L16_exit_scope:;
   } /* exit inner scope */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_counts_2, __pyx_t_1) < 0) __PYX_ERR(0, 925, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_counts_2, __pyx_t_1) < 0) __PYX_ERR(0, 1004, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":926
+  /* "statmoments/_native.pyx":1005
  *     self._stats = [[vtk.vtkMultiCorrelativeStatistics() for i in range(2)] for _ in range(classifier_len)]
- *     self._counts = [[0,0] for i in range(classifier_len)]
+ *     self._counts = [[0, 0] for i in range(classifier_len)]
+ *     self._retm   = np.empty((2, 2, tr_len * (tr_len + 1) // 2))             # <<<<<<<<<<<<<<
+ *     for mcss in self._stats:
+ *       for mcs in mcss:
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1005, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1005, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_tr_len, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1005, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_7 = PyNumber_Multiply(__pyx_v_tr_len, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1005, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_7, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1005, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __pyx_t_7 = PyTuple_New(3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1005, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_INCREF(__pyx_int_2);
+  __Pyx_GIVEREF(__pyx_int_2);
+  PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_int_2);
+  __Pyx_INCREF(__pyx_int_2);
+  __Pyx_GIVEREF(__pyx_int_2);
+  PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_int_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_7, 2, __pyx_t_2);
+  __pyx_t_2 = 0;
+  __pyx_t_2 = NULL;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
+    if (likely(__pyx_t_2)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+      __Pyx_INCREF(__pyx_t_2);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_3, function);
+    }
+  }
+  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1005, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_retm, __pyx_t_1) < 0) __PYX_ERR(0, 1005, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+
+  /* "statmoments/_native.pyx":1006
+ *     self._counts = [[0, 0] for i in range(classifier_len)]
+ *     self._retm   = np.empty((2, 2, tr_len * (tr_len + 1) // 2))
  *     for mcss in self._stats:             # <<<<<<<<<<<<<<
  *       for mcs in mcss:
  *         mcs.SetLearnOption(True)
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_stats); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 926, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_stats); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1006, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
-    __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_4 = 0;
+    __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
     __pyx_t_5 = NULL;
   } else {
-    __pyx_t_4 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 926, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 926, __pyx_L1_error)
+    __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1006, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1006, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_5)) {
-      if (likely(PyList_CheckExact(__pyx_t_2))) {
-        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_2)) break;
+      if (likely(PyList_CheckExact(__pyx_t_3))) {
+        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 926, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1006, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 926, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1006, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
-        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
+        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 926, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1006, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 926, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1006, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
-      __pyx_t_1 = __pyx_t_5(__pyx_t_2);
+      __pyx_t_1 = __pyx_t_5(__pyx_t_3);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 926, __pyx_L1_error)
+          else __PYX_ERR(0, 1006, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XDECREF_SET(__pyx_v_mcss, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":927
- *     self._counts = [[0,0] for i in range(classifier_len)]
+    /* "statmoments/_native.pyx":1007
+ *     self._retm   = np.empty((2, 2, tr_len * (tr_len + 1) // 2))
  *     for mcss in self._stats:
  *       for mcs in mcss:             # <<<<<<<<<<<<<<
  *         mcs.SetLearnOption(True)
  *         mcs.SetDeriveOption(True)
  */
     if (likely(PyList_CheckExact(__pyx_v_mcss)) || PyTuple_CheckExact(__pyx_v_mcss)) {
       __pyx_t_1 = __pyx_v_mcss; __Pyx_INCREF(__pyx_t_1); __pyx_t_10 = 0;
       __pyx_t_11 = NULL;
     } else {
-      __pyx_t_10 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_mcss); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 927, __pyx_L1_error)
+      __pyx_t_10 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_mcss); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1007, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_11 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 927, __pyx_L1_error)
+      __pyx_t_11 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1007, __pyx_L1_error)
     }
     for (;;) {
       if (likely(!__pyx_t_11)) {
         if (likely(PyList_CheckExact(__pyx_t_1))) {
           if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_10); __Pyx_INCREF(__pyx_t_3); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 927, __pyx_L1_error)
+          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_10); __Pyx_INCREF(__pyx_t_7); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 1007, __pyx_L1_error)
           #else
-          __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 927, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_1, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1007, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_7);
           #endif
         } else {
           if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_10); __Pyx_INCREF(__pyx_t_3); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 927, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_10); __Pyx_INCREF(__pyx_t_7); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 1007, __pyx_L1_error)
           #else
-          __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 927, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_1, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1007, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_7);
           #endif
         }
       } else {
-        __pyx_t_3 = __pyx_t_11(__pyx_t_1);
-        if (unlikely(!__pyx_t_3)) {
+        __pyx_t_7 = __pyx_t_11(__pyx_t_1);
+        if (unlikely(!__pyx_t_7)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 927, __pyx_L1_error)
+            else __PYX_ERR(0, 1007, __pyx_L1_error)
           }
           break;
         }
-        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_GOTREF(__pyx_t_7);
       }
-      __Pyx_XDECREF_SET(__pyx_v_mcs, __pyx_t_3);
-      __pyx_t_3 = 0;
+      __Pyx_XDECREF_SET(__pyx_v_mcs, __pyx_t_7);
+      __pyx_t_7 = 0;
 
-      /* "statmoments/_native.pyx":928
+      /* "statmoments/_native.pyx":1008
  *     for mcss in self._stats:
  *       for mcs in mcss:
  *         mcs.SetLearnOption(True)             # <<<<<<<<<<<<<<
  *         mcs.SetDeriveOption(True)
  *         mcs.SetAssessOption(False)
  */
-      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_mcs, __pyx_n_s_SetLearnOption); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 928, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_mcs, __pyx_n_s_SetLearnOption); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1008, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
       __pyx_t_9 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
-        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_7);
+      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
+        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
         if (likely(__pyx_t_9)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
           __Pyx_INCREF(__pyx_t_9);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_7, function);
+          __Pyx_DECREF_SET(__pyx_t_2, function);
         }
       }
-      __pyx_t_3 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_9, Py_True) : __Pyx_PyObject_CallOneArg(__pyx_t_7, Py_True);
+      __pyx_t_7 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_9, Py_True) : __Pyx_PyObject_CallOneArg(__pyx_t_2, Py_True);
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 928, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1008, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "statmoments/_native.pyx":929
+      /* "statmoments/_native.pyx":1009
  *       for mcs in mcss:
  *         mcs.SetLearnOption(True)
  *         mcs.SetDeriveOption(True)             # <<<<<<<<<<<<<<
  *         mcs.SetAssessOption(False)
  *         mcs.SetTestOption(False)
  */
-      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_mcs, __pyx_n_s_SetDeriveOption); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 929, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_mcs, __pyx_n_s_SetDeriveOption); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1009, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
       __pyx_t_9 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
-        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_7);
+      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
+        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
         if (likely(__pyx_t_9)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
           __Pyx_INCREF(__pyx_t_9);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_7, function);
+          __Pyx_DECREF_SET(__pyx_t_2, function);
         }
       }
-      __pyx_t_3 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_9, Py_True) : __Pyx_PyObject_CallOneArg(__pyx_t_7, Py_True);
+      __pyx_t_7 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_9, Py_True) : __Pyx_PyObject_CallOneArg(__pyx_t_2, Py_True);
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 929, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1009, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "statmoments/_native.pyx":930
+      /* "statmoments/_native.pyx":1010
  *         mcs.SetLearnOption(True)
  *         mcs.SetDeriveOption(True)
  *         mcs.SetAssessOption(False)             # <<<<<<<<<<<<<<
  *         mcs.SetTestOption(False)
  * 
  */
-      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_mcs, __pyx_n_s_SetAssessOption); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 930, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_mcs, __pyx_n_s_SetAssessOption); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1010, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
       __pyx_t_9 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
-        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_7);
+      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
+        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
         if (likely(__pyx_t_9)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
           __Pyx_INCREF(__pyx_t_9);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_7, function);
+          __Pyx_DECREF_SET(__pyx_t_2, function);
         }
       }
-      __pyx_t_3 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_9, Py_False) : __Pyx_PyObject_CallOneArg(__pyx_t_7, Py_False);
+      __pyx_t_7 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_9, Py_False) : __Pyx_PyObject_CallOneArg(__pyx_t_2, Py_False);
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 930, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1010, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "statmoments/_native.pyx":931
+      /* "statmoments/_native.pyx":1011
  *         mcs.SetDeriveOption(True)
  *         mcs.SetAssessOption(False)
  *         mcs.SetTestOption(False)             # <<<<<<<<<<<<<<
  * 
  *   def memory_size(self):
  */
-      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_mcs, __pyx_n_s_SetTestOption); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 931, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_mcs, __pyx_n_s_SetTestOption); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1011, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
       __pyx_t_9 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
-        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_7);
+      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
+        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
         if (likely(__pyx_t_9)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
           __Pyx_INCREF(__pyx_t_9);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_7, function);
+          __Pyx_DECREF_SET(__pyx_t_2, function);
         }
       }
-      __pyx_t_3 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_9, Py_False) : __Pyx_PyObject_CallOneArg(__pyx_t_7, Py_False);
+      __pyx_t_7 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_9, Py_False) : __Pyx_PyObject_CallOneArg(__pyx_t_2, Py_False);
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 931, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1011, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "statmoments/_native.pyx":927
- *     self._counts = [[0,0] for i in range(classifier_len)]
+      /* "statmoments/_native.pyx":1007
+ *     self._retm   = np.empty((2, 2, tr_len * (tr_len + 1) // 2))
  *     for mcss in self._stats:
  *       for mcs in mcss:             # <<<<<<<<<<<<<<
  *         mcs.SetLearnOption(True)
  *         mcs.SetDeriveOption(True)
  */
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":926
- *     self._stats = [[vtk.vtkMultiCorrelativeStatistics() for i in range(2)] for _ in range(classifier_len)]
- *     self._counts = [[0,0] for i in range(classifier_len)]
+    /* "statmoments/_native.pyx":1006
+ *     self._counts = [[0, 0] for i in range(classifier_len)]
+ *     self._retm   = np.empty((2, 2, tr_len * (tr_len + 1) // 2))
  *     for mcss in self._stats:             # <<<<<<<<<<<<<<
  *       for mcs in mcss:
  *         mcs.SetLearnOption(True)
  */
   }
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":920
+  /* "statmoments/_native.pyx":998
  * class bivar_vtk(object):
  *   """A class, using vtk multivariate kernel. Covariance ONLY!!!"""
- *   def __init__(self, trace_len, classifier_len, moment=2, **kwargs):             # <<<<<<<<<<<<<<
- *     self.moment = moment
- *     self.trace_len = trace_len
+ *   def __init__(self, tr_len, classifier_len, moment=2, **kwargs):             # <<<<<<<<<<<<<<
+ *     self.moment = moment # In fact, only 1
+ *     self.trace_len = tr_len
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
@@ -31634,22 +33181,22 @@
   __Pyx_XDECREF(__pyx_t_8);
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_AddTraceback("statmoments._native.bivar_vtk.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_mcss);
   __Pyx_XDECREF(__pyx_v_mcs);
-  __Pyx_XDECREF(__pyx_8genexpr6__pyx_v__);
-  __Pyx_XDECREF(__pyx_8genexpr8__pyx_v_i);
+  __Pyx_XDECREF(__pyx_8genexpr7__pyx_v__);
+  __Pyx_XDECREF(__pyx_8genexpr9__pyx_v_i);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":933
+/* "statmoments/_native.pyx":1013
  *         mcs.SetTestOption(False)
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     def _ms_helper(instl):
  *       return sum(i.GetActualMemorySize() for i in instl)
  */
 
@@ -31663,15 +33210,15 @@
   __pyx_r = __pyx_pf_11statmoments_7_native_9bivar_vtk_2memory_size(__pyx_self, ((PyObject *)__pyx_v_self));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":934
+/* "statmoments/_native.pyx":1014
  * 
  *   def memory_size(self):
  *     def _ms_helper(instl):             # <<<<<<<<<<<<<<
  *       return sum(i.GetActualMemorySize() for i in instl)
  * 
  */
 
@@ -31686,15 +33233,15 @@
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static PyObject *__pyx_gb_11statmoments_7_native_9bivar_vtk_11memory_size_10_ms_helper_2generator15(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "statmoments/_native.pyx":935
+/* "statmoments/_native.pyx":1015
  *   def memory_size(self):
  *     def _ms_helper(instl):
  *       return sum(i.GetActualMemorySize() for i in instl)             # <<<<<<<<<<<<<<
  * 
  *     intbl0  = [mcs.GetInputDataObject(0, 0) for mcss in self._stats for mcs in mcss]
  */
 
@@ -31706,23 +33253,23 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("genexpr", 0);
   __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_16_genexpr *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_16_genexpr(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_16_genexpr, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_16_genexpr *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 935, __pyx_L1_error)
+    __PYX_ERR(0, 1015, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_15__ms_helper *) __pyx_self;
   __Pyx_INCREF(((PyObject *)__pyx_cur_scope->__pyx_outer_scope));
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_outer_scope);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_9bivar_vtk_11memory_size_10_ms_helper_2generator15, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_bivar_vtk_memory_size_locals__ms, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 935, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_9bivar_vtk_11memory_size_10_ms_helper_2generator15, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_bivar_vtk_memory_size_locals__ms, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 1015, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -31753,74 +33300,74 @@
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L6_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 935, __pyx_L1_error)
-  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_instl)) { __Pyx_RaiseClosureNameError("instl"); __PYX_ERR(0, 935, __pyx_L1_error) }
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 1015, __pyx_L1_error)
+  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_instl)) { __Pyx_RaiseClosureNameError("instl"); __PYX_ERR(0, 1015, __pyx_L1_error) }
   if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_instl)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_instl)) {
     __pyx_t_1 = __pyx_cur_scope->__pyx_outer_scope->__pyx_v_instl; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
     __pyx_t_3 = NULL;
   } else {
-    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_instl); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 935, __pyx_L1_error)
+    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_instl); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1015, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 935, __pyx_L1_error)
+    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1015, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_3)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 935, __pyx_L1_error)
+        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1015, __pyx_L1_error)
         #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 935, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1015, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       } else {
         if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 935, __pyx_L1_error)
+        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1015, __pyx_L1_error)
         #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 935, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1015, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       }
     } else {
       __pyx_t_4 = __pyx_t_3(__pyx_t_1);
       if (unlikely(!__pyx_t_4)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 935, __pyx_L1_error)
+          else __PYX_ERR(0, 1015, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_4);
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_i);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_i, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_4);
     __pyx_t_4 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_i, __pyx_n_s_GetActualMemorySize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 935, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_i, __pyx_n_s_GetActualMemorySize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1015, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_4 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6) : __Pyx_PyObject_CallNoArg(__pyx_t_5);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 935, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1015, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_r = __pyx_t_4;
     __pyx_t_4 = 0;
     __Pyx_XGIVEREF(__pyx_t_1);
     __pyx_cur_scope->__pyx_t_0 = __pyx_t_1;
     __pyx_cur_scope->__pyx_t_1 = __pyx_t_2;
@@ -31833,15 +33380,15 @@
     return __pyx_r;
     __pyx_L6_resume_from_yield:;
     __pyx_t_1 = __pyx_cur_scope->__pyx_t_0;
     __pyx_cur_scope->__pyx_t_0 = 0;
     __Pyx_XGOTREF(__pyx_t_1);
     __pyx_t_2 = __pyx_cur_scope->__pyx_t_1;
     __pyx_t_3 = __pyx_cur_scope->__pyx_t_2;
-    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 935, __pyx_L1_error)
+    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 1015, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
   /* function exit code */
   PyErr_SetNone(PyExc_StopIteration);
   goto __pyx_L0;
@@ -31858,15 +33405,15 @@
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":934
+/* "statmoments/_native.pyx":1014
  * 
  *   def memory_size(self):
  *     def _ms_helper(instl):             # <<<<<<<<<<<<<<
  *       return sum(i.GetActualMemorySize() for i in instl)
  * 
  */
 
@@ -31881,40 +33428,40 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_ms_helper", 0);
   __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_15__ms_helper *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_15__ms_helper(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_15__ms_helper, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_15__ms_helper *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 934, __pyx_L1_error)
+    __PYX_ERR(0, 1014, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_instl = __pyx_v_instl;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_instl);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_instl);
 
-  /* "statmoments/_native.pyx":935
+  /* "statmoments/_native.pyx":1015
  *   def memory_size(self):
  *     def _ms_helper(instl):
  *       return sum(i.GetActualMemorySize() for i in instl)             # <<<<<<<<<<<<<<
  * 
  *     intbl0  = [mcs.GetInputDataObject(0, 0) for mcss in self._stats for mcs in mcss]
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_pf_11statmoments_7_native_9bivar_vtk_11memory_size_10_ms_helper_genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 935, __pyx_L1_error)
+  __pyx_t_1 = __pyx_pf_11statmoments_7_native_9bivar_vtk_11memory_size_10_ms_helper_genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1015, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_sum, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 935, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_sum, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1015, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":934
+  /* "statmoments/_native.pyx":1014
  * 
  *   def memory_size(self):
  *     def _ms_helper(instl):             # <<<<<<<<<<<<<<
  *       return sum(i.GetActualMemorySize() for i in instl)
  * 
  */
 
@@ -31928,33 +33475,34 @@
   __Pyx_XDECREF(__pyx_gb_11statmoments_7_native_9bivar_vtk_11memory_size_10_ms_helper_2generator15);
   __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":933
+/* "statmoments/_native.pyx":1013
  *         mcs.SetTestOption(False)
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     def _ms_helper(instl):
  *       return sum(i.GetActualMemorySize() for i in instl)
  */
 
 static PyObject *__pyx_pf_11statmoments_7_native_9bivar_vtk_2memory_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
   PyObject *__pyx_v__ms_helper = 0;
   PyObject *__pyx_v_intbl0 = NULL;
   PyObject *__pyx_v_outtbl0 = NULL;
   PyObject *__pyx_v_outds1 = NULL;
-  PyObject *__pyx_9genexpr10__pyx_v_mcss = NULL;
-  PyObject *__pyx_9genexpr10__pyx_v_mcs = NULL;
+  PyObject *__pyx_v_mem_ttest = NULL;
   PyObject *__pyx_9genexpr11__pyx_v_mcss = NULL;
   PyObject *__pyx_9genexpr11__pyx_v_mcs = NULL;
   PyObject *__pyx_9genexpr12__pyx_v_mcss = NULL;
   PyObject *__pyx_9genexpr12__pyx_v_mcs = NULL;
+  PyObject *__pyx_9genexpr13__pyx_v_mcss = NULL;
+  PyObject *__pyx_9genexpr13__pyx_v_mcs = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   Py_ssize_t __pyx_t_4;
   PyObject *(*__pyx_t_5)(PyObject *);
@@ -31964,445 +33512,478 @@
   PyObject *__pyx_t_9 = NULL;
   PyObject *__pyx_t_10 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("memory_size", 0);
 
-  /* "statmoments/_native.pyx":934
+  /* "statmoments/_native.pyx":1014
  * 
  *   def memory_size(self):
  *     def _ms_helper(instl):             # <<<<<<<<<<<<<<
  *       return sum(i.GetActualMemorySize() for i in instl)
  * 
  */
-  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_9bivar_vtk_11memory_size_1_ms_helper, 0, __pyx_n_s_bivar_vtk_memory_size_locals__ms_2, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__38)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 934, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_9bivar_vtk_11memory_size_1_ms_helper, 0, __pyx_n_s_bivar_vtk_memory_size_locals__ms_2, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__37)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1014, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v__ms_helper = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":937
+  /* "statmoments/_native.pyx":1017
  *       return sum(i.GetActualMemorySize() for i in instl)
  * 
  *     intbl0  = [mcs.GetInputDataObject(0, 0) for mcss in self._stats for mcs in mcss]             # <<<<<<<<<<<<<<
  *     outtbl0 = [mcs.GetOutputDataObject(0)   for mcss in self._stats for mcs in mcss]
  *     outds1  = [mcs.GetOutputDataObject(1)   for mcss in self._stats for mcs in mcss]
  */
   { /* enter inner scope */
-    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 937, __pyx_L5_error)
+    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1017, __pyx_L5_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_stats); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 937, __pyx_L5_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_stats); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1017, __pyx_L5_error)
     __Pyx_GOTREF(__pyx_t_2);
     if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
       __pyx_t_3 = __pyx_t_2; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
       __pyx_t_5 = NULL;
     } else {
-      __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 937, __pyx_L5_error)
+      __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1017, __pyx_L5_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 937, __pyx_L5_error)
+      __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1017, __pyx_L5_error)
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     for (;;) {
       if (likely(!__pyx_t_5)) {
         if (likely(PyList_CheckExact(__pyx_t_3))) {
           if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 937, __pyx_L5_error)
+          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1017, __pyx_L5_error)
           #else
-          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 937, __pyx_L5_error)
+          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1017, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_2);
           #endif
         } else {
           if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 937, __pyx_L5_error)
+          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1017, __pyx_L5_error)
           #else
-          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 937, __pyx_L5_error)
+          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1017, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_2);
           #endif
         }
       } else {
         __pyx_t_2 = __pyx_t_5(__pyx_t_3);
         if (unlikely(!__pyx_t_2)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 937, __pyx_L5_error)
+            else __PYX_ERR(0, 1017, __pyx_L5_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_2);
       }
-      __Pyx_XDECREF_SET(__pyx_9genexpr10__pyx_v_mcss, __pyx_t_2);
+      __Pyx_XDECREF_SET(__pyx_9genexpr11__pyx_v_mcss, __pyx_t_2);
       __pyx_t_2 = 0;
-      if (likely(PyList_CheckExact(__pyx_9genexpr10__pyx_v_mcss)) || PyTuple_CheckExact(__pyx_9genexpr10__pyx_v_mcss)) {
-        __pyx_t_2 = __pyx_9genexpr10__pyx_v_mcss; __Pyx_INCREF(__pyx_t_2); __pyx_t_6 = 0;
+      if (likely(PyList_CheckExact(__pyx_9genexpr11__pyx_v_mcss)) || PyTuple_CheckExact(__pyx_9genexpr11__pyx_v_mcss)) {
+        __pyx_t_2 = __pyx_9genexpr11__pyx_v_mcss; __Pyx_INCREF(__pyx_t_2); __pyx_t_6 = 0;
         __pyx_t_7 = NULL;
       } else {
-        __pyx_t_6 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_9genexpr10__pyx_v_mcss); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 937, __pyx_L5_error)
+        __pyx_t_6 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_9genexpr11__pyx_v_mcss); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1017, __pyx_L5_error)
         __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_7 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 937, __pyx_L5_error)
+        __pyx_t_7 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1017, __pyx_L5_error)
       }
       for (;;) {
         if (likely(!__pyx_t_7)) {
           if (likely(PyList_CheckExact(__pyx_t_2))) {
             if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_2)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_8 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_8); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 937, __pyx_L5_error)
+            __pyx_t_8 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_8); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1017, __pyx_L5_error)
             #else
-            __pyx_t_8 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 937, __pyx_L5_error)
+            __pyx_t_8 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1017, __pyx_L5_error)
             __Pyx_GOTREF(__pyx_t_8);
             #endif
           } else {
             if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_8); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 937, __pyx_L5_error)
+            __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_8); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1017, __pyx_L5_error)
             #else
-            __pyx_t_8 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 937, __pyx_L5_error)
+            __pyx_t_8 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1017, __pyx_L5_error)
             __Pyx_GOTREF(__pyx_t_8);
             #endif
           }
         } else {
           __pyx_t_8 = __pyx_t_7(__pyx_t_2);
           if (unlikely(!__pyx_t_8)) {
             PyObject* exc_type = PyErr_Occurred();
             if (exc_type) {
               if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-              else __PYX_ERR(0, 937, __pyx_L5_error)
+              else __PYX_ERR(0, 1017, __pyx_L5_error)
             }
             break;
           }
           __Pyx_GOTREF(__pyx_t_8);
         }
-        __Pyx_XDECREF_SET(__pyx_9genexpr10__pyx_v_mcs, __pyx_t_8);
+        __Pyx_XDECREF_SET(__pyx_9genexpr11__pyx_v_mcs, __pyx_t_8);
         __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_9genexpr10__pyx_v_mcs, __pyx_n_s_GetInputDataObject); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 937, __pyx_L5_error)
+        __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_9genexpr11__pyx_v_mcs, __pyx_n_s_GetInputDataObject); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1017, __pyx_L5_error)
         __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_tuple__21, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 937, __pyx_L5_error)
+        __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1017, __pyx_L5_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_9))) __PYX_ERR(0, 937, __pyx_L5_error)
+        if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_9))) __PYX_ERR(0, 1017, __pyx_L5_error)
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       }
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_XDECREF(__pyx_9genexpr10__pyx_v_mcs); __pyx_9genexpr10__pyx_v_mcs = 0;
-    __Pyx_XDECREF(__pyx_9genexpr10__pyx_v_mcss); __pyx_9genexpr10__pyx_v_mcss = 0;
+    __Pyx_XDECREF(__pyx_9genexpr11__pyx_v_mcs); __pyx_9genexpr11__pyx_v_mcs = 0;
+    __Pyx_XDECREF(__pyx_9genexpr11__pyx_v_mcss); __pyx_9genexpr11__pyx_v_mcss = 0;
     goto __pyx_L10_exit_scope;
     __pyx_L5_error:;
-    __Pyx_XDECREF(__pyx_9genexpr10__pyx_v_mcs); __pyx_9genexpr10__pyx_v_mcs = 0;
-    __Pyx_XDECREF(__pyx_9genexpr10__pyx_v_mcss); __pyx_9genexpr10__pyx_v_mcss = 0;
+    __Pyx_XDECREF(__pyx_9genexpr11__pyx_v_mcs); __pyx_9genexpr11__pyx_v_mcs = 0;
+    __Pyx_XDECREF(__pyx_9genexpr11__pyx_v_mcss); __pyx_9genexpr11__pyx_v_mcss = 0;
     goto __pyx_L1_error;
     __pyx_L10_exit_scope:;
   } /* exit inner scope */
   __pyx_v_intbl0 = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":938
+  /* "statmoments/_native.pyx":1018
  * 
  *     intbl0  = [mcs.GetInputDataObject(0, 0) for mcss in self._stats for mcs in mcss]
  *     outtbl0 = [mcs.GetOutputDataObject(0)   for mcss in self._stats for mcs in mcss]             # <<<<<<<<<<<<<<
  *     outds1  = [mcs.GetOutputDataObject(1)   for mcss in self._stats for mcs in mcss]
  * 
  */
   { /* enter inner scope */
-    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 938, __pyx_L13_error)
+    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1018, __pyx_L13_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_stats); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 938, __pyx_L13_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_stats); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1018, __pyx_L13_error)
     __Pyx_GOTREF(__pyx_t_3);
     if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
       __pyx_t_2 = __pyx_t_3; __Pyx_INCREF(__pyx_t_2); __pyx_t_4 = 0;
       __pyx_t_5 = NULL;
     } else {
-      __pyx_t_4 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 938, __pyx_L13_error)
+      __pyx_t_4 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1018, __pyx_L13_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_5 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 938, __pyx_L13_error)
+      __pyx_t_5 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1018, __pyx_L13_error)
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     for (;;) {
       if (likely(!__pyx_t_5)) {
         if (likely(PyList_CheckExact(__pyx_t_2))) {
           if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_2)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 938, __pyx_L13_error)
+          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1018, __pyx_L13_error)
           #else
-          __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 938, __pyx_L13_error)
+          __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1018, __pyx_L13_error)
           __Pyx_GOTREF(__pyx_t_3);
           #endif
         } else {
           if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 938, __pyx_L13_error)
+          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1018, __pyx_L13_error)
           #else
-          __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 938, __pyx_L13_error)
+          __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1018, __pyx_L13_error)
           __Pyx_GOTREF(__pyx_t_3);
           #endif
         }
       } else {
         __pyx_t_3 = __pyx_t_5(__pyx_t_2);
         if (unlikely(!__pyx_t_3)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 938, __pyx_L13_error)
+            else __PYX_ERR(0, 1018, __pyx_L13_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_3);
       }
-      __Pyx_XDECREF_SET(__pyx_9genexpr11__pyx_v_mcss, __pyx_t_3);
+      __Pyx_XDECREF_SET(__pyx_9genexpr12__pyx_v_mcss, __pyx_t_3);
       __pyx_t_3 = 0;
-      if (likely(PyList_CheckExact(__pyx_9genexpr11__pyx_v_mcss)) || PyTuple_CheckExact(__pyx_9genexpr11__pyx_v_mcss)) {
-        __pyx_t_3 = __pyx_9genexpr11__pyx_v_mcss; __Pyx_INCREF(__pyx_t_3); __pyx_t_6 = 0;
+      if (likely(PyList_CheckExact(__pyx_9genexpr12__pyx_v_mcss)) || PyTuple_CheckExact(__pyx_9genexpr12__pyx_v_mcss)) {
+        __pyx_t_3 = __pyx_9genexpr12__pyx_v_mcss; __Pyx_INCREF(__pyx_t_3); __pyx_t_6 = 0;
         __pyx_t_7 = NULL;
       } else {
-        __pyx_t_6 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_9genexpr11__pyx_v_mcss); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 938, __pyx_L13_error)
+        __pyx_t_6 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_9genexpr12__pyx_v_mcss); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1018, __pyx_L13_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_7 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 938, __pyx_L13_error)
+        __pyx_t_7 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1018, __pyx_L13_error)
       }
       for (;;) {
         if (likely(!__pyx_t_7)) {
           if (likely(PyList_CheckExact(__pyx_t_3))) {
             if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_3)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_9 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_9); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 938, __pyx_L13_error)
+            __pyx_t_9 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_9); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1018, __pyx_L13_error)
             #else
-            __pyx_t_9 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 938, __pyx_L13_error)
+            __pyx_t_9 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1018, __pyx_L13_error)
             __Pyx_GOTREF(__pyx_t_9);
             #endif
           } else {
             if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_9); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 938, __pyx_L13_error)
+            __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_9); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1018, __pyx_L13_error)
             #else
-            __pyx_t_9 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 938, __pyx_L13_error)
+            __pyx_t_9 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1018, __pyx_L13_error)
             __Pyx_GOTREF(__pyx_t_9);
             #endif
           }
         } else {
           __pyx_t_9 = __pyx_t_7(__pyx_t_3);
           if (unlikely(!__pyx_t_9)) {
             PyObject* exc_type = PyErr_Occurred();
             if (exc_type) {
               if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-              else __PYX_ERR(0, 938, __pyx_L13_error)
+              else __PYX_ERR(0, 1018, __pyx_L13_error)
             }
             break;
           }
           __Pyx_GOTREF(__pyx_t_9);
         }
-        __Pyx_XDECREF_SET(__pyx_9genexpr11__pyx_v_mcs, __pyx_t_9);
+        __Pyx_XDECREF_SET(__pyx_9genexpr12__pyx_v_mcs, __pyx_t_9);
         __pyx_t_9 = 0;
-        __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_9genexpr11__pyx_v_mcs, __pyx_n_s_GetOutputDataObject); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 938, __pyx_L13_error)
+        __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_9genexpr12__pyx_v_mcs, __pyx_n_s_GetOutputDataObject); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1018, __pyx_L13_error)
         __Pyx_GOTREF(__pyx_t_8);
         __pyx_t_10 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_8))) {
           __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_8);
           if (likely(__pyx_t_10)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
             __Pyx_INCREF(__pyx_t_10);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_8, function);
           }
         }
         __pyx_t_9 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_10, __pyx_int_0) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_int_0);
         __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-        if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 938, __pyx_L13_error)
+        if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1018, __pyx_L13_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_9))) __PYX_ERR(0, 938, __pyx_L13_error)
+        if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_9))) __PYX_ERR(0, 1018, __pyx_L13_error)
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       }
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_XDECREF(__pyx_9genexpr11__pyx_v_mcs); __pyx_9genexpr11__pyx_v_mcs = 0;
-    __Pyx_XDECREF(__pyx_9genexpr11__pyx_v_mcss); __pyx_9genexpr11__pyx_v_mcss = 0;
+    __Pyx_XDECREF(__pyx_9genexpr12__pyx_v_mcs); __pyx_9genexpr12__pyx_v_mcs = 0;
+    __Pyx_XDECREF(__pyx_9genexpr12__pyx_v_mcss); __pyx_9genexpr12__pyx_v_mcss = 0;
     goto __pyx_L18_exit_scope;
     __pyx_L13_error:;
-    __Pyx_XDECREF(__pyx_9genexpr11__pyx_v_mcs); __pyx_9genexpr11__pyx_v_mcs = 0;
-    __Pyx_XDECREF(__pyx_9genexpr11__pyx_v_mcss); __pyx_9genexpr11__pyx_v_mcss = 0;
+    __Pyx_XDECREF(__pyx_9genexpr12__pyx_v_mcs); __pyx_9genexpr12__pyx_v_mcs = 0;
+    __Pyx_XDECREF(__pyx_9genexpr12__pyx_v_mcss); __pyx_9genexpr12__pyx_v_mcss = 0;
     goto __pyx_L1_error;
     __pyx_L18_exit_scope:;
   } /* exit inner scope */
   __pyx_v_outtbl0 = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":939
+  /* "statmoments/_native.pyx":1019
  *     intbl0  = [mcs.GetInputDataObject(0, 0) for mcss in self._stats for mcs in mcss]
  *     outtbl0 = [mcs.GetOutputDataObject(0)   for mcss in self._stats for mcs in mcss]
  *     outds1  = [mcs.GetOutputDataObject(1)   for mcss in self._stats for mcs in mcss]             # <<<<<<<<<<<<<<
  * 
- *     return sum(map(_ms_helper, (intbl0, outtbl0, outds1))) * 1024
+ *     mem_ttest = 2 * 2 * self.trace_len * (self.trace_len + 1) // 2 * 8
  */
   { /* enter inner scope */
-    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 939, __pyx_L21_error)
+    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1019, __pyx_L21_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_stats); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 939, __pyx_L21_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_stats); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1019, __pyx_L21_error)
     __Pyx_GOTREF(__pyx_t_2);
     if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
       __pyx_t_3 = __pyx_t_2; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
       __pyx_t_5 = NULL;
     } else {
-      __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 939, __pyx_L21_error)
+      __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1019, __pyx_L21_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 939, __pyx_L21_error)
+      __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1019, __pyx_L21_error)
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     for (;;) {
       if (likely(!__pyx_t_5)) {
         if (likely(PyList_CheckExact(__pyx_t_3))) {
           if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 939, __pyx_L21_error)
+          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1019, __pyx_L21_error)
           #else
-          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 939, __pyx_L21_error)
+          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1019, __pyx_L21_error)
           __Pyx_GOTREF(__pyx_t_2);
           #endif
         } else {
           if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 939, __pyx_L21_error)
+          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1019, __pyx_L21_error)
           #else
-          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 939, __pyx_L21_error)
+          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1019, __pyx_L21_error)
           __Pyx_GOTREF(__pyx_t_2);
           #endif
         }
       } else {
         __pyx_t_2 = __pyx_t_5(__pyx_t_3);
         if (unlikely(!__pyx_t_2)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 939, __pyx_L21_error)
+            else __PYX_ERR(0, 1019, __pyx_L21_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_2);
       }
-      __Pyx_XDECREF_SET(__pyx_9genexpr12__pyx_v_mcss, __pyx_t_2);
+      __Pyx_XDECREF_SET(__pyx_9genexpr13__pyx_v_mcss, __pyx_t_2);
       __pyx_t_2 = 0;
-      if (likely(PyList_CheckExact(__pyx_9genexpr12__pyx_v_mcss)) || PyTuple_CheckExact(__pyx_9genexpr12__pyx_v_mcss)) {
-        __pyx_t_2 = __pyx_9genexpr12__pyx_v_mcss; __Pyx_INCREF(__pyx_t_2); __pyx_t_6 = 0;
+      if (likely(PyList_CheckExact(__pyx_9genexpr13__pyx_v_mcss)) || PyTuple_CheckExact(__pyx_9genexpr13__pyx_v_mcss)) {
+        __pyx_t_2 = __pyx_9genexpr13__pyx_v_mcss; __Pyx_INCREF(__pyx_t_2); __pyx_t_6 = 0;
         __pyx_t_7 = NULL;
       } else {
-        __pyx_t_6 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_9genexpr12__pyx_v_mcss); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 939, __pyx_L21_error)
+        __pyx_t_6 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_9genexpr13__pyx_v_mcss); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1019, __pyx_L21_error)
         __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_7 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 939, __pyx_L21_error)
+        __pyx_t_7 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1019, __pyx_L21_error)
       }
       for (;;) {
         if (likely(!__pyx_t_7)) {
           if (likely(PyList_CheckExact(__pyx_t_2))) {
             if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_2)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_9 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_9); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 939, __pyx_L21_error)
+            __pyx_t_9 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_9); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1019, __pyx_L21_error)
             #else
-            __pyx_t_9 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 939, __pyx_L21_error)
+            __pyx_t_9 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1019, __pyx_L21_error)
             __Pyx_GOTREF(__pyx_t_9);
             #endif
           } else {
             if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_9); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 939, __pyx_L21_error)
+            __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_9); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1019, __pyx_L21_error)
             #else
-            __pyx_t_9 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 939, __pyx_L21_error)
+            __pyx_t_9 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1019, __pyx_L21_error)
             __Pyx_GOTREF(__pyx_t_9);
             #endif
           }
         } else {
           __pyx_t_9 = __pyx_t_7(__pyx_t_2);
           if (unlikely(!__pyx_t_9)) {
             PyObject* exc_type = PyErr_Occurred();
             if (exc_type) {
               if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-              else __PYX_ERR(0, 939, __pyx_L21_error)
+              else __PYX_ERR(0, 1019, __pyx_L21_error)
             }
             break;
           }
           __Pyx_GOTREF(__pyx_t_9);
         }
-        __Pyx_XDECREF_SET(__pyx_9genexpr12__pyx_v_mcs, __pyx_t_9);
+        __Pyx_XDECREF_SET(__pyx_9genexpr13__pyx_v_mcs, __pyx_t_9);
         __pyx_t_9 = 0;
-        __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_9genexpr12__pyx_v_mcs, __pyx_n_s_GetOutputDataObject); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 939, __pyx_L21_error)
+        __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_9genexpr13__pyx_v_mcs, __pyx_n_s_GetOutputDataObject); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1019, __pyx_L21_error)
         __Pyx_GOTREF(__pyx_t_8);
         __pyx_t_10 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_8))) {
           __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_8);
           if (likely(__pyx_t_10)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
             __Pyx_INCREF(__pyx_t_10);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_8, function);
           }
         }
         __pyx_t_9 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_10, __pyx_int_1) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_int_1);
         __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-        if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 939, __pyx_L21_error)
+        if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1019, __pyx_L21_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_9))) __PYX_ERR(0, 939, __pyx_L21_error)
+        if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_9))) __PYX_ERR(0, 1019, __pyx_L21_error)
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       }
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_XDECREF(__pyx_9genexpr12__pyx_v_mcs); __pyx_9genexpr12__pyx_v_mcs = 0;
-    __Pyx_XDECREF(__pyx_9genexpr12__pyx_v_mcss); __pyx_9genexpr12__pyx_v_mcss = 0;
+    __Pyx_XDECREF(__pyx_9genexpr13__pyx_v_mcs); __pyx_9genexpr13__pyx_v_mcs = 0;
+    __Pyx_XDECREF(__pyx_9genexpr13__pyx_v_mcss); __pyx_9genexpr13__pyx_v_mcss = 0;
     goto __pyx_L26_exit_scope;
     __pyx_L21_error:;
-    __Pyx_XDECREF(__pyx_9genexpr12__pyx_v_mcs); __pyx_9genexpr12__pyx_v_mcs = 0;
-    __Pyx_XDECREF(__pyx_9genexpr12__pyx_v_mcss); __pyx_9genexpr12__pyx_v_mcss = 0;
+    __Pyx_XDECREF(__pyx_9genexpr13__pyx_v_mcs); __pyx_9genexpr13__pyx_v_mcs = 0;
+    __Pyx_XDECREF(__pyx_9genexpr13__pyx_v_mcss); __pyx_9genexpr13__pyx_v_mcss = 0;
     goto __pyx_L1_error;
     __pyx_L26_exit_scope:;
   } /* exit inner scope */
   __pyx_v_outds1 = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":941
+  /* "statmoments/_native.pyx":1021
  *     outds1  = [mcs.GetOutputDataObject(1)   for mcss in self._stats for mcs in mcss]
  * 
- *     return sum(map(_ms_helper, (intbl0, outtbl0, outds1))) * 1024             # <<<<<<<<<<<<<<
+ *     mem_ttest = 2 * 2 * self.trace_len * (self.trace_len + 1) // 2 * 8             # <<<<<<<<<<<<<<
+ * 
+ *     return sum(map(_ms_helper, (intbl0, outtbl0, outds1))) * 1024 + mem_ttest
+ */
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1021, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = PyNumber_Multiply(__pyx_int_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1021, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1021, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1021, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1021, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_1, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1021, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_2, __pyx_int_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1021, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_v_mem_ttest = __pyx_t_1;
+  __pyx_t_1 = 0;
+
+  /* "statmoments/_native.pyx":1023
+ *     mem_ttest = 2 * 2 * self.trace_len * (self.trace_len + 1) // 2 * 8
+ * 
+ *     return sum(map(_ms_helper, (intbl0, outtbl0, outds1))) * 1024 + mem_ttest             # <<<<<<<<<<<<<<
  * 
  *   @property
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 941, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1023, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_intbl0);
   __Pyx_GIVEREF(__pyx_v_intbl0);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_intbl0);
   __Pyx_INCREF(__pyx_v_outtbl0);
   __Pyx_GIVEREF(__pyx_v_outtbl0);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_outtbl0);
   __Pyx_INCREF(__pyx_v_outds1);
   __Pyx_GIVEREF(__pyx_v_outds1);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_outds1);
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 941, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1023, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_v__ms_helper);
   __Pyx_GIVEREF(__pyx_v__ms_helper);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v__ms_helper);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v__ms_helper);
   __Pyx_GIVEREF(__pyx_t_1);
-  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_map, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 941, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_map, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1023, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_sum, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 941, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_sum, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1023, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Multiply(__pyx_t_3, __pyx_int_1024); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 941, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_2, __pyx_int_1024); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1023, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_r = __pyx_t_1;
-  __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = PyNumber_Add(__pyx_t_1, __pyx_v_mem_ttest); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1023, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_r = __pyx_t_2;
+  __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":933
+  /* "statmoments/_native.pyx":1013
  *         mcs.SetTestOption(False)
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     def _ms_helper(instl):
  *       return sum(i.GetActualMemorySize() for i in instl)
  */
 
@@ -32417,26 +33998,27 @@
   __Pyx_AddTraceback("statmoments._native.bivar_vtk.memory_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v__ms_helper);
   __Pyx_XDECREF(__pyx_v_intbl0);
   __Pyx_XDECREF(__pyx_v_outtbl0);
   __Pyx_XDECREF(__pyx_v_outds1);
-  __Pyx_XDECREF(__pyx_9genexpr10__pyx_v_mcss);
-  __Pyx_XDECREF(__pyx_9genexpr10__pyx_v_mcs);
+  __Pyx_XDECREF(__pyx_v_mem_ttest);
   __Pyx_XDECREF(__pyx_9genexpr11__pyx_v_mcss);
   __Pyx_XDECREF(__pyx_9genexpr11__pyx_v_mcs);
   __Pyx_XDECREF(__pyx_9genexpr12__pyx_v_mcss);
   __Pyx_XDECREF(__pyx_9genexpr12__pyx_v_mcs);
+  __Pyx_XDECREF(__pyx_9genexpr13__pyx_v_mcss);
+  __Pyx_XDECREF(__pyx_9genexpr13__pyx_v_mcs);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":944
+/* "statmoments/_native.pyx":1026
  * 
  *   @property
  *   def total_count(self):             # <<<<<<<<<<<<<<
  *     return sum(self._counts[0])
  * 
  */
 
@@ -32460,35 +34042,35 @@
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("total_count", 0);
 
-  /* "statmoments/_native.pyx":945
+  /* "statmoments/_native.pyx":1027
  *   @property
  *   def total_count(self):
  *     return sum(self._counts[0])             # <<<<<<<<<<<<<<
  * 
  *   def update(self, traces, classifiers):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_counts_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 945, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_counts_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1027, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 945, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1027, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_sum, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 945, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_sum, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1027, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":944
+  /* "statmoments/_native.pyx":1026
  * 
  *   @property
  *   def total_count(self):             # <<<<<<<<<<<<<<
  *     return sum(self._counts[0])
  * 
  */
 
@@ -32500,15 +34082,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":947
+/* "statmoments/_native.pyx":1029
  *     return sum(self._counts[0])
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     traces = np.array(np.asarray(traces, dtype=np.float64).T, copy=True)
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  */
 
@@ -32546,40 +34128,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_traces)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 1); __PYX_ERR(0, 947, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 1); __PYX_ERR(0, 1029, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifiers)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 2); __PYX_ERR(0, 947, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 2); __PYX_ERR(0, 1029, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update") < 0)) __PYX_ERR(0, 947, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update") < 0)) __PYX_ERR(0, 1029, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_traces = values[1];
     __pyx_v_classifiers = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 947, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1029, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native.bivar_vtk.update", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_9bivar_vtk_6update(__pyx_self, __pyx_v_self, __pyx_v_traces, __pyx_v_classifiers);
 
@@ -32621,593 +34203,593 @@
   int __pyx_t_18;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("update", 0);
   __Pyx_INCREF(__pyx_v_traces);
 
-  /* "statmoments/_native.pyx":948
+  /* "statmoments/_native.pyx":1030
  * 
  *   def update(self, traces, classifiers):
  *     traces = np.array(np.asarray(traces, dtype=np.float64).T, copy=True)             # <<<<<<<<<<<<<<
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1030, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1030, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1030, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_asarray); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_asarray); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1030, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1030, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_traces);
   __Pyx_GIVEREF(__pyx_v_traces);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_traces);
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1030, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1030, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1030, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 948, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 1030, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1030, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_T); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_T); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1030, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1030, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1030, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_copy, Py_True) < 0) __PYX_ERR(0, 948, __pyx_L1_error)
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 948, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_copy, Py_True) < 0) __PYX_ERR(0, 1030, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1030, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF_SET(__pyx_v_traces, __pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":949
+  /* "statmoments/_native.pyx":1031
  *   def update(self, traces, classifiers):
  *     traces = np.array(np.asarray(traces, dtype=np.float64).T, copy=True)
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)             # <<<<<<<<<<<<<<
  * 
  *     for i in range(len(cl_copy[0])):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 949, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1031, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_asarray); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 949, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_asarray); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1031, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 949, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1031, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_classifiers);
   __Pyx_GIVEREF(__pyx_v_classifiers);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_classifiers);
-  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 949, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1031, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 949, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1031, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_uint8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 949, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_uint8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1031, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 949, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 1031, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 949, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1031, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_cl_copy = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":951
+  /* "statmoments/_native.pyx":1033
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  * 
  *     for i in range(len(cl_copy[0])):             # <<<<<<<<<<<<<<
- *       cls0 = (cl_copy[:,i] == 0)
+ *       cls0 = (cl_copy[:, i] == 0)
  *       traces_cl = [traces[:, cls0], traces[:, ~cls0]]
  */
-  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_cl_copy, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 951, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_cl_copy, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1033, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_7 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 951, __pyx_L1_error)
+  __pyx_t_7 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1033, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_8 = __pyx_t_7;
   for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
     __pyx_v_i = __pyx_t_9;
 
-    /* "statmoments/_native.pyx":952
+    /* "statmoments/_native.pyx":1034
  * 
  *     for i in range(len(cl_copy[0])):
- *       cls0 = (cl_copy[:,i] == 0)             # <<<<<<<<<<<<<<
+ *       cls0 = (cl_copy[:, i] == 0)             # <<<<<<<<<<<<<<
  *       traces_cl = [traces[:, cls0], traces[:, ~cls0]]
  *       self._counts[i][0] += len(traces_cl[0][0])
  */
-    __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 952, __pyx_L1_error)
+    __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1034, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 952, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1034, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_INCREF(__pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_slice__5);
-    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_slice__5);
+    __Pyx_INCREF(__pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_slice__7);
+    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_slice__7);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_3);
     __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_cl_copy, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 952, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_cl_copy, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1034, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyInt_EqObjC(__pyx_t_3, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 952, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyInt_EqObjC(__pyx_t_3, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1034, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_XDECREF_SET(__pyx_v_cls0, __pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":953
+    /* "statmoments/_native.pyx":1035
  *     for i in range(len(cl_copy[0])):
- *       cls0 = (cl_copy[:,i] == 0)
+ *       cls0 = (cl_copy[:, i] == 0)
  *       traces_cl = [traces[:, cls0], traces[:, ~cls0]]             # <<<<<<<<<<<<<<
  *       self._counts[i][0] += len(traces_cl[0][0])
  *       self._counts[i][1] += len(traces_cl[1][0])
  */
-    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 953, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1035, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_INCREF(__pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_slice__5);
-    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_slice__5);
+    __Pyx_INCREF(__pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_slice__7);
+    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_slice__7);
     __Pyx_INCREF(__pyx_v_cls0);
     __Pyx_GIVEREF(__pyx_v_cls0);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_v_cls0);
-    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_traces, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 953, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_traces, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1035, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyNumber_Invert(__pyx_v_cls0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 953, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Invert(__pyx_v_cls0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1035, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 953, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1035, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_INCREF(__pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_slice__5);
-    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_slice__5);
+    __Pyx_INCREF(__pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_slice__7);
+    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_slice__7);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_6);
     __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_traces, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 953, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_traces, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1035, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 953, __pyx_L1_error)
+    __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1035, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_3);
     PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_6);
     PyList_SET_ITEM(__pyx_t_1, 1, __pyx_t_6);
     __pyx_t_3 = 0;
     __pyx_t_6 = 0;
     __Pyx_XDECREF_SET(__pyx_v_traces_cl, ((PyObject*)__pyx_t_1));
     __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":954
- *       cls0 = (cl_copy[:,i] == 0)
+    /* "statmoments/_native.pyx":1036
+ *       cls0 = (cl_copy[:, i] == 0)
  *       traces_cl = [traces[:, cls0], traces[:, ~cls0]]
  *       self._counts[i][0] += len(traces_cl[0][0])             # <<<<<<<<<<<<<<
  *       self._counts[i][1] += len(traces_cl[1][0])
  *       for mcs, tr_set in zip(self._stats[i], traces_cl):
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_counts_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 954, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_counts_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1036, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 954, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1036, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_10 = 0;
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_6, __pyx_t_10, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 954, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_6, __pyx_t_10, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1036, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_GetItemInt(PyList_GET_ITEM(__pyx_v_traces_cl, 0), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 954, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(PyList_GET_ITEM(__pyx_v_traces_cl, 0), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1036, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_11 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_11 == ((Py_ssize_t)-1))) __PYX_ERR(0, 954, __pyx_L1_error)
+    __pyx_t_11 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_11 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1036, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 954, __pyx_L1_error)
+    __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1036, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyNumber_InPlaceAdd(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 954, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_InPlaceAdd(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1036, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(__Pyx_SetItemInt(__pyx_t_6, __pyx_t_10, __pyx_t_4, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0) < 0)) __PYX_ERR(0, 954, __pyx_L1_error)
+    if (unlikely(__Pyx_SetItemInt(__pyx_t_6, __pyx_t_10, __pyx_t_4, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0) < 0)) __PYX_ERR(0, 1036, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "statmoments/_native.pyx":955
+    /* "statmoments/_native.pyx":1037
  *       traces_cl = [traces[:, cls0], traces[:, ~cls0]]
  *       self._counts[i][0] += len(traces_cl[0][0])
  *       self._counts[i][1] += len(traces_cl[1][0])             # <<<<<<<<<<<<<<
  *       for mcs, tr_set in zip(self._stats[i], traces_cl):
  *         if tr_set.shape[1] == 0:
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_counts_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 955, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_counts_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1037, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_6, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 955, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_6, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1037, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_10 = 1;
-    __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_4, __pyx_t_10, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 955, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_4, __pyx_t_10, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1037, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_3 = __Pyx_GetItemInt(PyList_GET_ITEM(__pyx_v_traces_cl, 1), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(PyList_GET_ITEM(__pyx_v_traces_cl, 1), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1037, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_11 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_11 == ((Py_ssize_t)-1))) __PYX_ERR(0, 955, __pyx_L1_error)
+    __pyx_t_11 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_11 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1037, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
+    __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1037, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_1 = PyNumber_InPlaceAdd(__pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 955, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_InPlaceAdd(__pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1037, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(__Pyx_SetItemInt(__pyx_t_4, __pyx_t_10, __pyx_t_1, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0) < 0)) __PYX_ERR(0, 955, __pyx_L1_error)
+    if (unlikely(__Pyx_SetItemInt(__pyx_t_4, __pyx_t_10, __pyx_t_1, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0) < 0)) __PYX_ERR(0, 1037, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "statmoments/_native.pyx":956
+    /* "statmoments/_native.pyx":1038
  *       self._counts[i][0] += len(traces_cl[0][0])
  *       self._counts[i][1] += len(traces_cl[1][0])
  *       for mcs, tr_set in zip(self._stats[i], traces_cl):             # <<<<<<<<<<<<<<
  *         if tr_set.shape[1] == 0:
  *           continue
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_stats); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 956, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_stats); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1038, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_4, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 956, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_4, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1038, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 956, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1038, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
     __Pyx_INCREF(__pyx_v_traces_cl);
     __Pyx_GIVEREF(__pyx_v_traces_cl);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_traces_cl);
     __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_zip, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 956, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_zip, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1038, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
       __pyx_t_4 = __pyx_t_1; __Pyx_INCREF(__pyx_t_4); __pyx_t_10 = 0;
       __pyx_t_12 = NULL;
     } else {
-      __pyx_t_10 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 956, __pyx_L1_error)
+      __pyx_t_10 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1038, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_12 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 956, __pyx_L1_error)
+      __pyx_t_12 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1038, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     for (;;) {
       if (likely(!__pyx_t_12)) {
         if (likely(PyList_CheckExact(__pyx_t_4))) {
           if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_10); __Pyx_INCREF(__pyx_t_1); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 956, __pyx_L1_error)
+          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_10); __Pyx_INCREF(__pyx_t_1); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 1038, __pyx_L1_error)
           #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 956, __pyx_L1_error)
+          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1038, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           #endif
         } else {
           if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_10); __Pyx_INCREF(__pyx_t_1); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 956, __pyx_L1_error)
+          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_10); __Pyx_INCREF(__pyx_t_1); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 1038, __pyx_L1_error)
           #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 956, __pyx_L1_error)
+          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1038, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           #endif
         }
       } else {
         __pyx_t_1 = __pyx_t_12(__pyx_t_4);
         if (unlikely(!__pyx_t_1)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 956, __pyx_L1_error)
+            else __PYX_ERR(0, 1038, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_1);
       }
       if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
         PyObject* sequence = __pyx_t_1;
         Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
         if (unlikely(size != 2)) {
           if (size > 2) __Pyx_RaiseTooManyValuesError(2);
           else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-          __PYX_ERR(0, 956, __pyx_L1_error)
+          __PYX_ERR(0, 1038, __pyx_L1_error)
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
         if (likely(PyTuple_CheckExact(sequence))) {
           __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
           __pyx_t_6 = PyTuple_GET_ITEM(sequence, 1); 
         } else {
           __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
           __pyx_t_6 = PyList_GET_ITEM(sequence, 1); 
         }
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_6);
         #else
-        __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 956, __pyx_L1_error)
+        __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1038, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_6 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 956, __pyx_L1_error)
+        __pyx_t_6 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1038, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         #endif
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       } else {
         Py_ssize_t index = -1;
-        __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 956, __pyx_L1_error)
+        __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1038, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __pyx_t_13 = Py_TYPE(__pyx_t_2)->tp_iternext;
         index = 0; __pyx_t_3 = __pyx_t_13(__pyx_t_2); if (unlikely(!__pyx_t_3)) goto __pyx_L7_unpacking_failed;
         __Pyx_GOTREF(__pyx_t_3);
         index = 1; __pyx_t_6 = __pyx_t_13(__pyx_t_2); if (unlikely(!__pyx_t_6)) goto __pyx_L7_unpacking_failed;
         __Pyx_GOTREF(__pyx_t_6);
-        if (__Pyx_IternextUnpackEndCheck(__pyx_t_13(__pyx_t_2), 2) < 0) __PYX_ERR(0, 956, __pyx_L1_error)
+        if (__Pyx_IternextUnpackEndCheck(__pyx_t_13(__pyx_t_2), 2) < 0) __PYX_ERR(0, 1038, __pyx_L1_error)
         __pyx_t_13 = NULL;
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         goto __pyx_L8_unpacking_done;
         __pyx_L7_unpacking_failed:;
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __pyx_t_13 = NULL;
         if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-        __PYX_ERR(0, 956, __pyx_L1_error)
+        __PYX_ERR(0, 1038, __pyx_L1_error)
         __pyx_L8_unpacking_done:;
       }
       __Pyx_XDECREF_SET(__pyx_v_mcs, __pyx_t_3);
       __pyx_t_3 = 0;
       __Pyx_XDECREF_SET(__pyx_v_tr_set, __pyx_t_6);
       __pyx_t_6 = 0;
 
-      /* "statmoments/_native.pyx":957
+      /* "statmoments/_native.pyx":1039
  *       self._counts[i][1] += len(traces_cl[1][0])
  *       for mcs, tr_set in zip(self._stats[i], traces_cl):
  *         if tr_set.shape[1] == 0:             # <<<<<<<<<<<<<<
  *           continue
  *         tbl = vtk.vtkTable()
  */
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_tr_set, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 957, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_tr_set, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1039, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 957, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1039, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_t_6, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 957, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_t_6, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1039, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_14 < 0)) __PYX_ERR(0, 957, __pyx_L1_error)
+      __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_14 < 0)) __PYX_ERR(0, 1039, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       if (__pyx_t_14) {
 
-        /* "statmoments/_native.pyx":958
+        /* "statmoments/_native.pyx":1040
  *       for mcs, tr_set in zip(self._stats[i], traces_cl):
  *         if tr_set.shape[1] == 0:
  *           continue             # <<<<<<<<<<<<<<
  *         tbl = vtk.vtkTable()
  *         tbl.SetNumberOfRows(len(tr_set[0]))
  */
         goto __pyx_L5_continue;
 
-        /* "statmoments/_native.pyx":957
+        /* "statmoments/_native.pyx":1039
  *       self._counts[i][1] += len(traces_cl[1][0])
  *       for mcs, tr_set in zip(self._stats[i], traces_cl):
  *         if tr_set.shape[1] == 0:             # <<<<<<<<<<<<<<
  *           continue
  *         tbl = vtk.vtkTable()
  */
       }
 
-      /* "statmoments/_native.pyx":959
+      /* "statmoments/_native.pyx":1041
  *         if tr_set.shape[1] == 0:
  *           continue
  *         tbl = vtk.vtkTable()             # <<<<<<<<<<<<<<
  *         tbl.SetNumberOfRows(len(tr_set[0]))
  *         mcs.SetInputData(tbl)
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_vtk); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 959, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_vtk); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1041, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_vtkTable); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 959, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_vtkTable); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1041, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __pyx_t_6 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
         __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
         if (likely(__pyx_t_6)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
           __Pyx_INCREF(__pyx_t_6);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_3, function);
         }
       }
       __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_6) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 959, __pyx_L1_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1041, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_XDECREF_SET(__pyx_v_tbl, __pyx_t_1);
       __pyx_t_1 = 0;
 
-      /* "statmoments/_native.pyx":960
+      /* "statmoments/_native.pyx":1042
  *           continue
  *         tbl = vtk.vtkTable()
  *         tbl.SetNumberOfRows(len(tr_set[0]))             # <<<<<<<<<<<<<<
  *         mcs.SetInputData(tbl)
  *         for j, tr in enumerate(tr_set):
  */
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_tbl, __pyx_n_s_SetNumberOfRows); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 960, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_tbl, __pyx_n_s_SetNumberOfRows); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1042, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_tr_set, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 960, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_tr_set, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1042, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_11 = PyObject_Length(__pyx_t_6); if (unlikely(__pyx_t_11 == ((Py_ssize_t)-1))) __PYX_ERR(0, 960, __pyx_L1_error)
+      __pyx_t_11 = PyObject_Length(__pyx_t_6); if (unlikely(__pyx_t_11 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1042, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 960, __pyx_L1_error)
+      __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1042, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __pyx_t_2 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
         __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
         if (likely(__pyx_t_2)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
           __Pyx_INCREF(__pyx_t_2);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_3, function);
         }
       }
       __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_6);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 960, __pyx_L1_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1042, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "statmoments/_native.pyx":961
+      /* "statmoments/_native.pyx":1043
  *         tbl = vtk.vtkTable()
  *         tbl.SetNumberOfRows(len(tr_set[0]))
  *         mcs.SetInputData(tbl)             # <<<<<<<<<<<<<<
  *         for j, tr in enumerate(tr_set):
  *           vtk_arr = np2vtk(tr)
  */
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_mcs, __pyx_n_s_SetInputData); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 961, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_mcs, __pyx_n_s_SetInputData); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1043, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_6 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
         __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
         if (likely(__pyx_t_6)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
           __Pyx_INCREF(__pyx_t_6);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_3, function);
         }
       }
       __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_6, __pyx_v_tbl) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_tbl);
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 961, __pyx_L1_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1043, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "statmoments/_native.pyx":962
+      /* "statmoments/_native.pyx":1044
  *         tbl.SetNumberOfRows(len(tr_set[0]))
  *         mcs.SetInputData(tbl)
  *         for j, tr in enumerate(tr_set):             # <<<<<<<<<<<<<<
  *           vtk_arr = np2vtk(tr)
  *           vtk_arr.SetName('P{}'.format(j))
  */
       __Pyx_INCREF(__pyx_int_0);
       __pyx_t_1 = __pyx_int_0;
       if (likely(PyList_CheckExact(__pyx_v_tr_set)) || PyTuple_CheckExact(__pyx_v_tr_set)) {
         __pyx_t_3 = __pyx_v_tr_set; __Pyx_INCREF(__pyx_t_3); __pyx_t_11 = 0;
         __pyx_t_15 = NULL;
       } else {
-        __pyx_t_11 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_tr_set); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 962, __pyx_L1_error)
+        __pyx_t_11 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_tr_set); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1044, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_15 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 962, __pyx_L1_error)
+        __pyx_t_15 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1044, __pyx_L1_error)
       }
       for (;;) {
         if (likely(!__pyx_t_15)) {
           if (likely(PyList_CheckExact(__pyx_t_3))) {
             if (__pyx_t_11 >= PyList_GET_SIZE(__pyx_t_3)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_6 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_11); __Pyx_INCREF(__pyx_t_6); __pyx_t_11++; if (unlikely(0 < 0)) __PYX_ERR(0, 962, __pyx_L1_error)
+            __pyx_t_6 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_11); __Pyx_INCREF(__pyx_t_6); __pyx_t_11++; if (unlikely(0 < 0)) __PYX_ERR(0, 1044, __pyx_L1_error)
             #else
-            __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_11); __pyx_t_11++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 962, __pyx_L1_error)
+            __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_11); __pyx_t_11++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1044, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_6);
             #endif
           } else {
             if (__pyx_t_11 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_11); __Pyx_INCREF(__pyx_t_6); __pyx_t_11++; if (unlikely(0 < 0)) __PYX_ERR(0, 962, __pyx_L1_error)
+            __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_11); __Pyx_INCREF(__pyx_t_6); __pyx_t_11++; if (unlikely(0 < 0)) __PYX_ERR(0, 1044, __pyx_L1_error)
             #else
-            __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_11); __pyx_t_11++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 962, __pyx_L1_error)
+            __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_11); __pyx_t_11++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1044, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_6);
             #endif
           }
         } else {
           __pyx_t_6 = __pyx_t_15(__pyx_t_3);
           if (unlikely(!__pyx_t_6)) {
             PyObject* exc_type = PyErr_Occurred();
             if (exc_type) {
               if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-              else __PYX_ERR(0, 962, __pyx_L1_error)
+              else __PYX_ERR(0, 1044, __pyx_L1_error)
             }
             break;
           }
           __Pyx_GOTREF(__pyx_t_6);
         }
         __Pyx_XDECREF_SET(__pyx_v_tr, __pyx_t_6);
         __pyx_t_6 = 0;
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_1);
-        __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 962, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1044, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_1);
         __pyx_t_1 = __pyx_t_6;
         __pyx_t_6 = 0;
 
-        /* "statmoments/_native.pyx":963
+        /* "statmoments/_native.pyx":1045
  *         mcs.SetInputData(tbl)
  *         for j, tr in enumerate(tr_set):
  *           vtk_arr = np2vtk(tr)             # <<<<<<<<<<<<<<
  *           vtk_arr.SetName('P{}'.format(j))
  *           tbl.AddColumn(vtk_arr)
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np2vtk); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 963, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np2vtk); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1045, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __pyx_t_5 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
           __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
           if (likely(__pyx_t_5)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
             __Pyx_INCREF(__pyx_t_5);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_2, function);
           }
         }
         __pyx_t_6 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_v_tr) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_tr);
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-        if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 963, __pyx_L1_error)
+        if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1045, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_XDECREF_SET(__pyx_v_vtk_arr, __pyx_t_6);
         __pyx_t_6 = 0;
 
-        /* "statmoments/_native.pyx":964
+        /* "statmoments/_native.pyx":1046
  *         for j, tr in enumerate(tr_set):
  *           vtk_arr = np2vtk(tr)
  *           vtk_arr.SetName('P{}'.format(j))             # <<<<<<<<<<<<<<
  *           tbl.AddColumn(vtk_arr)
  *           mcs.SetColumnStatus(vtk_arr.GetName(), 1)
  */
-        __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_vtk_arr, __pyx_n_s_SetName); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 964, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_vtk_arr, __pyx_n_s_SetName); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1046, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_16 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_P, __pyx_n_s_format); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 964, __pyx_L1_error)
+        __pyx_t_16 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_P, __pyx_n_s_format); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1046, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_16);
         __pyx_t_17 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_16))) {
           __pyx_t_17 = PyMethod_GET_SELF(__pyx_t_16);
           if (likely(__pyx_t_17)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_16);
             __Pyx_INCREF(__pyx_t_17);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_16, function);
           }
         }
         __pyx_t_5 = (__pyx_t_17) ? __Pyx_PyObject_Call2Args(__pyx_t_16, __pyx_t_17, __pyx_v_j) : __Pyx_PyObject_CallOneArg(__pyx_t_16, __pyx_v_j);
         __Pyx_XDECREF(__pyx_t_17); __pyx_t_17 = 0;
-        if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 964, __pyx_L1_error)
+        if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1046, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
         __pyx_t_16 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
           __pyx_t_16 = PyMethod_GET_SELF(__pyx_t_2);
           if (likely(__pyx_t_16)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -33215,69 +34797,69 @@
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_2, function);
           }
         }
         __pyx_t_6 = (__pyx_t_16) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_16, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_5);
         __Pyx_XDECREF(__pyx_t_16); __pyx_t_16 = 0;
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 964, __pyx_L1_error)
+        if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1046, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-        /* "statmoments/_native.pyx":965
+        /* "statmoments/_native.pyx":1047
  *           vtk_arr = np2vtk(tr)
  *           vtk_arr.SetName('P{}'.format(j))
  *           tbl.AddColumn(vtk_arr)             # <<<<<<<<<<<<<<
  *           mcs.SetColumnStatus(vtk_arr.GetName(), 1)
  *         mcs.Update()
  */
-        __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_tbl, __pyx_n_s_AddColumn); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 965, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_tbl, __pyx_n_s_AddColumn); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1047, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __pyx_t_5 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
           __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
           if (likely(__pyx_t_5)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
             __Pyx_INCREF(__pyx_t_5);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_2, function);
           }
         }
         __pyx_t_6 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_v_vtk_arr) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_vtk_arr);
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-        if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 965, __pyx_L1_error)
+        if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1047, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-        /* "statmoments/_native.pyx":966
+        /* "statmoments/_native.pyx":1048
  *           vtk_arr.SetName('P{}'.format(j))
  *           tbl.AddColumn(vtk_arr)
  *           mcs.SetColumnStatus(vtk_arr.GetName(), 1)             # <<<<<<<<<<<<<<
  *         mcs.Update()
  * 
  */
-        __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_mcs, __pyx_n_s_SetColumnStatus); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_mcs, __pyx_n_s_SetColumnStatus); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1048, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_16 = __Pyx_PyObject_GetAttrStr(__pyx_v_vtk_arr, __pyx_n_s_GetName); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 966, __pyx_L1_error)
+        __pyx_t_16 = __Pyx_PyObject_GetAttrStr(__pyx_v_vtk_arr, __pyx_n_s_GetName); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1048, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_16);
         __pyx_t_17 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_16))) {
           __pyx_t_17 = PyMethod_GET_SELF(__pyx_t_16);
           if (likely(__pyx_t_17)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_16);
             __Pyx_INCREF(__pyx_t_17);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_16, function);
           }
         }
         __pyx_t_5 = (__pyx_t_17) ? __Pyx_PyObject_CallOneArg(__pyx_t_16, __pyx_t_17) : __Pyx_PyObject_CallNoArg(__pyx_t_16);
         __Pyx_XDECREF(__pyx_t_17); __pyx_t_17 = 0;
-        if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
+        if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1048, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
         __pyx_t_16 = NULL;
         __pyx_t_18 = 0;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
           __pyx_t_16 = PyMethod_GET_SELF(__pyx_t_2);
           if (likely(__pyx_t_16)) {
@@ -33287,98 +34869,98 @@
             __Pyx_DECREF_SET(__pyx_t_2, function);
             __pyx_t_18 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_2)) {
           PyObject *__pyx_temp[3] = {__pyx_t_16, __pyx_t_5, __pyx_int_1};
-          __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 966, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1048, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_16); __pyx_t_16 = 0;
           __Pyx_GOTREF(__pyx_t_6);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
           PyObject *__pyx_temp[3] = {__pyx_t_16, __pyx_t_5, __pyx_int_1};
-          __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 966, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1048, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_16); __pyx_t_16 = 0;
           __Pyx_GOTREF(__pyx_t_6);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         } else
         #endif
         {
-          __pyx_t_17 = PyTuple_New(2+__pyx_t_18); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 966, __pyx_L1_error)
+          __pyx_t_17 = PyTuple_New(2+__pyx_t_18); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1048, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_17);
           if (__pyx_t_16) {
             __Pyx_GIVEREF(__pyx_t_16); PyTuple_SET_ITEM(__pyx_t_17, 0, __pyx_t_16); __pyx_t_16 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_5);
           PyTuple_SET_ITEM(__pyx_t_17, 0+__pyx_t_18, __pyx_t_5);
           __Pyx_INCREF(__pyx_int_1);
           __Pyx_GIVEREF(__pyx_int_1);
           PyTuple_SET_ITEM(__pyx_t_17, 1+__pyx_t_18, __pyx_int_1);
           __pyx_t_5 = 0;
-          __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_17, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 966, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_17, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1048, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
         }
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-        /* "statmoments/_native.pyx":962
+        /* "statmoments/_native.pyx":1044
  *         tbl.SetNumberOfRows(len(tr_set[0]))
  *         mcs.SetInputData(tbl)
  *         for j, tr in enumerate(tr_set):             # <<<<<<<<<<<<<<
  *           vtk_arr = np2vtk(tr)
  *           vtk_arr.SetName('P{}'.format(j))
  */
       }
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "statmoments/_native.pyx":967
+      /* "statmoments/_native.pyx":1049
  *           tbl.AddColumn(vtk_arr)
  *           mcs.SetColumnStatus(vtk_arr.GetName(), 1)
  *         mcs.Update()             # <<<<<<<<<<<<<<
  * 
  *   def counts(self, i):
  */
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_mcs, __pyx_n_s_Update); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 967, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_mcs, __pyx_n_s_Update); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1049, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_6 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
         __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
         if (likely(__pyx_t_6)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
           __Pyx_INCREF(__pyx_t_6);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_3, function);
         }
       }
       __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_6) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 967, __pyx_L1_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1049, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "statmoments/_native.pyx":956
+      /* "statmoments/_native.pyx":1038
  *       self._counts[i][0] += len(traces_cl[0][0])
  *       self._counts[i][1] += len(traces_cl[1][0])
  *       for mcs, tr_set in zip(self._stats[i], traces_cl):             # <<<<<<<<<<<<<<
  *         if tr_set.shape[1] == 0:
  *           continue
  */
       __pyx_L5_continue:;
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   }
 
-  /* "statmoments/_native.pyx":947
+  /* "statmoments/_native.pyx":1029
  *     return sum(self._counts[0])
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     traces = np.array(np.asarray(traces, dtype=np.float64).T, copy=True)
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  */
 
@@ -33408,15 +34990,15 @@
   __Pyx_XDECREF(__pyx_v_vtk_arr);
   __Pyx_XDECREF(__pyx_v_traces);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":969
+/* "statmoments/_native.pyx":1051
  *         mcs.Update()
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
  *     # dbs = (mcs.GetOutputDataObject(1).GetBlock(1) for mcs in self._stats[i])
  *     # return [vtk2np(dd.GetColumn(1))[dd.GetNumberOfRows()-1] for dd in dbs]
  */
 
@@ -33451,32 +35033,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_i)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, 1); __PYX_ERR(0, 969, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, 1); __PYX_ERR(0, 1051, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "counts") < 0)) __PYX_ERR(0, 969, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "counts") < 0)) __PYX_ERR(0, 1051, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_i = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 969, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1051, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native.bivar_vtk.counts", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_9bivar_vtk_8counts(__pyx_self, __pyx_v_self, __pyx_v_i);
 
@@ -33491,32 +35073,32 @@
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("counts", 0);
 
-  /* "statmoments/_native.pyx":972
+  /* "statmoments/_native.pyx":1054
  *     # dbs = (mcs.GetOutputDataObject(1).GetBlock(1) for mcs in self._stats[i])
  *     # return [vtk2np(dd.GetColumn(1))[dd.GetNumberOfRows()-1] for dd in dbs]
  *     return self._counts[i]             # <<<<<<<<<<<<<<
  * 
- *   def _moments(self, moments, normalize):
+ *   def moments(self, moments, normalize):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_counts_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 972, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_counts_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1054, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 972, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1054, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":969
+  /* "statmoments/_native.pyx":1051
  *         mcs.Update()
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
  *     # dbs = (mcs.GetOutputDataObject(1).GetBlock(1) for mcs in self._stats[i])
  *     # return [vtk2np(dd.GetColumn(1))[dd.GetNumberOfRows()-1] for dd in dbs]
  */
 
@@ -33529,35 +35111,35 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static PyObject *__pyx_gb_11statmoments_7_native_9bivar_vtk_12generator8(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "statmoments/_native.pyx":974
+/* "statmoments/_native.pyx":1056
  *     return self._counts[i]
  * 
- *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
- *     m = moments[0]
- *     if self.moment < np.max(m):
+ *   def moments(self, moments, normalize):             # <<<<<<<<<<<<<<
+ *     maxm = np.max(moments)
+ *     if self.moment * 2 < maxm:
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11statmoments_7_native_9bivar_vtk_11_moments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_11statmoments_7_native_9bivar_vtk_11_moments = {"_moments", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_9bivar_vtk_11_moments, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11statmoments_7_native_9bivar_vtk_11_moments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_11statmoments_7_native_9bivar_vtk_11moments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_11statmoments_7_native_9bivar_vtk_11moments = {"moments", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_9bivar_vtk_11moments, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11statmoments_7_native_9bivar_vtk_11moments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_moments = 0;
   PyObject *__pyx_v_normalize = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("_moments (wrapper)", 0);
+  __Pyx_RefNannySetupContext("moments (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_moments,&__pyx_n_s_normalize,0};
     PyObject* values[3] = {0,0,0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
@@ -33575,647 +35157,1013 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moments)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 1); __PYX_ERR(0, 974, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("moments", 1, 3, 3, 1); __PYX_ERR(0, 1056, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_normalize)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 2); __PYX_ERR(0, 974, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("moments", 1, 3, 3, 2); __PYX_ERR(0, 1056, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_moments") < 0)) __PYX_ERR(0, 974, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "moments") < 0)) __PYX_ERR(0, 1056, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_moments = values[1];
     __pyx_v_normalize = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 974, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("moments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1056, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("statmoments._native.bivar_vtk._moments", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("statmoments._native.bivar_vtk.moments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11statmoments_7_native_9bivar_vtk_10_moments(__pyx_self, __pyx_v_self, __pyx_v_moments, __pyx_v_normalize);
+  __pyx_r = __pyx_pf_11statmoments_7_native_9bivar_vtk_10moments(__pyx_self, __pyx_v_self, __pyx_v_moments, __pyx_v_normalize);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11statmoments_7_native_9bivar_vtk_10_moments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize) {
-  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17__moments *__pyx_cur_scope;
+static PyObject *__pyx_pf_11statmoments_7_native_9bivar_vtk_10moments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, PyObject *__pyx_v_normalize) {
+  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17_moments *__pyx_cur_scope;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("_moments", 0);
-  __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17__moments *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_17__moments(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_17__moments, __pyx_empty_tuple, NULL);
+  __Pyx_RefNannySetupContext("moments", 0);
+  __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17_moments *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_17_moments(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_17_moments, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
-    __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17__moments *)Py_None);
+    __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17_moments *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 974, __pyx_L1_error)
+    __PYX_ERR(0, 1056, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
   __pyx_cur_scope->__pyx_v_moments = __pyx_v_moments;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_moments);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_moments);
   __pyx_cur_scope->__pyx_v_normalize = __pyx_v_normalize;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_normalize);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_normalize);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_9bivar_vtk_12generator8, __pyx_codeobj__39, (PyObject *) __pyx_cur_scope, __pyx_n_s_moments_2, __pyx_n_s_bivar_vtk__moments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 974, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_9bivar_vtk_12generator8, __pyx_codeobj__38, (PyObject *) __pyx_cur_scope, __pyx_n_s_moments, __pyx_n_s_bivar_vtk_moments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 1056, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
-  __Pyx_AddTraceback("statmoments._native.bivar_vtk._moments", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("statmoments._native.bivar_vtk.moments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 static PyObject *__pyx_gb_11statmoments_7_native_9bivar_vtk_12generator8(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
 {
-  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17__moments *__pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17__moments *)__pyx_generator->closure);
+  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17_moments *__pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17_moments *)__pyx_generator->closure);
   PyObject *__pyx_r = NULL;
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
-  PyObject *__pyx_t_4 = NULL;
-  int __pyx_t_5;
-  Py_ssize_t __pyx_t_6;
-  PyObject *(*__pyx_t_7)(PyObject *);
-  Py_ssize_t __pyx_t_8;
-  PyObject *(*__pyx_t_9)(PyObject *);
-  PyObject *__pyx_t_10 = NULL;
+  int __pyx_t_4;
+  Py_ssize_t __pyx_t_5;
+  PyObject *__pyx_t_6 = NULL;
+  PyObject *__pyx_t_7 = NULL;
+  PyObject *(*__pyx_t_8)(PyObject *);
+  Py_ssize_t __pyx_t_9;
+  PyObject *(*__pyx_t_10)(PyObject *);
   PyObject *__pyx_t_11 = NULL;
   PyObject *__pyx_t_12 = NULL;
-  int __pyx_t_13;
+  PyObject *__pyx_t_13 = NULL;
+  PyObject *__pyx_t_14 = NULL;
+  Py_ssize_t __pyx_t_15;
+  PyObject *(*__pyx_t_16)(PyObject *);
+  PyObject *__pyx_t_17 = NULL;
+  PyObject *__pyx_t_18 = NULL;
+  Py_ssize_t __pyx_t_19;
+  PyObject *(*__pyx_t_20)(PyObject *);
+  PyObject *__pyx_t_21 = NULL;
+  PyObject *__pyx_t_22 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("_moments", 0);
+  __Pyx_RefNannySetupContext("moments", 0);
   switch (__pyx_generator->resume_label) {
     case 0: goto __pyx_L3_first_run;
-    case 1: goto __pyx_L10_resume_from_yield;
+    case 1: goto __pyx_L15_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 974, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 1056, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":975
+  /* "statmoments/_native.pyx":1057
  * 
- *   def _moments(self, moments, normalize):
- *     m = moments[0]             # <<<<<<<<<<<<<<
- *     if self.moment < np.max(m):
+ *   def moments(self, moments, normalize):
+ *     maxm = np.max(moments)             # <<<<<<<<<<<<<<
+ *     if self.moment * 2 < maxm:
  *       raise ValueError("The moment should be less or equal than indicated in constructor.")
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_moments, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 975, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1057, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_max); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1057, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = NULL;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
+    if (likely(__pyx_t_2)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+      __Pyx_INCREF(__pyx_t_2);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_3, function);
+    }
+  }
+  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_cur_scope->__pyx_v_moments) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_cur_scope->__pyx_v_moments);
+  __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1057, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_GIVEREF(__pyx_t_1);
-  __pyx_cur_scope->__pyx_v_m = __pyx_t_1;
+  __pyx_cur_scope->__pyx_v_maxm = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":976
- *   def _moments(self, moments, normalize):
- *     m = moments[0]
- *     if self.moment < np.max(m):             # <<<<<<<<<<<<<<
+  /* "statmoments/_native.pyx":1058
+ *   def moments(self, moments, normalize):
+ *     maxm = np.max(moments)
+ *     if self.moment * 2 < maxm:             # <<<<<<<<<<<<<<
  *       raise ValueError("The moment should be less or equal than indicated in constructor.")
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 976, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1058, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 976, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_int_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1058, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_max); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 976, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyObject_RichCompare(__pyx_t_3, __pyx_cur_scope->__pyx_v_maxm, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1058, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = NULL;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
-    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
-    if (likely(__pyx_t_3)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
-      __Pyx_INCREF(__pyx_t_3);
-      __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_4, function);
-    }
-  }
-  __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_cur_scope->__pyx_v_m) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_cur_scope->__pyx_v_m);
-  __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 976, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyObject_RichCompare(__pyx_t_1, __pyx_t_2, Py_LT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 976, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1058, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 976, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(__pyx_t_5)) {
+  if (unlikely(__pyx_t_4)) {
 
-    /* "statmoments/_native.pyx":977
- *     m = moments[0]
- *     if self.moment < np.max(m):
+    /* "statmoments/_native.pyx":1059
+ *     maxm = np.max(moments)
+ *     if self.moment * 2 < maxm:
  *       raise ValueError("The moment should be less or equal than indicated in constructor.")             # <<<<<<<<<<<<<<
  * 
  *     if normalize:
  */
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 977, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_Raise(__pyx_t_4, 0, 0, 0);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __PYX_ERR(0, 977, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1059, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __PYX_ERR(0, 1059, __pyx_L1_error)
 
-    /* "statmoments/_native.pyx":976
- *   def _moments(self, moments, normalize):
- *     m = moments[0]
- *     if self.moment < np.max(m):             # <<<<<<<<<<<<<<
+    /* "statmoments/_native.pyx":1058
+ *   def moments(self, moments, normalize):
+ *     maxm = np.max(moments)
+ *     if self.moment * 2 < maxm:             # <<<<<<<<<<<<<<
  *       raise ValueError("The moment should be less or equal than indicated in constructor.")
  * 
  */
   }
 
-  /* "statmoments/_native.pyx":979
+  /* "statmoments/_native.pyx":1061
  *       raise ValueError("The moment should be less or equal than indicated in constructor.")
  * 
  *     if normalize:             # <<<<<<<<<<<<<<
  *       raise NotImplementedError("Not implemented")
  * 
  */
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_normalize); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 979, __pyx_L1_error)
-  if (unlikely(__pyx_t_5)) {
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_normalize); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  if (unlikely(__pyx_t_4)) {
 
-    /* "statmoments/_native.pyx":980
+    /* "statmoments/_native.pyx":1062
  * 
  *     if normalize:
  *       raise NotImplementedError("Not implemented")             # <<<<<<<<<<<<<<
  * 
  *     tr_len, min_cnt = self.trace_len, self.acc_min_count
  */
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_NotImplementedError, __pyx_tuple__40, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 980, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_Raise(__pyx_t_4, 0, 0, 0);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __PYX_ERR(0, 980, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_NotImplementedError, __pyx_tuple__39, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1062, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __PYX_ERR(0, 1062, __pyx_L1_error)
 
-    /* "statmoments/_native.pyx":979
+    /* "statmoments/_native.pyx":1061
  *       raise ValueError("The moment should be less or equal than indicated in constructor.")
  * 
  *     if normalize:             # <<<<<<<<<<<<<<
  *       raise NotImplementedError("Not implemented")
  * 
  */
   }
 
-  /* "statmoments/_native.pyx":982
+  /* "statmoments/_native.pyx":1064
  *       raise NotImplementedError("Not implemented")
  * 
  *     tr_len, min_cnt = self.trace_len, self.acc_min_count             # <<<<<<<<<<<<<<
  *     triuflatten = _triuflatten_gen(tr_len)
  * 
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 982, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_acc_min_count); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 982, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_4);
-  __pyx_cur_scope->__pyx_v_tr_len = __pyx_t_4;
-  __pyx_t_4 = 0;
-  __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_cur_scope->__pyx_v_min_cnt = __pyx_t_2;
-  __pyx_t_2 = 0;
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1064, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_acc_min_count); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1064, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_cur_scope->__pyx_v_tr_len = __pyx_t_1;
+  __pyx_t_1 = 0;
+  __Pyx_GIVEREF(__pyx_t_3);
+  __pyx_cur_scope->__pyx_v_min_cnt = __pyx_t_3;
+  __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":983
+  /* "statmoments/_native.pyx":1065
  * 
  *     tr_len, min_cnt = self.trace_len, self.acc_min_count
  *     triuflatten = _triuflatten_gen(tr_len)             # <<<<<<<<<<<<<<
  * 
- *     avgs = []
+ *     retm = np.empty((2, len(moments), tr_len), dtype=np.float64)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_triuflatten_gen); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 983, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = NULL;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
-    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
-    if (likely(__pyx_t_1)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
-      __Pyx_INCREF(__pyx_t_1);
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_triuflatten_gen); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1065, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = NULL;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
+    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
+    if (likely(__pyx_t_2)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+      __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_4, function);
+      __Pyx_DECREF_SET(__pyx_t_1, function);
     }
   }
-  __pyx_t_2 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_1, __pyx_cur_scope->__pyx_v_tr_len) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_cur_scope->__pyx_v_tr_len);
-  __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 983, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_cur_scope->__pyx_v_triuflatten = __pyx_t_2;
-  __pyx_t_2 = 0;
+  __pyx_t_3 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_2, __pyx_cur_scope->__pyx_v_tr_len) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_cur_scope->__pyx_v_tr_len);
+  __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1065, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_GIVEREF(__pyx_t_3);
+  __pyx_cur_scope->__pyx_v_triuflatten = __pyx_t_3;
+  __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":985
+  /* "statmoments/_native.pyx":1067
  *     triuflatten = _triuflatten_gen(tr_len)
  * 
- *     avgs = []             # <<<<<<<<<<<<<<
- *     for mcss in self._stats:
- *       for mcs in mcss:
+ *     retm = np.empty((2, len(moments), tr_len), dtype=np.float64)             # <<<<<<<<<<<<<<
+ * 
+ *     for ii, mcss in enumerate(self._stats):
  */
-  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 985, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1067, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1067, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_5 = PyObject_Length(__pyx_cur_scope->__pyx_v_moments); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1067, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1067, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1067, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_INCREF(__pyx_int_2);
+  __Pyx_GIVEREF(__pyx_int_2);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_2);
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3);
+  __Pyx_INCREF(__pyx_cur_scope->__pyx_v_tr_len);
+  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_tr_len);
+  PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_cur_scope->__pyx_v_tr_len);
+  __pyx_t_3 = 0;
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1067, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_cur_scope->__pyx_v_avgs = ((PyObject*)__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
   __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1067, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1067, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_6);
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1067, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 1067, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1067, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_GIVEREF(__pyx_t_7);
+  __pyx_cur_scope->__pyx_v_retm = __pyx_t_7;
+  __pyx_t_7 = 0;
 
-  /* "statmoments/_native.pyx":986
+  /* "statmoments/_native.pyx":1069
+ *     retm = np.empty((2, len(moments), tr_len), dtype=np.float64)
  * 
- *     avgs = []
- *     for mcss in self._stats:             # <<<<<<<<<<<<<<
- *       for mcs in mcss:
+ *     for ii, mcss in enumerate(self._stats):             # <<<<<<<<<<<<<<
+ *       for _i, mcs in enumerate(mcss):
  *         dd = mcs.GetOutputDataObject(1).GetBlock(1)
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_stats); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 986, __pyx_L1_error)
+  __Pyx_INCREF(__pyx_int_0);
+  __pyx_t_7 = __pyx_int_0;
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_stats); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1069, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
-    __pyx_t_4 = __pyx_t_2; __Pyx_INCREF(__pyx_t_4); __pyx_t_6 = 0;
-    __pyx_t_7 = NULL;
+    __pyx_t_3 = __pyx_t_2; __Pyx_INCREF(__pyx_t_3); __pyx_t_5 = 0;
+    __pyx_t_8 = NULL;
   } else {
-    __pyx_t_6 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 986, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_7 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 986, __pyx_L1_error)
+    __pyx_t_5 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1069, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_8 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1069, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   for (;;) {
-    if (likely(!__pyx_t_7)) {
-      if (likely(PyList_CheckExact(__pyx_t_4))) {
-        if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_4)) break;
+    if (likely(!__pyx_t_8)) {
+      if (likely(PyList_CheckExact(__pyx_t_3))) {
+        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_6); __Pyx_INCREF(__pyx_t_2); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 986, __pyx_L1_error)
+        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1069, __pyx_L1_error)
         #else
-        __pyx_t_2 = PySequence_ITEM(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 986, __pyx_L1_error)
+        __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1069, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         #endif
       } else {
-        if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
+        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_6); __Pyx_INCREF(__pyx_t_2); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 986, __pyx_L1_error)
+        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1069, __pyx_L1_error)
         #else
-        __pyx_t_2 = PySequence_ITEM(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 986, __pyx_L1_error)
+        __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1069, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         #endif
       }
     } else {
-      __pyx_t_2 = __pyx_t_7(__pyx_t_4);
+      __pyx_t_2 = __pyx_t_8(__pyx_t_3);
       if (unlikely(!__pyx_t_2)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 986, __pyx_L1_error)
+          else __PYX_ERR(0, 1069, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_2);
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_mcss);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_mcss, __pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_2);
     __pyx_t_2 = 0;
+    __Pyx_INCREF(__pyx_t_7);
+    __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_ii);
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_ii, __pyx_t_7);
+    __Pyx_GIVEREF(__pyx_t_7);
+    __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_t_7, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1069, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_7);
+    __pyx_t_7 = __pyx_t_2;
+    __pyx_t_2 = 0;
 
-    /* "statmoments/_native.pyx":987
- *     avgs = []
- *     for mcss in self._stats:
- *       for mcs in mcss:             # <<<<<<<<<<<<<<
+    /* "statmoments/_native.pyx":1070
+ * 
+ *     for ii, mcss in enumerate(self._stats):
+ *       for _i, mcs in enumerate(mcss):             # <<<<<<<<<<<<<<
  *         dd = mcs.GetOutputDataObject(1).GetBlock(1)
- *         n = dd.GetNumberOfRows()-1
+ *         n, cm = dd.GetNumberOfRows() - 1, retm[_i]
  */
+    __Pyx_INCREF(__pyx_int_0);
+    __pyx_t_2 = __pyx_int_0;
     if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_v_mcss)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_mcss)) {
-      __pyx_t_2 = __pyx_cur_scope->__pyx_v_mcss; __Pyx_INCREF(__pyx_t_2); __pyx_t_8 = 0;
-      __pyx_t_9 = NULL;
+      __pyx_t_1 = __pyx_cur_scope->__pyx_v_mcss; __Pyx_INCREF(__pyx_t_1); __pyx_t_9 = 0;
+      __pyx_t_10 = NULL;
     } else {
-      __pyx_t_8 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_mcss); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 987, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_9 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 987, __pyx_L1_error)
+      __pyx_t_9 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_mcss); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1070, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_10 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1070, __pyx_L1_error)
     }
     for (;;) {
-      if (likely(!__pyx_t_9)) {
-        if (likely(PyList_CheckExact(__pyx_t_2))) {
-          if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_2)) break;
+      if (likely(!__pyx_t_10)) {
+        if (likely(PyList_CheckExact(__pyx_t_1))) {
+          if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_8); __Pyx_INCREF(__pyx_t_1); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 987, __pyx_L1_error)
+          __pyx_t_6 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_9); __Pyx_INCREF(__pyx_t_6); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 1070, __pyx_L1_error)
           #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 987, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_1);
+          __pyx_t_6 = PySequence_ITEM(__pyx_t_1, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1070, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_6);
           #endif
         } else {
-          if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
+          if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_8); __Pyx_INCREF(__pyx_t_1); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 987, __pyx_L1_error)
+          __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_9); __Pyx_INCREF(__pyx_t_6); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 1070, __pyx_L1_error)
           #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 987, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_1);
+          __pyx_t_6 = PySequence_ITEM(__pyx_t_1, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1070, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_6);
           #endif
         }
       } else {
-        __pyx_t_1 = __pyx_t_9(__pyx_t_2);
-        if (unlikely(!__pyx_t_1)) {
+        __pyx_t_6 = __pyx_t_10(__pyx_t_1);
+        if (unlikely(!__pyx_t_6)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 987, __pyx_L1_error)
+            else __PYX_ERR(0, 1070, __pyx_L1_error)
           }
           break;
         }
-        __Pyx_GOTREF(__pyx_t_1);
+        __Pyx_GOTREF(__pyx_t_6);
       }
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_mcs);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_mcs, __pyx_t_1);
-      __Pyx_GIVEREF(__pyx_t_1);
-      __pyx_t_1 = 0;
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_mcs, __pyx_t_6);
+      __Pyx_GIVEREF(__pyx_t_6);
+      __pyx_t_6 = 0;
+      __Pyx_INCREF(__pyx_t_2);
+      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v__i);
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v__i, __pyx_t_2);
+      __Pyx_GIVEREF(__pyx_t_2);
+      __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1070, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      __Pyx_DECREF(__pyx_t_2);
+      __pyx_t_2 = __pyx_t_6;
+      __pyx_t_6 = 0;
 
-      /* "statmoments/_native.pyx":988
- *     for mcss in self._stats:
- *       for mcs in mcss:
+      /* "statmoments/_native.pyx":1071
+ *     for ii, mcss in enumerate(self._stats):
+ *       for _i, mcs in enumerate(mcss):
  *         dd = mcs.GetOutputDataObject(1).GetBlock(1)             # <<<<<<<<<<<<<<
- *         n = dd.GetNumberOfRows()-1
- *         avg = vtk2np(dd.GetColumn(1))[:n]
+ *         n, cm = dd.GetNumberOfRows() - 1, retm[_i]
+ *         nn = vtk2np(dd.GetColumn(1))[n]
  */
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_mcs, __pyx_n_s_GetOutputDataObject); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 988, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
+      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_mcs, __pyx_n_s_GetOutputDataObject); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1071, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_12);
+      __pyx_t_13 = NULL;
+      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_12))) {
+        __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_12);
+        if (likely(__pyx_t_13)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_12);
+          __Pyx_INCREF(__pyx_t_13);
+          __Pyx_INCREF(function);
+          __Pyx_DECREF_SET(__pyx_t_12, function);
+        }
+      }
+      __pyx_t_11 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_12, __pyx_t_13, __pyx_int_1) : __Pyx_PyObject_CallOneArg(__pyx_t_12, __pyx_int_1);
+      __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
+      if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1071, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
+      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_GetBlock); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1071, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_12);
+      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __pyx_t_11 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
-        __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_10);
+      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_12))) {
+        __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_12);
         if (likely(__pyx_t_11)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_12);
           __Pyx_INCREF(__pyx_t_11);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_10, function);
+          __Pyx_DECREF_SET(__pyx_t_12, function);
         }
       }
-      __pyx_t_3 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_11, __pyx_int_1) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_int_1);
+      __pyx_t_6 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_12, __pyx_t_11, __pyx_int_1) : __Pyx_PyObject_CallOneArg(__pyx_t_12, __pyx_int_1);
       __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 988, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_GetBlock); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 988, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
-        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_10);
-        if (likely(__pyx_t_3)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
-          __Pyx_INCREF(__pyx_t_3);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_10, function);
-        }
-      }
-      __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_3, __pyx_int_1) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_int_1);
-      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 988, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1071, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_dd);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_dd, __pyx_t_1);
-      __Pyx_GIVEREF(__pyx_t_1);
-      __pyx_t_1 = 0;
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_dd, __pyx_t_6);
+      __Pyx_GIVEREF(__pyx_t_6);
+      __pyx_t_6 = 0;
 
-      /* "statmoments/_native.pyx":989
- *       for mcs in mcss:
+      /* "statmoments/_native.pyx":1072
+ *       for _i, mcs in enumerate(mcss):
  *         dd = mcs.GetOutputDataObject(1).GetBlock(1)
- *         n = dd.GetNumberOfRows()-1             # <<<<<<<<<<<<<<
- *         avg = vtk2np(dd.GetColumn(1))[:n]
- *         avgs.append(avg)
+ *         n, cm = dd.GetNumberOfRows() - 1, retm[_i]             # <<<<<<<<<<<<<<
+ *         nn = vtk2np(dd.GetColumn(1))[n]
+ *         for jj, m in enumerate(moments):
  */
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_dd, __pyx_n_s_GetNumberOfRows); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 989, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_3 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
-        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_10);
-        if (likely(__pyx_t_3)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
-          __Pyx_INCREF(__pyx_t_3);
+      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_dd, __pyx_n_s_GetNumberOfRows); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1072, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_12);
+      __pyx_t_11 = NULL;
+      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_12))) {
+        __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_12);
+        if (likely(__pyx_t_11)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_12);
+          __Pyx_INCREF(__pyx_t_11);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_10, function);
+          __Pyx_DECREF_SET(__pyx_t_12, function);
         }
       }
-      __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_10);
-      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 989, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyInt_SubtractObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 989, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_t_6 = (__pyx_t_11) ? __Pyx_PyObject_CallOneArg(__pyx_t_12, __pyx_t_11) : __Pyx_PyObject_CallNoArg(__pyx_t_12);
+      __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
+      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1072, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+      __pyx_t_12 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1072, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_12);
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1072, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_n);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_n, __pyx_t_10);
-      __Pyx_GIVEREF(__pyx_t_10);
-      __pyx_t_10 = 0;
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_n, __pyx_t_12);
+      __Pyx_GIVEREF(__pyx_t_12);
+      __pyx_t_12 = 0;
+      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_cm);
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_cm, __pyx_t_6);
+      __Pyx_GIVEREF(__pyx_t_6);
+      __pyx_t_6 = 0;
 
-      /* "statmoments/_native.pyx":990
+      /* "statmoments/_native.pyx":1073
  *         dd = mcs.GetOutputDataObject(1).GetBlock(1)
- *         n = dd.GetNumberOfRows()-1
- *         avg = vtk2np(dd.GetColumn(1))[:n]             # <<<<<<<<<<<<<<
- *         avgs.append(avg)
- *     yield (avgs[0], avgs[0]), (avgs[1], avgs[1])
+ *         n, cm = dd.GetNumberOfRows() - 1, retm[_i]
+ *         nn = vtk2np(dd.GetColumn(1))[n]             # <<<<<<<<<<<<<<
+ *         for jj, m in enumerate(moments):
+ *           if m == 1:
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_vtk2np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 990, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_dd, __pyx_n_s_GetColumn); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 990, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __pyx_t_12 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
-        __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_11);
-        if (likely(__pyx_t_12)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
-          __Pyx_INCREF(__pyx_t_12);
+      __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_vtk2np); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1073, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_12);
+      __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_dd, __pyx_n_s_GetColumn); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1073, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_13);
+      __pyx_t_14 = NULL;
+      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_13))) {
+        __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_13);
+        if (likely(__pyx_t_14)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
+          __Pyx_INCREF(__pyx_t_14);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_11, function);
+          __Pyx_DECREF_SET(__pyx_t_13, function);
         }
       }
-      __pyx_t_3 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_12, __pyx_int_1) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_int_1);
-      __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 990, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_11 = NULL;
-      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
-        __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_1);
-        if (likely(__pyx_t_11)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
-          __Pyx_INCREF(__pyx_t_11);
+      __pyx_t_11 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_14, __pyx_int_1) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_int_1);
+      __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
+      if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1073, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
+      __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+      __pyx_t_13 = NULL;
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_12))) {
+        __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_12);
+        if (likely(__pyx_t_13)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_12);
+          __Pyx_INCREF(__pyx_t_13);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_1, function);
+          __Pyx_DECREF_SET(__pyx_t_12, function);
         }
       }
-      __pyx_t_10 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_11, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_3);
-      __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 990, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_t_10, 0, 0, NULL, &__pyx_cur_scope->__pyx_v_n, NULL, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 990, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_avg);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_avg, __pyx_t_1);
-      __Pyx_GIVEREF(__pyx_t_1);
-      __pyx_t_1 = 0;
+      __pyx_t_6 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_12, __pyx_t_13, __pyx_t_11) : __Pyx_PyObject_CallOneArg(__pyx_t_12, __pyx_t_11);
+      __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
+      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1073, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+      __pyx_t_12 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_cur_scope->__pyx_v_n); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1073, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_12);
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_nn);
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_nn, __pyx_t_12);
+      __Pyx_GIVEREF(__pyx_t_12);
+      __pyx_t_12 = 0;
+
+      /* "statmoments/_native.pyx":1074
+ *         n, cm = dd.GetNumberOfRows() - 1, retm[_i]
+ *         nn = vtk2np(dd.GetColumn(1))[n]
+ *         for jj, m in enumerate(moments):             # <<<<<<<<<<<<<<
+ *           if m == 1:
+ *             cm[:] = vtk2np(dd.GetColumn(1))[:n]
+ */
+      __Pyx_INCREF(__pyx_int_0);
+      __pyx_t_12 = __pyx_int_0;
+      if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_v_moments)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_moments)) {
+        __pyx_t_6 = __pyx_cur_scope->__pyx_v_moments; __Pyx_INCREF(__pyx_t_6); __pyx_t_15 = 0;
+        __pyx_t_16 = NULL;
+      } else {
+        __pyx_t_15 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1074, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_6);
+        __pyx_t_16 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1074, __pyx_L1_error)
+      }
+      for (;;) {
+        if (likely(!__pyx_t_16)) {
+          if (likely(PyList_CheckExact(__pyx_t_6))) {
+            if (__pyx_t_15 >= PyList_GET_SIZE(__pyx_t_6)) break;
+            #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+            __pyx_t_11 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_15); __Pyx_INCREF(__pyx_t_11); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 1074, __pyx_L1_error)
+            #else
+            __pyx_t_11 = PySequence_ITEM(__pyx_t_6, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1074, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_11);
+            #endif
+          } else {
+            if (__pyx_t_15 >= PyTuple_GET_SIZE(__pyx_t_6)) break;
+            #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+            __pyx_t_11 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_15); __Pyx_INCREF(__pyx_t_11); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 1074, __pyx_L1_error)
+            #else
+            __pyx_t_11 = PySequence_ITEM(__pyx_t_6, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1074, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_11);
+            #endif
+          }
+        } else {
+          __pyx_t_11 = __pyx_t_16(__pyx_t_6);
+          if (unlikely(!__pyx_t_11)) {
+            PyObject* exc_type = PyErr_Occurred();
+            if (exc_type) {
+              if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
+              else __PYX_ERR(0, 1074, __pyx_L1_error)
+            }
+            break;
+          }
+          __Pyx_GOTREF(__pyx_t_11);
+        }
+        __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_m);
+        __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_m, __pyx_t_11);
+        __Pyx_GIVEREF(__pyx_t_11);
+        __pyx_t_11 = 0;
+        __Pyx_INCREF(__pyx_t_12);
+        __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_jj);
+        __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_jj, __pyx_t_12);
+        __Pyx_GIVEREF(__pyx_t_12);
+        __pyx_t_11 = __Pyx_PyInt_AddObjC(__pyx_t_12, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1074, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_11);
+        __Pyx_DECREF(__pyx_t_12);
+        __pyx_t_12 = __pyx_t_11;
+        __pyx_t_11 = 0;
+
+        /* "statmoments/_native.pyx":1075
+ *         nn = vtk2np(dd.GetColumn(1))[n]
+ *         for jj, m in enumerate(moments):
+ *           if m == 1:             # <<<<<<<<<<<<<<
+ *             cm[:] = vtk2np(dd.GetColumn(1))[:n]
+ *           else: # VTK cannot find moments higher
+ */
+        __pyx_t_11 = __Pyx_PyInt_EqObjC(__pyx_cur_scope->__pyx_v_m, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1075, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_11);
+        __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_11); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1075, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+        if (__pyx_t_4) {
+
+          /* "statmoments/_native.pyx":1076
+ *         for jj, m in enumerate(moments):
+ *           if m == 1:
+ *             cm[:] = vtk2np(dd.GetColumn(1))[:n]             # <<<<<<<<<<<<<<
+ *           else: # VTK cannot find moments higher
+ *             for k in range(n):
+ */
+          __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_vtk2np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1076, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_13);
+          __pyx_t_17 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_dd, __pyx_n_s_GetColumn); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1076, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_17);
+          __pyx_t_18 = NULL;
+          if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_17))) {
+            __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_17);
+            if (likely(__pyx_t_18)) {
+              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_17);
+              __Pyx_INCREF(__pyx_t_18);
+              __Pyx_INCREF(function);
+              __Pyx_DECREF_SET(__pyx_t_17, function);
+            }
+          }
+          __pyx_t_14 = (__pyx_t_18) ? __Pyx_PyObject_Call2Args(__pyx_t_17, __pyx_t_18, __pyx_int_1) : __Pyx_PyObject_CallOneArg(__pyx_t_17, __pyx_int_1);
+          __Pyx_XDECREF(__pyx_t_18); __pyx_t_18 = 0;
+          if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1076, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_14);
+          __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
+          __pyx_t_17 = NULL;
+          if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
+            __pyx_t_17 = PyMethod_GET_SELF(__pyx_t_13);
+            if (likely(__pyx_t_17)) {
+              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
+              __Pyx_INCREF(__pyx_t_17);
+              __Pyx_INCREF(function);
+              __Pyx_DECREF_SET(__pyx_t_13, function);
+            }
+          }
+          __pyx_t_11 = (__pyx_t_17) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_17, __pyx_t_14) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_14);
+          __Pyx_XDECREF(__pyx_t_17); __pyx_t_17 = 0;
+          __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
+          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1076, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_11);
+          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+          __pyx_t_13 = __Pyx_PyObject_GetSlice(__pyx_t_11, 0, 0, NULL, &__pyx_cur_scope->__pyx_v_n, NULL, 0, 0, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1076, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_13);
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          if (__Pyx_PyObject_SetSlice(__pyx_cur_scope->__pyx_v_cm, __pyx_t_13, 0, 0, NULL, NULL, &__pyx_slice__7, 0, 0, 0) < 0) __PYX_ERR(0, 1076, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+
+          /* "statmoments/_native.pyx":1075
+ *         nn = vtk2np(dd.GetColumn(1))[n]
+ *         for jj, m in enumerate(moments):
+ *           if m == 1:             # <<<<<<<<<<<<<<
+ *             cm[:] = vtk2np(dd.GetColumn(1))[:n]
+ *           else: # VTK cannot find moments higher
+ */
+          goto __pyx_L12;
+        }
+
+        /* "statmoments/_native.pyx":1078
+ *             cm[:] = vtk2np(dd.GetColumn(1))[:n]
+ *           else: # VTK cannot find moments higher
+ *             for k in range(n):             # <<<<<<<<<<<<<<
+ *               cm[jj, k] = vtk2np(dd.GetColumn(k + 2))[k]
+ *             # Restore to ddof=0 to ensure correctness
+ */
+        /*else*/ {
+          __pyx_t_13 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_cur_scope->__pyx_v_n); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1078, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_13);
+          if (likely(PyList_CheckExact(__pyx_t_13)) || PyTuple_CheckExact(__pyx_t_13)) {
+            __pyx_t_11 = __pyx_t_13; __Pyx_INCREF(__pyx_t_11); __pyx_t_19 = 0;
+            __pyx_t_20 = NULL;
+          } else {
+            __pyx_t_19 = -1; __pyx_t_11 = PyObject_GetIter(__pyx_t_13); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1078, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_11);
+            __pyx_t_20 = Py_TYPE(__pyx_t_11)->tp_iternext; if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1078, __pyx_L1_error)
+          }
+          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+          for (;;) {
+            if (likely(!__pyx_t_20)) {
+              if (likely(PyList_CheckExact(__pyx_t_11))) {
+                if (__pyx_t_19 >= PyList_GET_SIZE(__pyx_t_11)) break;
+                #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+                __pyx_t_13 = PyList_GET_ITEM(__pyx_t_11, __pyx_t_19); __Pyx_INCREF(__pyx_t_13); __pyx_t_19++; if (unlikely(0 < 0)) __PYX_ERR(0, 1078, __pyx_L1_error)
+                #else
+                __pyx_t_13 = PySequence_ITEM(__pyx_t_11, __pyx_t_19); __pyx_t_19++; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1078, __pyx_L1_error)
+                __Pyx_GOTREF(__pyx_t_13);
+                #endif
+              } else {
+                if (__pyx_t_19 >= PyTuple_GET_SIZE(__pyx_t_11)) break;
+                #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+                __pyx_t_13 = PyTuple_GET_ITEM(__pyx_t_11, __pyx_t_19); __Pyx_INCREF(__pyx_t_13); __pyx_t_19++; if (unlikely(0 < 0)) __PYX_ERR(0, 1078, __pyx_L1_error)
+                #else
+                __pyx_t_13 = PySequence_ITEM(__pyx_t_11, __pyx_t_19); __pyx_t_19++; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1078, __pyx_L1_error)
+                __Pyx_GOTREF(__pyx_t_13);
+                #endif
+              }
+            } else {
+              __pyx_t_13 = __pyx_t_20(__pyx_t_11);
+              if (unlikely(!__pyx_t_13)) {
+                PyObject* exc_type = PyErr_Occurred();
+                if (exc_type) {
+                  if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
+                  else __PYX_ERR(0, 1078, __pyx_L1_error)
+                }
+                break;
+              }
+              __Pyx_GOTREF(__pyx_t_13);
+            }
+            __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_k);
+            __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_k, __pyx_t_13);
+            __Pyx_GIVEREF(__pyx_t_13);
+            __pyx_t_13 = 0;
+
+            /* "statmoments/_native.pyx":1079
+ *           else: # VTK cannot find moments higher
+ *             for k in range(n):
+ *               cm[jj, k] = vtk2np(dd.GetColumn(k + 2))[k]             # <<<<<<<<<<<<<<
+ *             # Restore to ddof=0 to ensure correctness
+ *             cm[jj, :] *= (nn - 1.0) / nn
+ */
+            __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_vtk2np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1079, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_14);
+            __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_dd, __pyx_n_s_GetColumn); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1079, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_18);
+            __pyx_t_21 = __Pyx_PyInt_AddObjC(__pyx_cur_scope->__pyx_v_k, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1079, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_21);
+            __pyx_t_22 = NULL;
+            if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_18))) {
+              __pyx_t_22 = PyMethod_GET_SELF(__pyx_t_18);
+              if (likely(__pyx_t_22)) {
+                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_18);
+                __Pyx_INCREF(__pyx_t_22);
+                __Pyx_INCREF(function);
+                __Pyx_DECREF_SET(__pyx_t_18, function);
+              }
+            }
+            __pyx_t_17 = (__pyx_t_22) ? __Pyx_PyObject_Call2Args(__pyx_t_18, __pyx_t_22, __pyx_t_21) : __Pyx_PyObject_CallOneArg(__pyx_t_18, __pyx_t_21);
+            __Pyx_XDECREF(__pyx_t_22); __pyx_t_22 = 0;
+            __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
+            if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1079, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_17);
+            __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
+            __pyx_t_18 = NULL;
+            if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_14))) {
+              __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_14);
+              if (likely(__pyx_t_18)) {
+                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
+                __Pyx_INCREF(__pyx_t_18);
+                __Pyx_INCREF(function);
+                __Pyx_DECREF_SET(__pyx_t_14, function);
+              }
+            }
+            __pyx_t_13 = (__pyx_t_18) ? __Pyx_PyObject_Call2Args(__pyx_t_14, __pyx_t_18, __pyx_t_17) : __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_t_17);
+            __Pyx_XDECREF(__pyx_t_18); __pyx_t_18 = 0;
+            __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
+            if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1079, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_13);
+            __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
+            __pyx_t_14 = __Pyx_PyObject_GetItem(__pyx_t_13, __pyx_cur_scope->__pyx_v_k); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1079, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_14);
+            __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+            __pyx_t_13 = PyTuple_New(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1079, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_13);
+            __Pyx_INCREF(__pyx_cur_scope->__pyx_v_jj);
+            __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_jj);
+            PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_cur_scope->__pyx_v_jj);
+            __Pyx_INCREF(__pyx_cur_scope->__pyx_v_k);
+            __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_k);
+            PyTuple_SET_ITEM(__pyx_t_13, 1, __pyx_cur_scope->__pyx_v_k);
+            if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_13, __pyx_t_14) < 0)) __PYX_ERR(0, 1079, __pyx_L1_error)
+            __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+            __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
+
+            /* "statmoments/_native.pyx":1078
+ *             cm[:] = vtk2np(dd.GetColumn(1))[:n]
+ *           else: # VTK cannot find moments higher
+ *             for k in range(n):             # <<<<<<<<<<<<<<
+ *               cm[jj, k] = vtk2np(dd.GetColumn(k + 2))[k]
+ *             # Restore to ddof=0 to ensure correctness
+ */
+          }
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-      /* "statmoments/_native.pyx":991
- *         n = dd.GetNumberOfRows()-1
- *         avg = vtk2np(dd.GetColumn(1))[:n]
- *         avgs.append(avg)             # <<<<<<<<<<<<<<
- *     yield (avgs[0], avgs[0]), (avgs[1], avgs[1])
+          /* "statmoments/_native.pyx":1081
+ *               cm[jj, k] = vtk2np(dd.GetColumn(k + 2))[k]
+ *             # Restore to ddof=0 to ensure correctness
+ *             cm[jj, :] *= (nn - 1.0) / nn             # <<<<<<<<<<<<<<
  * 
+ *     yield retm[:, :len(moments)]
+ */
+          __pyx_t_11 = PyTuple_New(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1081, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_11);
+          __Pyx_INCREF(__pyx_cur_scope->__pyx_v_jj);
+          __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_jj);
+          PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_cur_scope->__pyx_v_jj);
+          __Pyx_INCREF(__pyx_slice__7);
+          __Pyx_GIVEREF(__pyx_slice__7);
+          PyTuple_SET_ITEM(__pyx_t_11, 1, __pyx_slice__7);
+          __pyx_t_14 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_11); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1081, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_14);
+          __pyx_t_13 = __Pyx_PyFloat_SubtractObjC(__pyx_cur_scope->__pyx_v_nn, __pyx_float_1_0, 1.0, 0, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1081, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_13);
+          __pyx_t_17 = __Pyx_PyNumber_Divide(__pyx_t_13, __pyx_cur_scope->__pyx_v_nn); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1081, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_17);
+          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+          __pyx_t_13 = PyNumber_InPlaceMultiply(__pyx_t_14, __pyx_t_17); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1081, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_13);
+          __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
+          __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
+          if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_11, __pyx_t_13) < 0)) __PYX_ERR(0, 1081, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+        }
+        __pyx_L12:;
+
+        /* "statmoments/_native.pyx":1074
+ *         n, cm = dd.GetNumberOfRows() - 1, retm[_i]
+ *         nn = vtk2np(dd.GetColumn(1))[n]
+ *         for jj, m in enumerate(moments):             # <<<<<<<<<<<<<<
+ *           if m == 1:
+ *             cm[:] = vtk2np(dd.GetColumn(1))[:n]
  */
-      __pyx_t_13 = __Pyx_PyList_Append(__pyx_cur_scope->__pyx_v_avgs, __pyx_cur_scope->__pyx_v_avg); if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 991, __pyx_L1_error)
+      }
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-      /* "statmoments/_native.pyx":987
- *     avgs = []
- *     for mcss in self._stats:
- *       for mcs in mcss:             # <<<<<<<<<<<<<<
+      /* "statmoments/_native.pyx":1070
+ * 
+ *     for ii, mcss in enumerate(self._stats):
+ *       for _i, mcs in enumerate(mcss):             # <<<<<<<<<<<<<<
  *         dd = mcs.GetOutputDataObject(1).GetBlock(1)
- *         n = dd.GetNumberOfRows()-1
+ *         n, cm = dd.GetNumberOfRows() - 1, retm[_i]
  */
     }
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "statmoments/_native.pyx":986
+    /* "statmoments/_native.pyx":1069
+ *     retm = np.empty((2, len(moments), tr_len), dtype=np.float64)
  * 
- *     avgs = []
- *     for mcss in self._stats:             # <<<<<<<<<<<<<<
- *       for mcs in mcss:
+ *     for ii, mcss in enumerate(self._stats):             # <<<<<<<<<<<<<<
+ *       for _i, mcs in enumerate(mcss):
  *         dd = mcs.GetOutputDataObject(1).GetBlock(1)
  */
   }
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "statmoments/_native.pyx":992
- *         avg = vtk2np(dd.GetColumn(1))[:n]
- *         avgs.append(avg)
- *     yield (avgs[0], avgs[0]), (avgs[1], avgs[1])             # <<<<<<<<<<<<<<
+  /* "statmoments/_native.pyx":1083
+ *             cm[jj, :] *= (nn - 1.0) / nn
  * 
- *   def _comoments(self, moments, normalize):
+ *     yield retm[:, :len(moments)]             # <<<<<<<<<<<<<<
+ * 
+ *   def comoments(self, moments, normalize):
  */
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 992, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_INCREF(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_avgs, 0));
-  __Pyx_GIVEREF(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_avgs, 0));
-  PyTuple_SET_ITEM(__pyx_t_4, 0, PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_avgs, 0));
-  __Pyx_INCREF(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_avgs, 0));
-  __Pyx_GIVEREF(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_avgs, 0));
-  PyTuple_SET_ITEM(__pyx_t_4, 1, PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_avgs, 0));
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 992, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_INCREF(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_avgs, 1));
-  __Pyx_GIVEREF(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_avgs, 1));
-  PyTuple_SET_ITEM(__pyx_t_2, 0, PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_avgs, 1));
-  __Pyx_INCREF(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_avgs, 1));
-  __Pyx_GIVEREF(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_avgs, 1));
-  PyTuple_SET_ITEM(__pyx_t_2, 1, PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_avgs, 1));
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 992, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GIVEREF(__pyx_t_4);
-  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
-  __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_2);
-  __pyx_t_4 = 0;
-  __pyx_t_2 = 0;
-  __pyx_r = __pyx_t_1;
-  __pyx_t_1 = 0;
+  __pyx_t_5 = PyObject_Length(__pyx_cur_scope->__pyx_v_moments); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1083, __pyx_L1_error)
+  __pyx_t_7 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1083, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __pyx_t_3 = PySlice_New(Py_None, __pyx_t_7, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1083, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1083, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_INCREF(__pyx_slice__7);
+  __Pyx_GIVEREF(__pyx_slice__7);
+  PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_slice__7);
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_3);
+  __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1083, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __pyx_r = __pyx_t_3;
+  __pyx_t_3 = 0;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
   /* return from generator, yielding value */
   __pyx_generator->resume_label = 1;
   return __pyx_r;
-  __pyx_L10_resume_from_yield:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 992, __pyx_L1_error)
+  __pyx_L15_resume_from_yield:;
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 1083, __pyx_L1_error)
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
-  /* "statmoments/_native.pyx":974
+  /* "statmoments/_native.pyx":1056
  *     return self._counts[i]
  * 
- *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
- *     m = moments[0]
- *     if self.moment < np.max(m):
+ *   def moments(self, moments, normalize):             # <<<<<<<<<<<<<<
+ *     maxm = np.max(moments)
+ *     if self.moment * 2 < maxm:
  */
 
   /* function exit code */
   PyErr_SetNone(PyExc_StopIteration);
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_10);
+  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_11);
   __Pyx_XDECREF(__pyx_t_12);
-  __Pyx_AddTraceback("_moments", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_XDECREF(__pyx_t_13);
+  __Pyx_XDECREF(__pyx_t_14);
+  __Pyx_XDECREF(__pyx_t_17);
+  __Pyx_XDECREF(__pyx_t_18);
+  __Pyx_XDECREF(__pyx_t_21);
+  __Pyx_XDECREF(__pyx_t_22);
+  __Pyx_AddTraceback("moments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_r); __pyx_r = 0;
   #if !CYTHON_USE_EXC_INFO_STACK
   __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static PyObject *__pyx_gb_11statmoments_7_native_9bivar_vtk_15generator9(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "statmoments/_native.pyx":994
- *     yield (avgs[0], avgs[0]), (avgs[1], avgs[1])
+/* "statmoments/_native.pyx":1085
+ *     yield retm[:, :len(moments)]
  * 
- *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
+ *   def comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     tr_len, min_cnt = self.trace_len, self.acc_min_count
  *     triuflatten = _triuflatten_gen(tr_len)
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11statmoments_7_native_9bivar_vtk_14_comoments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_11statmoments_7_native_9bivar_vtk_14_comoments = {"_comoments", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_9bivar_vtk_14_comoments, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11statmoments_7_native_9bivar_vtk_14_comoments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_11statmoments_7_native_9bivar_vtk_14comoments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_11statmoments_7_native_9bivar_vtk_14comoments = {"comoments", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_9bivar_vtk_14comoments, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11statmoments_7_native_9bivar_vtk_14comoments(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
-  CYTHON_UNUSED PyObject *__pyx_v_moments = 0;
+  PyObject *__pyx_v_moments = 0;
   CYTHON_UNUSED PyObject *__pyx_v_normalize = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("_comoments (wrapper)", 0);
+  __Pyx_RefNannySetupContext("comoments (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_moments,&__pyx_n_s_normalize,0};
     PyObject* values[3] = {0,0,0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
@@ -34233,814 +36181,923 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moments)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, 1); __PYX_ERR(0, 994, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("comoments", 1, 3, 3, 1); __PYX_ERR(0, 1085, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_normalize)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, 2); __PYX_ERR(0, 994, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("comoments", 1, 3, 3, 2); __PYX_ERR(0, 1085, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_comoments") < 0)) __PYX_ERR(0, 994, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "comoments") < 0)) __PYX_ERR(0, 1085, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_moments = values[1];
     __pyx_v_normalize = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_comoments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 994, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("comoments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1085, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("statmoments._native.bivar_vtk._comoments", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("statmoments._native.bivar_vtk.comoments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11statmoments_7_native_9bivar_vtk_13_comoments(__pyx_self, __pyx_v_self, __pyx_v_moments, __pyx_v_normalize);
+  __pyx_r = __pyx_pf_11statmoments_7_native_9bivar_vtk_13comoments(__pyx_self, __pyx_v_self, __pyx_v_moments, __pyx_v_normalize);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11statmoments_7_native_9bivar_vtk_13_comoments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_moments, CYTHON_UNUSED PyObject *__pyx_v_normalize) {
-  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18__comoments *__pyx_cur_scope;
+static PyObject *__pyx_pf_11statmoments_7_native_9bivar_vtk_13comoments(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_moments, CYTHON_UNUSED PyObject *__pyx_v_normalize) {
+  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18_comoments *__pyx_cur_scope;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("_comoments", 0);
-  __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18__comoments *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_18__comoments(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_18__comoments, __pyx_empty_tuple, NULL);
+  __Pyx_RefNannySetupContext("comoments", 0);
+  __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18_comoments *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_18_comoments(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_18_comoments, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
-    __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18__comoments *)Py_None);
+    __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18_comoments *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 994, __pyx_L1_error)
+    __PYX_ERR(0, 1085, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
   __pyx_cur_scope->__pyx_v_moments = __pyx_v_moments;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_moments);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_moments);
   __pyx_cur_scope->__pyx_v_normalize = __pyx_v_normalize;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_normalize);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_normalize);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_9bivar_vtk_15generator9, __pyx_codeobj__41, (PyObject *) __pyx_cur_scope, __pyx_n_s_comoments, __pyx_n_s_bivar_vtk__comoments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 994, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_9bivar_vtk_15generator9, __pyx_codeobj__40, (PyObject *) __pyx_cur_scope, __pyx_n_s_comoments_2, __pyx_n_s_bivar_vtk_comoments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 1085, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
-  __Pyx_AddTraceback("statmoments._native.bivar_vtk._comoments", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("statmoments._native.bivar_vtk.comoments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 static PyObject *__pyx_gb_11statmoments_7_native_9bivar_vtk_15generator9(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
 {
-  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18__comoments *__pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18__comoments *)__pyx_generator->closure);
+  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18_comoments *__pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18_comoments *)__pyx_generator->closure);
   PyObject *__pyx_r = NULL;
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   Py_ssize_t __pyx_t_4;
   PyObject *(*__pyx_t_5)(PyObject *);
-  Py_ssize_t __pyx_t_6;
-  PyObject *(*__pyx_t_7)(PyObject *);
-  PyObject *__pyx_t_8 = NULL;
+  PyObject *__pyx_t_6 = NULL;
+  Py_ssize_t __pyx_t_7;
+  PyObject *(*__pyx_t_8)(PyObject *);
   PyObject *__pyx_t_9 = NULL;
   PyObject *__pyx_t_10 = NULL;
   PyObject *__pyx_t_11 = NULL;
-  Py_ssize_t __pyx_t_12;
-  PyObject *(*__pyx_t_13)(PyObject *);
-  PyObject *__pyx_t_14 = NULL;
-  PyObject *__pyx_t_15 = NULL;
-  int __pyx_t_16;
+  PyObject *__pyx_t_12 = NULL;
+  PyObject *__pyx_t_13 = NULL;
+  Py_ssize_t __pyx_t_14;
+  PyObject *(*__pyx_t_15)(PyObject *);
+  Py_ssize_t __pyx_t_16;
+  PyObject *(*__pyx_t_17)(PyObject *);
+  PyObject *__pyx_t_18 = NULL;
+  PyObject *__pyx_t_19 = NULL;
+  PyObject *__pyx_t_20 = NULL;
+  PyObject *__pyx_t_21 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("_comoments", 0);
+  __Pyx_RefNannySetupContext("comoments", 0);
   switch (__pyx_generator->resume_label) {
     case 0: goto __pyx_L3_first_run;
-    case 1: goto __pyx_L10_resume_from_yield;
+    case 1: goto __pyx_L12_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 994, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 1085, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":995
+  /* "statmoments/_native.pyx":1086
  * 
- *   def _comoments(self, moments, normalize):
+ *   def comoments(self, moments, normalize):
  *     tr_len, min_cnt = self.trace_len, self.acc_min_count             # <<<<<<<<<<<<<<
  *     triuflatten = _triuflatten_gen(tr_len)
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 995, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1086, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_acc_min_count); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 995, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_acc_min_count); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1086, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v_tr_len = __pyx_t_1;
   __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_cur_scope->__pyx_v_min_cnt = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":996
- *   def _comoments(self, moments, normalize):
+  /* "statmoments/_native.pyx":1087
+ *   def comoments(self, moments, normalize):
  *     tr_len, min_cnt = self.trace_len, self.acc_min_count
  *     triuflatten = _triuflatten_gen(tr_len)             # <<<<<<<<<<<<<<
  * 
- *     covs = []
+ *     for ii, mcss in enumerate(self._stats):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_triuflatten_gen); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 996, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_triuflatten_gen); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1087, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_1, function);
     }
   }
   __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_3, __pyx_cur_scope->__pyx_v_tr_len) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_cur_scope->__pyx_v_tr_len);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 996, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1087, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_cur_scope->__pyx_v_triuflatten = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":998
+  /* "statmoments/_native.pyx":1089
  *     triuflatten = _triuflatten_gen(tr_len)
  * 
- *     covs = []             # <<<<<<<<<<<<<<
- *     for mcss in self._stats:
- *       for mcs in mcss:
- */
-  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 998, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_cur_scope->__pyx_v_covs = ((PyObject*)__pyx_t_2);
-  __pyx_t_2 = 0;
-
-  /* "statmoments/_native.pyx":999
- * 
- *     covs = []
- *     for mcss in self._stats:             # <<<<<<<<<<<<<<
- *       for mcs in mcss:
- *         dd = mcs.GetOutputDataObject(1).GetBlock(1)
+ *     for ii, mcss in enumerate(self._stats):             # <<<<<<<<<<<<<<
+ *       for _i, mcs in enumerate(mcss):
+ *         retm = self._retm[_i]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_stats); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 999, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
-    __pyx_t_1 = __pyx_t_2; __Pyx_INCREF(__pyx_t_1); __pyx_t_4 = 0;
+  __Pyx_INCREF(__pyx_int_0);
+  __pyx_t_2 = __pyx_int_0;
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_stats); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1089, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
+    __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
     __pyx_t_5 = NULL;
   } else {
-    __pyx_t_4 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 999, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 999, __pyx_L1_error)
+    __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1089, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1089, __pyx_L1_error)
   }
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_5)) {
-      if (likely(PyList_CheckExact(__pyx_t_1))) {
-        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_1)) break;
+      if (likely(PyList_CheckExact(__pyx_t_3))) {
+        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 999, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1089, __pyx_L1_error)
         #else
-        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 999, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1089, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
-        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
+        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 999, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1089, __pyx_L1_error)
         #else
-        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 999, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1089, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
-      __pyx_t_2 = __pyx_t_5(__pyx_t_1);
-      if (unlikely(!__pyx_t_2)) {
+      __pyx_t_1 = __pyx_t_5(__pyx_t_3);
+      if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 999, __pyx_L1_error)
+          else __PYX_ERR(0, 1089, __pyx_L1_error)
         }
         break;
       }
-      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_mcss);
-    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_mcss, __pyx_t_2);
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_mcss, __pyx_t_1);
+    __Pyx_GIVEREF(__pyx_t_1);
+    __pyx_t_1 = 0;
+    __Pyx_INCREF(__pyx_t_2);
+    __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_ii);
+    __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_ii, __pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_2);
-    __pyx_t_2 = 0;
+    __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1089, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2);
+    __pyx_t_2 = __pyx_t_1;
+    __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":1000
- *     covs = []
- *     for mcss in self._stats:
- *       for mcs in mcss:             # <<<<<<<<<<<<<<
+    /* "statmoments/_native.pyx":1090
+ * 
+ *     for ii, mcss in enumerate(self._stats):
+ *       for _i, mcs in enumerate(mcss):             # <<<<<<<<<<<<<<
+ *         retm = self._retm[_i]
  *         dd = mcs.GetOutputDataObject(1).GetBlock(1)
- *         n = dd.GetNumberOfRows()-1
  */
+    __Pyx_INCREF(__pyx_int_0);
+    __pyx_t_1 = __pyx_int_0;
     if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_v_mcss)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_mcss)) {
-      __pyx_t_2 = __pyx_cur_scope->__pyx_v_mcss; __Pyx_INCREF(__pyx_t_2); __pyx_t_6 = 0;
-      __pyx_t_7 = NULL;
+      __pyx_t_6 = __pyx_cur_scope->__pyx_v_mcss; __Pyx_INCREF(__pyx_t_6); __pyx_t_7 = 0;
+      __pyx_t_8 = NULL;
     } else {
-      __pyx_t_6 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_mcss); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1000, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_7 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1000, __pyx_L1_error)
+      __pyx_t_7 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_mcss); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1090, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      __pyx_t_8 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1090, __pyx_L1_error)
     }
     for (;;) {
-      if (likely(!__pyx_t_7)) {
-        if (likely(PyList_CheckExact(__pyx_t_2))) {
-          if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_2)) break;
+      if (likely(!__pyx_t_8)) {
+        if (likely(PyList_CheckExact(__pyx_t_6))) {
+          if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_6)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1000, __pyx_L1_error)
+          __pyx_t_9 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_7); __Pyx_INCREF(__pyx_t_9); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 1090, __pyx_L1_error)
           #else
-          __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1000, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
+          __pyx_t_9 = PySequence_ITEM(__pyx_t_6, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1090, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_9);
           #endif
         } else {
-          if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
+          if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_6)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1000, __pyx_L1_error)
+          __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_7); __Pyx_INCREF(__pyx_t_9); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 1090, __pyx_L1_error)
           #else
-          __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1000, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_3);
+          __pyx_t_9 = PySequence_ITEM(__pyx_t_6, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1090, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_9);
           #endif
         }
       } else {
-        __pyx_t_3 = __pyx_t_7(__pyx_t_2);
-        if (unlikely(!__pyx_t_3)) {
+        __pyx_t_9 = __pyx_t_8(__pyx_t_6);
+        if (unlikely(!__pyx_t_9)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 1000, __pyx_L1_error)
+            else __PYX_ERR(0, 1090, __pyx_L1_error)
           }
           break;
         }
-        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_GOTREF(__pyx_t_9);
       }
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_mcs);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_mcs, __pyx_t_3);
-      __Pyx_GIVEREF(__pyx_t_3);
-      __pyx_t_3 = 0;
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_mcs, __pyx_t_9);
+      __Pyx_GIVEREF(__pyx_t_9);
+      __pyx_t_9 = 0;
+      __Pyx_INCREF(__pyx_t_1);
+      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v__i);
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v__i, __pyx_t_1);
+      __Pyx_GIVEREF(__pyx_t_1);
+      __pyx_t_9 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1090, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_9);
+      __Pyx_DECREF(__pyx_t_1);
+      __pyx_t_1 = __pyx_t_9;
+      __pyx_t_9 = 0;
 
-      /* "statmoments/_native.pyx":1001
- *     for mcss in self._stats:
- *       for mcs in mcss:
- *         dd = mcs.GetOutputDataObject(1).GetBlock(1)             # <<<<<<<<<<<<<<
- *         n = dd.GetNumberOfRows()-1
- *         m = vtk2np(dd.GetColumn(1))[n]
+      /* "statmoments/_native.pyx":1091
+ *     for ii, mcss in enumerate(self._stats):
+ *       for _i, mcs in enumerate(mcss):
+ *         retm = self._retm[_i]             # <<<<<<<<<<<<<<
+ *         dd = mcs.GetOutputDataObject(1).GetBlock(1)
+ *         n = dd.GetNumberOfRows() - 1
  */
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_mcs, __pyx_n_s_GetOutputDataObject); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1001, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1091, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_10 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_9))) {
-        __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_9);
-        if (likely(__pyx_t_10)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
-          __Pyx_INCREF(__pyx_t_10);
+      __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_9, __pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1091, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_10);
+      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_retm);
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_retm, __pyx_t_10);
+      __Pyx_GIVEREF(__pyx_t_10);
+      __pyx_t_10 = 0;
+
+      /* "statmoments/_native.pyx":1092
+ *       for _i, mcs in enumerate(mcss):
+ *         retm = self._retm[_i]
+ *         dd = mcs.GetOutputDataObject(1).GetBlock(1)             # <<<<<<<<<<<<<<
+ *         n = dd.GetNumberOfRows() - 1
+ *         nn = vtk2np(dd.GetColumn(1))[n]
+ */
+      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_mcs, __pyx_n_s_GetOutputDataObject); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1092, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
+      __pyx_t_12 = NULL;
+      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
+        __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_11);
+        if (likely(__pyx_t_12)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
+          __Pyx_INCREF(__pyx_t_12);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_9, function);
+          __Pyx_DECREF_SET(__pyx_t_11, function);
         }
       }
-      __pyx_t_8 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_10, __pyx_int_1) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_int_1);
-      __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1001, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_8);
-      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_GetBlock); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1001, __pyx_L1_error)
+      __pyx_t_9 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_12, __pyx_int_1) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_int_1);
+      __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
+      if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1092, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_9))) {
-        __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_9);
-        if (likely(__pyx_t_8)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
-          __Pyx_INCREF(__pyx_t_8);
+      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_GetBlock); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1092, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
+      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+      __pyx_t_9 = NULL;
+      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
+        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_11);
+        if (likely(__pyx_t_9)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
+          __Pyx_INCREF(__pyx_t_9);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_9, function);
+          __Pyx_DECREF_SET(__pyx_t_11, function);
         }
       }
-      __pyx_t_3 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_8, __pyx_int_1) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_int_1);
-      __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1001, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+      __pyx_t_10 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_9, __pyx_int_1) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_int_1);
+      __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
+      if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1092, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_10);
+      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_dd);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_dd, __pyx_t_3);
-      __Pyx_GIVEREF(__pyx_t_3);
-      __pyx_t_3 = 0;
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_dd, __pyx_t_10);
+      __Pyx_GIVEREF(__pyx_t_10);
+      __pyx_t_10 = 0;
 
-      /* "statmoments/_native.pyx":1002
- *       for mcs in mcss:
+      /* "statmoments/_native.pyx":1093
+ *         retm = self._retm[_i]
  *         dd = mcs.GetOutputDataObject(1).GetBlock(1)
- *         n = dd.GetNumberOfRows()-1             # <<<<<<<<<<<<<<
- *         m = vtk2np(dd.GetColumn(1))[n]
+ *         n = dd.GetNumberOfRows() - 1             # <<<<<<<<<<<<<<
+ *         nn = vtk2np(dd.GetColumn(1))[n]
  *         cov_arr = np.empty((n, n))
  */
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_dd, __pyx_n_s_GetNumberOfRows); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1002, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_8 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_9))) {
-        __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_9);
-        if (likely(__pyx_t_8)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
-          __Pyx_INCREF(__pyx_t_8);
+      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_dd, __pyx_n_s_GetNumberOfRows); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1093, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
+      __pyx_t_9 = NULL;
+      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
+        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_11);
+        if (likely(__pyx_t_9)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
+          __Pyx_INCREF(__pyx_t_9);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_9, function);
+          __Pyx_DECREF_SET(__pyx_t_11, function);
         }
       }
-      __pyx_t_3 = (__pyx_t_8) ? __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_8) : __Pyx_PyObject_CallNoArg(__pyx_t_9);
-      __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1002, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = __Pyx_PyInt_SubtractObjC(__pyx_t_3, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1002, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_9);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_10 = (__pyx_t_9) ? __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_9) : __Pyx_PyObject_CallNoArg(__pyx_t_11);
+      __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
+      if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1093, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_10);
+      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      __pyx_t_11 = __Pyx_PyInt_SubtractObjC(__pyx_t_10, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1093, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_n);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_n, __pyx_t_9);
-      __Pyx_GIVEREF(__pyx_t_9);
-      __pyx_t_9 = 0;
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_n, __pyx_t_11);
+      __Pyx_GIVEREF(__pyx_t_11);
+      __pyx_t_11 = 0;
 
-      /* "statmoments/_native.pyx":1003
+      /* "statmoments/_native.pyx":1094
  *         dd = mcs.GetOutputDataObject(1).GetBlock(1)
- *         n = dd.GetNumberOfRows()-1
- *         m = vtk2np(dd.GetColumn(1))[n]             # <<<<<<<<<<<<<<
+ *         n = dd.GetNumberOfRows() - 1
+ *         nn = vtk2np(dd.GetColumn(1))[n]             # <<<<<<<<<<<<<<
  *         cov_arr = np.empty((n, n))
- *         for k in range(n):
+ *         # VTK cannot find co-moments higher than covariance
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_vtk2np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1003, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_dd, __pyx_n_s_GetColumn); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1003, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_vtk2np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1094, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_11 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
-        __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_10);
-        if (likely(__pyx_t_11)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
-          __Pyx_INCREF(__pyx_t_11);
+      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_dd, __pyx_n_s_GetColumn); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1094, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_12);
+      __pyx_t_13 = NULL;
+      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_12))) {
+        __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_12);
+        if (likely(__pyx_t_13)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_12);
+          __Pyx_INCREF(__pyx_t_13);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_10, function);
+          __Pyx_DECREF_SET(__pyx_t_12, function);
         }
       }
-      __pyx_t_8 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_11, __pyx_int_1) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_int_1);
-      __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
-      if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1003, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_8);
-      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = NULL;
-      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
-        __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_3);
-        if (likely(__pyx_t_10)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-          __Pyx_INCREF(__pyx_t_10);
+      __pyx_t_9 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_12, __pyx_t_13, __pyx_int_1) : __Pyx_PyObject_CallOneArg(__pyx_t_12, __pyx_int_1);
+      __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
+      if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1094, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_9);
+      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+      __pyx_t_12 = NULL;
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
+        __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_10);
+        if (likely(__pyx_t_12)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
+          __Pyx_INCREF(__pyx_t_12);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_3, function);
+          __Pyx_DECREF_SET(__pyx_t_10, function);
         }
       }
-      __pyx_t_9 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_10, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_8);
-      __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1003, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_9);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_9, __pyx_cur_scope->__pyx_v_n); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1003, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_11 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_12, __pyx_t_9) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_9);
+      __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_m);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_m, __pyx_t_3);
-      __Pyx_GIVEREF(__pyx_t_3);
-      __pyx_t_3 = 0;
+      if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1094, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+      __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_11, __pyx_cur_scope->__pyx_v_n); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1094, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_10);
+      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_nn);
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_nn, __pyx_t_10);
+      __Pyx_GIVEREF(__pyx_t_10);
+      __pyx_t_10 = 0;
 
-      /* "statmoments/_native.pyx":1004
- *         n = dd.GetNumberOfRows()-1
- *         m = vtk2np(dd.GetColumn(1))[n]
+      /* "statmoments/_native.pyx":1095
+ *         n = dd.GetNumberOfRows() - 1
+ *         nn = vtk2np(dd.GetColumn(1))[n]
  *         cov_arr = np.empty((n, n))             # <<<<<<<<<<<<<<
- *         for k in range(n):
- *           cov_arr[k, :] = vtk2np(dd.GetColumn(k+2))[:n]
+ *         # VTK cannot find co-moments higher than covariance
+ *         for jj, m in enumerate(moments):
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1004, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_empty); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1004, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_8);
-      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1004, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1095, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_empty); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1095, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
+      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      __pyx_t_11 = PyTuple_New(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1095, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
       __Pyx_INCREF(__pyx_cur_scope->__pyx_v_n);
       __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_n);
-      PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_cur_scope->__pyx_v_n);
+      PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_cur_scope->__pyx_v_n);
       __Pyx_INCREF(__pyx_cur_scope->__pyx_v_n);
       __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_n);
-      PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_cur_scope->__pyx_v_n);
-      __pyx_t_10 = NULL;
-      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
-        __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_8);
-        if (likely(__pyx_t_10)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
-          __Pyx_INCREF(__pyx_t_10);
+      PyTuple_SET_ITEM(__pyx_t_11, 1, __pyx_cur_scope->__pyx_v_n);
+      __pyx_t_12 = NULL;
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
+        __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_9);
+        if (likely(__pyx_t_12)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
+          __Pyx_INCREF(__pyx_t_12);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_8, function);
+          __Pyx_DECREF_SET(__pyx_t_9, function);
         }
       }
-      __pyx_t_3 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_10, __pyx_t_9) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_9);
-      __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+      __pyx_t_10 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_12, __pyx_t_11) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_11);
+      __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
+      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1095, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1004, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_cov_arr);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_cov_arr, __pyx_t_3);
-      __Pyx_GIVEREF(__pyx_t_3);
-      __pyx_t_3 = 0;
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_cov_arr, __pyx_t_10);
+      __Pyx_GIVEREF(__pyx_t_10);
+      __pyx_t_10 = 0;
 
-      /* "statmoments/_native.pyx":1005
- *         m = vtk2np(dd.GetColumn(1))[n]
+      /* "statmoments/_native.pyx":1097
  *         cov_arr = np.empty((n, n))
- *         for k in range(n):             # <<<<<<<<<<<<<<
- *           cov_arr[k, :] = vtk2np(dd.GetColumn(k+2))[:n]
- *         # Restore to ddof=0 to ensure correctness
+ *         # VTK cannot find co-moments higher than covariance
+ *         for jj, m in enumerate(moments):             # <<<<<<<<<<<<<<
+ *           for k in range(n):
+ *             cov_arr[k, :] = vtk2np(dd.GetColumn(k + 2))[:n]
  */
-      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_cur_scope->__pyx_v_n); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1005, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
-        __pyx_t_8 = __pyx_t_3; __Pyx_INCREF(__pyx_t_8); __pyx_t_12 = 0;
-        __pyx_t_13 = NULL;
+      __Pyx_INCREF(__pyx_int_0);
+      __pyx_t_10 = __pyx_int_0;
+      if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_v_moments)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_moments)) {
+        __pyx_t_9 = __pyx_cur_scope->__pyx_v_moments; __Pyx_INCREF(__pyx_t_9); __pyx_t_14 = 0;
+        __pyx_t_15 = NULL;
       } else {
-        __pyx_t_12 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1005, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_13 = Py_TYPE(__pyx_t_8)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1005, __pyx_L1_error)
+        __pyx_t_14 = -1; __pyx_t_9 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1097, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_9);
+        __pyx_t_15 = Py_TYPE(__pyx_t_9)->tp_iternext; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1097, __pyx_L1_error)
       }
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       for (;;) {
-        if (likely(!__pyx_t_13)) {
-          if (likely(PyList_CheckExact(__pyx_t_8))) {
-            if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_8)) break;
+        if (likely(!__pyx_t_15)) {
+          if (likely(PyList_CheckExact(__pyx_t_9))) {
+            if (__pyx_t_14 >= PyList_GET_SIZE(__pyx_t_9)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_3 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_12); __Pyx_INCREF(__pyx_t_3); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1005, __pyx_L1_error)
+            __pyx_t_11 = PyList_GET_ITEM(__pyx_t_9, __pyx_t_14); __Pyx_INCREF(__pyx_t_11); __pyx_t_14++; if (unlikely(0 < 0)) __PYX_ERR(0, 1097, __pyx_L1_error)
             #else
-            __pyx_t_3 = PySequence_ITEM(__pyx_t_8, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1005, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_3);
+            __pyx_t_11 = PySequence_ITEM(__pyx_t_9, __pyx_t_14); __pyx_t_14++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1097, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_11);
             #endif
           } else {
-            if (__pyx_t_12 >= PyTuple_GET_SIZE(__pyx_t_8)) break;
+            if (__pyx_t_14 >= PyTuple_GET_SIZE(__pyx_t_9)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_12); __Pyx_INCREF(__pyx_t_3); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1005, __pyx_L1_error)
+            __pyx_t_11 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_14); __Pyx_INCREF(__pyx_t_11); __pyx_t_14++; if (unlikely(0 < 0)) __PYX_ERR(0, 1097, __pyx_L1_error)
             #else
-            __pyx_t_3 = PySequence_ITEM(__pyx_t_8, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1005, __pyx_L1_error)
-            __Pyx_GOTREF(__pyx_t_3);
+            __pyx_t_11 = PySequence_ITEM(__pyx_t_9, __pyx_t_14); __pyx_t_14++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1097, __pyx_L1_error)
+            __Pyx_GOTREF(__pyx_t_11);
             #endif
           }
         } else {
-          __pyx_t_3 = __pyx_t_13(__pyx_t_8);
-          if (unlikely(!__pyx_t_3)) {
+          __pyx_t_11 = __pyx_t_15(__pyx_t_9);
+          if (unlikely(!__pyx_t_11)) {
             PyObject* exc_type = PyErr_Occurred();
             if (exc_type) {
               if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-              else __PYX_ERR(0, 1005, __pyx_L1_error)
+              else __PYX_ERR(0, 1097, __pyx_L1_error)
             }
             break;
           }
-          __Pyx_GOTREF(__pyx_t_3);
+          __Pyx_GOTREF(__pyx_t_11);
         }
-        __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_k);
-        __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_k, __pyx_t_3);
-        __Pyx_GIVEREF(__pyx_t_3);
-        __pyx_t_3 = 0;
+        __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_m);
+        __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_m, __pyx_t_11);
+        __Pyx_GIVEREF(__pyx_t_11);
+        __pyx_t_11 = 0;
+        __Pyx_INCREF(__pyx_t_10);
+        __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_jj);
+        __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_jj, __pyx_t_10);
+        __Pyx_GIVEREF(__pyx_t_10);
+        __pyx_t_11 = __Pyx_PyInt_AddObjC(__pyx_t_10, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1097, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_11);
+        __Pyx_DECREF(__pyx_t_10);
+        __pyx_t_10 = __pyx_t_11;
+        __pyx_t_11 = 0;
 
-        /* "statmoments/_native.pyx":1006
- *         cov_arr = np.empty((n, n))
- *         for k in range(n):
- *           cov_arr[k, :] = vtk2np(dd.GetColumn(k+2))[:n]             # <<<<<<<<<<<<<<
- *         # Restore to ddof=0 to ensure correctness
- *         cov_arr *= (m-1.0) / m
+        /* "statmoments/_native.pyx":1098
+ *         # VTK cannot find co-moments higher than covariance
+ *         for jj, m in enumerate(moments):
+ *           for k in range(n):             # <<<<<<<<<<<<<<
+ *             cov_arr[k, :] = vtk2np(dd.GetColumn(k + 2))[:n]
+ *           # Restore to ddof=0 to ensure correctness
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_vtk2np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1006, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_9);
-        __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_dd, __pyx_n_s_GetColumn); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1006, __pyx_L1_error)
+        __pyx_t_11 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_cur_scope->__pyx_v_n); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1098, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_14 = __Pyx_PyInt_AddObjC(__pyx_cur_scope->__pyx_v_k, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1006, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_14);
-        __pyx_t_15 = NULL;
-        if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
-          __pyx_t_15 = PyMethod_GET_SELF(__pyx_t_11);
-          if (likely(__pyx_t_15)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
-            __Pyx_INCREF(__pyx_t_15);
-            __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_11, function);
-          }
+        if (likely(PyList_CheckExact(__pyx_t_11)) || PyTuple_CheckExact(__pyx_t_11)) {
+          __pyx_t_12 = __pyx_t_11; __Pyx_INCREF(__pyx_t_12); __pyx_t_16 = 0;
+          __pyx_t_17 = NULL;
+        } else {
+          __pyx_t_16 = -1; __pyx_t_12 = PyObject_GetIter(__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1098, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_12);
+          __pyx_t_17 = Py_TYPE(__pyx_t_12)->tp_iternext; if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1098, __pyx_L1_error)
         }
-        __pyx_t_10 = (__pyx_t_15) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_15, __pyx_t_14) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_14);
-        __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
-        __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-        if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1006, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_10);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __pyx_t_11 = NULL;
-        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
-          __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_9);
-          if (likely(__pyx_t_11)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
-            __Pyx_INCREF(__pyx_t_11);
-            __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_9, function);
+        for (;;) {
+          if (likely(!__pyx_t_17)) {
+            if (likely(PyList_CheckExact(__pyx_t_12))) {
+              if (__pyx_t_16 >= PyList_GET_SIZE(__pyx_t_12)) break;
+              #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+              __pyx_t_11 = PyList_GET_ITEM(__pyx_t_12, __pyx_t_16); __Pyx_INCREF(__pyx_t_11); __pyx_t_16++; if (unlikely(0 < 0)) __PYX_ERR(0, 1098, __pyx_L1_error)
+              #else
+              __pyx_t_11 = PySequence_ITEM(__pyx_t_12, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1098, __pyx_L1_error)
+              __Pyx_GOTREF(__pyx_t_11);
+              #endif
+            } else {
+              if (__pyx_t_16 >= PyTuple_GET_SIZE(__pyx_t_12)) break;
+              #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+              __pyx_t_11 = PyTuple_GET_ITEM(__pyx_t_12, __pyx_t_16); __Pyx_INCREF(__pyx_t_11); __pyx_t_16++; if (unlikely(0 < 0)) __PYX_ERR(0, 1098, __pyx_L1_error)
+              #else
+              __pyx_t_11 = PySequence_ITEM(__pyx_t_12, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1098, __pyx_L1_error)
+              __Pyx_GOTREF(__pyx_t_11);
+              #endif
+            }
+          } else {
+            __pyx_t_11 = __pyx_t_17(__pyx_t_12);
+            if (unlikely(!__pyx_t_11)) {
+              PyObject* exc_type = PyErr_Occurred();
+              if (exc_type) {
+                if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
+                else __PYX_ERR(0, 1098, __pyx_L1_error)
+              }
+              break;
+            }
+            __Pyx_GOTREF(__pyx_t_11);
           }
-        }
-        __pyx_t_3 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_11, __pyx_t_10) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_10);
-        __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1006, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-        __pyx_t_9 = __Pyx_PyObject_GetSlice(__pyx_t_3, 0, 0, NULL, &__pyx_cur_scope->__pyx_v_n, NULL, 0, 0, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1006, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_9);
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1006, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_k);
-        __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_k);
-        PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_cur_scope->__pyx_v_k);
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_slice__5);
-        if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cov_arr, __pyx_t_3, __pyx_t_9) < 0)) __PYX_ERR(0, 1006, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+          __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_k);
+          __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_k, __pyx_t_11);
+          __Pyx_GIVEREF(__pyx_t_11);
+          __pyx_t_11 = 0;
 
-        /* "statmoments/_native.pyx":1005
- *         m = vtk2np(dd.GetColumn(1))[n]
- *         cov_arr = np.empty((n, n))
- *         for k in range(n):             # <<<<<<<<<<<<<<
- *           cov_arr[k, :] = vtk2np(dd.GetColumn(k+2))[:n]
- *         # Restore to ddof=0 to ensure correctness
+          /* "statmoments/_native.pyx":1099
+ *         for jj, m in enumerate(moments):
+ *           for k in range(n):
+ *             cov_arr[k, :] = vtk2np(dd.GetColumn(k + 2))[:n]             # <<<<<<<<<<<<<<
+ *           # Restore to ddof=0 to ensure correctness
+ *           cov_arr *= (nn - 1.0) / nn
  */
-      }
-      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+          __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_vtk2np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1099, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_13);
+          __pyx_t_19 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_dd, __pyx_n_s_GetColumn); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1099, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_19);
+          __pyx_t_20 = __Pyx_PyInt_AddObjC(__pyx_cur_scope->__pyx_v_k, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1099, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_20);
+          __pyx_t_21 = NULL;
+          if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_19))) {
+            __pyx_t_21 = PyMethod_GET_SELF(__pyx_t_19);
+            if (likely(__pyx_t_21)) {
+              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_19);
+              __Pyx_INCREF(__pyx_t_21);
+              __Pyx_INCREF(function);
+              __Pyx_DECREF_SET(__pyx_t_19, function);
+            }
+          }
+          __pyx_t_18 = (__pyx_t_21) ? __Pyx_PyObject_Call2Args(__pyx_t_19, __pyx_t_21, __pyx_t_20) : __Pyx_PyObject_CallOneArg(__pyx_t_19, __pyx_t_20);
+          __Pyx_XDECREF(__pyx_t_21); __pyx_t_21 = 0;
+          __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
+          if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1099, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_18);
+          __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
+          __pyx_t_19 = NULL;
+          if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_13))) {
+            __pyx_t_19 = PyMethod_GET_SELF(__pyx_t_13);
+            if (likely(__pyx_t_19)) {
+              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
+              __Pyx_INCREF(__pyx_t_19);
+              __Pyx_INCREF(function);
+              __Pyx_DECREF_SET(__pyx_t_13, function);
+            }
+          }
+          __pyx_t_11 = (__pyx_t_19) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_19, __pyx_t_18) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_18);
+          __Pyx_XDECREF(__pyx_t_19); __pyx_t_19 = 0;
+          __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
+          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1099, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_11);
+          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+          __pyx_t_13 = __Pyx_PyObject_GetSlice(__pyx_t_11, 0, 0, NULL, &__pyx_cur_scope->__pyx_v_n, NULL, 0, 0, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1099, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_13);
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          __pyx_t_11 = PyTuple_New(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1099, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_11);
+          __Pyx_INCREF(__pyx_cur_scope->__pyx_v_k);
+          __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_k);
+          PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_cur_scope->__pyx_v_k);
+          __Pyx_INCREF(__pyx_slice__7);
+          __Pyx_GIVEREF(__pyx_slice__7);
+          PyTuple_SET_ITEM(__pyx_t_11, 1, __pyx_slice__7);
+          if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cov_arr, __pyx_t_11, __pyx_t_13) < 0)) __PYX_ERR(0, 1099, __pyx_L1_error)
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
 
-      /* "statmoments/_native.pyx":1008
- *           cov_arr[k, :] = vtk2np(dd.GetColumn(k+2))[:n]
- *         # Restore to ddof=0 to ensure correctness
- *         cov_arr *= (m-1.0) / m             # <<<<<<<<<<<<<<
- *         covs.append(triuflatten(cov_arr.T))
- *     yield (covs[0], covs[0]), (covs[1], covs[1])
+          /* "statmoments/_native.pyx":1098
+ *         # VTK cannot find co-moments higher than covariance
+ *         for jj, m in enumerate(moments):
+ *           for k in range(n):             # <<<<<<<<<<<<<<
+ *             cov_arr[k, :] = vtk2np(dd.GetColumn(k + 2))[:n]
+ *           # Restore to ddof=0 to ensure correctness
  */
-      __pyx_t_8 = __Pyx_PyFloat_SubtractObjC(__pyx_cur_scope->__pyx_v_m, __pyx_float_1_0, 1.0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1008, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_8);
-      __pyx_t_9 = __Pyx_PyNumber_Divide(__pyx_t_8, __pyx_cur_scope->__pyx_v_m); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1008, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_9);
-      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = PyNumber_InPlaceMultiply(__pyx_cur_scope->__pyx_v_cov_arr, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1008, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_8);
-      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __Pyx_GOTREF(__pyx_cur_scope->__pyx_v_cov_arr);
-      __Pyx_DECREF_SET(__pyx_cur_scope->__pyx_v_cov_arr, __pyx_t_8);
-      __Pyx_GIVEREF(__pyx_t_8);
-      __pyx_t_8 = 0;
+        }
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-      /* "statmoments/_native.pyx":1009
- *         # Restore to ddof=0 to ensure correctness
- *         cov_arr *= (m-1.0) / m
- *         covs.append(triuflatten(cov_arr.T))             # <<<<<<<<<<<<<<
- *     yield (covs[0], covs[0]), (covs[1], covs[1])
+        /* "statmoments/_native.pyx":1101
+ *             cov_arr[k, :] = vtk2np(dd.GetColumn(k + 2))[:n]
+ *           # Restore to ddof=0 to ensure correctness
+ *           cov_arr *= (nn - 1.0) / nn             # <<<<<<<<<<<<<<
+ *           retm[jj] = triuflatten(cov_arr.T)
+ *     yield self._retm[:, :len(moments[0])]
+ */
+        __pyx_t_12 = __Pyx_PyFloat_SubtractObjC(__pyx_cur_scope->__pyx_v_nn, __pyx_float_1_0, 1.0, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1101, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        __pyx_t_13 = __Pyx_PyNumber_Divide(__pyx_t_12, __pyx_cur_scope->__pyx_v_nn); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1101, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_13);
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __pyx_t_12 = PyNumber_InPlaceMultiply(__pyx_cur_scope->__pyx_v_cov_arr, __pyx_t_13); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1101, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+        __Pyx_GOTREF(__pyx_cur_scope->__pyx_v_cov_arr);
+        __Pyx_DECREF_SET(__pyx_cur_scope->__pyx_v_cov_arr, __pyx_t_12);
+        __Pyx_GIVEREF(__pyx_t_12);
+        __pyx_t_12 = 0;
+
+        /* "statmoments/_native.pyx":1102
+ *           # Restore to ddof=0 to ensure correctness
+ *           cov_arr *= (nn - 1.0) / nn
+ *           retm[jj] = triuflatten(cov_arr.T)             # <<<<<<<<<<<<<<
+ *     yield self._retm[:, :len(moments[0])]
  * 
  */
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_cov_arr, __pyx_n_s_T); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1009, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_9);
-      __Pyx_INCREF(__pyx_cur_scope->__pyx_v_triuflatten);
-      __pyx_t_3 = __pyx_cur_scope->__pyx_v_triuflatten; __pyx_t_10 = NULL;
-      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
-        __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_3);
-        if (likely(__pyx_t_10)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-          __Pyx_INCREF(__pyx_t_10);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_3, function);
+        __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_cov_arr, __pyx_n_s_T); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1102, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_13);
+        __Pyx_INCREF(__pyx_cur_scope->__pyx_v_triuflatten);
+        __pyx_t_11 = __pyx_cur_scope->__pyx_v_triuflatten; __pyx_t_18 = NULL;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
+          __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_11);
+          if (likely(__pyx_t_18)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
+            __Pyx_INCREF(__pyx_t_18);
+            __Pyx_INCREF(function);
+            __Pyx_DECREF_SET(__pyx_t_11, function);
+          }
         }
+        __pyx_t_12 = (__pyx_t_18) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_18, __pyx_t_13) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_13);
+        __Pyx_XDECREF(__pyx_t_18); __pyx_t_18 = 0;
+        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+        if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1102, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+        if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_retm, __pyx_cur_scope->__pyx_v_jj, __pyx_t_12) < 0)) __PYX_ERR(0, 1102, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+
+        /* "statmoments/_native.pyx":1097
+ *         cov_arr = np.empty((n, n))
+ *         # VTK cannot find co-moments higher than covariance
+ *         for jj, m in enumerate(moments):             # <<<<<<<<<<<<<<
+ *           for k in range(n):
+ *             cov_arr[k, :] = vtk2np(dd.GetColumn(k + 2))[:n]
+ */
       }
-      __pyx_t_8 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_10, __pyx_t_9) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_9);
-      __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1009, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_8);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_16 = __Pyx_PyList_Append(__pyx_cur_scope->__pyx_v_covs, __pyx_t_8); if (unlikely(__pyx_t_16 == ((int)-1))) __PYX_ERR(0, 1009, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-      /* "statmoments/_native.pyx":1000
- *     covs = []
- *     for mcss in self._stats:
- *       for mcs in mcss:             # <<<<<<<<<<<<<<
+      /* "statmoments/_native.pyx":1090
+ * 
+ *     for ii, mcss in enumerate(self._stats):
+ *       for _i, mcs in enumerate(mcss):             # <<<<<<<<<<<<<<
+ *         retm = self._retm[_i]
  *         dd = mcs.GetOutputDataObject(1).GetBlock(1)
- *         n = dd.GetNumberOfRows()-1
  */
     }
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":999
+    /* "statmoments/_native.pyx":1089
+ *     triuflatten = _triuflatten_gen(tr_len)
  * 
- *     covs = []
- *     for mcss in self._stats:             # <<<<<<<<<<<<<<
- *       for mcs in mcss:
- *         dd = mcs.GetOutputDataObject(1).GetBlock(1)
+ *     for ii, mcss in enumerate(self._stats):             # <<<<<<<<<<<<<<
+ *       for _i, mcs in enumerate(mcss):
+ *         retm = self._retm[_i]
  */
   }
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":1010
- *         cov_arr *= (m-1.0) / m
- *         covs.append(triuflatten(cov_arr.T))
- *     yield (covs[0], covs[0]), (covs[1], covs[1])             # <<<<<<<<<<<<<<
- * 
+  /* "statmoments/_native.pyx":1103
+ *           cov_arr *= (nn - 1.0) / nn
+ *           retm[jj] = triuflatten(cov_arr.T)
+ *     yield self._retm[:, :len(moments[0])]             # <<<<<<<<<<<<<<
  * 
+ * ########################## UNIVARIATE IMPLEMENTATIONS #########################
  */
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1010, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_INCREF(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_covs, 0));
-  __Pyx_GIVEREF(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_covs, 0));
-  PyTuple_SET_ITEM(__pyx_t_1, 0, PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_covs, 0));
-  __Pyx_INCREF(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_covs, 0));
-  __Pyx_GIVEREF(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_covs, 0));
-  PyTuple_SET_ITEM(__pyx_t_1, 1, PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_covs, 0));
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1010, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_INCREF(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_covs, 1));
-  __Pyx_GIVEREF(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_covs, 1));
-  PyTuple_SET_ITEM(__pyx_t_2, 0, PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_covs, 1));
-  __Pyx_INCREF(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_covs, 1));
-  __Pyx_GIVEREF(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_covs, 1));
-  PyTuple_SET_ITEM(__pyx_t_2, 1, PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_covs, 1));
-  __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1010, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_8);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1103, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_moments, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1103, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_4 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1103, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1103, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = PySlice_New(Py_None, __pyx_t_3, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1103, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1103, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_INCREF(__pyx_slice__7);
+  __Pyx_GIVEREF(__pyx_slice__7);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_slice__7);
   __Pyx_GIVEREF(__pyx_t_1);
-  PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_1);
-  __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_1);
+  __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1103, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
-  __pyx_t_2 = 0;
-  __pyx_r = __pyx_t_8;
-  __pyx_t_8 = 0;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
   /* return from generator, yielding value */
   __pyx_generator->resume_label = 1;
   return __pyx_r;
-  __pyx_L10_resume_from_yield:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 1010, __pyx_L1_error)
+  __pyx_L12_resume_from_yield:;
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 1103, __pyx_L1_error)
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
-  /* "statmoments/_native.pyx":994
- *     yield (avgs[0], avgs[0]), (avgs[1], avgs[1])
+  /* "statmoments/_native.pyx":1085
+ *     yield retm[:, :len(moments)]
  * 
- *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
+ *   def comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     tr_len, min_cnt = self.trace_len, self.acc_min_count
  *     triuflatten = _triuflatten_gen(tr_len)
  */
 
   /* function exit code */
   PyErr_SetNone(PyExc_StopIteration);
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_XDECREF(__pyx_t_6);
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_XDECREF(__pyx_t_10);
   __Pyx_XDECREF(__pyx_t_11);
-  __Pyx_XDECREF(__pyx_t_14);
-  __Pyx_XDECREF(__pyx_t_15);
-  __Pyx_AddTraceback("_comoments", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_XDECREF(__pyx_t_12);
+  __Pyx_XDECREF(__pyx_t_13);
+  __Pyx_XDECREF(__pyx_t_18);
+  __Pyx_XDECREF(__pyx_t_19);
+  __Pyx_XDECREF(__pyx_t_20);
+  __Pyx_XDECREF(__pyx_t_21);
+  __Pyx_AddTraceback("comoments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_r); __pyx_r = 0;
   #if !CYTHON_USE_EXC_INFO_STACK
   __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":1018
+/* "statmoments/_native.pyx":1110
  * @cython.returns('void')
  * @cython.locals(rm='double[::1]', sums1='double[::1]', n='int')
  * def _rawsums2rawmoments_acc0(sums1, rm, n):             # <<<<<<<<<<<<<<
  *   daxpy(sums1, rm, -1.0)
- *   dscal(1.0/n, rm)
+ *   dscal(1.0 / n, rm)
  */
 
 static void __pyx_f_11statmoments_7_native__rawsums2rawmoments_acc0(__Pyx_memviewslice __pyx_v_sums1, __Pyx_memviewslice __pyx_v_rm, int __pyx_v_n) {
   __Pyx_RefNannyDeclarations
   struct __pyx_opt_args_11statmoments_7_native_daxpy __pyx_t_1;
   __Pyx_RefNannySetupContext("_rawsums2rawmoments_acc0", 0);
 
-  /* "statmoments/_native.pyx":1019
+  /* "statmoments/_native.pyx":1111
  * @cython.locals(rm='double[::1]', sums1='double[::1]', n='int')
  * def _rawsums2rawmoments_acc0(sums1, rm, n):
  *   daxpy(sums1, rm, -1.0)             # <<<<<<<<<<<<<<
- *   dscal(1.0/n, rm)
+ *   dscal(1.0 / n, rm)
  * 
  */
   __pyx_t_1.__pyx_n = 1;
   __pyx_t_1.da = -1.0;
   __pyx_f_11statmoments_7_native_daxpy(__pyx_v_sums1, __pyx_v_rm, &__pyx_t_1); 
 
-  /* "statmoments/_native.pyx":1020
+  /* "statmoments/_native.pyx":1112
  * def _rawsums2rawmoments_acc0(sums1, rm, n):
  *   daxpy(sums1, rm, -1.0)
- *   dscal(1.0/n, rm)             # <<<<<<<<<<<<<<
+ *   dscal(1.0 / n, rm)             # <<<<<<<<<<<<<<
  * 
  * @cython.cfunc
  */
   __pyx_f_11statmoments_7_native_dscal((1.0 / ((double)__pyx_v_n)), __pyx_v_rm);
 
-  /* "statmoments/_native.pyx":1018
+  /* "statmoments/_native.pyx":1110
  * @cython.returns('void')
  * @cython.locals(rm='double[::1]', sums1='double[::1]', n='int')
  * def _rawsums2rawmoments_acc0(sums1, rm, n):             # <<<<<<<<<<<<<<
  *   daxpy(sums1, rm, -1.0)
- *   dscal(1.0/n, rm)
+ *   dscal(1.0 / n, rm)
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "statmoments/_native.pyx":1025
+/* "statmoments/_native.pyx":1117
  * @cython.returns('void')
  * @cython.locals(rm1='double[::1]', sums1='double[::1]', n='int')
  * def _rawsums2rawmoments_acc1(sums1, rm1, n):             # <<<<<<<<<<<<<<
- *   daxpy(sums1, rm1, 1.0/n)
+ *   daxpy(sums1, rm1, 1.0 / n)
  * 
  */
 
 static void __pyx_f_11statmoments_7_native__rawsums2rawmoments_acc1(__Pyx_memviewslice __pyx_v_sums1, __Pyx_memviewslice __pyx_v_rm1, int __pyx_v_n) {
   __Pyx_RefNannyDeclarations
   struct __pyx_opt_args_11statmoments_7_native_daxpy __pyx_t_1;
   __Pyx_RefNannySetupContext("_rawsums2rawmoments_acc1", 0);
 
-  /* "statmoments/_native.pyx":1026
+  /* "statmoments/_native.pyx":1118
  * @cython.locals(rm1='double[::1]', sums1='double[::1]', n='int')
  * def _rawsums2rawmoments_acc1(sums1, rm1, n):
- *   daxpy(sums1, rm1, 1.0/n)             # <<<<<<<<<<<<<<
+ *   daxpy(sums1, rm1, 1.0 / n)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_t_1.__pyx_n = 1;
   __pyx_t_1.da = (1.0 / ((double)__pyx_v_n));
   __pyx_f_11statmoments_7_native_daxpy(__pyx_v_sums1, __pyx_v_rm1, &__pyx_t_1); 
 
-  /* "statmoments/_native.pyx":1025
+  /* "statmoments/_native.pyx":1117
  * @cython.returns('void')
  * @cython.locals(rm1='double[::1]', sums1='double[::1]', n='int')
  * def _rawsums2rawmoments_acc1(sums1, rm1, n):             # <<<<<<<<<<<<<<
- *   daxpy(sums1, rm1, 1.0/n)
+ *   daxpy(sums1, rm1, 1.0 / n)
  * 
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "statmoments/_native.pyx":1030
+/* "statmoments/_native.pyx":1122
  * 
  * class univar_sum(_AccBase):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  * 
  */
 
@@ -35081,40 +37138,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_trace_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 1); __PYX_ERR(0, 1030, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 1); __PYX_ERR(0, 1122, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifier_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 2); __PYX_ERR(0, 1030, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 2); __PYX_ERR(0, 1122, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 1030, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 1122, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_trace_len = values[1];
     __pyx_v_classifier_len = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1030, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1122, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
   __Pyx_AddTraceback("statmoments._native.univar_sum.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_10univar_sum___init__(__pyx_self, __pyx_v_self, __pyx_v_trace_len, __pyx_v_classifier_len, __pyx_v_kwargs);
@@ -35136,271 +37193,271 @@
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "statmoments/_native.pyx":1031
+  /* "statmoments/_native.pyx":1123
  * class univar_sum(_AccBase):
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, **kwargs)             # <<<<<<<<<<<<<<
  * 
  *     self._dtype = kwargs.pop('acctype', np.float64)
  */
   __pyx_t_1 = __Pyx_CyFunction_GetClassObj(__pyx_self);
-  if (!__pyx_t_1) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 1031, __pyx_L1_error) }
+  if (!__pyx_t_1) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 1123, __pyx_L1_error) }
   __Pyx_INCREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1031, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __Pyx_INCREF(__pyx_v_self);
   __Pyx_GIVEREF(__pyx_v_self);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_self);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1031, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_init); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1031, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_init); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1031, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_trace_len);
   __Pyx_GIVEREF(__pyx_v_trace_len);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_trace_len);
   __Pyx_INCREF(__pyx_v_classifier_len);
   __Pyx_GIVEREF(__pyx_v_classifier_len);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_classifier_len);
-  __pyx_t_3 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1031, __pyx_L1_error)
+  __pyx_t_3 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1031, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":1033
+  /* "statmoments/_native.pyx":1125
  *     super().__init__(trace_len, classifier_len, **kwargs)
  * 
  *     self._dtype = kwargs.pop('acctype', np.float64)             # <<<<<<<<<<<<<<
- *     exp_traces = 50 # Guesstimate the number of traces in the input batch
+ *     exp_traces = 50  # Guesstimate the number of traces in the input batch
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1033, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1125, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1033, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1125, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_Pop(__pyx_v_kwargs, __pyx_n_u_acctype, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1033, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_Pop(__pyx_v_kwargs, __pyx_n_u_acctype, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1125, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2, __pyx_t_4) < 0) __PYX_ERR(0, 1033, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2, __pyx_t_4) < 0) __PYX_ERR(0, 1125, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":1034
+  /* "statmoments/_native.pyx":1126
  * 
  *     self._dtype = kwargs.pop('acctype', np.float64)
- *     exp_traces = 50 # Guesstimate the number of traces in the input batch             # <<<<<<<<<<<<<<
+ *     exp_traces = 50  # Guesstimate the number of traces in the input batch             # <<<<<<<<<<<<<<
  * 
  *     # Accumulators and layouts
  */
   __pyx_v_exp_traces = 50;
 
-  /* "statmoments/_native.pyx":1037
+  /* "statmoments/_native.pyx":1129
  * 
  *     # Accumulators and layouts
  *     moment = self.moment             # <<<<<<<<<<<<<<
  * 
  *     # Buffers for operations to avoid reallocations
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1037, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1129, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_v_moment = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":1040
+  /* "statmoments/_native.pyx":1132
  * 
  *     # Buffers for operations to avoid reallocations
- *     self._buf = np.empty((3, trace_len), dtype=self._dtype) # BLAS ops             # <<<<<<<<<<<<<<
+ *     self._buf    = np.empty((3, trace_len), dtype=self._dtype)  # BLAS ops buffer             # <<<<<<<<<<<<<<
  *     self._layout = np.empty((exp_traces, moment * trace_len + 1), dtype=self._dtype)
  *     self._accs   = np.zeros((classifier_len + 1, moment * trace_len + 1), dtype=self._dtype)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1040, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1132, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1040, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1132, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1040, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1132, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_int_3);
   __Pyx_GIVEREF(__pyx_int_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_int_3);
   __Pyx_INCREF(__pyx_v_trace_len);
   __Pyx_GIVEREF(__pyx_v_trace_len);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_trace_len);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1040, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1132, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1040, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1132, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1040, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1132, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 1040, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 1132, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1040, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1132, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_buf, __pyx_t_2) < 0) __PYX_ERR(0, 1040, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_buf, __pyx_t_2) < 0) __PYX_ERR(0, 1132, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":1041
+  /* "statmoments/_native.pyx":1133
  *     # Buffers for operations to avoid reallocations
- *     self._buf = np.empty((3, trace_len), dtype=self._dtype) # BLAS ops
+ *     self._buf    = np.empty((3, trace_len), dtype=self._dtype)  # BLAS ops buffer
  *     self._layout = np.empty((exp_traces, moment * trace_len + 1), dtype=self._dtype)             # <<<<<<<<<<<<<<
  *     self._accs   = np.zeros((classifier_len + 1, moment * trace_len + 1), dtype=self._dtype)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1041, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1133, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1041, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1133, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_exp_traces); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1041, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_exp_traces); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1133, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_v_moment, __pyx_v_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1041, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_moment, __pyx_v_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1133, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1041, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1133, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1041, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1133, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_3);
   __pyx_t_2 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1041, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1133, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1041, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1133, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1041, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1133, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 1041, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 1133, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1041, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1133, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_layout, __pyx_t_2) < 0) __PYX_ERR(0, 1041, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_layout, __pyx_t_2) < 0) __PYX_ERR(0, 1133, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":1042
- *     self._buf = np.empty((3, trace_len), dtype=self._dtype) # BLAS ops
+  /* "statmoments/_native.pyx":1134
+ *     self._buf    = np.empty((3, trace_len), dtype=self._dtype)  # BLAS ops buffer
  *     self._layout = np.empty((exp_traces, moment * trace_len + 1), dtype=self._dtype)
  *     self._accs   = np.zeros((classifier_len + 1, moment * trace_len + 1), dtype=self._dtype)             # <<<<<<<<<<<<<<
  * 
  *     # Buffers for raw/central moments transformation
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1042, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1042, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_classifier_len, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1042, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_classifier_len, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_v_moment, __pyx_v_trace_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1042, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_v_moment, __pyx_v_trace_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_3, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1042, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_3, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1042, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
   __pyx_t_2 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1042, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1042, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1042, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 1042, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 1134, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1042, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_accs, __pyx_t_2) < 0) __PYX_ERR(0, 1042, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_accs, __pyx_t_2) < 0) __PYX_ERR(0, 1134, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":1045
+  /* "statmoments/_native.pyx":1137
  * 
  *     # Buffers for raw/central moments transformation
  *     self._retm = np.empty((2, moment, trace_len), dtype=np.float64)             # <<<<<<<<<<<<<<
  * 
  *   @staticmethod
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1045, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1137, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1045, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1137, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1045, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1137, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_2);
   __Pyx_INCREF(__pyx_v_moment);
   __Pyx_GIVEREF(__pyx_v_moment);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_moment);
   __Pyx_INCREF(__pyx_v_trace_len);
   __Pyx_GIVEREF(__pyx_v_trace_len);
   PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_trace_len);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1045, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1137, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1045, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1137, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1045, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1137, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1045, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1137, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1045, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1137, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1045, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1137, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_retm, __pyx_t_5) < 0) __PYX_ERR(0, 1045, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_retm, __pyx_t_5) < 0) __PYX_ERR(0, 1137, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":1030
+  /* "statmoments/_native.pyx":1122
  * 
  * class univar_sum(_AccBase):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  * 
  */
 
@@ -35418,38 +37475,40 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_moment);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":1048
+/* "statmoments/_native.pyx":1140
  * 
  *   @staticmethod
- *   def estimate_mem_size(trace_len, classifier_len, moment):             # <<<<<<<<<<<<<<
- *     return ((classifier_len+1)*moment*trace_len + 2*moment*trace_len + 3 * trace_len) * 8
- * 
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *     exp_traces = 50  # Expected number of traces in the input batch
+ *     acc_dtype  = np.float64
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_11statmoments_7_native_10univar_sum_3estimate_mem_size(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_11statmoments_7_native_10univar_sum_3estimate_mem_size = {"estimate_mem_size", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_10univar_sum_3estimate_mem_size, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_11statmoments_7_native_10univar_sum_3estimate_mem_size(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyObject *__pyx_v_trace_len = 0;
-  PyObject *__pyx_v_classifier_len = 0;
+  PyObject *__pyx_v_tr_len = 0;
+  PyObject *__pyx_v_cl_len = 0;
   PyObject *__pyx_v_moment = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("estimate_mem_size (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_trace_len,&__pyx_n_s_classifier_len,&__pyx_n_s_moment,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_tr_len,&__pyx_n_s_cl_len,&__pyx_n_s_moment,0};
     PyObject* values[3] = {0,0,0};
+    values[1] = ((PyObject *)((PyObject *)__pyx_int_1));
+    values[2] = ((PyObject *)((PyObject *)__pyx_int_2));
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
@@ -35458,130 +37517,254 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_trace_len)) != 0)) kw_args--;
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tr_len)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifier_len)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("estimate_mem_size", 1, 3, 3, 1); __PYX_ERR(0, 1048, __pyx_L3_error)
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_cl_len);
+          if (value) { values[1] = value; kw_args--; }
         }
         CYTHON_FALLTHROUGH;
         case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moment)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("estimate_mem_size", 1, 3, 3, 2); __PYX_ERR(0, 1048, __pyx_L3_error)
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moment);
+          if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "estimate_mem_size") < 0)) __PYX_ERR(0, 1048, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "estimate_mem_size") < 0)) __PYX_ERR(0, 1140, __pyx_L3_error)
       }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
-      goto __pyx_L5_argtuple_error;
     } else {
-      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+      switch (PyTuple_GET_SIZE(__pyx_args)) {
+        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+        CYTHON_FALLTHROUGH;
+        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+        CYTHON_FALLTHROUGH;
+        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        break;
+        default: goto __pyx_L5_argtuple_error;
+      }
     }
-    __pyx_v_trace_len = values[0];
-    __pyx_v_classifier_len = values[1];
+    __pyx_v_tr_len = values[0];
+    __pyx_v_cl_len = values[1];
     __pyx_v_moment = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("estimate_mem_size", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1048, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("estimate_mem_size", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1140, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native.univar_sum.estimate_mem_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11statmoments_7_native_10univar_sum_2estimate_mem_size(__pyx_self, __pyx_v_trace_len, __pyx_v_classifier_len, __pyx_v_moment);
+  __pyx_r = __pyx_pf_11statmoments_7_native_10univar_sum_2estimate_mem_size(__pyx_self, __pyx_v_tr_len, __pyx_v_cl_len, __pyx_v_moment);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11statmoments_7_native_10univar_sum_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_trace_len, PyObject *__pyx_v_classifier_len, PyObject *__pyx_v_moment) {
+static PyObject *__pyx_pf_11statmoments_7_native_10univar_sum_2estimate_mem_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tr_len, PyObject *__pyx_v_cl_len, PyObject *__pyx_v_moment) {
+  PyObject *__pyx_v_exp_traces = NULL;
+  PyObject *__pyx_v_acc_dtype = NULL;
+  PyObject *__pyx_v_lytsz = NULL;
+  PyObject *__pyx_v_accssz = NULL;
+  PyObject *__pyx_v_bufsz = NULL;
+  PyObject *__pyx_v_ttsz = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("estimate_mem_size", 0);
 
-  /* "statmoments/_native.pyx":1049
+  /* "statmoments/_native.pyx":1141
  *   @staticmethod
- *   def estimate_mem_size(trace_len, classifier_len, moment):
- *     return ((classifier_len+1)*moment*trace_len + 2*moment*trace_len + 3 * trace_len) * 8             # <<<<<<<<<<<<<<
- * 
- *   def memory_size(self):
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):
+ *     exp_traces = 50  # Expected number of traces in the input batch             # <<<<<<<<<<<<<<
+ *     acc_dtype  = np.float64
+ *     lytsz      = exp_traces * (moment * tr_len + 1)
  */
-  __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_v_classifier_len, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1049, __pyx_L1_error)
+  __Pyx_INCREF(__pyx_int_50);
+  __pyx_v_exp_traces = __pyx_int_50;
+
+  /* "statmoments/_native.pyx":1142
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):
+ *     exp_traces = 50  # Expected number of traces in the input batch
+ *     acc_dtype  = np.float64             # <<<<<<<<<<<<<<
+ *     lytsz      = exp_traces * (moment * tr_len + 1)
+ *     accssz     = (cl_len + 1) * (moment * tr_len + 1)
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1142, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyNumber_Multiply(__pyx_t_1, __pyx_v_moment); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1049, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1142, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Multiply(__pyx_t_2, __pyx_v_trace_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1049, __pyx_L1_error)
+  __pyx_v_acc_dtype = __pyx_t_2;
+  __pyx_t_2 = 0;
+
+  /* "statmoments/_native.pyx":1143
+ *     exp_traces = 50  # Expected number of traces in the input batch
+ *     acc_dtype  = np.float64
+ *     lytsz      = exp_traces * (moment * tr_len + 1)             # <<<<<<<<<<<<<<
+ *     accssz     = (cl_len + 1) * (moment * tr_len + 1)
+ *     bufsz      = 3 * tr_len
+ */
+  __pyx_t_2 = PyNumber_Multiply(__pyx_v_moment, __pyx_v_tr_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1143, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1143, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyNumber_Multiply(__pyx_int_2, __pyx_v_moment); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1049, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_v_exp_traces, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1143, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_2, __pyx_v_trace_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1049, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyNumber_Add(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1049, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_lytsz = __pyx_t_2;
+  __pyx_t_2 = 0;
+
+  /* "statmoments/_native.pyx":1144
+ *     acc_dtype  = np.float64
+ *     lytsz      = exp_traces * (moment * tr_len + 1)
+ *     accssz     = (cl_len + 1) * (moment * tr_len + 1)             # <<<<<<<<<<<<<<
+ *     bufsz      = 3 * tr_len
+ *     ttsz       = 2 * moment * tr_len
+ */
+  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_cl_len, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1144, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_moment, __pyx_v_tr_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1144, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1144, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1144, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Multiply(__pyx_int_3, __pyx_v_trace_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1049, __pyx_L1_error)
+  __pyx_v_accssz = __pyx_t_1;
+  __pyx_t_1 = 0;
+
+  /* "statmoments/_native.pyx":1145
+ *     lytsz      = exp_traces * (moment * tr_len + 1)
+ *     accssz     = (cl_len + 1) * (moment * tr_len + 1)
+ *     bufsz      = 3 * tr_len             # <<<<<<<<<<<<<<
+ *     ttsz       = 2 * moment * tr_len
+ *     return (lytsz + accssz + bufsz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
+ */
+  __pyx_t_1 = PyNumber_Multiply(__pyx_int_3, __pyx_v_tr_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1145, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_v_bufsz = __pyx_t_1;
+  __pyx_t_1 = 0;
+
+  /* "statmoments/_native.pyx":1146
+ *     accssz     = (cl_len + 1) * (moment * tr_len + 1)
+ *     bufsz      = 3 * tr_len
+ *     ttsz       = 2 * moment * tr_len             # <<<<<<<<<<<<<<
+ *     return (lytsz + accssz + bufsz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
+ * 
+ */
+  __pyx_t_1 = PyNumber_Multiply(__pyx_int_2, __pyx_v_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1146, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_v_tr_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1146, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_ttsz = __pyx_t_3;
+  __pyx_t_3 = 0;
+
+  /* "statmoments/_native.pyx":1147
+ *     bufsz      = 3 * tr_len
+ *     ttsz       = 2 * moment * tr_len
+ *     return (lytsz + accssz + bufsz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8             # <<<<<<<<<<<<<<
+ * 
+ *   def memory_size(self):
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_3 = PyNumber_Add(__pyx_v_lytsz, __pyx_v_accssz); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1147, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyNumber_Add(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1049, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Add(__pyx_t_3, __pyx_v_bufsz); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1147, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1147, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_finfo); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1147, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = NULL;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
+    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
+    if (likely(__pyx_t_2)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
+      __Pyx_INCREF(__pyx_t_2);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_4, function);
+    }
+  }
+  __pyx_t_3 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, __pyx_v_acc_dtype) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_acc_dtype);
+  __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1147, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bits); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1147, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_int_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1049, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1147, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_r = __pyx_t_3;
-  __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_PyInt_FloorDivideObjC(__pyx_t_3, __pyx_int_8, 8, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1147, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = PyNumber_Multiply(__pyx_v_ttsz, __pyx_int_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1147, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = PyNumber_Add(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1147, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":1048
+  /* "statmoments/_native.pyx":1140
  * 
  *   @staticmethod
- *   def estimate_mem_size(trace_len, classifier_len, moment):             # <<<<<<<<<<<<<<
- *     return ((classifier_len+1)*moment*trace_len + 2*moment*trace_len + 3 * trace_len) * 8
- * 
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *     exp_traces = 50  # Expected number of traces in the input batch
+ *     acc_dtype  = np.float64
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
   __Pyx_AddTraceback("statmoments._native.univar_sum.estimate_mem_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
+  __Pyx_XDECREF(__pyx_v_exp_traces);
+  __Pyx_XDECREF(__pyx_v_acc_dtype);
+  __Pyx_XDECREF(__pyx_v_lytsz);
+  __Pyx_XDECREF(__pyx_v_accssz);
+  __Pyx_XDECREF(__pyx_v_bufsz);
+  __Pyx_XDECREF(__pyx_v_ttsz);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":1051
- *     return ((classifier_len+1)*moment*trace_len + 2*moment*trace_len + 3 * trace_len) * 8
+/* "statmoments/_native.pyx":1149
+ *     return (lytsz + accssz + bufsz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
  *     mem_ttest = 0  # included in mem_class
  */
 
 /* Python wrapper */
@@ -35595,15 +37778,15 @@
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static PyObject *__pyx_gb_11statmoments_7_native_10univar_sum_11memory_size_2generator16(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "statmoments/_native.pyx":1052
+/* "statmoments/_native.pyx":1150
  * 
  *   def memory_size(self):
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))             # <<<<<<<<<<<<<<
  *     mem_ttest = 0  # included in mem_class
  *     return mem_class + mem_ttest * 8
  */
 
@@ -35615,23 +37798,23 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("genexpr", 0);
   __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_20_genexpr *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_20_genexpr(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_20_genexpr, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_20_genexpr *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 1052, __pyx_L1_error)
+    __PYX_ERR(0, 1150, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_19_memory_size *) __pyx_self;
   __Pyx_INCREF(((PyObject *)__pyx_cur_scope->__pyx_outer_scope));
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_outer_scope);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_10univar_sum_11memory_size_2generator16, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_univar_sum_memory_size_locals_ge, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 1052, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_10univar_sum_11memory_size_2generator16, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_univar_sum_memory_size_locals_ge, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 1150, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -35665,48 +37848,48 @@
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L7_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 1052, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 1150, __pyx_L1_error)
   __pyx_t_2 = 0;
-  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_self)) { __Pyx_RaiseClosureNameError("self"); __PYX_ERR(0, 1052, __pyx_L1_error) }
-  __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_vars, __pyx_cur_scope->__pyx_outer_scope->__pyx_v_self); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1052, __pyx_L1_error)
+  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_self)) { __Pyx_RaiseClosureNameError("self"); __PYX_ERR(0, 1150, __pyx_L1_error) }
+  __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_vars, __pyx_cur_scope->__pyx_outer_scope->__pyx_v_self); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1150, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   if (unlikely(__pyx_t_5 == Py_None)) {
     PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "values");
-    __PYX_ERR(0, 1052, __pyx_L1_error)
+    __PYX_ERR(0, 1150, __pyx_L1_error)
   }
-  __pyx_t_6 = __Pyx_dict_iterator(__pyx_t_5, 0, __pyx_n_s_values, (&__pyx_t_3), (&__pyx_t_4)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1052, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_dict_iterator(__pyx_t_5, 0, __pyx_n_s_values, (&__pyx_t_3), (&__pyx_t_4)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1150, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_XDECREF(__pyx_t_1);
   __pyx_t_1 = __pyx_t_6;
   __pyx_t_6 = 0;
   while (1) {
     __pyx_t_7 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_3, &__pyx_t_2, NULL, &__pyx_t_6, NULL, __pyx_t_4);
     if (unlikely(__pyx_t_7 == 0)) break;
-    if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 1052, __pyx_L1_error)
+    if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 1150, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_v);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_v, __pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_6);
     __pyx_t_6 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1052, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1150, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_ndarray); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1052, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_ndarray); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1150, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_8 = PyObject_IsInstance(__pyx_cur_scope->__pyx_v_v, __pyx_t_5); if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 1052, __pyx_L1_error)
+    __pyx_t_8 = PyObject_IsInstance(__pyx_cur_scope->__pyx_v_v, __pyx_t_5); if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 1150, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_9 = (__pyx_t_8 != 0);
     if (__pyx_t_9) {
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_v, __pyx_n_s_nbytes); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1052, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_v, __pyx_n_s_nbytes); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1150, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __pyx_r = __pyx_t_5;
       __pyx_t_5 = 0;
       __Pyx_XGIVEREF(__pyx_t_1);
       __pyx_cur_scope->__pyx_t_0 = __pyx_t_1;
       __pyx_cur_scope->__pyx_t_1 = __pyx_t_2;
       __pyx_cur_scope->__pyx_t_2 = __pyx_t_3;
@@ -35720,15 +37903,15 @@
       __pyx_L7_resume_from_yield:;
       __pyx_t_1 = __pyx_cur_scope->__pyx_t_0;
       __pyx_cur_scope->__pyx_t_0 = 0;
       __Pyx_XGOTREF(__pyx_t_1);
       __pyx_t_2 = __pyx_cur_scope->__pyx_t_1;
       __pyx_t_3 = __pyx_cur_scope->__pyx_t_2;
       __pyx_t_4 = __pyx_cur_scope->__pyx_t_3;
-      if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 1052, __pyx_L1_error)
+      if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 1150, __pyx_L1_error)
     }
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
   /* function exit code */
   PyErr_SetNone(PyExc_StopIteration);
@@ -35745,16 +37928,16 @@
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":1051
- *     return ((classifier_len+1)*moment*trace_len + 2*moment*trace_len + 3 * trace_len) * 8
+/* "statmoments/_native.pyx":1149
+ *     return (lytsz + accssz + bufsz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
  *     mem_ttest = 0  # included in mem_class
  */
 
 static PyObject *__pyx_pf_11statmoments_7_native_10univar_sum_4memory_size(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
@@ -35770,66 +37953,66 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("memory_size", 0);
   __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_19_memory_size *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_19_memory_size(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_19_memory_size, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_19_memory_size *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 1051, __pyx_L1_error)
+    __PYX_ERR(0, 1149, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
 
-  /* "statmoments/_native.pyx":1052
+  /* "statmoments/_native.pyx":1150
  * 
  *   def memory_size(self):
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))             # <<<<<<<<<<<<<<
  *     mem_ttest = 0  # included in mem_class
  *     return mem_class + mem_ttest * 8
  */
-  __pyx_t_1 = __pyx_pf_11statmoments_7_native_10univar_sum_11memory_size_genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1052, __pyx_L1_error)
+  __pyx_t_1 = __pyx_pf_11statmoments_7_native_10univar_sum_11memory_size_genexpr(((PyObject*)__pyx_cur_scope)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1150, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_sum, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1052, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_sum, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1150, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_mem_class = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":1053
+  /* "statmoments/_native.pyx":1151
  *   def memory_size(self):
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
  *     mem_ttest = 0  # included in mem_class             # <<<<<<<<<<<<<<
  *     return mem_class + mem_ttest * 8
  * 
  */
   __Pyx_INCREF(__pyx_int_0);
   __pyx_v_mem_ttest = __pyx_int_0;
 
-  /* "statmoments/_native.pyx":1054
+  /* "statmoments/_native.pyx":1152
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
  *     mem_ttest = 0  # included in mem_class
  *     return mem_class + mem_ttest * 8             # <<<<<<<<<<<<<<
  * 
  *   def counts(self, i):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = PyNumber_Multiply(__pyx_v_mem_ttest, __pyx_int_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1054, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_v_mem_ttest, __pyx_int_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1152, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyNumber_Add(__pyx_v_mem_class, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1054, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Add(__pyx_v_mem_class, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1152, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":1051
- *     return ((classifier_len+1)*moment*trace_len + 2*moment*trace_len + 3 * trace_len) * 8
+  /* "statmoments/_native.pyx":1149
+ *     return (lytsz + accssz + bufsz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
  *     mem_ttest = 0  # included in mem_class
  */
 
   /* function exit code */
@@ -35844,19 +38027,19 @@
   __Pyx_XDECREF(__pyx_gb_11statmoments_7_native_10univar_sum_11memory_size_2generator16);
   __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":1056
+/* "statmoments/_native.pyx":1154
  *     return mem_class + mem_ttest * 8
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
- *     c1 = self._accs[i+1, 0]
+ *     c1 = self._accs[i + 1, 0]
  *     return self._accs[0, 0] - c1, c1
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_11statmoments_7_native_10univar_sum_7counts(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_11statmoments_7_native_10univar_sum_7counts = {"counts", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_10univar_sum_7counts, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_11statmoments_7_native_10univar_sum_7counts(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
@@ -35887,32 +38070,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_i)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, 1); __PYX_ERR(0, 1056, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, 1); __PYX_ERR(0, 1154, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "counts") < 0)) __PYX_ERR(0, 1056, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "counts") < 0)) __PYX_ERR(0, 1154, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_i = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1056, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("counts", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1154, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native.univar_sum.counts", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_10univar_sum_6counts(__pyx_self, __pyx_v_self, __pyx_v_i);
 
@@ -35929,73 +38112,73 @@
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("counts", 0);
 
-  /* "statmoments/_native.pyx":1057
+  /* "statmoments/_native.pyx":1155
  * 
  *   def counts(self, i):
- *     c1 = self._accs[i+1, 0]             # <<<<<<<<<<<<<<
+ *     c1 = self._accs[i + 1, 0]             # <<<<<<<<<<<<<<
  *     return self._accs[0, 0] - c1, c1
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1057, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1155, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1057, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1155, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1057, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1155, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
   __Pyx_INCREF(__pyx_int_0);
   __Pyx_GIVEREF(__pyx_int_0);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_0);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1057, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1155, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_c1 = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":1058
+  /* "statmoments/_native.pyx":1156
  *   def counts(self, i):
- *     c1 = self._accs[i+1, 0]
+ *     c1 = self._accs[i + 1, 0]
  *     return self._accs[0, 0] - c1, c1             # <<<<<<<<<<<<<<
  * 
  *   def _moments(self, moments, normalize):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1058, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1156, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_tuple__21); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1058, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_tuple__23); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1156, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyNumber_Subtract(__pyx_t_3, __pyx_v_c1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1058, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Subtract(__pyx_t_3, __pyx_v_c1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1156, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1058, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1156, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
   __Pyx_INCREF(__pyx_v_c1);
   __Pyx_GIVEREF(__pyx_v_c1);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_c1);
   __pyx_t_2 = 0;
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":1056
+  /* "statmoments/_native.pyx":1154
  *     return mem_class + mem_ttest * 8
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
- *     c1 = self._accs[i+1, 0]
+ *     c1 = self._accs[i + 1, 0]
  *     return self._accs[0, 0] - c1, c1
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
@@ -36006,15 +38189,15 @@
   __Pyx_XDECREF(__pyx_v_c1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static PyObject *__pyx_gb_11statmoments_7_native_10univar_sum_10generator10(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "statmoments/_native.pyx":1060
+/* "statmoments/_native.pyx":1158
  *     return self._accs[0, 0] - c1, c1
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     maxm = np.max(moments)
  *     if 2 * self.moment < maxm:
  */
 
@@ -36052,40 +38235,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moments)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 1); __PYX_ERR(0, 1060, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 1); __PYX_ERR(0, 1158, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_normalize)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 2); __PYX_ERR(0, 1060, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 2); __PYX_ERR(0, 1158, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_moments") < 0)) __PYX_ERR(0, 1060, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_moments") < 0)) __PYX_ERR(0, 1158, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_moments = values[1];
     __pyx_v_normalize = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1060, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1158, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native.univar_sum._moments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_10univar_sum_8_moments(__pyx_self, __pyx_v_self, __pyx_v_moments, __pyx_v_normalize);
 
@@ -36102,29 +38285,29 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_moments", 0);
   __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_21__moments *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_21__moments(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_21__moments, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_21__moments *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 1060, __pyx_L1_error)
+    __PYX_ERR(0, 1158, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
   __pyx_cur_scope->__pyx_v_moments = __pyx_v_moments;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_moments);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_moments);
   __pyx_cur_scope->__pyx_v_normalize = __pyx_v_normalize;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_normalize);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_normalize);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_10univar_sum_10generator10, __pyx_codeobj__42, (PyObject *) __pyx_cur_scope, __pyx_n_s_moments_2, __pyx_n_s_univar_sum__moments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 1060, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_10univar_sum_10generator10, __pyx_codeobj__41, (PyObject *) __pyx_cur_scope, __pyx_n_s_moments_2, __pyx_n_s_univar_sum__moments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 1158, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -36166,196 +38349,196 @@
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L17_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 1060, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 1158, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":1061
+  /* "statmoments/_native.pyx":1159
  * 
  *   def _moments(self, moments, normalize):
  *     maxm = np.max(moments)             # <<<<<<<<<<<<<<
  *     if 2 * self.moment < maxm:
  *       raise ValueError("The moment should be less or equal than indicated in constructor.")
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1159, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_max); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_max); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1159, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_cur_scope->__pyx_v_moments) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_cur_scope->__pyx_v_moments);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1159, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v_maxm = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":1062
+  /* "statmoments/_native.pyx":1160
  *   def _moments(self, moments, normalize):
  *     maxm = np.max(moments)
  *     if 2 * self.moment < maxm:             # <<<<<<<<<<<<<<
  *       raise ValueError("The moment should be less or equal than indicated in constructor.")
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1160, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_int_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_int_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1160, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyObject_RichCompare(__pyx_t_3, __pyx_cur_scope->__pyx_v_maxm, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(__pyx_t_3, __pyx_cur_scope->__pyx_v_maxm, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1160, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1160, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (unlikely(__pyx_t_4)) {
 
-    /* "statmoments/_native.pyx":1063
+    /* "statmoments/_native.pyx":1161
  *     maxm = np.max(moments)
  *     if 2 * self.moment < maxm:
  *       raise ValueError("The moment should be less or equal than indicated in constructor.")             # <<<<<<<<<<<<<<
  * 
  *     # TODO: slice cm up to maxm
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1063, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1161, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 1063, __pyx_L1_error)
+    __PYX_ERR(0, 1161, __pyx_L1_error)
 
-    /* "statmoments/_native.pyx":1062
+    /* "statmoments/_native.pyx":1160
  *   def _moments(self, moments, normalize):
  *     maxm = np.max(moments)
  *     if 2 * self.moment < maxm:             # <<<<<<<<<<<<<<
  *       raise ValueError("The moment should be less or equal than indicated in constructor.")
  * 
  */
   }
 
-  /* "statmoments/_native.pyx":1068
+  /* "statmoments/_native.pyx":1166
  *     # Ensure that 2nd moment (variance) is in a separate piece of memory
  *     # to avoid buffer corruption while normalizing skeweness and higher moments
  *     cm, buf = self._retm, self._buf             # <<<<<<<<<<<<<<
- *     moments = [m-1 for m in moments]
+ *     moments = [m - 1 for m in moments]
  *     nT, accT = self._accs[0, 0], self._accs[0, 1:].reshape(self._retm.shape[1:])
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1068, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1166, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_buf); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1068, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_buf); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1166, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v_cm = __pyx_t_1;
   __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_3);
   __pyx_cur_scope->__pyx_v_buf = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":1069
+  /* "statmoments/_native.pyx":1167
  *     # to avoid buffer corruption while normalizing skeweness and higher moments
  *     cm, buf = self._retm, self._buf
- *     moments = [m-1 for m in moments]             # <<<<<<<<<<<<<<
+ *     moments = [m - 1 for m in moments]             # <<<<<<<<<<<<<<
  *     nT, accT = self._accs[0, 0], self._accs[0, 1:].reshape(self._retm.shape[1:])
  * 
  */
   { /* enter inner scope */
-    __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1069, __pyx_L1_error)
+    __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1167, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_v_moments)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_moments)) {
       __pyx_t_1 = __pyx_cur_scope->__pyx_v_moments; __Pyx_INCREF(__pyx_t_1); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
     } else {
-      __pyx_t_5 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1069, __pyx_L1_error)
+      __pyx_t_5 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1167, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1069, __pyx_L1_error)
+      __pyx_t_6 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1167, __pyx_L1_error)
     }
     for (;;) {
       if (likely(!__pyx_t_6)) {
         if (likely(PyList_CheckExact(__pyx_t_1))) {
           if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1069, __pyx_L1_error)
+          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1167, __pyx_L1_error)
           #else
-          __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1069, __pyx_L1_error)
+          __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1167, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           #endif
         } else {
           if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1069, __pyx_L1_error)
+          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1167, __pyx_L1_error)
           #else
-          __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1069, __pyx_L1_error)
+          __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1167, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           #endif
         }
       } else {
         __pyx_t_2 = __pyx_t_6(__pyx_t_1);
         if (unlikely(!__pyx_t_2)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 1069, __pyx_L1_error)
+            else __PYX_ERR(0, 1167, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_2);
       }
-      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_9genexpr14__pyx_v_m);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_9genexpr14__pyx_v_m, __pyx_t_2);
+      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_9genexpr15__pyx_v_m);
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_9genexpr15__pyx_v_m, __pyx_t_2);
       __Pyx_GIVEREF(__pyx_t_2);
       __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_cur_scope->__pyx_9genexpr14__pyx_v_m, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1069, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_cur_scope->__pyx_9genexpr15__pyx_v_m, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1167, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 1069, __pyx_L1_error)
+      if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 1167, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   } /* exit inner scope */
   __Pyx_GOTREF(__pyx_cur_scope->__pyx_v_moments);
   __Pyx_DECREF_SET(__pyx_cur_scope->__pyx_v_moments, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":1070
+  /* "statmoments/_native.pyx":1168
  *     cm, buf = self._retm, self._buf
- *     moments = [m-1 for m in moments]
+ *     moments = [m - 1 for m in moments]
  *     nT, accT = self._accs[0, 0], self._accs[0, 1:].reshape(self._retm.shape[1:])             # <<<<<<<<<<<<<<
  * 
  *     for acc1 in self._accs[1:]:
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1070, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1168, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_tuple__21); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1070, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_tuple__23); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1168, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1070, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1168, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_tuple__43); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1070, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_tuple__42); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1168, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_reshape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1070, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_reshape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1168, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1070, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1168, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_shape); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1070, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_shape); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1168, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_GetSlice(__pyx_t_8, 1, 0, NULL, NULL, &__pyx_slice__17, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1070, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetSlice(__pyx_t_8, 1, 0, NULL, NULL, &__pyx_slice__19, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1168, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   __pyx_t_8 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_8)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -36363,311 +38546,311 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_3 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_8, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_7);
   __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1070, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1168, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v_nT = __pyx_t_1;
   __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_3);
   __pyx_cur_scope->__pyx_v_accT = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":1072
+  /* "statmoments/_native.pyx":1170
  *     nT, accT = self._accs[0, 0], self._accs[0, 1:].reshape(self._retm.shape[1:])
  * 
  *     for acc1 in self._accs[1:]:             # <<<<<<<<<<<<<<
  *       n1, acc1 = acc1[0], acc1[1:]
  *       nn = [nT - n1, n1]
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1072, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1170, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_t_3, 1, 0, NULL, NULL, &__pyx_slice__17, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1072, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_t_3, 1, 0, NULL, NULL, &__pyx_slice__19, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1170, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
     __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3); __pyx_t_5 = 0;
     __pyx_t_6 = NULL;
   } else {
-    __pyx_t_5 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1072, __pyx_L1_error)
+    __pyx_t_5 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1170, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_6 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1072, __pyx_L1_error)
+    __pyx_t_6 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1170, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_6)) {
       if (likely(PyList_CheckExact(__pyx_t_3))) {
         if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1072, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1170, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1072, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1170, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1072, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1170, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1072, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1170, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
       __pyx_t_1 = __pyx_t_6(__pyx_t_3);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 1072, __pyx_L1_error)
+          else __PYX_ERR(0, 1170, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_acc1);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_acc1, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":1073
+    /* "statmoments/_native.pyx":1171
  * 
  *     for acc1 in self._accs[1:]:
  *       n1, acc1 = acc1[0], acc1[1:]             # <<<<<<<<<<<<<<
  *       nn = [nT - n1, n1]
  * 
  */
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_acc1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1073, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_acc1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1171, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_cur_scope->__pyx_v_acc1, 1, 0, NULL, NULL, &__pyx_slice__17, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1073, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_cur_scope->__pyx_v_acc1, 1, 0, NULL, NULL, &__pyx_slice__19, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1171, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_n1);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_n1, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_1);
     __pyx_t_1 = 0;
     __Pyx_GOTREF(__pyx_cur_scope->__pyx_v_acc1);
     __Pyx_DECREF_SET(__pyx_cur_scope->__pyx_v_acc1, __pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "statmoments/_native.pyx":1074
+    /* "statmoments/_native.pyx":1172
  *     for acc1 in self._accs[1:]:
  *       n1, acc1 = acc1[0], acc1[1:]
  *       nn = [nT - n1, n1]             # <<<<<<<<<<<<<<
  * 
- *       cm[0][:] = accT         #cm0 = (accT - acc[ii]) / nn[0] # Has to be copied out
+ *       cm[0][:] = accT         #  cm0 = (accT - acc[ii]) / nn[0] # Has to be copied out
  */
-    __pyx_t_2 = PyNumber_Subtract(__pyx_cur_scope->__pyx_v_nT, __pyx_cur_scope->__pyx_v_n1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1074, __pyx_L1_error)
+    __pyx_t_2 = PyNumber_Subtract(__pyx_cur_scope->__pyx_v_nT, __pyx_cur_scope->__pyx_v_n1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1172, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1074, __pyx_L1_error)
+    __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1172, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_2);
     PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
     __Pyx_INCREF(__pyx_cur_scope->__pyx_v_n1);
     __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_n1);
     PyList_SET_ITEM(__pyx_t_1, 1, __pyx_cur_scope->__pyx_v_n1);
     __pyx_t_2 = 0;
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_nn);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_nn, ((PyObject*)__pyx_t_1));
     __Pyx_GIVEREF(__pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":1076
+    /* "statmoments/_native.pyx":1174
  *       nn = [nT - n1, n1]
  * 
- *       cm[0][:] = accT         #cm0 = (accT - acc[ii]) / nn[0] # Has to be copied out             # <<<<<<<<<<<<<<
- *       cm[1][:] = 0.0          #cm1 =         acc[ii]  / nn[1] # Has to be zeroed out
+ *       cm[0][:] = accT         #  cm0 = (accT - acc[ii]) / nn[0] # Has to be copied out             # <<<<<<<<<<<<<<
+ *       cm[1][:] = 0.0          #  cm1 =         acc[ii]  / nn[1] # Has to be zeroed out
  * 
  */
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_cm, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1076, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_cm, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1174, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (__Pyx_PyObject_SetSlice(__pyx_t_1, __pyx_cur_scope->__pyx_v_accT, 0, 0, NULL, NULL, &__pyx_slice__5, 0, 0, 0) < 0) __PYX_ERR(0, 1076, __pyx_L1_error)
+    if (__Pyx_PyObject_SetSlice(__pyx_t_1, __pyx_cur_scope->__pyx_v_accT, 0, 0, NULL, NULL, &__pyx_slice__7, 0, 0, 0) < 0) __PYX_ERR(0, 1174, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":1077
+    /* "statmoments/_native.pyx":1175
  * 
- *       cm[0][:] = accT         #cm0 = (accT - acc[ii]) / nn[0] # Has to be copied out
- *       cm[1][:] = 0.0          #cm1 =         acc[ii]  / nn[1] # Has to be zeroed out             # <<<<<<<<<<<<<<
+ *       cm[0][:] = accT         #  cm0 = (accT - acc[ii]) / nn[0] # Has to be copied out
+ *       cm[1][:] = 0.0          #  cm1 =         acc[ii]  / nn[1] # Has to be zeroed out             # <<<<<<<<<<<<<<
  * 
  *       # TODO: Shorten the accumulator to convert
  */
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_cm, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1077, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_cm, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1175, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (__Pyx_PyObject_SetSlice(__pyx_t_1, __pyx_float_0_0, 0, 0, NULL, NULL, &__pyx_slice__5, 0, 0, 0) < 0) __PYX_ERR(0, 1077, __pyx_L1_error)
+    if (__Pyx_PyObject_SetSlice(__pyx_t_1, __pyx_float_0_0, 0, 0, NULL, NULL, &__pyx_slice__7, 0, 0, 0) < 0) __PYX_ERR(0, 1175, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":1080
+    /* "statmoments/_native.pyx":1178
  * 
  *       # TODO: Shorten the accumulator to convert
  *       _rawsums2rawmoments_acc0(acc1.ravel(), cm[0].ravel(), max(1, nn[0]))             # <<<<<<<<<<<<<<
  *       _rawsums2rawmoments_acc1(acc1.ravel(), cm[1].ravel(), max(1, nn[1]))
  * 
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_acc1, __pyx_n_s_ravel); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_acc1, __pyx_n_s_ravel); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1178, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_1 = (__pyx_t_7) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_7) : __Pyx_PyObject_CallNoArg(__pyx_t_2);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1178, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1178, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_cm, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_cm, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1178, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_ravel); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_ravel); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1178, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_7);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1178, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 1178, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_INCREF(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_nn, 0));
     __pyx_t_1 = PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_nn, 0);
     __pyx_t_11 = 1;
-    __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1178, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_8 = PyObject_RichCompare(__pyx_t_1, __pyx_t_2, Py_GT); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    __pyx_t_8 = PyObject_RichCompare(__pyx_t_1, __pyx_t_2, Py_GT); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1178, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1178, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     if (__pyx_t_4) {
       __Pyx_INCREF(__pyx_t_1);
       __pyx_t_7 = __pyx_t_1;
     } else {
-      __pyx_t_8 = __Pyx_PyInt_From_long(__pyx_t_11); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1080, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyInt_From_long(__pyx_t_11); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1178, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __pyx_t_7 = __pyx_t_8;
       __pyx_t_8 = 0;
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_12 = __Pyx_PyInt_As_int(__pyx_t_7); if (unlikely((__pyx_t_12 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1080, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyInt_As_int(__pyx_t_7); if (unlikely((__pyx_t_12 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1178, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_f_11statmoments_7_native__rawsums2rawmoments_acc0(__pyx_t_9, __pyx_t_10, __pyx_t_12);
     __PYX_XDEC_MEMVIEW(&__pyx_t_9, 1);
     __pyx_t_9.memview = NULL;
     __pyx_t_9.data = NULL;
     __PYX_XDEC_MEMVIEW(&__pyx_t_10, 1);
     __pyx_t_10.memview = NULL;
     __pyx_t_10.data = NULL;
 
-    /* "statmoments/_native.pyx":1081
+    /* "statmoments/_native.pyx":1179
  *       # TODO: Shorten the accumulator to convert
  *       _rawsums2rawmoments_acc0(acc1.ravel(), cm[0].ravel(), max(1, nn[0]))
  *       _rawsums2rawmoments_acc1(acc1.ravel(), cm[1].ravel(), max(1, nn[1]))             # <<<<<<<<<<<<<<
  * 
  *       _rmoms2cmoms(cm[0], maxm, buf)
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_acc1, __pyx_n_s_ravel); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1081, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_acc1, __pyx_n_s_ravel); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1179, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_8 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_8)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
         __Pyx_INCREF(__pyx_t_8);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_7 = (__pyx_t_8) ? __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_8) : __Pyx_PyObject_CallNoArg(__pyx_t_1);
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1081, __pyx_L1_error)
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1179, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 1081, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 1179, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_cm, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1081, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_cm, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1179, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_ravel); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1081, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_ravel); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1179, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_1 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_8))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_8);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_8, function);
       }
     }
     __pyx_t_7 = (__pyx_t_1) ? __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_1) : __Pyx_PyObject_CallNoArg(__pyx_t_8);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1081, __pyx_L1_error)
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1179, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1081, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1179, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_INCREF(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_nn, 1));
     __pyx_t_7 = PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_nn, 1);
     __pyx_t_11 = 1;
-    __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1081, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1179, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = PyObject_RichCompare(__pyx_t_7, __pyx_t_1, Py_GT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1081, __pyx_L1_error)
+    __pyx_t_2 = PyObject_RichCompare(__pyx_t_7, __pyx_t_1, Py_GT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1179, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1081, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1179, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     if (__pyx_t_4) {
       __Pyx_INCREF(__pyx_t_7);
       __pyx_t_8 = __pyx_t_7;
     } else {
-      __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1081, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1179, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __pyx_t_8 = __pyx_t_2;
       __pyx_t_2 = 0;
     }
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_12 = __Pyx_PyInt_As_int(__pyx_t_8); if (unlikely((__pyx_t_12 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1081, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyInt_As_int(__pyx_t_8); if (unlikely((__pyx_t_12 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1179, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __pyx_f_11statmoments_7_native__rawsums2rawmoments_acc1(__pyx_t_10, __pyx_t_9, __pyx_t_12);
     __PYX_XDEC_MEMVIEW(&__pyx_t_10, 1);
     __pyx_t_10.memview = NULL;
     __pyx_t_10.data = NULL;
     __PYX_XDEC_MEMVIEW(&__pyx_t_9, 1);
     __pyx_t_9.memview = NULL;
     __pyx_t_9.data = NULL;
 
-    /* "statmoments/_native.pyx":1083
+    /* "statmoments/_native.pyx":1181
  *       _rawsums2rawmoments_acc1(acc1.ravel(), cm[1].ravel(), max(1, nn[1]))
  * 
  *       _rmoms2cmoms(cm[0], maxm, buf)             # <<<<<<<<<<<<<<
  *       _rmoms2cmoms(cm[1], maxm, buf)
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_rmoms2cmoms); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1083, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_rmoms2cmoms); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1181, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_cm, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1083, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_cm, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1181, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_1 = NULL;
     __pyx_t_12 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
@@ -36676,61 +38859,61 @@
         __Pyx_DECREF_SET(__pyx_t_7, function);
         __pyx_t_12 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_7)) {
       PyObject *__pyx_temp[4] = {__pyx_t_1, __pyx_t_2, __pyx_cur_scope->__pyx_v_maxm, __pyx_cur_scope->__pyx_v_buf};
-      __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_12, 3+__pyx_t_12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1083, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_12, 3+__pyx_t_12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1181, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_7)) {
       PyObject *__pyx_temp[4] = {__pyx_t_1, __pyx_t_2, __pyx_cur_scope->__pyx_v_maxm, __pyx_cur_scope->__pyx_v_buf};
-      __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_12, 3+__pyx_t_12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1083, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_12, 3+__pyx_t_12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1181, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     } else
     #endif
     {
-      __pyx_t_13 = PyTuple_New(3+__pyx_t_12); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1083, __pyx_L1_error)
+      __pyx_t_13 = PyTuple_New(3+__pyx_t_12); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1181, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_13);
       if (__pyx_t_1) {
         __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_1); __pyx_t_1 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_2);
       PyTuple_SET_ITEM(__pyx_t_13, 0+__pyx_t_12, __pyx_t_2);
       __Pyx_INCREF(__pyx_cur_scope->__pyx_v_maxm);
       __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_maxm);
       PyTuple_SET_ITEM(__pyx_t_13, 1+__pyx_t_12, __pyx_cur_scope->__pyx_v_maxm);
       __Pyx_INCREF(__pyx_cur_scope->__pyx_v_buf);
       __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_buf);
       PyTuple_SET_ITEM(__pyx_t_13, 2+__pyx_t_12, __pyx_cur_scope->__pyx_v_buf);
       __pyx_t_2 = 0;
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_13, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1083, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_13, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1181, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
     }
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "statmoments/_native.pyx":1084
+    /* "statmoments/_native.pyx":1182
  * 
  *       _rmoms2cmoms(cm[0], maxm, buf)
  *       _rmoms2cmoms(cm[1], maxm, buf)             # <<<<<<<<<<<<<<
  * 
  *       if maxm >= 3 and normalize:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_rmoms2cmoms); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1084, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_rmoms2cmoms); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1182, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_13 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_cm, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1084, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_cm, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1182, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __pyx_t_2 = NULL;
     __pyx_t_12 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
@@ -36739,116 +38922,116 @@
         __Pyx_DECREF_SET(__pyx_t_7, function);
         __pyx_t_12 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_7)) {
       PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_t_13, __pyx_cur_scope->__pyx_v_maxm, __pyx_cur_scope->__pyx_v_buf};
-      __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_12, 3+__pyx_t_12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1084, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_12, 3+__pyx_t_12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1182, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_7)) {
       PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_t_13, __pyx_cur_scope->__pyx_v_maxm, __pyx_cur_scope->__pyx_v_buf};
-      __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_12, 3+__pyx_t_12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1084, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_12, 3+__pyx_t_12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1182, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
     } else
     #endif
     {
-      __pyx_t_1 = PyTuple_New(3+__pyx_t_12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1084, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(3+__pyx_t_12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1182, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (__pyx_t_2) {
         __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2); __pyx_t_2 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_13);
       PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_12, __pyx_t_13);
       __Pyx_INCREF(__pyx_cur_scope->__pyx_v_maxm);
       __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_maxm);
       PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_12, __pyx_cur_scope->__pyx_v_maxm);
       __Pyx_INCREF(__pyx_cur_scope->__pyx_v_buf);
       __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_buf);
       PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_12, __pyx_cur_scope->__pyx_v_buf);
       __pyx_t_13 = 0;
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_1, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1084, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_1, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1182, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "statmoments/_native.pyx":1086
+    /* "statmoments/_native.pyx":1184
  *       _rmoms2cmoms(cm[1], maxm, buf)
  * 
  *       if maxm >= 3 and normalize:             # <<<<<<<<<<<<<<
  *         for _i in range(2):
  *           if nn[_i] > 0:
  */
-    __pyx_t_8 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_maxm, __pyx_int_3, Py_GE); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1086, __pyx_L1_error)
-    __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_14 < 0)) __PYX_ERR(0, 1086, __pyx_L1_error)
+    __pyx_t_8 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_maxm, __pyx_int_3, Py_GE); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1184, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_14 < 0)) __PYX_ERR(0, 1184, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     if (__pyx_t_14) {
     } else {
       __pyx_t_4 = __pyx_t_14;
       goto __pyx_L10_bool_binop_done;
     }
-    __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_normalize); if (unlikely(__pyx_t_14 < 0)) __PYX_ERR(0, 1086, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_normalize); if (unlikely(__pyx_t_14 < 0)) __PYX_ERR(0, 1184, __pyx_L1_error)
     __pyx_t_4 = __pyx_t_14;
     __pyx_L10_bool_binop_done:;
     if (__pyx_t_4) {
 
-      /* "statmoments/_native.pyx":1087
+      /* "statmoments/_native.pyx":1185
  * 
  *       if maxm >= 3 and normalize:
  *         for _i in range(2):             # <<<<<<<<<<<<<<
  *           if nn[_i] > 0:
  *             sd = np.sqrt(cm[_i, 1])
  */
       for (__pyx_t_11 = 0; __pyx_t_11 < 2; __pyx_t_11+=1) {
         __pyx_cur_scope->__pyx_v__i = __pyx_t_11;
 
-        /* "statmoments/_native.pyx":1088
+        /* "statmoments/_native.pyx":1186
  *       if maxm >= 3 and normalize:
  *         for _i in range(2):
  *           if nn[_i] > 0:             # <<<<<<<<<<<<<<
  *             sd = np.sqrt(cm[_i, 1])
  *             for i, cmi in enumerate(cm[_i, 2:maxm], 3):
  */
-        __pyx_t_8 = PyObject_RichCompare(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_nn, __pyx_cur_scope->__pyx_v__i), __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1088, __pyx_L1_error)
-        __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1088, __pyx_L1_error)
+        __pyx_t_8 = PyObject_RichCompare(PyList_GET_ITEM(__pyx_cur_scope->__pyx_v_nn, __pyx_cur_scope->__pyx_v__i), __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1186, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1186, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         if (__pyx_t_4) {
 
-          /* "statmoments/_native.pyx":1089
+          /* "statmoments/_native.pyx":1187
  *         for _i in range(2):
  *           if nn[_i] > 0:
  *             sd = np.sqrt(cm[_i, 1])             # <<<<<<<<<<<<<<
  *             for i, cmi in enumerate(cm[_i, 2:maxm], 3):
  *               cmi[:] /= sd ** i
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1089, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1187, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
-          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1089, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1187, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          __pyx_t_7 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1089, __pyx_L1_error)
+          __pyx_t_7 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1187, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
-          __pyx_t_13 = PyTuple_New(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1089, __pyx_L1_error)
+          __pyx_t_13 = PyTuple_New(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1187, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_13);
           __Pyx_GIVEREF(__pyx_t_7);
           PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_7);
           __Pyx_INCREF(__pyx_int_1);
           __Pyx_GIVEREF(__pyx_int_1);
           PyTuple_SET_ITEM(__pyx_t_13, 1, __pyx_int_1);
           __pyx_t_7 = 0;
-          __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_13); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1089, __pyx_L1_error)
+          __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_13); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1187, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
           __pyx_t_13 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
             __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_1);
             if (likely(__pyx_t_13)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
@@ -36856,169 +39039,169 @@
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_1, function);
             }
           }
           __pyx_t_8 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_13, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_7);
           __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1089, __pyx_L1_error)
+          if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1187, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
           __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_sd);
           __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_sd, __pyx_t_8);
           __Pyx_GIVEREF(__pyx_t_8);
           __pyx_t_8 = 0;
 
-          /* "statmoments/_native.pyx":1090
+          /* "statmoments/_native.pyx":1188
  *           if nn[_i] > 0:
  *             sd = np.sqrt(cm[_i, 1])
  *             for i, cmi in enumerate(cm[_i, 2:maxm], 3):             # <<<<<<<<<<<<<<
  *               cmi[:] /= sd ** i
  * 
  */
           __Pyx_INCREF(__pyx_int_3);
           __pyx_t_8 = __pyx_int_3;
-          __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1090, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_cur_scope->__pyx_v__i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1188, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_7 = PySlice_New(__pyx_int_2, __pyx_cur_scope->__pyx_v_maxm, Py_None); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1090, __pyx_L1_error)
+          __pyx_t_7 = PySlice_New(__pyx_int_2, __pyx_cur_scope->__pyx_v_maxm, Py_None); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1188, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
-          __pyx_t_13 = PyTuple_New(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1090, __pyx_L1_error)
+          __pyx_t_13 = PyTuple_New(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1188, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_13);
           __Pyx_GIVEREF(__pyx_t_1);
           PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_1);
           __Pyx_GIVEREF(__pyx_t_7);
           PyTuple_SET_ITEM(__pyx_t_13, 1, __pyx_t_7);
           __pyx_t_1 = 0;
           __pyx_t_7 = 0;
-          __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_13); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1090, __pyx_L1_error)
+          __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cm, __pyx_t_13); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1188, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
           if (likely(PyList_CheckExact(__pyx_t_7)) || PyTuple_CheckExact(__pyx_t_7)) {
             __pyx_t_13 = __pyx_t_7; __Pyx_INCREF(__pyx_t_13); __pyx_t_15 = 0;
             __pyx_t_16 = NULL;
           } else {
-            __pyx_t_15 = -1; __pyx_t_13 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1090, __pyx_L1_error)
+            __pyx_t_15 = -1; __pyx_t_13 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1188, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_13);
-            __pyx_t_16 = Py_TYPE(__pyx_t_13)->tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1090, __pyx_L1_error)
+            __pyx_t_16 = Py_TYPE(__pyx_t_13)->tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1188, __pyx_L1_error)
           }
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
           for (;;) {
             if (likely(!__pyx_t_16)) {
               if (likely(PyList_CheckExact(__pyx_t_13))) {
                 if (__pyx_t_15 >= PyList_GET_SIZE(__pyx_t_13)) break;
                 #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-                __pyx_t_7 = PyList_GET_ITEM(__pyx_t_13, __pyx_t_15); __Pyx_INCREF(__pyx_t_7); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 1090, __pyx_L1_error)
+                __pyx_t_7 = PyList_GET_ITEM(__pyx_t_13, __pyx_t_15); __Pyx_INCREF(__pyx_t_7); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 1188, __pyx_L1_error)
                 #else
-                __pyx_t_7 = PySequence_ITEM(__pyx_t_13, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1090, __pyx_L1_error)
+                __pyx_t_7 = PySequence_ITEM(__pyx_t_13, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1188, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_7);
                 #endif
               } else {
                 if (__pyx_t_15 >= PyTuple_GET_SIZE(__pyx_t_13)) break;
                 #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-                __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_13, __pyx_t_15); __Pyx_INCREF(__pyx_t_7); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 1090, __pyx_L1_error)
+                __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_13, __pyx_t_15); __Pyx_INCREF(__pyx_t_7); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 1188, __pyx_L1_error)
                 #else
-                __pyx_t_7 = PySequence_ITEM(__pyx_t_13, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1090, __pyx_L1_error)
+                __pyx_t_7 = PySequence_ITEM(__pyx_t_13, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1188, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_7);
                 #endif
               }
             } else {
               __pyx_t_7 = __pyx_t_16(__pyx_t_13);
               if (unlikely(!__pyx_t_7)) {
                 PyObject* exc_type = PyErr_Occurred();
                 if (exc_type) {
                   if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                  else __PYX_ERR(0, 1090, __pyx_L1_error)
+                  else __PYX_ERR(0, 1188, __pyx_L1_error)
                 }
                 break;
               }
               __Pyx_GOTREF(__pyx_t_7);
             }
             __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_cmi);
             __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_cmi, __pyx_t_7);
             __Pyx_GIVEREF(__pyx_t_7);
             __pyx_t_7 = 0;
             __Pyx_INCREF(__pyx_t_8);
             __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_i);
             __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_i, __pyx_t_8);
             __Pyx_GIVEREF(__pyx_t_8);
-            __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_8, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1090, __pyx_L1_error)
+            __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_8, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1188, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_7);
             __Pyx_DECREF(__pyx_t_8);
             __pyx_t_8 = __pyx_t_7;
             __pyx_t_7 = 0;
 
-            /* "statmoments/_native.pyx":1091
+            /* "statmoments/_native.pyx":1189
  *             sd = np.sqrt(cm[_i, 1])
  *             for i, cmi in enumerate(cm[_i, 2:maxm], 3):
  *               cmi[:] /= sd ** i             # <<<<<<<<<<<<<<
  * 
  *       yield self._retm[:, moments]
  */
-            __Pyx_INCREF(__pyx_slice__5);
-            __pyx_t_17 = __pyx_slice__5;
-            __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cmi, __pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1091, __pyx_L1_error)
+            __Pyx_INCREF(__pyx_slice__7);
+            __pyx_t_17 = __pyx_slice__7;
+            __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_cmi, __pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1189, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_7);
-            __pyx_t_1 = PyNumber_Power(__pyx_cur_scope->__pyx_v_sd, __pyx_cur_scope->__pyx_v_i, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1091, __pyx_L1_error)
+            __pyx_t_1 = PyNumber_Power(__pyx_cur_scope->__pyx_v_sd, __pyx_cur_scope->__pyx_v_i, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1189, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_1);
-            __pyx_t_2 = __Pyx_PyNumber_InPlaceDivide(__pyx_t_7, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1091, __pyx_L1_error)
+            __pyx_t_2 = __Pyx_PyNumber_InPlaceDivide(__pyx_t_7, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1189, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_2);
             __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-            if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cmi, __pyx_t_17, __pyx_t_2) < 0)) __PYX_ERR(0, 1091, __pyx_L1_error)
+            if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_cmi, __pyx_t_17, __pyx_t_2) < 0)) __PYX_ERR(0, 1189, __pyx_L1_error)
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
             __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
 
-            /* "statmoments/_native.pyx":1090
+            /* "statmoments/_native.pyx":1188
  *           if nn[_i] > 0:
  *             sd = np.sqrt(cm[_i, 1])
  *             for i, cmi in enumerate(cm[_i, 2:maxm], 3):             # <<<<<<<<<<<<<<
  *               cmi[:] /= sd ** i
  * 
  */
           }
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-          /* "statmoments/_native.pyx":1088
+          /* "statmoments/_native.pyx":1186
  *       if maxm >= 3 and normalize:
  *         for _i in range(2):
  *           if nn[_i] > 0:             # <<<<<<<<<<<<<<
  *             sd = np.sqrt(cm[_i, 1])
  *             for i, cmi in enumerate(cm[_i, 2:maxm], 3):
  */
         }
       }
 
-      /* "statmoments/_native.pyx":1086
+      /* "statmoments/_native.pyx":1184
  *       _rmoms2cmoms(cm[1], maxm, buf)
  * 
  *       if maxm >= 3 and normalize:             # <<<<<<<<<<<<<<
  *         for _i in range(2):
  *           if nn[_i] > 0:
  */
     }
 
-    /* "statmoments/_native.pyx":1093
+    /* "statmoments/_native.pyx":1191
  *               cmi[:] /= sd ** i
  * 
  *       yield self._retm[:, moments]             # <<<<<<<<<<<<<<
  * 
  *   def update(self, traces, classifiers):
  */
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1093, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_retm); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1191, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_13 = PyTuple_New(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1093, __pyx_L1_error)
+    __pyx_t_13 = PyTuple_New(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1191, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
-    __Pyx_INCREF(__pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_slice__5);
-    PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_slice__5);
+    __Pyx_INCREF(__pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_slice__7);
+    PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_slice__7);
     __Pyx_INCREF(__pyx_cur_scope->__pyx_v_moments);
     __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_moments);
     PyTuple_SET_ITEM(__pyx_t_13, 1, __pyx_cur_scope->__pyx_v_moments);
-    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_8, __pyx_t_13); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1093, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_8, __pyx_t_13); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1191, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
     __Pyx_XGIVEREF(__pyx_t_3);
     __pyx_cur_scope->__pyx_t_0 = __pyx_t_3;
@@ -37032,28 +39215,28 @@
     return __pyx_r;
     __pyx_L17_resume_from_yield:;
     __pyx_t_3 = __pyx_cur_scope->__pyx_t_0;
     __pyx_cur_scope->__pyx_t_0 = 0;
     __Pyx_XGOTREF(__pyx_t_3);
     __pyx_t_5 = __pyx_cur_scope->__pyx_t_1;
     __pyx_t_6 = __pyx_cur_scope->__pyx_t_2;
-    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 1093, __pyx_L1_error)
+    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 1191, __pyx_L1_error)
 
-    /* "statmoments/_native.pyx":1072
+    /* "statmoments/_native.pyx":1170
  *     nT, accT = self._accs[0, 0], self._accs[0, 1:].reshape(self._retm.shape[1:])
  * 
  *     for acc1 in self._accs[1:]:             # <<<<<<<<<<<<<<
  *       n1, acc1 = acc1[0], acc1[1:]
  *       nn = [nT - n1, n1]
  */
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
-  /* "statmoments/_native.pyx":1060
+  /* "statmoments/_native.pyx":1158
  *     return self._accs[0, 0] - c1, c1
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     maxm = np.max(moments)
  *     if 2 * self.moment < maxm:
  */
 
@@ -37078,15 +39261,15 @@
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":1095
+/* "statmoments/_native.pyx":1193
  *       yield self._retm[:, moments]
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     moment, batch_cnt = self.moment, len(traces)
  *     tr_len, cl_len = self.trace_len, self.classifiers_len
  */
 
@@ -37124,40 +39307,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_traces)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 1); __PYX_ERR(0, 1095, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 1); __PYX_ERR(0, 1193, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifiers)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 2); __PYX_ERR(0, 1095, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 2); __PYX_ERR(0, 1193, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update") < 0)) __PYX_ERR(0, 1095, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update") < 0)) __PYX_ERR(0, 1193, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_traces = values[1];
     __pyx_v_classifiers = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1095, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1193, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native.univar_sum.update", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_10univar_sum_11update(__pyx_self, __pyx_v_self, __pyx_v_traces, __pyx_v_classifiers);
 
@@ -37196,171 +39379,171 @@
   __Pyx_memviewslice __pyx_t_15 = { 0, 0, { 0 }, { 0 }, { 0 } };
   struct __pyx_opt_args_11statmoments_7_native_dgemm __pyx_t_16;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("update", 0);
 
-  /* "statmoments/_native.pyx":1096
+  /* "statmoments/_native.pyx":1194
  * 
  *   def update(self, traces, classifiers):
  *     moment, batch_cnt = self.moment, len(traces)             # <<<<<<<<<<<<<<
  *     tr_len, cl_len = self.trace_len, self.classifiers_len
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1096, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_moment); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1194, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_Length(__pyx_v_traces); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1096, __pyx_L1_error)
-  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1096, __pyx_L1_error)
+  __pyx_t_2 = PyObject_Length(__pyx_v_traces); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1194, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1194, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_v_moment = __pyx_t_1;
   __pyx_t_1 = 0;
   __pyx_v_batch_cnt = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":1097
+  /* "statmoments/_native.pyx":1195
  *   def update(self, traces, classifiers):
  *     moment, batch_cnt = self.moment, len(traces)
  *     tr_len, cl_len = self.trace_len, self.classifiers_len             # <<<<<<<<<<<<<<
  * 
  *     self.total_count += batch_cnt
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1097, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1195, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_classifiers_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1097, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_classifiers_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1195, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_tr_len = __pyx_t_3;
   __pyx_t_3 = 0;
   __pyx_v_cl_len = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":1099
+  /* "statmoments/_native.pyx":1197
  *     tr_len, cl_len = self.trace_len, self.classifiers_len
  * 
  *     self.total_count += batch_cnt             # <<<<<<<<<<<<<<
  * 
  *     if len(self._layout) < batch_cnt:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_total_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1099, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_total_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1197, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_t_1, __pyx_v_batch_cnt); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1099, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_t_1, __pyx_v_batch_cnt); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1197, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_total_count, __pyx_t_3) < 0) __PYX_ERR(0, 1099, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_total_count, __pyx_t_3) < 0) __PYX_ERR(0, 1197, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":1101
+  /* "statmoments/_native.pyx":1199
  *     self.total_count += batch_cnt
  * 
  *     if len(self._layout) < batch_cnt:             # <<<<<<<<<<<<<<
  *       self._layout = np.empty((batch_cnt, moment * tr_len + 1), dtype=self._layout.dtype)
  * 
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_layout); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1101, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_layout); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1199, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1101, __pyx_L1_error)
+  __pyx_t_2 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1199, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1101, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1199, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyObject_RichCompare(__pyx_t_3, __pyx_v_batch_cnt, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1101, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(__pyx_t_3, __pyx_v_batch_cnt, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1199, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1101, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1199, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_4) {
 
-    /* "statmoments/_native.pyx":1102
+    /* "statmoments/_native.pyx":1200
  * 
  *     if len(self._layout) < batch_cnt:
  *       self._layout = np.empty((batch_cnt, moment * tr_len + 1), dtype=self._layout.dtype)             # <<<<<<<<<<<<<<
  * 
  *     tr_lyt = self._layout[:batch_cnt]
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1102, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1200, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1102, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1200, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Multiply(__pyx_v_moment, __pyx_v_tr_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1102, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Multiply(__pyx_v_moment, __pyx_v_tr_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1200, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1102, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1200, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1102, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1200, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v_batch_cnt);
     __Pyx_GIVEREF(__pyx_v_batch_cnt);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_batch_cnt);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_5);
     __pyx_t_5 = 0;
-    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1102, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1200, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
     __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1102, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1200, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_layout); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1102, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_layout); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1200, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_dtype); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1102, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_dtype); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1200, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 1102, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 1200, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1102, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1200, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_layout, __pyx_t_7) < 0) __PYX_ERR(0, 1102, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_layout, __pyx_t_7) < 0) __PYX_ERR(0, 1200, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-    /* "statmoments/_native.pyx":1101
+    /* "statmoments/_native.pyx":1199
  *     self.total_count += batch_cnt
  * 
  *     if len(self._layout) < batch_cnt:             # <<<<<<<<<<<<<<
  *       self._layout = np.empty((batch_cnt, moment * tr_len + 1), dtype=self._layout.dtype)
  * 
  */
   }
 
-  /* "statmoments/_native.pyx":1104
+  /* "statmoments/_native.pyx":1202
  *       self._layout = np.empty((batch_cnt, moment * tr_len + 1), dtype=self._layout.dtype)
  * 
  *     tr_lyt = self._layout[:batch_cnt]             # <<<<<<<<<<<<<<
  *     tr_lyt[:, 0] = 1
  *     tr_lyt_view = tr_lyt[:, 1:].reshape(batch_cnt, moment, tr_len)
  */
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_layout); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1104, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_layout); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1202, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_t_7, 0, 0, NULL, &__pyx_v_batch_cnt, NULL, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1104, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_t_7, 0, 0, NULL, &__pyx_v_batch_cnt, NULL, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1202, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_v_tr_lyt = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":1105
+  /* "statmoments/_native.pyx":1203
  * 
  *     tr_lyt = self._layout[:batch_cnt]
  *     tr_lyt[:, 0] = 1             # <<<<<<<<<<<<<<
  *     tr_lyt_view = tr_lyt[:, 1:].reshape(batch_cnt, moment, tr_len)
  * 
  */
-  if (unlikely(PyObject_SetItem(__pyx_v_tr_lyt, __pyx_tuple__16, __pyx_int_1) < 0)) __PYX_ERR(0, 1105, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_tr_lyt, __pyx_tuple__18, __pyx_int_1) < 0)) __PYX_ERR(0, 1203, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":1106
+  /* "statmoments/_native.pyx":1204
  *     tr_lyt = self._layout[:batch_cnt]
  *     tr_lyt[:, 0] = 1
  *     tr_lyt_view = tr_lyt[:, 1:].reshape(batch_cnt, moment, tr_len)             # <<<<<<<<<<<<<<
  * 
  *     # Step 1: Create trace layout matrix up to moment degree
  */
-  __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_tr_lyt, __pyx_tuple__18); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1106, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_tr_lyt, __pyx_tuple__20); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1204, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_reshape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1106, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_reshape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1204, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_t_7 = NULL;
   __pyx_t_8 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_7)) {
@@ -37370,162 +39553,162 @@
       __Pyx_DECREF_SET(__pyx_t_5, function);
       __pyx_t_8 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_5)) {
     PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_v_batch_cnt, __pyx_v_moment, __pyx_v_tr_len};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1106, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1204, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
     PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_v_batch_cnt, __pyx_v_moment, __pyx_v_tr_len};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1106, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1204, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   {
-    __pyx_t_3 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1106, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1204, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     if (__pyx_t_7) {
       __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_7); __pyx_t_7 = NULL;
     }
     __Pyx_INCREF(__pyx_v_batch_cnt);
     __Pyx_GIVEREF(__pyx_v_batch_cnt);
     PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_8, __pyx_v_batch_cnt);
     __Pyx_INCREF(__pyx_v_moment);
     __Pyx_GIVEREF(__pyx_v_moment);
     PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_8, __pyx_v_moment);
     __Pyx_INCREF(__pyx_v_tr_len);
     __Pyx_GIVEREF(__pyx_v_tr_len);
     PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_8, __pyx_v_tr_len);
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1106, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1204, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_tr_lyt_view = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":1109
+  /* "statmoments/_native.pyx":1207
  * 
  *     # Step 1: Create trace layout matrix up to moment degree
  *     tr_lyt_view[:, 0, :] = traces             # <<<<<<<<<<<<<<
  *     for j in range(1, moment):
  *       np.multiply(tr_lyt_view[:, 0, :], tr_lyt_view[:, j - 1, :], tr_lyt_view[:, j, :])
  */
-  if (unlikely(PyObject_SetItem(__pyx_v_tr_lyt_view, __pyx_tuple__19, __pyx_v_traces) < 0)) __PYX_ERR(0, 1109, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_tr_lyt_view, __pyx_tuple__21, __pyx_v_traces) < 0)) __PYX_ERR(0, 1207, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":1110
+  /* "statmoments/_native.pyx":1208
  *     # Step 1: Create trace layout matrix up to moment degree
  *     tr_lyt_view[:, 0, :] = traces
  *     for j in range(1, moment):             # <<<<<<<<<<<<<<
  *       np.multiply(tr_lyt_view[:, 0, :], tr_lyt_view[:, j - 1, :], tr_lyt_view[:, j, :])
  * 
  */
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1110, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1208, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_int_1);
   __Pyx_INCREF(__pyx_v_moment);
   __Pyx_GIVEREF(__pyx_v_moment);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_moment);
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_1, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1110, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_1, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1208, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
     __pyx_t_1 = __pyx_t_5; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
     __pyx_t_9 = NULL;
   } else {
-    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1110, __pyx_L1_error)
+    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1208, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_9 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1110, __pyx_L1_error)
+    __pyx_t_9 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1208, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   for (;;) {
     if (likely(!__pyx_t_9)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_5); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1110, __pyx_L1_error)
+        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_5); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1208, __pyx_L1_error)
         #else
-        __pyx_t_5 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1110, __pyx_L1_error)
+        __pyx_t_5 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1208, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         #endif
       } else {
         if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_5); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1110, __pyx_L1_error)
+        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_5); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1208, __pyx_L1_error)
         #else
-        __pyx_t_5 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1110, __pyx_L1_error)
+        __pyx_t_5 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1208, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         #endif
       }
     } else {
       __pyx_t_5 = __pyx_t_9(__pyx_t_1);
       if (unlikely(!__pyx_t_5)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 1110, __pyx_L1_error)
+          else __PYX_ERR(0, 1208, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_5);
     }
     __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_5);
     __pyx_t_5 = 0;
 
-    /* "statmoments/_native.pyx":1111
+    /* "statmoments/_native.pyx":1209
  *     tr_lyt_view[:, 0, :] = traces
  *     for j in range(1, moment):
  *       np.multiply(tr_lyt_view[:, 0, :], tr_lyt_view[:, j - 1, :], tr_lyt_view[:, j, :])             # <<<<<<<<<<<<<<
  * 
  *     # Step 2: Create classifier layout matrix
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1111, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1209, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_multiply); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1111, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_multiply); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1209, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_tr_lyt_view, __pyx_tuple__19); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1111, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_tr_lyt_view, __pyx_tuple__21); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1209, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_v_j, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1111, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_v_j, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1209, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_10 = PyTuple_New(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1111, __pyx_L1_error)
+    __pyx_t_10 = PyTuple_New(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1209, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __Pyx_INCREF(__pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_slice__5);
-    PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_slice__5);
+    __Pyx_INCREF(__pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_slice__7);
+    PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_slice__7);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_t_6);
-    __Pyx_INCREF(__pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_slice__5);
-    PyTuple_SET_ITEM(__pyx_t_10, 2, __pyx_slice__5);
+    __Pyx_INCREF(__pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_slice__7);
+    PyTuple_SET_ITEM(__pyx_t_10, 2, __pyx_slice__7);
     __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_tr_lyt_view, __pyx_t_10); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1111, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_tr_lyt_view, __pyx_t_10); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1209, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = PyTuple_New(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1111, __pyx_L1_error)
+    __pyx_t_10 = PyTuple_New(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1209, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __Pyx_INCREF(__pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_slice__5);
-    PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_slice__5);
+    __Pyx_INCREF(__pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_slice__7);
+    PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_slice__7);
     __Pyx_INCREF(__pyx_v_j);
     __Pyx_GIVEREF(__pyx_v_j);
     PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_v_j);
-    __Pyx_INCREF(__pyx_slice__5);
-    __Pyx_GIVEREF(__pyx_slice__5);
-    PyTuple_SET_ITEM(__pyx_t_10, 2, __pyx_slice__5);
-    __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_v_tr_lyt_view, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1111, __pyx_L1_error)
+    __Pyx_INCREF(__pyx_slice__7);
+    __Pyx_GIVEREF(__pyx_slice__7);
+    PyTuple_SET_ITEM(__pyx_t_10, 2, __pyx_slice__7);
+    __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_v_tr_lyt_view, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1209, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __pyx_t_10 = NULL;
     __pyx_t_8 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_10)) {
@@ -37535,178 +39718,178 @@
         __Pyx_DECREF_SET(__pyx_t_7, function);
         __pyx_t_8 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_7)) {
       PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_t_3, __pyx_t_6, __pyx_t_11};
-      __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1111, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1209, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_7)) {
       PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_t_3, __pyx_t_6, __pyx_t_11};
-      __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1111, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1209, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     } else
     #endif
     {
-      __pyx_t_12 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1111, __pyx_L1_error)
+      __pyx_t_12 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1209, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       if (__pyx_t_10) {
         __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_3);
       PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_8, __pyx_t_3);
       __Pyx_GIVEREF(__pyx_t_6);
       PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_8, __pyx_t_6);
       __Pyx_GIVEREF(__pyx_t_11);
       PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_8, __pyx_t_11);
       __pyx_t_3 = 0;
       __pyx_t_6 = 0;
       __pyx_t_11 = 0;
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_12, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1111, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_12, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1209, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     }
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "statmoments/_native.pyx":1110
+    /* "statmoments/_native.pyx":1208
  *     # Step 1: Create trace layout matrix up to moment degree
  *     tr_lyt_view[:, 0, :] = traces
  *     for j in range(1, moment):             # <<<<<<<<<<<<<<
  *       np.multiply(tr_lyt_view[:, 0, :], tr_lyt_view[:, j - 1, :], tr_lyt_view[:, j, :])
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":1114
+  /* "statmoments/_native.pyx":1212
  * 
  *     # Step 2: Create classifier layout matrix
  *     _cl_layout = np.empty((len(classifiers), len(classifiers[0]) + 1), dtype=self._layout.dtype)             # <<<<<<<<<<<<<<
  *     cl_lyt = _cl_layout[:batch_cnt]
  *     cl_lyt[:, 0] = 1
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1114, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1212, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1114, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1212, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_2 = PyObject_Length(__pyx_v_classifiers); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1114, __pyx_L1_error)
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1114, __pyx_L1_error)
+  __pyx_t_2 = PyObject_Length(__pyx_v_classifiers); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1212, __pyx_L1_error)
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1212, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_classifiers, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1114, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_classifiers, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1212, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_2 = PyObject_Length(__pyx_t_7); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1114, __pyx_L1_error)
+  __pyx_t_2 = PyObject_Length(__pyx_t_7); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1212, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = PyInt_FromSsize_t((__pyx_t_2 + 1)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1114, __pyx_L1_error)
+  __pyx_t_7 = PyInt_FromSsize_t((__pyx_t_2 + 1)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1212, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_12 = PyTuple_New(2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1114, __pyx_L1_error)
+  __pyx_t_12 = PyTuple_New(2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1212, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_7);
   PyTuple_SET_ITEM(__pyx_t_12, 1, __pyx_t_7);
   __pyx_t_1 = 0;
   __pyx_t_7 = 0;
-  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1114, __pyx_L1_error)
+  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1212, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_12);
   PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_12);
   __pyx_t_12 = 0;
-  __pyx_t_12 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1114, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1212, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_layout); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1114, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_layout); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1212, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_dtype); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1114, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_dtype); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1212, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_s_dtype, __pyx_t_11) < 0) __PYX_ERR(0, 1114, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_s_dtype, __pyx_t_11) < 0) __PYX_ERR(0, 1212, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_7, __pyx_t_12); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1114, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_7, __pyx_t_12); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1212, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
   __pyx_v__cl_layout = __pyx_t_11;
   __pyx_t_11 = 0;
 
-  /* "statmoments/_native.pyx":1115
+  /* "statmoments/_native.pyx":1213
  *     # Step 2: Create classifier layout matrix
  *     _cl_layout = np.empty((len(classifiers), len(classifiers[0]) + 1), dtype=self._layout.dtype)
  *     cl_lyt = _cl_layout[:batch_cnt]             # <<<<<<<<<<<<<<
  *     cl_lyt[:, 0] = 1
  *     cl_lyt_view = cl_lyt[:, 1:]
  */
-  __pyx_t_11 = __Pyx_PyObject_GetSlice(__pyx_v__cl_layout, 0, 0, NULL, &__pyx_v_batch_cnt, NULL, 0, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1115, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_GetSlice(__pyx_v__cl_layout, 0, 0, NULL, &__pyx_v_batch_cnt, NULL, 0, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1213, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __pyx_v_cl_lyt = __pyx_t_11;
   __pyx_t_11 = 0;
 
-  /* "statmoments/_native.pyx":1116
+  /* "statmoments/_native.pyx":1214
  *     _cl_layout = np.empty((len(classifiers), len(classifiers[0]) + 1), dtype=self._layout.dtype)
  *     cl_lyt = _cl_layout[:batch_cnt]
  *     cl_lyt[:, 0] = 1             # <<<<<<<<<<<<<<
  *     cl_lyt_view = cl_lyt[:, 1:]
  *     cl_lyt_view[:] = classifiers
  */
-  if (unlikely(PyObject_SetItem(__pyx_v_cl_lyt, __pyx_tuple__16, __pyx_int_1) < 0)) __PYX_ERR(0, 1116, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_cl_lyt, __pyx_tuple__18, __pyx_int_1) < 0)) __PYX_ERR(0, 1214, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":1117
+  /* "statmoments/_native.pyx":1215
  *     cl_lyt = _cl_layout[:batch_cnt]
  *     cl_lyt[:, 0] = 1
  *     cl_lyt_view = cl_lyt[:, 1:]             # <<<<<<<<<<<<<<
  *     cl_lyt_view[:] = classifiers
  * 
  */
-  __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_v_cl_lyt, __pyx_tuple__18); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1117, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_v_cl_lyt, __pyx_tuple__20); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1215, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __pyx_v_cl_lyt_view = __pyx_t_11;
   __pyx_t_11 = 0;
 
-  /* "statmoments/_native.pyx":1118
+  /* "statmoments/_native.pyx":1216
  *     cl_lyt[:, 0] = 1
  *     cl_lyt_view = cl_lyt[:, 1:]
  *     cl_lyt_view[:] = classifiers             # <<<<<<<<<<<<<<
  * 
  *     # Step 3: Multiply and accumulate
  */
-  if (__Pyx_PyObject_SetSlice(__pyx_v_cl_lyt_view, __pyx_v_classifiers, 0, 0, NULL, NULL, &__pyx_slice__5, 0, 0, 0) < 0) __PYX_ERR(0, 1118, __pyx_L1_error)
+  if (__Pyx_PyObject_SetSlice(__pyx_v_cl_lyt_view, __pyx_v_classifiers, 0, 0, NULL, NULL, &__pyx_slice__7, 0, 0, 0) < 0) __PYX_ERR(0, 1216, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":1121
+  /* "statmoments/_native.pyx":1219
  * 
  *     # Step 3: Multiply and accumulate
  *     dgemm(tr_lyt, cl_lyt, self._accs.reshape((cl_lyt.shape[1], -1)), b'N', b'T')             # <<<<<<<<<<<<<<
  * 
- * class univar_sum_detrend(univar_sum):
+ * 
  */
-  __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_v_tr_lyt, PyBUF_WRITABLE); if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 1121, __pyx_L1_error)
-  __pyx_t_14 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_v_cl_lyt, PyBUF_WRITABLE); if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 1121, __pyx_L1_error)
-  __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1121, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_v_tr_lyt, PyBUF_WRITABLE); if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 1219, __pyx_L1_error)
+  __pyx_t_14 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_v_cl_lyt, PyBUF_WRITABLE); if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 1219, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_accs); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1219, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_reshape); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1121, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_reshape); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1219, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-  __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_cl_lyt, __pyx_n_s_shape); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1121, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_cl_lyt, __pyx_n_s_shape); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1219, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_12, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1121, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_12, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1219, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-  __pyx_t_12 = PyTuple_New(2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1121, __pyx_L1_error)
+  __pyx_t_12 = PyTuple_New(2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1219, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_5);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
   PyTuple_SET_ITEM(__pyx_t_12, 1, __pyx_int_neg_1);
   __pyx_t_5 = 0;
@@ -37719,18 +39902,18 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_7, function);
     }
   }
   __pyx_t_11 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_5, __pyx_t_12) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_12);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-  if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1121, __pyx_L1_error)
+  if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1219, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_15 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_11, PyBUF_WRITABLE); if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 1121, __pyx_L1_error)
+  __pyx_t_15 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_11, PyBUF_WRITABLE); if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 1219, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   __pyx_t_16.__pyx_n = 2;
   __pyx_t_16.transa = 'N';
   __pyx_t_16.transb = 'T';
   __pyx_f_11statmoments_7_native_dgemm(__pyx_t_13, __pyx_t_14, __pyx_t_15, &__pyx_t_16); 
   __PYX_XDEC_MEMVIEW(&__pyx_t_13, 1);
   __pyx_t_13.memview = NULL;
@@ -37738,15 +39921,15 @@
   __PYX_XDEC_MEMVIEW(&__pyx_t_14, 1);
   __pyx_t_14.memview = NULL;
   __pyx_t_14.data = NULL;
   __PYX_XDEC_MEMVIEW(&__pyx_t_15, 1);
   __pyx_t_15.memview = NULL;
   __pyx_t_15.data = NULL;
 
-  /* "statmoments/_native.pyx":1095
+  /* "statmoments/_native.pyx":1193
  *       yield self._retm[:, moments]
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     moment, batch_cnt = self.moment, len(traces)
  *     tr_len, cl_len = self.trace_len, self.classifiers_len
  */
 
@@ -37779,15 +39962,15 @@
   __Pyx_XDECREF(__pyx_v_cl_lyt);
   __Pyx_XDECREF(__pyx_v_cl_lyt_view);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":1124
+/* "statmoments/_native.pyx":1223
  * 
  * class univar_sum_detrend(univar_sum):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  *     self._dbuf = np.zeros((1, self.trace_len), dtype=self._dtype)[1:]
  */
 
@@ -37828,40 +40011,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_trace_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 1); __PYX_ERR(0, 1124, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 1); __PYX_ERR(0, 1223, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifier_len)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 2); __PYX_ERR(0, 1124, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, 2); __PYX_ERR(0, 1223, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 1124, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 1223, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_trace_len = values[1];
     __pyx_v_classifier_len = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1124, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1223, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
   __Pyx_AddTraceback("statmoments._native.univar_sum_detrend.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_18univar_sum_detrend___init__(__pyx_self, __pyx_v_self, __pyx_v_trace_len, __pyx_v_classifier_len, __pyx_v_kwargs);
@@ -37881,159 +40064,159 @@
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "statmoments/_native.pyx":1125
+  /* "statmoments/_native.pyx":1224
  * class univar_sum_detrend(univar_sum):
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, **kwargs)             # <<<<<<<<<<<<<<
  *     self._dbuf = np.zeros((1, self.trace_len), dtype=self._dtype)[1:]
- *     self._cbuf = np.asarray([bytearray(b'2') * classifier_len], dtype=np.uint8)[1:] # 2 is non existing element
+ *     self._cbuf = np.asarray([bytearray(b'2') * classifier_len], dtype=np.uint8)[1:]  # 2 is non existing element
  */
   __pyx_t_1 = __Pyx_CyFunction_GetClassObj(__pyx_self);
-  if (!__pyx_t_1) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 1125, __pyx_L1_error) }
+  if (!__pyx_t_1) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 1224, __pyx_L1_error) }
   __Pyx_INCREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1125, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1224, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __Pyx_INCREF(__pyx_v_self);
   __Pyx_GIVEREF(__pyx_v_self);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_self);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1125, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1224, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_init); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1125, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_init); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1224, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1125, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1224, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_trace_len);
   __Pyx_GIVEREF(__pyx_v_trace_len);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_trace_len);
   __Pyx_INCREF(__pyx_v_classifier_len);
   __Pyx_GIVEREF(__pyx_v_classifier_len);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_classifier_len);
-  __pyx_t_3 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1125, __pyx_L1_error)
+  __pyx_t_3 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1224, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1125, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1224, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":1126
+  /* "statmoments/_native.pyx":1225
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, **kwargs)
  *     self._dbuf = np.zeros((1, self.trace_len), dtype=self._dtype)[1:]             # <<<<<<<<<<<<<<
- *     self._cbuf = np.asarray([bytearray(b'2') * classifier_len], dtype=np.uint8)[1:] # 2 is non existing element
+ *     self._cbuf = np.asarray([bytearray(b'2') * classifier_len], dtype=np.uint8)[1:]  # 2 is non existing element
  *     self._detrend_cnt = kwargs.pop('detrend_cnt', 10)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1126, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1225, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1126, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1225, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1126, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_trace_len); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1225, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1126, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1225, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_int_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1126, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1225, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1126, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1225, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1126, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1225, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 1126, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 1225, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1126, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1225, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_t_2, 1, 0, NULL, NULL, &__pyx_slice__17, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1126, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_t_2, 1, 0, NULL, NULL, &__pyx_slice__19, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1225, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_dbuf, __pyx_t_1) < 0) __PYX_ERR(0, 1126, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_dbuf, __pyx_t_1) < 0) __PYX_ERR(0, 1225, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":1127
+  /* "statmoments/_native.pyx":1226
  *     super().__init__(trace_len, classifier_len, **kwargs)
  *     self._dbuf = np.zeros((1, self.trace_len), dtype=self._dtype)[1:]
- *     self._cbuf = np.asarray([bytearray(b'2') * classifier_len], dtype=np.uint8)[1:] # 2 is non existing element             # <<<<<<<<<<<<<<
+ *     self._cbuf = np.asarray([bytearray(b'2') * classifier_len], dtype=np.uint8)[1:]  # 2 is non existing element             # <<<<<<<<<<<<<<
  *     self._detrend_cnt = kwargs.pop('detrend_cnt', 10)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1127, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1226, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_asarray); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1127, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_asarray); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1226, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)(&PyByteArray_Type)), __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1127, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)(&PyByteArray_Type)), __pyx_tuple__27, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1226, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_v_classifier_len); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1127, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_v_classifier_len); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1226, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1127, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1226, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1127, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1226, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1127, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1226, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1127, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1226, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1127, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1226, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1127, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1226, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1127, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1226, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_t_5, 1, 0, NULL, NULL, &__pyx_slice__17, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1127, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_t_5, 1, 0, NULL, NULL, &__pyx_slice__19, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1226, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_cbuf, __pyx_t_1) < 0) __PYX_ERR(0, 1127, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_cbuf, __pyx_t_1) < 0) __PYX_ERR(0, 1226, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":1128
+  /* "statmoments/_native.pyx":1227
  *     self._dbuf = np.zeros((1, self.trace_len), dtype=self._dtype)[1:]
- *     self._cbuf = np.asarray([bytearray(b'2') * classifier_len], dtype=np.uint8)[1:] # 2 is non existing element
+ *     self._cbuf = np.asarray([bytearray(b'2') * classifier_len], dtype=np.uint8)[1:]  # 2 is non existing element
  *     self._detrend_cnt = kwargs.pop('detrend_cnt', 10)             # <<<<<<<<<<<<<<
  * 
  *   def update(self, traces, classifiers):
  */
-  __pyx_t_1 = __Pyx_PyDict_Pop(__pyx_v_kwargs, __pyx_n_u_detrend_cnt, __pyx_int_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1128, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_Pop(__pyx_v_kwargs, __pyx_n_u_detrend_cnt, __pyx_int_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1227, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2, __pyx_t_1) < 0) __PYX_ERR(0, 1128, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2, __pyx_t_1) < 0) __PYX_ERR(0, 1227, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":1124
+  /* "statmoments/_native.pyx":1223
  * 
  * class univar_sum_detrend(univar_sum):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  *     self._dbuf = np.zeros((1, self.trace_len), dtype=self._dtype)[1:]
  */
 
@@ -38050,15 +40233,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":1130
+/* "statmoments/_native.pyx":1229
  *     self._detrend_cnt = kwargs.pop('detrend_cnt', 10)
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     tr_copy = np.asarray(traces, dtype=self._dtype)
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  */
 
@@ -38096,40 +40279,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_traces)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 1); __PYX_ERR(0, 1130, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 1); __PYX_ERR(0, 1229, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_classifiers)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 2); __PYX_ERR(0, 1130, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, 2); __PYX_ERR(0, 1229, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update") < 0)) __PYX_ERR(0, 1130, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update") < 0)) __PYX_ERR(0, 1229, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_traces = values[1];
     __pyx_v_classifiers = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1130, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("update", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1229, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native.univar_sum_detrend.update", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_18univar_sum_detrend_2update(__pyx_self, __pyx_v_self, __pyx_v_traces, __pyx_v_classifiers);
 
@@ -38154,139 +40337,139 @@
   Py_ssize_t __pyx_t_7;
   int __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("update", 0);
 
-  /* "statmoments/_native.pyx":1131
+  /* "statmoments/_native.pyx":1230
  * 
  *   def update(self, traces, classifiers):
  *     tr_copy = np.asarray(traces, dtype=self._dtype)             # <<<<<<<<<<<<<<
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1131, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1230, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_asarray); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1131, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_asarray); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1230, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1131, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1230, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_traces);
   __Pyx_GIVEREF(__pyx_v_traces);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_traces);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1131, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1230, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1131, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dtype_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1230, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 1131, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 1230, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1131, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1230, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_tr_copy = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":1132
+  /* "statmoments/_native.pyx":1231
  *   def update(self, traces, classifiers):
  *     tr_copy = np.asarray(traces, dtype=self._dtype)
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)             # <<<<<<<<<<<<<<
  * 
  *     if self._detrend_cnt > 0:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1132, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1231, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_asarray); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1132, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_asarray); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1231, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1132, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1231, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_v_classifiers);
   __Pyx_GIVEREF(__pyx_v_classifiers);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_classifiers);
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1132, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1231, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1132, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1231, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1132, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1231, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1132, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1231, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1132, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1231, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_cl_copy = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":1134
+  /* "statmoments/_native.pyx":1233
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  * 
  *     if self._detrend_cnt > 0:             # <<<<<<<<<<<<<<
  *       db_part = tr_copy[:self._detrend_cnt]
  *       cl_part = cl_copy[:self._detrend_cnt]
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1134, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1233, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = PyObject_RichCompare(__pyx_t_5, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1134, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(__pyx_t_5, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1233, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1134, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1233, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_6) {
 
-    /* "statmoments/_native.pyx":1135
+    /* "statmoments/_native.pyx":1234
  * 
  *     if self._detrend_cnt > 0:
  *       db_part = tr_copy[:self._detrend_cnt]             # <<<<<<<<<<<<<<
  *       cl_part = cl_copy[:self._detrend_cnt]
  *       self._dbuf = np.vstack((self._dbuf, db_part))
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1135, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1234, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_v_tr_copy, 0, 0, NULL, &__pyx_t_1, NULL, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1135, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_v_tr_copy, 0, 0, NULL, &__pyx_t_1, NULL, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1234, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_v_db_part = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "statmoments/_native.pyx":1136
+    /* "statmoments/_native.pyx":1235
  *     if self._detrend_cnt > 0:
  *       db_part = tr_copy[:self._detrend_cnt]
  *       cl_part = cl_copy[:self._detrend_cnt]             # <<<<<<<<<<<<<<
  *       self._dbuf = np.vstack((self._dbuf, db_part))
  *       self._cbuf = np.vstack((self._cbuf, cl_part))
  */
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1136, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1235, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_cl_copy, 0, 0, NULL, &__pyx_t_5, NULL, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1136, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_cl_copy, 0, 0, NULL, &__pyx_t_5, NULL, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1235, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_v_cl_part = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":1137
+    /* "statmoments/_native.pyx":1236
  *       db_part = tr_copy[:self._detrend_cnt]
  *       cl_part = cl_copy[:self._detrend_cnt]
  *       self._dbuf = np.vstack((self._dbuf, db_part))             # <<<<<<<<<<<<<<
  *       self._cbuf = np.vstack((self._cbuf, cl_part))
  *       self._detrend_cnt -= len(db_part)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1137, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1236, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_vstack); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1137, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_vstack); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1236, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1137, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1236, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1137, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1236, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
     __Pyx_INCREF(__pyx_v_db_part);
     __Pyx_GIVEREF(__pyx_v_db_part);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_db_part);
     __pyx_t_5 = 0;
@@ -38299,35 +40482,35 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1137, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1236, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_dbuf, __pyx_t_1) < 0) __PYX_ERR(0, 1137, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_dbuf, __pyx_t_1) < 0) __PYX_ERR(0, 1236, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":1138
+    /* "statmoments/_native.pyx":1237
  *       cl_part = cl_copy[:self._detrend_cnt]
  *       self._dbuf = np.vstack((self._dbuf, db_part))
  *       self._cbuf = np.vstack((self._cbuf, cl_part))             # <<<<<<<<<<<<<<
  *       self._detrend_cnt -= len(db_part)
  *       if self._detrend_cnt > 0:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1138, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1237, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_vstack); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1138, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_vstack); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1237, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cbuf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1138, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cbuf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1237, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1138, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1237, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
     __Pyx_INCREF(__pyx_v_cl_part);
     __Pyx_GIVEREF(__pyx_v_cl_part);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_cl_part);
     __pyx_t_4 = 0;
@@ -38340,108 +40523,108 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1138, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1237, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_cbuf, __pyx_t_1) < 0) __PYX_ERR(0, 1138, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_cbuf, __pyx_t_1) < 0) __PYX_ERR(0, 1237, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":1139
+    /* "statmoments/_native.pyx":1238
  *       self._dbuf = np.vstack((self._dbuf, db_part))
  *       self._cbuf = np.vstack((self._cbuf, cl_part))
  *       self._detrend_cnt -= len(db_part)             # <<<<<<<<<<<<<<
  *       if self._detrend_cnt > 0:
- *         return # Not enough input data for detrending
+ *         return  # Not enough input data for detrending
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1139, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1238, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = PyObject_Length(__pyx_v_db_part); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1139, __pyx_L1_error)
-    __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1139, __pyx_L1_error)
+    __pyx_t_7 = PyObject_Length(__pyx_v_db_part); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1238, __pyx_L1_error)
+    __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1238, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_5 = PyNumber_InPlaceSubtract(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1139, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_InPlaceSubtract(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1238, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2, __pyx_t_5) < 0) __PYX_ERR(0, 1139, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2, __pyx_t_5) < 0) __PYX_ERR(0, 1238, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "statmoments/_native.pyx":1140
+    /* "statmoments/_native.pyx":1239
  *       self._cbuf = np.vstack((self._cbuf, cl_part))
  *       self._detrend_cnt -= len(db_part)
  *       if self._detrend_cnt > 0:             # <<<<<<<<<<<<<<
- *         return # Not enough input data for detrending
+ *         return  # Not enough input data for detrending
  *       if self._detrend_cnt == 0:
  */
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1140, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1239, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = PyObject_RichCompare(__pyx_t_5, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1140, __pyx_L1_error)
+    __pyx_t_3 = PyObject_RichCompare(__pyx_t_5, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1239, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1140, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1239, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_6) {
 
-      /* "statmoments/_native.pyx":1141
+      /* "statmoments/_native.pyx":1240
  *       self._detrend_cnt -= len(db_part)
  *       if self._detrend_cnt > 0:
- *         return # Not enough input data for detrending             # <<<<<<<<<<<<<<
+ *         return  # Not enough input data for detrending             # <<<<<<<<<<<<<<
  *       if self._detrend_cnt == 0:
  *         tr_copy = np.vstack((self._dbuf, tr_copy[len(db_part):]))
  */
       __Pyx_XDECREF(__pyx_r);
       __pyx_r = Py_None; __Pyx_INCREF(Py_None);
       goto __pyx_L0;
 
-      /* "statmoments/_native.pyx":1140
+      /* "statmoments/_native.pyx":1239
  *       self._cbuf = np.vstack((self._cbuf, cl_part))
  *       self._detrend_cnt -= len(db_part)
  *       if self._detrend_cnt > 0:             # <<<<<<<<<<<<<<
- *         return # Not enough input data for detrending
+ *         return  # Not enough input data for detrending
  *       if self._detrend_cnt == 0:
  */
     }
 
-    /* "statmoments/_native.pyx":1142
+    /* "statmoments/_native.pyx":1241
  *       if self._detrend_cnt > 0:
- *         return # Not enough input data for detrending
+ *         return  # Not enough input data for detrending
  *       if self._detrend_cnt == 0:             # <<<<<<<<<<<<<<
  *         tr_copy = np.vstack((self._dbuf, tr_copy[len(db_part):]))
  *         cl_copy = np.vstack((self._cbuf, cl_copy[len(cl_part):]))
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1142, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_detrend_cnt_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1241, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_t_3, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1142, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_t_3, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1241, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1142, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1241, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     if (__pyx_t_6) {
 
-      /* "statmoments/_native.pyx":1143
- *         return # Not enough input data for detrending
+      /* "statmoments/_native.pyx":1242
+ *         return  # Not enough input data for detrending
  *       if self._detrend_cnt == 0:
  *         tr_copy = np.vstack((self._dbuf, tr_copy[len(db_part):]))             # <<<<<<<<<<<<<<
  *         cl_copy = np.vstack((self._cbuf, cl_copy[len(cl_part):]))
  *         self._dbuf = np.mean(self._dbuf, axis=0)
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1143, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1242, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_vstack); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1143, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_vstack); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1242, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1143, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1242, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_7 = PyObject_Length(__pyx_v_db_part); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1143, __pyx_L1_error)
-      __pyx_t_4 = __Pyx_PyObject_GetSlice(__pyx_v_tr_copy, __pyx_t_7, 0, NULL, NULL, NULL, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1143, __pyx_L1_error)
+      __pyx_t_7 = PyObject_Length(__pyx_v_db_part); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1242, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetSlice(__pyx_v_tr_copy, __pyx_t_7, 0, NULL, NULL, NULL, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1242, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1143, __pyx_L1_error)
+      __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1242, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_GIVEREF(__pyx_t_3);
       PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
       __Pyx_GIVEREF(__pyx_t_4);
       PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_4);
       __pyx_t_3 = 0;
       __pyx_t_4 = 0;
@@ -38454,38 +40637,38 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
       __pyx_t_5 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_2);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1143, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1242, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF_SET(__pyx_v_tr_copy, __pyx_t_5);
       __pyx_t_5 = 0;
 
-      /* "statmoments/_native.pyx":1144
+      /* "statmoments/_native.pyx":1243
  *       if self._detrend_cnt == 0:
  *         tr_copy = np.vstack((self._dbuf, tr_copy[len(db_part):]))
  *         cl_copy = np.vstack((self._cbuf, cl_copy[len(cl_part):]))             # <<<<<<<<<<<<<<
  *         self._dbuf = np.mean(self._dbuf, axis=0)
  *         self._cbuf = None
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1144, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1243, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_vstack); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1144, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_vstack); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1243, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cbuf); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1144, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_cbuf); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1243, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_7 = PyObject_Length(__pyx_v_cl_part); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1144, __pyx_L1_error)
-      __pyx_t_4 = __Pyx_PyObject_GetSlice(__pyx_v_cl_copy, __pyx_t_7, 0, NULL, NULL, NULL, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1144, __pyx_L1_error)
+      __pyx_t_7 = PyObject_Length(__pyx_v_cl_part); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1243, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetSlice(__pyx_v_cl_copy, __pyx_t_7, 0, NULL, NULL, NULL, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1243, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1144, __pyx_L1_error)
+      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1243, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_GIVEREF(__pyx_t_1);
       PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
       __Pyx_GIVEREF(__pyx_t_4);
       PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
       __pyx_t_1 = 0;
       __pyx_t_4 = 0;
@@ -38498,104 +40681,104 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_2, function);
         }
       }
       __pyx_t_5 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1144, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1243, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF_SET(__pyx_v_cl_copy, __pyx_t_5);
       __pyx_t_5 = 0;
 
-      /* "statmoments/_native.pyx":1145
+      /* "statmoments/_native.pyx":1244
  *         tr_copy = np.vstack((self._dbuf, tr_copy[len(db_part):]))
  *         cl_copy = np.vstack((self._cbuf, cl_copy[len(cl_part):]))
  *         self._dbuf = np.mean(self._dbuf, axis=0)             # <<<<<<<<<<<<<<
  *         self._cbuf = None
- *     super().update(tr_copy-self._dbuf, cl_copy)
+ *     super().update(tr_copy - self._dbuf, cl_copy)
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1145, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1244, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_mean); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1145, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_mean); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1244, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1145, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1244, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1145, __pyx_L1_error)
+      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1244, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_GIVEREF(__pyx_t_5);
       PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
       __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1145, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1244, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 1145, __pyx_L1_error)
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1145, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 1244, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1244, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_dbuf, __pyx_t_4) < 0) __PYX_ERR(0, 1145, __pyx_L1_error)
+      if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_dbuf, __pyx_t_4) < 0) __PYX_ERR(0, 1244, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "statmoments/_native.pyx":1146
+      /* "statmoments/_native.pyx":1245
  *         cl_copy = np.vstack((self._cbuf, cl_copy[len(cl_part):]))
  *         self._dbuf = np.mean(self._dbuf, axis=0)
  *         self._cbuf = None             # <<<<<<<<<<<<<<
- *     super().update(tr_copy-self._dbuf, cl_copy)
+ *     super().update(tr_copy - self._dbuf, cl_copy)
  * 
  */
-      if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_cbuf, Py_None) < 0) __PYX_ERR(0, 1146, __pyx_L1_error)
+      if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_cbuf, Py_None) < 0) __PYX_ERR(0, 1245, __pyx_L1_error)
 
-      /* "statmoments/_native.pyx":1142
+      /* "statmoments/_native.pyx":1241
  *       if self._detrend_cnt > 0:
- *         return # Not enough input data for detrending
+ *         return  # Not enough input data for detrending
  *       if self._detrend_cnt == 0:             # <<<<<<<<<<<<<<
  *         tr_copy = np.vstack((self._dbuf, tr_copy[len(db_part):]))
  *         cl_copy = np.vstack((self._cbuf, cl_copy[len(cl_part):]))
  */
     }
 
-    /* "statmoments/_native.pyx":1134
+    /* "statmoments/_native.pyx":1233
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  * 
  *     if self._detrend_cnt > 0:             # <<<<<<<<<<<<<<
  *       db_part = tr_copy[:self._detrend_cnt]
  *       cl_part = cl_copy[:self._detrend_cnt]
  */
   }
 
-  /* "statmoments/_native.pyx":1147
+  /* "statmoments/_native.pyx":1246
  *         self._dbuf = np.mean(self._dbuf, axis=0)
  *         self._cbuf = None
- *     super().update(tr_copy-self._dbuf, cl_copy)             # <<<<<<<<<<<<<<
+ *     super().update(tr_copy - self._dbuf, cl_copy)             # <<<<<<<<<<<<<<
  * 
  *   def _moments(self, moments, normalize):
  */
   __pyx_t_5 = __Pyx_CyFunction_GetClassObj(__pyx_self);
-  if (!__pyx_t_5) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 1147, __pyx_L1_error) }
+  if (!__pyx_t_5) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 1246, __pyx_L1_error) }
   __Pyx_INCREF(__pyx_t_5);
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1147, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1246, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
   __Pyx_INCREF(__pyx_v_self);
   __Pyx_GIVEREF(__pyx_v_self);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_self);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1147, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1246, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_update); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1147, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_update); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1246, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1147, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1246, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_2 = PyNumber_Subtract(__pyx_v_tr_copy, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1147, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Subtract(__pyx_v_tr_copy, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1246, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   __pyx_t_8 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
@@ -38605,49 +40788,49 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_8 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_2, __pyx_v_cl_copy};
-    __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1147, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1246, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_2, __pyx_v_cl_copy};
-    __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1147, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1246, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else
   #endif
   {
-    __pyx_t_1 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1147, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1246, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     if (__pyx_t_5) {
       __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5); __pyx_t_5 = NULL;
     }
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_8, __pyx_t_2);
     __Pyx_INCREF(__pyx_v_cl_copy);
     __Pyx_GIVEREF(__pyx_v_cl_copy);
     PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_8, __pyx_v_cl_copy);
     __pyx_t_2 = 0;
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1147, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1246, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":1130
+  /* "statmoments/_native.pyx":1229
  *     self._detrend_cnt = kwargs.pop('detrend_cnt', 10)
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     tr_copy = np.asarray(traces, dtype=self._dtype)
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  */
 
@@ -38669,16 +40852,16 @@
   __Pyx_XDECREF(__pyx_v_cl_part);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static PyObject *__pyx_gb_11statmoments_7_native_18univar_sum_detrend_6generator11(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "statmoments/_native.pyx":1149
- *     super().update(tr_copy-self._dbuf, cl_copy)
+/* "statmoments/_native.pyx":1248
+ *     super().update(tr_copy - self._dbuf, cl_copy)
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     m1idx = [i for i, m in enumerate(moments) if m == 1]
  *     has_m1 = len(m1idx) != 0
  */
 
 /* Python wrapper */
@@ -38715,40 +40898,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_moments)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 1); __PYX_ERR(0, 1149, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 1); __PYX_ERR(0, 1248, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_normalize)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 2); __PYX_ERR(0, 1149, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, 2); __PYX_ERR(0, 1248, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_moments") < 0)) __PYX_ERR(0, 1149, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_moments") < 0)) __PYX_ERR(0, 1248, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_moments = values[1];
     __pyx_v_normalize = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1149, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_moments", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1248, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native.univar_sum_detrend._moments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11statmoments_7_native_18univar_sum_detrend_4_moments(__pyx_self, __pyx_v_self, __pyx_v_moments, __pyx_v_normalize);
 
@@ -38765,29 +40948,29 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_moments", 0);
   __pyx_cur_scope = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_22__moments *)__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_22__moments(__pyx_ptype_11statmoments_7_native___pyx_scope_struct_22__moments, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_22__moments *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 1149, __pyx_L1_error)
+    __PYX_ERR(0, 1248, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
   __pyx_cur_scope->__pyx_v_moments = __pyx_v_moments;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_moments);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_moments);
   __pyx_cur_scope->__pyx_v_normalize = __pyx_v_normalize;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_normalize);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_normalize);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_18univar_sum_detrend_6generator11, __pyx_codeobj__44, (PyObject *) __pyx_cur_scope, __pyx_n_s_moments_2, __pyx_n_s_univar_sum_detrend__moments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 1149, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11statmoments_7_native_18univar_sum_detrend_6generator11, __pyx_codeobj__43, (PyObject *) __pyx_cur_scope, __pyx_n_s_moments_2, __pyx_n_s_univar_sum_detrend__moments, __pyx_n_s_statmoments__native); if (unlikely(!gen)) __PYX_ERR(0, 1248, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     gen->classobj = __Pyx_CyFunction_GetClassObj(__pyx_self);
     __Pyx_INCREF(gen->classobj);
     __Pyx_GIVEREF(gen->classobj);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
@@ -38810,145 +40993,163 @@
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   Py_ssize_t __pyx_t_4;
   PyObject *(*__pyx_t_5)(PyObject *);
   PyObject *__pyx_t_6 = NULL;
   int __pyx_t_7;
   int __pyx_t_8;
-  PyObject *__pyx_t_9 = NULL;
+  int __pyx_t_9;
+  PyObject *__pyx_t_10 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("_moments", 0);
   switch (__pyx_generator->resume_label) {
     case 0: goto __pyx_L3_first_run;
-    case 1: goto __pyx_L10_resume_from_yield;
+    case 1: goto __pyx_L12_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 1149, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 1248, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":1150
+  /* "statmoments/_native.pyx":1249
  * 
  *   def _moments(self, moments, normalize):
  *     m1idx = [i for i, m in enumerate(moments) if m == 1]             # <<<<<<<<<<<<<<
  *     has_m1 = len(m1idx) != 0
- *     for res in super()._moments(moments, normalize):
+ *     dbuf_nonempty = len(self._dbuf) != 0
  */
   { /* enter inner scope */
-    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1150, __pyx_L1_error)
+    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1249, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_int_0);
     __pyx_t_2 = __pyx_int_0;
     if (likely(PyList_CheckExact(__pyx_cur_scope->__pyx_v_moments)) || PyTuple_CheckExact(__pyx_cur_scope->__pyx_v_moments)) {
       __pyx_t_3 = __pyx_cur_scope->__pyx_v_moments; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
       __pyx_t_5 = NULL;
     } else {
-      __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1150, __pyx_L1_error)
+      __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_cur_scope->__pyx_v_moments); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1249, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1150, __pyx_L1_error)
+      __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1249, __pyx_L1_error)
     }
     for (;;) {
       if (likely(!__pyx_t_5)) {
         if (likely(PyList_CheckExact(__pyx_t_3))) {
           if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_6 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_6); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1150, __pyx_L1_error)
+          __pyx_t_6 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_6); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1249, __pyx_L1_error)
           #else
-          __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1150, __pyx_L1_error)
+          __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1249, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           #endif
         } else {
           if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_6); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1150, __pyx_L1_error)
+          __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_6); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1249, __pyx_L1_error)
           #else
-          __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1150, __pyx_L1_error)
+          __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1249, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           #endif
         }
       } else {
         __pyx_t_6 = __pyx_t_5(__pyx_t_3);
         if (unlikely(!__pyx_t_6)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 1150, __pyx_L1_error)
+            else __PYX_ERR(0, 1249, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_6);
       }
-      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_9genexpr15__pyx_v_m);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_9genexpr15__pyx_v_m, __pyx_t_6);
+      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_9genexpr16__pyx_v_m);
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_9genexpr16__pyx_v_m, __pyx_t_6);
       __Pyx_GIVEREF(__pyx_t_6);
       __pyx_t_6 = 0;
       __Pyx_INCREF(__pyx_t_2);
-      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_9genexpr15__pyx_v_i);
-      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_9genexpr15__pyx_v_i, __pyx_t_2);
+      __Pyx_XGOTREF(__pyx_cur_scope->__pyx_9genexpr16__pyx_v_i);
+      __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_9genexpr16__pyx_v_i, __pyx_t_2);
       __Pyx_GIVEREF(__pyx_t_2);
-      __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1150, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1249, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_2);
       __pyx_t_2 = __pyx_t_6;
       __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyInt_EqObjC(__pyx_cur_scope->__pyx_9genexpr15__pyx_v_m, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1150, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_EqObjC(__pyx_cur_scope->__pyx_9genexpr16__pyx_v_m, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1249, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1150, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1249, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       if (__pyx_t_7) {
-        if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_cur_scope->__pyx_9genexpr15__pyx_v_i))) __PYX_ERR(0, 1150, __pyx_L1_error)
+        if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_cur_scope->__pyx_9genexpr16__pyx_v_i))) __PYX_ERR(0, 1249, __pyx_L1_error)
       }
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } /* exit inner scope */
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v_m1idx = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":1151
+  /* "statmoments/_native.pyx":1250
  *   def _moments(self, moments, normalize):
  *     m1idx = [i for i, m in enumerate(moments) if m == 1]
  *     has_m1 = len(m1idx) != 0             # <<<<<<<<<<<<<<
+ *     dbuf_nonempty = len(self._dbuf) != 0
  *     for res in super()._moments(moments, normalize):
- *       if has_m1:
  */
-  __pyx_t_4 = PyList_GET_SIZE(__pyx_cur_scope->__pyx_v_m1idx); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1151, __pyx_L1_error)
-  __pyx_t_1 = __Pyx_PyBool_FromLong((__pyx_t_4 != 0)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1151, __pyx_L1_error)
+  __pyx_t_4 = PyList_GET_SIZE(__pyx_cur_scope->__pyx_v_m1idx); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1250, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyBool_FromLong((__pyx_t_4 != 0)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1250, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v_has_m1 = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":1152
+  /* "statmoments/_native.pyx":1251
  *     m1idx = [i for i, m in enumerate(moments) if m == 1]
  *     has_m1 = len(m1idx) != 0
+ *     dbuf_nonempty = len(self._dbuf) != 0             # <<<<<<<<<<<<<<
+ *     for res in super()._moments(moments, normalize):
+ *       if has_m1 and dbuf_nonempty:
+ */
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1251, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_4 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1251, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyBool_FromLong((__pyx_t_4 != 0)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1251, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_cur_scope->__pyx_v_dbuf_nonempty = __pyx_t_1;
+  __pyx_t_1 = 0;
+
+  /* "statmoments/_native.pyx":1252
+ *     has_m1 = len(m1idx) != 0
+ *     dbuf_nonempty = len(self._dbuf) != 0
  *     for res in super()._moments(moments, normalize):             # <<<<<<<<<<<<<<
- *       if has_m1:
+ *       if has_m1 and dbuf_nonempty:
  *         # Restore offset if mean requested
  */
   __pyx_t_2 =  __pyx_generator->classobj;
-  if (!__pyx_t_2) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 1152, __pyx_L1_error) }
+  if (!__pyx_t_2) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 1252, __pyx_L1_error) }
   __Pyx_INCREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1152, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1252, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_cur_scope->__pyx_v_self);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1152, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1252, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_moments_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1152, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_moments_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1252, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_8 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
@@ -38958,214 +41159,222 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_8 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_cur_scope->__pyx_v_moments, __pyx_cur_scope->__pyx_v_normalize};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1152, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1252, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_cur_scope->__pyx_v_moments, __pyx_cur_scope->__pyx_v_normalize};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1152, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1252, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   {
-    __pyx_t_6 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1152, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1252, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     if (__pyx_t_2) {
       __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_2); __pyx_t_2 = NULL;
     }
     __Pyx_INCREF(__pyx_cur_scope->__pyx_v_moments);
     __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_moments);
     PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_8, __pyx_cur_scope->__pyx_v_moments);
     __Pyx_INCREF(__pyx_cur_scope->__pyx_v_normalize);
     __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_normalize);
     PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_8, __pyx_cur_scope->__pyx_v_normalize);
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1152, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1252, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
     __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
     __pyx_t_5 = NULL;
   } else {
-    __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1152, __pyx_L1_error)
+    __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1252, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1152, __pyx_L1_error)
+    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1252, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_5)) {
       if (likely(PyList_CheckExact(__pyx_t_3))) {
         if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1152, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1252, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1152, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1252, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1152, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1252, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1152, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1252, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
       __pyx_t_1 = __pyx_t_5(__pyx_t_3);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 1152, __pyx_L1_error)
+          else __PYX_ERR(0, 1252, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_res);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_res, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":1153
- *     has_m1 = len(m1idx) != 0
+    /* "statmoments/_native.pyx":1253
+ *     dbuf_nonempty = len(self._dbuf) != 0
  *     for res in super()._moments(moments, normalize):
- *       if has_m1:             # <<<<<<<<<<<<<<
+ *       if has_m1 and dbuf_nonempty:             # <<<<<<<<<<<<<<
  *         # Restore offset if mean requested
  *         res[:, m1idx] += self._dbuf
  */
-    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_has_m1); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1153, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_has_m1); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1253, __pyx_L1_error)
+    if (__pyx_t_9) {
+    } else {
+      __pyx_t_7 = __pyx_t_9;
+      goto __pyx_L10_bool_binop_done;
+    }
+    __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_dbuf_nonempty); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1253, __pyx_L1_error)
+    __pyx_t_7 = __pyx_t_9;
+    __pyx_L10_bool_binop_done:;
     if (__pyx_t_7) {
 
-      /* "statmoments/_native.pyx":1155
- *       if has_m1:
+      /* "statmoments/_native.pyx":1255
+ *       if has_m1 and dbuf_nonempty:
  *         # Restore offset if mean requested
  *         res[:, m1idx] += self._dbuf             # <<<<<<<<<<<<<<
  *       yield res
  * 
  */
-      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1155, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1255, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_INCREF(__pyx_slice__5);
-      __Pyx_GIVEREF(__pyx_slice__5);
-      PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_slice__5);
+      __Pyx_INCREF(__pyx_slice__7);
+      __Pyx_GIVEREF(__pyx_slice__7);
+      PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_slice__7);
       __Pyx_INCREF(__pyx_cur_scope->__pyx_v_m1idx);
       __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_m1idx);
       PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_cur_scope->__pyx_v_m1idx);
-      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_res, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1155, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_cur_scope->__pyx_v_res, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1255, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1155, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_dbuf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1255, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_9 = PyNumber_InPlaceAdd(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1155, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_9);
+      __pyx_t_10 = PyNumber_InPlaceAdd(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1255, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_res, __pyx_t_1, __pyx_t_9) < 0)) __PYX_ERR(0, 1155, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+      if (unlikely(PyObject_SetItem(__pyx_cur_scope->__pyx_v_res, __pyx_t_1, __pyx_t_10) < 0)) __PYX_ERR(0, 1255, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "statmoments/_native.pyx":1153
- *     has_m1 = len(m1idx) != 0
+      /* "statmoments/_native.pyx":1253
+ *     dbuf_nonempty = len(self._dbuf) != 0
  *     for res in super()._moments(moments, normalize):
- *       if has_m1:             # <<<<<<<<<<<<<<
+ *       if has_m1 and dbuf_nonempty:             # <<<<<<<<<<<<<<
  *         # Restore offset if mean requested
  *         res[:, m1idx] += self._dbuf
  */
     }
 
-    /* "statmoments/_native.pyx":1156
+    /* "statmoments/_native.pyx":1256
  *         # Restore offset if mean requested
  *         res[:, m1idx] += self._dbuf
  *       yield res             # <<<<<<<<<<<<<<
  * 
- * ################################ STAT TESTS ##################################
+ * 
  */
     __Pyx_INCREF(__pyx_cur_scope->__pyx_v_res);
     __pyx_r = __pyx_cur_scope->__pyx_v_res;
     __Pyx_XGIVEREF(__pyx_t_3);
     __pyx_cur_scope->__pyx_t_0 = __pyx_t_3;
     __pyx_cur_scope->__pyx_t_1 = __pyx_t_4;
     __pyx_cur_scope->__pyx_t_2 = __pyx_t_5;
     __Pyx_XGIVEREF(__pyx_r);
     __Pyx_RefNannyFinishContext();
     __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
     /* return from generator, yielding value */
     __pyx_generator->resume_label = 1;
     return __pyx_r;
-    __pyx_L10_resume_from_yield:;
+    __pyx_L12_resume_from_yield:;
     __pyx_t_3 = __pyx_cur_scope->__pyx_t_0;
     __pyx_cur_scope->__pyx_t_0 = 0;
     __Pyx_XGOTREF(__pyx_t_3);
     __pyx_t_4 = __pyx_cur_scope->__pyx_t_1;
     __pyx_t_5 = __pyx_cur_scope->__pyx_t_2;
-    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 1156, __pyx_L1_error)
+    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 1256, __pyx_L1_error)
 
-    /* "statmoments/_native.pyx":1152
- *     m1idx = [i for i, m in enumerate(moments) if m == 1]
+    /* "statmoments/_native.pyx":1252
  *     has_m1 = len(m1idx) != 0
+ *     dbuf_nonempty = len(self._dbuf) != 0
  *     for res in super()._moments(moments, normalize):             # <<<<<<<<<<<<<<
- *       if has_m1:
+ *       if has_m1 and dbuf_nonempty:
  *         # Restore offset if mean requested
  */
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
-  /* "statmoments/_native.pyx":1149
- *     super().update(tr_copy-self._dbuf, cl_copy)
+  /* "statmoments/_native.pyx":1248
+ *     super().update(tr_copy - self._dbuf, cl_copy)
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     m1idx = [i for i, m in enumerate(moments) if m == 1]
  *     has_m1 = len(m1idx) != 0
  */
 
   /* function exit code */
   PyErr_SetNone(PyExc_StopIteration);
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_6);
-  __Pyx_XDECREF(__pyx_t_9);
+  __Pyx_XDECREF(__pyx_t_10);
   __Pyx_AddTraceback("_moments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_r); __pyx_r = 0;
   #if !CYTHON_USE_EXC_INFO_STACK
   __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":1163
+/* "statmoments/_native.pyx":1264
  * #@cython.returns('double[:, ::1]')
  * #@cython.locals(M = 'double[:, ::1]', m='int')
  * def _preprocvar(M, m, variance=None):             # <<<<<<<<<<<<<<
  *   if m > 2:
  *     M[1][:] = (M[1] - M[0] ** 2) / variance
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11statmoments_7_native_17_preprocvar(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_11statmoments_7_native_17_preprocvar = {"_preprocvar", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_17_preprocvar, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11statmoments_7_native_17_preprocvar(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_11statmoments_7_native_19_preprocvar(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_11statmoments_7_native_19_preprocvar = {"_preprocvar", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_19_preprocvar, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11statmoments_7_native_19_preprocvar(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_M = 0;
   PyObject *__pyx_v_m = 0;
   PyObject *__pyx_v_variance = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
@@ -39193,25 +41402,25 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_M)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_preprocvar", 0, 2, 3, 1); __PYX_ERR(0, 1163, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_preprocvar", 0, 2, 3, 1); __PYX_ERR(0, 1264, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_variance);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_preprocvar") < 0)) __PYX_ERR(0, 1163, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_preprocvar") < 0)) __PYX_ERR(0, 1264, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
@@ -39221,197 +41430,197 @@
     }
     __pyx_v_M = values[0];
     __pyx_v_m = values[1];
     __pyx_v_variance = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_preprocvar", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1163, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_preprocvar", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1264, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native._preprocvar", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11statmoments_7_native_16_preprocvar(__pyx_self, __pyx_v_M, __pyx_v_m, __pyx_v_variance);
+  __pyx_r = __pyx_pf_11statmoments_7_native_18_preprocvar(__pyx_self, __pyx_v_M, __pyx_v_m, __pyx_v_variance);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11statmoments_7_native_16_preprocvar(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_M, PyObject *__pyx_v_m, PyObject *__pyx_v_variance) {
+static PyObject *__pyx_pf_11statmoments_7_native_18_preprocvar(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_M, PyObject *__pyx_v_m, PyObject *__pyx_v_variance) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_preprocvar", 0);
 
-  /* "statmoments/_native.pyx":1164
+  /* "statmoments/_native.pyx":1265
  * #@cython.locals(M = 'double[:, ::1]', m='int')
  * def _preprocvar(M, m, variance=None):
  *   if m > 2:             # <<<<<<<<<<<<<<
  *     M[1][:] = (M[1] - M[0] ** 2) / variance
  *     M[0][:] = M[0] / np.sqrt(variance)
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_m, __pyx_int_2, Py_GT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1164, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1164, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_m, __pyx_int_2, Py_GT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1265, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1265, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "statmoments/_native.pyx":1165
+    /* "statmoments/_native.pyx":1266
  * def _preprocvar(M, m, variance=None):
  *   if m > 2:
  *     M[1][:] = (M[1] - M[0] ** 2) / variance             # <<<<<<<<<<<<<<
  *     M[0][:] = M[0] / np.sqrt(variance)
  *   elif m == 2:
  */
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_M, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1165, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_M, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1266, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_M, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1165, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_M, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1266, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyNumber_Power(__pyx_t_3, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1165, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Power(__pyx_t_3, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1266, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1165, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1266, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_v_variance); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1165, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_v_variance); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1266, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_M, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1165, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_M, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1266, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    if (__Pyx_PyObject_SetSlice(__pyx_t_3, __pyx_t_4, 0, 0, NULL, NULL, &__pyx_slice__5, 0, 0, 0) < 0) __PYX_ERR(0, 1165, __pyx_L1_error)
+    if (__Pyx_PyObject_SetSlice(__pyx_t_3, __pyx_t_4, 0, 0, NULL, NULL, &__pyx_slice__7, 0, 0, 0) < 0) __PYX_ERR(0, 1266, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "statmoments/_native.pyx":1166
+    /* "statmoments/_native.pyx":1267
  *   if m > 2:
  *     M[1][:] = (M[1] - M[0] ** 2) / variance
  *     M[0][:] = M[0] / np.sqrt(variance)             # <<<<<<<<<<<<<<
  *   elif m == 2:
- *     M[1] = M[1] - M[0]**2
+ *     M[1] = M[1] - M[0] ** 2
  */
-    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_M, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1166, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_M, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1267, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1166, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1267, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1166, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1267, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_1 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_3 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_1, __pyx_v_variance) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_variance);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1166, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1267, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyNumber_Divide(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1166, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyNumber_Divide(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1267, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_M, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1166, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_M, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1267, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    if (__Pyx_PyObject_SetSlice(__pyx_t_3, __pyx_t_5, 0, 0, NULL, NULL, &__pyx_slice__5, 0, 0, 0) < 0) __PYX_ERR(0, 1166, __pyx_L1_error)
+    if (__Pyx_PyObject_SetSlice(__pyx_t_3, __pyx_t_5, 0, 0, NULL, NULL, &__pyx_slice__7, 0, 0, 0) < 0) __PYX_ERR(0, 1267, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "statmoments/_native.pyx":1164
+    /* "statmoments/_native.pyx":1265
  * #@cython.locals(M = 'double[:, ::1]', m='int')
  * def _preprocvar(M, m, variance=None):
  *   if m > 2:             # <<<<<<<<<<<<<<
  *     M[1][:] = (M[1] - M[0] ** 2) / variance
  *     M[0][:] = M[0] / np.sqrt(variance)
  */
     goto __pyx_L3;
   }
 
-  /* "statmoments/_native.pyx":1167
+  /* "statmoments/_native.pyx":1268
  *     M[1][:] = (M[1] - M[0] ** 2) / variance
  *     M[0][:] = M[0] / np.sqrt(variance)
  *   elif m == 2:             # <<<<<<<<<<<<<<
- *     M[1] = M[1] - M[0]**2
+ *     M[1] = M[1] - M[0] ** 2
  *     M[0] = M[0]
  */
-  __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_v_m, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1167, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_v_m, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1268, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1167, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1268, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   if (__pyx_t_2) {
 
-    /* "statmoments/_native.pyx":1168
+    /* "statmoments/_native.pyx":1269
  *     M[0][:] = M[0] / np.sqrt(variance)
  *   elif m == 2:
- *     M[1] = M[1] - M[0]**2             # <<<<<<<<<<<<<<
+ *     M[1] = M[1] - M[0] ** 2             # <<<<<<<<<<<<<<
  *     M[0] = M[0]
  * 
  */
-    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_M, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1168, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_M, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1269, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_M, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1168, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_M, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1269, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyNumber_Power(__pyx_t_3, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1168, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Power(__pyx_t_3, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1269, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Subtract(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1168, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Subtract(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1269, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(__Pyx_SetItemInt(__pyx_v_M, 1, __pyx_t_3, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) < 0)) __PYX_ERR(0, 1168, __pyx_L1_error)
+    if (unlikely(__Pyx_SetItemInt(__pyx_v_M, 1, __pyx_t_3, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) < 0)) __PYX_ERR(0, 1269, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "statmoments/_native.pyx":1169
+    /* "statmoments/_native.pyx":1270
  *   elif m == 2:
- *     M[1] = M[1] - M[0]**2
+ *     M[1] = M[1] - M[0] ** 2
  *     M[0] = M[0]             # <<<<<<<<<<<<<<
  * 
  *   # Do nothing for m == 1
  */
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_M, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1169, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_M, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1270, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    if (unlikely(__Pyx_SetItemInt(__pyx_v_M, 0, __pyx_t_3, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) < 0)) __PYX_ERR(0, 1169, __pyx_L1_error)
+    if (unlikely(__Pyx_SetItemInt(__pyx_v_M, 0, __pyx_t_3, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) < 0)) __PYX_ERR(0, 1270, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "statmoments/_native.pyx":1167
+    /* "statmoments/_native.pyx":1268
  *     M[1][:] = (M[1] - M[0] ** 2) / variance
  *     M[0][:] = M[0] / np.sqrt(variance)
  *   elif m == 2:             # <<<<<<<<<<<<<<
- *     M[1] = M[1] - M[0]**2
+ *     M[1] = M[1] - M[0] ** 2
  *     M[0] = M[0]
  */
   }
   __pyx_L3:;
 
-  /* "statmoments/_native.pyx":1172
+  /* "statmoments/_native.pyx":1273
  * 
  *   # Do nothing for m == 1
  *   return M             # <<<<<<<<<<<<<<
  * 
- * 
+ * @cython.cfunc
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_M);
   __pyx_r = __pyx_v_M;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":1163
+  /* "statmoments/_native.pyx":1264
  * #@cython.returns('double[:, ::1]')
  * #@cython.locals(M = 'double[:, ::1]', m='int')
  * def _preprocvar(M, m, variance=None):             # <<<<<<<<<<<<<<
  *   if m > 2:
  *     M[1][:] = (M[1] - M[0] ** 2) / variance
  */
 
@@ -39425,17 +41634,17 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":1178
+/* "statmoments/_native.pyx":1278
  * @cython.returns('double[::1]')
- * @cython.locals(n0 = cython.int, n1 = cython.int, m0 = 'double[::1]', m1 = 'double[::1]', v0 = 'double[::1]', v1 = 'double[::1]')
+ * @cython.locals(n0=cython.int, n1=cython.int, m0='double[::1]', m1='double[::1]', v0='double[::1]', v1='double[::1]')
  * def _ttest_ne(n0, n1, m0, m1, v0, v1):             # <<<<<<<<<<<<<<
  *   """ Non-equal vars """
  *   # This function modifies the buffers of given data
  */
 
 static __Pyx_memviewslice __pyx_f_11statmoments_7_native__ttest_ne(int __pyx_v_n0, int __pyx_v_n1, __Pyx_memviewslice __pyx_v_m0, __Pyx_memviewslice __pyx_v_m1, __Pyx_memviewslice __pyx_v_v0, __Pyx_memviewslice __pyx_v_v1) {
   __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
@@ -39448,91 +41657,91 @@
   PyObject *__pyx_t_6 = NULL;
   __Pyx_memviewslice __pyx_t_7 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_ttest_ne", 0);
 
-  /* "statmoments/_native.pyx":1185
+  /* "statmoments/_native.pyx":1285
  *   # 0.8-1% of CM time for ttest order 2
  *   # Divide to (n-1) to compensate division to n in finding CMs
  *   daxpy(m1, m0, -1.0)             # <<<<<<<<<<<<<<
  *   dscal(1.0 / (n0 - 1), v0)
  *   daxpy(v1, v0, 1.0 / (n1 - 1))
  */
   __pyx_t_1.__pyx_n = 1;
   __pyx_t_1.da = -1.0;
   __pyx_f_11statmoments_7_native_daxpy(__pyx_v_m1, __pyx_v_m0, &__pyx_t_1); 
 
-  /* "statmoments/_native.pyx":1186
+  /* "statmoments/_native.pyx":1286
  *   # Divide to (n-1) to compensate division to n in finding CMs
  *   daxpy(m1, m0, -1.0)
  *   dscal(1.0 / (n0 - 1), v0)             # <<<<<<<<<<<<<<
  *   daxpy(v1, v0, 1.0 / (n1 - 1))
  *   return m0 / np.sqrt(v0)
  */
   __pyx_f_11statmoments_7_native_dscal((1.0 / ((double)(__pyx_v_n0 - 1))), __pyx_v_v0);
 
-  /* "statmoments/_native.pyx":1187
+  /* "statmoments/_native.pyx":1287
  *   daxpy(m1, m0, -1.0)
  *   dscal(1.0 / (n0 - 1), v0)
  *   daxpy(v1, v0, 1.0 / (n1 - 1))             # <<<<<<<<<<<<<<
  *   return m0 / np.sqrt(v0)
  * 
  */
   __pyx_t_1.__pyx_n = 1;
   __pyx_t_1.da = (1.0 / ((double)(__pyx_v_n1 - 1)));
   __pyx_f_11statmoments_7_native_daxpy(__pyx_v_v1, __pyx_v_v0, &__pyx_t_1); 
 
-  /* "statmoments/_native.pyx":1188
+  /* "statmoments/_native.pyx":1288
  *   dscal(1.0 / (n0 - 1), v0)
  *   daxpy(v1, v0, 1.0 / (n1 - 1))
  *   return m0 / np.sqrt(v0)             # <<<<<<<<<<<<<<
  * 
  * @cython.cfunc
  */
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_m0, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1188, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_m0, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1188, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1188, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_v0, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1188, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_v0, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1188, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyNumber_Divide(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1188, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyNumber_Divide(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_5, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1188, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_5, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1288, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_r = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":1178
+  /* "statmoments/_native.pyx":1278
  * @cython.returns('double[::1]')
- * @cython.locals(n0 = cython.int, n1 = cython.int, m0 = 'double[::1]', m1 = 'double[::1]', v0 = 'double[::1]', v1 = 'double[::1]')
+ * @cython.locals(n0=cython.int, n1=cython.int, m0='double[::1]', m1='double[::1]', v0='double[::1]', v1='double[::1]')
  * def _ttest_ne(n0, n1, m0, m1, v0, v1):             # <<<<<<<<<<<<<<
  *   """ Non-equal vars """
  *   # This function modifies the buffers of given data
  */
 
   /* function exit code */
   __pyx_L1_error:;
@@ -39551,15 +41760,15 @@
     PyErr_SetString(PyExc_TypeError, "Memoryview return value is not initialized");
   }
   __pyx_L2:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":1192
+/* "statmoments/_native.pyx":1292
  * @cython.cfunc
  * #@cython.locals(n0 = cython.int, n1 = cython.int, m0 = 'double[::1]', m1 = 'double[::1]', v0 = 'double[::1]', v1 = 'double[::1]')
  * def _ttest_eq(n0, n1, m0, m1, v0, v1):             # <<<<<<<<<<<<<<
  *   """ Equal vars """
  *   # This function modifies the buffers of given data
  */
 
@@ -39575,136 +41784,136 @@
   struct __pyx_opt_args_11statmoments_7_native_daxpy __pyx_t_6;
   double __pyx_t_7;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_ttest_eq", 0);
 
-  /* "statmoments/_native.pyx":1195
+  /* "statmoments/_native.pyx":1295
  *   """ Equal vars """
  *   # This function modifies the buffers of given data
  *   denom = (1.0 / n0 + 1.0 / n1) / (n0 + n1 - 2.0)             # <<<<<<<<<<<<<<
  *   daxpy(m1, m0, -1.0)
  *   dscal(n0 * denom, v0)
  */
-  __pyx_t_1 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_v_n0, 1.0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1195, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_v_n0, 1.0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1295, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_v_n1, 1.0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1195, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_0, __pyx_v_n1, 1.0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1295, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1195, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1295, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyNumber_Add(__pyx_v_n0, __pyx_v_n1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1195, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Add(__pyx_v_n0, __pyx_v_n1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1295, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyFloat_SubtractObjC(__pyx_t_2, __pyx_float_2_0, 2.0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1195, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyFloat_SubtractObjC(__pyx_t_2, __pyx_float_2_0, 2.0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1295, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1195, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1295, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_denom = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":1196
+  /* "statmoments/_native.pyx":1296
  *   # This function modifies the buffers of given data
  *   denom = (1.0 / n0 + 1.0 / n1) / (n0 + n1 - 2.0)
  *   daxpy(m1, m0, -1.0)             # <<<<<<<<<<<<<<
  *   dscal(n0 * denom, v0)
  *   daxpy(v1, v0, n1 * denom)
  */
-  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_v_m1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 1196, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_v_m0, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1196, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_v_m1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 1296, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_v_m0, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1296, __pyx_L1_error)
   __pyx_t_6.__pyx_n = 1;
   __pyx_t_6.da = -1.0;
   __pyx_f_11statmoments_7_native_daxpy(__pyx_t_4, __pyx_t_5, &__pyx_t_6); 
   __PYX_XDEC_MEMVIEW(&__pyx_t_4, 1);
   __pyx_t_4.memview = NULL;
   __pyx_t_4.data = NULL;
   __PYX_XDEC_MEMVIEW(&__pyx_t_5, 1);
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "statmoments/_native.pyx":1197
+  /* "statmoments/_native.pyx":1297
  *   denom = (1.0 / n0 + 1.0 / n1) / (n0 + n1 - 2.0)
  *   daxpy(m1, m0, -1.0)
  *   dscal(n0 * denom, v0)             # <<<<<<<<<<<<<<
  *   daxpy(v1, v0, n1 * denom)
  *   return m0 / np.sqrt(v0)
  */
-  __pyx_t_2 = PyNumber_Multiply(__pyx_v_n0, __pyx_v_denom); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1197, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_v_n0, __pyx_v_denom); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_7 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_7 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1197, __pyx_L1_error)
+  __pyx_t_7 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_7 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1297, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_v_v0, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1197, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_v_v0, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1297, __pyx_L1_error)
   __pyx_f_11statmoments_7_native_dscal(__pyx_t_7, __pyx_t_5);
   __PYX_XDEC_MEMVIEW(&__pyx_t_5, 1);
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "statmoments/_native.pyx":1198
+  /* "statmoments/_native.pyx":1298
  *   daxpy(m1, m0, -1.0)
  *   dscal(n0 * denom, v0)
  *   daxpy(v1, v0, n1 * denom)             # <<<<<<<<<<<<<<
  *   return m0 / np.sqrt(v0)
  * 
  */
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_v_v1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1198, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_v_v0, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 1198, __pyx_L1_error)
-  __pyx_t_2 = PyNumber_Multiply(__pyx_v_n1, __pyx_v_denom); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1198, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_v_v1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1298, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_v_v0, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 1298, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_v_n1, __pyx_v_denom); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1298, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_7 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_7 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1198, __pyx_L1_error)
+  __pyx_t_7 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_7 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1298, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_6.__pyx_n = 1;
   __pyx_t_6.da = __pyx_t_7;
   __pyx_f_11statmoments_7_native_daxpy(__pyx_t_5, __pyx_t_4, &__pyx_t_6); 
   __PYX_XDEC_MEMVIEW(&__pyx_t_5, 1);
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
   __PYX_XDEC_MEMVIEW(&__pyx_t_4, 1);
   __pyx_t_4.memview = NULL;
   __pyx_t_4.data = NULL;
 
-  /* "statmoments/_native.pyx":1199
+  /* "statmoments/_native.pyx":1299
  *   dscal(n0 * denom, v0)
  *   daxpy(v1, v0, n1 * denom)
  *   return m0 / np.sqrt(v0)             # <<<<<<<<<<<<<<
  * 
  * def ttest(n0, n1, m10, m11, m20, m21, veq):
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1199, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1299, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1199, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1299, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_1)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_1);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_2 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_v_v0) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_v0);
   __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1199, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1299, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_v_m0, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1199, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_v_m0, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1299, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":1192
+  /* "statmoments/_native.pyx":1292
  * @cython.cfunc
  * #@cython.locals(n0 = cython.int, n1 = cython.int, m0 = 'double[::1]', m1 = 'double[::1]', v0 = 'double[::1]', v1 = 'double[::1]')
  * def _ttest_eq(n0, n1, m0, m1, v0, v1):             # <<<<<<<<<<<<<<
  *   """ Equal vars """
  *   # This function modifies the buffers of given data
  */
 
@@ -39720,27 +41929,27 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_denom);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "statmoments/_native.pyx":1201
+/* "statmoments/_native.pyx":1301
  *   return m0 / np.sqrt(v0)
  * 
  * def ttest(n0, n1, m10, m11, m20, m21, veq):             # <<<<<<<<<<<<<<
  *   """Compute t-test"""
  * 
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11statmoments_7_native_19ttest(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_11statmoments_7_native_18ttest[] = "Compute t-test";
-static PyMethodDef __pyx_mdef_11statmoments_7_native_19ttest = {"ttest", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_19ttest, METH_VARARGS|METH_KEYWORDS, __pyx_doc_11statmoments_7_native_18ttest};
-static PyObject *__pyx_pw_11statmoments_7_native_19ttest(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_11statmoments_7_native_21ttest(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_11statmoments_7_native_20ttest[] = "Compute t-test";
+static PyMethodDef __pyx_mdef_11statmoments_7_native_21ttest = {"ttest", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11statmoments_7_native_21ttest, METH_VARARGS|METH_KEYWORDS, __pyx_doc_11statmoments_7_native_20ttest};
+static PyObject *__pyx_pw_11statmoments_7_native_21ttest(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_n0 = 0;
   PyObject *__pyx_v_n1 = 0;
   PyObject *__pyx_v_m10 = 0;
   PyObject *__pyx_v_m11 = 0;
   PyObject *__pyx_v_m20 = 0;
   PyObject *__pyx_v_m21 = 0;
   PyObject *__pyx_v_veq = 0;
@@ -39779,49 +41988,49 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_n0)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_n1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ttest", 1, 7, 7, 1); __PYX_ERR(0, 1201, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ttest", 1, 7, 7, 1); __PYX_ERR(0, 1301, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m10)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ttest", 1, 7, 7, 2); __PYX_ERR(0, 1201, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ttest", 1, 7, 7, 2); __PYX_ERR(0, 1301, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m11)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ttest", 1, 7, 7, 3); __PYX_ERR(0, 1201, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ttest", 1, 7, 7, 3); __PYX_ERR(0, 1301, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m20)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ttest", 1, 7, 7, 4); __PYX_ERR(0, 1201, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ttest", 1, 7, 7, 4); __PYX_ERR(0, 1301, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_m21)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ttest", 1, 7, 7, 5); __PYX_ERR(0, 1201, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ttest", 1, 7, 7, 5); __PYX_ERR(0, 1301, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_veq)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ttest", 1, 7, 7, 6); __PYX_ERR(0, 1201, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ttest", 1, 7, 7, 6); __PYX_ERR(0, 1301, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ttest") < 0)) __PYX_ERR(0, 1201, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ttest") < 0)) __PYX_ERR(0, 1301, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 7) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -39836,28 +42045,28 @@
     __pyx_v_m11 = values[3];
     __pyx_v_m20 = values[4];
     __pyx_v_m21 = values[5];
     __pyx_v_veq = values[6];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("ttest", 1, 7, 7, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1201, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("ttest", 1, 7, 7, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1301, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("statmoments._native.ttest", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11statmoments_7_native_18ttest(__pyx_self, __pyx_v_n0, __pyx_v_n1, __pyx_v_m10, __pyx_v_m11, __pyx_v_m20, __pyx_v_m21, __pyx_v_veq);
+  __pyx_r = __pyx_pf_11statmoments_7_native_20ttest(__pyx_self, __pyx_v_n0, __pyx_v_n1, __pyx_v_m10, __pyx_v_m11, __pyx_v_m20, __pyx_v_m21, __pyx_v_veq);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11statmoments_7_native_18ttest(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_n0, PyObject *__pyx_v_n1, PyObject *__pyx_v_m10, PyObject *__pyx_v_m11, PyObject *__pyx_v_m20, PyObject *__pyx_v_m21, PyObject *__pyx_v_veq) {
+static PyObject *__pyx_pf_11statmoments_7_native_20ttest(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_n0, PyObject *__pyx_v_n1, PyObject *__pyx_v_m10, PyObject *__pyx_v_m11, PyObject *__pyx_v_m20, PyObject *__pyx_v_m21, PyObject *__pyx_v_veq) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_t_2;
   int __pyx_t_3;
   int __pyx_t_4;
   __Pyx_memviewslice __pyx_t_5 = { 0, 0, { 0 }, { 0 }, { 0 } };
@@ -39867,59 +42076,59 @@
   __Pyx_memviewslice __pyx_t_9 = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_t_10 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("ttest", 0);
 
-  /* "statmoments/_native.pyx":1204
+  /* "statmoments/_native.pyx":1304
  *   """Compute t-test"""
  * 
  *   return _ttest_ne(n0, n1, m10, m11, m20, m21) if not veq else _ttest_eq(n0, n1, m10, m11, m20, m21)             # <<<<<<<<<<<<<<
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_veq); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1204, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_veq); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1304, __pyx_L1_error)
   if (((!__pyx_t_2) != 0)) {
-    __pyx_t_3 = __Pyx_PyInt_As_int(__pyx_v_n0); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1204, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyInt_As_int(__pyx_v_n1); if (unlikely((__pyx_t_4 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1204, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_v_m10, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1204, __pyx_L1_error)
-    __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_v_m11, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1204, __pyx_L1_error)
-    __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_v_m20, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1204, __pyx_L1_error)
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_v_m21, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1204, __pyx_L1_error)
-    __pyx_t_9 = __pyx_f_11statmoments_7_native__ttest_ne(__pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1204, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_As_int(__pyx_v_n0); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1304, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_As_int(__pyx_v_n1); if (unlikely((__pyx_t_4 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1304, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_v_m10, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1304, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_v_m11, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1304, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_v_m20, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1304, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_v_m21, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1304, __pyx_L1_error)
+    __pyx_t_9 = __pyx_f_11statmoments_7_native__ttest_ne(__pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1304, __pyx_L1_error)
     __PYX_XDEC_MEMVIEW(&__pyx_t_5, 1);
     __pyx_t_5.memview = NULL;
     __pyx_t_5.data = NULL;
     __PYX_XDEC_MEMVIEW(&__pyx_t_6, 1);
     __pyx_t_6.memview = NULL;
     __pyx_t_6.data = NULL;
     __PYX_XDEC_MEMVIEW(&__pyx_t_7, 1);
     __pyx_t_7.memview = NULL;
     __pyx_t_7.data = NULL;
     __PYX_XDEC_MEMVIEW(&__pyx_t_8, 1);
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
-    __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1204, __pyx_L1_error)
+    __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1304, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __PYX_XDEC_MEMVIEW(&__pyx_t_9, 1);
     __pyx_t_9.memview = NULL;
     __pyx_t_9.data = NULL;
     __pyx_t_1 = __pyx_t_10;
     __pyx_t_10 = 0;
   } else {
-    __pyx_t_10 = __pyx_f_11statmoments_7_native__ttest_eq(__pyx_v_n0, __pyx_v_n1, __pyx_v_m10, __pyx_v_m11, __pyx_v_m20, __pyx_v_m21); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1204, __pyx_L1_error)
+    __pyx_t_10 = __pyx_f_11statmoments_7_native__ttest_eq(__pyx_v_n0, __pyx_v_n1, __pyx_v_m10, __pyx_v_m11, __pyx_v_m20, __pyx_v_m21); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1304, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __pyx_t_1 = __pyx_t_10;
     __pyx_t_10 = 0;
   }
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "statmoments/_native.pyx":1201
+  /* "statmoments/_native.pyx":1301
  *   return m0 / np.sqrt(v0)
  * 
  * def ttest(n0, n1, m10, m11, m20, m21, veq):             # <<<<<<<<<<<<<<
  *   """Compute t-test"""
  * 
  */
 
@@ -40139,15 +42348,15 @@
     /* "View.MemoryView":134
  * 
  *         if not self.ndim:
  *             raise ValueError("Empty shape tuple for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if itemsize <= 0:
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__45, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 134, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__44, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 134, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(1, 134, __pyx_L1_error)
 
     /* "View.MemoryView":133
  *         self.itemsize = itemsize
@@ -40171,15 +42380,15 @@
     /* "View.MemoryView":137
  * 
  *         if itemsize <= 0:
  *             raise ValueError("itemsize <= 0 for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if not isinstance(format, bytes):
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__46, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 137, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__45, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 137, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(1, 137, __pyx_L1_error)
 
     /* "View.MemoryView":136
  *             raise ValueError("Empty shape tuple for cython.array")
@@ -40298,15 +42507,15 @@
     /* "View.MemoryView":149
  * 
  *         if not self._shape:
  *             raise MemoryError("unable to allocate shape and strides.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__47, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 149, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__46, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 149, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(1, 149, __pyx_L1_error)
 
     /* "View.MemoryView":148
  *         self._strides = self._shape + self.ndim
@@ -40572,15 +42781,15 @@
       /* "View.MemoryView":177
  *             self.data = <char *>malloc(self.len)
  *             if not self.data:
  *                 raise MemoryError("unable to allocate array data.")             # <<<<<<<<<<<<<<
  * 
  *             if self.dtype_is_object:
  */
-      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__48, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 177, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__47, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 177, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_Raise(__pyx_t_10, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __PYX_ERR(1, 177, __pyx_L1_error)
 
       /* "View.MemoryView":176
  * 
@@ -40816,15 +43025,15 @@
     /* "View.MemoryView":193
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         if not (flags & bufmode):
  *             raise ValueError("Can only create a buffer that is contiguous in memory.")             # <<<<<<<<<<<<<<
  *         info.buf = self.data
  *         info.len = self.len
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__49, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 193, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__48, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 193, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(1, 193, __pyx_L1_error)
 
     /* "View.MemoryView":192
  *         elif self.mode == u"fortran":
@@ -41550,15 +43759,15 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__50, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__49, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(1, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
@@ -41606,15 +43815,15 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__51, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__50, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(1, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -43335,15 +45544,15 @@
     /* "View.MemoryView":420
  *     def __setitem__(memoryview self, object index, object value):
  *         if self.view.readonly:
  *             raise TypeError("Cannot assign to read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         have_slices, index = _unellipsify(index, self.view.ndim)
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__52, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 420, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__51, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 420, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __PYX_ERR(1, 420, __pyx_L1_error)
 
     /* "View.MemoryView":419
  * 
@@ -44383,15 +46592,15 @@
       /* "View.MemoryView":497
  *             result = struct.unpack(self.view.format, bytesitem)
  *         except struct.error:
  *             raise ValueError("Unable to convert item to object")             # <<<<<<<<<<<<<<
  *         else:
  *             if len(self.view.format) == 1:
  */
-      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__53, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 497, __pyx_L5_except_error)
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__52, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 497, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __PYX_ERR(1, 497, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
@@ -44745,15 +46954,15 @@
     /* "View.MemoryView":522
  *     def __getbuffer__(self, Py_buffer *info, int flags):
  *         if flags & PyBUF_WRITABLE and self.view.readonly:
  *             raise ValueError("Cannot create writable memory view from read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         if flags & PyBUF_ND:
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__54, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 522, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__53, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 522, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(1, 522, __pyx_L1_error)
 
     /* "View.MemoryView":521
  *     @cname('getbuffer')
@@ -45294,15 +47503,15 @@
     /* "View.MemoryView":572
  *         if self.view.strides == NULL:
  * 
  *             raise ValueError("Buffer view does not expose strides")             # <<<<<<<<<<<<<<
  * 
  *         return tuple([stride for stride in self.view.strides[:self.view.ndim]])
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__55, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 572, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__54, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 572, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __PYX_ERR(1, 572, __pyx_L1_error)
 
     /* "View.MemoryView":570
  *     @property
@@ -45411,15 +47620,15 @@
  *             return (-1,) * self.view.ndim             # <<<<<<<<<<<<<<
  * 
  *         return tuple([suboffset for suboffset in self.view.suboffsets[:self.view.ndim]])
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_self->view.ndim); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 579, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyNumber_Multiply(__pyx_tuple__56, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 579, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Multiply(__pyx_tuple__55, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 579, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L0;
 
     /* "View.MemoryView":578
@@ -46449,15 +48658,15 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__57, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__56, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(1, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
@@ -46505,15 +48714,15 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__58, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__57, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(1, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -46862,17 +49071,17 @@
  *             else:
  */
         __pyx_t_8 = PyObject_Length(__pyx_v_tup); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(1, 684, __pyx_L1_error)
         __pyx_t_7 = PyList_New(1 * ((((__pyx_v_ndim - __pyx_t_8) + 1)<0) ? 0:((__pyx_v_ndim - __pyx_t_8) + 1))); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 684, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         { Py_ssize_t __pyx_temp;
           for (__pyx_temp=0; __pyx_temp < ((__pyx_v_ndim - __pyx_t_8) + 1); __pyx_temp++) {
-            __Pyx_INCREF(__pyx_slice__5);
-            __Pyx_GIVEREF(__pyx_slice__5);
-            PyList_SET_ITEM(__pyx_t_7, __pyx_temp, __pyx_slice__5);
+            __Pyx_INCREF(__pyx_slice__7);
+            __Pyx_GIVEREF(__pyx_slice__7);
+            PyList_SET_ITEM(__pyx_t_7, __pyx_temp, __pyx_slice__7);
           }
         }
         __pyx_t_9 = __Pyx_PyList_Extend(__pyx_v_result, __pyx_t_7); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(1, 684, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
         /* "View.MemoryView":685
  *             if not seen_ellipsis:
@@ -46897,15 +49106,15 @@
  *                 seen_ellipsis = True
  *             else:
  *                 result.append(slice(None))             # <<<<<<<<<<<<<<
  *             have_slices = True
  *         else:
  */
       /*else*/ {
-        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_result, __pyx_slice__5); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(1, 687, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_result, __pyx_slice__7); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(1, 687, __pyx_L1_error)
       }
       __pyx_L7:;
 
       /* "View.MemoryView":688
  *             else:
  *                 result.append(slice(None))
  *             have_slices = True             # <<<<<<<<<<<<<<
@@ -47037,17 +49246,17 @@
  * 
  *     return have_slices or nslices, tuple(result)
  */
     __pyx_t_3 = PyList_New(1 * ((__pyx_v_nslices<0) ? 0:__pyx_v_nslices)); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     { Py_ssize_t __pyx_temp;
       for (__pyx_temp=0; __pyx_temp < __pyx_v_nslices; __pyx_temp++) {
-        __Pyx_INCREF(__pyx_slice__5);
-        __Pyx_GIVEREF(__pyx_slice__5);
-        PyList_SET_ITEM(__pyx_t_3, __pyx_temp, __pyx_slice__5);
+        __Pyx_INCREF(__pyx_slice__7);
+        __Pyx_GIVEREF(__pyx_slice__7);
+        PyList_SET_ITEM(__pyx_t_3, __pyx_temp, __pyx_slice__7);
       }
     }
     __pyx_t_9 = __Pyx_PyList_Extend(__pyx_v_result, __pyx_t_3); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(1, 698, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
     /* "View.MemoryView":697
  * 
@@ -47166,15 +49375,15 @@
       /* "View.MemoryView":705
  *     for suboffset in suboffsets[:ndim]:
  *         if suboffset >= 0:
  *             raise ValueError("Indirect dimensions not supported")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__59, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 705, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__58, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 705, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_Raise(__pyx_t_5, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __PYX_ERR(1, 705, __pyx_L1_error)
 
       /* "View.MemoryView":704
  * cdef assert_direct_dimensions(Py_ssize_t *suboffsets, int ndim):
@@ -49350,15 +51559,15 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__60, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__59, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(1, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
@@ -49406,15 +51615,15 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__61, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__60, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(1, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -52683,15 +54892,15 @@
  *     cdef object __pyx_result
  *     if __pyx_checksum not in (0xb068931, 0x82a3537, 0x6ae9995):             # <<<<<<<<<<<<<<
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))" % __pyx_checksum)
  */
   __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v___pyx_checksum); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_t_1, __pyx_tuple__62, Py_NE)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_t_1, __pyx_tuple__61, Py_NE)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_3 = (__pyx_t_2 != 0);
   if (__pyx_t_3) {
 
     /* "(tree fragment)":5
  *     cdef object __pyx_result
  *     if __pyx_checksum not in (0xb068931, 0x82a3537, 0x6ae9995):
@@ -53232,29 +55441,33 @@
   }
   return o;
 }
 
 static void __pyx_tp_dealloc_11statmoments_7_native___pyx_scope_struct_2__moments(PyObject *o) {
   struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_2__moments *p = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_2__moments *)o;
   PyObject_GC_UnTrack(o);
+  Py_CLEAR(p->__pyx_v_acc);
   Py_CLEAR(p->__pyx_v_acc0);
   Py_CLEAR(p->__pyx_v_acc1);
   Py_CLEAR(p->__pyx_v_buf);
   Py_CLEAR(p->__pyx_v_cl_len);
   Py_CLEAR(p->__pyx_v_cm);
   Py_CLEAR(p->__pyx_v_cmi);
   Py_CLEAR(p->__pyx_v_i);
   Py_CLEAR(p->__pyx_v_ii);
   Py_CLEAR(p->__pyx_8genexpr1__pyx_v_m);
   Py_CLEAR(p->__pyx_v_ma);
   Py_CLEAR(p->__pyx_v_maxm);
+  Py_CLEAR(p->__pyx_v_min_cnt);
   Py_CLEAR(p->__pyx_v_moments);
   Py_CLEAR(p->__pyx_v_n0);
   Py_CLEAR(p->__pyx_v_n1);
+  Py_CLEAR(p->__pyx_v_nn);
   Py_CLEAR(p->__pyx_v_normalize);
+  Py_CLEAR(p->__pyx_v_raw);
   Py_CLEAR(p->__pyx_v_raw0);
   Py_CLEAR(p->__pyx_v_raw1);
   Py_CLEAR(p->__pyx_v_sd);
   Py_CLEAR(p->__pyx_v_self);
   Py_CLEAR(p->__pyx_v_tr_len);
   Py_CLEAR(p->__pyx_t_2);
   if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_11statmoments_7_native___pyx_scope_struct_2__moments < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_2__moments)))) {
@@ -53263,14 +55476,17 @@
     (*Py_TYPE(o)->tp_free)(o);
   }
 }
 
 static int __pyx_tp_traverse_11statmoments_7_native___pyx_scope_struct_2__moments(PyObject *o, visitproc v, void *a) {
   int e;
   struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_2__moments *p = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_2__moments *)o;
+  if (p->__pyx_v_acc) {
+    e = (*v)(p->__pyx_v_acc, a); if (e) return e;
+  }
   if (p->__pyx_v_acc0) {
     e = (*v)(p->__pyx_v_acc0, a); if (e) return e;
   }
   if (p->__pyx_v_acc1) {
     e = (*v)(p->__pyx_v_acc1, a); if (e) return e;
   }
   if (p->__pyx_v_buf) {
@@ -53296,26 +55512,35 @@
   }
   if (p->__pyx_v_ma) {
     e = (*v)(p->__pyx_v_ma, a); if (e) return e;
   }
   if (p->__pyx_v_maxm) {
     e = (*v)(p->__pyx_v_maxm, a); if (e) return e;
   }
+  if (p->__pyx_v_min_cnt) {
+    e = (*v)(p->__pyx_v_min_cnt, a); if (e) return e;
+  }
   if (p->__pyx_v_moments) {
     e = (*v)(p->__pyx_v_moments, a); if (e) return e;
   }
   if (p->__pyx_v_n0) {
     e = (*v)(p->__pyx_v_n0, a); if (e) return e;
   }
   if (p->__pyx_v_n1) {
     e = (*v)(p->__pyx_v_n1, a); if (e) return e;
   }
+  if (p->__pyx_v_nn) {
+    e = (*v)(p->__pyx_v_nn, a); if (e) return e;
+  }
   if (p->__pyx_v_normalize) {
     e = (*v)(p->__pyx_v_normalize, a); if (e) return e;
   }
+  if (p->__pyx_v_raw) {
+    e = (*v)(p->__pyx_v_raw, a); if (e) return e;
+  }
   if (p->__pyx_v_raw0) {
     e = (*v)(p->__pyx_v_raw0, a); if (e) return e;
   }
   if (p->__pyx_v_raw1) {
     e = (*v)(p->__pyx_v_raw1, a); if (e) return e;
   }
   if (p->__pyx_v_sd) {
@@ -53432,16 +55657,14 @@
   Py_CLEAR(p->__pyx_v_i);
   Py_CLEAR(p->__pyx_v_ii);
   Py_CLEAR(p->__pyx_v_j);
   Py_CLEAR(p->__pyx_v_jj);
   Py_CLEAR(p->__pyx_v_k);
   Py_CLEAR(p->__pyx_v_lm);
   Py_CLEAR(p->__pyx_v_m1);
-  Py_CLEAR(p->__pyx_v_m10);
-  Py_CLEAR(p->__pyx_v_m11);
   Py_CLEAR(p->__pyx_v_m2);
   Py_CLEAR(p->__pyx_v_ma);
   Py_CLEAR(p->__pyx_v_min_cnt);
   Py_CLEAR(p->__pyx_v_moments);
   Py_CLEAR(p->__pyx_v_n0);
   Py_CLEAR(p->__pyx_v_n1);
   Py_CLEAR(p->__pyx_v_nn);
@@ -53494,20 +55717,14 @@
   }
   if (p->__pyx_v_lm) {
     e = (*v)(p->__pyx_v_lm, a); if (e) return e;
   }
   if (p->__pyx_v_m1) {
     e = (*v)(p->__pyx_v_m1, a); if (e) return e;
   }
-  if (p->__pyx_v_m10) {
-    e = (*v)(p->__pyx_v_m10, a); if (e) return e;
-  }
-  if (p->__pyx_v_m11) {
-    e = (*v)(p->__pyx_v_m11, a); if (e) return e;
-  }
   if (p->__pyx_v_m2) {
     e = (*v)(p->__pyx_v_m2, a); if (e) return e;
   }
   if (p->__pyx_v_ma) {
     e = (*v)(p->__pyx_v_ma, a); if (e) return e;
   }
   if (p->__pyx_v_min_cnt) {
@@ -53646,14 +55863,15 @@
   }
   return o;
 }
 
 static void __pyx_tp_dealloc_11statmoments_7_native___pyx_scope_struct_4__moments(PyObject *o) {
   struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_4__moments *p = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_4__moments *)o;
   PyObject_GC_UnTrack(o);
+  Py_CLEAR(p->__pyx_v_dbuf);
   Py_CLEAR(p->__pyx_v_has_m1);
   Py_CLEAR(p->__pyx_8genexpr2__pyx_v_i);
   Py_CLEAR(p->__pyx_8genexpr2__pyx_v_m);
   Py_CLEAR(p->__pyx_v_m1idx);
   Py_CLEAR(p->__pyx_v_moments);
   Py_CLEAR(p->__pyx_v_normalize);
   Py_CLEAR(p->__pyx_v_res);
@@ -53665,14 +55883,17 @@
     (*Py_TYPE(o)->tp_free)(o);
   }
 }
 
 static int __pyx_tp_traverse_11statmoments_7_native___pyx_scope_struct_4__moments(PyObject *o, visitproc v, void *a) {
   int e;
   struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_4__moments *p = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_4__moments *)o;
+  if (p->__pyx_v_dbuf) {
+    e = (*v)(p->__pyx_v_dbuf, a); if (e) return e;
+  }
   if (p->__pyx_v_has_m1) {
     e = (*v)(p->__pyx_v_has_m1, a); if (e) return e;
   }
   if (p->__pyx_8genexpr2__pyx_v_i) {
     e = (*v)(p->__pyx_8genexpr2__pyx_v_i, a); if (e) return e;
   }
   if (p->__pyx_8genexpr2__pyx_v_m) {
@@ -54147,14 +56368,15 @@
   Py_CLEAR(p->__pyx_v_cl_len);
   Py_CLEAR(p->__pyx_v_cm);
   Py_CLEAR(p->__pyx_v_ii);
   Py_CLEAR(p->__pyx_v_jj);
   Py_CLEAR(p->__pyx_8genexpr4__pyx_v_m);
   Py_CLEAR(p->__pyx_v_m);
   Py_CLEAR(p->__pyx_v_maxm);
+  Py_CLEAR(p->__pyx_v_min_cnt);
   Py_CLEAR(p->__pyx_v_moments);
   Py_CLEAR(p->__pyx_v_nn);
   Py_CLEAR(p->__pyx_v_normalize);
   Py_CLEAR(p->__pyx_v_retm);
   Py_CLEAR(p->__pyx_v_sd);
   Py_CLEAR(p->__pyx_v_self);
   Py_CLEAR(p->__pyx_v_tr_len);
@@ -54186,14 +56408,17 @@
   }
   if (p->__pyx_v_m) {
     e = (*v)(p->__pyx_v_m, a); if (e) return e;
   }
   if (p->__pyx_v_maxm) {
     e = (*v)(p->__pyx_v_maxm, a); if (e) return e;
   }
+  if (p->__pyx_v_min_cnt) {
+    e = (*v)(p->__pyx_v_min_cnt, a); if (e) return e;
+  }
   if (p->__pyx_v_moments) {
     e = (*v)(p->__pyx_v_moments, a); if (e) return e;
   }
   if (p->__pyx_v_nn) {
     e = (*v)(p->__pyx_v_nn, a); if (e) return e;
   }
   if (p->__pyx_v_normalize) {
@@ -54454,66 +56679,66 @@
   0, /*tp_print*/
   #endif
   #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
   0, /*tp_pypy_flags*/
   #endif
 };
 
-static struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10__sz_helper *__pyx_freelist_11statmoments_7_native___pyx_scope_struct_10__sz_helper[8];
-static int __pyx_freecount_11statmoments_7_native___pyx_scope_struct_10__sz_helper = 0;
+static struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10_memory_size *__pyx_freelist_11statmoments_7_native___pyx_scope_struct_10_memory_size[8];
+static int __pyx_freecount_11statmoments_7_native___pyx_scope_struct_10_memory_size = 0;
 
-static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_10__sz_helper(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
+static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_10_memory_size(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
   PyObject *o;
-  if (CYTHON_COMPILING_IN_CPYTHON && likely((__pyx_freecount_11statmoments_7_native___pyx_scope_struct_10__sz_helper > 0) & (t->tp_basicsize == sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10__sz_helper)))) {
-    o = (PyObject*)__pyx_freelist_11statmoments_7_native___pyx_scope_struct_10__sz_helper[--__pyx_freecount_11statmoments_7_native___pyx_scope_struct_10__sz_helper];
-    memset(o, 0, sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10__sz_helper));
+  if (CYTHON_COMPILING_IN_CPYTHON && likely((__pyx_freecount_11statmoments_7_native___pyx_scope_struct_10_memory_size > 0) & (t->tp_basicsize == sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10_memory_size)))) {
+    o = (PyObject*)__pyx_freelist_11statmoments_7_native___pyx_scope_struct_10_memory_size[--__pyx_freecount_11statmoments_7_native___pyx_scope_struct_10_memory_size];
+    memset(o, 0, sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10_memory_size));
     (void) PyObject_INIT(o, t);
     PyObject_GC_Track(o);
   } else {
     o = (*t->tp_alloc)(t, 0);
     if (unlikely(!o)) return 0;
   }
   return o;
 }
 
-static void __pyx_tp_dealloc_11statmoments_7_native___pyx_scope_struct_10__sz_helper(PyObject *o) {
-  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10__sz_helper *p = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10__sz_helper *)o;
+static void __pyx_tp_dealloc_11statmoments_7_native___pyx_scope_struct_10_memory_size(PyObject *o) {
+  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10_memory_size *p = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10_memory_size *)o;
   PyObject_GC_UnTrack(o);
-  Py_CLEAR(p->__pyx_v_inst);
-  if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_11statmoments_7_native___pyx_scope_struct_10__sz_helper < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10__sz_helper)))) {
-    __pyx_freelist_11statmoments_7_native___pyx_scope_struct_10__sz_helper[__pyx_freecount_11statmoments_7_native___pyx_scope_struct_10__sz_helper++] = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10__sz_helper *)o);
+  Py_CLEAR(p->__pyx_v_self);
+  if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_11statmoments_7_native___pyx_scope_struct_10_memory_size < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10_memory_size)))) {
+    __pyx_freelist_11statmoments_7_native___pyx_scope_struct_10_memory_size[__pyx_freecount_11statmoments_7_native___pyx_scope_struct_10_memory_size++] = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10_memory_size *)o);
   } else {
     (*Py_TYPE(o)->tp_free)(o);
   }
 }
 
-static int __pyx_tp_traverse_11statmoments_7_native___pyx_scope_struct_10__sz_helper(PyObject *o, visitproc v, void *a) {
+static int __pyx_tp_traverse_11statmoments_7_native___pyx_scope_struct_10_memory_size(PyObject *o, visitproc v, void *a) {
   int e;
-  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10__sz_helper *p = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10__sz_helper *)o;
-  if (p->__pyx_v_inst) {
-    e = (*v)(p->__pyx_v_inst, a); if (e) return e;
+  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10_memory_size *p = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10_memory_size *)o;
+  if (p->__pyx_v_self) {
+    e = (*v)(p->__pyx_v_self, a); if (e) return e;
   }
   return 0;
 }
 
-static int __pyx_tp_clear_11statmoments_7_native___pyx_scope_struct_10__sz_helper(PyObject *o) {
+static int __pyx_tp_clear_11statmoments_7_native___pyx_scope_struct_10_memory_size(PyObject *o) {
   PyObject* tmp;
-  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10__sz_helper *p = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10__sz_helper *)o;
-  tmp = ((PyObject*)p->__pyx_v_inst);
-  p->__pyx_v_inst = Py_None; Py_INCREF(Py_None);
+  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10_memory_size *p = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10_memory_size *)o;
+  tmp = ((PyObject*)p->__pyx_v_self);
+  p->__pyx_v_self = Py_None; Py_INCREF(Py_None);
   Py_XDECREF(tmp);
   return 0;
 }
 
-static PyTypeObject __pyx_type_11statmoments_7_native___pyx_scope_struct_10__sz_helper = {
+static PyTypeObject __pyx_type_11statmoments_7_native___pyx_scope_struct_10_memory_size = {
   PyVarObject_HEAD_INIT(0, 0)
-  "statmoments._native.__pyx_scope_struct_10__sz_helper", /*tp_name*/
-  sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10__sz_helper), /*tp_basicsize*/
+  "statmoments._native.__pyx_scope_struct_10_memory_size", /*tp_name*/
+  sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_10_memory_size), /*tp_basicsize*/
   0, /*tp_itemsize*/
-  __pyx_tp_dealloc_11statmoments_7_native___pyx_scope_struct_10__sz_helper, /*tp_dealloc*/
+  __pyx_tp_dealloc_11statmoments_7_native___pyx_scope_struct_10_memory_size, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
   0, /*tp_vectorcall_offset*/
   #endif
   0, /*tp_getattr*/
@@ -54532,31 +56757,31 @@
   0, /*tp_call*/
   0, /*tp_str*/
   0, /*tp_getattro*/
   0, /*tp_setattro*/
   0, /*tp_as_buffer*/
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
   0, /*tp_doc*/
-  __pyx_tp_traverse_11statmoments_7_native___pyx_scope_struct_10__sz_helper, /*tp_traverse*/
-  __pyx_tp_clear_11statmoments_7_native___pyx_scope_struct_10__sz_helper, /*tp_clear*/
+  __pyx_tp_traverse_11statmoments_7_native___pyx_scope_struct_10_memory_size, /*tp_traverse*/
+  __pyx_tp_clear_11statmoments_7_native___pyx_scope_struct_10_memory_size, /*tp_clear*/
   0, /*tp_richcompare*/
   0, /*tp_weaklistoffset*/
   0, /*tp_iter*/
   0, /*tp_iternext*/
   0, /*tp_methods*/
   0, /*tp_members*/
   0, /*tp_getset*/
   0, /*tp_base*/
   0, /*tp_dict*/
   0, /*tp_descr_get*/
   0, /*tp_descr_set*/
   0, /*tp_dictoffset*/
   0, /*tp_init*/
   0, /*tp_alloc*/
-  __pyx_tp_new_11statmoments_7_native___pyx_scope_struct_10__sz_helper, /*tp_new*/
+  __pyx_tp_new_11statmoments_7_native___pyx_scope_struct_10_memory_size, /*tp_new*/
   0, /*tp_free*/
   0, /*tp_is_gc*/
   0, /*tp_bases*/
   0, /*tp_mro*/
   0, /*tp_cache*/
   0, /*tp_subclasses*/
   0, /*tp_weaklist*/
@@ -54715,24 +56940,28 @@
   PyObject_GC_UnTrack(o);
   Py_CLEAR(p->__pyx_v_cl_len);
   Py_CLEAR(p->__pyx_v_cls0);
   Py_CLEAR(p->__pyx_v_cm);
   Py_CLEAR(p->__pyx_v_ii);
   Py_CLEAR(p->__pyx_v_jj);
   Py_CLEAR(p->__pyx_v_m);
+  Py_CLEAR(p->__pyx_v_min_cnt);
   Py_CLEAR(p->__pyx_v_moments);
-  Py_CLEAR(p->__pyx_v_n);
+  Py_CLEAR(p->__pyx_v_n0);
+  Py_CLEAR(p->__pyx_v_n1);
+  Py_CLEAR(p->__pyx_v_nn);
   Py_CLEAR(p->__pyx_v_normalize);
+  Py_CLEAR(p->__pyx_v_raw);
   Py_CLEAR(p->__pyx_v_retm);
   Py_CLEAR(p->__pyx_v_sd);
   Py_CLEAR(p->__pyx_v_self);
   Py_CLEAR(p->__pyx_v_tr_len);
   Py_CLEAR(p->__pyx_v_tr_set);
-  Py_CLEAR(p->__pyx_v_tr_set_mean);
   Py_CLEAR(p->__pyx_v_traces_cl);
+  Py_CLEAR(p->__pyx_8genexpr6__pyx_v_ts);
   Py_CLEAR(p->__pyx_t_1);
   if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_11statmoments_7_native___pyx_scope_struct_12__moments < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_12__moments)))) {
     __pyx_freelist_11statmoments_7_native___pyx_scope_struct_12__moments[__pyx_freecount_11statmoments_7_native___pyx_scope_struct_12__moments++] = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_12__moments *)o);
   } else {
     (*Py_TYPE(o)->tp_free)(o);
   }
 }
@@ -54754,23 +56983,35 @@
   }
   if (p->__pyx_v_jj) {
     e = (*v)(p->__pyx_v_jj, a); if (e) return e;
   }
   if (p->__pyx_v_m) {
     e = (*v)(p->__pyx_v_m, a); if (e) return e;
   }
+  if (p->__pyx_v_min_cnt) {
+    e = (*v)(p->__pyx_v_min_cnt, a); if (e) return e;
+  }
   if (p->__pyx_v_moments) {
     e = (*v)(p->__pyx_v_moments, a); if (e) return e;
   }
-  if (p->__pyx_v_n) {
-    e = (*v)(p->__pyx_v_n, a); if (e) return e;
+  if (p->__pyx_v_n0) {
+    e = (*v)(p->__pyx_v_n0, a); if (e) return e;
+  }
+  if (p->__pyx_v_n1) {
+    e = (*v)(p->__pyx_v_n1, a); if (e) return e;
+  }
+  if (p->__pyx_v_nn) {
+    e = (*v)(p->__pyx_v_nn, a); if (e) return e;
   }
   if (p->__pyx_v_normalize) {
     e = (*v)(p->__pyx_v_normalize, a); if (e) return e;
   }
+  if (p->__pyx_v_raw) {
+    e = (*v)(p->__pyx_v_raw, a); if (e) return e;
+  }
   if (p->__pyx_v_retm) {
     e = (*v)(p->__pyx_v_retm, a); if (e) return e;
   }
   if (p->__pyx_v_sd) {
     e = (*v)(p->__pyx_v_sd, a); if (e) return e;
   }
   if (p->__pyx_v_self) {
@@ -54778,20 +57019,20 @@
   }
   if (p->__pyx_v_tr_len) {
     e = (*v)(p->__pyx_v_tr_len, a); if (e) return e;
   }
   if (p->__pyx_v_tr_set) {
     e = (*v)(p->__pyx_v_tr_set, a); if (e) return e;
   }
-  if (p->__pyx_v_tr_set_mean) {
-    e = (*v)(p->__pyx_v_tr_set_mean, a); if (e) return e;
-  }
   if (p->__pyx_v_traces_cl) {
     e = (*v)(p->__pyx_v_traces_cl, a); if (e) return e;
   }
+  if (p->__pyx_8genexpr6__pyx_v_ts) {
+    e = (*v)(p->__pyx_8genexpr6__pyx_v_ts, a); if (e) return e;
+  }
   if (p->__pyx_t_1) {
     e = (*v)(p->__pyx_t_1, a); if (e) return e;
   }
   return 0;
 }
 
 static PyTypeObject __pyx_type_11statmoments_7_native___pyx_scope_struct_12__moments = {
@@ -54889,23 +57130,25 @@
   Py_CLEAR(p->__pyx_v_C);
   Py_CLEAR(p->__pyx_v_cl_len);
   Py_CLEAR(p->__pyx_v_ii);
   Py_CLEAR(p->__pyx_v_jj);
   Py_CLEAR(p->__pyx_v_lm);
   Py_CLEAR(p->__pyx_v_m);
   Py_CLEAR(p->__pyx_v_mft);
+  Py_CLEAR(p->__pyx_v_min_cnt);
   Py_CLEAR(p->__pyx_v_moments);
   Py_CLEAR(p->__pyx_v_n);
   Py_CLEAR(p->__pyx_v_normalize);
   Py_CLEAR(p->__pyx_v_retm);
   Py_CLEAR(p->__pyx_v_rm);
   Py_CLEAR(p->__pyx_v_sd);
   Py_CLEAR(p->__pyx_v_self);
   Py_CLEAR(p->__pyx_v_tr_len);
   Py_CLEAR(p->__pyx_v_triuflatten);
+  Py_CLEAR(p->__pyx_t_0);
   if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_11statmoments_7_native___pyx_scope_struct_13__comoments < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_13__comoments)))) {
     __pyx_freelist_11statmoments_7_native___pyx_scope_struct_13__comoments[__pyx_freecount_11statmoments_7_native___pyx_scope_struct_13__comoments++] = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_13__comoments *)o);
   } else {
     (*Py_TYPE(o)->tp_free)(o);
   }
 }
 
@@ -54929,14 +57172,17 @@
   }
   if (p->__pyx_v_m) {
     e = (*v)(p->__pyx_v_m, a); if (e) return e;
   }
   if (p->__pyx_v_mft) {
     e = (*v)(p->__pyx_v_mft, a); if (e) return e;
   }
+  if (p->__pyx_v_min_cnt) {
+    e = (*v)(p->__pyx_v_min_cnt, a); if (e) return e;
+  }
   if (p->__pyx_v_moments) {
     e = (*v)(p->__pyx_v_moments, a); if (e) return e;
   }
   if (p->__pyx_v_n) {
     e = (*v)(p->__pyx_v_n, a); if (e) return e;
   }
   if (p->__pyx_v_normalize) {
@@ -54956,14 +57202,17 @@
   }
   if (p->__pyx_v_tr_len) {
     e = (*v)(p->__pyx_v_tr_len, a); if (e) return e;
   }
   if (p->__pyx_v_triuflatten) {
     e = (*v)(p->__pyx_v_triuflatten, a); if (e) return e;
   }
+  if (p->__pyx_t_0) {
+    e = (*v)(p->__pyx_t_0, a); if (e) return e;
+  }
   return 0;
 }
 
 static PyTypeObject __pyx_type_11statmoments_7_native___pyx_scope_struct_13__comoments = {
   PyVarObject_HEAD_INIT(0, 0)
   "statmoments._native.__pyx_scope_struct_13__comoments", /*tp_name*/
   sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_13__comoments), /*tp_basicsize*/
@@ -55059,24 +57308,26 @@
   Py_CLEAR(p->__pyx_v_cl_len);
   Py_CLEAR(p->__pyx_v_cl_set);
   Py_CLEAR(p->__pyx_v_ii);
   Py_CLEAR(p->__pyx_v_jj);
   Py_CLEAR(p->__pyx_v_lm);
   Py_CLEAR(p->__pyx_v_m);
   Py_CLEAR(p->__pyx_v_mft);
+  Py_CLEAR(p->__pyx_v_min_cnt);
   Py_CLEAR(p->__pyx_v_moments);
   Py_CLEAR(p->__pyx_v_n);
   Py_CLEAR(p->__pyx_v_normalize);
   Py_CLEAR(p->__pyx_v_retm);
   Py_CLEAR(p->__pyx_v_rm);
   Py_CLEAR(p->__pyx_v_sd);
   Py_CLEAR(p->__pyx_v_self);
   Py_CLEAR(p->__pyx_v_tr_len);
   Py_CLEAR(p->__pyx_v_tri);
   Py_CLEAR(p->__pyx_v_triuflatten);
+  Py_CLEAR(p->__pyx_t_0);
   if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_11statmoments_7_native___pyx_scope_struct_14__comoments < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_14__comoments)))) {
     __pyx_freelist_11statmoments_7_native___pyx_scope_struct_14__comoments[__pyx_freecount_11statmoments_7_native___pyx_scope_struct_14__comoments++] = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_14__comoments *)o);
   } else {
     (*Py_TYPE(o)->tp_free)(o);
   }
 }
 
@@ -55103,14 +57354,17 @@
   }
   if (p->__pyx_v_m) {
     e = (*v)(p->__pyx_v_m, a); if (e) return e;
   }
   if (p->__pyx_v_mft) {
     e = (*v)(p->__pyx_v_mft, a); if (e) return e;
   }
+  if (p->__pyx_v_min_cnt) {
+    e = (*v)(p->__pyx_v_min_cnt, a); if (e) return e;
+  }
   if (p->__pyx_v_moments) {
     e = (*v)(p->__pyx_v_moments, a); if (e) return e;
   }
   if (p->__pyx_v_n) {
     e = (*v)(p->__pyx_v_n, a); if (e) return e;
   }
   if (p->__pyx_v_normalize) {
@@ -55133,14 +57387,17 @@
   }
   if (p->__pyx_v_tri) {
     e = (*v)(p->__pyx_v_tri, a); if (e) return e;
   }
   if (p->__pyx_v_triuflatten) {
     e = (*v)(p->__pyx_v_triuflatten, a); if (e) return e;
   }
+  if (p->__pyx_t_0) {
+    e = (*v)(p->__pyx_t_0, a); if (e) return e;
+  }
   return 0;
 }
 
 static PyTypeObject __pyx_type_11statmoments_7_native___pyx_scope_struct_14__comoments = {
   PyVarObject_HEAD_INIT(0, 0)
   "statmoments._native.__pyx_scope_struct_14__comoments", /*tp_name*/
   sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_14__comoments), /*tp_basicsize*/
@@ -55443,69 +57700,87 @@
   0, /*tp_print*/
   #endif
   #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
   0, /*tp_pypy_flags*/
   #endif
 };
 
-static struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17__moments *__pyx_freelist_11statmoments_7_native___pyx_scope_struct_17__moments[8];
-static int __pyx_freecount_11statmoments_7_native___pyx_scope_struct_17__moments = 0;
+static struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17_moments *__pyx_freelist_11statmoments_7_native___pyx_scope_struct_17_moments[8];
+static int __pyx_freecount_11statmoments_7_native___pyx_scope_struct_17_moments = 0;
 
-static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_17__moments(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
+static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_17_moments(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
   PyObject *o;
-  if (CYTHON_COMPILING_IN_CPYTHON && likely((__pyx_freecount_11statmoments_7_native___pyx_scope_struct_17__moments > 0) & (t->tp_basicsize == sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17__moments)))) {
-    o = (PyObject*)__pyx_freelist_11statmoments_7_native___pyx_scope_struct_17__moments[--__pyx_freecount_11statmoments_7_native___pyx_scope_struct_17__moments];
-    memset(o, 0, sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17__moments));
+  if (CYTHON_COMPILING_IN_CPYTHON && likely((__pyx_freecount_11statmoments_7_native___pyx_scope_struct_17_moments > 0) & (t->tp_basicsize == sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17_moments)))) {
+    o = (PyObject*)__pyx_freelist_11statmoments_7_native___pyx_scope_struct_17_moments[--__pyx_freecount_11statmoments_7_native___pyx_scope_struct_17_moments];
+    memset(o, 0, sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17_moments));
     (void) PyObject_INIT(o, t);
     PyObject_GC_Track(o);
   } else {
     o = (*t->tp_alloc)(t, 0);
     if (unlikely(!o)) return 0;
   }
   return o;
 }
 
-static void __pyx_tp_dealloc_11statmoments_7_native___pyx_scope_struct_17__moments(PyObject *o) {
-  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17__moments *p = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17__moments *)o;
+static void __pyx_tp_dealloc_11statmoments_7_native___pyx_scope_struct_17_moments(PyObject *o) {
+  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17_moments *p = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17_moments *)o;
   PyObject_GC_UnTrack(o);
-  Py_CLEAR(p->__pyx_v_avg);
-  Py_CLEAR(p->__pyx_v_avgs);
+  Py_CLEAR(p->__pyx_v__i);
+  Py_CLEAR(p->__pyx_v_cm);
   Py_CLEAR(p->__pyx_v_dd);
+  Py_CLEAR(p->__pyx_v_ii);
+  Py_CLEAR(p->__pyx_v_jj);
+  Py_CLEAR(p->__pyx_v_k);
   Py_CLEAR(p->__pyx_v_m);
+  Py_CLEAR(p->__pyx_v_maxm);
   Py_CLEAR(p->__pyx_v_mcs);
   Py_CLEAR(p->__pyx_v_mcss);
   Py_CLEAR(p->__pyx_v_min_cnt);
   Py_CLEAR(p->__pyx_v_moments);
   Py_CLEAR(p->__pyx_v_n);
+  Py_CLEAR(p->__pyx_v_nn);
   Py_CLEAR(p->__pyx_v_normalize);
+  Py_CLEAR(p->__pyx_v_retm);
   Py_CLEAR(p->__pyx_v_self);
   Py_CLEAR(p->__pyx_v_tr_len);
   Py_CLEAR(p->__pyx_v_triuflatten);
-  if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_11statmoments_7_native___pyx_scope_struct_17__moments < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17__moments)))) {
-    __pyx_freelist_11statmoments_7_native___pyx_scope_struct_17__moments[__pyx_freecount_11statmoments_7_native___pyx_scope_struct_17__moments++] = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17__moments *)o);
+  if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_11statmoments_7_native___pyx_scope_struct_17_moments < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17_moments)))) {
+    __pyx_freelist_11statmoments_7_native___pyx_scope_struct_17_moments[__pyx_freecount_11statmoments_7_native___pyx_scope_struct_17_moments++] = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17_moments *)o);
   } else {
     (*Py_TYPE(o)->tp_free)(o);
   }
 }
 
-static int __pyx_tp_traverse_11statmoments_7_native___pyx_scope_struct_17__moments(PyObject *o, visitproc v, void *a) {
+static int __pyx_tp_traverse_11statmoments_7_native___pyx_scope_struct_17_moments(PyObject *o, visitproc v, void *a) {
   int e;
-  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17__moments *p = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17__moments *)o;
-  if (p->__pyx_v_avg) {
-    e = (*v)(p->__pyx_v_avg, a); if (e) return e;
+  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17_moments *p = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17_moments *)o;
+  if (p->__pyx_v__i) {
+    e = (*v)(p->__pyx_v__i, a); if (e) return e;
   }
-  if (p->__pyx_v_avgs) {
-    e = (*v)(p->__pyx_v_avgs, a); if (e) return e;
+  if (p->__pyx_v_cm) {
+    e = (*v)(p->__pyx_v_cm, a); if (e) return e;
   }
   if (p->__pyx_v_dd) {
     e = (*v)(p->__pyx_v_dd, a); if (e) return e;
   }
+  if (p->__pyx_v_ii) {
+    e = (*v)(p->__pyx_v_ii, a); if (e) return e;
+  }
+  if (p->__pyx_v_jj) {
+    e = (*v)(p->__pyx_v_jj, a); if (e) return e;
+  }
+  if (p->__pyx_v_k) {
+    e = (*v)(p->__pyx_v_k, a); if (e) return e;
+  }
   if (p->__pyx_v_m) {
     e = (*v)(p->__pyx_v_m, a); if (e) return e;
   }
+  if (p->__pyx_v_maxm) {
+    e = (*v)(p->__pyx_v_maxm, a); if (e) return e;
+  }
   if (p->__pyx_v_mcs) {
     e = (*v)(p->__pyx_v_mcs, a); if (e) return e;
   }
   if (p->__pyx_v_mcss) {
     e = (*v)(p->__pyx_v_mcss, a); if (e) return e;
   }
   if (p->__pyx_v_min_cnt) {
@@ -55513,35 +57788,41 @@
   }
   if (p->__pyx_v_moments) {
     e = (*v)(p->__pyx_v_moments, a); if (e) return e;
   }
   if (p->__pyx_v_n) {
     e = (*v)(p->__pyx_v_n, a); if (e) return e;
   }
+  if (p->__pyx_v_nn) {
+    e = (*v)(p->__pyx_v_nn, a); if (e) return e;
+  }
   if (p->__pyx_v_normalize) {
     e = (*v)(p->__pyx_v_normalize, a); if (e) return e;
   }
+  if (p->__pyx_v_retm) {
+    e = (*v)(p->__pyx_v_retm, a); if (e) return e;
+  }
   if (p->__pyx_v_self) {
     e = (*v)(p->__pyx_v_self, a); if (e) return e;
   }
   if (p->__pyx_v_tr_len) {
     e = (*v)(p->__pyx_v_tr_len, a); if (e) return e;
   }
   if (p->__pyx_v_triuflatten) {
     e = (*v)(p->__pyx_v_triuflatten, a); if (e) return e;
   }
   return 0;
 }
 
-static PyTypeObject __pyx_type_11statmoments_7_native___pyx_scope_struct_17__moments = {
+static PyTypeObject __pyx_type_11statmoments_7_native___pyx_scope_struct_17_moments = {
   PyVarObject_HEAD_INIT(0, 0)
-  "statmoments._native.__pyx_scope_struct_17__moments", /*tp_name*/
-  sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17__moments), /*tp_basicsize*/
+  "statmoments._native.__pyx_scope_struct_17_moments", /*tp_name*/
+  sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_17_moments), /*tp_basicsize*/
   0, /*tp_itemsize*/
-  __pyx_tp_dealloc_11statmoments_7_native___pyx_scope_struct_17__moments, /*tp_dealloc*/
+  __pyx_tp_dealloc_11statmoments_7_native___pyx_scope_struct_17_moments, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
   0, /*tp_vectorcall_offset*/
   #endif
   0, /*tp_getattr*/
@@ -55560,15 +57841,15 @@
   0, /*tp_call*/
   0, /*tp_str*/
   0, /*tp_getattro*/
   0, /*tp_setattro*/
   0, /*tp_as_buffer*/
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
   0, /*tp_doc*/
-  __pyx_tp_traverse_11statmoments_7_native___pyx_scope_struct_17__moments, /*tp_traverse*/
+  __pyx_tp_traverse_11statmoments_7_native___pyx_scope_struct_17_moments, /*tp_traverse*/
   0, /*tp_clear*/
   0, /*tp_richcompare*/
   0, /*tp_weaklistoffset*/
   0, /*tp_iter*/
   0, /*tp_iternext*/
   0, /*tp_methods*/
   0, /*tp_members*/
@@ -55576,15 +57857,15 @@
   0, /*tp_base*/
   0, /*tp_dict*/
   0, /*tp_descr_get*/
   0, /*tp_descr_set*/
   0, /*tp_dictoffset*/
   0, /*tp_init*/
   0, /*tp_alloc*/
-  __pyx_tp_new_11statmoments_7_native___pyx_scope_struct_17__moments, /*tp_new*/
+  __pyx_tp_new_11statmoments_7_native___pyx_scope_struct_17_moments, /*tp_new*/
   0, /*tp_free*/
   0, /*tp_is_gc*/
   0, /*tp_bases*/
   0, /*tp_mro*/
   0, /*tp_cache*/
   0, /*tp_subclasses*/
   0, /*tp_weaklist*/
@@ -55600,67 +57881,77 @@
   0, /*tp_print*/
   #endif
   #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
   0, /*tp_pypy_flags*/
   #endif
 };
 
-static struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18__comoments *__pyx_freelist_11statmoments_7_native___pyx_scope_struct_18__comoments[8];
-static int __pyx_freecount_11statmoments_7_native___pyx_scope_struct_18__comoments = 0;
+static struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18_comoments *__pyx_freelist_11statmoments_7_native___pyx_scope_struct_18_comoments[8];
+static int __pyx_freecount_11statmoments_7_native___pyx_scope_struct_18_comoments = 0;
 
-static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_18__comoments(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
+static PyObject *__pyx_tp_new_11statmoments_7_native___pyx_scope_struct_18_comoments(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
   PyObject *o;
-  if (CYTHON_COMPILING_IN_CPYTHON && likely((__pyx_freecount_11statmoments_7_native___pyx_scope_struct_18__comoments > 0) & (t->tp_basicsize == sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18__comoments)))) {
-    o = (PyObject*)__pyx_freelist_11statmoments_7_native___pyx_scope_struct_18__comoments[--__pyx_freecount_11statmoments_7_native___pyx_scope_struct_18__comoments];
-    memset(o, 0, sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18__comoments));
+  if (CYTHON_COMPILING_IN_CPYTHON && likely((__pyx_freecount_11statmoments_7_native___pyx_scope_struct_18_comoments > 0) & (t->tp_basicsize == sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18_comoments)))) {
+    o = (PyObject*)__pyx_freelist_11statmoments_7_native___pyx_scope_struct_18_comoments[--__pyx_freecount_11statmoments_7_native___pyx_scope_struct_18_comoments];
+    memset(o, 0, sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18_comoments));
     (void) PyObject_INIT(o, t);
     PyObject_GC_Track(o);
   } else {
     o = (*t->tp_alloc)(t, 0);
     if (unlikely(!o)) return 0;
   }
   return o;
 }
 
-static void __pyx_tp_dealloc_11statmoments_7_native___pyx_scope_struct_18__comoments(PyObject *o) {
-  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18__comoments *p = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18__comoments *)o;
+static void __pyx_tp_dealloc_11statmoments_7_native___pyx_scope_struct_18_comoments(PyObject *o) {
+  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18_comoments *p = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18_comoments *)o;
   PyObject_GC_UnTrack(o);
+  Py_CLEAR(p->__pyx_v__i);
   Py_CLEAR(p->__pyx_v_cov_arr);
-  Py_CLEAR(p->__pyx_v_covs);
   Py_CLEAR(p->__pyx_v_dd);
+  Py_CLEAR(p->__pyx_v_ii);
+  Py_CLEAR(p->__pyx_v_jj);
   Py_CLEAR(p->__pyx_v_k);
   Py_CLEAR(p->__pyx_v_m);
   Py_CLEAR(p->__pyx_v_mcs);
   Py_CLEAR(p->__pyx_v_mcss);
   Py_CLEAR(p->__pyx_v_min_cnt);
   Py_CLEAR(p->__pyx_v_moments);
   Py_CLEAR(p->__pyx_v_n);
+  Py_CLEAR(p->__pyx_v_nn);
   Py_CLEAR(p->__pyx_v_normalize);
+  Py_CLEAR(p->__pyx_v_retm);
   Py_CLEAR(p->__pyx_v_self);
   Py_CLEAR(p->__pyx_v_tr_len);
   Py_CLEAR(p->__pyx_v_triuflatten);
-  if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_11statmoments_7_native___pyx_scope_struct_18__comoments < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18__comoments)))) {
-    __pyx_freelist_11statmoments_7_native___pyx_scope_struct_18__comoments[__pyx_freecount_11statmoments_7_native___pyx_scope_struct_18__comoments++] = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18__comoments *)o);
+  if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_11statmoments_7_native___pyx_scope_struct_18_comoments < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18_comoments)))) {
+    __pyx_freelist_11statmoments_7_native___pyx_scope_struct_18_comoments[__pyx_freecount_11statmoments_7_native___pyx_scope_struct_18_comoments++] = ((struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18_comoments *)o);
   } else {
     (*Py_TYPE(o)->tp_free)(o);
   }
 }
 
-static int __pyx_tp_traverse_11statmoments_7_native___pyx_scope_struct_18__comoments(PyObject *o, visitproc v, void *a) {
+static int __pyx_tp_traverse_11statmoments_7_native___pyx_scope_struct_18_comoments(PyObject *o, visitproc v, void *a) {
   int e;
-  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18__comoments *p = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18__comoments *)o;
+  struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18_comoments *p = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18_comoments *)o;
+  if (p->__pyx_v__i) {
+    e = (*v)(p->__pyx_v__i, a); if (e) return e;
+  }
   if (p->__pyx_v_cov_arr) {
     e = (*v)(p->__pyx_v_cov_arr, a); if (e) return e;
   }
-  if (p->__pyx_v_covs) {
-    e = (*v)(p->__pyx_v_covs, a); if (e) return e;
-  }
   if (p->__pyx_v_dd) {
     e = (*v)(p->__pyx_v_dd, a); if (e) return e;
   }
+  if (p->__pyx_v_ii) {
+    e = (*v)(p->__pyx_v_ii, a); if (e) return e;
+  }
+  if (p->__pyx_v_jj) {
+    e = (*v)(p->__pyx_v_jj, a); if (e) return e;
+  }
   if (p->__pyx_v_k) {
     e = (*v)(p->__pyx_v_k, a); if (e) return e;
   }
   if (p->__pyx_v_m) {
     e = (*v)(p->__pyx_v_m, a); if (e) return e;
   }
   if (p->__pyx_v_mcs) {
@@ -55674,35 +57965,41 @@
   }
   if (p->__pyx_v_moments) {
     e = (*v)(p->__pyx_v_moments, a); if (e) return e;
   }
   if (p->__pyx_v_n) {
     e = (*v)(p->__pyx_v_n, a); if (e) return e;
   }
+  if (p->__pyx_v_nn) {
+    e = (*v)(p->__pyx_v_nn, a); if (e) return e;
+  }
   if (p->__pyx_v_normalize) {
     e = (*v)(p->__pyx_v_normalize, a); if (e) return e;
   }
+  if (p->__pyx_v_retm) {
+    e = (*v)(p->__pyx_v_retm, a); if (e) return e;
+  }
   if (p->__pyx_v_self) {
     e = (*v)(p->__pyx_v_self, a); if (e) return e;
   }
   if (p->__pyx_v_tr_len) {
     e = (*v)(p->__pyx_v_tr_len, a); if (e) return e;
   }
   if (p->__pyx_v_triuflatten) {
     e = (*v)(p->__pyx_v_triuflatten, a); if (e) return e;
   }
   return 0;
 }
 
-static PyTypeObject __pyx_type_11statmoments_7_native___pyx_scope_struct_18__comoments = {
+static PyTypeObject __pyx_type_11statmoments_7_native___pyx_scope_struct_18_comoments = {
   PyVarObject_HEAD_INIT(0, 0)
-  "statmoments._native.__pyx_scope_struct_18__comoments", /*tp_name*/
-  sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18__comoments), /*tp_basicsize*/
+  "statmoments._native.__pyx_scope_struct_18_comoments", /*tp_name*/
+  sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_18_comoments), /*tp_basicsize*/
   0, /*tp_itemsize*/
-  __pyx_tp_dealloc_11statmoments_7_native___pyx_scope_struct_18__comoments, /*tp_dealloc*/
+  __pyx_tp_dealloc_11statmoments_7_native___pyx_scope_struct_18_comoments, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
   0, /*tp_vectorcall_offset*/
   #endif
   0, /*tp_getattr*/
@@ -55721,15 +58018,15 @@
   0, /*tp_call*/
   0, /*tp_str*/
   0, /*tp_getattro*/
   0, /*tp_setattro*/
   0, /*tp_as_buffer*/
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
   0, /*tp_doc*/
-  __pyx_tp_traverse_11statmoments_7_native___pyx_scope_struct_18__comoments, /*tp_traverse*/
+  __pyx_tp_traverse_11statmoments_7_native___pyx_scope_struct_18_comoments, /*tp_traverse*/
   0, /*tp_clear*/
   0, /*tp_richcompare*/
   0, /*tp_weaklistoffset*/
   0, /*tp_iter*/
   0, /*tp_iternext*/
   0, /*tp_methods*/
   0, /*tp_members*/
@@ -55737,15 +58034,15 @@
   0, /*tp_base*/
   0, /*tp_dict*/
   0, /*tp_descr_get*/
   0, /*tp_descr_set*/
   0, /*tp_dictoffset*/
   0, /*tp_init*/
   0, /*tp_alloc*/
-  __pyx_tp_new_11statmoments_7_native___pyx_scope_struct_18__comoments, /*tp_new*/
+  __pyx_tp_new_11statmoments_7_native___pyx_scope_struct_18_comoments, /*tp_new*/
   0, /*tp_free*/
   0, /*tp_is_gc*/
   0, /*tp_bases*/
   0, /*tp_mro*/
   0, /*tp_cache*/
   0, /*tp_subclasses*/
   0, /*tp_weaklist*/
@@ -56022,15 +58319,15 @@
   PyObject_GC_UnTrack(o);
   Py_CLEAR(p->__pyx_v_acc1);
   Py_CLEAR(p->__pyx_v_accT);
   Py_CLEAR(p->__pyx_v_buf);
   Py_CLEAR(p->__pyx_v_cm);
   Py_CLEAR(p->__pyx_v_cmi);
   Py_CLEAR(p->__pyx_v_i);
-  Py_CLEAR(p->__pyx_9genexpr14__pyx_v_m);
+  Py_CLEAR(p->__pyx_9genexpr15__pyx_v_m);
   Py_CLEAR(p->__pyx_v_maxm);
   Py_CLEAR(p->__pyx_v_moments);
   Py_CLEAR(p->__pyx_v_n1);
   Py_CLEAR(p->__pyx_v_nT);
   Py_CLEAR(p->__pyx_v_nn);
   Py_CLEAR(p->__pyx_v_normalize);
   Py_CLEAR(p->__pyx_v_sd);
@@ -56060,16 +58357,16 @@
   }
   if (p->__pyx_v_cmi) {
     e = (*v)(p->__pyx_v_cmi, a); if (e) return e;
   }
   if (p->__pyx_v_i) {
     e = (*v)(p->__pyx_v_i, a); if (e) return e;
   }
-  if (p->__pyx_9genexpr14__pyx_v_m) {
-    e = (*v)(p->__pyx_9genexpr14__pyx_v_m, a); if (e) return e;
+  if (p->__pyx_9genexpr15__pyx_v_m) {
+    e = (*v)(p->__pyx_9genexpr15__pyx_v_m, a); if (e) return e;
   }
   if (p->__pyx_v_maxm) {
     e = (*v)(p->__pyx_v_maxm, a); if (e) return e;
   }
   if (p->__pyx_v_moments) {
     e = (*v)(p->__pyx_v_moments, a); if (e) return e;
   }
@@ -56185,17 +58482,18 @@
   }
   return o;
 }
 
 static void __pyx_tp_dealloc_11statmoments_7_native___pyx_scope_struct_22__moments(PyObject *o) {
   struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_22__moments *p = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_22__moments *)o;
   PyObject_GC_UnTrack(o);
+  Py_CLEAR(p->__pyx_v_dbuf_nonempty);
   Py_CLEAR(p->__pyx_v_has_m1);
-  Py_CLEAR(p->__pyx_9genexpr15__pyx_v_i);
-  Py_CLEAR(p->__pyx_9genexpr15__pyx_v_m);
+  Py_CLEAR(p->__pyx_9genexpr16__pyx_v_i);
+  Py_CLEAR(p->__pyx_9genexpr16__pyx_v_m);
   Py_CLEAR(p->__pyx_v_m1idx);
   Py_CLEAR(p->__pyx_v_moments);
   Py_CLEAR(p->__pyx_v_normalize);
   Py_CLEAR(p->__pyx_v_res);
   Py_CLEAR(p->__pyx_v_self);
   Py_CLEAR(p->__pyx_t_0);
   if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_11statmoments_7_native___pyx_scope_struct_22__moments < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_22__moments)))) {
@@ -56204,22 +58502,25 @@
     (*Py_TYPE(o)->tp_free)(o);
   }
 }
 
 static int __pyx_tp_traverse_11statmoments_7_native___pyx_scope_struct_22__moments(PyObject *o, visitproc v, void *a) {
   int e;
   struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_22__moments *p = (struct __pyx_obj_11statmoments_7_native___pyx_scope_struct_22__moments *)o;
+  if (p->__pyx_v_dbuf_nonempty) {
+    e = (*v)(p->__pyx_v_dbuf_nonempty, a); if (e) return e;
+  }
   if (p->__pyx_v_has_m1) {
     e = (*v)(p->__pyx_v_has_m1, a); if (e) return e;
   }
-  if (p->__pyx_9genexpr15__pyx_v_i) {
-    e = (*v)(p->__pyx_9genexpr15__pyx_v_i, a); if (e) return e;
+  if (p->__pyx_9genexpr16__pyx_v_i) {
+    e = (*v)(p->__pyx_9genexpr16__pyx_v_i, a); if (e) return e;
   }
-  if (p->__pyx_9genexpr15__pyx_v_m) {
-    e = (*v)(p->__pyx_9genexpr15__pyx_v_m, a); if (e) return e;
+  if (p->__pyx_9genexpr16__pyx_v_m) {
+    e = (*v)(p->__pyx_9genexpr16__pyx_v_m, a); if (e) return e;
   }
   if (p->__pyx_v_m1idx) {
     e = (*v)(p->__pyx_v_m1idx, a); if (e) return e;
   }
   if (p->__pyx_v_moments) {
     e = (*v)(p->__pyx_v_moments, a); if (e) return e;
   }
@@ -57100,15 +59401,14 @@
   {&__pyx_n_s_BivarNpassBase, __pyx_k_BivarNpassBase, sizeof(__pyx_k_BivarNpassBase), 0, 0, 1, 1},
   {&__pyx_n_s_BivarNpassBase___init, __pyx_k_BivarNpassBase___init, sizeof(__pyx_k_BivarNpassBase___init), 0, 0, 1, 1},
   {&__pyx_n_s_BivarNpassBase__moments, __pyx_k_BivarNpassBase__moments, sizeof(__pyx_k_BivarNpassBase__moments), 0, 0, 1, 1},
   {&__pyx_n_s_BivarNpassBase_counts, __pyx_k_BivarNpassBase_counts, sizeof(__pyx_k_BivarNpassBase_counts), 0, 0, 1, 1},
   {&__pyx_n_s_BivarNpassBase_estimate_mem_siz, __pyx_k_BivarNpassBase_estimate_mem_siz, sizeof(__pyx_k_BivarNpassBase_estimate_mem_siz), 0, 0, 1, 1},
   {&__pyx_n_s_BivarNpassBase_memory_size, __pyx_k_BivarNpassBase_memory_size, sizeof(__pyx_k_BivarNpassBase_memory_size), 0, 0, 1, 1},
   {&__pyx_n_s_BivarNpassBase_memory_size_loca, __pyx_k_BivarNpassBase_memory_size_loca, sizeof(__pyx_k_BivarNpassBase_memory_size_loca), 0, 0, 1, 1},
-  {&__pyx_n_s_BivarNpassBase_memory_size_loca_2, __pyx_k_BivarNpassBase_memory_size_loca_2, sizeof(__pyx_k_BivarNpassBase_memory_size_loca_2), 0, 0, 1, 1},
   {&__pyx_n_s_BivarNpassBase_update, __pyx_k_BivarNpassBase_update, sizeof(__pyx_k_BivarNpassBase_update), 0, 0, 1, 1},
   {&__pyx_kp_s_Buffer_view_does_not_expose_stri, __pyx_k_Buffer_view_does_not_expose_stri, sizeof(__pyx_k_Buffer_view_does_not_expose_stri), 0, 0, 1, 0},
   {&__pyx_n_s_C, __pyx_k_C, sizeof(__pyx_k_C), 0, 0, 1, 1},
   {&__pyx_kp_s_Can_only_create_a_buffer_that_is, __pyx_k_Can_only_create_a_buffer_that_is, sizeof(__pyx_k_Can_only_create_a_buffer_that_is), 0, 0, 1, 0},
   {&__pyx_kp_s_Cannot_assign_to_read_only_memor, __pyx_k_Cannot_assign_to_read_only_memor, sizeof(__pyx_k_Cannot_assign_to_read_only_memor), 0, 0, 1, 0},
   {&__pyx_kp_s_Cannot_create_writable_memory_vi, __pyx_k_Cannot_create_writable_memory_vi, sizeof(__pyx_k_Cannot_create_writable_memory_vi), 0, 0, 1, 0},
   {&__pyx_kp_s_Cannot_index_with_type_s, __pyx_k_Cannot_index_with_type_s, sizeof(__pyx_k_Cannot_index_with_type_s), 0, 0, 1, 0},
@@ -57127,14 +59427,15 @@
   {&__pyx_kp_s_Invalid_mode_expected_c_or_fortr, __pyx_k_Invalid_mode_expected_c_or_fortr, sizeof(__pyx_k_Invalid_mode_expected_c_or_fortr), 0, 0, 1, 0},
   {&__pyx_kp_s_Invalid_shape_in_axis_d_d, __pyx_k_Invalid_shape_in_axis_d_d, sizeof(__pyx_k_Invalid_shape_in_axis_d_d), 0, 0, 1, 0},
   {&__pyx_n_s_M, __pyx_k_M, sizeof(__pyx_k_M), 0, 0, 1, 1},
   {&__pyx_n_s_MM, __pyx_k_MM, sizeof(__pyx_k_MM), 0, 0, 1, 1},
   {&__pyx_n_s_MemoryError, __pyx_k_MemoryError, sizeof(__pyx_k_MemoryError), 0, 0, 1, 1},
   {&__pyx_kp_s_MemoryView_of_r_at_0x_x, __pyx_k_MemoryView_of_r_at_0x_x, sizeof(__pyx_k_MemoryView_of_r_at_0x_x), 0, 0, 1, 0},
   {&__pyx_kp_s_MemoryView_of_r_object, __pyx_k_MemoryView_of_r_object, sizeof(__pyx_k_MemoryView_of_r_object), 0, 0, 1, 0},
+  {&__pyx_n_s_ModuleNotFoundError, __pyx_k_ModuleNotFoundError, sizeof(__pyx_k_ModuleNotFoundError), 0, 0, 1, 1},
   {&__pyx_n_s_Mpq, __pyx_k_Mpq, sizeof(__pyx_k_Mpq), 0, 0, 1, 1},
   {&__pyx_kp_u_Must_be_implemented_in_an_inheri, __pyx_k_Must_be_implemented_in_an_inheri, sizeof(__pyx_k_Must_be_implemented_in_an_inheri), 0, 1, 0, 0},
   {&__pyx_n_s_NotImplementedError, __pyx_k_NotImplementedError, sizeof(__pyx_k_NotImplementedError), 0, 0, 1, 1},
   {&__pyx_kp_u_Not_implemented, __pyx_k_Not_implemented, sizeof(__pyx_k_Not_implemented), 0, 1, 0, 0},
   {&__pyx_n_b_O, __pyx_k_O, sizeof(__pyx_k_O), 0, 0, 0, 1},
   {&__pyx_kp_s_Out_of_bounds_on_buffer_access_a, __pyx_k_Out_of_bounds_on_buffer_access_a, sizeof(__pyx_k_Out_of_bounds_on_buffer_access_a), 0, 0, 1, 0},
   {&__pyx_kp_u_P, __pyx_k_P, sizeof(__pyx_k_P), 0, 1, 0, 0},
@@ -57150,54 +59451,58 @@
   {&__pyx_n_s_T, __pyx_k_T, sizeof(__pyx_k_T), 0, 0, 1, 1},
   {&__pyx_kp_u_The_input_moment_lists_should_ha, __pyx_k_The_input_moment_lists_should_ha, sizeof(__pyx_k_The_input_moment_lists_should_ha), 0, 1, 0, 0},
   {&__pyx_kp_u_The_input_moment_should_be_less, __pyx_k_The_input_moment_should_be_less, sizeof(__pyx_k_The_input_moment_should_be_less), 0, 1, 0, 0},
   {&__pyx_kp_u_The_moment_should_be_less_or_equ, __pyx_k_The_moment_should_be_less_or_equ, sizeof(__pyx_k_The_moment_should_be_less_or_equ), 0, 1, 0, 0},
   {&__pyx_n_s_TypeError, __pyx_k_TypeError, sizeof(__pyx_k_TypeError), 0, 0, 1, 1},
   {&__pyx_kp_s_Unable_to_convert_item_to_object, __pyx_k_Unable_to_convert_item_to_object, sizeof(__pyx_k_Unable_to_convert_item_to_object), 0, 0, 1, 0},
   {&__pyx_n_s_Update, __pyx_k_Update, sizeof(__pyx_k_Update), 0, 0, 1, 1},
+  {&__pyx_kp_u_VTK_is_installed_and_used, __pyx_k_VTK_is_installed_and_used, sizeof(__pyx_k_VTK_is_installed_and_used), 0, 1, 0, 0},
+  {&__pyx_kp_u_VTK_is_not_installed, __pyx_k_VTK_is_not_installed, sizeof(__pyx_k_VTK_is_not_installed), 0, 1, 0, 0},
   {&__pyx_n_s_ValueError, __pyx_k_ValueError, sizeof(__pyx_k_ValueError), 0, 0, 1, 1},
   {&__pyx_n_s_View_MemoryView, __pyx_k_View_MemoryView, sizeof(__pyx_k_View_MemoryView), 0, 0, 1, 1},
-  {&__pyx_n_s__154, __pyx_k__154, sizeof(__pyx_k__154), 0, 0, 1, 1},
-  {&__pyx_n_s__63, __pyx_k__63, sizeof(__pyx_k__63), 0, 0, 1, 1},
+  {&__pyx_n_s__165, __pyx_k__165, sizeof(__pyx_k__165), 0, 0, 1, 1},
+  {&__pyx_n_s__62, __pyx_k__62, sizeof(__pyx_k__62), 0, 0, 1, 1},
   {&__pyx_n_s_acc, __pyx_k_acc, sizeof(__pyx_k_acc), 0, 0, 1, 1},
   {&__pyx_n_s_acc0, __pyx_k_acc0, sizeof(__pyx_k_acc0), 0, 0, 1, 1},
   {&__pyx_n_s_acc1, __pyx_k_acc1, sizeof(__pyx_k_acc1), 0, 0, 1, 1},
   {&__pyx_n_s_acc1d, __pyx_k_acc1d, sizeof(__pyx_k_acc1d), 0, 0, 1, 1},
   {&__pyx_n_s_acc2d, __pyx_k_acc2d, sizeof(__pyx_k_acc2d), 0, 0, 1, 1},
   {&__pyx_n_s_accT, __pyx_k_accT, sizeof(__pyx_k_accT), 0, 0, 1, 1},
   {&__pyx_n_s_acc_dtype, __pyx_k_acc_dtype, sizeof(__pyx_k_acc_dtype), 0, 0, 1, 1},
   {&__pyx_n_s_acc_min_count, __pyx_k_acc_min_count, sizeof(__pyx_k_acc_min_count), 0, 0, 1, 1},
   {&__pyx_n_u_acc_min_count, __pyx_k_acc_min_count, sizeof(__pyx_k_acc_min_count), 0, 1, 0, 1},
   {&__pyx_n_s_accs, __pyx_k_accs, sizeof(__pyx_k_accs), 0, 0, 1, 1},
   {&__pyx_n_s_accs1d, __pyx_k_accs1d, sizeof(__pyx_k_accs1d), 0, 0, 1, 1},
+  {&__pyx_n_s_accs1dsz, __pyx_k_accs1dsz, sizeof(__pyx_k_accs1dsz), 0, 0, 1, 1},
   {&__pyx_n_s_accs2d, __pyx_k_accs2d, sizeof(__pyx_k_accs2d), 0, 0, 1, 1},
   {&__pyx_n_s_accs2d_2, __pyx_k_accs2d_2, sizeof(__pyx_k_accs2d_2), 0, 0, 1, 1},
+  {&__pyx_n_s_accs2dsz, __pyx_k_accs2dsz, sizeof(__pyx_k_accs2dsz), 0, 0, 1, 1},
   {&__pyx_n_s_accs_2, __pyx_k_accs_2, sizeof(__pyx_k_accs_2), 0, 0, 1, 1},
   {&__pyx_n_s_accs_count, __pyx_k_accs_count, sizeof(__pyx_k_accs_count), 0, 0, 1, 1},
   {&__pyx_n_s_accssz, __pyx_k_accssz, sizeof(__pyx_k_accssz), 0, 0, 1, 1},
   {&__pyx_n_s_acctype, __pyx_k_acctype, sizeof(__pyx_k_acctype), 0, 0, 1, 1},
   {&__pyx_n_u_acctype, __pyx_k_acctype, sizeof(__pyx_k_acctype), 0, 1, 0, 1},
   {&__pyx_n_s_allocate_buffer, __pyx_k_allocate_buffer, sizeof(__pyx_k_allocate_buffer), 0, 0, 1, 1},
   {&__pyx_n_s_ar_len, __pyx_k_ar_len, sizeof(__pyx_k_ar_len), 0, 0, 1, 1},
   {&__pyx_n_s_args, __pyx_k_args, sizeof(__pyx_k_args), 0, 0, 1, 1},
   {&__pyx_n_s_arr, __pyx_k_arr, sizeof(__pyx_k_arr), 0, 0, 1, 1},
   {&__pyx_n_s_array, __pyx_k_array, sizeof(__pyx_k_array), 0, 0, 1, 1},
   {&__pyx_n_s_asarray, __pyx_k_asarray, sizeof(__pyx_k_asarray), 0, 0, 1, 1},
   {&__pyx_n_s_ave, __pyx_k_ave, sizeof(__pyx_k_ave), 0, 0, 1, 1},
   {&__pyx_n_s_ave_i, __pyx_k_ave_i, sizeof(__pyx_k_ave_i), 0, 0, 1, 1},
   {&__pyx_n_s_ave_j, __pyx_k_ave_j, sizeof(__pyx_k_ave_j), 0, 0, 1, 1},
-  {&__pyx_n_s_avg, __pyx_k_avg, sizeof(__pyx_k_avg), 0, 0, 1, 1},
-  {&__pyx_n_s_avgs, __pyx_k_avgs, sizeof(__pyx_k_avgs), 0, 0, 1, 1},
   {&__pyx_n_s_axis, __pyx_k_axis, sizeof(__pyx_k_axis), 0, 0, 1, 1},
   {&__pyx_n_s_base, __pyx_k_base, sizeof(__pyx_k_base), 0, 0, 1, 1},
   {&__pyx_n_s_batch_cnt, __pyx_k_batch_cnt, sizeof(__pyx_k_batch_cnt), 0, 0, 1, 1},
   {&__pyx_n_s_binom, __pyx_k_binom, sizeof(__pyx_k_binom), 0, 0, 1, 1},
   {&__pyx_n_s_bits, __pyx_k_bits, sizeof(__pyx_k_bits), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_2pass, __pyx_k_bivar_2pass, sizeof(__pyx_k_bivar_2pass), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_2pass__comoments, __pyx_k_bivar_2pass__comoments, sizeof(__pyx_k_bivar_2pass__comoments), 0, 0, 1, 1},
+  {&__pyx_n_s_bivar_2pass_estimate_mem_size, __pyx_k_bivar_2pass_estimate_mem_size, sizeof(__pyx_k_bivar_2pass_estimate_mem_size), 0, 0, 1, 1},
+  {&__pyx_n_s_bivar_2pass_memory_size, __pyx_k_bivar_2pass_memory_size, sizeof(__pyx_k_bivar_2pass_memory_size), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_cntr, __pyx_k_bivar_cntr, sizeof(__pyx_k_bivar_cntr), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_cntr___init, __pyx_k_bivar_cntr___init, sizeof(__pyx_k_bivar_cntr___init), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_cntr__comoments, __pyx_k_bivar_cntr__comoments, sizeof(__pyx_k_bivar_cntr__comoments), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_cntr__moments, __pyx_k_bivar_cntr__moments, sizeof(__pyx_k_bivar_cntr__moments), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_cntr_counts, __pyx_k_bivar_cntr_counts, sizeof(__pyx_k_bivar_cntr_counts), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_cntr_estimate_mem_size, __pyx_k_bivar_cntr_estimate_mem_size, sizeof(__pyx_k_bivar_cntr_estimate_mem_size), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_cntr_memory_size, __pyx_k_bivar_cntr_memory_size, sizeof(__pyx_k_bivar_cntr_memory_size), 0, 0, 1, 1},
@@ -57220,27 +59525,30 @@
   {&__pyx_n_s_bivar_sum_detrend_update, __pyx_k_bivar_sum_detrend_update, sizeof(__pyx_k_bivar_sum_detrend_update), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_sum_mix, __pyx_k_bivar_sum_mix, sizeof(__pyx_k_bivar_sum_mix), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_sum_mix___init, __pyx_k_bivar_sum_mix___init, sizeof(__pyx_k_bivar_sum_mix___init), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_txtbk, __pyx_k_bivar_txtbk, sizeof(__pyx_k_bivar_txtbk), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_txtbk___init, __pyx_k_bivar_txtbk___init, sizeof(__pyx_k_bivar_txtbk___init), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_txtbk__comoments, __pyx_k_bivar_txtbk__comoments, sizeof(__pyx_k_bivar_txtbk__comoments), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_txtbk__realloc_tri, __pyx_k_bivar_txtbk__realloc_tri, sizeof(__pyx_k_bivar_txtbk__realloc_tri), 0, 0, 1, 1},
+  {&__pyx_n_s_bivar_txtbk_estimate_mem_size, __pyx_k_bivar_txtbk_estimate_mem_size, sizeof(__pyx_k_bivar_txtbk_estimate_mem_size), 0, 0, 1, 1},
+  {&__pyx_n_s_bivar_txtbk_memory_size, __pyx_k_bivar_txtbk_memory_size, sizeof(__pyx_k_bivar_txtbk_memory_size), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_vtk, __pyx_k_bivar_vtk, sizeof(__pyx_k_bivar_vtk), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_vtk___init, __pyx_k_bivar_vtk___init, sizeof(__pyx_k_bivar_vtk___init), 0, 0, 1, 1},
-  {&__pyx_n_s_bivar_vtk__comoments, __pyx_k_bivar_vtk__comoments, sizeof(__pyx_k_bivar_vtk__comoments), 0, 0, 1, 1},
-  {&__pyx_n_s_bivar_vtk__moments, __pyx_k_bivar_vtk__moments, sizeof(__pyx_k_bivar_vtk__moments), 0, 0, 1, 1},
+  {&__pyx_n_s_bivar_vtk_comoments, __pyx_k_bivar_vtk_comoments, sizeof(__pyx_k_bivar_vtk_comoments), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_vtk_counts, __pyx_k_bivar_vtk_counts, sizeof(__pyx_k_bivar_vtk_counts), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_vtk_memory_size, __pyx_k_bivar_vtk_memory_size, sizeof(__pyx_k_bivar_vtk_memory_size), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_vtk_memory_size_locals__ms, __pyx_k_bivar_vtk_memory_size_locals__ms, sizeof(__pyx_k_bivar_vtk_memory_size_locals__ms), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_vtk_memory_size_locals__ms_2, __pyx_k_bivar_vtk_memory_size_locals__ms_2, sizeof(__pyx_k_bivar_vtk_memory_size_locals__ms_2), 0, 0, 1, 1},
+  {&__pyx_n_s_bivar_vtk_moments, __pyx_k_bivar_vtk_moments, sizeof(__pyx_k_bivar_vtk_moments), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_vtk_total_count, __pyx_k_bivar_vtk_total_count, sizeof(__pyx_k_bivar_vtk_total_count), 0, 0, 1, 1},
   {&__pyx_n_s_bivar_vtk_update, __pyx_k_bivar_vtk_update, sizeof(__pyx_k_bivar_vtk_update), 0, 0, 1, 1},
   {&__pyx_n_s_broadcast_to, __pyx_k_broadcast_to, sizeof(__pyx_k_broadcast_to), 0, 0, 1, 1},
   {&__pyx_n_s_buf, __pyx_k_buf, sizeof(__pyx_k_buf), 0, 0, 1, 1},
   {&__pyx_n_s_buf_2, __pyx_k_buf_2, sizeof(__pyx_k_buf_2), 0, 0, 1, 1},
+  {&__pyx_n_s_bufsz, __pyx_k_bufsz, sizeof(__pyx_k_bufsz), 0, 0, 1, 1},
   {&__pyx_n_s_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 0, 1, 1},
   {&__pyx_n_u_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 1, 0, 1},
   {&__pyx_n_s_c1, __pyx_k_c1, sizeof(__pyx_k_c1), 0, 0, 1, 1},
   {&__pyx_n_s_calc_central_moment_general, __pyx_k_calc_central_moment_general, sizeof(__pyx_k_calc_central_moment_general), 0, 0, 1, 1},
   {&__pyx_n_s_calc_comoments, __pyx_k_calc_comoments, sizeof(__pyx_k_calc_comoments), 0, 0, 1, 1},
   {&__pyx_n_s_cbuf, __pyx_k_cbuf, sizeof(__pyx_k_cbuf), 0, 0, 1, 1},
   {&__pyx_n_s_cl, __pyx_k_cl, sizeof(__pyx_k_cl), 0, 0, 1, 1},
@@ -57256,31 +59564,33 @@
   {&__pyx_n_s_classifiers, __pyx_k_classifiers, sizeof(__pyx_k_classifiers), 0, 0, 1, 1},
   {&__pyx_n_s_classifiers_len, __pyx_k_classifiers_len, sizeof(__pyx_k_classifiers_len), 0, 0, 1, 1},
   {&__pyx_n_s_cline_in_traceback, __pyx_k_cline_in_traceback, sizeof(__pyx_k_cline_in_traceback), 0, 0, 1, 1},
   {&__pyx_n_s_close, __pyx_k_close, sizeof(__pyx_k_close), 0, 0, 1, 1},
   {&__pyx_n_s_cls, __pyx_k_cls, sizeof(__pyx_k_cls), 0, 0, 1, 1},
   {&__pyx_n_s_cls0, __pyx_k_cls0, sizeof(__pyx_k_cls0), 0, 0, 1, 1},
   {&__pyx_n_s_cls_count, __pyx_k_cls_count, sizeof(__pyx_k_cls_count), 0, 0, 1, 1},
+  {&__pyx_n_s_clssz, __pyx_k_clssz, sizeof(__pyx_k_clssz), 0, 0, 1, 1},
   {&__pyx_n_s_cm, __pyx_k_cm, sizeof(__pyx_k_cm), 0, 0, 1, 1},
   {&__pyx_n_s_cmi, __pyx_k_cmi, sizeof(__pyx_k_cmi), 0, 0, 1, 1},
   {&__pyx_n_s_com, __pyx_k_com, sizeof(__pyx_k_com), 0, 0, 1, 1},
   {&__pyx_n_s_comoments, __pyx_k_comoments, sizeof(__pyx_k_comoments), 0, 0, 1, 1},
   {&__pyx_n_s_comoments_2, __pyx_k_comoments_2, sizeof(__pyx_k_comoments_2), 0, 0, 1, 1},
   {&__pyx_n_s_compute_by_rows, __pyx_k_compute_by_rows, sizeof(__pyx_k_compute_by_rows), 0, 0, 1, 1},
   {&__pyx_kp_s_contiguous_and_direct, __pyx_k_contiguous_and_direct, sizeof(__pyx_k_contiguous_and_direct), 0, 0, 1, 0},
   {&__pyx_kp_s_contiguous_and_indirect, __pyx_k_contiguous_and_indirect, sizeof(__pyx_k_contiguous_and_indirect), 0, 0, 1, 0},
   {&__pyx_n_s_copy, __pyx_k_copy, sizeof(__pyx_k_copy), 0, 0, 1, 1},
   {&__pyx_n_s_counts, __pyx_k_counts, sizeof(__pyx_k_counts), 0, 0, 1, 1},
   {&__pyx_n_s_counts_2, __pyx_k_counts_2, sizeof(__pyx_k_counts_2), 0, 0, 1, 1},
   {&__pyx_n_s_cov_arr, __pyx_k_cov_arr, sizeof(__pyx_k_cov_arr), 0, 0, 1, 1},
-  {&__pyx_n_s_covs, __pyx_k_covs, sizeof(__pyx_k_covs), 0, 0, 1, 1},
   {&__pyx_n_s_da, __pyx_k_da, sizeof(__pyx_k_da), 0, 0, 1, 1},
   {&__pyx_n_s_daxpy, __pyx_k_daxpy, sizeof(__pyx_k_daxpy), 0, 0, 1, 1},
   {&__pyx_n_s_db_part, __pyx_k_db_part, sizeof(__pyx_k_db_part), 0, 0, 1, 1},
   {&__pyx_n_s_dbuf, __pyx_k_dbuf, sizeof(__pyx_k_dbuf), 0, 0, 1, 1},
+  {&__pyx_n_s_dbuf_2, __pyx_k_dbuf_2, sizeof(__pyx_k_dbuf_2), 0, 0, 1, 1},
+  {&__pyx_n_s_dbuf_nonempty, __pyx_k_dbuf_nonempty, sizeof(__pyx_k_dbuf_nonempty), 0, 0, 1, 1},
   {&__pyx_n_s_dd, __pyx_k_dd, sizeof(__pyx_k_dd), 0, 0, 1, 1},
   {&__pyx_n_s_delta, __pyx_k_delta, sizeof(__pyx_k_delta), 0, 0, 1, 1},
   {&__pyx_n_u_detrend_cnt, __pyx_k_detrend_cnt, sizeof(__pyx_k_detrend_cnt), 0, 1, 0, 1},
   {&__pyx_n_s_detrend_cnt_2, __pyx_k_detrend_cnt_2, sizeof(__pyx_k_detrend_cnt_2), 0, 0, 1, 1},
   {&__pyx_n_s_dgemm, __pyx_k_dgemm, sizeof(__pyx_k_dgemm), 0, 0, 1, 1},
   {&__pyx_n_s_dger, __pyx_k_dger, sizeof(__pyx_k_dger), 0, 0, 1, 1},
   {&__pyx_n_s_diag, __pyx_k_diag, sizeof(__pyx_k_diag), 0, 0, 1, 1},
@@ -57289,14 +59599,15 @@
   {&__pyx_n_s_doc, __pyx_k_doc, sizeof(__pyx_k_doc), 0, 0, 1, 1},
   {&__pyx_n_s_dsbmv, __pyx_k_dsbmv, sizeof(__pyx_k_dsbmv), 0, 0, 1, 1},
   {&__pyx_n_s_dscal, __pyx_k_dscal, sizeof(__pyx_k_dscal), 0, 0, 1, 1},
   {&__pyx_n_s_dsyrk, __pyx_k_dsyrk, sizeof(__pyx_k_dsyrk), 0, 0, 1, 1},
   {&__pyx_n_s_dtype, __pyx_k_dtype, sizeof(__pyx_k_dtype), 0, 0, 1, 1},
   {&__pyx_n_s_dtype_2, __pyx_k_dtype_2, sizeof(__pyx_k_dtype_2), 0, 0, 1, 1},
   {&__pyx_n_s_dtype_is_object, __pyx_k_dtype_is_object, sizeof(__pyx_k_dtype_is_object), 0, 0, 1, 1},
+  {&__pyx_n_s_edge_val, __pyx_k_edge_val, sizeof(__pyx_k_edge_val), 0, 0, 1, 1},
   {&__pyx_n_s_empty, __pyx_k_empty, sizeof(__pyx_k_empty), 0, 0, 1, 1},
   {&__pyx_n_s_empty_like, __pyx_k_empty_like, sizeof(__pyx_k_empty_like), 0, 0, 1, 1},
   {&__pyx_n_s_encode, __pyx_k_encode, sizeof(__pyx_k_encode), 0, 0, 1, 1},
   {&__pyx_n_s_ensure_ret, __pyx_k_ensure_ret, sizeof(__pyx_k_ensure_ret), 0, 0, 1, 1},
   {&__pyx_n_s_enumerate, __pyx_k_enumerate, sizeof(__pyx_k_enumerate), 0, 0, 1, 1},
   {&__pyx_n_s_error, __pyx_k_error, sizeof(__pyx_k_error), 0, 0, 1, 1},
   {&__pyx_n_s_estimate_mem_size, __pyx_k_estimate_mem_size, sizeof(__pyx_k_estimate_mem_size), 0, 0, 1, 1},
@@ -57315,18 +59626,18 @@
   {&__pyx_n_s_has_m1, __pyx_k_has_m1, sizeof(__pyx_k_has_m1), 0, 0, 1, 1},
   {&__pyx_n_s_i, __pyx_k_i, sizeof(__pyx_k_i), 0, 0, 1, 1},
   {&__pyx_n_s_i_2, __pyx_k_i_2, sizeof(__pyx_k_i_2), 0, 0, 1, 1},
   {&__pyx_n_s_id, __pyx_k_id, sizeof(__pyx_k_id), 0, 0, 1, 1},
   {&__pyx_n_s_ii, __pyx_k_ii, sizeof(__pyx_k_ii), 0, 0, 1, 1},
   {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
   {&__pyx_n_s_init, __pyx_k_init, sizeof(__pyx_k_init), 0, 0, 1, 1},
-  {&__pyx_n_s_inst, __pyx_k_inst, sizeof(__pyx_k_inst), 0, 0, 1, 1},
   {&__pyx_n_s_instl, __pyx_k_instl, sizeof(__pyx_k_instl), 0, 0, 1, 1},
   {&__pyx_n_s_intbl0, __pyx_k_intbl0, sizeof(__pyx_k_intbl0), 0, 0, 1, 1},
   {&__pyx_n_s_inv_n, __pyx_k_inv_n, sizeof(__pyx_k_inv_n), 0, 0, 1, 1},
+  {&__pyx_n_s_is_vtk_installed, __pyx_k_is_vtk_installed, sizeof(__pyx_k_is_vtk_installed), 0, 0, 1, 1},
   {&__pyx_n_s_items, __pyx_k_items, sizeof(__pyx_k_items), 0, 0, 1, 1},
   {&__pyx_n_s_itemsize, __pyx_k_itemsize, sizeof(__pyx_k_itemsize), 0, 0, 1, 1},
   {&__pyx_kp_s_itemsize_0_for_cython_array, __pyx_k_itemsize_0_for_cython_array, sizeof(__pyx_k_itemsize_0_for_cython_array), 0, 0, 1, 0},
   {&__pyx_n_s_j, __pyx_k_j, sizeof(__pyx_k_j), 0, 0, 1, 1},
   {&__pyx_n_s_jj, __pyx_k_jj, sizeof(__pyx_k_jj), 0, 0, 1, 1},
   {&__pyx_n_s_k, __pyx_k_k, sizeof(__pyx_k_k), 0, 0, 1, 1},
   {&__pyx_n_s_kwargs, __pyx_k_kwargs, sizeof(__pyx_k_kwargs), 0, 0, 1, 1},
@@ -57346,20 +59657,24 @@
   {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
   {&__pyx_n_s_map, __pyx_k_map, sizeof(__pyx_k_map), 0, 0, 1, 1},
   {&__pyx_n_s_max, __pyx_k_max, sizeof(__pyx_k_max), 0, 0, 1, 1},
   {&__pyx_n_s_maxm, __pyx_k_maxm, sizeof(__pyx_k_maxm), 0, 0, 1, 1},
   {&__pyx_n_s_mcs, __pyx_k_mcs, sizeof(__pyx_k_mcs), 0, 0, 1, 1},
   {&__pyx_n_s_mcss, __pyx_k_mcss, sizeof(__pyx_k_mcss), 0, 0, 1, 1},
   {&__pyx_n_s_mean, __pyx_k_mean, sizeof(__pyx_k_mean), 0, 0, 1, 1},
+  {&__pyx_n_s_mem_base, __pyx_k_mem_base, sizeof(__pyx_k_mem_base), 0, 0, 1, 1},
   {&__pyx_n_s_mem_class, __pyx_k_mem_class, sizeof(__pyx_k_mem_class), 0, 0, 1, 1},
+  {&__pyx_n_s_mem_tri, __pyx_k_mem_tri, sizeof(__pyx_k_mem_tri), 0, 0, 1, 1},
   {&__pyx_n_s_mem_ttest, __pyx_k_mem_ttest, sizeof(__pyx_k_mem_ttest), 0, 0, 1, 1},
+  {&__pyx_n_s_mem_ttstd, __pyx_k_mem_ttstd, sizeof(__pyx_k_mem_ttstd), 0, 0, 1, 1},
   {&__pyx_n_s_memory_size, __pyx_k_memory_size, sizeof(__pyx_k_memory_size), 0, 0, 1, 1},
   {&__pyx_n_s_memview, __pyx_k_memview, sizeof(__pyx_k_memview), 0, 0, 1, 1},
   {&__pyx_n_s_metaclass, __pyx_k_metaclass, sizeof(__pyx_k_metaclass), 0, 0, 1, 1},
   {&__pyx_n_s_mft, __pyx_k_mft, sizeof(__pyx_k_mft), 0, 0, 1, 1},
+  {&__pyx_n_s_min, __pyx_k_min, sizeof(__pyx_k_min), 0, 0, 1, 1},
   {&__pyx_n_s_min_cnt, __pyx_k_min_cnt, sizeof(__pyx_k_min_cnt), 0, 0, 1, 1},
   {&__pyx_n_s_mlen, __pyx_k_mlen, sizeof(__pyx_k_mlen), 0, 0, 1, 1},
   {&__pyx_n_s_mode, __pyx_k_mode, sizeof(__pyx_k_mode), 0, 0, 1, 1},
   {&__pyx_n_s_module, __pyx_k_module, sizeof(__pyx_k_module), 0, 0, 1, 1},
   {&__pyx_n_s_moment, __pyx_k_moment, sizeof(__pyx_k_moment), 0, 0, 1, 1},
   {&__pyx_n_s_moments, __pyx_k_moments, sizeof(__pyx_k_moments), 0, 0, 1, 1},
   {&__pyx_n_s_moments_2, __pyx_k_moments_2, sizeof(__pyx_k_moments_2), 0, 0, 1, 1},
@@ -57394,14 +59709,15 @@
   {&__pyx_n_s_p, __pyx_k_p, sizeof(__pyx_k_p), 0, 0, 1, 1},
   {&__pyx_n_s_pack, __pyx_k_pack, sizeof(__pyx_k_pack), 0, 0, 1, 1},
   {&__pyx_n_s_pickle, __pyx_k_pickle, sizeof(__pyx_k_pickle), 0, 0, 1, 1},
   {&__pyx_n_s_pop, __pyx_k_pop, sizeof(__pyx_k_pop), 0, 0, 1, 1},
   {&__pyx_n_s_power, __pyx_k_power, sizeof(__pyx_k_power), 0, 0, 1, 1},
   {&__pyx_n_s_prepare, __pyx_k_prepare, sizeof(__pyx_k_prepare), 0, 0, 1, 1},
   {&__pyx_n_s_preprocvar, __pyx_k_preprocvar, sizeof(__pyx_k_preprocvar), 0, 0, 1, 1},
+  {&__pyx_n_s_print, __pyx_k_print, sizeof(__pyx_k_print), 0, 0, 1, 1},
   {&__pyx_n_s_property, __pyx_k_property, sizeof(__pyx_k_property), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_PickleError, __pyx_k_pyx_PickleError, sizeof(__pyx_k_pyx_PickleError), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_checksum, __pyx_k_pyx_checksum, sizeof(__pyx_k_pyx_checksum), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_getbuffer, __pyx_k_pyx_getbuffer, sizeof(__pyx_k_pyx_getbuffer), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_result, __pyx_k_pyx_result, sizeof(__pyx_k_pyx_result), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_state, __pyx_k_pyx_state, sizeof(__pyx_k_pyx_state), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_type, __pyx_k_pyx_type, sizeof(__pyx_k_pyx_type), 0, 0, 1, 1},
@@ -57450,15 +59766,14 @@
   {&__pyx_kp_s_strided_and_direct, __pyx_k_strided_and_direct, sizeof(__pyx_k_strided_and_direct), 0, 0, 1, 0},
   {&__pyx_kp_s_strided_and_direct_or_indirect, __pyx_k_strided_and_direct_or_indirect, sizeof(__pyx_k_strided_and_direct_or_indirect), 0, 0, 1, 0},
   {&__pyx_kp_s_strided_and_indirect, __pyx_k_strided_and_indirect, sizeof(__pyx_k_strided_and_indirect), 0, 0, 1, 0},
   {&__pyx_kp_s_stringsource, __pyx_k_stringsource, sizeof(__pyx_k_stringsource), 0, 0, 1, 0},
   {&__pyx_n_s_struct, __pyx_k_struct, sizeof(__pyx_k_struct), 0, 0, 1, 1},
   {&__pyx_n_s_sum, __pyx_k_sum, sizeof(__pyx_k_sum), 0, 0, 1, 1},
   {&__pyx_n_s_super, __pyx_k_super, sizeof(__pyx_k_super), 0, 0, 1, 1},
-  {&__pyx_n_s_sz_helper, __pyx_k_sz_helper, sizeof(__pyx_k_sz_helper), 0, 0, 1, 1},
   {&__pyx_n_s_tbl, __pyx_k_tbl, sizeof(__pyx_k_tbl), 0, 0, 1, 1},
   {&__pyx_n_s_temp_diag, __pyx_k_temp_diag, sizeof(__pyx_k_temp_diag), 0, 0, 1, 1},
   {&__pyx_n_s_test, __pyx_k_test, sizeof(__pyx_k_test), 0, 0, 1, 1},
   {&__pyx_n_s_throw, __pyx_k_throw, sizeof(__pyx_k_throw), 0, 0, 1, 1},
   {&__pyx_n_s_tmpbuf, __pyx_k_tmpbuf, sizeof(__pyx_k_tmpbuf), 0, 0, 1, 1},
   {&__pyx_n_s_tmpsq, __pyx_k_tmpsq, sizeof(__pyx_k_tmpsq), 0, 0, 1, 1},
   {&__pyx_n_s_total_count, __pyx_k_total_count, sizeof(__pyx_k_total_count), 0, 0, 1, 1},
@@ -57466,26 +59781,27 @@
   {&__pyx_n_s_tr2d, __pyx_k_tr2d, sizeof(__pyx_k_tr2d), 0, 0, 1, 1},
   {&__pyx_n_s_tr_copy, __pyx_k_tr_copy, sizeof(__pyx_k_tr_copy), 0, 0, 1, 1},
   {&__pyx_n_s_tr_layout, __pyx_k_tr_layout, sizeof(__pyx_k_tr_layout), 0, 0, 1, 1},
   {&__pyx_n_s_tr_len, __pyx_k_tr_len, sizeof(__pyx_k_tr_len), 0, 0, 1, 1},
   {&__pyx_n_s_tr_lyt, __pyx_k_tr_lyt, sizeof(__pyx_k_tr_lyt), 0, 0, 1, 1},
   {&__pyx_n_s_tr_lyt_view, __pyx_k_tr_lyt_view, sizeof(__pyx_k_tr_lyt_view), 0, 0, 1, 1},
   {&__pyx_n_s_tr_set, __pyx_k_tr_set, sizeof(__pyx_k_tr_set), 0, 0, 1, 1},
-  {&__pyx_n_s_tr_set_mean, __pyx_k_tr_set_mean, sizeof(__pyx_k_tr_set_mean), 0, 0, 1, 1},
   {&__pyx_n_s_trace_len, __pyx_k_trace_len, sizeof(__pyx_k_trace_len), 0, 0, 1, 1},
   {&__pyx_n_s_traces, __pyx_k_traces, sizeof(__pyx_k_traces), 0, 0, 1, 1},
   {&__pyx_n_s_traces_cl, __pyx_k_traces_cl, sizeof(__pyx_k_traces_cl), 0, 0, 1, 1},
   {&__pyx_n_s_tri, __pyx_k_tri, sizeof(__pyx_k_tri), 0, 0, 1, 1},
   {&__pyx_n_s_tri_2, __pyx_k_tri_2, sizeof(__pyx_k_tri_2), 0, 0, 1, 1},
   {&__pyx_n_s_triu, __pyx_k_triu, sizeof(__pyx_k_triu), 0, 0, 1, 1},
   {&__pyx_n_s_triu_indices_from, __pyx_k_triu_indices_from, sizeof(__pyx_k_triu_indices_from), 0, 0, 1, 1},
   {&__pyx_n_s_triuflatten, __pyx_k_triuflatten, sizeof(__pyx_k_triuflatten), 0, 0, 1, 1},
   {&__pyx_n_s_triuflatten_gen, __pyx_k_triuflatten_gen, sizeof(__pyx_k_triuflatten_gen), 0, 0, 1, 1},
   {&__pyx_n_s_triuflatten_gen_locals__triu, __pyx_k_triuflatten_gen_locals__triu, sizeof(__pyx_k_triuflatten_gen_locals__triu), 0, 0, 1, 1},
+  {&__pyx_n_s_ts, __pyx_k_ts, sizeof(__pyx_k_ts), 0, 0, 1, 1},
   {&__pyx_n_s_ttest, __pyx_k_ttest, sizeof(__pyx_k_ttest), 0, 0, 1, 1},
+  {&__pyx_n_s_ttstdsz, __pyx_k_ttstdsz, sizeof(__pyx_k_ttstdsz), 0, 0, 1, 1},
   {&__pyx_n_s_ttsz, __pyx_k_ttsz, sizeof(__pyx_k_ttsz), 0, 0, 1, 1},
   {&__pyx_n_s_uint32, __pyx_k_uint32, sizeof(__pyx_k_uint32), 0, 0, 1, 1},
   {&__pyx_n_s_uint8, __pyx_k_uint8, sizeof(__pyx_k_uint8), 0, 0, 1, 1},
   {&__pyx_kp_s_unable_to_allocate_array_data, __pyx_k_unable_to_allocate_array_data, sizeof(__pyx_k_unable_to_allocate_array_data), 0, 0, 1, 0},
   {&__pyx_kp_s_unable_to_allocate_shape_and_str, __pyx_k_unable_to_allocate_shape_and_str, sizeof(__pyx_k_unable_to_allocate_shape_and_str), 0, 0, 1, 0},
   {&__pyx_n_s_univar_sum, __pyx_k_univar_sum, sizeof(__pyx_k_univar_sum), 0, 0, 1, 1},
   {&__pyx_n_s_univar_sum___init, __pyx_k_univar_sum___init, sizeof(__pyx_k_univar_sum___init), 0, 0, 1, 1},
@@ -57515,1401 +59831,1471 @@
   {&__pyx_n_s_vtk_to_numpy, __pyx_k_vtk_to_numpy, sizeof(__pyx_k_vtk_to_numpy), 0, 0, 1, 1},
   {&__pyx_n_s_vtk_util_numpy_support, __pyx_k_vtk_util_numpy_support, sizeof(__pyx_k_vtk_util_numpy_support), 0, 0, 1, 1},
   {&__pyx_n_s_zeros, __pyx_k_zeros, sizeof(__pyx_k_zeros), 0, 0, 1, 1},
   {&__pyx_n_s_zip, __pyx_k_zip, sizeof(__pyx_k_zip), 0, 0, 1, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_object = __Pyx_GetBuiltinName(__pyx_n_s_object); if (!__pyx_builtin_object) __PYX_ERR(0, 189, __pyx_L1_error)
-  __pyx_builtin_staticmethod = __Pyx_GetBuiltinName(__pyx_n_s_staticmethod); if (!__pyx_builtin_staticmethod) __PYX_ERR(0, 198, __pyx_L1_error)
-  __pyx_builtin_property = __Pyx_GetBuiltinName(__pyx_n_s_property); if (!__pyx_builtin_property) __PYX_ERR(0, 943, __pyx_L1_error)
-  __pyx_builtin_NotImplementedError = __Pyx_GetBuiltinName(__pyx_n_s_NotImplementedError); if (!__pyx_builtin_NotImplementedError) __PYX_ERR(0, 200, __pyx_L1_error)
-  __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(0, 229, __pyx_L1_error)
-  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 246, __pyx_L1_error)
-  __pyx_builtin_super = __Pyx_GetBuiltinName(__pyx_n_s_super); if (!__pyx_builtin_super) __PYX_ERR(0, 330, __pyx_L1_error)
-  __pyx_builtin_sum = __Pyx_GetBuiltinName(__pyx_n_s_sum); if (!__pyx_builtin_sum) __PYX_ERR(0, 356, __pyx_L1_error)
-  __pyx_builtin_vars = __Pyx_GetBuiltinName(__pyx_n_s_vars); if (!__pyx_builtin_vars) __PYX_ERR(0, 356, __pyx_L1_error)
-  __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(0, 375, __pyx_L1_error)
-  __pyx_builtin_zip = __Pyx_GetBuiltinName(__pyx_n_s_zip); if (!__pyx_builtin_zip) __PYX_ERR(0, 459, __pyx_L1_error)
-  __pyx_builtin_map = __Pyx_GetBuiltinName(__pyx_n_s_map); if (!__pyx_builtin_map) __PYX_ERR(0, 793, __pyx_L1_error)
+  __pyx_builtin_object = __Pyx_GetBuiltinName(__pyx_n_s_object); if (!__pyx_builtin_object) __PYX_ERR(0, 206, __pyx_L1_error)
+  __pyx_builtin_staticmethod = __Pyx_GetBuiltinName(__pyx_n_s_staticmethod); if (!__pyx_builtin_staticmethod) __PYX_ERR(0, 215, __pyx_L1_error)
+  __pyx_builtin_property = __Pyx_GetBuiltinName(__pyx_n_s_property); if (!__pyx_builtin_property) __PYX_ERR(0, 1025, __pyx_L1_error)
+  __pyx_builtin_print = __Pyx_GetBuiltinName(__pyx_n_s_print); if (!__pyx_builtin_print) __PYX_ERR(0, 25, __pyx_L1_error)
+  __pyx_builtin_NotImplementedError = __Pyx_GetBuiltinName(__pyx_n_s_NotImplementedError); if (!__pyx_builtin_NotImplementedError) __PYX_ERR(0, 217, __pyx_L1_error)
+  __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(0, 246, __pyx_L1_error)
+  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 264, __pyx_L1_error)
+  __pyx_builtin_super = __Pyx_GetBuiltinName(__pyx_n_s_super); if (!__pyx_builtin_super) __PYX_ERR(0, 352, __pyx_L1_error)
+  __pyx_builtin_sum = __Pyx_GetBuiltinName(__pyx_n_s_sum); if (!__pyx_builtin_sum) __PYX_ERR(0, 379, __pyx_L1_error)
+  __pyx_builtin_vars = __Pyx_GetBuiltinName(__pyx_n_s_vars); if (!__pyx_builtin_vars) __PYX_ERR(0, 379, __pyx_L1_error)
+  __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(0, 399, __pyx_L1_error)
+  __pyx_builtin_zip = __Pyx_GetBuiltinName(__pyx_n_s_zip); if (!__pyx_builtin_zip) __PYX_ERR(0, 498, __pyx_L1_error)
+  __pyx_builtin_min = __Pyx_GetBuiltinName(__pyx_n_s_min); if (!__pyx_builtin_min) __PYX_ERR(0, 735, __pyx_L1_error)
+  __pyx_builtin_map = __Pyx_GetBuiltinName(__pyx_n_s_map); if (!__pyx_builtin_map) __PYX_ERR(0, 1023, __pyx_L1_error)
   __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(1, 149, __pyx_L1_error)
   __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(1, 2, __pyx_L1_error)
   __pyx_builtin_Ellipsis = __Pyx_GetBuiltinName(__pyx_n_s_Ellipsis); if (!__pyx_builtin_Ellipsis) __PYX_ERR(1, 406, __pyx_L1_error)
   __pyx_builtin_id = __Pyx_GetBuiltinName(__pyx_n_s_id); if (!__pyx_builtin_id) __PYX_ERR(1, 615, __pyx_L1_error)
   __pyx_builtin_IndexError = __Pyx_GetBuiltinName(__pyx_n_s_IndexError); if (!__pyx_builtin_IndexError) __PYX_ERR(1, 834, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitCachedConstants(void) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);
 
-  /* "statmoments/_native.pyx":200
+  /* "statmoments/_native.pyx":25
+ *   try:
+ *     import vtk
+ *     print("VTK is installed and used")             # <<<<<<<<<<<<<<
+ *     return True
+ *   except ModuleNotFoundError:
+ */
+  __pyx_tuple_ = PyTuple_Pack(1, __pyx_kp_u_VTK_is_installed_and_used); if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 25, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple_);
+  __Pyx_GIVEREF(__pyx_tuple_);
+
+  /* "statmoments/_native.pyx":28
+ *     return True
+ *   except ModuleNotFoundError:
+ *     print("VTK is not installed")             # <<<<<<<<<<<<<<
+ *     return False
+ * 
+ */
+  __pyx_tuple__2 = PyTuple_Pack(1, __pyx_kp_u_VTK_is_not_installed); if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 28, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__2);
+  __Pyx_GIVEREF(__pyx_tuple__2);
+
+  /* "statmoments/_native.pyx":217
  *   @staticmethod
- *   def estimate_mem_size(trace_len, classifier_len=1, moment=2):
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):
  *     raise NotImplementedError("Must be implemented in an inherited class")             # <<<<<<<<<<<<<<
  * 
  *   def memory_size(self):
  */
-  __pyx_tuple_ = PyTuple_Pack(1, __pyx_kp_u_Must_be_implemented_in_an_inheri); if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 200, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple_);
-  __Pyx_GIVEREF(__pyx_tuple_);
+  __pyx_tuple__3 = PyTuple_Pack(1, __pyx_kp_u_Must_be_implemented_in_an_inheri); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 217, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__3);
+  __Pyx_GIVEREF(__pyx_tuple__3);
 
-  /* "statmoments/_native.pyx":226
+  /* "statmoments/_native.pyx":243
  *   def comoments(self, moments=None, normalize=None):
  *     """Return a generator yielding the requested set of bivariate comoments for each classifier"""
  *     moments = moments if moments is not None else np.broadcast_to(self.moment, (2, 1))             # <<<<<<<<<<<<<<
  *     normalize = normalize if normalize is not None else self.normalize
  *     if len(moments[0]) != len(moments[1]):
  */
-  __pyx_tuple__2 = PyTuple_Pack(2, __pyx_int_2, __pyx_int_1); if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 226, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__2);
-  __Pyx_GIVEREF(__pyx_tuple__2);
+  __pyx_tuple__4 = PyTuple_Pack(2, __pyx_int_2, __pyx_int_1); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 243, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__4);
+  __Pyx_GIVEREF(__pyx_tuple__4);
 
-  /* "statmoments/_native.pyx":229
+  /* "statmoments/_native.pyx":246
  *     normalize = normalize if normalize is not None else self.normalize
  *     if len(moments[0]) != len(moments[1]):
  *       raise ValueError("The input moment lists should have equal lengths.")             # <<<<<<<<<<<<<<
  * 
  *     if self.moment < np.max(moments):
  */
-  __pyx_tuple__3 = PyTuple_Pack(1, __pyx_kp_u_The_input_moment_lists_should_ha); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 229, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__3);
-  __Pyx_GIVEREF(__pyx_tuple__3);
+  __pyx_tuple__5 = PyTuple_Pack(1, __pyx_kp_u_The_input_moment_lists_should_ha); if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 246, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__5);
+  __Pyx_GIVEREF(__pyx_tuple__5);
 
-  /* "statmoments/_native.pyx":232
+  /* "statmoments/_native.pyx":249
  * 
  *     if self.moment < np.max(moments):
  *       raise ValueError("The input moment should be less or equal than indicated in constructor.")             # <<<<<<<<<<<<<<
  * 
  *     self._ensure_ret(len(moments[0]))
  */
-  __pyx_tuple__4 = PyTuple_Pack(1, __pyx_kp_u_The_input_moment_should_be_less); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 232, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__4);
-  __Pyx_GIVEREF(__pyx_tuple__4);
+  __pyx_tuple__6 = PyTuple_Pack(1, __pyx_kp_u_The_input_moment_should_be_less); if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 249, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__6);
+  __Pyx_GIVEREF(__pyx_tuple__6);
 
-  /* "statmoments/_native.pyx":263
+  /* "statmoments/_native.pyx":280
  * 
  *   for p in range(2, k + 1):
- *     com += (-1) ** (k + l - p) * binom(k, p) * raw[0,:,p-2,:][i, i]            * ave_j ** l * ave_i ** (k - p)             # <<<<<<<<<<<<<<
+ *     edge_val = raw[0, :, p - 2, :][i, i]             # <<<<<<<<<<<<<<
+ *     com += (-1) ** (k + l - p) * binom(k, p) * edge_val * ave_j ** l * ave_i ** (k - p)
  *   for q in range(2, l + 1):
- *     com += (-1) ** (k + l - q) * binom(l, q) * raw[0,:,q-2,:][j, j].diagonal() * ave_i ** k * ave_j ** (l - q)
- */
-  __pyx_slice__5 = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__5)) __PYX_ERR(0, 263, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_slice__5);
-  __Pyx_GIVEREF(__pyx_slice__5);
-
-  /* "statmoments/_native.pyx":284
- *   # Horner representation generated with sympy
- *   if lm + rm == 2:                             # E(X Y)
- *     M_11 = raw[0,:,0,:]             # <<<<<<<<<<<<<<
- *     m = M_11[i, j] * inv_n - ave_i * ave_j
- *   elif lm + rm == 3:                           # E(XX Y)
  */
-  __pyx_tuple__6 = PyTuple_Pack(4, __pyx_int_0, __pyx_slice__5, __pyx_int_0, __pyx_slice__5); if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 284, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__6);
-  __Pyx_GIVEREF(__pyx_tuple__6);
+  __pyx_slice__7 = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__7)) __PYX_ERR(0, 280, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__7);
+  __Pyx_GIVEREF(__pyx_slice__7);
 
-  /* "statmoments/_native.pyx":288
- *   elif lm + rm == 3:                           # E(XX Y)
- *     M_11 = raw[0,:,0,:]  # 0
- *     M_12 = raw[0,:,1,:]             # <<<<<<<<<<<<<<
- *     m = ave_j*(2*n*ave_i*ave_j - 2*M_11[i, j]) \
- *         - ave_i*M_11[j, j].diagonal() \
- */
-  __pyx_tuple__7 = PyTuple_Pack(4, __pyx_int_0, __pyx_slice__5, __pyx_int_1, __pyx_slice__5); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 288, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__7);
-  __Pyx_GIVEREF(__pyx_tuple__7);
-
-  /* "statmoments/_native.pyx":296
- *     M_11 = raw[0,:,0,:]  # 0
- *     M_12 = raw[0,:,1,:]
- *     M_22 = raw[1,:,1,:]  # 1             # <<<<<<<<<<<<<<
- *     m = ave_i*(ave_i*M_11[j, j].diagonal() - 2 * M_12[i, j]) \
- *         + ave_j*(4*ave_i*M_11[i, j] + ave_j*(M_11[i, i] - 3*n*ave_i*ave_i) - 2*M_12[j, i]) \
+  /* "statmoments/_native.pyx":305
+ *     pass # Helps formatting for all cases
+ *   elif lm == 1 and rm == 1:  # E(X Y)
+ *     M_11 = raw[0, :, 0, :]   # 0             # <<<<<<<<<<<<<<
+ *     m = M_11[i, j] * inv_n - ave_i * ave_j
+ *   elif lm + rm == 3:         # E(XX Y)
  */
-  __pyx_tuple__8 = PyTuple_Pack(4, __pyx_int_1, __pyx_slice__5, __pyx_int_1, __pyx_slice__5); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 296, __pyx_L1_error)
+  __pyx_tuple__8 = PyTuple_Pack(4, __pyx_int_0, __pyx_slice__7, __pyx_int_0, __pyx_slice__7); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 305, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__8);
   __Pyx_GIVEREF(__pyx_tuple__8);
 
-  /* "statmoments/_native.pyx":304
- *     M_11 = raw[0,:,0,:]  # 0
- *     M_12 = raw[0,:,1,:]
- *     M_13 = raw[0,:,2,:]             # <<<<<<<<<<<<<<
- *     M_14 = raw[0,:,3,:]
- *     M_22 = raw[1,:,1,:]  # 1
+  /* "statmoments/_native.pyx":309
+ *   elif lm + rm == 3:         # E(XX Y)
+ *     M_11 = raw[0, :, 0, :]   # 0
+ *     M_12 = raw[0, :, 1, :]             # <<<<<<<<<<<<<<
+ *     m = ave_j * (2 * n * ave_i * ave_j - 2 * M_11[i, j]) \
+ *         - ave_i * M_11[j, j].diagonal() \
  */
-  __pyx_tuple__9 = PyTuple_Pack(4, __pyx_int_0, __pyx_slice__5, __pyx_int_2, __pyx_slice__5); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 304, __pyx_L1_error)
+  __pyx_tuple__9 = PyTuple_Pack(4, __pyx_int_0, __pyx_slice__7, __pyx_int_1, __pyx_slice__7); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 309, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__9);
   __Pyx_GIVEREF(__pyx_tuple__9);
 
-  /* "statmoments/_native.pyx":305
- *     M_12 = raw[0,:,1,:]
- *     M_13 = raw[0,:,2,:]
- *     M_14 = raw[0,:,3,:]             # <<<<<<<<<<<<<<
- *     M_22 = raw[1,:,1,:]  # 1
- *     M_23 = raw[1,:,2,:]
+  /* "statmoments/_native.pyx":317
+ *     M_11 = raw[0, :, 0, :]   # 0
+ *     M_12 = raw[0, :, 1, :]
+ *     M_22 = raw[1, :, 1, :]   # 1             # <<<<<<<<<<<<<<
+ *     m = ave_i * (ave_i * M_11[j, j].diagonal() - 2 * M_12[i, j]) \
+ *         + ave_j * (4 * ave_i * M_11[i, j] + ave_j * (M_11[i, i] - 3 * n * ave_i * ave_i) - 2 * M_12[j, i]) \
  */
-  __pyx_tuple__10 = PyTuple_Pack(4, __pyx_int_0, __pyx_slice__5, __pyx_int_3, __pyx_slice__5); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 305, __pyx_L1_error)
+  __pyx_tuple__10 = PyTuple_Pack(4, __pyx_int_1, __pyx_slice__7, __pyx_int_1, __pyx_slice__7); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 317, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__10);
   __Pyx_GIVEREF(__pyx_tuple__10);
 
-  /* "statmoments/_native.pyx":307
- *     M_14 = raw[0,:,3,:]
- *     M_22 = raw[1,:,1,:]  # 1
- *     M_23 = raw[1,:,2,:]             # <<<<<<<<<<<<<<
- *     M_24 = raw[1,:,3,:]
- *     M_33 = raw[2,:,2,:]  # 2
+  /* "statmoments/_native.pyx":325
+ *     M_11 = raw[0, :, 0, :]   # 0
+ *     M_12 = raw[0, :, 1, :]
+ *     M_13 = raw[0, :, 2, :]             # <<<<<<<<<<<<<<
+ *     M_14 = raw[0, :, 3, :]
+ *     M_22 = raw[1, :, 1, :]   # 1
  */
-  __pyx_tuple__11 = PyTuple_Pack(4, __pyx_int_1, __pyx_slice__5, __pyx_int_2, __pyx_slice__5); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 307, __pyx_L1_error)
+  __pyx_tuple__11 = PyTuple_Pack(4, __pyx_int_0, __pyx_slice__7, __pyx_int_2, __pyx_slice__7); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 325, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__11);
   __Pyx_GIVEREF(__pyx_tuple__11);
 
-  /* "statmoments/_native.pyx":308
- *     M_22 = raw[1,:,1,:]  # 1
- *     M_23 = raw[1,:,2,:]
- *     M_24 = raw[1,:,3,:]             # <<<<<<<<<<<<<<
- *     M_33 = raw[2,:,2,:]  # 2
- *     M_34 = raw[2,:,3,:]
+  /* "statmoments/_native.pyx":326
+ *     M_12 = raw[0, :, 1, :]
+ *     M_13 = raw[0, :, 2, :]
+ *     M_14 = raw[0, :, 3, :]             # <<<<<<<<<<<<<<
+ *     M_22 = raw[1, :, 1, :]   # 1
+ *     M_23 = raw[1, :, 2, :]
  */
-  __pyx_tuple__12 = PyTuple_Pack(4, __pyx_int_1, __pyx_slice__5, __pyx_int_3, __pyx_slice__5); if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 308, __pyx_L1_error)
+  __pyx_tuple__12 = PyTuple_Pack(4, __pyx_int_0, __pyx_slice__7, __pyx_int_3, __pyx_slice__7); if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 326, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__12);
   __Pyx_GIVEREF(__pyx_tuple__12);
 
-  /* "statmoments/_native.pyx":309
- *     M_23 = raw[1,:,2,:]
- *     M_24 = raw[1,:,3,:]
- *     M_33 = raw[2,:,2,:]  # 2             # <<<<<<<<<<<<<<
- *     M_34 = raw[2,:,3,:]
- *     M_44 = raw[3,:,3,:]  # 3
+  /* "statmoments/_native.pyx":328
+ *     M_14 = raw[0, :, 3, :]
+ *     M_22 = raw[1, :, 1, :]   # 1
+ *     M_23 = raw[1, :, 2, :]             # <<<<<<<<<<<<<<
+ *     M_24 = raw[1, :, 3, :]
+ *     M_33 = raw[2, :, 2, :]   # 2
  */
-  __pyx_tuple__13 = PyTuple_Pack(4, __pyx_int_2, __pyx_slice__5, __pyx_int_2, __pyx_slice__5); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 309, __pyx_L1_error)
+  __pyx_tuple__13 = PyTuple_Pack(4, __pyx_int_1, __pyx_slice__7, __pyx_int_2, __pyx_slice__7); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 328, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__13);
   __Pyx_GIVEREF(__pyx_tuple__13);
 
-  /* "statmoments/_native.pyx":310
- *     M_24 = raw[1,:,3,:]
- *     M_33 = raw[2,:,2,:]  # 2
- *     M_34 = raw[2,:,3,:]             # <<<<<<<<<<<<<<
- *     M_44 = raw[3,:,3,:]  # 3
- *     m = ave_i * (-4 * M_34[i, j] + ave_i * (6 * M_24[i, j] + ave_i * (M_13[j, j].diagonal() * ave_i - 4 * M_14[i, j]))) \
+  /* "statmoments/_native.pyx":329
+ *     M_22 = raw[1, :, 1, :]   # 1
+ *     M_23 = raw[1, :, 2, :]
+ *     M_24 = raw[1, :, 3, :]             # <<<<<<<<<<<<<<
+ *     M_33 = raw[2, :, 2, :]   # 2
+ *     M_34 = raw[2, :, 3, :]
  */
-  __pyx_tuple__14 = PyTuple_Pack(4, __pyx_int_2, __pyx_slice__5, __pyx_int_3, __pyx_slice__5); if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 310, __pyx_L1_error)
+  __pyx_tuple__14 = PyTuple_Pack(4, __pyx_int_1, __pyx_slice__7, __pyx_int_3, __pyx_slice__7); if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 329, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__14);
   __Pyx_GIVEREF(__pyx_tuple__14);
 
-  /* "statmoments/_native.pyx":311
- *     M_33 = raw[2,:,2,:]  # 2
- *     M_34 = raw[2,:,3,:]
- *     M_44 = raw[3,:,3,:]  # 3             # <<<<<<<<<<<<<<
- *     m = ave_i * (-4 * M_34[i, j] + ave_i * (6 * M_24[i, j] + ave_i * (M_13[j, j].diagonal() * ave_i - 4 * M_14[i, j]))) \
- *         + ave_j * (-4 * M_34[j, i] \
+  /* "statmoments/_native.pyx":330
+ *     M_23 = raw[1, :, 2, :]
+ *     M_24 = raw[1, :, 3, :]
+ *     M_33 = raw[2, :, 2, :]   # 2             # <<<<<<<<<<<<<<
+ *     M_34 = raw[2, :, 3, :]
+ *     M_44 = raw[3, :, 3, :]   # 3
  */
-  __pyx_tuple__15 = PyTuple_Pack(4, __pyx_int_3, __pyx_slice__5, __pyx_int_3, __pyx_slice__5); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 311, __pyx_L1_error)
+  __pyx_tuple__15 = PyTuple_Pack(4, __pyx_int_2, __pyx_slice__7, __pyx_int_2, __pyx_slice__7); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 330, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__15);
   __Pyx_GIVEREF(__pyx_tuple__15);
 
-  /* "statmoments/_native.pyx":370
+  /* "statmoments/_native.pyx":331
+ *     M_24 = raw[1, :, 3, :]
+ *     M_33 = raw[2, :, 2, :]   # 2
+ *     M_34 = raw[2, :, 3, :]             # <<<<<<<<<<<<<<
+ *     M_44 = raw[3, :, 3, :]   # 3
+ *     m = ave_i * (-4 * M_34[i, j] + ave_i * (6 * M_24[i, j] + ave_i * (M_13[j, j].diagonal() * ave_i - 4 * M_14[i, j]))) \
+ */
+  __pyx_tuple__16 = PyTuple_Pack(4, __pyx_int_2, __pyx_slice__7, __pyx_int_3, __pyx_slice__7); if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 331, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__16);
+  __Pyx_GIVEREF(__pyx_tuple__16);
+
+  /* "statmoments/_native.pyx":332
+ *     M_33 = raw[2, :, 2, :]   # 2
+ *     M_34 = raw[2, :, 3, :]
+ *     M_44 = raw[3, :, 3, :]   # 3             # <<<<<<<<<<<<<<
+ *     m = ave_i * (-4 * M_34[i, j] + ave_i * (6 * M_24[i, j] + ave_i * (M_13[j, j].diagonal() * ave_i - 4 * M_14[i, j]))) \
+ *         + ave_j * (-4 * M_34[j, i] \
+ */
+  __pyx_tuple__17 = PyTuple_Pack(4, __pyx_int_3, __pyx_slice__7, __pyx_int_3, __pyx_slice__7); if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 332, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__17);
+  __Pyx_GIVEREF(__pyx_tuple__17);
+
+  /* "statmoments/_native.pyx":394
  * 
  *     tr_lyt = self._layout[:batch_cnt]
  *     tr_lyt[:, 0] = 1             # <<<<<<<<<<<<<<
  *     tr_lyt_view = tr_lyt[:, 1:].reshape(batch_cnt, moment, tr_len)
  *     for i in range(cl_len):
  */
-  __pyx_tuple__16 = PyTuple_Pack(2, __pyx_slice__5, __pyx_int_0); if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 370, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__16);
-  __Pyx_GIVEREF(__pyx_tuple__16);
+  __pyx_tuple__18 = PyTuple_Pack(2, __pyx_slice__7, __pyx_int_0); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 394, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__18);
+  __Pyx_GIVEREF(__pyx_tuple__18);
 
-  /* "statmoments/_native.pyx":371
+  /* "statmoments/_native.pyx":395
  *     tr_lyt = self._layout[:batch_cnt]
  *     tr_lyt[:, 0] = 1
  *     tr_lyt_view = tr_lyt[:, 1:].reshape(batch_cnt, moment, tr_len)             # <<<<<<<<<<<<<<
  *     for i in range(cl_len):
  *       n0, n1 = 0, 0
  */
-  __pyx_slice__17 = PySlice_New(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__17)) __PYX_ERR(0, 371, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_slice__17);
-  __Pyx_GIVEREF(__pyx_slice__17);
-  __pyx_tuple__18 = PyTuple_Pack(2, __pyx_slice__5, __pyx_slice__17); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 371, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__18);
-  __Pyx_GIVEREF(__pyx_tuple__18);
+  __pyx_slice__19 = PySlice_New(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__19)) __PYX_ERR(0, 395, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__19);
+  __Pyx_GIVEREF(__pyx_slice__19);
+  __pyx_tuple__20 = PyTuple_Pack(2, __pyx_slice__7, __pyx_slice__19); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 395, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__20);
+  __Pyx_GIVEREF(__pyx_tuple__20);
 
-  /* "statmoments/_native.pyx":385
+  /* "statmoments/_native.pyx":409
  *       # Step 1: Create layout matrix up to moment degree
  *       for j in range(1, moment):
  *         np.multiply(tr_lyt_view[:, 0, :], tr_lyt_view[:, j - 1, :], tr_lyt_view[:, j, :])             # <<<<<<<<<<<<<<
  * 
  *       # Step 2: Gram multiplication accumulates sums of all combinations of all degrees
  */
-  __pyx_tuple__19 = PyTuple_Pack(3, __pyx_slice__5, __pyx_int_0, __pyx_slice__5); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 385, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__19);
-  __Pyx_GIVEREF(__pyx_tuple__19);
+  __pyx_tuple__21 = PyTuple_Pack(3, __pyx_slice__7, __pyx_int_0, __pyx_slice__7); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 409, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__21);
+  __Pyx_GIVEREF(__pyx_tuple__21);
 
-  /* "statmoments/_native.pyx":391
+  /* "statmoments/_native.pyx":415
  *         # syrk: acc0 += T0 * T0.T
  *         if tr_lyt.dtype == np.float64:
  *           dsyrk(tr_lyt[:n0], self._accs[i, :-1], b'L')             # <<<<<<<<<<<<<<
  *         else:
  *           ssyrk(tr_lyt[:n0], self._accs[i, :-1], b'L')
  */
-  __pyx_slice__20 = PySlice_New(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__20)) __PYX_ERR(0, 391, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_slice__20);
-  __Pyx_GIVEREF(__pyx_slice__20);
+  __pyx_slice__22 = PySlice_New(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__22)) __PYX_ERR(0, 415, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__22);
+  __Pyx_GIVEREF(__pyx_slice__22);
 
-  /* "statmoments/_native.pyx":404
+  /* "statmoments/_native.pyx":428
  *     accs = self._accs[i]
  *     acc0, acc1 = accs, accs[1:].T
  *     return acc0[0, 0], acc1[0, 0]             # <<<<<<<<<<<<<<
  * 
  *   def _moments(self, moments, normalize):
  */
-  __pyx_tuple__21 = PyTuple_Pack(2, __pyx_int_0, __pyx_int_0); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 404, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__21);
-  __Pyx_GIVEREF(__pyx_tuple__21);
+  __pyx_tuple__23 = PyTuple_Pack(2, __pyx_int_0, __pyx_int_0); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 428, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__23);
+  __Pyx_GIVEREF(__pyx_tuple__23);
 
-  /* "statmoments/_native.pyx":409
+  /* "statmoments/_native.pyx":433
  *     maxm = np.max(moments)
  *     if self.moment * 2 < maxm:
  *       raise ValueError("The moment should be less or equal than indicated in constructor.")             # <<<<<<<<<<<<<<
  * 
- *     moments = [m-1 for m in moments]
- */
-  __pyx_tuple__23 = PyTuple_Pack(1, __pyx_kp_u_The_moment_should_be_less_or_equ); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 409, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__23);
-  __Pyx_GIVEREF(__pyx_tuple__23);
-
-  /* "statmoments/_native.pyx":431
- *       # Get mean
- *       cm[0, 0] = acc0[0, 1: 1 + tr_len]
- *       cm[1, 0] = acc1[0, 1: 1 + tr_len]             # <<<<<<<<<<<<<<
- * 
- *       # and higher raw moments
+ *     moments = [m - 1 for m in moments]
  */
-  __pyx_tuple__24 = PyTuple_Pack(2, __pyx_int_1, __pyx_int_0); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 431, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__24);
-  __Pyx_GIVEREF(__pyx_tuple__24);
+  __pyx_tuple__25 = PyTuple_Pack(1, __pyx_kp_u_The_moment_should_be_less_or_equ); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 433, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__25);
+  __Pyx_GIVEREF(__pyx_tuple__25);
 
-  /* "statmoments/_native.pyx":510
+  /* "statmoments/_native.pyx":536
  *     super().__init__(trace_len, classifier_len, **kwargs)
  *     self._dbuf = np.zeros((1, self.trace_len), dtype=self._dtype)[1:]
- *     self._cbuf = np.asarray([bytearray(b'2') * classifier_len], dtype=np.uint8)[1:] # 2 is non existing element             # <<<<<<<<<<<<<<
+ *     self._cbuf = np.asarray([bytearray(b'2') * classifier_len], dtype=np.uint8)[1:]  # 2 is non existing element             # <<<<<<<<<<<<<<
  *     self._detrend_cnt = kwargs.pop('detrend_cnt', 10)
  * 
  */
-  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_b_2); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 510, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__26);
-  __Pyx_GIVEREF(__pyx_tuple__26);
+  __pyx_tuple__27 = PyTuple_Pack(1, __pyx_kp_b_2); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 536, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__27);
+  __Pyx_GIVEREF(__pyx_tuple__27);
 
-  /* "statmoments/_native.pyx":544
+  /* "statmoments/_native.pyx":571
  * def _triuflatten_gen(n):
  *   _ndx = np.triu_indices_from(np.empty((n, n)))
  *   def _triu(tr2d):             # <<<<<<<<<<<<<<
  *     return tr2d[_ndx]
  *   return _triu
  */
-  __pyx_tuple__28 = PyTuple_Pack(1, __pyx_n_s_tr2d); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(0, 544, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__28);
-  __Pyx_GIVEREF(__pyx_tuple__28);
-  __pyx_codeobj__29 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__28, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_triu, 544, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__29)) __PYX_ERR(0, 544, __pyx_L1_error)
+  __pyx_tuple__29 = PyTuple_Pack(1, __pyx_n_s_tr2d); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 571, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__29);
+  __Pyx_GIVEREF(__pyx_tuple__29);
+  __pyx_codeobj__30 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__29, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_triu, 571, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__30)) __PYX_ERR(0, 571, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":791
- * 
- *   def memory_size(self):
- *     def _sz_helper(inst):             # <<<<<<<<<<<<<<
- *       return sum(v.nbytes for v in inst if isinstance(v, np.ndarray))
- *     mem_class =  sum(map(_sz_helper, [vars(self).values()]))
- */
-  __pyx_tuple__32 = PyTuple_Pack(3, __pyx_n_s_inst, __pyx_n_s_genexpr, __pyx_n_s_genexpr); if (unlikely(!__pyx_tuple__32)) __PYX_ERR(0, 791, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__32);
-  __Pyx_GIVEREF(__pyx_tuple__32);
-  __pyx_codeobj__33 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__32, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_sz_helper, 791, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__33)) __PYX_ERR(0, 791, __pyx_L1_error)
-
-  /* "statmoments/_native.pyx":934
+  /* "statmoments/_native.pyx":1014
  * 
  *   def memory_size(self):
  *     def _ms_helper(instl):             # <<<<<<<<<<<<<<
  *       return sum(i.GetActualMemorySize() for i in instl)
  * 
  */
-  __pyx_tuple__37 = PyTuple_Pack(3, __pyx_n_s_instl, __pyx_n_s_genexpr, __pyx_n_s_genexpr); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(0, 934, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__37);
-  __Pyx_GIVEREF(__pyx_tuple__37);
-  __pyx_codeobj__38 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__37, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_ms_helper, 934, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__38)) __PYX_ERR(0, 934, __pyx_L1_error)
+  __pyx_tuple__36 = PyTuple_Pack(3, __pyx_n_s_instl, __pyx_n_s_genexpr, __pyx_n_s_genexpr); if (unlikely(!__pyx_tuple__36)) __PYX_ERR(0, 1014, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__36);
+  __Pyx_GIVEREF(__pyx_tuple__36);
+  __pyx_codeobj__37 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__36, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_ms_helper, 1014, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__37)) __PYX_ERR(0, 1014, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":980
+  /* "statmoments/_native.pyx":1062
  * 
  *     if normalize:
  *       raise NotImplementedError("Not implemented")             # <<<<<<<<<<<<<<
  * 
  *     tr_len, min_cnt = self.trace_len, self.acc_min_count
  */
-  __pyx_tuple__40 = PyTuple_Pack(1, __pyx_kp_u_Not_implemented); if (unlikely(!__pyx_tuple__40)) __PYX_ERR(0, 980, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__40);
-  __Pyx_GIVEREF(__pyx_tuple__40);
+  __pyx_tuple__39 = PyTuple_Pack(1, __pyx_kp_u_Not_implemented); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__39);
+  __Pyx_GIVEREF(__pyx_tuple__39);
 
-  /* "statmoments/_native.pyx":1070
+  /* "statmoments/_native.pyx":1168
  *     cm, buf = self._retm, self._buf
- *     moments = [m-1 for m in moments]
+ *     moments = [m - 1 for m in moments]
  *     nT, accT = self._accs[0, 0], self._accs[0, 1:].reshape(self._retm.shape[1:])             # <<<<<<<<<<<<<<
  * 
  *     for acc1 in self._accs[1:]:
  */
-  __pyx_tuple__43 = PyTuple_Pack(2, __pyx_int_0, __pyx_slice__17); if (unlikely(!__pyx_tuple__43)) __PYX_ERR(0, 1070, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__43);
-  __Pyx_GIVEREF(__pyx_tuple__43);
+  __pyx_tuple__42 = PyTuple_Pack(2, __pyx_int_0, __pyx_slice__19); if (unlikely(!__pyx_tuple__42)) __PYX_ERR(0, 1168, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__42);
+  __Pyx_GIVEREF(__pyx_tuple__42);
 
   /* "View.MemoryView":134
  * 
  *         if not self.ndim:
  *             raise ValueError("Empty shape tuple for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if itemsize <= 0:
  */
-  __pyx_tuple__45 = PyTuple_Pack(1, __pyx_kp_s_Empty_shape_tuple_for_cython_arr); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(1, 134, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__45);
-  __Pyx_GIVEREF(__pyx_tuple__45);
+  __pyx_tuple__44 = PyTuple_Pack(1, __pyx_kp_s_Empty_shape_tuple_for_cython_arr); if (unlikely(!__pyx_tuple__44)) __PYX_ERR(1, 134, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__44);
+  __Pyx_GIVEREF(__pyx_tuple__44);
 
   /* "View.MemoryView":137
  * 
  *         if itemsize <= 0:
  *             raise ValueError("itemsize <= 0 for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if not isinstance(format, bytes):
  */
-  __pyx_tuple__46 = PyTuple_Pack(1, __pyx_kp_s_itemsize_0_for_cython_array); if (unlikely(!__pyx_tuple__46)) __PYX_ERR(1, 137, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__46);
-  __Pyx_GIVEREF(__pyx_tuple__46);
+  __pyx_tuple__45 = PyTuple_Pack(1, __pyx_kp_s_itemsize_0_for_cython_array); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(1, 137, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__45);
+  __Pyx_GIVEREF(__pyx_tuple__45);
 
   /* "View.MemoryView":149
  * 
  *         if not self._shape:
  *             raise MemoryError("unable to allocate shape and strides.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__47 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_shape_and_str); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(1, 149, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__47);
-  __Pyx_GIVEREF(__pyx_tuple__47);
+  __pyx_tuple__46 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_shape_and_str); if (unlikely(!__pyx_tuple__46)) __PYX_ERR(1, 149, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__46);
+  __Pyx_GIVEREF(__pyx_tuple__46);
 
   /* "View.MemoryView":177
  *             self.data = <char *>malloc(self.len)
  *             if not self.data:
  *                 raise MemoryError("unable to allocate array data.")             # <<<<<<<<<<<<<<
  * 
  *             if self.dtype_is_object:
  */
-  __pyx_tuple__48 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_array_data); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(1, 177, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__48);
-  __Pyx_GIVEREF(__pyx_tuple__48);
+  __pyx_tuple__47 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_array_data); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(1, 177, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__47);
+  __Pyx_GIVEREF(__pyx_tuple__47);
 
   /* "View.MemoryView":193
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         if not (flags & bufmode):
  *             raise ValueError("Can only create a buffer that is contiguous in memory.")             # <<<<<<<<<<<<<<
  *         info.buf = self.data
  *         info.len = self.len
  */
-  __pyx_tuple__49 = PyTuple_Pack(1, __pyx_kp_s_Can_only_create_a_buffer_that_is); if (unlikely(!__pyx_tuple__49)) __PYX_ERR(1, 193, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__49);
-  __Pyx_GIVEREF(__pyx_tuple__49);
+  __pyx_tuple__48 = PyTuple_Pack(1, __pyx_kp_s_Can_only_create_a_buffer_that_is); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(1, 193, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__48);
+  __Pyx_GIVEREF(__pyx_tuple__48);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__50 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__50)) __PYX_ERR(1, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__50);
-  __Pyx_GIVEREF(__pyx_tuple__50);
+  __pyx_tuple__49 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__49)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__49);
+  __Pyx_GIVEREF(__pyx_tuple__49);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__51 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__51)) __PYX_ERR(1, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__51);
-  __Pyx_GIVEREF(__pyx_tuple__51);
+  __pyx_tuple__50 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__50)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__50);
+  __Pyx_GIVEREF(__pyx_tuple__50);
 
   /* "View.MemoryView":420
  *     def __setitem__(memoryview self, object index, object value):
  *         if self.view.readonly:
  *             raise TypeError("Cannot assign to read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         have_slices, index = _unellipsify(index, self.view.ndim)
  */
-  __pyx_tuple__52 = PyTuple_Pack(1, __pyx_kp_s_Cannot_assign_to_read_only_memor); if (unlikely(!__pyx_tuple__52)) __PYX_ERR(1, 420, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__52);
-  __Pyx_GIVEREF(__pyx_tuple__52);
+  __pyx_tuple__51 = PyTuple_Pack(1, __pyx_kp_s_Cannot_assign_to_read_only_memor); if (unlikely(!__pyx_tuple__51)) __PYX_ERR(1, 420, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__51);
+  __Pyx_GIVEREF(__pyx_tuple__51);
 
   /* "View.MemoryView":497
  *             result = struct.unpack(self.view.format, bytesitem)
  *         except struct.error:
  *             raise ValueError("Unable to convert item to object")             # <<<<<<<<<<<<<<
  *         else:
  *             if len(self.view.format) == 1:
  */
-  __pyx_tuple__53 = PyTuple_Pack(1, __pyx_kp_s_Unable_to_convert_item_to_object); if (unlikely(!__pyx_tuple__53)) __PYX_ERR(1, 497, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__53);
-  __Pyx_GIVEREF(__pyx_tuple__53);
+  __pyx_tuple__52 = PyTuple_Pack(1, __pyx_kp_s_Unable_to_convert_item_to_object); if (unlikely(!__pyx_tuple__52)) __PYX_ERR(1, 497, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__52);
+  __Pyx_GIVEREF(__pyx_tuple__52);
 
   /* "View.MemoryView":522
  *     def __getbuffer__(self, Py_buffer *info, int flags):
  *         if flags & PyBUF_WRITABLE and self.view.readonly:
  *             raise ValueError("Cannot create writable memory view from read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         if flags & PyBUF_ND:
  */
-  __pyx_tuple__54 = PyTuple_Pack(1, __pyx_kp_s_Cannot_create_writable_memory_vi); if (unlikely(!__pyx_tuple__54)) __PYX_ERR(1, 522, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__54);
-  __Pyx_GIVEREF(__pyx_tuple__54);
+  __pyx_tuple__53 = PyTuple_Pack(1, __pyx_kp_s_Cannot_create_writable_memory_vi); if (unlikely(!__pyx_tuple__53)) __PYX_ERR(1, 522, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__53);
+  __Pyx_GIVEREF(__pyx_tuple__53);
 
   /* "View.MemoryView":572
  *         if self.view.strides == NULL:
  * 
  *             raise ValueError("Buffer view does not expose strides")             # <<<<<<<<<<<<<<
  * 
  *         return tuple([stride for stride in self.view.strides[:self.view.ndim]])
  */
-  __pyx_tuple__55 = PyTuple_Pack(1, __pyx_kp_s_Buffer_view_does_not_expose_stri); if (unlikely(!__pyx_tuple__55)) __PYX_ERR(1, 572, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__55);
-  __Pyx_GIVEREF(__pyx_tuple__55);
+  __pyx_tuple__54 = PyTuple_Pack(1, __pyx_kp_s_Buffer_view_does_not_expose_stri); if (unlikely(!__pyx_tuple__54)) __PYX_ERR(1, 572, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__54);
+  __Pyx_GIVEREF(__pyx_tuple__54);
 
   /* "View.MemoryView":579
  *     def suboffsets(self):
  *         if self.view.suboffsets == NULL:
  *             return (-1,) * self.view.ndim             # <<<<<<<<<<<<<<
  * 
  *         return tuple([suboffset for suboffset in self.view.suboffsets[:self.view.ndim]])
  */
-  __pyx_tuple__56 = PyTuple_New(1); if (unlikely(!__pyx_tuple__56)) __PYX_ERR(1, 579, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__56);
+  __pyx_tuple__55 = PyTuple_New(1); if (unlikely(!__pyx_tuple__55)) __PYX_ERR(1, 579, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__55);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
-  PyTuple_SET_ITEM(__pyx_tuple__56, 0, __pyx_int_neg_1);
-  __Pyx_GIVEREF(__pyx_tuple__56);
+  PyTuple_SET_ITEM(__pyx_tuple__55, 0, __pyx_int_neg_1);
+  __Pyx_GIVEREF(__pyx_tuple__55);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__57 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__57)) __PYX_ERR(1, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__57);
-  __Pyx_GIVEREF(__pyx_tuple__57);
+  __pyx_tuple__56 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__56)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__56);
+  __Pyx_GIVEREF(__pyx_tuple__56);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__58 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__58)) __PYX_ERR(1, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__58);
-  __Pyx_GIVEREF(__pyx_tuple__58);
+  __pyx_tuple__57 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__57)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__57);
+  __Pyx_GIVEREF(__pyx_tuple__57);
 
   /* "View.MemoryView":705
  *     for suboffset in suboffsets[:ndim]:
  *         if suboffset >= 0:
  *             raise ValueError("Indirect dimensions not supported")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__59 = PyTuple_Pack(1, __pyx_kp_s_Indirect_dimensions_not_supporte); if (unlikely(!__pyx_tuple__59)) __PYX_ERR(1, 705, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__59);
-  __Pyx_GIVEREF(__pyx_tuple__59);
+  __pyx_tuple__58 = PyTuple_Pack(1, __pyx_kp_s_Indirect_dimensions_not_supporte); if (unlikely(!__pyx_tuple__58)) __PYX_ERR(1, 705, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__58);
+  __Pyx_GIVEREF(__pyx_tuple__58);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__60 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__60)) __PYX_ERR(1, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__60);
-  __Pyx_GIVEREF(__pyx_tuple__60);
+  __pyx_tuple__59 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__59)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__59);
+  __Pyx_GIVEREF(__pyx_tuple__59);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__61 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__61)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __pyx_tuple__60 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__60)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__60);
+  __Pyx_GIVEREF(__pyx_tuple__60);
+  __pyx_tuple__61 = PyTuple_Pack(3, __pyx_int_184977713, __pyx_int_136983863, __pyx_int_112105877); if (unlikely(!__pyx_tuple__61)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__61);
   __Pyx_GIVEREF(__pyx_tuple__61);
-  __pyx_tuple__62 = PyTuple_Pack(3, __pyx_int_184977713, __pyx_int_136983863, __pyx_int_112105877); if (unlikely(!__pyx_tuple__62)) __PYX_ERR(1, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__62);
-  __Pyx_GIVEREF(__pyx_tuple__62);
 
-  /* "statmoments/_native.pyx":189
+  /* "statmoments/_native.pyx":19
+ * USE_GPU = 0
+ * 
+ * def is_vtk_installed():             # <<<<<<<<<<<<<<
+ *   if not USE_VTK:
+ *     return False
+ */
+  __pyx_tuple__63 = PyTuple_Pack(1, __pyx_n_s_vtk); if (unlikely(!__pyx_tuple__63)) __PYX_ERR(0, 19, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__63);
+  __Pyx_GIVEREF(__pyx_tuple__63);
+  __pyx_codeobj__64 = (PyObject*)__Pyx_PyCode_New(0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__63, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_is_vtk_installed, 19, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__64)) __PYX_ERR(0, 19, __pyx_L1_error)
+
+  /* "statmoments/_native.pyx":206
  * 
  * ############################### COMMON CLASS ##################################
  * class _AccBase(object):             # <<<<<<<<<<<<<<
  *   def __init__(self, tr_len, cl_len, moment=2, normalize=True, **kwargs):
  *     self.total_count = 0
  */
-  __pyx_tuple__64 = PyTuple_Pack(1, __pyx_builtin_object); if (unlikely(!__pyx_tuple__64)) __PYX_ERR(0, 189, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__64);
-  __Pyx_GIVEREF(__pyx_tuple__64);
+  __pyx_tuple__65 = PyTuple_Pack(1, __pyx_builtin_object); if (unlikely(!__pyx_tuple__65)) __PYX_ERR(0, 206, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__65);
+  __Pyx_GIVEREF(__pyx_tuple__65);
 
-  /* "statmoments/_native.pyx":190
+  /* "statmoments/_native.pyx":207
  * ############################### COMMON CLASS ##################################
  * class _AccBase(object):
  *   def __init__(self, tr_len, cl_len, moment=2, normalize=True, **kwargs):             # <<<<<<<<<<<<<<
  *     self.total_count = 0
  *     self.moment = moment
  */
-  __pyx_tuple__65 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_moment, __pyx_n_s_normalize, __pyx_n_s_kwargs); if (unlikely(!__pyx_tuple__65)) __PYX_ERR(0, 190, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__65);
-  __Pyx_GIVEREF(__pyx_tuple__65);
-  __pyx_codeobj__66 = (PyObject*)__Pyx_PyCode_New(5, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__65, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 190, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__66)) __PYX_ERR(0, 190, __pyx_L1_error)
-  __pyx_tuple__67 = PyTuple_Pack(2, ((PyObject *)__pyx_int_2), ((PyObject *)Py_True)); if (unlikely(!__pyx_tuple__67)) __PYX_ERR(0, 190, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__67);
-  __Pyx_GIVEREF(__pyx_tuple__67);
+  __pyx_tuple__66 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_moment, __pyx_n_s_normalize, __pyx_n_s_kwargs); if (unlikely(!__pyx_tuple__66)) __PYX_ERR(0, 207, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__66);
+  __Pyx_GIVEREF(__pyx_tuple__66);
+  __pyx_codeobj__67 = (PyObject*)__Pyx_PyCode_New(5, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__66, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 207, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__67)) __PYX_ERR(0, 207, __pyx_L1_error)
+  __pyx_tuple__68 = PyTuple_Pack(2, ((PyObject *)__pyx_int_2), ((PyObject *)Py_True)); if (unlikely(!__pyx_tuple__68)) __PYX_ERR(0, 207, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__68);
+  __Pyx_GIVEREF(__pyx_tuple__68);
 
-  /* "statmoments/_native.pyx":199
+  /* "statmoments/_native.pyx":216
  * 
  *   @staticmethod
- *   def estimate_mem_size(trace_len, classifier_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  */
-  __pyx_tuple__68 = PyTuple_Pack(3, __pyx_n_s_trace_len, __pyx_n_s_classifier_len, __pyx_n_s_moment); if (unlikely(!__pyx_tuple__68)) __PYX_ERR(0, 199, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__68);
-  __Pyx_GIVEREF(__pyx_tuple__68);
-  __pyx_codeobj__69 = (PyObject*)__Pyx_PyCode_New(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__68, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_estimate_mem_size, 199, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__69)) __PYX_ERR(0, 199, __pyx_L1_error)
-  __pyx_tuple__70 = PyTuple_Pack(2, ((PyObject *)__pyx_int_1), ((PyObject *)__pyx_int_2)); if (unlikely(!__pyx_tuple__70)) __PYX_ERR(0, 199, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__70);
-  __Pyx_GIVEREF(__pyx_tuple__70);
+  __pyx_tuple__69 = PyTuple_Pack(3, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_moment); if (unlikely(!__pyx_tuple__69)) __PYX_ERR(0, 216, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__69);
+  __Pyx_GIVEREF(__pyx_tuple__69);
+  __pyx_codeobj__70 = (PyObject*)__Pyx_PyCode_New(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__69, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_estimate_mem_size, 216, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__70)) __PYX_ERR(0, 216, __pyx_L1_error)
+  __pyx_tuple__71 = PyTuple_Pack(2, ((PyObject *)__pyx_int_1), ((PyObject *)__pyx_int_2)); if (unlikely(!__pyx_tuple__71)) __PYX_ERR(0, 216, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__71);
+  __Pyx_GIVEREF(__pyx_tuple__71);
 
-  /* "statmoments/_native.pyx":202
+  /* "statmoments/_native.pyx":219
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  */
-  __pyx_tuple__71 = PyTuple_Pack(1, __pyx_n_s_self); if (unlikely(!__pyx_tuple__71)) __PYX_ERR(0, 202, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__71);
-  __Pyx_GIVEREF(__pyx_tuple__71);
-  __pyx_codeobj__72 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__71, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_memory_size, 202, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__72)) __PYX_ERR(0, 202, __pyx_L1_error)
+  __pyx_tuple__72 = PyTuple_Pack(1, __pyx_n_s_self); if (unlikely(!__pyx_tuple__72)) __PYX_ERR(0, 219, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__72);
+  __Pyx_GIVEREF(__pyx_tuple__72);
+  __pyx_codeobj__73 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__72, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_memory_size, 219, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__73)) __PYX_ERR(0, 219, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":205
+  /* "statmoments/_native.pyx":222
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  */
-  __pyx_tuple__73 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_traces, __pyx_n_s_classifiers); if (unlikely(!__pyx_tuple__73)) __PYX_ERR(0, 205, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__73);
-  __Pyx_GIVEREF(__pyx_tuple__73);
-  __pyx_codeobj__74 = (PyObject*)__Pyx_PyCode_New(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__73, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_update, 205, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__74)) __PYX_ERR(0, 205, __pyx_L1_error)
+  __pyx_tuple__74 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_traces, __pyx_n_s_classifiers); if (unlikely(!__pyx_tuple__74)) __PYX_ERR(0, 222, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__74);
+  __Pyx_GIVEREF(__pyx_tuple__74);
+  __pyx_codeobj__75 = (PyObject*)__Pyx_PyCode_New(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__74, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_update, 222, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__75)) __PYX_ERR(0, 222, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":208
+  /* "statmoments/_native.pyx":225
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  */
-  __pyx_tuple__75 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_i); if (unlikely(!__pyx_tuple__75)) __PYX_ERR(0, 208, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__75);
-  __Pyx_GIVEREF(__pyx_tuple__75);
-  __pyx_codeobj__76 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__75, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_counts, 208, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__76)) __PYX_ERR(0, 208, __pyx_L1_error)
+  __pyx_tuple__76 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_i); if (unlikely(!__pyx_tuple__76)) __PYX_ERR(0, 225, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__76);
+  __Pyx_GIVEREF(__pyx_tuple__76);
+  __pyx_codeobj__77 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__76, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_counts, 225, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__77)) __PYX_ERR(0, 225, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":211
+  /* "statmoments/_native.pyx":228
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  *   def moments(self, moments=None, normalize=None):             # <<<<<<<<<<<<<<
  *     """Return a generator yielding a pair of univariate statistical moments for each classifier"""
  *     moments = moments if moments is not None else [self.moment]
  */
-  __pyx_tuple__77 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize); if (unlikely(!__pyx_tuple__77)) __PYX_ERR(0, 211, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__77);
-  __Pyx_GIVEREF(__pyx_tuple__77);
-  __pyx_codeobj__78 = (PyObject*)__Pyx_PyCode_New(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__77, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_moments, 211, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__78)) __PYX_ERR(0, 211, __pyx_L1_error)
-  __pyx_tuple__79 = PyTuple_Pack(2, ((PyObject *)Py_None), ((PyObject *)Py_None)); if (unlikely(!__pyx_tuple__79)) __PYX_ERR(0, 211, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__79);
-  __Pyx_GIVEREF(__pyx_tuple__79);
+  __pyx_tuple__78 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize); if (unlikely(!__pyx_tuple__78)) __PYX_ERR(0, 228, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__78);
+  __Pyx_GIVEREF(__pyx_tuple__78);
+  __pyx_codeobj__79 = (PyObject*)__Pyx_PyCode_New(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__78, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_moments, 228, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__79)) __PYX_ERR(0, 228, __pyx_L1_error)
+  __pyx_tuple__80 = PyTuple_Pack(2, ((PyObject *)Py_None), ((PyObject *)Py_None)); if (unlikely(!__pyx_tuple__80)) __PYX_ERR(0, 228, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__80);
+  __Pyx_GIVEREF(__pyx_tuple__80);
 
-  /* "statmoments/_native.pyx":217
+  /* "statmoments/_native.pyx":234
  *     return self._moments(moments, normalize)
  * 
  *   def _ensure_ret(self, mlen):             # <<<<<<<<<<<<<<
  *     if self._retm.shape[1] < mlen:
- *         tr_len = self.trace_len
+ *       tr_len = self.trace_len
  */
-  __pyx_tuple__80 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_mlen, __pyx_n_s_tr_len); if (unlikely(!__pyx_tuple__80)) __PYX_ERR(0, 217, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__80);
-  __Pyx_GIVEREF(__pyx_tuple__80);
-  __pyx_codeobj__81 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__80, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_ensure_ret, 217, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__81)) __PYX_ERR(0, 217, __pyx_L1_error)
+  __pyx_tuple__81 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_mlen, __pyx_n_s_tr_len); if (unlikely(!__pyx_tuple__81)) __PYX_ERR(0, 234, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__81);
+  __Pyx_GIVEREF(__pyx_tuple__81);
+  __pyx_codeobj__82 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__81, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_ensure_ret, 234, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__82)) __PYX_ERR(0, 234, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":224
+  /* "statmoments/_native.pyx":241
  *     return self._retm
  * 
  *   def comoments(self, moments=None, normalize=None):             # <<<<<<<<<<<<<<
  *     """Return a generator yielding the requested set of bivariate comoments for each classifier"""
  *     moments = moments if moments is not None else np.broadcast_to(self.moment, (2, 1))
  */
-  __pyx_tuple__82 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize); if (unlikely(!__pyx_tuple__82)) __PYX_ERR(0, 224, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__82);
-  __Pyx_GIVEREF(__pyx_tuple__82);
-  __pyx_codeobj__83 = (PyObject*)__Pyx_PyCode_New(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__82, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_comoments_2, 224, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__83)) __PYX_ERR(0, 224, __pyx_L1_error)
-  __pyx_tuple__84 = PyTuple_Pack(2, ((PyObject *)Py_None), ((PyObject *)Py_None)); if (unlikely(!__pyx_tuple__84)) __PYX_ERR(0, 224, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__84);
-  __Pyx_GIVEREF(__pyx_tuple__84);
+  __pyx_tuple__83 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize); if (unlikely(!__pyx_tuple__83)) __PYX_ERR(0, 241, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__83);
+  __Pyx_GIVEREF(__pyx_tuple__83);
+  __pyx_codeobj__84 = (PyObject*)__Pyx_PyCode_New(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__83, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_comoments_2, 241, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__84)) __PYX_ERR(0, 241, __pyx_L1_error)
+  __pyx_tuple__85 = PyTuple_Pack(2, ((PyObject *)Py_None), ((PyObject *)Py_None)); if (unlikely(!__pyx_tuple__85)) __PYX_ERR(0, 241, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__85);
+  __Pyx_GIVEREF(__pyx_tuple__85);
 
-  /* "statmoments/_native.pyx":243
+  /* "statmoments/_native.pyx":261
  * #@cython.returns('double[:, ::1]')
  * #@cython.locals(M = 'double[:, ::1]', moment='int', tmpbuf = 'double[:, ::1]')
  * def _rmoms2cmoms(M, moment, tmpbuf):             # <<<<<<<<<<<<<<
  *   cython.declare(k='int', p='int')
  * 
  */
-  __pyx_tuple__85 = PyTuple_Pack(5, __pyx_n_s_M, __pyx_n_s_moment, __pyx_n_s_tmpbuf, __pyx_n_s_k, __pyx_n_s_p); if (unlikely(!__pyx_tuple__85)) __PYX_ERR(0, 243, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__85);
-  __Pyx_GIVEREF(__pyx_tuple__85);
-  __pyx_codeobj__86 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__85, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_rmoms2cmoms, 243, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__86)) __PYX_ERR(0, 243, __pyx_L1_error)
+  __pyx_tuple__86 = PyTuple_Pack(5, __pyx_n_s_M, __pyx_n_s_moment, __pyx_n_s_tmpbuf, __pyx_n_s_k, __pyx_n_s_p); if (unlikely(!__pyx_tuple__86)) __PYX_ERR(0, 261, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__86);
+  __Pyx_GIVEREF(__pyx_tuple__86);
+  __pyx_codeobj__87 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__86, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_rmoms2cmoms, 261, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__87)) __PYX_ERR(0, 261, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":254
- * 
+  /* "statmoments/_native.pyx":271
+ *   return M
  * 
  * def calc_central_moment_general(raw, ave, n, k, l, i, j):             # <<<<<<<<<<<<<<
  *   """ Calculate co-moments for any available moments """
- *   ave_i = ave[i]
+ *   ave_i = ave[i]  # i is a scalar
  */
-  __pyx_tuple__87 = PyTuple_Pack(14, __pyx_n_s_raw, __pyx_n_s_ave, __pyx_n_s_n, __pyx_n_s_k, __pyx_n_s_l, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_ave_i, __pyx_n_s_ave_j, __pyx_n_s_inv_n, __pyx_n_s_com, __pyx_n_s_p, __pyx_n_s_q, __pyx_n_s_Mpq); if (unlikely(!__pyx_tuple__87)) __PYX_ERR(0, 254, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__87);
-  __Pyx_GIVEREF(__pyx_tuple__87);
-  __pyx_codeobj__88 = (PyObject*)__Pyx_PyCode_New(7, 0, 14, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__87, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_calc_central_moment_general, 254, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__88)) __PYX_ERR(0, 254, __pyx_L1_error)
+  __pyx_tuple__88 = PyTuple_Pack(15, __pyx_n_s_raw, __pyx_n_s_ave, __pyx_n_s_n, __pyx_n_s_k, __pyx_n_s_l, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_ave_i, __pyx_n_s_ave_j, __pyx_n_s_inv_n, __pyx_n_s_com, __pyx_n_s_p, __pyx_n_s_edge_val, __pyx_n_s_q, __pyx_n_s_Mpq); if (unlikely(!__pyx_tuple__88)) __PYX_ERR(0, 271, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__88);
+  __Pyx_GIVEREF(__pyx_tuple__88);
+  __pyx_codeobj__89 = (PyObject*)__Pyx_PyCode_New(7, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__88, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_calc_central_moment_general, 271, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__89)) __PYX_ERR(0, 271, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":329
+  /* "statmoments/_native.pyx":351
  * 
  * class _bivar_sum_base(_AccBase):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  * 
  */
-  __pyx_tuple__89 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_trace_len, __pyx_n_s_classifier_len, __pyx_n_s_kwargs, __pyx_n_s_moment, __pyx_n_s_exp_traces); if (unlikely(!__pyx_tuple__89)) __PYX_ERR(0, 329, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__89);
-  __Pyx_GIVEREF(__pyx_tuple__89);
-  __pyx_codeobj__90 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__89, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 329, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__90)) __PYX_ERR(0, 329, __pyx_L1_error)
+  __pyx_tuple__90 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_trace_len, __pyx_n_s_classifier_len, __pyx_n_s_kwargs, __pyx_n_s_moment, __pyx_n_s_exp_traces); if (unlikely(!__pyx_tuple__90)) __PYX_ERR(0, 351, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__90);
+  __Pyx_GIVEREF(__pyx_tuple__90);
+  __pyx_codeobj__91 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__90, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 351, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__91)) __PYX_ERR(0, 351, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":346
+  /* "statmoments/_native.pyx":368
  * 
  *   @staticmethod
- *   def estimate_mem_size(trace_len, classifier_len=1, moment=2, acc_dtype=np.float64):             # <<<<<<<<<<<<<<
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2, acc_dtype=np.float64):             # <<<<<<<<<<<<<<
  *     # Approximate memory consumption for 1 classifier, 1 moment:
  *     # 10k: 5GB,  20k: 15GB,  50k: 80GB
  */
-  __pyx_tuple__91 = PyTuple_Pack(8, __pyx_n_s_trace_len, __pyx_n_s_classifier_len, __pyx_n_s_moment, __pyx_n_s_acc_dtype, __pyx_n_s_exp_traces, __pyx_n_s_lytsz, __pyx_n_s_accssz, __pyx_n_s_ttsz); if (unlikely(!__pyx_tuple__91)) __PYX_ERR(0, 346, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__91);
-  __Pyx_GIVEREF(__pyx_tuple__91);
-  __pyx_codeobj__92 = (PyObject*)__Pyx_PyCode_New(4, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__91, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_estimate_mem_size, 346, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__92)) __PYX_ERR(0, 346, __pyx_L1_error)
+  __pyx_tuple__92 = PyTuple_Pack(9, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_moment, __pyx_n_s_acc_dtype, __pyx_n_s_exp_traces, __pyx_n_s_bufsz, __pyx_n_s_lytsz, __pyx_n_s_accssz, __pyx_n_s_ttsz); if (unlikely(!__pyx_tuple__92)) __PYX_ERR(0, 368, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__92);
+  __Pyx_GIVEREF(__pyx_tuple__92);
+  __pyx_codeobj__93 = (PyObject*)__Pyx_PyCode_New(4, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__92, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_estimate_mem_size, 368, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__93)) __PYX_ERR(0, 368, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":355
- *     return (lytsz + accssz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
+  /* "statmoments/_native.pyx":378
+ *     return (lytsz + accssz + bufsz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
- *     mem_ttest = 0  # included in mem_class
+ *     # ttest memory included in mem_class or std normalization computed one line at a time
  */
-  __pyx_tuple__93 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_mem_class, __pyx_n_s_mem_ttest, __pyx_n_s_genexpr, __pyx_n_s_genexpr); if (unlikely(!__pyx_tuple__93)) __PYX_ERR(0, 355, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__93);
-  __Pyx_GIVEREF(__pyx_tuple__93);
-  __pyx_codeobj__94 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__93, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_memory_size, 355, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__94)) __PYX_ERR(0, 355, __pyx_L1_error)
+  __pyx_tuple__94 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_mem_class, __pyx_n_s_mem_ttest, __pyx_n_s_genexpr, __pyx_n_s_genexpr); if (unlikely(!__pyx_tuple__94)) __PYX_ERR(0, 378, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__94);
+  __Pyx_GIVEREF(__pyx_tuple__94);
+  __pyx_codeobj__95 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__94, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_memory_size, 378, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__95)) __PYX_ERR(0, 378, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":360
+  /* "statmoments/_native.pyx":384
  *     return mem_class + mem_ttest * 8
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     moment, batch_cnt = self.moment, len(traces)
  *     tr_len, cl_len = self.trace_len, self.classifiers_len
  */
-  __pyx_tuple__95 = PyTuple_Pack(14, __pyx_n_s_self, __pyx_n_s_traces, __pyx_n_s_classifiers, __pyx_n_s_moment, __pyx_n_s_batch_cnt, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_tr_lyt, __pyx_n_s_tr_lyt_view, __pyx_n_s_i, __pyx_n_s_n0, __pyx_n_s_n1, __pyx_n_s_j, __pyx_n_s_tr); if (unlikely(!__pyx_tuple__95)) __PYX_ERR(0, 360, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__95);
-  __Pyx_GIVEREF(__pyx_tuple__95);
-  __pyx_codeobj__96 = (PyObject*)__Pyx_PyCode_New(3, 0, 14, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__95, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_update, 360, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__96)) __PYX_ERR(0, 360, __pyx_L1_error)
+  __pyx_tuple__96 = PyTuple_Pack(14, __pyx_n_s_self, __pyx_n_s_traces, __pyx_n_s_classifiers, __pyx_n_s_moment, __pyx_n_s_batch_cnt, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_tr_lyt, __pyx_n_s_tr_lyt_view, __pyx_n_s_i, __pyx_n_s_n0, __pyx_n_s_n1, __pyx_n_s_j, __pyx_n_s_tr); if (unlikely(!__pyx_tuple__96)) __PYX_ERR(0, 384, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__96);
+  __Pyx_GIVEREF(__pyx_tuple__96);
+  __pyx_codeobj__97 = (PyObject*)__Pyx_PyCode_New(3, 0, 14, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__96, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_update, 384, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__97)) __PYX_ERR(0, 384, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":401
+  /* "statmoments/_native.pyx":425
  *           ssyrk(tr_lyt[n0:], self._accs[i, 1:], b'U')
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
  *     accs = self._accs[i]
  *     acc0, acc1 = accs, accs[1:].T
  */
-  __pyx_tuple__97 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_i, __pyx_n_s_accs_2, __pyx_n_s_acc0, __pyx_n_s_acc1); if (unlikely(!__pyx_tuple__97)) __PYX_ERR(0, 401, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__97);
-  __Pyx_GIVEREF(__pyx_tuple__97);
-  __pyx_codeobj__98 = (PyObject*)__Pyx_PyCode_New(2, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__97, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_counts, 401, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__98)) __PYX_ERR(0, 401, __pyx_L1_error)
+  __pyx_tuple__98 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_i, __pyx_n_s_accs_2, __pyx_n_s_acc0, __pyx_n_s_acc1); if (unlikely(!__pyx_tuple__98)) __PYX_ERR(0, 425, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__98);
+  __Pyx_GIVEREF(__pyx_tuple__98);
+  __pyx_codeobj__99 = (PyObject*)__Pyx_PyCode_New(2, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__98, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_counts, 425, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__99)) __PYX_ERR(0, 425, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":406
+  /* "statmoments/_native.pyx":430
  *     return acc0[0, 0], acc1[0, 0]
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     maxm = np.max(moments)
  *     if self.moment * 2 < maxm:
  */
-  __pyx_tuple__99 = PyTuple_Pack(21, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_maxm, __pyx_n_s_ma, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_cm, __pyx_n_s_buf_2, __pyx_n_s_ii, __pyx_n_s_n0, __pyx_n_s_n1, __pyx_n_s_acc0, __pyx_n_s_acc1, __pyx_n_s_raw0, __pyx_n_s_raw1, __pyx_n_s_i, __pyx_n_s_i_2, __pyx_n_s_sd, __pyx_n_s_cmi, __pyx_n_s_m); if (unlikely(!__pyx_tuple__99)) __PYX_ERR(0, 406, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__99);
-  __Pyx_GIVEREF(__pyx_tuple__99);
-  __pyx_codeobj__22 = (PyObject*)__Pyx_PyCode_New(3, 0, 21, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__99, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_moments_2, 406, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__22)) __PYX_ERR(0, 406, __pyx_L1_error)
+  __pyx_tuple__100 = PyTuple_Pack(25, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_maxm, __pyx_n_s_ma, __pyx_n_s_min_cnt, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_cm, __pyx_n_s_buf_2, __pyx_n_s_ii, __pyx_n_s_n0, __pyx_n_s_n1, __pyx_n_s_acc0, __pyx_n_s_acc1, __pyx_n_s_raw0, __pyx_n_s_raw1, __pyx_n_s_i_2, __pyx_n_s_nn, __pyx_n_s_raw, __pyx_n_s_acc, __pyx_n_s_i, __pyx_n_s_sd, __pyx_n_s_cmi, __pyx_n_s_m); if (unlikely(!__pyx_tuple__100)) __PYX_ERR(0, 430, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__100);
+  __Pyx_GIVEREF(__pyx_tuple__100);
+  __pyx_codeobj__24 = (PyObject*)__Pyx_PyCode_New(3, 0, 25, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__100, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_moments_2, 430, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__24)) __PYX_ERR(0, 430, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":452
+  /* "statmoments/_native.pyx":481
  *       yield cm[:, moments]
  * 
  *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     retm = self._retm
  *     tr_len, cl_len = self.trace_len, self._accs.shape[0]
  */
-  __pyx_tuple__100 = PyTuple_Pack(30, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_retm_2, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_ma, __pyx_n_s_min_cnt, __pyx_n_s_ii, __pyx_n_s_jj, __pyx_n_s_lm, __pyx_n_s_rm, __pyx_n_s_n0, __pyx_n_s_n1, __pyx_n_s_acc0, __pyx_n_s_acc1, __pyx_n_s_raw0, __pyx_n_s_raw1, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_m10, __pyx_n_s_m11, __pyx_n_s_i_2, __pyx_n_s_raw, __pyx_n_s_acc, __pyx_n_s_nn, __pyx_n_s_m2, __pyx_n_s_m1, __pyx_n_s_sd); if (unlikely(!__pyx_tuple__100)) __PYX_ERR(0, 452, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__100);
-  __Pyx_GIVEREF(__pyx_tuple__100);
-  __pyx_codeobj__25 = (PyObject*)__Pyx_PyCode_New(3, 0, 30, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__100, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_comoments, 452, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__25)) __PYX_ERR(0, 452, __pyx_L1_error)
+  __pyx_tuple__101 = PyTuple_Pack(28, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_retm_2, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_ma, __pyx_n_s_min_cnt, __pyx_n_s_ii, __pyx_n_s_n0, __pyx_n_s_n1, __pyx_n_s_acc0, __pyx_n_s_acc1, __pyx_n_s_raw0, __pyx_n_s_raw1, __pyx_n_s_jj, __pyx_n_s_lm, __pyx_n_s_rm, __pyx_n_s_i_2, __pyx_n_s_raw, __pyx_n_s_acc, __pyx_n_s_nn, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_m1, __pyx_n_s_m2, __pyx_n_s_sd); if (unlikely(!__pyx_tuple__101)) __PYX_ERR(0, 481, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__101);
+  __Pyx_GIVEREF(__pyx_tuple__101);
+  __pyx_codeobj__26 = (PyObject*)__Pyx_PyCode_New(3, 0, 28, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__101, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_comoments, 481, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__26)) __PYX_ERR(0, 481, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":499
+  /* "statmoments/_native.pyx":523
  * 
  * class bivar_sum(_bivar_sum_base):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, acctype=np.float64, **kwargs)
  * 
  */
-  __pyx_tuple__101 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_trace_len, __pyx_n_s_classifier_len, __pyx_n_s_kwargs); if (unlikely(!__pyx_tuple__101)) __PYX_ERR(0, 499, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__101);
-  __Pyx_GIVEREF(__pyx_tuple__101);
-  __pyx_codeobj__102 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__101, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 499, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__102)) __PYX_ERR(0, 499, __pyx_L1_error)
+  __pyx_tuple__102 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_trace_len, __pyx_n_s_classifier_len, __pyx_n_s_kwargs); if (unlikely(!__pyx_tuple__102)) __PYX_ERR(0, 523, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__102);
+  __Pyx_GIVEREF(__pyx_tuple__102);
+  __pyx_codeobj__103 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__102, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 523, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__103)) __PYX_ERR(0, 523, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":503
+  /* "statmoments/_native.pyx":528
  * 
  * class bivar_sum_mix(_bivar_sum_base):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, acctype=np.float32, **kwargs)
  * 
  */
-  __pyx_tuple__103 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_trace_len, __pyx_n_s_classifier_len, __pyx_n_s_kwargs); if (unlikely(!__pyx_tuple__103)) __PYX_ERR(0, 503, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__103);
-  __Pyx_GIVEREF(__pyx_tuple__103);
-  __pyx_codeobj__104 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__103, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 503, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__104)) __PYX_ERR(0, 503, __pyx_L1_error)
+  __pyx_tuple__104 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_trace_len, __pyx_n_s_classifier_len, __pyx_n_s_kwargs); if (unlikely(!__pyx_tuple__104)) __PYX_ERR(0, 528, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__104);
+  __Pyx_GIVEREF(__pyx_tuple__104);
+  __pyx_codeobj__105 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__104, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 528, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__105)) __PYX_ERR(0, 528, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":507
+  /* "statmoments/_native.pyx":533
  * 
  * class bivar_sum_detrend(_bivar_sum_base):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  *     self._dbuf = np.zeros((1, self.trace_len), dtype=self._dtype)[1:]
  */
-  __pyx_tuple__105 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_trace_len, __pyx_n_s_classifier_len, __pyx_n_s_kwargs); if (unlikely(!__pyx_tuple__105)) __PYX_ERR(0, 507, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__105);
-  __Pyx_GIVEREF(__pyx_tuple__105);
-  __pyx_codeobj__106 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__105, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 507, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__106)) __PYX_ERR(0, 507, __pyx_L1_error)
+  __pyx_tuple__106 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_trace_len, __pyx_n_s_classifier_len, __pyx_n_s_kwargs); if (unlikely(!__pyx_tuple__106)) __PYX_ERR(0, 533, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__106);
+  __Pyx_GIVEREF(__pyx_tuple__106);
+  __pyx_codeobj__107 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__106, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 533, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__107)) __PYX_ERR(0, 533, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":513
+  /* "statmoments/_native.pyx":539
  *     self._detrend_cnt = kwargs.pop('detrend_cnt', 10)
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     tr_copy = np.asarray(traces, dtype=self._dtype)
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  */
-  __pyx_tuple__107 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_traces, __pyx_n_s_classifiers, __pyx_n_s_tr_copy, __pyx_n_s_cl_copy, __pyx_n_s_db_part, __pyx_n_s_cl_part); if (unlikely(!__pyx_tuple__107)) __PYX_ERR(0, 513, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__107);
-  __Pyx_GIVEREF(__pyx_tuple__107);
-  __pyx_codeobj__108 = (PyObject*)__Pyx_PyCode_New(3, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__107, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_update, 513, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__108)) __PYX_ERR(0, 513, __pyx_L1_error)
+  __pyx_tuple__108 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_traces, __pyx_n_s_classifiers, __pyx_n_s_tr_copy, __pyx_n_s_cl_copy, __pyx_n_s_db_part, __pyx_n_s_cl_part); if (unlikely(!__pyx_tuple__108)) __PYX_ERR(0, 539, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__108);
+  __Pyx_GIVEREF(__pyx_tuple__108);
+  __pyx_codeobj__109 = (PyObject*)__Pyx_PyCode_New(3, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__108, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_update, 539, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__109)) __PYX_ERR(0, 539, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":532
- *     super().update(tr_copy-self._dbuf, cl_copy)
+  /* "statmoments/_native.pyx":558
+ *     super().update(tr_copy - self._dbuf, cl_copy)
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     m1idx = [i for i, m in enumerate(moments) if m == 1]
  *     has_m1 = len(m1idx) != 0
  */
-  __pyx_tuple__109 = PyTuple_Pack(8, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_m1idx, __pyx_n_s_has_m1, __pyx_n_s_res, __pyx_n_s_i, __pyx_n_s_m); if (unlikely(!__pyx_tuple__109)) __PYX_ERR(0, 532, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__109);
-  __Pyx_GIVEREF(__pyx_tuple__109);
-  __pyx_codeobj__27 = (PyObject*)__Pyx_PyCode_New(3, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__109, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_moments_2, 532, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__27)) __PYX_ERR(0, 532, __pyx_L1_error)
+  __pyx_tuple__110 = PyTuple_Pack(9, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_m1idx, __pyx_n_s_has_m1, __pyx_n_s_dbuf_2, __pyx_n_s_res, __pyx_n_s_i, __pyx_n_s_m); if (unlikely(!__pyx_tuple__110)) __PYX_ERR(0, 558, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__110);
+  __Pyx_GIVEREF(__pyx_tuple__110);
+  __pyx_codeobj__28 = (PyObject*)__Pyx_PyCode_New(3, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__110, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_moments_2, 558, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__28)) __PYX_ERR(0, 558, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":542
+  /* "statmoments/_native.pyx":569
  * 
  * 
  * def _triuflatten_gen(n):             # <<<<<<<<<<<<<<
  *   _ndx = np.triu_indices_from(np.empty((n, n)))
  *   def _triu(tr2d):
  */
-  __pyx_tuple__110 = PyTuple_Pack(4, __pyx_n_s_n, __pyx_n_s_ndx, __pyx_n_s_triu, __pyx_n_s_triu); if (unlikely(!__pyx_tuple__110)) __PYX_ERR(0, 542, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__110);
-  __Pyx_GIVEREF(__pyx_tuple__110);
-  __pyx_codeobj__111 = (PyObject*)__Pyx_PyCode_New(1, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__110, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_triuflatten_gen, 542, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__111)) __PYX_ERR(0, 542, __pyx_L1_error)
+  __pyx_tuple__111 = PyTuple_Pack(4, __pyx_n_s_n, __pyx_n_s_ndx, __pyx_n_s_triu, __pyx_n_s_triu); if (unlikely(!__pyx_tuple__111)) __PYX_ERR(0, 569, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__111);
+  __Pyx_GIVEREF(__pyx_tuple__111);
+  __pyx_codeobj__112 = (PyObject*)__Pyx_PyCode_New(1, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__111, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_triuflatten_gen, 569, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__112)) __PYX_ERR(0, 569, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":548
+  /* "statmoments/_native.pyx":575
  *   return _triu
  * 
  * def _compute_by_rows(tr_len, f):             # <<<<<<<<<<<<<<
  *   # Compute by rows upper triangle part of matrix from function f
  *   # This function is required for optimized memory consumption
  */
-  __pyx_tuple__112 = PyTuple_Pack(6, __pyx_n_s_tr_len, __pyx_n_s_f, __pyx_n_s_com, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k); if (unlikely(!__pyx_tuple__112)) __PYX_ERR(0, 548, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__112);
-  __Pyx_GIVEREF(__pyx_tuple__112);
-  __pyx_codeobj__113 = (PyObject*)__Pyx_PyCode_New(2, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__112, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_compute_by_rows, 548, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__113)) __PYX_ERR(0, 548, __pyx_L1_error)
+  __pyx_tuple__113 = PyTuple_Pack(6, __pyx_n_s_tr_len, __pyx_n_s_f, __pyx_n_s_com, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k); if (unlikely(!__pyx_tuple__113)) __PYX_ERR(0, 575, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__113);
+  __Pyx_GIVEREF(__pyx_tuple__113);
+  __pyx_codeobj__114 = (PyObject*)__Pyx_PyCode_New(2, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__113, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_compute_by_rows, 575, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__114)) __PYX_ERR(0, 575, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":557
+  /* "statmoments/_native.pyx":584
  *   return com
  * 
  * def update_moments(acc2d, acc1d, n1, moment, traces):             # <<<<<<<<<<<<<<
  *   # The update method:
  *   # x - ave2 = x + (ave1 - ave1) - ave2 = x - ave1 + (ave1 - ave2)
  */
-  __pyx_tuple__114 = PyTuple_Pack(14, __pyx_n_s_acc2d, __pyx_n_s_acc1d, __pyx_n_s_n1, __pyx_n_s_moment, __pyx_n_s_traces, __pyx_n_s_n2, __pyx_n_s_delta, __pyx_n_s_j, __pyx_n_s_temp_diag, __pyx_n_s_k, __pyx_n_s_l, __pyx_n_s_p, __pyx_n_s_q, __pyx_n_s_da); if (unlikely(!__pyx_tuple__114)) __PYX_ERR(0, 557, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__114);
-  __Pyx_GIVEREF(__pyx_tuple__114);
-  __pyx_codeobj__115 = (PyObject*)__Pyx_PyCode_New(5, 0, 14, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__114, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_update_moments, 557, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__115)) __PYX_ERR(0, 557, __pyx_L1_error)
+  __pyx_tuple__115 = PyTuple_Pack(14, __pyx_n_s_acc2d, __pyx_n_s_acc1d, __pyx_n_s_n1, __pyx_n_s_moment, __pyx_n_s_traces, __pyx_n_s_n2, __pyx_n_s_delta, __pyx_n_s_j, __pyx_n_s_temp_diag, __pyx_n_s_k, __pyx_n_s_l, __pyx_n_s_p, __pyx_n_s_q, __pyx_n_s_da); if (unlikely(!__pyx_tuple__115)) __PYX_ERR(0, 584, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__115);
+  __Pyx_GIVEREF(__pyx_tuple__115);
+  __pyx_codeobj__116 = (PyObject*)__Pyx_PyCode_New(5, 0, 14, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__115, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_update_moments, 584, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__116)) __PYX_ERR(0, 584, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":607
+  /* "statmoments/_native.pyx":634
  *       acc2d[k, :, l, :] += n1 * np.outer(delta[k], delta[l])
  * 
  * def _calc_comoments(MM, lm, rm, normalize):             # <<<<<<<<<<<<<<
  *   # Find the coefficients with the required degree for the left part and the right part
  *   # lm - left_moment, rm - right_moment
  */
-  __pyx_tuple__116 = PyTuple_Pack(6, __pyx_n_s_MM, __pyx_n_s_lm, __pyx_n_s_rm, __pyx_n_s_normalize, __pyx_n_s_m, __pyx_n_s_sd); if (unlikely(!__pyx_tuple__116)) __PYX_ERR(0, 607, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__116);
-  __Pyx_GIVEREF(__pyx_tuple__116);
-  __pyx_codeobj__117 = (PyObject*)__Pyx_PyCode_New(4, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__116, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_calc_comoments, 607, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__117)) __PYX_ERR(0, 607, __pyx_L1_error)
+  __pyx_tuple__117 = PyTuple_Pack(6, __pyx_n_s_MM, __pyx_n_s_lm, __pyx_n_s_rm, __pyx_n_s_normalize, __pyx_n_s_m, __pyx_n_s_sd); if (unlikely(!__pyx_tuple__117)) __PYX_ERR(0, 634, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__117);
+  __Pyx_GIVEREF(__pyx_tuple__117);
+  __pyx_codeobj__118 = (PyObject*)__Pyx_PyCode_New(4, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__117, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_calc_comoments, 634, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__118)) __PYX_ERR(0, 634, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":618
+  /* "statmoments/_native.pyx":646
  * class bivar_cntr(_AccBase):
  *   """A class, working with 2D accs, which track central moments"""
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  * 
  */
-  __pyx_tuple__118 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_trace_len, __pyx_n_s_classifier_len, __pyx_n_s_kwargs, __pyx_n_s_moment); if (unlikely(!__pyx_tuple__118)) __PYX_ERR(0, 618, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__118);
-  __Pyx_GIVEREF(__pyx_tuple__118);
-  __pyx_codeobj__119 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__118, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 618, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__119)) __PYX_ERR(0, 618, __pyx_L1_error)
+  __pyx_tuple__119 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_trace_len, __pyx_n_s_classifier_len, __pyx_n_s_kwargs, __pyx_n_s_moment); if (unlikely(!__pyx_tuple__119)) __PYX_ERR(0, 646, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__119);
+  __Pyx_GIVEREF(__pyx_tuple__119);
+  __pyx_codeobj__120 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__119, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 646, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__120)) __PYX_ERR(0, 646, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":630
+  /* "statmoments/_native.pyx":658
  * 
  *   @staticmethod
- *   def estimate_mem_size(tr_len, classifier_len=1, moment=2):             # <<<<<<<<<<<<<<
- *     #                   layout          acc_count                    accs1d                                             accs2d
- *     mem_class = 10*moment*tr_len + classifier_len*2 + classifier_len*2*tr_len + classifier_len*2*moment*tr_len*moment*tr_len
- */
-  __pyx_tuple__120 = PyTuple_Pack(4, __pyx_n_s_tr_len, __pyx_n_s_classifier_len, __pyx_n_s_moment, __pyx_n_s_mem_class); if (unlikely(!__pyx_tuple__120)) __PYX_ERR(0, 630, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__120);
-  __Pyx_GIVEREF(__pyx_tuple__120);
-  __pyx_codeobj__121 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__120, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_estimate_mem_size, 630, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__121)) __PYX_ERR(0, 630, __pyx_L1_error)
-  __pyx_tuple__122 = PyTuple_Pack(2, ((PyObject *)__pyx_int_1), ((PyObject *)__pyx_int_2)); if (unlikely(!__pyx_tuple__122)) __PYX_ERR(0, 630, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__122);
-  __Pyx_GIVEREF(__pyx_tuple__122);
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *     exp_traces = 50  # Expected number of traces in the input batch
+ *     acc_dtype  = np.float64
+ */
+  __pyx_tuple__121 = PyTuple_Pack(11, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_moment, __pyx_n_s_exp_traces, __pyx_n_s_acc_dtype, __pyx_n_s_lytsz, __pyx_n_s_accs1dsz, __pyx_n_s_accs2dsz, __pyx_n_s_ttsz, __pyx_n_s_clssz, __pyx_n_s_ttstdsz); if (unlikely(!__pyx_tuple__121)) __PYX_ERR(0, 658, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__121);
+  __Pyx_GIVEREF(__pyx_tuple__121);
+  __pyx_codeobj__122 = (PyObject*)__Pyx_PyCode_New(3, 0, 11, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__121, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_estimate_mem_size, 658, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__122)) __PYX_ERR(0, 658, __pyx_L1_error)
+  __pyx_tuple__123 = PyTuple_Pack(2, ((PyObject *)__pyx_int_1), ((PyObject *)__pyx_int_2)); if (unlikely(!__pyx_tuple__123)) __PYX_ERR(0, 658, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__123);
+  __Pyx_GIVEREF(__pyx_tuple__123);
 
-  /* "statmoments/_native.pyx":635
- *     return mem_class * classifier_len * 8
+  /* "statmoments/_native.pyx":670
+ *     return (lytsz + accs1dsz + accs2dsz) * np.finfo(acc_dtype).bits // 8 + (ttsz + ttstdsz) * 8 + clssz * 4
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
- *     mem_ttest = self._accs1d.shape[2] ** 2 // 2 * 4
+ *     # ttest memory included in mem_class or one additional square for std normalization
  */
-  __pyx_tuple__123 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_mem_class, __pyx_n_s_mem_ttest, __pyx_n_s_genexpr, __pyx_n_s_genexpr); if (unlikely(!__pyx_tuple__123)) __PYX_ERR(0, 635, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__123);
-  __Pyx_GIVEREF(__pyx_tuple__123);
-  __pyx_codeobj__124 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__123, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_memory_size, 635, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__124)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __pyx_tuple__124 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_mem_class, __pyx_n_s_mem_ttest, __pyx_n_s_genexpr, __pyx_n_s_genexpr); if (unlikely(!__pyx_tuple__124)) __PYX_ERR(0, 670, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__124);
+  __Pyx_GIVEREF(__pyx_tuple__124);
+  __pyx_codeobj__125 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__124, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_memory_size, 670, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__125)) __PYX_ERR(0, 670, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":640
+  /* "statmoments/_native.pyx":676
  *     return mem_class + mem_ttest * 8
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     moment, batch_cnt = self.moment, len(traces)
  *     tr_len, cl_len = self.trace_len, len(classifiers[0])
  */
-  __pyx_tuple__125 = PyTuple_Pack(15, __pyx_n_s_self, __pyx_n_s_traces, __pyx_n_s_classifiers, __pyx_n_s_moment, __pyx_n_s_batch_cnt, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_tr_layout, __pyx_n_s_i, __pyx_n_s_n0, __pyx_n_s_n1, __pyx_n_s_tr, __pyx_n_s_cl, __pyx_n_s_j, __pyx_n_s_ar_len); if (unlikely(!__pyx_tuple__125)) __PYX_ERR(0, 640, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__125);
-  __Pyx_GIVEREF(__pyx_tuple__125);
-  __pyx_codeobj__126 = (PyObject*)__Pyx_PyCode_New(3, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__125, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_update, 640, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__126)) __PYX_ERR(0, 640, __pyx_L1_error)
+  __pyx_tuple__126 = PyTuple_Pack(15, __pyx_n_s_self, __pyx_n_s_traces, __pyx_n_s_classifiers, __pyx_n_s_moment, __pyx_n_s_batch_cnt, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_tr_layout, __pyx_n_s_i, __pyx_n_s_n0, __pyx_n_s_n1, __pyx_n_s_tr, __pyx_n_s_cl, __pyx_n_s_j, __pyx_n_s_ar_len); if (unlikely(!__pyx_tuple__126)) __PYX_ERR(0, 676, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__126);
+  __Pyx_GIVEREF(__pyx_tuple__126);
+  __pyx_codeobj__127 = (PyObject*)__Pyx_PyCode_New(3, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__126, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_update, 676, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__127)) __PYX_ERR(0, 676, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":680
- *         dgemm(tr_layout[n0:].reshape((-1, ar_len)), tr_layout[n0:].reshape((-1, ar_len)), self._accs2d[i, 1].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
+  /* "statmoments/_native.pyx":718
+ *               self._accs2d[i, 1].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
  *     return self._cls_count[i]
  * 
  */
-  __pyx_tuple__127 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_i); if (unlikely(!__pyx_tuple__127)) __PYX_ERR(0, 680, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__127);
-  __Pyx_GIVEREF(__pyx_tuple__127);
-  __pyx_codeobj__128 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__127, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_counts, 680, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__128)) __PYX_ERR(0, 680, __pyx_L1_error)
+  __pyx_tuple__128 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_i); if (unlikely(!__pyx_tuple__128)) __PYX_ERR(0, 718, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__128);
+  __Pyx_GIVEREF(__pyx_tuple__128);
+  __pyx_codeobj__129 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__128, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_counts, 718, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__129)) __PYX_ERR(0, 718, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":683
+  /* "statmoments/_native.pyx":721
  *     return self._cls_count[i]
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
- *     maxm = np.max(moments)
+ *     maxm, min_cnt = np.max(moments), self.acc_min_count
  *     if self.moment * 2 < maxm:
  */
-  __pyx_tuple__129 = PyTuple_Pack(15, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_maxm, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_retm_2, __pyx_n_s_ii, __pyx_n_s_i_2, __pyx_n_s_cm, __pyx_n_s_jj, __pyx_n_s_m, __pyx_n_s_nn, __pyx_n_s_sd, __pyx_n_s_m); if (unlikely(!__pyx_tuple__129)) __PYX_ERR(0, 683, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__129);
-  __Pyx_GIVEREF(__pyx_tuple__129);
-  __pyx_codeobj__30 = (PyObject*)__Pyx_PyCode_New(3, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__129, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_moments_2, 683, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__30)) __PYX_ERR(0, 683, __pyx_L1_error)
+  __pyx_tuple__130 = PyTuple_Pack(16, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_maxm, __pyx_n_s_min_cnt, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_retm_2, __pyx_n_s_ii, __pyx_n_s_nn, __pyx_n_s_i_2, __pyx_n_s_cm, __pyx_n_s_jj, __pyx_n_s_m, __pyx_n_s_sd, __pyx_n_s_m); if (unlikely(!__pyx_tuple__130)) __PYX_ERR(0, 721, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__130);
+  __Pyx_GIVEREF(__pyx_tuple__130);
+  __pyx_codeobj__31 = (PyObject*)__Pyx_PyCode_New(3, 0, 16, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__130, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_moments_2, 721, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__31)) __PYX_ERR(0, 721, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":711
+  /* "statmoments/_native.pyx":754
  *       yield retm
  * 
  *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
- * #    self._retm[:] = 0  # TODO: Check if needed
  *     retm = self._retm
+ *     tr_len, min_cnt = self.trace_len, self.acc_min_count
  */
-  __pyx_tuple__130 = PyTuple_Pack(15, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_retm_2, __pyx_n_s_tr_len, __pyx_n_s_min_cnt, __pyx_n_s_triuflatten, __pyx_n_s_accs2d_2, __pyx_n_s_accs_count, __pyx_n_s_n0, __pyx_n_s_n1, __pyx_n_s_jj, __pyx_n_s_lm, __pyx_n_s_rm, __pyx_n_s_C); if (unlikely(!__pyx_tuple__130)) __PYX_ERR(0, 711, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__130);
-  __Pyx_GIVEREF(__pyx_tuple__130);
-  __pyx_codeobj__31 = (PyObject*)__Pyx_PyCode_New(3, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__130, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_comoments, 711, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__31)) __PYX_ERR(0, 711, __pyx_L1_error)
+  __pyx_tuple__131 = PyTuple_Pack(15, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_retm_2, __pyx_n_s_tr_len, __pyx_n_s_min_cnt, __pyx_n_s_triuflatten, __pyx_n_s_accs2d_2, __pyx_n_s_accs_count, __pyx_n_s_n0, __pyx_n_s_n1, __pyx_n_s_jj, __pyx_n_s_lm, __pyx_n_s_rm, __pyx_n_s_C); if (unlikely(!__pyx_tuple__131)) __PYX_ERR(0, 754, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__131);
+  __Pyx_GIVEREF(__pyx_tuple__131);
+  __pyx_codeobj__32 = (PyObject*)__Pyx_PyCode_New(3, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__131, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_comoments, 754, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__32)) __PYX_ERR(0, 754, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":730
+  /* "statmoments/_native.pyx":776
  * 
  * ########################## BIVAR 2pass and text book ##########################
  * def _std_normalize(arr):             # <<<<<<<<<<<<<<
- *     return arr / np.std(arr, axis=0)
+ *   return arr / np.std(arr, axis=0)
  * 
  */
-  __pyx_tuple__131 = PyTuple_Pack(1, __pyx_n_s_arr); if (unlikely(!__pyx_tuple__131)) __PYX_ERR(0, 730, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__131);
-  __Pyx_GIVEREF(__pyx_tuple__131);
-  __pyx_codeobj__132 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__131, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_std_normalize, 730, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__132)) __PYX_ERR(0, 730, __pyx_L1_error)
+  __pyx_tuple__132 = PyTuple_Pack(1, __pyx_n_s_arr); if (unlikely(!__pyx_tuple__132)) __PYX_ERR(0, 776, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__132);
+  __Pyx_GIVEREF(__pyx_tuple__132);
+  __pyx_codeobj__133 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__132, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_std_normalize, 776, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__133)) __PYX_ERR(0, 776, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":733
- *     return arr / np.std(arr, axis=0)
+  /* "statmoments/_native.pyx":779
+ *   return arr / np.std(arr, axis=0)
  * 
  * def _sort_meanfree(ret, normalize=False):             # <<<<<<<<<<<<<<
- *   ret[:] -= np.mean(ret, axis=0)
- *   if normalize:
+ *   if len(ret) < 1:
+ *     return ret
  */
-  __pyx_tuple__133 = PyTuple_Pack(2, __pyx_n_s_ret, __pyx_n_s_normalize); if (unlikely(!__pyx_tuple__133)) __PYX_ERR(0, 733, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__133);
-  __Pyx_GIVEREF(__pyx_tuple__133);
-  __pyx_codeobj__134 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__133, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_sort_meanfree, 733, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__134)) __PYX_ERR(0, 733, __pyx_L1_error)
+  __pyx_tuple__134 = PyTuple_Pack(2, __pyx_n_s_ret, __pyx_n_s_normalize); if (unlikely(!__pyx_tuple__134)) __PYX_ERR(0, 779, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__134);
+  __Pyx_GIVEREF(__pyx_tuple__134);
+  __pyx_codeobj__135 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__134, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_sort_meanfree, 779, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__135)) __PYX_ERR(0, 779, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":778
+  /* "statmoments/_native.pyx":827
  * 
  * class _BivarNpassBase(_AccBase):
  *   def __init__(self, tr_len, cl_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(tr_len, cl_len, **kwargs)
  *     self.traces = np.empty((1, tr_len))[1:]
  */
-  __pyx_tuple__135 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_kwargs); if (unlikely(!__pyx_tuple__135)) __PYX_ERR(0, 778, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__135);
-  __Pyx_GIVEREF(__pyx_tuple__135);
-  __pyx_codeobj__136 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__135, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 778, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__136)) __PYX_ERR(0, 778, __pyx_L1_error)
+  __pyx_tuple__136 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_kwargs); if (unlikely(!__pyx_tuple__136)) __PYX_ERR(0, 827, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__136);
+  __Pyx_GIVEREF(__pyx_tuple__136);
+  __pyx_codeobj__137 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__136, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 827, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__137)) __PYX_ERR(0, 827, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":786
+  /* "statmoments/_native.pyx":835
  * 
  *   @staticmethod
- *   def estimate_mem_size(trace_len, classifier_len=1, moment=2):             # <<<<<<<<<<<<<<
- *     mem_class = trace_len * trace_len + 4 * trace_len * (trace_len+1) // 2
- *     return mem_class * 8 * classifier_len
- */
-  __pyx_tuple__137 = PyTuple_Pack(4, __pyx_n_s_trace_len, __pyx_n_s_classifier_len, __pyx_n_s_moment, __pyx_n_s_mem_class); if (unlikely(!__pyx_tuple__137)) __PYX_ERR(0, 786, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__137);
-  __Pyx_GIVEREF(__pyx_tuple__137);
-  __pyx_codeobj__138 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__137, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_estimate_mem_size, 786, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__138)) __PYX_ERR(0, 786, __pyx_L1_error)
-  __pyx_tuple__139 = PyTuple_Pack(2, ((PyObject *)__pyx_int_1), ((PyObject *)__pyx_int_2)); if (unlikely(!__pyx_tuple__139)) __PYX_ERR(0, 786, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__139);
-  __Pyx_GIVEREF(__pyx_tuple__139);
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *     mem_class = tr_len * tr_len + 2 * 2 * tr_len * (tr_len + 1) // 2
+ *     return mem_class * 8
+ */
+  __pyx_tuple__138 = PyTuple_Pack(4, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_moment, __pyx_n_s_mem_class); if (unlikely(!__pyx_tuple__138)) __PYX_ERR(0, 835, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__138);
+  __Pyx_GIVEREF(__pyx_tuple__138);
+  __pyx_codeobj__139 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__138, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_estimate_mem_size, 835, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__139)) __PYX_ERR(0, 835, __pyx_L1_error)
+  __pyx_tuple__140 = PyTuple_Pack(2, ((PyObject *)__pyx_int_1), ((PyObject *)__pyx_int_2)); if (unlikely(!__pyx_tuple__140)) __PYX_ERR(0, 835, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__140);
+  __Pyx_GIVEREF(__pyx_tuple__140);
 
-  /* "statmoments/_native.pyx":790
- *     return mem_class * 8 * classifier_len
+  /* "statmoments/_native.pyx":839
+ *     return mem_class * 8
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
- *     def _sz_helper(inst):
- *       return sum(v.nbytes for v in inst if isinstance(v, np.ndarray))
+ *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
+ *     return mem_class
  */
-  __pyx_tuple__140 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_sz_helper, __pyx_n_s_sz_helper, __pyx_n_s_mem_class, __pyx_n_s_mem_ttest); if (unlikely(!__pyx_tuple__140)) __PYX_ERR(0, 790, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__140);
-  __Pyx_GIVEREF(__pyx_tuple__140);
-  __pyx_codeobj__141 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__140, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_memory_size, 790, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__141)) __PYX_ERR(0, 790, __pyx_L1_error)
+  __pyx_tuple__141 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_mem_class, __pyx_n_s_genexpr, __pyx_n_s_genexpr); if (unlikely(!__pyx_tuple__141)) __PYX_ERR(0, 839, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__141);
+  __Pyx_GIVEREF(__pyx_tuple__141);
+  __pyx_codeobj__142 = (PyObject*)__Pyx_PyCode_New(1, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__141, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_memory_size, 839, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__142)) __PYX_ERR(0, 839, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":797
- *     return mem_class + mem_ttest * 8
+  /* "statmoments/_native.pyx":843
+ *     return mem_class
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     self.total_count += len(traces)
  * 
  */
-  __pyx_tuple__142 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_traces, __pyx_n_s_classifiers, __pyx_n_s_tr_copy, __pyx_n_s_cl_copy); if (unlikely(!__pyx_tuple__142)) __PYX_ERR(0, 797, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__142);
-  __Pyx_GIVEREF(__pyx_tuple__142);
-  __pyx_codeobj__143 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__142, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_update, 797, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__143)) __PYX_ERR(0, 797, __pyx_L1_error)
+  __pyx_tuple__143 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_traces, __pyx_n_s_classifiers, __pyx_n_s_tr_copy, __pyx_n_s_cl_copy); if (unlikely(!__pyx_tuple__143)) __PYX_ERR(0, 843, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__143);
+  __Pyx_GIVEREF(__pyx_tuple__143);
+  __pyx_codeobj__144 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__143, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_update, 843, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__144)) __PYX_ERR(0, 843, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":805
+  /* "statmoments/_native.pyx":851
  *     self.cls    = np.vstack((self.cls, cl_copy))
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
  *     c1 = sum(self.cls[:, i])
  *     return self.total_count - c1, c1
  */
-  __pyx_tuple__144 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_i, __pyx_n_s_c1); if (unlikely(!__pyx_tuple__144)) __PYX_ERR(0, 805, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__144);
-  __Pyx_GIVEREF(__pyx_tuple__144);
-  __pyx_codeobj__145 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__144, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_counts, 805, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__145)) __PYX_ERR(0, 805, __pyx_L1_error)
+  __pyx_tuple__145 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_i, __pyx_n_s_c1); if (unlikely(!__pyx_tuple__145)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__145);
+  __Pyx_GIVEREF(__pyx_tuple__145);
+  __pyx_codeobj__146 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__145, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_counts, 851, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__146)) __PYX_ERR(0, 851, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":809
+  /* "statmoments/_native.pyx":855
  *     return self.total_count - c1, c1
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
+ *     min_cnt = self.acc_min_count
  *     tr_len, cl_len = self.trace_len, self.classifiers_len
+ */
+  __pyx_tuple__147 = PyTuple_Pack(21, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_min_cnt, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_retm_2, __pyx_n_s_ii, __pyx_n_s_cls0, __pyx_n_s_traces_cl, __pyx_n_s_n0, __pyx_n_s_n1, __pyx_n_s_i_2, __pyx_n_s_tr_set, __pyx_n_s_nn, __pyx_n_s_cm, __pyx_n_s_raw, __pyx_n_s_jj, __pyx_n_s_m, __pyx_n_s_sd, __pyx_n_s_ts); if (unlikely(!__pyx_tuple__147)) __PYX_ERR(0, 855, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__147);
+  __Pyx_GIVEREF(__pyx_tuple__147);
+  __pyx_codeobj__33 = (PyObject*)__Pyx_PyCode_New(3, 0, 21, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__147, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_moments_2, 855, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__33)) __PYX_ERR(0, 855, __pyx_L1_error)
+
+  /* "statmoments/_native.pyx":894
+ * class bivar_2pass(_BivarNpassBase):
+ *   @staticmethod
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *     mem_base  = _BivarNpassBase.estimate_mem_size(tr_len, cl_len, moment)
+ *     # One additional square for std normalization for moments > 2
+ */
+  __pyx_tuple__148 = PyTuple_Pack(5, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_moment, __pyx_n_s_mem_base, __pyx_n_s_mem_ttstd); if (unlikely(!__pyx_tuple__148)) __PYX_ERR(0, 894, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__148);
+  __Pyx_GIVEREF(__pyx_tuple__148);
+  __pyx_codeobj__149 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__148, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_estimate_mem_size, 894, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__149)) __PYX_ERR(0, 894, __pyx_L1_error)
+  __pyx_tuple__150 = PyTuple_Pack(2, ((PyObject *)__pyx_int_1), ((PyObject *)__pyx_int_2)); if (unlikely(!__pyx_tuple__150)) __PYX_ERR(0, 894, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__150);
+  __Pyx_GIVEREF(__pyx_tuple__150);
+
+  /* "statmoments/_native.pyx":900
+ *     return mem_base + mem_ttstd * 8
  * 
+ *   def memory_size(self):             # <<<<<<<<<<<<<<
+ *     mem_base = super().memory_size()
+ *     # One additional square for std normalization for moments > 2
  */
-  __pyx_tuple__146 = PyTuple_Pack(17, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_retm_2, __pyx_n_s_ii, __pyx_n_s_cls0, __pyx_n_s_traces_cl, __pyx_n_s_i_2, __pyx_n_s_tr_set, __pyx_n_s_n, __pyx_n_s_cm, __pyx_n_s_tr_set_mean, __pyx_n_s_jj, __pyx_n_s_m, __pyx_n_s_sd); if (unlikely(!__pyx_tuple__146)) __PYX_ERR(0, 809, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__146);
-  __Pyx_GIVEREF(__pyx_tuple__146);
-  __pyx_codeobj__34 = (PyObject*)__Pyx_PyCode_New(3, 0, 17, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__146, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_moments_2, 809, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__34)) __PYX_ERR(0, 809, __pyx_L1_error)
+  __pyx_tuple__151 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_mem_base, __pyx_n_s_mem_ttstd); if (unlikely(!__pyx_tuple__151)) __PYX_ERR(0, 900, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__151);
+  __Pyx_GIVEREF(__pyx_tuple__151);
+  __pyx_codeobj__152 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__151, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_memory_size, 900, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__152)) __PYX_ERR(0, 900, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":839
+  /* "statmoments/_native.pyx":906
+ *     return mem_base + mem_ttstd * 8
  * 
- * class bivar_2pass(_BivarNpassBase):
  *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
- *     C = self._tmpsq
- *     tr_len, cl_len = self.trace_len, self.cls.shape[1]
+ *     min_cnt, C = self.acc_min_count, self._tmpsq
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len
  */
-  __pyx_tuple__147 = PyTuple_Pack(17, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_C, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_ii, __pyx_n_s_i_2, __pyx_n_s_mft, __pyx_n_s_m, __pyx_n_s_n, __pyx_n_s_triuflatten, __pyx_n_s_retm_2, __pyx_n_s_jj, __pyx_n_s_lm, __pyx_n_s_rm, __pyx_n_s_sd); if (unlikely(!__pyx_tuple__147)) __PYX_ERR(0, 839, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__147);
-  __Pyx_GIVEREF(__pyx_tuple__147);
-  __pyx_codeobj__35 = (PyObject*)__Pyx_PyCode_New(3, 0, 17, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__147, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_comoments, 839, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__35)) __PYX_ERR(0, 839, __pyx_L1_error)
+  __pyx_tuple__153 = PyTuple_Pack(18, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_min_cnt, __pyx_n_s_C, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_ii, __pyx_n_s_i_2, __pyx_n_s_mft, __pyx_n_s_m, __pyx_n_s_n, __pyx_n_s_retm_2, __pyx_n_s_triuflatten, __pyx_n_s_jj, __pyx_n_s_lm, __pyx_n_s_rm, __pyx_n_s_sd); if (unlikely(!__pyx_tuple__153)) __PYX_ERR(0, 906, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__153);
+  __Pyx_GIVEREF(__pyx_tuple__153);
+  __pyx_codeobj__34 = (PyObject*)__Pyx_PyCode_New(3, 0, 18, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__153, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_comoments, 906, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__34)) __PYX_ERR(0, 906, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":863
+  /* "statmoments/_native.pyx":934
  * 
  * class bivar_txtbk(_BivarNpassBase):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  *     m, n = self.acc_min_count, trace_len
  */
-  __pyx_tuple__148 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_trace_len, __pyx_n_s_classifier_len, __pyx_n_s_kwargs, __pyx_n_s_m, __pyx_n_s_n); if (unlikely(!__pyx_tuple__148)) __PYX_ERR(0, 863, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__148);
-  __Pyx_GIVEREF(__pyx_tuple__148);
-  __pyx_codeobj__149 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__148, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 863, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__149)) __PYX_ERR(0, 863, __pyx_L1_error)
+  __pyx_tuple__154 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_trace_len, __pyx_n_s_classifier_len, __pyx_n_s_kwargs, __pyx_n_s_m, __pyx_n_s_n); if (unlikely(!__pyx_tuple__154)) __PYX_ERR(0, 934, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__154);
+  __Pyx_GIVEREF(__pyx_tuple__154);
+  __pyx_codeobj__155 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__154, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 934, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__155)) __PYX_ERR(0, 934, __pyx_L1_error)
+
+  /* "statmoments/_native.pyx":940
+ * 
+ *   @staticmethod
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *     exp_traces = 10  # Expected number of traces in the input batch
+ *     mem_base  = _BivarNpassBase.estimate_mem_size(tr_len, cl_len, moment)
+ */
+  __pyx_tuple__156 = PyTuple_Pack(7, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_moment, __pyx_n_s_exp_traces, __pyx_n_s_mem_base, __pyx_n_s_mem_tri, __pyx_n_s_mem_ttstd); if (unlikely(!__pyx_tuple__156)) __PYX_ERR(0, 940, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__156);
+  __Pyx_GIVEREF(__pyx_tuple__156);
+  __pyx_codeobj__157 = (PyObject*)__Pyx_PyCode_New(3, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__156, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_estimate_mem_size, 940, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__157)) __PYX_ERR(0, 940, __pyx_L1_error)
+  __pyx_tuple__158 = PyTuple_Pack(2, ((PyObject *)__pyx_int_1), ((PyObject *)__pyx_int_2)); if (unlikely(!__pyx_tuple__158)) __PYX_ERR(0, 940, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__158);
+  __Pyx_GIVEREF(__pyx_tuple__158);
+
+  /* "statmoments/_native.pyx":947
+ *     return mem_base + (mem_tri  + mem_ttstd)* 8
+ * 
+ *   def memory_size(self):             # <<<<<<<<<<<<<<
+ *     mem_base = super().memory_size()
+ *     # One additional square for std normalization for moments > 2
+ */
+  __pyx_tuple__159 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_mem_base, __pyx_n_s_mem_ttstd); if (unlikely(!__pyx_tuple__159)) __PYX_ERR(0, 947, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__159);
+  __Pyx_GIVEREF(__pyx_tuple__159);
+  __pyx_codeobj__160 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__159, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_memory_size, 947, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__160)) __PYX_ERR(0, 947, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":868
- *     self._tri  = np.empty((m, n * (n+1)//2))   # Handle the triangle dynamically
+  /* "statmoments/_native.pyx":953
+ *     return mem_base + mem_ttstd * 8
  * 
  *   def _realloc_tri(self, m):             # <<<<<<<<<<<<<<
  *     if len(self._tri) < m:
- *       self._tri = None                         # Dealloc previous memory
+ *       # Greater batch received, dealloc the previous triangle and alloc new one
  */
-  __pyx_tuple__150 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_m, __pyx_n_s_n); if (unlikely(!__pyx_tuple__150)) __PYX_ERR(0, 868, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__150);
-  __Pyx_GIVEREF(__pyx_tuple__150);
-  __pyx_codeobj__151 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__150, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_realloc_tri, 868, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__151)) __PYX_ERR(0, 868, __pyx_L1_error)
+  __pyx_tuple__161 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_m, __pyx_n_s_n); if (unlikely(!__pyx_tuple__161)) __PYX_ERR(0, 953, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__161);
+  __Pyx_GIVEREF(__pyx_tuple__161);
+  __pyx_codeobj__162 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__161, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_realloc_tri, 953, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__162)) __PYX_ERR(0, 953, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":875
+  /* "statmoments/_native.pyx":961
  *     return self._tri[:m]
  * 
  *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
- *     C = self._tmpsq
- *     tr_len, cl_len = self.trace_len, self.cls.shape[1]
+ *     min_cnt, C = self.acc_min_count, self._tmpsq
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len
  */
-  __pyx_tuple__152 = PyTuple_Pack(19, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_C, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_ii, __pyx_n_s_cl_set, __pyx_n_s_i_2, __pyx_n_s_mft, __pyx_n_s_m, __pyx_n_s_n, __pyx_n_s_retm_2, __pyx_n_s_tri_2, __pyx_n_s_jj, __pyx_n_s_lm, __pyx_n_s_rm, __pyx_n_s_triuflatten, __pyx_n_s_sd); if (unlikely(!__pyx_tuple__152)) __PYX_ERR(0, 875, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__152);
-  __Pyx_GIVEREF(__pyx_tuple__152);
-  __pyx_codeobj__36 = (PyObject*)__Pyx_PyCode_New(3, 0, 19, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__152, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_comoments, 875, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__36)) __PYX_ERR(0, 875, __pyx_L1_error)
+  __pyx_tuple__163 = PyTuple_Pack(20, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_min_cnt, __pyx_n_s_C, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_ii, __pyx_n_s_cl_set, __pyx_n_s_i_2, __pyx_n_s_mft, __pyx_n_s_m, __pyx_n_s_n, __pyx_n_s_retm_2, __pyx_n_s_tri_2, __pyx_n_s_jj, __pyx_n_s_lm, __pyx_n_s_rm, __pyx_n_s_triuflatten, __pyx_n_s_sd); if (unlikely(!__pyx_tuple__163)) __PYX_ERR(0, 961, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__163);
+  __Pyx_GIVEREF(__pyx_tuple__163);
+  __pyx_codeobj__35 = (PyObject*)__Pyx_PyCode_New(3, 0, 20, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__163, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_comoments, 961, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__35)) __PYX_ERR(0, 961, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":918
- *   from vtk.util.numpy_support import numpy_to_vtk as np2vtk, vtk_to_numpy as vtk2np
+  /* "statmoments/_native.pyx":996
+ * 
  * 
  * class bivar_vtk(object):             # <<<<<<<<<<<<<<
  *   """A class, using vtk multivariate kernel. Covariance ONLY!!!"""
- *   def __init__(self, trace_len, classifier_len, moment=2, **kwargs):
+ *   def __init__(self, tr_len, classifier_len, moment=2, **kwargs):
  */
-  __pyx_tuple__153 = PyTuple_Pack(1, __pyx_builtin_object); if (unlikely(!__pyx_tuple__153)) __PYX_ERR(0, 918, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__153);
-  __Pyx_GIVEREF(__pyx_tuple__153);
+  __pyx_tuple__164 = PyTuple_Pack(1, __pyx_builtin_object); if (unlikely(!__pyx_tuple__164)) __PYX_ERR(0, 996, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__164);
+  __Pyx_GIVEREF(__pyx_tuple__164);
 
-  /* "statmoments/_native.pyx":920
+  /* "statmoments/_native.pyx":998
  * class bivar_vtk(object):
  *   """A class, using vtk multivariate kernel. Covariance ONLY!!!"""
- *   def __init__(self, trace_len, classifier_len, moment=2, **kwargs):             # <<<<<<<<<<<<<<
- *     self.moment = moment
- *     self.trace_len = trace_len
+ *   def __init__(self, tr_len, classifier_len, moment=2, **kwargs):             # <<<<<<<<<<<<<<
+ *     self.moment = moment # In fact, only 1
+ *     self.trace_len = tr_len
  */
-  __pyx_tuple__155 = PyTuple_Pack(10, __pyx_n_s_self, __pyx_n_s_trace_len, __pyx_n_s_classifier_len, __pyx_n_s_moment, __pyx_n_s_kwargs, __pyx_n_s_mcss, __pyx_n_s_mcs, __pyx_n_s__154, __pyx_n_s_i, __pyx_n_s_i); if (unlikely(!__pyx_tuple__155)) __PYX_ERR(0, 920, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__155);
-  __Pyx_GIVEREF(__pyx_tuple__155);
-  __pyx_codeobj__156 = (PyObject*)__Pyx_PyCode_New(4, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__155, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 920, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__156)) __PYX_ERR(0, 920, __pyx_L1_error)
-  __pyx_tuple__157 = PyTuple_Pack(1, ((PyObject *)__pyx_int_2)); if (unlikely(!__pyx_tuple__157)) __PYX_ERR(0, 920, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__157);
-  __Pyx_GIVEREF(__pyx_tuple__157);
+  __pyx_tuple__166 = PyTuple_Pack(10, __pyx_n_s_self, __pyx_n_s_tr_len, __pyx_n_s_classifier_len, __pyx_n_s_moment, __pyx_n_s_kwargs, __pyx_n_s_mcss, __pyx_n_s_mcs, __pyx_n_s__165, __pyx_n_s_i, __pyx_n_s_i); if (unlikely(!__pyx_tuple__166)) __PYX_ERR(0, 998, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__166);
+  __Pyx_GIVEREF(__pyx_tuple__166);
+  __pyx_codeobj__167 = (PyObject*)__Pyx_PyCode_New(4, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__166, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 998, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__167)) __PYX_ERR(0, 998, __pyx_L1_error)
+  __pyx_tuple__168 = PyTuple_Pack(1, ((PyObject *)__pyx_int_2)); if (unlikely(!__pyx_tuple__168)) __PYX_ERR(0, 998, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__168);
+  __Pyx_GIVEREF(__pyx_tuple__168);
 
-  /* "statmoments/_native.pyx":933
+  /* "statmoments/_native.pyx":1013
  *         mcs.SetTestOption(False)
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     def _ms_helper(instl):
  *       return sum(i.GetActualMemorySize() for i in instl)
  */
-  __pyx_tuple__158 = PyTuple_Pack(12, __pyx_n_s_self, __pyx_n_s_ms_helper, __pyx_n_s_ms_helper, __pyx_n_s_intbl0, __pyx_n_s_outtbl0, __pyx_n_s_outds1, __pyx_n_s_mcss, __pyx_n_s_mcs, __pyx_n_s_mcss, __pyx_n_s_mcs, __pyx_n_s_mcss, __pyx_n_s_mcs); if (unlikely(!__pyx_tuple__158)) __PYX_ERR(0, 933, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__158);
-  __Pyx_GIVEREF(__pyx_tuple__158);
-  __pyx_codeobj__159 = (PyObject*)__Pyx_PyCode_New(1, 0, 12, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__158, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_memory_size, 933, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__159)) __PYX_ERR(0, 933, __pyx_L1_error)
+  __pyx_tuple__169 = PyTuple_Pack(13, __pyx_n_s_self, __pyx_n_s_ms_helper, __pyx_n_s_ms_helper, __pyx_n_s_intbl0, __pyx_n_s_outtbl0, __pyx_n_s_outds1, __pyx_n_s_mem_ttest, __pyx_n_s_mcss, __pyx_n_s_mcs, __pyx_n_s_mcss, __pyx_n_s_mcs, __pyx_n_s_mcss, __pyx_n_s_mcs); if (unlikely(!__pyx_tuple__169)) __PYX_ERR(0, 1013, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__169);
+  __Pyx_GIVEREF(__pyx_tuple__169);
+  __pyx_codeobj__170 = (PyObject*)__Pyx_PyCode_New(1, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__169, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_memory_size, 1013, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__170)) __PYX_ERR(0, 1013, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":944
+  /* "statmoments/_native.pyx":1026
  * 
  *   @property
  *   def total_count(self):             # <<<<<<<<<<<<<<
  *     return sum(self._counts[0])
  * 
  */
-  __pyx_tuple__160 = PyTuple_Pack(1, __pyx_n_s_self); if (unlikely(!__pyx_tuple__160)) __PYX_ERR(0, 944, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__160);
-  __Pyx_GIVEREF(__pyx_tuple__160);
-  __pyx_codeobj__161 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__160, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_total_count, 944, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__161)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_tuple__171 = PyTuple_Pack(1, __pyx_n_s_self); if (unlikely(!__pyx_tuple__171)) __PYX_ERR(0, 1026, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__171);
+  __Pyx_GIVEREF(__pyx_tuple__171);
+  __pyx_codeobj__172 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__171, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_total_count, 1026, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__172)) __PYX_ERR(0, 1026, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":947
+  /* "statmoments/_native.pyx":1029
  *     return sum(self._counts[0])
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     traces = np.array(np.asarray(traces, dtype=np.float64).T, copy=True)
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  */
-  __pyx_tuple__162 = PyTuple_Pack(13, __pyx_n_s_self, __pyx_n_s_traces, __pyx_n_s_classifiers, __pyx_n_s_cl_copy, __pyx_n_s_i, __pyx_n_s_cls0, __pyx_n_s_traces_cl, __pyx_n_s_mcs, __pyx_n_s_tr_set, __pyx_n_s_tbl, __pyx_n_s_j, __pyx_n_s_tr, __pyx_n_s_vtk_arr); if (unlikely(!__pyx_tuple__162)) __PYX_ERR(0, 947, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__162);
-  __Pyx_GIVEREF(__pyx_tuple__162);
-  __pyx_codeobj__163 = (PyObject*)__Pyx_PyCode_New(3, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__162, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_update, 947, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__163)) __PYX_ERR(0, 947, __pyx_L1_error)
+  __pyx_tuple__173 = PyTuple_Pack(13, __pyx_n_s_self, __pyx_n_s_traces, __pyx_n_s_classifiers, __pyx_n_s_cl_copy, __pyx_n_s_i, __pyx_n_s_cls0, __pyx_n_s_traces_cl, __pyx_n_s_mcs, __pyx_n_s_tr_set, __pyx_n_s_tbl, __pyx_n_s_j, __pyx_n_s_tr, __pyx_n_s_vtk_arr); if (unlikely(!__pyx_tuple__173)) __PYX_ERR(0, 1029, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__173);
+  __Pyx_GIVEREF(__pyx_tuple__173);
+  __pyx_codeobj__174 = (PyObject*)__Pyx_PyCode_New(3, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__173, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_update, 1029, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__174)) __PYX_ERR(0, 1029, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":969
+  /* "statmoments/_native.pyx":1051
  *         mcs.Update()
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
  *     # dbs = (mcs.GetOutputDataObject(1).GetBlock(1) for mcs in self._stats[i])
  *     # return [vtk2np(dd.GetColumn(1))[dd.GetNumberOfRows()-1] for dd in dbs]
  */
-  __pyx_tuple__164 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_i); if (unlikely(!__pyx_tuple__164)) __PYX_ERR(0, 969, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__164);
-  __Pyx_GIVEREF(__pyx_tuple__164);
-  __pyx_codeobj__165 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__164, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_counts, 969, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__165)) __PYX_ERR(0, 969, __pyx_L1_error)
+  __pyx_tuple__175 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_i); if (unlikely(!__pyx_tuple__175)) __PYX_ERR(0, 1051, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__175);
+  __Pyx_GIVEREF(__pyx_tuple__175);
+  __pyx_codeobj__176 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__175, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_counts, 1051, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__176)) __PYX_ERR(0, 1051, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":974
+  /* "statmoments/_native.pyx":1056
  *     return self._counts[i]
  * 
- *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
- *     m = moments[0]
- *     if self.moment < np.max(m):
+ *   def moments(self, moments, normalize):             # <<<<<<<<<<<<<<
+ *     maxm = np.max(moments)
+ *     if self.moment * 2 < maxm:
  */
-  __pyx_tuple__166 = PyTuple_Pack(13, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_m, __pyx_n_s_tr_len, __pyx_n_s_min_cnt, __pyx_n_s_triuflatten, __pyx_n_s_avgs, __pyx_n_s_mcss, __pyx_n_s_mcs, __pyx_n_s_dd, __pyx_n_s_n, __pyx_n_s_avg); if (unlikely(!__pyx_tuple__166)) __PYX_ERR(0, 974, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__166);
-  __Pyx_GIVEREF(__pyx_tuple__166);
-  __pyx_codeobj__39 = (PyObject*)__Pyx_PyCode_New(3, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__166, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_moments_2, 974, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__39)) __PYX_ERR(0, 974, __pyx_L1_error)
+  __pyx_tuple__177 = PyTuple_Pack(19, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_maxm, __pyx_n_s_tr_len, __pyx_n_s_min_cnt, __pyx_n_s_triuflatten, __pyx_n_s_retm_2, __pyx_n_s_ii, __pyx_n_s_mcss, __pyx_n_s_i_2, __pyx_n_s_mcs, __pyx_n_s_dd, __pyx_n_s_n, __pyx_n_s_cm, __pyx_n_s_nn, __pyx_n_s_jj, __pyx_n_s_m, __pyx_n_s_k); if (unlikely(!__pyx_tuple__177)) __PYX_ERR(0, 1056, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__177);
+  __Pyx_GIVEREF(__pyx_tuple__177);
+  __pyx_codeobj__38 = (PyObject*)__Pyx_PyCode_New(3, 0, 19, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__177, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_moments, 1056, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__38)) __PYX_ERR(0, 1056, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":994
- *     yield (avgs[0], avgs[0]), (avgs[1], avgs[1])
+  /* "statmoments/_native.pyx":1085
+ *     yield retm[:, :len(moments)]
  * 
- *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
+ *   def comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     tr_len, min_cnt = self.trace_len, self.acc_min_count
  *     triuflatten = _triuflatten_gen(tr_len)
  */
-  __pyx_tuple__167 = PyTuple_Pack(14, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_tr_len, __pyx_n_s_min_cnt, __pyx_n_s_triuflatten, __pyx_n_s_covs, __pyx_n_s_mcss, __pyx_n_s_mcs, __pyx_n_s_dd, __pyx_n_s_n, __pyx_n_s_m, __pyx_n_s_cov_arr, __pyx_n_s_k); if (unlikely(!__pyx_tuple__167)) __PYX_ERR(0, 994, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__167);
-  __Pyx_GIVEREF(__pyx_tuple__167);
-  __pyx_codeobj__41 = (PyObject*)__Pyx_PyCode_New(3, 0, 14, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__167, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_comoments, 994, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__41)) __PYX_ERR(0, 994, __pyx_L1_error)
+  __pyx_tuple__178 = PyTuple_Pack(18, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_tr_len, __pyx_n_s_min_cnt, __pyx_n_s_triuflatten, __pyx_n_s_ii, __pyx_n_s_mcss, __pyx_n_s_i_2, __pyx_n_s_mcs, __pyx_n_s_retm_2, __pyx_n_s_dd, __pyx_n_s_n, __pyx_n_s_nn, __pyx_n_s_cov_arr, __pyx_n_s_jj, __pyx_n_s_m, __pyx_n_s_k); if (unlikely(!__pyx_tuple__178)) __PYX_ERR(0, 1085, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__178);
+  __Pyx_GIVEREF(__pyx_tuple__178);
+  __pyx_codeobj__40 = (PyObject*)__Pyx_PyCode_New(3, 0, 18, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__178, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_comoments_2, 1085, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__40)) __PYX_ERR(0, 1085, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":1030
+  /* "statmoments/_native.pyx":1122
  * 
  * class univar_sum(_AccBase):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  * 
  */
-  __pyx_tuple__168 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_trace_len, __pyx_n_s_classifier_len, __pyx_n_s_kwargs, __pyx_n_s_exp_traces, __pyx_n_s_moment); if (unlikely(!__pyx_tuple__168)) __PYX_ERR(0, 1030, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__168);
-  __Pyx_GIVEREF(__pyx_tuple__168);
-  __pyx_codeobj__169 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__168, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 1030, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__169)) __PYX_ERR(0, 1030, __pyx_L1_error)
+  __pyx_tuple__179 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_trace_len, __pyx_n_s_classifier_len, __pyx_n_s_kwargs, __pyx_n_s_exp_traces, __pyx_n_s_moment); if (unlikely(!__pyx_tuple__179)) __PYX_ERR(0, 1122, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__179);
+  __Pyx_GIVEREF(__pyx_tuple__179);
+  __pyx_codeobj__180 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__179, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 1122, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__180)) __PYX_ERR(0, 1122, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":1048
+  /* "statmoments/_native.pyx":1140
  * 
  *   @staticmethod
- *   def estimate_mem_size(trace_len, classifier_len, moment):             # <<<<<<<<<<<<<<
- *     return ((classifier_len+1)*moment*trace_len + 2*moment*trace_len + 3 * trace_len) * 8
- * 
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *     exp_traces = 50  # Expected number of traces in the input batch
+ *     acc_dtype  = np.float64
  */
-  __pyx_tuple__170 = PyTuple_Pack(3, __pyx_n_s_trace_len, __pyx_n_s_classifier_len, __pyx_n_s_moment); if (unlikely(!__pyx_tuple__170)) __PYX_ERR(0, 1048, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__170);
-  __Pyx_GIVEREF(__pyx_tuple__170);
-  __pyx_codeobj__171 = (PyObject*)__Pyx_PyCode_New(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__170, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_estimate_mem_size, 1048, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__171)) __PYX_ERR(0, 1048, __pyx_L1_error)
+  __pyx_tuple__181 = PyTuple_Pack(9, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_moment, __pyx_n_s_exp_traces, __pyx_n_s_acc_dtype, __pyx_n_s_lytsz, __pyx_n_s_accssz, __pyx_n_s_bufsz, __pyx_n_s_ttsz); if (unlikely(!__pyx_tuple__181)) __PYX_ERR(0, 1140, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__181);
+  __Pyx_GIVEREF(__pyx_tuple__181);
+  __pyx_codeobj__182 = (PyObject*)__Pyx_PyCode_New(3, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__181, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_estimate_mem_size, 1140, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__182)) __PYX_ERR(0, 1140, __pyx_L1_error)
+  __pyx_tuple__183 = PyTuple_Pack(2, ((PyObject *)__pyx_int_1), ((PyObject *)__pyx_int_2)); if (unlikely(!__pyx_tuple__183)) __PYX_ERR(0, 1140, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__183);
+  __Pyx_GIVEREF(__pyx_tuple__183);
 
-  /* "statmoments/_native.pyx":1051
- *     return ((classifier_len+1)*moment*trace_len + 2*moment*trace_len + 3 * trace_len) * 8
+  /* "statmoments/_native.pyx":1149
+ *     return (lytsz + accssz + bufsz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
  *     mem_ttest = 0  # included in mem_class
  */
-  __pyx_tuple__172 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_mem_class, __pyx_n_s_mem_ttest, __pyx_n_s_genexpr, __pyx_n_s_genexpr); if (unlikely(!__pyx_tuple__172)) __PYX_ERR(0, 1051, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__172);
-  __Pyx_GIVEREF(__pyx_tuple__172);
-  __pyx_codeobj__173 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__172, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_memory_size, 1051, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__173)) __PYX_ERR(0, 1051, __pyx_L1_error)
+  __pyx_tuple__184 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_mem_class, __pyx_n_s_mem_ttest, __pyx_n_s_genexpr, __pyx_n_s_genexpr); if (unlikely(!__pyx_tuple__184)) __PYX_ERR(0, 1149, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__184);
+  __Pyx_GIVEREF(__pyx_tuple__184);
+  __pyx_codeobj__185 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__184, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_memory_size, 1149, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__185)) __PYX_ERR(0, 1149, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":1056
+  /* "statmoments/_native.pyx":1154
  *     return mem_class + mem_ttest * 8
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
- *     c1 = self._accs[i+1, 0]
+ *     c1 = self._accs[i + 1, 0]
  *     return self._accs[0, 0] - c1, c1
  */
-  __pyx_tuple__174 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_i, __pyx_n_s_c1); if (unlikely(!__pyx_tuple__174)) __PYX_ERR(0, 1056, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__174);
-  __Pyx_GIVEREF(__pyx_tuple__174);
-  __pyx_codeobj__175 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__174, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_counts, 1056, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__175)) __PYX_ERR(0, 1056, __pyx_L1_error)
+  __pyx_tuple__186 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_i, __pyx_n_s_c1); if (unlikely(!__pyx_tuple__186)) __PYX_ERR(0, 1154, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__186);
+  __Pyx_GIVEREF(__pyx_tuple__186);
+  __pyx_codeobj__187 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__186, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_counts, 1154, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__187)) __PYX_ERR(0, 1154, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":1060
+  /* "statmoments/_native.pyx":1158
  *     return self._accs[0, 0] - c1, c1
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     maxm = np.max(moments)
  *     if 2 * self.moment < maxm:
  */
-  __pyx_tuple__176 = PyTuple_Pack(16, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_maxm, __pyx_n_s_cm, __pyx_n_s_buf_2, __pyx_n_s_nT, __pyx_n_s_accT, __pyx_n_s_acc1, __pyx_n_s_n1, __pyx_n_s_nn, __pyx_n_s_i_2, __pyx_n_s_sd, __pyx_n_s_i, __pyx_n_s_cmi, __pyx_n_s_m); if (unlikely(!__pyx_tuple__176)) __PYX_ERR(0, 1060, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__176);
-  __Pyx_GIVEREF(__pyx_tuple__176);
-  __pyx_codeobj__42 = (PyObject*)__Pyx_PyCode_New(3, 0, 16, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__176, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_moments_2, 1060, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__42)) __PYX_ERR(0, 1060, __pyx_L1_error)
+  __pyx_tuple__188 = PyTuple_Pack(16, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_maxm, __pyx_n_s_cm, __pyx_n_s_buf_2, __pyx_n_s_nT, __pyx_n_s_accT, __pyx_n_s_acc1, __pyx_n_s_n1, __pyx_n_s_nn, __pyx_n_s_i_2, __pyx_n_s_sd, __pyx_n_s_i, __pyx_n_s_cmi, __pyx_n_s_m); if (unlikely(!__pyx_tuple__188)) __PYX_ERR(0, 1158, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__188);
+  __Pyx_GIVEREF(__pyx_tuple__188);
+  __pyx_codeobj__41 = (PyObject*)__Pyx_PyCode_New(3, 0, 16, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__188, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_moments_2, 1158, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__41)) __PYX_ERR(0, 1158, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":1095
+  /* "statmoments/_native.pyx":1193
  *       yield self._retm[:, moments]
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     moment, batch_cnt = self.moment, len(traces)
  *     tr_len, cl_len = self.trace_len, self.classifiers_len
  */
-  __pyx_tuple__177 = PyTuple_Pack(13, __pyx_n_s_self, __pyx_n_s_traces, __pyx_n_s_classifiers, __pyx_n_s_moment, __pyx_n_s_batch_cnt, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_tr_lyt, __pyx_n_s_tr_lyt_view, __pyx_n_s_j, __pyx_n_s_cl_layout, __pyx_n_s_cl_lyt, __pyx_n_s_cl_lyt_view); if (unlikely(!__pyx_tuple__177)) __PYX_ERR(0, 1095, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__177);
-  __Pyx_GIVEREF(__pyx_tuple__177);
-  __pyx_codeobj__178 = (PyObject*)__Pyx_PyCode_New(3, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__177, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_update, 1095, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__178)) __PYX_ERR(0, 1095, __pyx_L1_error)
+  __pyx_tuple__189 = PyTuple_Pack(13, __pyx_n_s_self, __pyx_n_s_traces, __pyx_n_s_classifiers, __pyx_n_s_moment, __pyx_n_s_batch_cnt, __pyx_n_s_tr_len, __pyx_n_s_cl_len, __pyx_n_s_tr_lyt, __pyx_n_s_tr_lyt_view, __pyx_n_s_j, __pyx_n_s_cl_layout, __pyx_n_s_cl_lyt, __pyx_n_s_cl_lyt_view); if (unlikely(!__pyx_tuple__189)) __PYX_ERR(0, 1193, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__189);
+  __Pyx_GIVEREF(__pyx_tuple__189);
+  __pyx_codeobj__190 = (PyObject*)__Pyx_PyCode_New(3, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__189, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_update, 1193, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__190)) __PYX_ERR(0, 1193, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":1124
+  /* "statmoments/_native.pyx":1223
  * 
  * class univar_sum_detrend(univar_sum):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  *     self._dbuf = np.zeros((1, self.trace_len), dtype=self._dtype)[1:]
  */
-  __pyx_tuple__179 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_trace_len, __pyx_n_s_classifier_len, __pyx_n_s_kwargs); if (unlikely(!__pyx_tuple__179)) __PYX_ERR(0, 1124, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__179);
-  __Pyx_GIVEREF(__pyx_tuple__179);
-  __pyx_codeobj__180 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__179, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 1124, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__180)) __PYX_ERR(0, 1124, __pyx_L1_error)
+  __pyx_tuple__191 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_trace_len, __pyx_n_s_classifier_len, __pyx_n_s_kwargs); if (unlikely(!__pyx_tuple__191)) __PYX_ERR(0, 1223, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__191);
+  __Pyx_GIVEREF(__pyx_tuple__191);
+  __pyx_codeobj__192 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__191, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_init, 1223, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__192)) __PYX_ERR(0, 1223, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":1130
+  /* "statmoments/_native.pyx":1229
  *     self._detrend_cnt = kwargs.pop('detrend_cnt', 10)
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     tr_copy = np.asarray(traces, dtype=self._dtype)
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  */
-  __pyx_tuple__181 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_traces, __pyx_n_s_classifiers, __pyx_n_s_tr_copy, __pyx_n_s_cl_copy, __pyx_n_s_db_part, __pyx_n_s_cl_part); if (unlikely(!__pyx_tuple__181)) __PYX_ERR(0, 1130, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__181);
-  __Pyx_GIVEREF(__pyx_tuple__181);
-  __pyx_codeobj__182 = (PyObject*)__Pyx_PyCode_New(3, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__181, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_update, 1130, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__182)) __PYX_ERR(0, 1130, __pyx_L1_error)
+  __pyx_tuple__193 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_traces, __pyx_n_s_classifiers, __pyx_n_s_tr_copy, __pyx_n_s_cl_copy, __pyx_n_s_db_part, __pyx_n_s_cl_part); if (unlikely(!__pyx_tuple__193)) __PYX_ERR(0, 1229, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__193);
+  __Pyx_GIVEREF(__pyx_tuple__193);
+  __pyx_codeobj__194 = (PyObject*)__Pyx_PyCode_New(3, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__193, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_update, 1229, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__194)) __PYX_ERR(0, 1229, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":1149
- *     super().update(tr_copy-self._dbuf, cl_copy)
+  /* "statmoments/_native.pyx":1248
+ *     super().update(tr_copy - self._dbuf, cl_copy)
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     m1idx = [i for i, m in enumerate(moments) if m == 1]
  *     has_m1 = len(m1idx) != 0
  */
-  __pyx_tuple__183 = PyTuple_Pack(8, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_m1idx, __pyx_n_s_has_m1, __pyx_n_s_res, __pyx_n_s_i, __pyx_n_s_m); if (unlikely(!__pyx_tuple__183)) __PYX_ERR(0, 1149, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__183);
-  __Pyx_GIVEREF(__pyx_tuple__183);
-  __pyx_codeobj__44 = (PyObject*)__Pyx_PyCode_New(3, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__183, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_moments_2, 1149, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__44)) __PYX_ERR(0, 1149, __pyx_L1_error)
+  __pyx_tuple__195 = PyTuple_Pack(9, __pyx_n_s_self, __pyx_n_s_moments, __pyx_n_s_normalize, __pyx_n_s_m1idx, __pyx_n_s_has_m1, __pyx_n_s_dbuf_nonempty, __pyx_n_s_res, __pyx_n_s_i, __pyx_n_s_m); if (unlikely(!__pyx_tuple__195)) __PYX_ERR(0, 1248, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__195);
+  __Pyx_GIVEREF(__pyx_tuple__195);
+  __pyx_codeobj__43 = (PyObject*)__Pyx_PyCode_New(3, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__195, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_moments_2, 1248, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__43)) __PYX_ERR(0, 1248, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":1163
+  /* "statmoments/_native.pyx":1264
  * #@cython.returns('double[:, ::1]')
  * #@cython.locals(M = 'double[:, ::1]', m='int')
  * def _preprocvar(M, m, variance=None):             # <<<<<<<<<<<<<<
  *   if m > 2:
  *     M[1][:] = (M[1] - M[0] ** 2) / variance
  */
-  __pyx_tuple__184 = PyTuple_Pack(3, __pyx_n_s_M, __pyx_n_s_m, __pyx_n_s_variance); if (unlikely(!__pyx_tuple__184)) __PYX_ERR(0, 1163, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__184);
-  __Pyx_GIVEREF(__pyx_tuple__184);
-  __pyx_codeobj__185 = (PyObject*)__Pyx_PyCode_New(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__184, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_preprocvar, 1163, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__185)) __PYX_ERR(0, 1163, __pyx_L1_error)
+  __pyx_tuple__196 = PyTuple_Pack(3, __pyx_n_s_M, __pyx_n_s_m, __pyx_n_s_variance); if (unlikely(!__pyx_tuple__196)) __PYX_ERR(0, 1264, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__196);
+  __Pyx_GIVEREF(__pyx_tuple__196);
+  __pyx_codeobj__197 = (PyObject*)__Pyx_PyCode_New(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__196, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_preprocvar, 1264, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__197)) __PYX_ERR(0, 1264, __pyx_L1_error)
 
-  /* "statmoments/_native.pyx":1201
+  /* "statmoments/_native.pyx":1301
  *   return m0 / np.sqrt(v0)
  * 
  * def ttest(n0, n1, m10, m11, m20, m21, veq):             # <<<<<<<<<<<<<<
  *   """Compute t-test"""
  * 
  */
-  __pyx_tuple__186 = PyTuple_Pack(7, __pyx_n_s_n0, __pyx_n_s_n1, __pyx_n_s_m10, __pyx_n_s_m11, __pyx_n_s_m20, __pyx_n_s_m21, __pyx_n_s_veq); if (unlikely(!__pyx_tuple__186)) __PYX_ERR(0, 1201, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__186);
-  __Pyx_GIVEREF(__pyx_tuple__186);
-  __pyx_codeobj__187 = (PyObject*)__Pyx_PyCode_New(7, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__186, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_ttest, 1201, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__187)) __PYX_ERR(0, 1201, __pyx_L1_error)
+  __pyx_tuple__198 = PyTuple_Pack(7, __pyx_n_s_n0, __pyx_n_s_n1, __pyx_n_s_m10, __pyx_n_s_m11, __pyx_n_s_m20, __pyx_n_s_m21, __pyx_n_s_veq); if (unlikely(!__pyx_tuple__198)) __PYX_ERR(0, 1301, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__198);
+  __Pyx_GIVEREF(__pyx_tuple__198);
+  __pyx_codeobj__199 = (PyObject*)__Pyx_PyCode_New(7, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__198, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_statmoments__native_pyx, __pyx_n_s_ttest, 1301, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__199)) __PYX_ERR(0, 1301, __pyx_L1_error)
 
   /* "View.MemoryView":287
  *         return self.name
  * 
  * cdef generic = Enum("<strided and direct or indirect>")             # <<<<<<<<<<<<<<
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")
  */
-  __pyx_tuple__188 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct_or_indirect); if (unlikely(!__pyx_tuple__188)) __PYX_ERR(1, 287, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__188);
-  __Pyx_GIVEREF(__pyx_tuple__188);
+  __pyx_tuple__200 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct_or_indirect); if (unlikely(!__pyx_tuple__200)) __PYX_ERR(1, 287, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__200);
+  __Pyx_GIVEREF(__pyx_tuple__200);
 
   /* "View.MemoryView":288
  * 
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default             # <<<<<<<<<<<<<<
  * cdef indirect = Enum("<strided and indirect>")
  * 
  */
-  __pyx_tuple__189 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct); if (unlikely(!__pyx_tuple__189)) __PYX_ERR(1, 288, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__189);
-  __Pyx_GIVEREF(__pyx_tuple__189);
+  __pyx_tuple__201 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct); if (unlikely(!__pyx_tuple__201)) __PYX_ERR(1, 288, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__201);
+  __Pyx_GIVEREF(__pyx_tuple__201);
 
   /* "View.MemoryView":289
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__190 = PyTuple_Pack(1, __pyx_kp_s_strided_and_indirect); if (unlikely(!__pyx_tuple__190)) __PYX_ERR(1, 289, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__190);
-  __Pyx_GIVEREF(__pyx_tuple__190);
+  __pyx_tuple__202 = PyTuple_Pack(1, __pyx_kp_s_strided_and_indirect); if (unlikely(!__pyx_tuple__202)) __PYX_ERR(1, 289, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__202);
+  __Pyx_GIVEREF(__pyx_tuple__202);
 
   /* "View.MemoryView":292
  * 
  * 
  * cdef contiguous = Enum("<contiguous and direct>")             # <<<<<<<<<<<<<<
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")
  * 
  */
-  __pyx_tuple__191 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_direct); if (unlikely(!__pyx_tuple__191)) __PYX_ERR(1, 292, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__191);
-  __Pyx_GIVEREF(__pyx_tuple__191);
+  __pyx_tuple__203 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_direct); if (unlikely(!__pyx_tuple__203)) __PYX_ERR(1, 292, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__203);
+  __Pyx_GIVEREF(__pyx_tuple__203);
 
   /* "View.MemoryView":293
  * 
  * cdef contiguous = Enum("<contiguous and direct>")
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__192 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_indirect); if (unlikely(!__pyx_tuple__192)) __PYX_ERR(1, 293, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__192);
-  __Pyx_GIVEREF(__pyx_tuple__192);
+  __pyx_tuple__204 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_indirect); if (unlikely(!__pyx_tuple__204)) __PYX_ERR(1, 293, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__204);
+  __Pyx_GIVEREF(__pyx_tuple__204);
 
   /* "(tree fragment)":1
  * def __pyx_unpickle_Enum(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  */
-  __pyx_tuple__193 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__193)) __PYX_ERR(1, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__193);
-  __Pyx_GIVEREF(__pyx_tuple__193);
-  __pyx_codeobj__194 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__193, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__194)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __pyx_tuple__205 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__205)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__205);
+  __Pyx_GIVEREF(__pyx_tuple__205);
+  __pyx_codeobj__206 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__205, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__206)) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 
@@ -58983,191 +61369,191 @@
 static int __Pyx_modinit_type_init_code(void) {
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_init_code", 0);
   /*--- Type init code ---*/
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct__memory_size) < 0) __PYX_ERR(0, 355, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct__memory_size) < 0) __PYX_ERR(0, 378, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_11statmoments_7_native___pyx_scope_struct__memory_size.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct__memory_size.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct__memory_size.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_11statmoments_7_native___pyx_scope_struct__memory_size.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_11statmoments_7_native___pyx_scope_struct__memory_size = &__pyx_type_11statmoments_7_native___pyx_scope_struct__memory_size;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_1_genexpr) < 0) __PYX_ERR(0, 356, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_1_genexpr) < 0) __PYX_ERR(0, 379, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_11statmoments_7_native___pyx_scope_struct_1_genexpr.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_1_genexpr.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_1_genexpr.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_11statmoments_7_native___pyx_scope_struct_1_genexpr.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_11statmoments_7_native___pyx_scope_struct_1_genexpr = &__pyx_type_11statmoments_7_native___pyx_scope_struct_1_genexpr;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_2__moments) < 0) __PYX_ERR(0, 406, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_2__moments) < 0) __PYX_ERR(0, 430, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_11statmoments_7_native___pyx_scope_struct_2__moments.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_2__moments.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_2__moments.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_11statmoments_7_native___pyx_scope_struct_2__moments.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_11statmoments_7_native___pyx_scope_struct_2__moments = &__pyx_type_11statmoments_7_native___pyx_scope_struct_2__moments;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_3__comoments) < 0) __PYX_ERR(0, 452, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_3__comoments) < 0) __PYX_ERR(0, 481, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_11statmoments_7_native___pyx_scope_struct_3__comoments.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_3__comoments.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_3__comoments.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_11statmoments_7_native___pyx_scope_struct_3__comoments.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_11statmoments_7_native___pyx_scope_struct_3__comoments = &__pyx_type_11statmoments_7_native___pyx_scope_struct_3__comoments;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_4__moments) < 0) __PYX_ERR(0, 532, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_4__moments) < 0) __PYX_ERR(0, 558, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_11statmoments_7_native___pyx_scope_struct_4__moments.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_4__moments.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_4__moments.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_11statmoments_7_native___pyx_scope_struct_4__moments.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_11statmoments_7_native___pyx_scope_struct_4__moments = &__pyx_type_11statmoments_7_native___pyx_scope_struct_4__moments;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_5__triuflatten_gen) < 0) __PYX_ERR(0, 542, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_5__triuflatten_gen) < 0) __PYX_ERR(0, 569, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_11statmoments_7_native___pyx_scope_struct_5__triuflatten_gen.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_5__triuflatten_gen.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_5__triuflatten_gen.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_11statmoments_7_native___pyx_scope_struct_5__triuflatten_gen.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_11statmoments_7_native___pyx_scope_struct_5__triuflatten_gen = &__pyx_type_11statmoments_7_native___pyx_scope_struct_5__triuflatten_gen;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_6_memory_size) < 0) __PYX_ERR(0, 635, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_6_memory_size) < 0) __PYX_ERR(0, 670, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_11statmoments_7_native___pyx_scope_struct_6_memory_size.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_6_memory_size.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_6_memory_size.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_11statmoments_7_native___pyx_scope_struct_6_memory_size.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_11statmoments_7_native___pyx_scope_struct_6_memory_size = &__pyx_type_11statmoments_7_native___pyx_scope_struct_6_memory_size;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_7_genexpr) < 0) __PYX_ERR(0, 636, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_7_genexpr) < 0) __PYX_ERR(0, 671, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_11statmoments_7_native___pyx_scope_struct_7_genexpr.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_7_genexpr.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_7_genexpr.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_11statmoments_7_native___pyx_scope_struct_7_genexpr.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_11statmoments_7_native___pyx_scope_struct_7_genexpr = &__pyx_type_11statmoments_7_native___pyx_scope_struct_7_genexpr;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_8__moments) < 0) __PYX_ERR(0, 683, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_8__moments) < 0) __PYX_ERR(0, 721, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_11statmoments_7_native___pyx_scope_struct_8__moments.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_8__moments.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_8__moments.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_11statmoments_7_native___pyx_scope_struct_8__moments.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_11statmoments_7_native___pyx_scope_struct_8__moments = &__pyx_type_11statmoments_7_native___pyx_scope_struct_8__moments;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_9__comoments) < 0) __PYX_ERR(0, 711, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_9__comoments) < 0) __PYX_ERR(0, 754, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_11statmoments_7_native___pyx_scope_struct_9__comoments.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_9__comoments.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_9__comoments.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_11statmoments_7_native___pyx_scope_struct_9__comoments.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_11statmoments_7_native___pyx_scope_struct_9__comoments = &__pyx_type_11statmoments_7_native___pyx_scope_struct_9__comoments;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_10__sz_helper) < 0) __PYX_ERR(0, 791, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_10_memory_size) < 0) __PYX_ERR(0, 839, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
-  __pyx_type_11statmoments_7_native___pyx_scope_struct_10__sz_helper.tp_print = 0;
+  __pyx_type_11statmoments_7_native___pyx_scope_struct_10_memory_size.tp_print = 0;
   #endif
-  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_10__sz_helper.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_10__sz_helper.tp_getattro == PyObject_GenericGetAttr)) {
-    __pyx_type_11statmoments_7_native___pyx_scope_struct_10__sz_helper.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
+  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_10_memory_size.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_10_memory_size.tp_getattro == PyObject_GenericGetAttr)) {
+    __pyx_type_11statmoments_7_native___pyx_scope_struct_10_memory_size.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
-  __pyx_ptype_11statmoments_7_native___pyx_scope_struct_10__sz_helper = &__pyx_type_11statmoments_7_native___pyx_scope_struct_10__sz_helper;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_11_genexpr) < 0) __PYX_ERR(0, 792, __pyx_L1_error)
+  __pyx_ptype_11statmoments_7_native___pyx_scope_struct_10_memory_size = &__pyx_type_11statmoments_7_native___pyx_scope_struct_10_memory_size;
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_11_genexpr) < 0) __PYX_ERR(0, 840, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_11statmoments_7_native___pyx_scope_struct_11_genexpr.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_11_genexpr.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_11_genexpr.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_11statmoments_7_native___pyx_scope_struct_11_genexpr.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_11statmoments_7_native___pyx_scope_struct_11_genexpr = &__pyx_type_11statmoments_7_native___pyx_scope_struct_11_genexpr;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_12__moments) < 0) __PYX_ERR(0, 809, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_12__moments) < 0) __PYX_ERR(0, 855, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_11statmoments_7_native___pyx_scope_struct_12__moments.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_12__moments.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_12__moments.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_11statmoments_7_native___pyx_scope_struct_12__moments.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_11statmoments_7_native___pyx_scope_struct_12__moments = &__pyx_type_11statmoments_7_native___pyx_scope_struct_12__moments;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_13__comoments) < 0) __PYX_ERR(0, 839, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_13__comoments) < 0) __PYX_ERR(0, 906, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_11statmoments_7_native___pyx_scope_struct_13__comoments.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_13__comoments.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_13__comoments.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_11statmoments_7_native___pyx_scope_struct_13__comoments.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_11statmoments_7_native___pyx_scope_struct_13__comoments = &__pyx_type_11statmoments_7_native___pyx_scope_struct_13__comoments;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_14__comoments) < 0) __PYX_ERR(0, 875, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_14__comoments) < 0) __PYX_ERR(0, 961, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_11statmoments_7_native___pyx_scope_struct_14__comoments.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_14__comoments.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_14__comoments.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_11statmoments_7_native___pyx_scope_struct_14__comoments.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_11statmoments_7_native___pyx_scope_struct_14__comoments = &__pyx_type_11statmoments_7_native___pyx_scope_struct_14__comoments;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_15__ms_helper) < 0) __PYX_ERR(0, 934, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_15__ms_helper) < 0) __PYX_ERR(0, 1014, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_11statmoments_7_native___pyx_scope_struct_15__ms_helper.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_15__ms_helper.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_15__ms_helper.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_11statmoments_7_native___pyx_scope_struct_15__ms_helper.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_11statmoments_7_native___pyx_scope_struct_15__ms_helper = &__pyx_type_11statmoments_7_native___pyx_scope_struct_15__ms_helper;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_16_genexpr) < 0) __PYX_ERR(0, 935, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_16_genexpr) < 0) __PYX_ERR(0, 1015, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_11statmoments_7_native___pyx_scope_struct_16_genexpr.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_16_genexpr.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_16_genexpr.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_11statmoments_7_native___pyx_scope_struct_16_genexpr.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_11statmoments_7_native___pyx_scope_struct_16_genexpr = &__pyx_type_11statmoments_7_native___pyx_scope_struct_16_genexpr;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_17__moments) < 0) __PYX_ERR(0, 974, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_17_moments) < 0) __PYX_ERR(0, 1056, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
-  __pyx_type_11statmoments_7_native___pyx_scope_struct_17__moments.tp_print = 0;
+  __pyx_type_11statmoments_7_native___pyx_scope_struct_17_moments.tp_print = 0;
   #endif
-  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_17__moments.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_17__moments.tp_getattro == PyObject_GenericGetAttr)) {
-    __pyx_type_11statmoments_7_native___pyx_scope_struct_17__moments.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
+  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_17_moments.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_17_moments.tp_getattro == PyObject_GenericGetAttr)) {
+    __pyx_type_11statmoments_7_native___pyx_scope_struct_17_moments.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
-  __pyx_ptype_11statmoments_7_native___pyx_scope_struct_17__moments = &__pyx_type_11statmoments_7_native___pyx_scope_struct_17__moments;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_18__comoments) < 0) __PYX_ERR(0, 994, __pyx_L1_error)
+  __pyx_ptype_11statmoments_7_native___pyx_scope_struct_17_moments = &__pyx_type_11statmoments_7_native___pyx_scope_struct_17_moments;
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_18_comoments) < 0) __PYX_ERR(0, 1085, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
-  __pyx_type_11statmoments_7_native___pyx_scope_struct_18__comoments.tp_print = 0;
+  __pyx_type_11statmoments_7_native___pyx_scope_struct_18_comoments.tp_print = 0;
   #endif
-  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_18__comoments.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_18__comoments.tp_getattro == PyObject_GenericGetAttr)) {
-    __pyx_type_11statmoments_7_native___pyx_scope_struct_18__comoments.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
+  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_18_comoments.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_18_comoments.tp_getattro == PyObject_GenericGetAttr)) {
+    __pyx_type_11statmoments_7_native___pyx_scope_struct_18_comoments.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
-  __pyx_ptype_11statmoments_7_native___pyx_scope_struct_18__comoments = &__pyx_type_11statmoments_7_native___pyx_scope_struct_18__comoments;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_19_memory_size) < 0) __PYX_ERR(0, 1051, __pyx_L1_error)
+  __pyx_ptype_11statmoments_7_native___pyx_scope_struct_18_comoments = &__pyx_type_11statmoments_7_native___pyx_scope_struct_18_comoments;
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_19_memory_size) < 0) __PYX_ERR(0, 1149, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_11statmoments_7_native___pyx_scope_struct_19_memory_size.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_19_memory_size.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_19_memory_size.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_11statmoments_7_native___pyx_scope_struct_19_memory_size.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_11statmoments_7_native___pyx_scope_struct_19_memory_size = &__pyx_type_11statmoments_7_native___pyx_scope_struct_19_memory_size;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_20_genexpr) < 0) __PYX_ERR(0, 1052, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_20_genexpr) < 0) __PYX_ERR(0, 1150, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_11statmoments_7_native___pyx_scope_struct_20_genexpr.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_20_genexpr.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_20_genexpr.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_11statmoments_7_native___pyx_scope_struct_20_genexpr.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_11statmoments_7_native___pyx_scope_struct_20_genexpr = &__pyx_type_11statmoments_7_native___pyx_scope_struct_20_genexpr;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_21__moments) < 0) __PYX_ERR(0, 1060, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_21__moments) < 0) __PYX_ERR(0, 1158, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_11statmoments_7_native___pyx_scope_struct_21__moments.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_21__moments.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_21__moments.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_11statmoments_7_native___pyx_scope_struct_21__moments.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_11statmoments_7_native___pyx_scope_struct_21__moments = &__pyx_type_11statmoments_7_native___pyx_scope_struct_21__moments;
-  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_22__moments) < 0) __PYX_ERR(0, 1149, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_11statmoments_7_native___pyx_scope_struct_22__moments) < 0) __PYX_ERR(0, 1248, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_11statmoments_7_native___pyx_scope_struct_22__moments.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11statmoments_7_native___pyx_scope_struct_22__moments.tp_dictoffset && __pyx_type_11statmoments_7_native___pyx_scope_struct_22__moments.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_11statmoments_7_native___pyx_scope_struct_22__moments.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_11statmoments_7_native___pyx_scope_struct_22__moments = &__pyx_type_11statmoments_7_native___pyx_scope_struct_22__moments;
@@ -59496,17 +61882,17 @@
  * import numpy as np
  * import scipy.linalg.blas as scipy_blas             # <<<<<<<<<<<<<<
  * from scipy.special import binom
  * 
  */
   __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 11, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_INCREF(__pyx_n_s__63);
-  __Pyx_GIVEREF(__pyx_n_s__63);
-  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s__63);
+  __Pyx_INCREF(__pyx_n_s__62);
+  __Pyx_GIVEREF(__pyx_n_s__62);
+  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s__62);
   __pyx_t_2 = __Pyx_Import(__pyx_n_s_scipy_linalg_blas, __pyx_t_1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 11, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_scipy_blas, __pyx_t_2) < 0) __PYX_ERR(0, 11, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "statmoments/_native.pyx":12
@@ -59540,1475 +61926,1576 @@
   __pyx_v_11statmoments_7_native_USE_VTK = 0;
 
   /* "statmoments/_native.pyx":17
  * USE_VTK = 0
  * cython.declare(USE_GPU = cython.int)
  * USE_GPU = 0             # <<<<<<<<<<<<<<
  * 
- * #if USE_GPU:
+ * def is_vtk_installed():
  */
   __pyx_v_11statmoments_7_native_USE_GPU = 0;
 
-  /* "statmoments/_native.pyx":189
+  /* "statmoments/_native.pyx":19
+ * USE_GPU = 0
+ * 
+ * def is_vtk_installed():             # <<<<<<<<<<<<<<
+ *   if not USE_VTK:
+ *     return False
+ */
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11statmoments_7_native_1is_vtk_installed, NULL, __pyx_n_s_statmoments__native); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 19, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_is_vtk_installed, __pyx_t_1) < 0) __PYX_ERR(0, 19, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+
+  /* "statmoments/_native.pyx":206
  * 
  * ############################### COMMON CLASS ##################################
  * class _AccBase(object):             # <<<<<<<<<<<<<<
  *   def __init__(self, tr_len, cl_len, moment=2, normalize=True, **kwargs):
  *     self.total_count = 0
  */
-  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 189, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__65); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 206, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_tuple__64, __pyx_n_s_AccBase, __pyx_n_s_AccBase, (PyObject *) NULL, __pyx_n_s_statmoments__native, (PyObject *) NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 189, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_tuple__65, __pyx_n_s_AccBase, __pyx_n_s_AccBase, (PyObject *) NULL, __pyx_n_s_statmoments__native, (PyObject *) NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 206, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
 
-  /* "statmoments/_native.pyx":190
+  /* "statmoments/_native.pyx":207
  * ############################### COMMON CLASS ##################################
  * class _AccBase(object):
  *   def __init__(self, tr_len, cl_len, moment=2, normalize=True, **kwargs):             # <<<<<<<<<<<<<<
  *     self.total_count = 0
  *     self.moment = moment
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_8_AccBase_1__init__, 0, __pyx_n_s_AccBase___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__66)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 190, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_8_AccBase_1__init__, 0, __pyx_n_s_AccBase___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__67)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 207, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__67);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 190, __pyx_L1_error)
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__68);
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 207, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":199
+  /* "statmoments/_native.pyx":216
  * 
  *   @staticmethod
- *   def estimate_mem_size(trace_len, classifier_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_8_AccBase_3estimate_mem_size, __Pyx_CYFUNCTION_STATICMETHOD, __pyx_n_s_AccBase_estimate_mem_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__69)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 199, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_8_AccBase_3estimate_mem_size, __Pyx_CYFUNCTION_STATICMETHOD, __pyx_n_s_AccBase_estimate_mem_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__70)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 216, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__70);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__71);
 
-  /* "statmoments/_native.pyx":198
+  /* "statmoments/_native.pyx":215
  *     self.acc_min_count = kwargs.pop('acc_min_count', 10)
  * 
  *   @staticmethod             # <<<<<<<<<<<<<<
- *   def estimate_mem_size(trace_len, classifier_len=1, moment=2):
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):
  *     raise NotImplementedError("Must be implemented in an inherited class")
  */
-  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 198, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 215, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_estimate_mem_size, __pyx_t_4) < 0) __PYX_ERR(0, 199, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_estimate_mem_size, __pyx_t_4) < 0) __PYX_ERR(0, 216, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":202
+  /* "statmoments/_native.pyx":219
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_8_AccBase_5memory_size, 0, __pyx_n_s_AccBase_memory_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__72)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 202, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_8_AccBase_5memory_size, 0, __pyx_n_s_AccBase_memory_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__73)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 219, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_memory_size, __pyx_t_4) < 0) __PYX_ERR(0, 202, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_memory_size, __pyx_t_4) < 0) __PYX_ERR(0, 219, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":205
+  /* "statmoments/_native.pyx":222
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_8_AccBase_7update, 0, __pyx_n_s_AccBase_update, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__74)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 205, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_8_AccBase_7update, 0, __pyx_n_s_AccBase_update, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__75)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 222, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_update, __pyx_t_4) < 0) __PYX_ERR(0, 205, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_update, __pyx_t_4) < 0) __PYX_ERR(0, 222, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":208
+  /* "statmoments/_native.pyx":225
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_8_AccBase_9counts, 0, __pyx_n_s_AccBase_counts, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__76)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 208, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_8_AccBase_9counts, 0, __pyx_n_s_AccBase_counts, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__77)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 225, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_counts, __pyx_t_4) < 0) __PYX_ERR(0, 208, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_counts, __pyx_t_4) < 0) __PYX_ERR(0, 225, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":211
+  /* "statmoments/_native.pyx":228
  *     raise NotImplementedError("Must be implemented in an inherited class")
  * 
  *   def moments(self, moments=None, normalize=None):             # <<<<<<<<<<<<<<
  *     """Return a generator yielding a pair of univariate statistical moments for each classifier"""
  *     moments = moments if moments is not None else [self.moment]
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_8_AccBase_11moments, 0, __pyx_n_s_AccBase_moments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__78)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 211, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_8_AccBase_11moments, 0, __pyx_n_s_AccBase_moments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__79)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 228, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_4, __pyx_tuple__79);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_moments, __pyx_t_4) < 0) __PYX_ERR(0, 211, __pyx_L1_error)
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_4, __pyx_tuple__80);
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_moments, __pyx_t_4) < 0) __PYX_ERR(0, 228, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":217
+  /* "statmoments/_native.pyx":234
  *     return self._moments(moments, normalize)
  * 
  *   def _ensure_ret(self, mlen):             # <<<<<<<<<<<<<<
  *     if self._retm.shape[1] < mlen:
- *         tr_len = self.trace_len
+ *       tr_len = self.trace_len
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_8_AccBase_13_ensure_ret, 0, __pyx_n_s_AccBase__ensure_ret, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__81)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 217, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_8_AccBase_13_ensure_ret, 0, __pyx_n_s_AccBase__ensure_ret, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__82)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 234, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_ensure_ret, __pyx_t_4) < 0) __PYX_ERR(0, 217, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_ensure_ret, __pyx_t_4) < 0) __PYX_ERR(0, 234, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":224
+  /* "statmoments/_native.pyx":241
  *     return self._retm
  * 
  *   def comoments(self, moments=None, normalize=None):             # <<<<<<<<<<<<<<
  *     """Return a generator yielding the requested set of bivariate comoments for each classifier"""
  *     moments = moments if moments is not None else np.broadcast_to(self.moment, (2, 1))
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_8_AccBase_15comoments, 0, __pyx_n_s_AccBase_comoments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__83)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 224, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_8_AccBase_15comoments, 0, __pyx_n_s_AccBase_comoments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__84)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 241, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_4, __pyx_tuple__84);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_comoments_2, __pyx_t_4) < 0) __PYX_ERR(0, 224, __pyx_L1_error)
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_4, __pyx_tuple__85);
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_comoments_2, __pyx_t_4) < 0) __PYX_ERR(0, 241, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":189
+  /* "statmoments/_native.pyx":206
  * 
  * ############################### COMMON CLASS ##################################
  * class _AccBase(object):             # <<<<<<<<<<<<<<
  *   def __init__(self, tr_len, cl_len, moment=2, normalize=True, **kwargs):
  *     self.total_count = 0
  */
-  __pyx_t_4 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_AccBase, __pyx_tuple__64, __pyx_t_2, NULL, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 189, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_AccBase, __pyx_tuple__65, __pyx_t_2, NULL, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 206, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_AccBase, __pyx_t_4) < 0) __PYX_ERR(0, 189, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_AccBase, __pyx_t_4) < 0) __PYX_ERR(0, 206, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":243
+  /* "statmoments/_native.pyx":261
  * #@cython.returns('double[:, ::1]')
  * #@cython.locals(M = 'double[:, ::1]', moment='int', tmpbuf = 'double[:, ::1]')
  * def _rmoms2cmoms(M, moment, tmpbuf):             # <<<<<<<<<<<<<<
  *   cython.declare(k='int', p='int')
  * 
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11statmoments_7_native_1_rmoms2cmoms, NULL, __pyx_n_s_statmoments__native); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 243, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11statmoments_7_native_3_rmoms2cmoms, NULL, __pyx_n_s_statmoments__native); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 261, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_rmoms2cmoms, __pyx_t_1) < 0) __PYX_ERR(0, 243, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_rmoms2cmoms, __pyx_t_1) < 0) __PYX_ERR(0, 261, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":254
- * 
+  /* "statmoments/_native.pyx":271
+ *   return M
  * 
  * def calc_central_moment_general(raw, ave, n, k, l, i, j):             # <<<<<<<<<<<<<<
  *   """ Calculate co-moments for any available moments """
- *   ave_i = ave[i]
+ *   ave_i = ave[i]  # i is a scalar
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11statmoments_7_native_3calc_central_moment_general, NULL, __pyx_n_s_statmoments__native); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 254, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11statmoments_7_native_5calc_central_moment_general, NULL, __pyx_n_s_statmoments__native); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 271, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calc_central_moment_general, __pyx_t_1) < 0) __PYX_ERR(0, 254, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calc_central_moment_general, __pyx_t_1) < 0) __PYX_ERR(0, 271, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":328
- *   return m
+  /* "statmoments/_native.pyx":350
+ * 
  * 
  * class _bivar_sum_base(_AccBase):             # <<<<<<<<<<<<<<
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, **kwargs)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_AccBase); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 328, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_AccBase); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 350, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 328, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 350, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 328, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 350, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_t_2, __pyx_n_s_bivar_sum_base, __pyx_n_s_bivar_sum_base, (PyObject *) NULL, __pyx_n_s_statmoments__native, (PyObject *) NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 328, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_t_2, __pyx_n_s_bivar_sum_base, __pyx_n_s_bivar_sum_base, (PyObject *) NULL, __pyx_n_s_statmoments__native, (PyObject *) NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 350, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 328, __pyx_L1_error)
+  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 350, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
 
-  /* "statmoments/_native.pyx":329
+  /* "statmoments/_native.pyx":351
  * 
  * class _bivar_sum_base(_AccBase):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  * 
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_bivar_sum_base_1__init__, 0, __pyx_n_s_bivar_sum_base___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__90)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 329, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_bivar_sum_base_1__init__, 0, __pyx_n_s_bivar_sum_base___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__91)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 351, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(__pyx_t_5);
   PyList_Append(__pyx_t_3, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_5);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_init, __pyx_t_5) < 0) __PYX_ERR(0, 329, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_init, __pyx_t_5) < 0) __PYX_ERR(0, 351, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":346
+  /* "statmoments/_native.pyx":368
  * 
  *   @staticmethod
- *   def estimate_mem_size(trace_len, classifier_len=1, moment=2, acc_dtype=np.float64):             # <<<<<<<<<<<<<<
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2, acc_dtype=np.float64):             # <<<<<<<<<<<<<<
  *     # Approximate memory consumption for 1 classifier, 1 moment:
  *     # 10k: 5GB,  20k: 15GB,  50k: 80GB
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_bivar_sum_base_3estimate_mem_size, __Pyx_CYFUNCTION_STATICMETHOD, __pyx_n_s_bivar_sum_base_estimate_mem_siz, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__92)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 346, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_bivar_sum_base_3estimate_mem_size, __Pyx_CYFUNCTION_STATICMETHOD, __pyx_n_s_bivar_sum_base_estimate_mem_siz, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 368, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (!__Pyx_CyFunction_InitDefaults(__pyx_t_5, sizeof(__pyx_defaults), 1)) __PYX_ERR(0, 346, __pyx_L1_error)
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 346, __pyx_L1_error)
+  if (!__Pyx_CyFunction_InitDefaults(__pyx_t_5, sizeof(__pyx_defaults), 1)) __PYX_ERR(0, 368, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 368, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 346, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 368, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_CyFunction_Defaults(__pyx_defaults, __pyx_t_5)->__pyx_arg_acc_dtype = __pyx_t_7;
   __Pyx_GIVEREF(__pyx_t_7);
   __pyx_t_7 = 0;
-  __Pyx_CyFunction_SetDefaultsGetter(__pyx_t_5, __pyx_pf_11statmoments_7_native_20__defaults__);
+  __Pyx_CyFunction_SetDefaultsGetter(__pyx_t_5, __pyx_pf_11statmoments_7_native_22__defaults__);
 
-  /* "statmoments/_native.pyx":345
+  /* "statmoments/_native.pyx":367
  *     self._accs   = np.zeros((classifier_len, moment * trace_len + 2, moment * trace_len + 1), dtype=self._dtype)
  * 
  *   @staticmethod             # <<<<<<<<<<<<<<
- *   def estimate_mem_size(trace_len, classifier_len=1, moment=2, acc_dtype=np.float64):
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2, acc_dtype=np.float64):
  *     # Approximate memory consumption for 1 classifier, 1 moment:
  */
-  __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 345, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 367, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_estimate_mem_size, __pyx_t_7) < 0) __PYX_ERR(0, 346, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_estimate_mem_size, __pyx_t_7) < 0) __PYX_ERR(0, 368, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "statmoments/_native.pyx":355
- *     return (lytsz + accssz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
+  /* "statmoments/_native.pyx":378
+ *     return (lytsz + accssz + bufsz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
- *     mem_ttest = 0  # included in mem_class
+ *     # ttest memory included in mem_class or std normalization computed one line at a time
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_bivar_sum_base_5memory_size, 0, __pyx_n_s_bivar_sum_base_memory_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__94)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 355, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_bivar_sum_base_5memory_size, 0, __pyx_n_s_bivar_sum_base_memory_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 378, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_memory_size, __pyx_t_7) < 0) __PYX_ERR(0, 355, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_memory_size, __pyx_t_7) < 0) __PYX_ERR(0, 378, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "statmoments/_native.pyx":360
+  /* "statmoments/_native.pyx":384
  *     return mem_class + mem_ttest * 8
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     moment, batch_cnt = self.moment, len(traces)
  *     tr_len, cl_len = self.trace_len, self.classifiers_len
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_bivar_sum_base_7update, 0, __pyx_n_s_bivar_sum_base_update, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__96)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 360, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_bivar_sum_base_7update, 0, __pyx_n_s_bivar_sum_base_update, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 384, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_update, __pyx_t_7) < 0) __PYX_ERR(0, 360, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_update, __pyx_t_7) < 0) __PYX_ERR(0, 384, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "statmoments/_native.pyx":401
+  /* "statmoments/_native.pyx":425
  *           ssyrk(tr_lyt[n0:], self._accs[i, 1:], b'U')
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
  *     accs = self._accs[i]
  *     acc0, acc1 = accs, accs[1:].T
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_bivar_sum_base_9counts, 0, __pyx_n_s_bivar_sum_base_counts, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__98)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 401, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_bivar_sum_base_9counts, 0, __pyx_n_s_bivar_sum_base_counts, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__99)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 425, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_counts, __pyx_t_7) < 0) __PYX_ERR(0, 401, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_counts, __pyx_t_7) < 0) __PYX_ERR(0, 425, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "statmoments/_native.pyx":406
+  /* "statmoments/_native.pyx":430
  *     return acc0[0, 0], acc1[0, 0]
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     maxm = np.max(moments)
  *     if self.moment * 2 < maxm:
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_bivar_sum_base_11_moments, 0, __pyx_n_s_bivar_sum_base__moments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__22)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 406, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_bivar_sum_base_11_moments, 0, __pyx_n_s_bivar_sum_base__moments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__24)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 430, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_moments_2, __pyx_t_7) < 0) __PYX_ERR(0, 406, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_moments_2, __pyx_t_7) < 0) __PYX_ERR(0, 430, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "statmoments/_native.pyx":452
+  /* "statmoments/_native.pyx":481
  *       yield cm[:, moments]
  * 
  *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     retm = self._retm
  *     tr_len, cl_len = self.trace_len, self._accs.shape[0]
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_bivar_sum_base_14_comoments, 0, __pyx_n_s_bivar_sum_base__comoments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__25)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 452, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_bivar_sum_base_14_comoments, 0, __pyx_n_s_bivar_sum_base__comoments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__26)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_comoments, __pyx_t_7) < 0) __PYX_ERR(0, 452, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_comoments, __pyx_t_7) < 0) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "statmoments/_native.pyx":328
- *   return m
+  /* "statmoments/_native.pyx":350
+ * 
  * 
  * class _bivar_sum_base(_AccBase):             # <<<<<<<<<<<<<<
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, **kwargs)
  */
-  __pyx_t_7 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_bivar_sum_base, __pyx_t_2, __pyx_t_4, NULL, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 328, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_bivar_sum_base, __pyx_t_2, __pyx_t_4, NULL, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 350, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (__Pyx_CyFunction_InitClassCell(__pyx_t_3, __pyx_t_7) < 0) __PYX_ERR(0, 328, __pyx_L1_error)
+  if (__Pyx_CyFunction_InitClassCell(__pyx_t_3, __pyx_t_7) < 0) __PYX_ERR(0, 350, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_bivar_sum_base, __pyx_t_7) < 0) __PYX_ERR(0, 328, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_bivar_sum_base, __pyx_t_7) < 0) __PYX_ERR(0, 350, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":498
+  /* "statmoments/_native.pyx":522
  * 
  * 
  * class bivar_sum(_bivar_sum_base):             # <<<<<<<<<<<<<<
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, acctype=np.float64, **kwargs)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_bivar_sum_base); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 498, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_bivar_sum_base); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 522, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 498, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 522, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_CalculateMetaclass(NULL, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 498, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_CalculateMetaclass(NULL, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 522, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_Py3MetaclassPrepare(__pyx_t_2, __pyx_t_1, __pyx_n_s_bivar_sum, __pyx_n_s_bivar_sum, (PyObject *) NULL, __pyx_n_s_statmoments__native, (PyObject *) NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 498, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_Py3MetaclassPrepare(__pyx_t_2, __pyx_t_1, __pyx_n_s_bivar_sum, __pyx_n_s_bivar_sum, (PyObject *) NULL, __pyx_n_s_statmoments__native, (PyObject *) NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 522, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 498, __pyx_L1_error)
+  __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 522, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
 
-  /* "statmoments/_native.pyx":499
+  /* "statmoments/_native.pyx":523
  * 
  * class bivar_sum(_bivar_sum_base):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, acctype=np.float64, **kwargs)
  * 
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_9bivar_sum_1__init__, 0, __pyx_n_s_bivar_sum___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__102)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 499, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_9bivar_sum_1__init__, 0, __pyx_n_s_bivar_sum___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__103)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 523, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_t_3);
   PyList_Append(__pyx_t_7, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 499, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 523, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":498
+  /* "statmoments/_native.pyx":522
  * 
  * 
  * class bivar_sum(_bivar_sum_base):             # <<<<<<<<<<<<<<
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, acctype=np.float64, **kwargs)
  */
-  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_bivar_sum, __pyx_t_1, __pyx_t_4, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 498, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_bivar_sum, __pyx_t_1, __pyx_t_4, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 522, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_CyFunction_InitClassCell(__pyx_t_7, __pyx_t_3) < 0) __PYX_ERR(0, 498, __pyx_L1_error)
+  if (__Pyx_CyFunction_InitClassCell(__pyx_t_7, __pyx_t_3) < 0) __PYX_ERR(0, 522, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_bivar_sum, __pyx_t_3) < 0) __PYX_ERR(0, 498, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_bivar_sum, __pyx_t_3) < 0) __PYX_ERR(0, 522, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":502
- *     super().__init__(trace_len, classifier_len, acctype=np.float64, **kwargs)
+  /* "statmoments/_native.pyx":527
+ * 
  * 
  * class bivar_sum_mix(_bivar_sum_base):             # <<<<<<<<<<<<<<
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, acctype=np.float32, **kwargs)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_bivar_sum_base); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 502, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_bivar_sum_base); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 527, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 502, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 527, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 502, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 527, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_t_2, __pyx_n_s_bivar_sum_mix, __pyx_n_s_bivar_sum_mix, (PyObject *) NULL, __pyx_n_s_statmoments__native, (PyObject *) NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 502, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_t_2, __pyx_n_s_bivar_sum_mix, __pyx_n_s_bivar_sum_mix, (PyObject *) NULL, __pyx_n_s_statmoments__native, (PyObject *) NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 527, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 502, __pyx_L1_error)
+  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 527, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
 
-  /* "statmoments/_native.pyx":503
+  /* "statmoments/_native.pyx":528
  * 
  * class bivar_sum_mix(_bivar_sum_base):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, acctype=np.float32, **kwargs)
  * 
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_13bivar_sum_mix_1__init__, 0, __pyx_n_s_bivar_sum_mix___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__104)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 503, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_13bivar_sum_mix_1__init__, 0, __pyx_n_s_bivar_sum_mix___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__105)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 528, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_INCREF(__pyx_t_7);
   PyList_Append(__pyx_t_3, __pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_7);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_init, __pyx_t_7) < 0) __PYX_ERR(0, 503, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_init, __pyx_t_7) < 0) __PYX_ERR(0, 528, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "statmoments/_native.pyx":502
- *     super().__init__(trace_len, classifier_len, acctype=np.float64, **kwargs)
+  /* "statmoments/_native.pyx":527
+ * 
  * 
  * class bivar_sum_mix(_bivar_sum_base):             # <<<<<<<<<<<<<<
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, acctype=np.float32, **kwargs)
  */
-  __pyx_t_7 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_bivar_sum_mix, __pyx_t_2, __pyx_t_4, NULL, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 502, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_bivar_sum_mix, __pyx_t_2, __pyx_t_4, NULL, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 527, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (__Pyx_CyFunction_InitClassCell(__pyx_t_3, __pyx_t_7) < 0) __PYX_ERR(0, 502, __pyx_L1_error)
+  if (__Pyx_CyFunction_InitClassCell(__pyx_t_3, __pyx_t_7) < 0) __PYX_ERR(0, 527, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_bivar_sum_mix, __pyx_t_7) < 0) __PYX_ERR(0, 502, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_bivar_sum_mix, __pyx_t_7) < 0) __PYX_ERR(0, 527, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":506
- *     super().__init__(trace_len, classifier_len, acctype=np.float32, **kwargs)
+  /* "statmoments/_native.pyx":532
+ * 
  * 
  * class bivar_sum_detrend(_bivar_sum_base):             # <<<<<<<<<<<<<<
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, **kwargs)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_bivar_sum_base); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 506, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_bivar_sum_base); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 532, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 506, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 532, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_CalculateMetaclass(NULL, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 506, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_CalculateMetaclass(NULL, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 532, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_Py3MetaclassPrepare(__pyx_t_2, __pyx_t_1, __pyx_n_s_bivar_sum_detrend, __pyx_n_s_bivar_sum_detrend, (PyObject *) NULL, __pyx_n_s_statmoments__native, (PyObject *) NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 506, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_Py3MetaclassPrepare(__pyx_t_2, __pyx_t_1, __pyx_n_s_bivar_sum_detrend, __pyx_n_s_bivar_sum_detrend, (PyObject *) NULL, __pyx_n_s_statmoments__native, (PyObject *) NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 532, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 506, __pyx_L1_error)
+  __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 532, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
 
-  /* "statmoments/_native.pyx":507
+  /* "statmoments/_native.pyx":533
  * 
  * class bivar_sum_detrend(_bivar_sum_base):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  *     self._dbuf = np.zeros((1, self.trace_len), dtype=self._dtype)[1:]
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_17bivar_sum_detrend_1__init__, 0, __pyx_n_s_bivar_sum_detrend___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__106)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 507, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_17bivar_sum_detrend_1__init__, 0, __pyx_n_s_bivar_sum_detrend___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__107)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 533, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_t_3);
   PyList_Append(__pyx_t_7, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 507, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 533, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":513
+  /* "statmoments/_native.pyx":539
  *     self._detrend_cnt = kwargs.pop('detrend_cnt', 10)
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     tr_copy = np.asarray(traces, dtype=self._dtype)
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_17bivar_sum_detrend_3update, 0, __pyx_n_s_bivar_sum_detrend_update, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__108)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 513, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_17bivar_sum_detrend_3update, 0, __pyx_n_s_bivar_sum_detrend_update, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__109)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 539, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_t_3);
   PyList_Append(__pyx_t_7, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_update, __pyx_t_3) < 0) __PYX_ERR(0, 513, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_update, __pyx_t_3) < 0) __PYX_ERR(0, 539, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":532
- *     super().update(tr_copy-self._dbuf, cl_copy)
+  /* "statmoments/_native.pyx":558
+ *     super().update(tr_copy - self._dbuf, cl_copy)
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     m1idx = [i for i, m in enumerate(moments) if m == 1]
  *     has_m1 = len(m1idx) != 0
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_17bivar_sum_detrend_5_moments, 0, __pyx_n_s_bivar_sum_detrend__moments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__27)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 532, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_17bivar_sum_detrend_5_moments, 0, __pyx_n_s_bivar_sum_detrend__moments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__28)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 558, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_t_3);
   PyList_Append(__pyx_t_7, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_moments_2, __pyx_t_3) < 0) __PYX_ERR(0, 532, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_moments_2, __pyx_t_3) < 0) __PYX_ERR(0, 558, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":506
- *     super().__init__(trace_len, classifier_len, acctype=np.float32, **kwargs)
+  /* "statmoments/_native.pyx":532
+ * 
  * 
  * class bivar_sum_detrend(_bivar_sum_base):             # <<<<<<<<<<<<<<
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, **kwargs)
  */
-  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_bivar_sum_detrend, __pyx_t_1, __pyx_t_4, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 506, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_bivar_sum_detrend, __pyx_t_1, __pyx_t_4, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 532, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_CyFunction_InitClassCell(__pyx_t_7, __pyx_t_3) < 0) __PYX_ERR(0, 506, __pyx_L1_error)
+  if (__Pyx_CyFunction_InitClassCell(__pyx_t_7, __pyx_t_3) < 0) __PYX_ERR(0, 532, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_bivar_sum_detrend, __pyx_t_3) < 0) __PYX_ERR(0, 506, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_bivar_sum_detrend, __pyx_t_3) < 0) __PYX_ERR(0, 532, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":542
+  /* "statmoments/_native.pyx":569
  * 
  * 
  * def _triuflatten_gen(n):             # <<<<<<<<<<<<<<
  *   _ndx = np.triu_indices_from(np.empty((n, n)))
  *   def _triu(tr2d):
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11statmoments_7_native_5_triuflatten_gen, NULL, __pyx_n_s_statmoments__native); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 542, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11statmoments_7_native_7_triuflatten_gen, NULL, __pyx_n_s_statmoments__native); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 569, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_triuflatten_gen, __pyx_t_1) < 0) __PYX_ERR(0, 542, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_triuflatten_gen, __pyx_t_1) < 0) __PYX_ERR(0, 569, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":548
+  /* "statmoments/_native.pyx":575
  *   return _triu
  * 
  * def _compute_by_rows(tr_len, f):             # <<<<<<<<<<<<<<
  *   # Compute by rows upper triangle part of matrix from function f
  *   # This function is required for optimized memory consumption
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11statmoments_7_native_7_compute_by_rows, NULL, __pyx_n_s_statmoments__native); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 548, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11statmoments_7_native_9_compute_by_rows, NULL, __pyx_n_s_statmoments__native); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 575, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_by_rows, __pyx_t_1) < 0) __PYX_ERR(0, 548, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_by_rows, __pyx_t_1) < 0) __PYX_ERR(0, 575, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":557
+  /* "statmoments/_native.pyx":584
  *   return com
  * 
  * def update_moments(acc2d, acc1d, n1, moment, traces):             # <<<<<<<<<<<<<<
  *   # The update method:
  *   # x - ave2 = x + (ave1 - ave1) - ave2 = x - ave1 + (ave1 - ave2)
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11statmoments_7_native_9update_moments, NULL, __pyx_n_s_statmoments__native); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 557, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11statmoments_7_native_11update_moments, NULL, __pyx_n_s_statmoments__native); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 584, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_update_moments, __pyx_t_1) < 0) __PYX_ERR(0, 557, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_update_moments, __pyx_t_1) < 0) __PYX_ERR(0, 584, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":607
+  /* "statmoments/_native.pyx":634
  *       acc2d[k, :, l, :] += n1 * np.outer(delta[k], delta[l])
  * 
  * def _calc_comoments(MM, lm, rm, normalize):             # <<<<<<<<<<<<<<
  *   # Find the coefficients with the required degree for the left part and the right part
  *   # lm - left_moment, rm - right_moment
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11statmoments_7_native_11_calc_comoments, NULL, __pyx_n_s_statmoments__native); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 607, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11statmoments_7_native_13_calc_comoments, NULL, __pyx_n_s_statmoments__native); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 634, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calc_comoments, __pyx_t_1) < 0) __PYX_ERR(0, 607, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calc_comoments, __pyx_t_1) < 0) __PYX_ERR(0, 634, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":616
- *   return m
+  /* "statmoments/_native.pyx":644
+ * 
  * 
  * class bivar_cntr(_AccBase):             # <<<<<<<<<<<<<<
  *   """A class, working with 2D accs, which track central moments"""
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_AccBase); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 616, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_AccBase); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 644, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 616, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 644, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 616, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 644, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_t_2, __pyx_n_s_bivar_cntr, __pyx_n_s_bivar_cntr, (PyObject *) NULL, __pyx_n_s_statmoments__native, __pyx_kp_s_A_class_working_with_2D_accs_whi); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 616, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_t_2, __pyx_n_s_bivar_cntr, __pyx_n_s_bivar_cntr, (PyObject *) NULL, __pyx_n_s_statmoments__native, __pyx_kp_s_A_class_working_with_2D_accs_whi); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 644, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 616, __pyx_L1_error)
+  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 644, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
 
-  /* "statmoments/_native.pyx":618
+  /* "statmoments/_native.pyx":646
  * class bivar_cntr(_AccBase):
  *   """A class, working with 2D accs, which track central moments"""
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  * 
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10bivar_cntr_1__init__, 0, __pyx_n_s_bivar_cntr___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__119)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 618, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10bivar_cntr_1__init__, 0, __pyx_n_s_bivar_cntr___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__120)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 646, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_INCREF(__pyx_t_7);
   PyList_Append(__pyx_t_3, __pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_7);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_init, __pyx_t_7) < 0) __PYX_ERR(0, 618, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_init, __pyx_t_7) < 0) __PYX_ERR(0, 646, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "statmoments/_native.pyx":630
+  /* "statmoments/_native.pyx":658
  * 
  *   @staticmethod
- *   def estimate_mem_size(tr_len, classifier_len=1, moment=2):             # <<<<<<<<<<<<<<
- *     #                   layout          acc_count                    accs1d                                             accs2d
- *     mem_class = 10*moment*tr_len + classifier_len*2 + classifier_len*2*tr_len + classifier_len*2*moment*tr_len*moment*tr_len
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *     exp_traces = 50  # Expected number of traces in the input batch
+ *     acc_dtype  = np.float64
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10bivar_cntr_3estimate_mem_size, __Pyx_CYFUNCTION_STATICMETHOD, __pyx_n_s_bivar_cntr_estimate_mem_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__121)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 630, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10bivar_cntr_3estimate_mem_size, __Pyx_CYFUNCTION_STATICMETHOD, __pyx_n_s_bivar_cntr_estimate_mem_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__122)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 658, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_7, __pyx_tuple__122);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_7, __pyx_tuple__123);
 
-  /* "statmoments/_native.pyx":629
- *     self._retm  = np.empty((2, 2, trace_len * (trace_len + 1) // 2))
+  /* "statmoments/_native.pyx":657
+ *     self._retm = np.empty((2, 2, trace_len * (trace_len + 1) // 2))
  * 
  *   @staticmethod             # <<<<<<<<<<<<<<
- *   def estimate_mem_size(tr_len, classifier_len=1, moment=2):
- *     #                   layout          acc_count                    accs1d                                             accs2d
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):
+ *     exp_traces = 50  # Expected number of traces in the input batch
  */
-  __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 629, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 657, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_estimate_mem_size, __pyx_t_5) < 0) __PYX_ERR(0, 630, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_estimate_mem_size, __pyx_t_5) < 0) __PYX_ERR(0, 658, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":635
- *     return mem_class * classifier_len * 8
+  /* "statmoments/_native.pyx":670
+ *     return (lytsz + accs1dsz + accs2dsz) * np.finfo(acc_dtype).bits // 8 + (ttsz + ttstdsz) * 8 + clssz * 4
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
- *     mem_ttest = self._accs1d.shape[2] ** 2 // 2 * 4
+ *     # ttest memory included in mem_class or one additional square for std normalization
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10bivar_cntr_5memory_size, 0, __pyx_n_s_bivar_cntr_memory_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__124)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10bivar_cntr_5memory_size, 0, __pyx_n_s_bivar_cntr_memory_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__125)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 670, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_memory_size, __pyx_t_5) < 0) __PYX_ERR(0, 635, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_memory_size, __pyx_t_5) < 0) __PYX_ERR(0, 670, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":640
+  /* "statmoments/_native.pyx":676
  *     return mem_class + mem_ttest * 8
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     moment, batch_cnt = self.moment, len(traces)
  *     tr_len, cl_len = self.trace_len, len(classifiers[0])
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10bivar_cntr_7update, 0, __pyx_n_s_bivar_cntr_update, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__126)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 640, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10bivar_cntr_7update, 0, __pyx_n_s_bivar_cntr_update, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__127)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 676, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_update, __pyx_t_5) < 0) __PYX_ERR(0, 640, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_update, __pyx_t_5) < 0) __PYX_ERR(0, 676, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":680
- *         dgemm(tr_layout[n0:].reshape((-1, ar_len)), tr_layout[n0:].reshape((-1, ar_len)), self._accs2d[i, 1].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
+  /* "statmoments/_native.pyx":718
+ *               self._accs2d[i, 1].reshape(ar_len, ar_len), transa=b'N', transb=b'T')
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
  *     return self._cls_count[i]
  * 
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10bivar_cntr_9counts, 0, __pyx_n_s_bivar_cntr_counts, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__128)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 680, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10bivar_cntr_9counts, 0, __pyx_n_s_bivar_cntr_counts, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__129)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 718, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_counts, __pyx_t_5) < 0) __PYX_ERR(0, 680, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_counts, __pyx_t_5) < 0) __PYX_ERR(0, 718, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":683
+  /* "statmoments/_native.pyx":721
  *     return self._cls_count[i]
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
- *     maxm = np.max(moments)
+ *     maxm, min_cnt = np.max(moments), self.acc_min_count
  *     if self.moment * 2 < maxm:
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10bivar_cntr_11_moments, 0, __pyx_n_s_bivar_cntr__moments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__30)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 683, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10bivar_cntr_11_moments, 0, __pyx_n_s_bivar_cntr__moments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__31)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 721, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_moments_2, __pyx_t_5) < 0) __PYX_ERR(0, 683, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_moments_2, __pyx_t_5) < 0) __PYX_ERR(0, 721, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":711
+  /* "statmoments/_native.pyx":754
  *       yield retm
  * 
  *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
- * #    self._retm[:] = 0  # TODO: Check if needed
  *     retm = self._retm
+ *     tr_len, min_cnt = self.trace_len, self.acc_min_count
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10bivar_cntr_14_comoments, 0, __pyx_n_s_bivar_cntr__comoments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__31)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10bivar_cntr_14_comoments, 0, __pyx_n_s_bivar_cntr__comoments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__32)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 754, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_comoments, __pyx_t_5) < 0) __PYX_ERR(0, 711, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_comoments, __pyx_t_5) < 0) __PYX_ERR(0, 754, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":616
- *   return m
+  /* "statmoments/_native.pyx":644
+ * 
  * 
  * class bivar_cntr(_AccBase):             # <<<<<<<<<<<<<<
  *   """A class, working with 2D accs, which track central moments"""
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  */
-  __pyx_t_5 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_bivar_cntr, __pyx_t_2, __pyx_t_4, NULL, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 616, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_bivar_cntr, __pyx_t_2, __pyx_t_4, NULL, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 644, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_CyFunction_InitClassCell(__pyx_t_3, __pyx_t_5) < 0) __PYX_ERR(0, 616, __pyx_L1_error)
+  if (__Pyx_CyFunction_InitClassCell(__pyx_t_3, __pyx_t_5) < 0) __PYX_ERR(0, 644, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_bivar_cntr, __pyx_t_5) < 0) __PYX_ERR(0, 616, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_bivar_cntr, __pyx_t_5) < 0) __PYX_ERR(0, 644, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":730
+  /* "statmoments/_native.pyx":776
  * 
  * ########################## BIVAR 2pass and text book ##########################
  * def _std_normalize(arr):             # <<<<<<<<<<<<<<
- *     return arr / np.std(arr, axis=0)
+ *   return arr / np.std(arr, axis=0)
  * 
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_11statmoments_7_native_13_std_normalize, NULL, __pyx_n_s_statmoments__native); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 730, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_11statmoments_7_native_15_std_normalize, NULL, __pyx_n_s_statmoments__native); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 776, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_std_normalize, __pyx_t_2) < 0) __PYX_ERR(0, 730, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_std_normalize, __pyx_t_2) < 0) __PYX_ERR(0, 776, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":733
- *     return arr / np.std(arr, axis=0)
+  /* "statmoments/_native.pyx":779
+ *   return arr / np.std(arr, axis=0)
  * 
  * def _sort_meanfree(ret, normalize=False):             # <<<<<<<<<<<<<<
- *   ret[:] -= np.mean(ret, axis=0)
- *   if normalize:
+ *   if len(ret) < 1:
+ *     return ret
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_11statmoments_7_native_15_sort_meanfree, NULL, __pyx_n_s_statmoments__native); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 733, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_11statmoments_7_native_17_sort_meanfree, NULL, __pyx_n_s_statmoments__native); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 779, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_sort_meanfree, __pyx_t_2) < 0) __PYX_ERR(0, 733, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_sort_meanfree, __pyx_t_2) < 0) __PYX_ERR(0, 779, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":777
- *   # return np.vstack(list(triuflatten(np.outer(tr**m1, tr**m2)) for tr in traces)) # 3x slower
+  /* "statmoments/_native.pyx":826
+ * 
  * 
  * class _BivarNpassBase(_AccBase):             # <<<<<<<<<<<<<<
  *   def __init__(self, tr_len, cl_len, **kwargs):
  *     super().__init__(tr_len, cl_len, **kwargs)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_AccBase); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 777, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_AccBase); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 826, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 777, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 826, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_CalculateMetaclass(NULL, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 777, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_CalculateMetaclass(NULL, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 826, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_Py3MetaclassPrepare(__pyx_t_2, __pyx_t_1, __pyx_n_s_BivarNpassBase, __pyx_n_s_BivarNpassBase, (PyObject *) NULL, __pyx_n_s_statmoments__native, (PyObject *) NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 777, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_Py3MetaclassPrepare(__pyx_t_2, __pyx_t_1, __pyx_n_s_BivarNpassBase, __pyx_n_s_BivarNpassBase, (PyObject *) NULL, __pyx_n_s_statmoments__native, (PyObject *) NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 826, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 777, __pyx_L1_error)
+  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 826, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
 
-  /* "statmoments/_native.pyx":778
+  /* "statmoments/_native.pyx":827
  * 
  * class _BivarNpassBase(_AccBase):
  *   def __init__(self, tr_len, cl_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(tr_len, cl_len, **kwargs)
  *     self.traces = np.empty((1, tr_len))[1:]
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_BivarNpassBase_1__init__, 0, __pyx_n_s_BivarNpassBase___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__136)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 778, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_BivarNpassBase_1__init__, 0, __pyx_n_s_BivarNpassBase___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__137)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 827, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_t_3);
   PyList_Append(__pyx_t_5, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 778, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 827, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":786
+  /* "statmoments/_native.pyx":835
  * 
  *   @staticmethod
- *   def estimate_mem_size(trace_len, classifier_len=1, moment=2):             # <<<<<<<<<<<<<<
- *     mem_class = trace_len * trace_len + 4 * trace_len * (trace_len+1) // 2
- *     return mem_class * 8 * classifier_len
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *     mem_class = tr_len * tr_len + 2 * 2 * tr_len * (tr_len + 1) // 2
+ *     return mem_class * 8
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_BivarNpassBase_3estimate_mem_size, __Pyx_CYFUNCTION_STATICMETHOD, __pyx_n_s_BivarNpassBase_estimate_mem_siz, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__138)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 786, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_BivarNpassBase_3estimate_mem_size, __Pyx_CYFUNCTION_STATICMETHOD, __pyx_n_s_BivarNpassBase_estimate_mem_siz, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__139)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 835, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__139);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__140);
 
-  /* "statmoments/_native.pyx":785
+  /* "statmoments/_native.pyx":834
  *     self._retm  = np.empty((2, 2, tr_len * (tr_len + 1) // 2))
  * 
  *   @staticmethod             # <<<<<<<<<<<<<<
- *   def estimate_mem_size(trace_len, classifier_len=1, moment=2):
- *     mem_class = trace_len * trace_len + 4 * trace_len * (trace_len+1) // 2
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):
+ *     mem_class = tr_len * tr_len + 2 * 2 * tr_len * (tr_len + 1) // 2
  */
-  __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 785, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 834, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_estimate_mem_size, __pyx_t_7) < 0) __PYX_ERR(0, 786, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_estimate_mem_size, __pyx_t_7) < 0) __PYX_ERR(0, 835, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "statmoments/_native.pyx":790
- *     return mem_class * 8 * classifier_len
+  /* "statmoments/_native.pyx":839
+ *     return mem_class * 8
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
- *     def _sz_helper(inst):
- *       return sum(v.nbytes for v in inst if isinstance(v, np.ndarray))
+ *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
+ *     return mem_class
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_BivarNpassBase_5memory_size, 0, __pyx_n_s_BivarNpassBase_memory_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__141)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 790, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_BivarNpassBase_5memory_size, 0, __pyx_n_s_BivarNpassBase_memory_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__142)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 839, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_memory_size, __pyx_t_7) < 0) __PYX_ERR(0, 790, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_memory_size, __pyx_t_7) < 0) __PYX_ERR(0, 839, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "statmoments/_native.pyx":797
- *     return mem_class + mem_ttest * 8
+  /* "statmoments/_native.pyx":843
+ *     return mem_class
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     self.total_count += len(traces)
  * 
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_BivarNpassBase_7update, 0, __pyx_n_s_BivarNpassBase_update, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__143)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 797, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_BivarNpassBase_7update, 0, __pyx_n_s_BivarNpassBase_update, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__144)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 843, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_update, __pyx_t_7) < 0) __PYX_ERR(0, 797, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_update, __pyx_t_7) < 0) __PYX_ERR(0, 843, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "statmoments/_native.pyx":805
+  /* "statmoments/_native.pyx":851
  *     self.cls    = np.vstack((self.cls, cl_copy))
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
  *     c1 = sum(self.cls[:, i])
  *     return self.total_count - c1, c1
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_BivarNpassBase_9counts, 0, __pyx_n_s_BivarNpassBase_counts, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__145)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 805, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_BivarNpassBase_9counts, 0, __pyx_n_s_BivarNpassBase_counts, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__146)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 851, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_counts, __pyx_t_7) < 0) __PYX_ERR(0, 805, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_counts, __pyx_t_7) < 0) __PYX_ERR(0, 851, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "statmoments/_native.pyx":809
+  /* "statmoments/_native.pyx":855
  *     return self.total_count - c1, c1
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
+ *     min_cnt = self.acc_min_count
  *     tr_len, cl_len = self.trace_len, self.classifiers_len
- * 
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_BivarNpassBase_11_moments, 0, __pyx_n_s_BivarNpassBase__moments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__34)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 809, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_15_BivarNpassBase_11_moments, 0, __pyx_n_s_BivarNpassBase__moments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__33)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 855, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_moments_2, __pyx_t_7) < 0) __PYX_ERR(0, 809, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_moments_2, __pyx_t_7) < 0) __PYX_ERR(0, 855, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "statmoments/_native.pyx":777
- *   # return np.vstack(list(triuflatten(np.outer(tr**m1, tr**m2)) for tr in traces)) # 3x slower
+  /* "statmoments/_native.pyx":826
+ * 
  * 
  * class _BivarNpassBase(_AccBase):             # <<<<<<<<<<<<<<
  *   def __init__(self, tr_len, cl_len, **kwargs):
  *     super().__init__(tr_len, cl_len, **kwargs)
  */
-  __pyx_t_7 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_BivarNpassBase, __pyx_t_1, __pyx_t_4, NULL, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 777, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_BivarNpassBase, __pyx_t_1, __pyx_t_4, NULL, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 826, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (__Pyx_CyFunction_InitClassCell(__pyx_t_5, __pyx_t_7) < 0) __PYX_ERR(0, 777, __pyx_L1_error)
+  if (__Pyx_CyFunction_InitClassCell(__pyx_t_5, __pyx_t_7) < 0) __PYX_ERR(0, 826, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_BivarNpassBase, __pyx_t_7) < 0) __PYX_ERR(0, 777, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_BivarNpassBase, __pyx_t_7) < 0) __PYX_ERR(0, 826, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":838
- *       yield retm[:, :len(moments)]
+  /* "statmoments/_native.pyx":892
+ * 
  * 
  * class bivar_2pass(_BivarNpassBase):             # <<<<<<<<<<<<<<
- *   def _comoments(self, moments, normalize):
- *     C = self._tmpsq
+ *   @staticmethod
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_BivarNpassBase); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 838, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_BivarNpassBase); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 892, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 838, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 892, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 838, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 892, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_t_2, __pyx_n_s_bivar_2pass, __pyx_n_s_bivar_2pass, (PyObject *) NULL, __pyx_n_s_statmoments__native, (PyObject *) NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 838, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_t_2, __pyx_n_s_bivar_2pass, __pyx_n_s_bivar_2pass, (PyObject *) NULL, __pyx_n_s_statmoments__native, (PyObject *) NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 892, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
 
-  /* "statmoments/_native.pyx":839
+  /* "statmoments/_native.pyx":894
+ * class bivar_2pass(_BivarNpassBase):
+ *   @staticmethod
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *     mem_base  = _BivarNpassBase.estimate_mem_size(tr_len, cl_len, moment)
+ *     # One additional square for std normalization for moments > 2
+ */
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_11bivar_2pass_1estimate_mem_size, __Pyx_CYFUNCTION_STATICMETHOD, __pyx_n_s_bivar_2pass_estimate_mem_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__149)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 894, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_5, __pyx_tuple__150);
+
+  /* "statmoments/_native.pyx":893
  * 
  * class bivar_2pass(_BivarNpassBase):
+ *   @staticmethod             # <<<<<<<<<<<<<<
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):
+ *     mem_base  = _BivarNpassBase.estimate_mem_size(tr_len, cl_len, moment)
+ */
+  __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_estimate_mem_size, __pyx_t_3) < 0) __PYX_ERR(0, 894, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+
+  /* "statmoments/_native.pyx":900
+ *     return mem_base + mem_ttstd * 8
+ * 
+ *   def memory_size(self):             # <<<<<<<<<<<<<<
+ *     mem_base = super().memory_size()
+ *     # One additional square for std normalization for moments > 2
+ */
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_11bivar_2pass_3memory_size, 0, __pyx_n_s_bivar_2pass_memory_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__152)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 900, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_INCREF(__pyx_t_3);
+  PyList_Append(__pyx_t_7, __pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_3);
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_memory_size, __pyx_t_3) < 0) __PYX_ERR(0, 900, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+
+  /* "statmoments/_native.pyx":906
+ *     return mem_base + mem_ttstd * 8
+ * 
  *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
- *     C = self._tmpsq
- *     tr_len, cl_len = self.trace_len, self.cls.shape[1]
+ *     min_cnt, C = self.acc_min_count, self._tmpsq
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_11bivar_2pass_1_comoments, 0, __pyx_n_s_bivar_2pass__comoments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__35)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 839, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_comoments, __pyx_t_7) < 0) __PYX_ERR(0, 839, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_11bivar_2pass_5_comoments, 0, __pyx_n_s_bivar_2pass__comoments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__34)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 906, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_comoments, __pyx_t_3) < 0) __PYX_ERR(0, 906, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":838
- *       yield retm[:, :len(moments)]
+  /* "statmoments/_native.pyx":892
+ * 
  * 
  * class bivar_2pass(_BivarNpassBase):             # <<<<<<<<<<<<<<
- *   def _comoments(self, moments, normalize):
- *     C = self._tmpsq
+ *   @staticmethod
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):
  */
-  __pyx_t_7 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_bivar_2pass, __pyx_t_2, __pyx_t_4, NULL, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 838, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_bivar_2pass, __pyx_t_7) < 0) __PYX_ERR(0, 838, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_bivar_2pass, __pyx_t_2, __pyx_t_4, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  if (__Pyx_CyFunction_InitClassCell(__pyx_t_7, __pyx_t_3) < 0) __PYX_ERR(0, 892, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_bivar_2pass, __pyx_t_3) < 0) __PYX_ERR(0, 892, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":862
- *     yield self._retm[:, :len(moments[0])]
+  /* "statmoments/_native.pyx":933
+ * 
  * 
  * class bivar_txtbk(_BivarNpassBase):             # <<<<<<<<<<<<<<
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, **kwargs)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BivarNpassBase); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 862, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BivarNpassBase); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 933, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 862, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 933, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_CalculateMetaclass(NULL, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 862, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_CalculateMetaclass(NULL, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 933, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_Py3MetaclassPrepare(__pyx_t_2, __pyx_t_1, __pyx_n_s_bivar_txtbk, __pyx_n_s_bivar_txtbk, (PyObject *) NULL, __pyx_n_s_statmoments__native, (PyObject *) NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 862, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_Py3MetaclassPrepare(__pyx_t_2, __pyx_t_1, __pyx_n_s_bivar_txtbk, __pyx_n_s_bivar_txtbk, (PyObject *) NULL, __pyx_n_s_statmoments__native, (PyObject *) NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 933, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 862, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
+  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 933, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
 
-  /* "statmoments/_native.pyx":863
+  /* "statmoments/_native.pyx":934
  * 
  * class bivar_txtbk(_BivarNpassBase):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  *     m, n = self.acc_min_count, trace_len
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_11bivar_txtbk_1__init__, 0, __pyx_n_s_bivar_txtbk___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__149)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 863, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_11bivar_txtbk_1__init__, 0, __pyx_n_s_bivar_txtbk___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__155)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 934, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_INCREF(__pyx_t_7);
+  PyList_Append(__pyx_t_3, __pyx_t_7);
+  __Pyx_GIVEREF(__pyx_t_7);
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_init, __pyx_t_7) < 0) __PYX_ERR(0, 934, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+
+  /* "statmoments/_native.pyx":940
+ * 
+ *   @staticmethod
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *     exp_traces = 10  # Expected number of traces in the input batch
+ *     mem_base  = _BivarNpassBase.estimate_mem_size(tr_len, cl_len, moment)
+ */
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_11bivar_txtbk_3estimate_mem_size, __Pyx_CYFUNCTION_STATICMETHOD, __pyx_n_s_bivar_txtbk_estimate_mem_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__157)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 940, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_7, __pyx_tuple__158);
+
+  /* "statmoments/_native.pyx":939
+ *     self._tri = np.empty((m, n * (n + 1) // 2))  # Handle the triangle dynamically
+ * 
+ *   @staticmethod             # <<<<<<<<<<<<<<
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):
+ *     exp_traces = 10  # Expected number of traces in the input batch
+ */
+  __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 939, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_estimate_mem_size, __pyx_t_5) < 0) __PYX_ERR(0, 940, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+
+  /* "statmoments/_native.pyx":947
+ *     return mem_base + (mem_tri  + mem_ttstd)* 8
+ * 
+ *   def memory_size(self):             # <<<<<<<<<<<<<<
+ *     mem_base = super().memory_size()
+ *     # One additional square for std normalization for moments > 2
+ */
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_11bivar_txtbk_5memory_size, 0, __pyx_n_s_bivar_txtbk_memory_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__160)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(__pyx_t_5);
-  PyList_Append(__pyx_t_7, __pyx_t_5);
+  PyList_Append(__pyx_t_3, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_5);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_init, __pyx_t_5) < 0) __PYX_ERR(0, 863, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_memory_size, __pyx_t_5) < 0) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":868
- *     self._tri  = np.empty((m, n * (n+1)//2))   # Handle the triangle dynamically
+  /* "statmoments/_native.pyx":953
+ *     return mem_base + mem_ttstd * 8
  * 
  *   def _realloc_tri(self, m):             # <<<<<<<<<<<<<<
  *     if len(self._tri) < m:
- *       self._tri = None                         # Dealloc previous memory
+ *       # Greater batch received, dealloc the previous triangle and alloc new one
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_11bivar_txtbk_3_realloc_tri, 0, __pyx_n_s_bivar_txtbk__realloc_tri, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__151)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 868, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_11bivar_txtbk_7_realloc_tri, 0, __pyx_n_s_bivar_txtbk__realloc_tri, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__162)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 953, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_realloc_tri, __pyx_t_5) < 0) __PYX_ERR(0, 868, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_realloc_tri, __pyx_t_5) < 0) __PYX_ERR(0, 953, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":875
+  /* "statmoments/_native.pyx":961
  *     return self._tri[:m]
  * 
  *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
- *     C = self._tmpsq
- *     tr_len, cl_len = self.trace_len, self.cls.shape[1]
+ *     min_cnt, C = self.acc_min_count, self._tmpsq
+ *     tr_len, cl_len = self.trace_len, self.classifiers_len
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_11bivar_txtbk_5_comoments, 0, __pyx_n_s_bivar_txtbk__comoments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__36)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_11bivar_txtbk_9_comoments, 0, __pyx_n_s_bivar_txtbk__comoments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__35)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 961, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_comoments, __pyx_t_5) < 0) __PYX_ERR(0, 875, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_comoments, __pyx_t_5) < 0) __PYX_ERR(0, 961, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":862
- *     yield self._retm[:, :len(moments[0])]
+  /* "statmoments/_native.pyx":933
+ * 
  * 
  * class bivar_txtbk(_BivarNpassBase):             # <<<<<<<<<<<<<<
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, **kwargs)
  */
-  __pyx_t_5 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_bivar_txtbk, __pyx_t_1, __pyx_t_4, NULL, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 862, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_bivar_txtbk, __pyx_t_1, __pyx_t_4, NULL, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 933, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_CyFunction_InitClassCell(__pyx_t_7, __pyx_t_5) < 0) __PYX_ERR(0, 862, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_bivar_txtbk, __pyx_t_5) < 0) __PYX_ERR(0, 862, __pyx_L1_error)
+  if (__Pyx_CyFunction_InitClassCell(__pyx_t_3, __pyx_t_5) < 0) __PYX_ERR(0, 933, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_bivar_txtbk, __pyx_t_5) < 0) __PYX_ERR(0, 933, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":914
+  /* "statmoments/_native.pyx":991
  * ##################################### VTK #####################################
  * # Used for benchmarking only
- * if USE_VTK:             # <<<<<<<<<<<<<<
+ * if is_vtk_installed():             # <<<<<<<<<<<<<<
  *   import vtk
  *   from vtk.util.numpy_support import numpy_to_vtk as np2vtk, vtk_to_numpy as vtk2np
  */
-  __pyx_t_8 = (__pyx_v_11statmoments_7_native_USE_VTK != 0);
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_is_vtk_installed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 991, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 991, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 991, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (__pyx_t_8) {
 
-    /* "statmoments/_native.pyx":915
+    /* "statmoments/_native.pyx":992
  * # Used for benchmarking only
- * if USE_VTK:
+ * if is_vtk_installed():
  *   import vtk             # <<<<<<<<<<<<<<
  *   from vtk.util.numpy_support import numpy_to_vtk as np2vtk, vtk_to_numpy as vtk2np
  * 
  */
-    __pyx_t_1 = __Pyx_Import(__pyx_n_s_vtk, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 915, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_d, __pyx_n_s_vtk, __pyx_t_1) < 0) __PYX_ERR(0, 915, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_2 = __Pyx_Import(__pyx_n_s_vtk, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 992, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_vtk, __pyx_t_2) < 0) __PYX_ERR(0, 992, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "statmoments/_native.pyx":916
- * if USE_VTK:
+    /* "statmoments/_native.pyx":993
+ * if is_vtk_installed():
  *   import vtk
  *   from vtk.util.numpy_support import numpy_to_vtk as np2vtk, vtk_to_numpy as vtk2np             # <<<<<<<<<<<<<<
  * 
- * class bivar_vtk(object):
+ * 
  */
-    __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 916, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_2 = PyList_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 993, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_n_s_numpy_to_vtk);
     __Pyx_GIVEREF(__pyx_n_s_numpy_to_vtk);
-    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_numpy_to_vtk);
+    PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_s_numpy_to_vtk);
     __Pyx_INCREF(__pyx_n_s_vtk_to_numpy);
     __Pyx_GIVEREF(__pyx_n_s_vtk_to_numpy);
-    PyList_SET_ITEM(__pyx_t_1, 1, __pyx_n_s_vtk_to_numpy);
-    __pyx_t_2 = __Pyx_Import(__pyx_n_s_vtk_util_numpy_support, __pyx_t_1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 916, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_numpy_to_vtk); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 916, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_d, __pyx_n_s_np2vtk, __pyx_t_1) < 0) __PYX_ERR(0, 916, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_vtk_to_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 916, __pyx_L1_error)
+    PyList_SET_ITEM(__pyx_t_2, 1, __pyx_n_s_vtk_to_numpy);
+    __pyx_t_1 = __Pyx_Import(__pyx_n_s_vtk_util_numpy_support, __pyx_t_2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 993, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_d, __pyx_n_s_vtk2np, __pyx_t_1) < 0) __PYX_ERR(0, 916, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_numpy_to_vtk); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 993, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_np2vtk, __pyx_t_2) < 0) __PYX_ERR(0, 993, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_vtk_to_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 993, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    if (PyDict_SetItem(__pyx_d, __pyx_n_s_vtk2np, __pyx_t_2) < 0) __PYX_ERR(0, 993, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "statmoments/_native.pyx":914
+    /* "statmoments/_native.pyx":991
  * ##################################### VTK #####################################
  * # Used for benchmarking only
- * if USE_VTK:             # <<<<<<<<<<<<<<
+ * if is_vtk_installed():             # <<<<<<<<<<<<<<
  *   import vtk
  *   from vtk.util.numpy_support import numpy_to_vtk as np2vtk, vtk_to_numpy as vtk2np
  */
   }
 
-  /* "statmoments/_native.pyx":918
- *   from vtk.util.numpy_support import numpy_to_vtk as np2vtk, vtk_to_numpy as vtk2np
+  /* "statmoments/_native.pyx":996
+ * 
  * 
  * class bivar_vtk(object):             # <<<<<<<<<<<<<<
  *   """A class, using vtk multivariate kernel. Covariance ONLY!!!"""
- *   def __init__(self, trace_len, classifier_len, moment=2, **kwargs):
+ *   def __init__(self, tr_len, classifier_len, moment=2, **kwargs):
  */
-  __pyx_t_2 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__153); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 918, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_Py3MetaclassPrepare(__pyx_t_2, __pyx_tuple__153, __pyx_n_s_bivar_vtk, __pyx_n_s_bivar_vtk, (PyObject *) NULL, __pyx_n_s_statmoments__native, __pyx_kp_s_A_class_using_vtk_multivariate_k); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 918, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__164); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 996, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_tuple__164, __pyx_n_s_bivar_vtk, __pyx_n_s_bivar_vtk, (PyObject *) NULL, __pyx_n_s_statmoments__native, __pyx_kp_s_A_class_using_vtk_multivariate_k); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 996, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
 
-  /* "statmoments/_native.pyx":920
+  /* "statmoments/_native.pyx":998
  * class bivar_vtk(object):
  *   """A class, using vtk multivariate kernel. Covariance ONLY!!!"""
- *   def __init__(self, trace_len, classifier_len, moment=2, **kwargs):             # <<<<<<<<<<<<<<
- *     self.moment = moment
- *     self.trace_len = trace_len
+ *   def __init__(self, tr_len, classifier_len, moment=2, **kwargs):             # <<<<<<<<<<<<<<
+ *     self.moment = moment # In fact, only 1
+ *     self.trace_len = tr_len
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_9bivar_vtk_1__init__, 0, __pyx_n_s_bivar_vtk___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__156)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 920, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_9bivar_vtk_1__init__, 0, __pyx_n_s_bivar_vtk___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__167)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 998, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_4, __pyx_tuple__157);
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_init, __pyx_t_4) < 0) __PYX_ERR(0, 920, __pyx_L1_error)
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_4, __pyx_tuple__168);
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_init, __pyx_t_4) < 0) __PYX_ERR(0, 998, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":933
+  /* "statmoments/_native.pyx":1013
  *         mcs.SetTestOption(False)
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     def _ms_helper(instl):
  *       return sum(i.GetActualMemorySize() for i in instl)
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_9bivar_vtk_3memory_size, 0, __pyx_n_s_bivar_vtk_memory_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__159)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 933, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_9bivar_vtk_3memory_size, 0, __pyx_n_s_bivar_vtk_memory_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__170)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1013, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_memory_size, __pyx_t_4) < 0) __PYX_ERR(0, 933, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_memory_size, __pyx_t_4) < 0) __PYX_ERR(0, 1013, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":944
+  /* "statmoments/_native.pyx":1026
  * 
  *   @property
  *   def total_count(self):             # <<<<<<<<<<<<<<
  *     return sum(self._counts[0])
  * 
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_9bivar_vtk_5total_count, 0, __pyx_n_s_bivar_vtk_total_count, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__161)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_9bivar_vtk_5total_count, 0, __pyx_n_s_bivar_vtk_total_count, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__172)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1026, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
 
-  /* "statmoments/_native.pyx":943
- *     return sum(map(_ms_helper, (intbl0, outtbl0, outds1))) * 1024
+  /* "statmoments/_native.pyx":1025
+ *     return sum(map(_ms_helper, (intbl0, outtbl0, outds1))) * 1024 + mem_ttest
  * 
  *   @property             # <<<<<<<<<<<<<<
  *   def total_count(self):
  *     return sum(self._counts[0])
  */
-  __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_property, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 943, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_property, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1025, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_total_count, __pyx_t_5) < 0) __PYX_ERR(0, 944, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_total_count, __pyx_t_5) < 0) __PYX_ERR(0, 1026, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":947
+  /* "statmoments/_native.pyx":1029
  *     return sum(self._counts[0])
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     traces = np.array(np.asarray(traces, dtype=np.float64).T, copy=True)
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_9bivar_vtk_7update, 0, __pyx_n_s_bivar_vtk_update, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__163)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 947, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_9bivar_vtk_7update, 0, __pyx_n_s_bivar_vtk_update, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__174)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1029, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_update, __pyx_t_5) < 0) __PYX_ERR(0, 947, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_update, __pyx_t_5) < 0) __PYX_ERR(0, 1029, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":969
+  /* "statmoments/_native.pyx":1051
  *         mcs.Update()
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
  *     # dbs = (mcs.GetOutputDataObject(1).GetBlock(1) for mcs in self._stats[i])
  *     # return [vtk2np(dd.GetColumn(1))[dd.GetNumberOfRows()-1] for dd in dbs]
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_9bivar_vtk_9counts, 0, __pyx_n_s_bivar_vtk_counts, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__165)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 969, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_9bivar_vtk_9counts, 0, __pyx_n_s_bivar_vtk_counts, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__176)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1051, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_counts, __pyx_t_5) < 0) __PYX_ERR(0, 969, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_counts, __pyx_t_5) < 0) __PYX_ERR(0, 1051, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":974
+  /* "statmoments/_native.pyx":1056
  *     return self._counts[i]
  * 
- *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
- *     m = moments[0]
- *     if self.moment < np.max(m):
+ *   def moments(self, moments, normalize):             # <<<<<<<<<<<<<<
+ *     maxm = np.max(moments)
+ *     if self.moment * 2 < maxm:
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_9bivar_vtk_11_moments, 0, __pyx_n_s_bivar_vtk__moments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__39)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 974, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_9bivar_vtk_11moments, 0, __pyx_n_s_bivar_vtk_moments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__38)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1056, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_moments_2, __pyx_t_5) < 0) __PYX_ERR(0, 974, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_moments, __pyx_t_5) < 0) __PYX_ERR(0, 1056, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":994
- *     yield (avgs[0], avgs[0]), (avgs[1], avgs[1])
+  /* "statmoments/_native.pyx":1085
+ *     yield retm[:, :len(moments)]
  * 
- *   def _comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
+ *   def comoments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     tr_len, min_cnt = self.trace_len, self.acc_min_count
  *     triuflatten = _triuflatten_gen(tr_len)
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_9bivar_vtk_14_comoments, 0, __pyx_n_s_bivar_vtk__comoments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__41)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 994, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_9bivar_vtk_14comoments, 0, __pyx_n_s_bivar_vtk_comoments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__40)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1085, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_comoments, __pyx_t_5) < 0) __PYX_ERR(0, 994, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_comoments_2, __pyx_t_5) < 0) __PYX_ERR(0, 1085, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "statmoments/_native.pyx":918
- *   from vtk.util.numpy_support import numpy_to_vtk as np2vtk, vtk_to_numpy as vtk2np
+  /* "statmoments/_native.pyx":996
+ * 
  * 
  * class bivar_vtk(object):             # <<<<<<<<<<<<<<
  *   """A class, using vtk multivariate kernel. Covariance ONLY!!!"""
- *   def __init__(self, trace_len, classifier_len, moment=2, **kwargs):
+ *   def __init__(self, tr_len, classifier_len, moment=2, **kwargs):
  */
-  __pyx_t_5 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_bivar_vtk, __pyx_tuple__153, __pyx_t_1, NULL, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 918, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_bivar_vtk, __pyx_tuple__164, __pyx_t_2, NULL, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 996, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_bivar_vtk, __pyx_t_5) < 0) __PYX_ERR(0, 918, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_bivar_vtk, __pyx_t_5) < 0) __PYX_ERR(0, 996, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":1029
+  /* "statmoments/_native.pyx":1121
  * 
  * 
  * class univar_sum(_AccBase):             # <<<<<<<<<<<<<<
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, **kwargs)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_AccBase); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1029, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1029, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_AccBase); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1121, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
-  __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_CalculateMetaclass(NULL, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1029, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1121, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_Py3MetaclassPrepare(__pyx_t_2, __pyx_t_1, __pyx_n_s_univar_sum, __pyx_n_s_univar_sum, (PyObject *) NULL, __pyx_n_s_statmoments__native, (PyObject *) NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1029, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
+  __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1121, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_5 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_t_2, __pyx_n_s_univar_sum, __pyx_n_s_univar_sum, (PyObject *) NULL, __pyx_n_s_statmoments__native, (PyObject *) NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1121, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1029, __pyx_L1_error)
+  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1121, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
 
-  /* "statmoments/_native.pyx":1030
+  /* "statmoments/_native.pyx":1122
  * 
  * class univar_sum(_AccBase):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  * 
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10univar_sum_1__init__, 0, __pyx_n_s_univar_sum___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__169)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1030, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_INCREF(__pyx_t_7);
-  PyList_Append(__pyx_t_4, __pyx_t_7);
-  __Pyx_GIVEREF(__pyx_t_7);
-  if (__Pyx_SetNameInClass(__pyx_t_5, __pyx_n_s_init, __pyx_t_7) < 0) __PYX_ERR(0, 1030, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10univar_sum_1__init__, 0, __pyx_n_s_univar_sum___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__180)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1122, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_INCREF(__pyx_t_3);
+  PyList_Append(__pyx_t_4, __pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_3);
+  if (__Pyx_SetNameInClass(__pyx_t_5, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 1122, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "statmoments/_native.pyx":1048
+  /* "statmoments/_native.pyx":1140
  * 
  *   @staticmethod
- *   def estimate_mem_size(trace_len, classifier_len, moment):             # <<<<<<<<<<<<<<
- *     return ((classifier_len+1)*moment*trace_len + 2*moment*trace_len + 3 * trace_len) * 8
- * 
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):             # <<<<<<<<<<<<<<
+ *     exp_traces = 50  # Expected number of traces in the input batch
+ *     acc_dtype  = np.float64
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10univar_sum_3estimate_mem_size, __Pyx_CYFUNCTION_STATICMETHOD, __pyx_n_s_univar_sum_estimate_mem_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__171)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1048, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10univar_sum_3estimate_mem_size, __Pyx_CYFUNCTION_STATICMETHOD, __pyx_n_s_univar_sum_estimate_mem_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__182)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1140, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__183);
 
-  /* "statmoments/_native.pyx":1047
+  /* "statmoments/_native.pyx":1139
  *     self._retm = np.empty((2, moment, trace_len), dtype=np.float64)
  * 
  *   @staticmethod             # <<<<<<<<<<<<<<
- *   def estimate_mem_size(trace_len, classifier_len, moment):
- *     return ((classifier_len+1)*moment*trace_len + 2*moment*trace_len + 3 * trace_len) * 8
+ *   def estimate_mem_size(tr_len, cl_len=1, moment=2):
+ *     exp_traces = 50  # Expected number of traces in the input batch
  */
-  __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1047, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetNameInClass(__pyx_t_5, __pyx_n_s_estimate_mem_size, __pyx_t_3) < 0) __PYX_ERR(0, 1048, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1139, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (__Pyx_SetNameInClass(__pyx_t_5, __pyx_n_s_estimate_mem_size, __pyx_t_7) < 0) __PYX_ERR(0, 1140, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "statmoments/_native.pyx":1051
- *     return ((classifier_len+1)*moment*trace_len + 2*moment*trace_len + 3 * trace_len) * 8
+  /* "statmoments/_native.pyx":1149
+ *     return (lytsz + accssz + bufsz) * np.finfo(acc_dtype).bits // 8 + ttsz * 8
  * 
  *   def memory_size(self):             # <<<<<<<<<<<<<<
  *     mem_class = sum(v.nbytes for v in vars(self).values() if isinstance(v, np.ndarray))
  *     mem_ttest = 0  # included in mem_class
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10univar_sum_5memory_size, 0, __pyx_n_s_univar_sum_memory_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__173)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1051, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_5, __pyx_n_s_memory_size, __pyx_t_3) < 0) __PYX_ERR(0, 1051, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10univar_sum_5memory_size, 0, __pyx_n_s_univar_sum_memory_size, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__185)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1149, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  if (__Pyx_SetNameInClass(__pyx_t_5, __pyx_n_s_memory_size, __pyx_t_7) < 0) __PYX_ERR(0, 1149, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "statmoments/_native.pyx":1056
+  /* "statmoments/_native.pyx":1154
  *     return mem_class + mem_ttest * 8
  * 
  *   def counts(self, i):             # <<<<<<<<<<<<<<
- *     c1 = self._accs[i+1, 0]
+ *     c1 = self._accs[i + 1, 0]
  *     return self._accs[0, 0] - c1, c1
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10univar_sum_7counts, 0, __pyx_n_s_univar_sum_counts, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__175)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1056, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_5, __pyx_n_s_counts, __pyx_t_3) < 0) __PYX_ERR(0, 1056, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10univar_sum_7counts, 0, __pyx_n_s_univar_sum_counts, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__187)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1154, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  if (__Pyx_SetNameInClass(__pyx_t_5, __pyx_n_s_counts, __pyx_t_7) < 0) __PYX_ERR(0, 1154, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "statmoments/_native.pyx":1060
+  /* "statmoments/_native.pyx":1158
  *     return self._accs[0, 0] - c1, c1
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     maxm = np.max(moments)
  *     if 2 * self.moment < maxm:
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10univar_sum_9_moments, 0, __pyx_n_s_univar_sum__moments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__42)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1060, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_5, __pyx_n_s_moments_2, __pyx_t_3) < 0) __PYX_ERR(0, 1060, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10univar_sum_9_moments, 0, __pyx_n_s_univar_sum__moments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__41)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1158, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  if (__Pyx_SetNameInClass(__pyx_t_5, __pyx_n_s_moments_2, __pyx_t_7) < 0) __PYX_ERR(0, 1158, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "statmoments/_native.pyx":1095
+  /* "statmoments/_native.pyx":1193
  *       yield self._retm[:, moments]
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     moment, batch_cnt = self.moment, len(traces)
  *     tr_len, cl_len = self.trace_len, self.classifiers_len
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10univar_sum_12update, 0, __pyx_n_s_univar_sum_update, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__178)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1095, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_5, __pyx_n_s_update, __pyx_t_3) < 0) __PYX_ERR(0, 1095, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_10univar_sum_12update, 0, __pyx_n_s_univar_sum_update, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__190)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1193, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  if (__Pyx_SetNameInClass(__pyx_t_5, __pyx_n_s_update, __pyx_t_7) < 0) __PYX_ERR(0, 1193, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "statmoments/_native.pyx":1029
+  /* "statmoments/_native.pyx":1121
  * 
  * 
  * class univar_sum(_AccBase):             # <<<<<<<<<<<<<<
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, **kwargs)
  */
-  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_univar_sum, __pyx_t_1, __pyx_t_5, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1029, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_CyFunction_InitClassCell(__pyx_t_4, __pyx_t_3) < 0) __PYX_ERR(0, 1029, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_univar_sum, __pyx_t_2, __pyx_t_5, NULL, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1121, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  if (__Pyx_CyFunction_InitClassCell(__pyx_t_4, __pyx_t_7) < 0) __PYX_ERR(0, 1121, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_univar_sum, __pyx_t_3) < 0) __PYX_ERR(0, 1029, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_univar_sum, __pyx_t_7) < 0) __PYX_ERR(0, 1121, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "statmoments/_native.pyx":1123
- *     dgemm(tr_lyt, cl_lyt, self._accs.reshape((cl_lyt.shape[1], -1)), b'N', b'T')
+  /* "statmoments/_native.pyx":1222
+ * 
  * 
  * class univar_sum_detrend(univar_sum):             # <<<<<<<<<<<<<<
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, **kwargs)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_univar_sum); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1123, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1123, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_univar_sum); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1222, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_1);
-  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
-  __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1123, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1222, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_t_2, __pyx_n_s_univar_sum_detrend, __pyx_n_s_univar_sum_detrend, (PyObject *) NULL, __pyx_n_s_statmoments__native, (PyObject *) NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1123, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
+  __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_CalculateMetaclass(NULL, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1222, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_5 = __Pyx_Py3MetaclassPrepare(__pyx_t_2, __pyx_t_1, __pyx_n_s_univar_sum_detrend, __pyx_n_s_univar_sum_detrend, (PyObject *) NULL, __pyx_n_s_statmoments__native, (PyObject *) NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1222, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1123, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1222, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
 
-  /* "statmoments/_native.pyx":1124
+  /* "statmoments/_native.pyx":1223
  * 
  * class univar_sum_detrend(univar_sum):
  *   def __init__(self, trace_len, classifier_len, **kwargs):             # <<<<<<<<<<<<<<
  *     super().__init__(trace_len, classifier_len, **kwargs)
  *     self._dbuf = np.zeros((1, self.trace_len), dtype=self._dtype)[1:]
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_18univar_sum_detrend_1__init__, 0, __pyx_n_s_univar_sum_detrend___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__180)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1124, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_18univar_sum_detrend_1__init__, 0, __pyx_n_s_univar_sum_detrend___init, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__192)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1223, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_t_4);
-  PyList_Append(__pyx_t_3, __pyx_t_4);
+  PyList_Append(__pyx_t_7, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
-  if (__Pyx_SetNameInClass(__pyx_t_5, __pyx_n_s_init, __pyx_t_4) < 0) __PYX_ERR(0, 1124, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_5, __pyx_n_s_init, __pyx_t_4) < 0) __PYX_ERR(0, 1223, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":1130
+  /* "statmoments/_native.pyx":1229
  *     self._detrend_cnt = kwargs.pop('detrend_cnt', 10)
  * 
  *   def update(self, traces, classifiers):             # <<<<<<<<<<<<<<
  *     tr_copy = np.asarray(traces, dtype=self._dtype)
  *     cl_copy = np.asarray(classifiers, dtype=np.uint8)
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_18univar_sum_detrend_3update, 0, __pyx_n_s_univar_sum_detrend_update, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__182)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1130, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_18univar_sum_detrend_3update, 0, __pyx_n_s_univar_sum_detrend_update, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__194)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1229, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_t_4);
-  PyList_Append(__pyx_t_3, __pyx_t_4);
+  PyList_Append(__pyx_t_7, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
-  if (__Pyx_SetNameInClass(__pyx_t_5, __pyx_n_s_update, __pyx_t_4) < 0) __PYX_ERR(0, 1130, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_5, __pyx_n_s_update, __pyx_t_4) < 0) __PYX_ERR(0, 1229, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":1149
- *     super().update(tr_copy-self._dbuf, cl_copy)
+  /* "statmoments/_native.pyx":1248
+ *     super().update(tr_copy - self._dbuf, cl_copy)
  * 
  *   def _moments(self, moments, normalize):             # <<<<<<<<<<<<<<
  *     m1idx = [i for i, m in enumerate(moments) if m == 1]
  *     has_m1 = len(m1idx) != 0
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_18univar_sum_detrend_5_moments, 0, __pyx_n_s_univar_sum_detrend__moments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__44)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1149, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11statmoments_7_native_18univar_sum_detrend_5_moments, 0, __pyx_n_s_univar_sum_detrend__moments, NULL, __pyx_n_s_statmoments__native, __pyx_d, ((PyObject *)__pyx_codeobj__43)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1248, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_t_4);
-  PyList_Append(__pyx_t_3, __pyx_t_4);
+  PyList_Append(__pyx_t_7, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
-  if (__Pyx_SetNameInClass(__pyx_t_5, __pyx_n_s_moments_2, __pyx_t_4) < 0) __PYX_ERR(0, 1149, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_5, __pyx_n_s_moments_2, __pyx_t_4) < 0) __PYX_ERR(0, 1248, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "statmoments/_native.pyx":1123
- *     dgemm(tr_lyt, cl_lyt, self._accs.reshape((cl_lyt.shape[1], -1)), b'N', b'T')
+  /* "statmoments/_native.pyx":1222
+ * 
  * 
  * class univar_sum_detrend(univar_sum):             # <<<<<<<<<<<<<<
  *   def __init__(self, trace_len, classifier_len, **kwargs):
  *     super().__init__(trace_len, classifier_len, **kwargs)
  */
-  __pyx_t_4 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_univar_sum_detrend, __pyx_t_2, __pyx_t_5, NULL, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1123, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_univar_sum_detrend, __pyx_t_1, __pyx_t_5, NULL, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1222, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (__Pyx_CyFunction_InitClassCell(__pyx_t_3, __pyx_t_4) < 0) __PYX_ERR(0, 1123, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_univar_sum_detrend, __pyx_t_4) < 0) __PYX_ERR(0, 1123, __pyx_L1_error)
+  if (__Pyx_CyFunction_InitClassCell(__pyx_t_7, __pyx_t_4) < 0) __PYX_ERR(0, 1222, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_univar_sum_detrend, __pyx_t_4) < 0) __PYX_ERR(0, 1222, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":1163
+  /* "statmoments/_native.pyx":1264
  * #@cython.returns('double[:, ::1]')
  * #@cython.locals(M = 'double[:, ::1]', m='int')
  * def _preprocvar(M, m, variance=None):             # <<<<<<<<<<<<<<
  *   if m > 2:
  *     M[1][:] = (M[1] - M[0] ** 2) / variance
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_11statmoments_7_native_17_preprocvar, NULL, __pyx_n_s_statmoments__native); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1163, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_preprocvar, __pyx_t_2) < 0) __PYX_ERR(0, 1163, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11statmoments_7_native_19_preprocvar, NULL, __pyx_n_s_statmoments__native); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1264, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_preprocvar, __pyx_t_1) < 0) __PYX_ERR(0, 1264, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "statmoments/_native.pyx":1201
+  /* "statmoments/_native.pyx":1301
  *   return m0 / np.sqrt(v0)
  * 
  * def ttest(n0, n1, m10, m11, m20, m21, veq):             # <<<<<<<<<<<<<<
  *   """Compute t-test"""
  * 
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_11statmoments_7_native_19ttest, NULL, __pyx_n_s_statmoments__native); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1201, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ttest, __pyx_t_2) < 0) __PYX_ERR(0, 1201, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11statmoments_7_native_21ttest, NULL, __pyx_n_s_statmoments__native); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1301, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ttest, __pyx_t_1) < 0) __PYX_ERR(0, 1301, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "statmoments/_native.pyx":1
  * #!python             # <<<<<<<<<<<<<<
  * #cython: boundscheck=False, cdivision=True, initializedcheck=False, nonecheck=False, overflowcheck=False, profile=False, wraparound=False
  * 
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_2) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_1) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "View.MemoryView":210
  *         info.obj = self
  * 
  *     __pyx_getbuffer = capsule(<void *> &__pyx_array_getbuffer, "getbuffer(obj, view, flags)")             # <<<<<<<<<<<<<<
  * 
  *     def __dealloc__(array self):
  */
-  __pyx_t_2 = __pyx_capsule_create(((void *)(&__pyx_array_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 210, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem((PyObject *)__pyx_array_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_2) < 0) __PYX_ERR(1, 210, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_1 = __pyx_capsule_create(((void *)(&__pyx_array_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 210, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem((PyObject *)__pyx_array_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_1) < 0) __PYX_ERR(1, 210, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_array_type);
 
   /* "View.MemoryView":287
  *         return self.name
  * 
  * cdef generic = Enum("<strided and direct or indirect>")             # <<<<<<<<<<<<<<
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")
  */
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__188, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 287, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__200, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 287, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XGOTREF(generic);
-  __Pyx_DECREF_SET(generic, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_t_2 = 0;
+  __Pyx_DECREF_SET(generic, __pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_t_1 = 0;
 
   /* "View.MemoryView":288
  * 
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default             # <<<<<<<<<<<<<<
  * cdef indirect = Enum("<strided and indirect>")
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__189, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 288, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__201, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 288, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XGOTREF(strided);
-  __Pyx_DECREF_SET(strided, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_t_2 = 0;
+  __Pyx_DECREF_SET(strided, __pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_t_1 = 0;
 
   /* "View.MemoryView":289
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__190, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 289, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__202, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 289, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XGOTREF(indirect);
-  __Pyx_DECREF_SET(indirect, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_t_2 = 0;
+  __Pyx_DECREF_SET(indirect, __pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_t_1 = 0;
 
   /* "View.MemoryView":292
  * 
  * 
  * cdef contiguous = Enum("<contiguous and direct>")             # <<<<<<<<<<<<<<
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__191, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 292, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__203, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 292, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XGOTREF(contiguous);
-  __Pyx_DECREF_SET(contiguous, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_t_2 = 0;
+  __Pyx_DECREF_SET(contiguous, __pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_t_1 = 0;
 
   /* "View.MemoryView":293
  * 
  * cdef contiguous = Enum("<contiguous and direct>")
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__192, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 293, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__204, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 293, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XGOTREF(indirect_contiguous);
-  __Pyx_DECREF_SET(indirect_contiguous, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_2);
-  __pyx_t_2 = 0;
+  __Pyx_DECREF_SET(indirect_contiguous, __pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_1);
+  __pyx_t_1 = 0;
 
   /* "View.MemoryView":317
  * 
  * DEF THREAD_LOCKS_PREALLOCATED = 8
  * cdef int __pyx_memoryview_thread_locks_used = 0             # <<<<<<<<<<<<<<
  * cdef PyThread_type_lock[THREAD_LOCKS_PREALLOCATED] __pyx_memoryview_thread_locks = [
  *     PyThread_allocate_lock(),
@@ -61035,42 +63522,42 @@
   /* "View.MemoryView":551
  *         info.obj = self
  * 
  *     __pyx_getbuffer = capsule(<void *> &__pyx_memoryview_getbuffer, "getbuffer(obj, view, flags)")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_2 = __pyx_capsule_create(((void *)(&__pyx_memoryview_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 551, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem((PyObject *)__pyx_memoryview_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_2) < 0) __PYX_ERR(1, 551, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_1 = __pyx_capsule_create(((void *)(&__pyx_memoryview_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 551, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem((PyObject *)__pyx_memoryview_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_1) < 0) __PYX_ERR(1, 551, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_memoryview_type);
 
   /* "View.MemoryView":997
  *         return self.from_object
  * 
  *     __pyx_getbuffer = capsule(<void *> &__pyx_memoryview_getbuffer, "getbuffer(obj, view, flags)")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_2 = __pyx_capsule_create(((void *)(&__pyx_memoryview_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 997, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem((PyObject *)__pyx_memoryviewslice_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_2) < 0) __PYX_ERR(1, 997, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_1 = __pyx_capsule_create(((void *)(&__pyx_memoryview_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 997, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem((PyObject *)__pyx_memoryviewslice_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_1) < 0) __PYX_ERR(1, 997, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_memoryviewslice_type);
 
   /* "(tree fragment)":1
  * def __pyx_unpickle_Enum(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_15View_dot_MemoryView_1__pyx_unpickle_Enum, NULL, __pyx_n_s_View_MemoryView); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_pyx_unpickle_Enum, __pyx_t_2) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_15View_dot_MemoryView_1__pyx_unpickle_Enum, NULL, __pyx_n_s_View_MemoryView); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_pyx_unpickle_Enum, __pyx_t_1) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "(tree fragment)":11
  *         __pyx_unpickle_Enum__set_state(<Enum> __pyx_result, __pyx_state)
  *     return __pyx_result
  * cdef __pyx_unpickle_Enum__set_state(Enum __pyx_result, tuple __pyx_state):             # <<<<<<<<<<<<<<
  *     __pyx_result.name = __pyx_state[0]
  *     if len(__pyx_state) > 1 and hasattr(__pyx_result, '__dict__'):
@@ -61148,14 +63635,279 @@
 #else
             "name '%.200s' is not defined", PyString_AS_STRING(name));
 #endif
     }
     return result;
 }
 
+/* Import */
+static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level) {
+    PyObject *empty_list = 0;
+    PyObject *module = 0;
+    PyObject *global_dict = 0;
+    PyObject *empty_dict = 0;
+    PyObject *list;
+    #if PY_MAJOR_VERSION < 3
+    PyObject *py_import;
+    py_import = __Pyx_PyObject_GetAttrStr(__pyx_b, __pyx_n_s_import);
+    if (!py_import)
+        goto bad;
+    #endif
+    if (from_list)
+        list = from_list;
+    else {
+        empty_list = PyList_New(0);
+        if (!empty_list)
+            goto bad;
+        list = empty_list;
+    }
+    global_dict = PyModule_GetDict(__pyx_m);
+    if (!global_dict)
+        goto bad;
+    empty_dict = PyDict_New();
+    if (!empty_dict)
+        goto bad;
+    {
+        #if PY_MAJOR_VERSION >= 3
+        if (level == -1) {
+            if ((1) && (strchr(__Pyx_MODULE_NAME, '.'))) {
+                module = PyImport_ImportModuleLevelObject(
+                    name, global_dict, empty_dict, list, 1);
+                if (!module) {
+                    if (!PyErr_ExceptionMatches(PyExc_ImportError))
+                        goto bad;
+                    PyErr_Clear();
+                }
+            }
+            level = 0;
+        }
+        #endif
+        if (!module) {
+            #if PY_MAJOR_VERSION < 3
+            PyObject *py_level = PyInt_FromLong(level);
+            if (!py_level)
+                goto bad;
+            module = PyObject_CallFunctionObjArgs(py_import,
+                name, global_dict, empty_dict, list, py_level, (PyObject *)NULL);
+            Py_DECREF(py_level);
+            #else
+            module = PyImport_ImportModuleLevelObject(
+                name, global_dict, empty_dict, list, level);
+            #endif
+        }
+    }
+bad:
+    #if PY_MAJOR_VERSION < 3
+    Py_XDECREF(py_import);
+    #endif
+    Py_XDECREF(empty_list);
+    Py_XDECREF(empty_dict);
+    return module;
+}
+
+/* PyObjectCall */
+#if CYTHON_COMPILING_IN_CPYTHON
+static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw) {
+    PyObject *result;
+    ternaryfunc call = Py_TYPE(func)->tp_call;
+    if (unlikely(!call))
+        return PyObject_Call(func, arg, kw);
+    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
+        return NULL;
+    result = (*call)(func, arg, kw);
+    Py_LeaveRecursiveCall();
+    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
+        PyErr_SetString(
+            PyExc_SystemError,
+            "NULL result without error in PyObject_Call");
+    }
+    return result;
+}
+#endif
+
+/* GetTopmostException */
+#if CYTHON_USE_EXC_INFO_STACK
+static _PyErr_StackItem *
+__Pyx_PyErr_GetTopmostException(PyThreadState *tstate)
+{
+    _PyErr_StackItem *exc_info = tstate->exc_info;
+    while ((exc_info->exc_type == NULL || exc_info->exc_type == Py_None) &&
+           exc_info->previous_item != NULL)
+    {
+        exc_info = exc_info->previous_item;
+    }
+    return exc_info;
+}
+#endif
+
+/* SaveResetException */
+#if CYTHON_FAST_THREAD_STATE
+static CYTHON_INLINE void __Pyx__ExceptionSave(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb) {
+    #if CYTHON_USE_EXC_INFO_STACK
+    _PyErr_StackItem *exc_info = __Pyx_PyErr_GetTopmostException(tstate);
+    *type = exc_info->exc_type;
+    *value = exc_info->exc_value;
+    *tb = exc_info->exc_traceback;
+    #else
+    *type = tstate->exc_type;
+    *value = tstate->exc_value;
+    *tb = tstate->exc_traceback;
+    #endif
+    Py_XINCREF(*type);
+    Py_XINCREF(*value);
+    Py_XINCREF(*tb);
+}
+static CYTHON_INLINE void __Pyx__ExceptionReset(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb) {
+    PyObject *tmp_type, *tmp_value, *tmp_tb;
+    #if CYTHON_USE_EXC_INFO_STACK
+    _PyErr_StackItem *exc_info = tstate->exc_info;
+    tmp_type = exc_info->exc_type;
+    tmp_value = exc_info->exc_value;
+    tmp_tb = exc_info->exc_traceback;
+    exc_info->exc_type = type;
+    exc_info->exc_value = value;
+    exc_info->exc_traceback = tb;
+    #else
+    tmp_type = tstate->exc_type;
+    tmp_value = tstate->exc_value;
+    tmp_tb = tstate->exc_traceback;
+    tstate->exc_type = type;
+    tstate->exc_value = value;
+    tstate->exc_traceback = tb;
+    #endif
+    Py_XDECREF(tmp_type);
+    Py_XDECREF(tmp_value);
+    Py_XDECREF(tmp_tb);
+}
+#endif
+
+/* PyErrFetchRestore */
+#if CYTHON_FAST_THREAD_STATE
+static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb) {
+    PyObject *tmp_type, *tmp_value, *tmp_tb;
+    tmp_type = tstate->curexc_type;
+    tmp_value = tstate->curexc_value;
+    tmp_tb = tstate->curexc_traceback;
+    tstate->curexc_type = type;
+    tstate->curexc_value = value;
+    tstate->curexc_traceback = tb;
+    Py_XDECREF(tmp_type);
+    Py_XDECREF(tmp_value);
+    Py_XDECREF(tmp_tb);
+}
+static CYTHON_INLINE void __Pyx_ErrFetchInState(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb) {
+    *type = tstate->curexc_type;
+    *value = tstate->curexc_value;
+    *tb = tstate->curexc_traceback;
+    tstate->curexc_type = 0;
+    tstate->curexc_value = 0;
+    tstate->curexc_traceback = 0;
+}
+#endif
+
+/* FastTypeChecks */
+#if CYTHON_COMPILING_IN_CPYTHON
+static int __Pyx_InBases(PyTypeObject *a, PyTypeObject *b) {
+    while (a) {
+        a = a->tp_base;
+        if (a == b)
+            return 1;
+    }
+    return b == &PyBaseObject_Type;
+}
+static CYTHON_INLINE int __Pyx_IsSubtype(PyTypeObject *a, PyTypeObject *b) {
+    PyObject *mro;
+    if (a == b) return 1;
+    mro = a->tp_mro;
+    if (likely(mro)) {
+        Py_ssize_t i, n;
+        n = PyTuple_GET_SIZE(mro);
+        for (i = 0; i < n; i++) {
+            if (PyTuple_GET_ITEM(mro, i) == (PyObject *)b)
+                return 1;
+        }
+        return 0;
+    }
+    return __Pyx_InBases(a, b);
+}
+#if PY_MAJOR_VERSION == 2
+static int __Pyx_inner_PyErr_GivenExceptionMatches2(PyObject *err, PyObject* exc_type1, PyObject* exc_type2) {
+    PyObject *exception, *value, *tb;
+    int res;
+    __Pyx_PyThreadState_declare
+    __Pyx_PyThreadState_assign
+    __Pyx_ErrFetch(&exception, &value, &tb);
+    res = exc_type1 ? PyObject_IsSubclass(err, exc_type1) : 0;
+    if (unlikely(res == -1)) {
+        PyErr_WriteUnraisable(err);
+        res = 0;
+    }
+    if (!res) {
+        res = PyObject_IsSubclass(err, exc_type2);
+        if (unlikely(res == -1)) {
+            PyErr_WriteUnraisable(err);
+            res = 0;
+        }
+    }
+    __Pyx_ErrRestore(exception, value, tb);
+    return res;
+}
+#else
+static CYTHON_INLINE int __Pyx_inner_PyErr_GivenExceptionMatches2(PyObject *err, PyObject* exc_type1, PyObject *exc_type2) {
+    int res = exc_type1 ? __Pyx_IsSubtype((PyTypeObject*)err, (PyTypeObject*)exc_type1) : 0;
+    if (!res) {
+        res = __Pyx_IsSubtype((PyTypeObject*)err, (PyTypeObject*)exc_type2);
+    }
+    return res;
+}
+#endif
+static int __Pyx_PyErr_GivenExceptionMatchesTuple(PyObject *exc_type, PyObject *tuple) {
+    Py_ssize_t i, n;
+    assert(PyExceptionClass_Check(exc_type));
+    n = PyTuple_GET_SIZE(tuple);
+#if PY_MAJOR_VERSION >= 3
+    for (i=0; i<n; i++) {
+        if (exc_type == PyTuple_GET_ITEM(tuple, i)) return 1;
+    }
+#endif
+    for (i=0; i<n; i++) {
+        PyObject *t = PyTuple_GET_ITEM(tuple, i);
+        #if PY_MAJOR_VERSION < 3
+        if (likely(exc_type == t)) return 1;
+        #endif
+        if (likely(PyExceptionClass_Check(t))) {
+            if (__Pyx_inner_PyErr_GivenExceptionMatches2(exc_type, NULL, t)) return 1;
+        } else {
+        }
+    }
+    return 0;
+}
+static CYTHON_INLINE int __Pyx_PyErr_GivenExceptionMatches(PyObject *err, PyObject* exc_type) {
+    if (likely(err == exc_type)) return 1;
+    if (likely(PyExceptionClass_Check(err))) {
+        if (likely(PyExceptionClass_Check(exc_type))) {
+            return __Pyx_inner_PyErr_GivenExceptionMatches2(err, NULL, exc_type);
+        } else if (likely(PyTuple_Check(exc_type))) {
+            return __Pyx_PyErr_GivenExceptionMatchesTuple(err, exc_type);
+        } else {
+        }
+    }
+    return PyErr_GivenExceptionMatches(err, exc_type);
+}
+static CYTHON_INLINE int __Pyx_PyErr_GivenExceptionMatches2(PyObject *err, PyObject *exc_type1, PyObject *exc_type2) {
+    assert(PyExceptionClass_Check(exc_type1));
+    assert(PyExceptionClass_Check(exc_type2));
+    if (likely(err == exc_type1 || err == exc_type2)) return 1;
+    if (likely(PyExceptionClass_Check(err))) {
+        return __Pyx_inner_PyErr_GivenExceptionMatches2(err, exc_type1, exc_type2);
+    }
+    return (PyErr_GivenExceptionMatches(err, exc_type1) || PyErr_GivenExceptionMatches(err, exc_type2));
+}
+#endif
+
 /* PyDictVersioning */
 #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_TYPE_SLOTS
 static CYTHON_INLINE PY_UINT64_T __Pyx_get_tp_dict_version(PyObject *obj) {
     PyObject *dict = Py_TYPE(obj)->tp_dict;
     return likely(dict) ? __PYX_GET_DICT_VERSION(dict) : 0;
 }
 static CYTHON_INLINE PY_UINT64_T __Pyx_get_object_dict_version(PyObject *obj) {
@@ -61209,14 +63961,88 @@
         return __Pyx_NewRef(result);
     }
     PyErr_Clear();
 #endif
     return __Pyx_GetBuiltinName(name);
 }
 
+/* GetException */
+#if CYTHON_FAST_THREAD_STATE
+static int __Pyx__GetException(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb)
+#else
+static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb)
+#endif
+{
+    PyObject *local_type, *local_value, *local_tb;
+#if CYTHON_FAST_THREAD_STATE
+    PyObject *tmp_type, *tmp_value, *tmp_tb;
+    local_type = tstate->curexc_type;
+    local_value = tstate->curexc_value;
+    local_tb = tstate->curexc_traceback;
+    tstate->curexc_type = 0;
+    tstate->curexc_value = 0;
+    tstate->curexc_traceback = 0;
+#else
+    PyErr_Fetch(&local_type, &local_value, &local_tb);
+#endif
+    PyErr_NormalizeException(&local_type, &local_value, &local_tb);
+#if CYTHON_FAST_THREAD_STATE
+    if (unlikely(tstate->curexc_type))
+#else
+    if (unlikely(PyErr_Occurred()))
+#endif
+        goto bad;
+    #if PY_MAJOR_VERSION >= 3
+    if (local_tb) {
+        if (unlikely(PyException_SetTraceback(local_value, local_tb) < 0))
+            goto bad;
+    }
+    #endif
+    Py_XINCREF(local_tb);
+    Py_XINCREF(local_type);
+    Py_XINCREF(local_value);
+    *type = local_type;
+    *value = local_value;
+    *tb = local_tb;
+#if CYTHON_FAST_THREAD_STATE
+    #if CYTHON_USE_EXC_INFO_STACK
+    {
+        _PyErr_StackItem *exc_info = tstate->exc_info;
+        tmp_type = exc_info->exc_type;
+        tmp_value = exc_info->exc_value;
+        tmp_tb = exc_info->exc_traceback;
+        exc_info->exc_type = local_type;
+        exc_info->exc_value = local_value;
+        exc_info->exc_traceback = local_tb;
+    }
+    #else
+    tmp_type = tstate->exc_type;
+    tmp_value = tstate->exc_value;
+    tmp_tb = tstate->exc_traceback;
+    tstate->exc_type = local_type;
+    tstate->exc_value = local_value;
+    tstate->exc_traceback = local_tb;
+    #endif
+    Py_XDECREF(tmp_type);
+    Py_XDECREF(tmp_value);
+    Py_XDECREF(tmp_tb);
+#else
+    PyErr_SetExcInfo(local_type, local_value, local_tb);
+#endif
+    return 0;
+bad:
+    *type = 0;
+    *value = 0;
+    *tb = 0;
+    Py_XDECREF(local_type);
+    Py_XDECREF(local_value);
+    Py_XDECREF(local_tb);
+    return -1;
+}
+
 /* PyFunctionFastCall */
 #if CYTHON_FAST_PYCALL
 static PyObject* __Pyx_PyFunction_FastCallNoKw(PyCodeObject *co, PyObject **args, Py_ssize_t na,
                                                PyObject *globals) {
     PyFrameObject *f;
     PyThreadState *tstate = __Pyx_PyThreadState_Current;
     PyObject **fastlocals;
@@ -61351,58 +64177,14 @@
         return (*((__Pyx_PyCFunctionFastWithKeywords)(void*)meth)) (self, args, nargs, NULL);
     } else {
         return (*((__Pyx_PyCFunctionFast)(void*)meth)) (self, args, nargs);
     }
 }
 #endif
 
-/* PyObjectCall */
-#if CYTHON_COMPILING_IN_CPYTHON
-static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw) {
-    PyObject *result;
-    ternaryfunc call = Py_TYPE(func)->tp_call;
-    if (unlikely(!call))
-        return PyObject_Call(func, arg, kw);
-    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
-        return NULL;
-    result = (*call)(func, arg, kw);
-    Py_LeaveRecursiveCall();
-    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
-        PyErr_SetString(
-            PyExc_SystemError,
-            "NULL result without error in PyObject_Call");
-    }
-    return result;
-}
-#endif
-
-/* PyErrFetchRestore */
-#if CYTHON_FAST_THREAD_STATE
-static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb) {
-    PyObject *tmp_type, *tmp_value, *tmp_tb;
-    tmp_type = tstate->curexc_type;
-    tmp_value = tstate->curexc_value;
-    tmp_tb = tstate->curexc_traceback;
-    tstate->curexc_type = type;
-    tstate->curexc_value = value;
-    tstate->curexc_traceback = tb;
-    Py_XDECREF(tmp_type);
-    Py_XDECREF(tmp_value);
-    Py_XDECREF(tmp_tb);
-}
-static CYTHON_INLINE void __Pyx_ErrFetchInState(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb) {
-    *type = tstate->curexc_type;
-    *value = tstate->curexc_value;
-    *tb = tstate->curexc_traceback;
-    tstate->curexc_type = 0;
-    tstate->curexc_value = 0;
-    tstate->curexc_traceback = 0;
-}
-#endif
-
 /* WriteUnraisableException */
 static void __Pyx_WriteUnraisable(const char *name, CYTHON_UNUSED int clineno,
                                   CYTHON_UNUSED int lineno, CYTHON_UNUSED const char *filename,
                                   int full_traceback, CYTHON_UNUSED int nogil) {
     PyObject *old_exc, *old_val, *old_tb;
     PyObject *ctx;
     __Pyx_PyThreadState_declare
@@ -64817,144 +67599,14 @@
     if (likely(__Pyx_TypeCheck(obj, type)))
         return 1;
     PyErr_Format(PyExc_TypeError, "Cannot convert %.200s to %.200s",
                  Py_TYPE(obj)->tp_name, type->tp_name);
     return 0;
 }
 
-/* GetTopmostException */
-    #if CYTHON_USE_EXC_INFO_STACK
-static _PyErr_StackItem *
-__Pyx_PyErr_GetTopmostException(PyThreadState *tstate)
-{
-    _PyErr_StackItem *exc_info = tstate->exc_info;
-    while ((exc_info->exc_type == NULL || exc_info->exc_type == Py_None) &&
-           exc_info->previous_item != NULL)
-    {
-        exc_info = exc_info->previous_item;
-    }
-    return exc_info;
-}
-#endif
-
-/* SaveResetException */
-    #if CYTHON_FAST_THREAD_STATE
-static CYTHON_INLINE void __Pyx__ExceptionSave(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb) {
-    #if CYTHON_USE_EXC_INFO_STACK
-    _PyErr_StackItem *exc_info = __Pyx_PyErr_GetTopmostException(tstate);
-    *type = exc_info->exc_type;
-    *value = exc_info->exc_value;
-    *tb = exc_info->exc_traceback;
-    #else
-    *type = tstate->exc_type;
-    *value = tstate->exc_value;
-    *tb = tstate->exc_traceback;
-    #endif
-    Py_XINCREF(*type);
-    Py_XINCREF(*value);
-    Py_XINCREF(*tb);
-}
-static CYTHON_INLINE void __Pyx__ExceptionReset(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb) {
-    PyObject *tmp_type, *tmp_value, *tmp_tb;
-    #if CYTHON_USE_EXC_INFO_STACK
-    _PyErr_StackItem *exc_info = tstate->exc_info;
-    tmp_type = exc_info->exc_type;
-    tmp_value = exc_info->exc_value;
-    tmp_tb = exc_info->exc_traceback;
-    exc_info->exc_type = type;
-    exc_info->exc_value = value;
-    exc_info->exc_traceback = tb;
-    #else
-    tmp_type = tstate->exc_type;
-    tmp_value = tstate->exc_value;
-    tmp_tb = tstate->exc_traceback;
-    tstate->exc_type = type;
-    tstate->exc_value = value;
-    tstate->exc_traceback = tb;
-    #endif
-    Py_XDECREF(tmp_type);
-    Py_XDECREF(tmp_value);
-    Py_XDECREF(tmp_tb);
-}
-#endif
-
-/* GetException */
-    #if CYTHON_FAST_THREAD_STATE
-static int __Pyx__GetException(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb)
-#else
-static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb)
-#endif
-{
-    PyObject *local_type, *local_value, *local_tb;
-#if CYTHON_FAST_THREAD_STATE
-    PyObject *tmp_type, *tmp_value, *tmp_tb;
-    local_type = tstate->curexc_type;
-    local_value = tstate->curexc_value;
-    local_tb = tstate->curexc_traceback;
-    tstate->curexc_type = 0;
-    tstate->curexc_value = 0;
-    tstate->curexc_traceback = 0;
-#else
-    PyErr_Fetch(&local_type, &local_value, &local_tb);
-#endif
-    PyErr_NormalizeException(&local_type, &local_value, &local_tb);
-#if CYTHON_FAST_THREAD_STATE
-    if (unlikely(tstate->curexc_type))
-#else
-    if (unlikely(PyErr_Occurred()))
-#endif
-        goto bad;
-    #if PY_MAJOR_VERSION >= 3
-    if (local_tb) {
-        if (unlikely(PyException_SetTraceback(local_value, local_tb) < 0))
-            goto bad;
-    }
-    #endif
-    Py_XINCREF(local_tb);
-    Py_XINCREF(local_type);
-    Py_XINCREF(local_value);
-    *type = local_type;
-    *value = local_value;
-    *tb = local_tb;
-#if CYTHON_FAST_THREAD_STATE
-    #if CYTHON_USE_EXC_INFO_STACK
-    {
-        _PyErr_StackItem *exc_info = tstate->exc_info;
-        tmp_type = exc_info->exc_type;
-        tmp_value = exc_info->exc_value;
-        tmp_tb = exc_info->exc_traceback;
-        exc_info->exc_type = local_type;
-        exc_info->exc_value = local_value;
-        exc_info->exc_traceback = local_tb;
-    }
-    #else
-    tmp_type = tstate->exc_type;
-    tmp_value = tstate->exc_value;
-    tmp_tb = tstate->exc_traceback;
-    tstate->exc_type = local_type;
-    tstate->exc_value = local_value;
-    tstate->exc_traceback = local_tb;
-    #endif
-    Py_XDECREF(tmp_type);
-    Py_XDECREF(tmp_value);
-    Py_XDECREF(tmp_tb);
-#else
-    PyErr_SetExcInfo(local_type, local_value, local_tb);
-#endif
-    return 0;
-bad:
-    *type = 0;
-    *value = 0;
-    *tb = 0;
-    Py_XDECREF(local_type);
-    Py_XDECREF(local_value);
-    Py_XDECREF(local_tb);
-    return -1;
-}
-
 /* SwapException */
     #if CYTHON_FAST_THREAD_STATE
 static CYTHON_INLINE void __Pyx__ExceptionSwap(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb) {
     PyObject *tmp_type, *tmp_value, *tmp_tb;
     #if CYTHON_USE_EXC_INFO_STACK
     _PyErr_StackItem *exc_info = tstate->exc_info;
     tmp_type = exc_info->exc_type;
@@ -64982,179 +67634,14 @@
     PyErr_SetExcInfo(*type, *value, *tb);
     *type = tmp_type;
     *value = tmp_value;
     *tb = tmp_tb;
 }
 #endif
 
-/* Import */
-    static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level) {
-    PyObject *empty_list = 0;
-    PyObject *module = 0;
-    PyObject *global_dict = 0;
-    PyObject *empty_dict = 0;
-    PyObject *list;
-    #if PY_MAJOR_VERSION < 3
-    PyObject *py_import;
-    py_import = __Pyx_PyObject_GetAttrStr(__pyx_b, __pyx_n_s_import);
-    if (!py_import)
-        goto bad;
-    #endif
-    if (from_list)
-        list = from_list;
-    else {
-        empty_list = PyList_New(0);
-        if (!empty_list)
-            goto bad;
-        list = empty_list;
-    }
-    global_dict = PyModule_GetDict(__pyx_m);
-    if (!global_dict)
-        goto bad;
-    empty_dict = PyDict_New();
-    if (!empty_dict)
-        goto bad;
-    {
-        #if PY_MAJOR_VERSION >= 3
-        if (level == -1) {
-            if ((1) && (strchr(__Pyx_MODULE_NAME, '.'))) {
-                module = PyImport_ImportModuleLevelObject(
-                    name, global_dict, empty_dict, list, 1);
-                if (!module) {
-                    if (!PyErr_ExceptionMatches(PyExc_ImportError))
-                        goto bad;
-                    PyErr_Clear();
-                }
-            }
-            level = 0;
-        }
-        #endif
-        if (!module) {
-            #if PY_MAJOR_VERSION < 3
-            PyObject *py_level = PyInt_FromLong(level);
-            if (!py_level)
-                goto bad;
-            module = PyObject_CallFunctionObjArgs(py_import,
-                name, global_dict, empty_dict, list, py_level, (PyObject *)NULL);
-            Py_DECREF(py_level);
-            #else
-            module = PyImport_ImportModuleLevelObject(
-                name, global_dict, empty_dict, list, level);
-            #endif
-        }
-    }
-bad:
-    #if PY_MAJOR_VERSION < 3
-    Py_XDECREF(py_import);
-    #endif
-    Py_XDECREF(empty_list);
-    Py_XDECREF(empty_dict);
-    return module;
-}
-
-/* FastTypeChecks */
-    #if CYTHON_COMPILING_IN_CPYTHON
-static int __Pyx_InBases(PyTypeObject *a, PyTypeObject *b) {
-    while (a) {
-        a = a->tp_base;
-        if (a == b)
-            return 1;
-    }
-    return b == &PyBaseObject_Type;
-}
-static CYTHON_INLINE int __Pyx_IsSubtype(PyTypeObject *a, PyTypeObject *b) {
-    PyObject *mro;
-    if (a == b) return 1;
-    mro = a->tp_mro;
-    if (likely(mro)) {
-        Py_ssize_t i, n;
-        n = PyTuple_GET_SIZE(mro);
-        for (i = 0; i < n; i++) {
-            if (PyTuple_GET_ITEM(mro, i) == (PyObject *)b)
-                return 1;
-        }
-        return 0;
-    }
-    return __Pyx_InBases(a, b);
-}
-#if PY_MAJOR_VERSION == 2
-static int __Pyx_inner_PyErr_GivenExceptionMatches2(PyObject *err, PyObject* exc_type1, PyObject* exc_type2) {
-    PyObject *exception, *value, *tb;
-    int res;
-    __Pyx_PyThreadState_declare
-    __Pyx_PyThreadState_assign
-    __Pyx_ErrFetch(&exception, &value, &tb);
-    res = exc_type1 ? PyObject_IsSubclass(err, exc_type1) : 0;
-    if (unlikely(res == -1)) {
-        PyErr_WriteUnraisable(err);
-        res = 0;
-    }
-    if (!res) {
-        res = PyObject_IsSubclass(err, exc_type2);
-        if (unlikely(res == -1)) {
-            PyErr_WriteUnraisable(err);
-            res = 0;
-        }
-    }
-    __Pyx_ErrRestore(exception, value, tb);
-    return res;
-}
-#else
-static CYTHON_INLINE int __Pyx_inner_PyErr_GivenExceptionMatches2(PyObject *err, PyObject* exc_type1, PyObject *exc_type2) {
-    int res = exc_type1 ? __Pyx_IsSubtype((PyTypeObject*)err, (PyTypeObject*)exc_type1) : 0;
-    if (!res) {
-        res = __Pyx_IsSubtype((PyTypeObject*)err, (PyTypeObject*)exc_type2);
-    }
-    return res;
-}
-#endif
-static int __Pyx_PyErr_GivenExceptionMatchesTuple(PyObject *exc_type, PyObject *tuple) {
-    Py_ssize_t i, n;
-    assert(PyExceptionClass_Check(exc_type));
-    n = PyTuple_GET_SIZE(tuple);
-#if PY_MAJOR_VERSION >= 3
-    for (i=0; i<n; i++) {
-        if (exc_type == PyTuple_GET_ITEM(tuple, i)) return 1;
-    }
-#endif
-    for (i=0; i<n; i++) {
-        PyObject *t = PyTuple_GET_ITEM(tuple, i);
-        #if PY_MAJOR_VERSION < 3
-        if (likely(exc_type == t)) return 1;
-        #endif
-        if (likely(PyExceptionClass_Check(t))) {
-            if (__Pyx_inner_PyErr_GivenExceptionMatches2(exc_type, NULL, t)) return 1;
-        } else {
-        }
-    }
-    return 0;
-}
-static CYTHON_INLINE int __Pyx_PyErr_GivenExceptionMatches(PyObject *err, PyObject* exc_type) {
-    if (likely(err == exc_type)) return 1;
-    if (likely(PyExceptionClass_Check(err))) {
-        if (likely(PyExceptionClass_Check(exc_type))) {
-            return __Pyx_inner_PyErr_GivenExceptionMatches2(err, NULL, exc_type);
-        } else if (likely(PyTuple_Check(exc_type))) {
-            return __Pyx_PyErr_GivenExceptionMatchesTuple(err, exc_type);
-        } else {
-        }
-    }
-    return PyErr_GivenExceptionMatches(err, exc_type);
-}
-static CYTHON_INLINE int __Pyx_PyErr_GivenExceptionMatches2(PyObject *err, PyObject *exc_type1, PyObject *exc_type2) {
-    assert(PyExceptionClass_Check(exc_type1));
-    assert(PyExceptionClass_Check(exc_type2));
-    if (likely(err == exc_type1 || err == exc_type2)) return 1;
-    if (likely(PyExceptionClass_Check(err))) {
-        return __Pyx_inner_PyErr_GivenExceptionMatches2(err, exc_type1, exc_type2);
-    }
-    return (PyErr_GivenExceptionMatches(err, exc_type1) || PyErr_GivenExceptionMatches(err, exc_type2));
-}
-#endif
-
 /* None */
     static CYTHON_INLINE void __Pyx_RaiseUnboundLocalError(const char *varname) {
     PyErr_Format(PyExc_UnboundLocalError, "local variable '%s' referenced before assignment", varname);
 }
 
 /* ImportFrom */
     static PyObject* __Pyx_ImportFrom(PyObject* module, PyObject* name) {
```

### Comparing `statmoments-1.0.4/statmoments/_native_shim.py` & `statmoments-1.0.5/statmoments/_native_shim.py`

 * *Files identical despite different names*

### Comparing `statmoments-1.0.4/statmoments/_statmoments_impl.py` & `statmoments-1.0.5/statmoments/_statmoments_impl.py`

 * *Files 2% similar despite different names*

```diff
@@ -83,15 +83,15 @@
   return traces - np.mean(traces, axis=0)
 
 
 def uni2bivar(data, lm=1, rm=1, normalize=True):
   sd = 1
   if normalize and (lm + rm) >= 3:
     sd = np.std(data, axis=0, ddof=0)
-  res = [triu_flatten(np.outer((tr/sd)**lm, (tr/sd)**rm)) for tr in meanfree(data)]
+  res = [triu_flatten(np.outer((tr / sd) ** lm, (tr / sd) ** rm)) for tr in meanfree(data)]
   return res
 
 
 # ============================= ENGINE INTERFACE ============================= #
 class _BaseImpl(object):
   @classmethod
   def estimate_mem_size(cls, tr_len, cl_len, moment=2):
@@ -192,17 +192,19 @@
 
   @staticmethod
   def _fit_kernel(_1, _2, moment=2, use_central=None):
     use_central = use_central if use_central is not None else False  # moment > 2
     return bivar_cntr if use_central else bivar_sum_detrend
 
   @classmethod
-  def estimate_mem_size(cls, tr_len, cl_len, moment=2, use_central=None):
+  def estimate_mem_size(cls, tr_len, cl_len, moment=2, use_central=None, **kwargs):
     """Return an coarse-grained amount of memory, required by the processing kernel."""
-    impl_type = cls._fit_kernel(tr_len, cl_len, moment, use_central)
+    impl_type = kwargs.pop('kernel', None)
+    if impl_type is None:
+      impl_type = cls._fit_kernel(tr_len, cl_len, moment, use_central)
     return impl_type.estimate_mem_size(tr_len, cl_len, moment)
 
 
 class Univar(_BaseImpl):
   """
   Streaming processing statistical tool to find univariate moments for input data sets.
```

### Comparing `statmoments-1.0.4/statmoments/benchmark/benchlib.py` & `statmoments-1.0.5/statmoments/benchmark/benchlib.py`

 * *Files 12% similar despite different names*

```diff
@@ -22,61 +22,65 @@
   return bin(int(hex_line, 16))[2:].zfill(len(byte_line) * 8)
 
 
 def make_hypotheses(hlen):
   return bytes2classifiers(_urandom((hlen + 7) // 8))[:hlen]
 
 
-class engine_factory(object):
+class EngineFactory(object):
   def __init__(self, make_trace, make_classifiers, factory, **options):
     self._gen_trace = make_trace
     self._gen_classifiers = make_classifiers
     self._factory = factory
     self._options = options
 
+  def name(self):
+    return self._options['kernel'].__name__
+
   def create_data(self, tr_count, tr_len, cl_len):
     blk_sz = 8
     traces = np.empty((tr_count // blk_sz * blk_sz, tr_len))
     traces[:len(traces) // blk_sz, :] = self._gen_trace((len(traces) // blk_sz, tr_len))
-    traces.reshape(blk_sz, -1, tr_len)[:] = traces[:len(traces)//blk_sz]
+    traces.reshape(blk_sz, -1, tr_len)[:] = traces[:len(traces) // blk_sz]
     traces = np.random.permutation(traces)
     classifiers = [self._gen_classifiers(cl_len) for _ in range(len(traces))]
     return traces, classifiers
 
   def create_engine(self, tr_len, cl_len):
     return self._factory(tr_len, cl_len, **self._options)
 
 
 def benchmark(benchset):
   number, repeat = 1, 1
 
 # Name        Implementation                     MB  tr_cnt   tr_len  cl_cnt   tr/sec   time res_time
 # bivar_m1    bivar_vtk(m(1, 1))                 50    5000      500       1      725    6.9      0.0
 # bivar_m1    bivar_vtk(m(1, 1))                124    5000     1000       1      132   37.7      0.0
-  print('{:12}{:30}{:>7}{:>8}{:>9}{:>8}{:>8}{:>7}{:>9}'.format(
-        'Kernel', 'Implementation', 'MB', 'tr_cnt', 'tr_len', 'cl_cnt', 'tr/sec', 'time', 'res_time'))
+  print('{:12}{:30}{:>7}{:>8}{:>9}{:>8}{:>8}{:>9}{:>9}'.format(
+        'Kernel', 'Implementation', 'MB', 'tr_cnt', 'tr_len', 'cl_cnt', 'tr/sec', 'upd_time', 'res_time'))
 
   for name, params in benchset:
-    for fctr, tr_count, tr_len, cl_count in product(*params):
-      tproc, ttest = [], []
+    for engine_factory, tr_count, tr_len, cl_count in product(*params):
+      update_times, ttest_times = [], []
+      assert repeat > 0
       for _ in range(repeat):
         # Garbage collect memory after the prev iteration to free the existing memory
         traces, engine = None, None
-        traces, classifiers = fctr.create_data(tr_count, tr_len, cl_count)
-        engine = fctr.create_engine(tr_len, cl_count)
+        traces, classifiers = engine_factory.create_data(tr_count, tr_len, cl_count)
+        engine = engine_factory.create_engine(tr_len, cl_count)
         for _ in range(number):
           start = timer()
           engine.update(traces, classifiers)  # Streaming: layout and accumulator
-          tproc.append(timer() - start)
+          update_times.append(timer() - start)
 
           start = timer()
-          for _ in ttests(engine):           # On-demand: t-tests
-            _ = None
-          ttest.append(timer() - start)
+          for _ in ttests(engine):  # On-demand: t-tests
+            pass
+          ttest_times.append(timer() - start)
 
-      mproc, mtt = min(tproc), min(ttest)
-      max_mom = ''.join(map(str, [engine.moment]*2))
+      min_update, min_tt = min(update_times), min(ttest_times)
+      max_mom = ''.join(map(str, [engine.moment] * 2))
       kname = '{}(m{})'.format(type(engine._impl).__name__, max_mom)
-      print("{:12}{:30}{:7d}{:8d}{:9d}{:8d}{:>8d}{:>7.1f}{:>9.1f}".format(
+      print("{:12}{:30}{:7d}{:8d}{:9d}{:8d}{:>8d}{:>9.1f}{:>9.1f}".format(
           name, kname, engine.memory_size >> 20, tr_count, tr_len, cl_count,
-          int(tr_count / mproc), mproc, mtt))
+          int(tr_count / min_update), min_update, min_tt))
   print()
```

### Comparing `statmoments-1.0.4/statmoments/bivar.py` & `statmoments-1.0.5/statmoments/bivar.py`

 * *Files identical despite different names*

### Comparing `statmoments-1.0.4/statmoments/stattests.py` & `statmoments-1.0.5/statmoments/stattests.py`

 * *Files 6% similar despite different names*

```diff
@@ -11,15 +11,15 @@
 
 def ttests(engine, moment=None, dim=None, equal_var=False):
   """Return a generator yielding Welch's t-test for each classifier"""
 
   test_dim = dim    if dim    is not None else engine.dim
   test_mom = moment if moment is not None else engine.moment // 2
 
-  if engine.moment // 2 < np.max(test_mom):
+  if engine.moment < 2 or engine.moment // 2 < np.max(test_mom):
     raise ValueError("The engine cannot provide required statistical moments.")
 
   mom_conv = [
       {  # Empty
       },
       {  # Univariate case
           1: (1, 2),
@@ -51,26 +51,27 @@
 
   # Moments are standardized _not_ here, but later
   # _preprocvar to save FLOPS on sqrt
   for i, (cm, stdd) in enumerate(zip(momgen(mlist, False), stddgen)):
     n0, n1 = engine.counts(i)
     if min(n0, n1) < engine.acc_min_count:
       tr_len = engine.trace_len
-      tr_len = [tr_len, tr_len * (tr_len + 1) // 2][test_dim-1]
+      tr_len = [tr_len, tr_len * (tr_len + 1) // 2][test_dim - 1]
       yield np.zeros(tr_len)
       continue
 
     if tmd > 2:
       if False:
         pass
       elif test_dim == 1:
         stdd = stdd ** test_mom
       elif test_dim == 2:
         lm, rm = test_mom
-        stdd = [triu_flatten(np.outer(stdd[0] ** lm, stdd[0] ** rm)), triu_flatten(np.outer(stdd[1] ** lm, stdd[1] ** rm))]
+        stdl, stdr = stdd
+        stdd = [triu_flatten(np.outer(stdl ** lm, stdl ** rm)), triu_flatten(np.outer(stdr ** lm, stdr ** rm))]
 
     # Convert to preprocessed variance and standartize
     _preprocvar(cm[0], tmd, stdd[0])
     _preprocvar(cm[1], tmd, stdd[1])
 
     m10, m20 = cm[0]
     m11, m21 = cm[1]
```

### Comparing `statmoments-1.0.4/statmoments/tests/test_bivar.py` & `statmoments-1.0.5/statmoments/tests/test_bivar.py`

 * *Files 15% similar despite different names*

```diff
@@ -1,522 +1,496 @@
-00000000: 0d0a 696d 706f 7274 2075 6e69 7474 6573  ..import unittes
-00000010: 740d 0a66 726f 6d20 6974 6572 746f 6f6c  t..from itertool
-00000020: 7320 696d 706f 7274 2063 6f6d 6269 6e61  s import combina
-00000030: 7469 6f6e 735f 7769 7468 5f72 6570 6c61  tions_with_repla
-00000040: 6365 6d65 6e74 2061 7320 5f63 6f6d 6275  cement as _combu
-00000050: 0d0a 0d0a 696d 706f 7274 206e 756d 7079  ....import numpy
-00000060: 2061 7320 6e70 0d0a 696d 706f 7274 206e   as np..import n
-00000070: 756d 7079 2e74 6573 7469 6e67 2061 7320  umpy.testing as 
-00000080: 6e74 0d0a 0d0a 6672 6f6d 2073 6369 7079  nt....from scipy
-00000090: 2e73 7461 7473 2069 6d70 6f72 7420 736b  .stats import sk
-000000a0: 6577 2c20 6b75 7274 6f73 6973 0d0a 0d0a  ew, kurtosis....
-000000b0: 696d 706f 7274 2073 7461 746d 6f6d 656e  import statmomen
-000000c0: 7473 0d0a 6672 6f6d 2073 7461 746d 6f6d  ts..from statmom
-000000d0: 656e 7473 2e5f 7374 6174 6d6f 6d65 6e74  ents._statmoment
-000000e0: 735f 696d 706c 2069 6d70 6f72 7420 6d65  s_impl import me
-000000f0: 616e 6672 6565 2c20 7472 6975 5f66 6c61  anfree, triu_fla
-00000100: 7474 656e 2c20 756e 6932 6269 7661 720d  tten, uni2bivar.
-00000110: 0a0d 0a23 206e 702e 7261 6e64 6f6d 2e73  ...# np.random.s
-00000120: 6565 6428 3129 0d0a 0d0a 0d0a 6465 6620  eed(1)......def 
-00000130: 616c 6c5f 656e 6769 6e65 735f 3264 2874  all_engines_2d(t
-00000140: 725f 6c65 6e2c 2063 6c5f 6c65 6e2c 206d  r_len, cl_len, m
-00000150: 6f6d 656e 743d 322c 202a 2a6b 7761 7267  oment=2, **kwarg
-00000160: 7329 3a0d 0a20 2072 6574 7572 6e20 5b0d  s):..  return [.
-00000170: 0a20 2020 2020 2073 7461 746d 6f6d 656e  .      statmomen
-00000180: 7473 2e42 6976 6172 2874 725f 6c65 6e2c  ts.Bivar(tr_len,
-00000190: 2063 6c5f 6c65 6e2c 206b 6572 6e65 6c3d   cl_len, kernel=
-000001a0: 7374 6174 6d6f 6d65 6e74 732e 6269 7661  statmoments.biva
-000001b0: 725f 7375 6d2c 2020 2020 2020 2020 206d  r_sum,         m
-000001c0: 6f6d 656e 743d 6d6f 6d65 6e74 2c20 2a2a  oment=moment, **
-000001d0: 6b77 6172 6773 292c 0d0a 2020 2020 2020  kwargs),..      
-000001e0: 7374 6174 6d6f 6d65 6e74 732e 4269 7661  statmoments.Biva
-000001f0: 7228 7472 5f6c 656e 2c20 636c 5f6c 656e  r(tr_len, cl_len
-00000200: 2c20 6b65 726e 656c 3d73 7461 746d 6f6d  , kernel=statmom
-00000210: 656e 7473 2e62 6976 6172 5f63 6e74 722c  ents.bivar_cntr,
-00000220: 2020 2020 2020 2020 6d6f 6d65 6e74 3d6d          moment=m
-00000230: 6f6d 656e 742c 202a 2a6b 7761 7267 7329  oment, **kwargs)
-00000240: 2c0d 0a20 2020 2020 2073 7461 746d 6f6d  ,..      statmom
-00000250: 656e 7473 2e42 6976 6172 2874 725f 6c65  ents.Bivar(tr_le
-00000260: 6e2c 2063 6c5f 6c65 6e2c 206b 6572 6e65  n, cl_len, kerne
-00000270: 6c3d 7374 6174 6d6f 6d65 6e74 732e 6269  l=statmoments.bi
-00000280: 7661 725f 7478 7462 6b2c 2020 2020 2020  var_txtbk,      
-00000290: 206d 6f6d 656e 743d 6d6f 6d65 6e74 2c20   moment=moment, 
-000002a0: 2a2a 6b77 6172 6773 292c 0d0a 2020 2020  **kwargs),..    
-000002b0: 2020 7374 6174 6d6f 6d65 6e74 732e 4269    statmoments.Bi
-000002c0: 7661 7228 7472 5f6c 656e 2c20 636c 5f6c  var(tr_len, cl_l
-000002d0: 656e 2c20 6b65 726e 656c 3d73 7461 746d  en, kernel=statm
-000002e0: 6f6d 656e 7473 2e62 6976 6172 5f32 7061  oments.bivar_2pa
-000002f0: 7373 2c20 2020 2020 2020 6d6f 6d65 6e74  ss,       moment
-00000300: 3d6d 6f6d 656e 742c 202a 2a6b 7761 7267  =moment, **kwarg
-00000310: 7329 2c0d 0a20 2020 2020 2073 7461 746d  s),..      statm
-00000320: 6f6d 656e 7473 2e42 6976 6172 2874 725f  oments.Bivar(tr_
-00000330: 6c65 6e2c 2063 6c5f 6c65 6e2c 206b 6572  len, cl_len, ker
-00000340: 6e65 6c3d 7374 6174 6d6f 6d65 6e74 732e  nel=statmoments.
-00000350: 6269 7661 725f 7375 6d5f 6465 7472 656e  bivar_sum_detren
-00000360: 642c 206d 6f6d 656e 743d 6d6f 6d65 6e74  d, moment=moment
-00000370: 2c20 2a2a 6b77 6172 6773 292c 0d0a 2020  , **kwargs),..  
-00000380: 5d0d 0a0d 0a0d 0a64 6566 206b 7572 746f  ]......def kurto
-00000390: 7369 735f 7065 6172 736f 6e28 782c 202a  sis_pearson(x, *
-000003a0: 2a61 7267 7329 3a0d 0a20 2072 6574 7572  *args):..  retur
-000003b0: 6e20 6b75 7274 6f73 6973 2878 2c20 6669  n kurtosis(x, fi
-000003c0: 7368 6572 3d46 616c 7365 2c20 2a2a 6172  sher=False, **ar
-000003d0: 6773 290d 0a0d 0a0d 0a64 6566 2063 616c  gs)......def cal
-000003e0: 635f 6d6f 6d28 7472 6163 6573 2c20 6d2c  c_mom(traces, m,
-000003f0: 206e 6f72 6d61 6c69 7a65 6429 3a0d 0a20   normalized):.. 
-00000400: 2023 2073 6b65 776e 6573 7320 616e 6420   # skewness and 
-00000410: 6b75 7274 6f73 6973 2068 6572 6520 6172  kurtosis here ar
-00000420: 6520 7369 676d 612d 6e6f 726d 616c 697a  e sigma-normaliz
-00000430: 6564 0d0a 2020 6966 206d 203c 2035 3a0d  ed..  if m < 5:.
-00000440: 0a20 2020 206d 6f6d 5f6c 6973 7420 3d20  .    mom_list = 
-00000450: 5b4e 6f6e 652c 206e 702e 6d65 616e 2c20  [None, np.mean, 
-00000460: 6e70 2e76 6172 2c20 736b 6577 2c20 6b75  np.var, skew, ku
-00000470: 7274 6f73 6973 5f70 6561 7273 6f6e 5d0d  rtosis_pearson].
-00000480: 0a20 2020 206d 6f6d 5f72 6573 203d 206d  .    mom_res = m
-00000490: 6f6d 5f6c 6973 745b 6d5d 2874 7261 6365  om_list[m](trace
-000004a0: 732c 2061 7869 733d 3029 0d0a 2020 656c  s, axis=0)..  el
-000004b0: 7365 3a0d 0a20 2020 2023 204a 7573 7420  se:..    # Just 
-000004c0: 696e 2063 6173 650d 0a20 2020 206d 6f6d  in case..    mom
-000004d0: 5f72 6573 203d 206e 702e 7375 6d28 7472  _res = np.sum(tr
-000004e0: 6163 6573 2c20 6178 6973 3d30 2920 2f20  aces, axis=0) / 
-000004f0: 6c65 6e28 7472 6163 6573 290d 0a20 2020  len(traces)..   
-00000500: 206d 6f6d 5f72 6573 203d 206e 702e 7375   mom_res = np.su
-00000510: 6d28 2874 7261 6365 7320 2d20 6d6f 6d5f  m((traces - mom_
-00000520: 7265 7329 202a 2a20 6d2c 2061 7869 733d  res) ** m, axis=
-00000530: 3029 202f 206c 656e 2874 7261 6365 7329  0) / len(traces)
-00000540: 0d0a 2020 2020 6d6f 6d5f 7265 7320 2f3d  ..    mom_res /=
-00000550: 206e 702e 7374 6428 7472 6163 6573 2c20   np.std(traces, 
-00000560: 6178 6973 3d30 2920 2a2a 206d 0d0a 0d0a  axis=0) ** m....
-00000570: 2020 6966 206d 203e 3d20 3320 616e 6420    if m >= 3 and 
-00000580: 6e6f 7420 6e6f 726d 616c 697a 6564 3a0d  not normalized:.
-00000590: 0a20 2020 206d 6f6d 5f72 6573 202a 3d20  .    mom_res *= 
-000005a0: 6e70 2e73 7464 2874 7261 6365 732c 2061  np.std(traces, a
-000005b0: 7869 733d 3029 202a 2a20 6d0d 0a0d 0a20  xis=0) ** m.... 
-000005c0: 2072 6574 7572 6e20 6d6f 6d5f 7265 730d   return mom_res.
-000005d0: 0a0d 0a0d 0a64 6566 2063 616c 635f 636f  .....def calc_co
-000005e0: 6d6f 6d28 7472 6163 6573 2c20 6d6d 2c20  mom(traces, mm, 
-000005f0: 6e6f 726d 616c 697a 6564 293a 0d0a 2020  normalized):..  
-00000600: 6c6d 2c20 726d 203d 206d 6d0d 0a20 2069  lm, rm = mm..  i
-00000610: 6620 6c6d 203d 3d20 3120 616e 6420 726d  f lm == 1 and rm
-00000620: 203d 3d20 313a 0d0a 2020 2020 6563 6d32   == 1:..    ecm2
-00000630: 203d 206e 702e 636f 7628 7472 6163 6573   = np.cov(traces
-00000640: 2e54 2c20 6269 6173 3d54 7275 652c 2064  .T, bias=True, d
-00000650: 646f 663d 3029 0d0a 2020 2020 6563 6d32  dof=0)..    ecm2
-00000660: 203d 2074 7269 755f 666c 6174 7465 6e28   = triu_flatten(
-00000670: 6563 6d32 290d 0a20 2065 6c73 653a 0d0a  ecm2)..  else:..
-00000680: 2020 2020 656d 6620 3d20 6d65 616e 6672      emf = meanfr
-00000690: 6565 2874 7261 6365 7329 0d0a 2020 2020  ee(traces)..    
-000006a0: 6563 6d32 203d 206e 702e 646f 7428 656d  ecm2 = np.dot(em
-000006b0: 662e 542a 2a6c 6d2c 2065 6d66 2a2a 726d  f.T**lm, emf**rm
-000006c0: 2920 2f20 6c65 6e28 656d 6629 0d0a 2020  ) / len(emf)..  
-000006d0: 2020 6563 6d32 203d 2074 7269 755f 666c    ecm2 = triu_fl
-000006e0: 6174 7465 6e28 6563 6d32 290d 0a20 2020  atten(ecm2)..   
-000006f0: 2065 636d 7420 3d20 756e 6932 6269 7661   ecmt = uni2biva
-00000700: 7228 7472 6163 6573 2c20 2a6d 6d2c 2046  r(traces, *mm, F
-00000710: 616c 7365 290d 0a20 2020 2065 636d 7420  alse)..    ecmt 
-00000720: 3d20 6e70 2e6d 6561 6e28 6563 6d74 2c20  = np.mean(ecmt, 
-00000730: 6178 6973 3d30 290d 0a20 2020 206e 742e  axis=0)..    nt.
-00000740: 6173 7365 7274 5f61 6c6c 636c 6f73 6528  assert_allclose(
-00000750: 6563 6d32 2c20 6563 6d74 2c20 6174 6f6c  ecm2, ecmt, atol
-00000760: 3d31 652d 3038 2c20 6572 725f 6d73 673d  =1e-08, err_msg=
-00000770: 2765 7272 6f72 2069 6e20 636f 6d6f 6d65  'error in comome
-00000780: 6e74 206f 7264 6572 207b 7d27 2e66 6f72  nt order {}'.for
-00000790: 6d61 7428 6d6d 2929 0d0a 2020 2020 6966  mat(mm))..    if
-000007a0: 206e 6f72 6d61 6c69 7a65 643a 0d0a 2020   normalized:..  
-000007b0: 2020 2020 7364 203d 206e 702e 7374 6428      sd = np.std(
-000007c0: 7472 6163 6573 2c20 6178 6973 3d30 290d  traces, axis=0).
-000007d0: 0a20 2020 2020 2065 636d 3220 2f3d 2074  .      ecm2 /= t
-000007e0: 7269 755f 666c 6174 7465 6e28 6e70 2e6f  riu_flatten(np.o
-000007f0: 7574 6572 2873 6420 2a2a 206c 6d2c 2073  uter(sd ** lm, s
-00000800: 6420 2a2a 2072 6d29 290d 0a20 2072 6574  d ** rm))..  ret
-00000810: 7572 6e20 6563 6d32 0d0a 0d0a 0d0a 6465  urn ecm2......de
-00000820: 6620 5f65 6e73 7572 655f 636f 6d6f 6d28  f _ensure_comom(
-00000830: 656e 6769 6e65 732c 2074 7261 6365 7330  engines, traces0
-00000840: 2c20 7472 6163 6573 312c 206e 6f72 6d61  , traces1, norma
-00000850: 6c69 7a65 643d 5472 7565 293a 0d0a 2020  lized=True):..  
-00000860: 6e30 2c20 6e31 203d 206c 656e 2874 7261  n0, n1 = len(tra
-00000870: 6365 7330 292c 206c 656e 2874 7261 6365  ces0), len(trace
-00000880: 7331 290d 0a0d 0a20 2066 6f72 2065 6e67  s1)....  for eng
-00000890: 2069 6e20 656e 6769 6e65 733a 0d0a 2020   in engines:..  
-000008a0: 2020 2320 5465 7374 2063 6f75 6e74 730d    # Test counts.
-000008b0: 0a20 2020 206e 742e 6173 7365 7274 5f65  .    nt.assert_e
-000008c0: 7175 616c 286c 6973 7428 656e 672e 636f  qual(list(eng.co
-000008d0: 756e 7473 2830 2929 2c20 5b6e 302c 206e  unts(0)), [n0, n
-000008e0: 315d 290d 0a0d 0a20 2020 2023 2054 6573  1])....    # Tes
-000008f0: 7420 3244 0d0a 2020 2020 6d61 785f 6d6f  t 2D..    max_mo
-00000900: 6d65 6e74 203d 2065 6e67 2e6d 6f6d 656e  ment = eng.momen
-00000910: 740d 0a0d 0a20 2020 2023 2047 6574 206c  t....    # Get l
-00000920: 6973 7420 6f66 2061 6c6c 2070 6f73 7369  ist of all possi
-00000930: 626c 6520 636f 6d6f 6d65 6e74 730d 0a20  ble comoments.. 
-00000940: 2020 206c 6d6d 203d 206c 6973 7428 5f63     lmm = list(_c
-00000950: 6f6d 6275 2872 616e 6765 2831 2c20 6d61  ombu(range(1, ma
-00000960: 785f 6d6f 6d65 6e74 202b 2031 292c 2072  x_moment + 1), r
-00000970: 3d32 2929 0d0a 0d0a 2020 2020 2320 4765  =2))....    # Ge
-00000980: 7420 6174 206f 6e63 650d 0a20 2020 2065  t at once..    e
-00000990: 636d 203d 205b 2863 616c 635f 636f 6d6f  cm = [(calc_como
-000009a0: 6d28 7472 6163 6573 302c 206d 6d2c 206e  m(traces0, mm, n
-000009b0: 6f72 6d61 6c69 7a65 6429 2c20 6361 6c63  ormalized), calc
-000009c0: 5f63 6f6d 6f6d 2874 7261 6365 7331 2c20  _comom(traces1, 
-000009d0: 6d6d 2c20 6e6f 726d 616c 697a 6564 2929  mm, normalized))
-000009e0: 2066 6f72 206d 6d20 696e 206c 6d6d 5d0d   for mm in lmm].
-000009f0: 0a20 2020 2065 636d 203d 206c 6973 7428  .    ecm = list(
-00000a00: 7a69 7028 2a65 636d 2929 0d0a 2020 2020  zip(*ecm))..    
-00000a10: 6163 6d20 3d20 6e65 7874 2865 6e67 2e63  acm = next(eng.c
-00000a20: 6f6d 6f6d 656e 7473 286d 6f6d 656e 7473  omoments(moments
-00000a30: 3d6c 6d6d 2929 0d0a 2020 2020 6e74 2e61  =lmm))..    nt.a
-00000a40: 7373 6572 745f 616c 6c63 6c6f 7365 2861  ssert_allclose(a
-00000a50: 636d 2c20 2065 636d 2c20 6174 6f6c 3d31  cm,  ecm, atol=1
-00000a60: 652d 3038 2c20 6572 725f 6d73 673d 2765  e-08, err_msg='e
-00000a70: 7272 6f72 2069 6e20 636f 6d6f 6d65 6e74  rror in comoment
-00000a80: 2061 7272 6179 2729 0d0a 0d0a 2020 2020   array')....    
-00000a90: 2320 4f6e 6520 6279 206f 6e65 0d0a 2020  # One by one..  
-00000aa0: 2020 666f 7220 6d6d 2069 6e20 6c6d 6d3a    for mm in lmm:
-00000ab0: 0d0a 2020 2020 2020 6563 6d20 3d20 5b63  ..      ecm = [c
-00000ac0: 616c 635f 636f 6d6f 6d28 7472 6163 6573  alc_comom(traces
-00000ad0: 302c 206d 6d2c 206e 6f72 6d61 6c69 7a65  0, mm, normalize
-00000ae0: 6429 2c20 6361 6c63 5f63 6f6d 6f6d 2874  d), calc_comom(t
-00000af0: 7261 6365 7331 2c20 6d6d 2c20 6e6f 726d  races1, mm, norm
-00000b00: 616c 697a 6564 295d 0d0a 2020 2020 2020  alized)]..      
-00000b10: 6163 6d20 3d20 5b63 6d5b 3a2c 2030 5d2e  acm = [cm[:, 0].
-00000b20: 636f 7079 2829 2066 6f72 2063 6d20 696e  copy() for cm in
-00000b30: 2065 6e67 2e63 6f6d 6f6d 656e 7473 286d   eng.comoments(m
-00000b40: 6f6d 656e 7473 3d6d 6d29 5d5b 305d 2020  oments=mm)][0]  
-00000b50: 2320 4f6e 6c79 206f 6e65 2063 6c61 7373  # Only one class
-00000b60: 6966 6965 720d 0a20 2020 2020 206e 742e  ifier..      nt.
-00000b70: 6173 7365 7274 5f61 6c6c 636c 6f73 6528  assert_allclose(
-00000b80: 6163 6d2c 2020 6563 6d2c 2061 746f 6c3d  acm,  ecm, atol=
-00000b90: 3165 2d30 382c 2065 7272 5f6d 7367 3d27  1e-08, err_msg='
-00000ba0: 6572 726f 7220 696e 2063 6f6d 6f6d 656e  error in comomen
-00000bb0: 7420 6f72 6465 7220 7b7d 272e 666f 726d  t order {}'.form
-00000bc0: 6174 286d 6d29 290d 0a0d 0a0d 0a64 6566  at(mm))......def
-00000bd0: 205f 656e 7375 7265 5f6d 6f6d 2865 6e67   _ensure_mom(eng
-00000be0: 696e 6573 2c20 7472 6163 6573 302c 2074  ines, traces0, t
-00000bf0: 7261 6365 7331 2c20 6e6f 726d 616c 697a  races1, normaliz
-00000c00: 6564 3d54 7275 6529 3a0d 0a20 206e 302c  ed=True):..  n0,
-00000c10: 206e 3120 3d20 6c65 6e28 7472 6163 6573   n1 = len(traces
-00000c20: 3029 2c20 6c65 6e28 7472 6163 6573 3129  0), len(traces1)
-00000c30: 0d0a 0d0a 2020 666f 7220 656e 6720 696e  ....  for eng in
-00000c40: 2065 6e67 696e 6573 3a0d 0a20 2020 2023   engines:..    #
-00000c50: 2054 6573 7420 636f 756e 7473 0d0a 2020   Test counts..  
-00000c60: 2020 6e74 2e61 7373 6572 745f 6571 7561    nt.assert_equa
-00000c70: 6c28 6c69 7374 2865 6e67 2e63 6f75 6e74  l(list(eng.count
-00000c80: 7328 3029 292c 205b 6e30 2c20 6e31 5d29  s(0)), [n0, n1])
-00000c90: 0d0a 0d0a 2020 2020 2320 5465 7374 2031  ....    # Test 1
-00000ca0: 440d 0a20 2020 206d 6178 5f6d 6f6d 656e  D..    max_momen
-00000cb0: 7420 3d20 656e 672e 6d6f 6d65 6e74 202a  t = eng.moment *
-00000cc0: 2065 6e67 2e64 696d 0d0a 0d0a 2020 2020   eng.dim....    
-00000cd0: 2320 5261 7720 6d6f 6d65 6e74 0d0a 2020  # Raw moment..  
-00000ce0: 2020 6d20 3d20 310d 0a20 2020 2065 6d6f    m = 1..    emo
-00000cf0: 6d20 3d20 5b63 616c 635f 6d6f 6d28 7472  m = [calc_mom(tr
-00000d00: 6163 6573 302c 206d 2c20 6e6f 726d 616c  aces0, m, normal
-00000d10: 697a 6564 292c 2063 616c 635f 6d6f 6d28  ized), calc_mom(
-00000d20: 7472 6163 6573 312c 206d 2c20 6e6f 726d  traces1, m, norm
-00000d30: 616c 697a 6564 295d 0d0a 2020 2020 616d  alized)]..    am
-00000d40: 6f6d 203d 205b 5f6d 5b3a 2c20 305d 2e63  om = [_m[:, 0].c
-00000d50: 6f70 7928 2920 666f 7220 5f6d 2069 6e20  opy() for _m in 
-00000d60: 656e 672e 6d6f 6d65 6e74 7328 6d6f 6d65  eng.moments(mome
-00000d70: 6e74 733d 6d29 5d5b 305d 2020 2320 4f6e  nts=m)][0]  # On
-00000d80: 6c79 206f 6e65 2063 6c61 7373 6966 6965  ly one classifie
-00000d90: 720d 0a20 2020 206e 742e 6173 7365 7274  r..    nt.assert
-00000da0: 5f61 6c6c 636c 6f73 6528 656d 6f6d 2c20  _allclose(emom, 
-00000db0: 616d 6f6d 2c20 6174 6f6c 3d31 652d 3037  amom, atol=1e-07
-00000dc0: 2c20 6572 725f 6d73 673d 2765 7272 6f72  , err_msg='error
-00000dd0: 2069 6e20 656e 6769 6e65 207b 7d20 6d6f   in engine {} mo
-00000de0: 6d65 6e74 206f 7264 6572 207b 7d27 2e66  ment order {}'.f
-00000df0: 6f72 6d61 7428 656e 672e 5f69 6d70 6c2c  ormat(eng._impl,
-00000e00: 206d 2929 0d0a 0d0a 2020 2020 6966 206d   m))....    if m
-00000e10: 6178 5f6d 6f6d 656e 7420 3c20 333a 0d0a  ax_moment < 3:..
-00000e20: 2020 2020 2020 7265 7475 726e 0d0a 0d0a        return....
-00000e30: 2020 2020 2320 4365 6e74 7261 6c20 6d6f      # Central mo
-00000e40: 6d65 6e74 0d0a 2020 2020 6d20 3d20 320d  ment..    m = 2.
+00000000: 696d 706f 7274 2070 7974 6573 740d 0a0d  import pytest...
+00000010: 0a66 726f 6d20 6974 6572 746f 6f6c 7320  .from itertools 
+00000020: 696d 706f 7274 2063 6f6d 6269 6e61 7469  import combinati
+00000030: 6f6e 735f 7769 7468 5f72 6570 6c61 6365  ons_with_replace
+00000040: 6d65 6e74 2061 7320 5f63 6f6d 6275 0d0a  ment as _combu..
+00000050: 0d0a 696d 706f 7274 206e 756d 7079 2061  ..import numpy a
+00000060: 7320 6e70 0d0a 696d 706f 7274 206e 756d  s np..import num
+00000070: 7079 2e74 6573 7469 6e67 2061 7320 6e74  py.testing as nt
+00000080: 0d0a 0d0a 6672 6f6d 2073 6369 7079 2e73  ....from scipy.s
+00000090: 7461 7473 2069 6d70 6f72 7420 736b 6577  tats import skew
+000000a0: 2c20 6b75 7274 6f73 6973 2c20 6d6f 6d65  , kurtosis, mome
+000000b0: 6e74 0d0a 0d0a 696d 706f 7274 2073 7461  nt....import sta
+000000c0: 746d 6f6d 656e 7473 0d0a 6672 6f6d 2073  tmoments..from s
+000000d0: 7461 746d 6f6d 656e 7473 2e5f 7374 6174  tatmoments._stat
+000000e0: 6d6f 6d65 6e74 735f 696d 706c 2069 6d70  moments_impl imp
+000000f0: 6f72 7420 6d65 616e 6672 6565 2c20 7472  ort meanfree, tr
+00000100: 6975 5f66 6c61 7474 656e 2c20 756e 6932  iu_flatten, uni2
+00000110: 6269 7661 720d 0a0d 0a23 206e 702e 7261  bivar....# np.ra
+00000120: 6e64 6f6d 2e73 6565 6428 3129 0d0a 0d0a  ndom.seed(1)....
+00000130: 0d0a 6465 6620 6361 6c63 5f6d 6f6d 2864  ..def calc_mom(d
+00000140: 6174 612c 206b 2c20 6e6f 726d 616c 697a  ata, k, normaliz
+00000150: 653d 4661 6c73 6529 3a0d 0a20 2022 2222  e=False):..  """
+00000160: 2043 656e 7472 616c 206d 6f6d 656e 7473   Central moments
+00000170: 2c20 6e75 6d70 7920 616e 6420 7363 6970  , numpy and scip
+00000180: 7920 2222 220d 0a20 2023 2046 6972 7374  y """..  # First
+00000190: 2035 206d 6f6d 656e 7473 2c20 7769 7468   5 moments, with
+000001a0: 2073 6967 6d61 2d6e 6f72 6d61 6c69 7a65   sigma-normalize
+000001b0: 6420 736b 6577 6e65 7373 2c20 6b75 7274  d skewness, kurt
+000001c0: 6f73 6973 2061 6e64 2035 7468 0d0a 2020  osis and 5th..  
+000001d0: 6b75 7274 6f73 6973 5f70 6561 7273 6f6e  kurtosis_pearson
+000001e0: 203d 206c 616d 6264 6120 782c 202a 2a61   = lambda x, **a
+000001f0: 3a20 6b75 7274 6f73 6973 2878 2c20 6669  : kurtosis(x, fi
+00000200: 7368 6572 3d46 616c 7365 2c20 2a2a 6129  sher=False, **a)
+00000210: 2020 2320 6e6f 7161 3a20 4537 3331 0d0a    # noqa: E731..
+00000220: 2020 7374 6174 5f6d 6f6d 656e 7420 3d20    stat_moment = 
+00000230: 6c61 6d62 6461 2078 2c20 2a2a 613a 206d  lambda x, **a: m
+00000240: 6f6d 656e 7428 782c 206d 6f6d 656e 743d  oment(x, moment=
+00000250: 6b2c 202a 2a61 2920 2f20 6e70 2e73 7464  k, **a) / np.std
+00000260: 2864 6174 612c 202a 2a61 292a 2a6b 2020  (data, **a)**k  
+00000270: 2320 6e6f 7161 3a20 4537 3331 0d0a 2020  # noqa: E731..  
+00000280: 6d6f 6d5f 6675 6e63 7320 3d20 5b6e 702e  mom_funcs = [np.
+00000290: 7375 6d2c 206e 702e 6d65 616e 2c20 6e70  sum, np.mean, np
+000002a0: 2e76 6172 2c20 736b 6577 2c20 6b75 7274  .var, skew, kurt
+000002b0: 6f73 6973 5f70 6561 7273 6f6e 5d0d 0a20  osis_pearson].. 
+000002c0: 206d 6f6d 5f66 756e 6373 202b 3d20 5b73   mom_funcs += [s
+000002d0: 7461 745f 6d6f 6d65 6e74 5d20 2a20 340d  tat_moment] * 4.
+000002e0: 0a0d 0a20 206d 6f6d 5f72 6573 203d 206d  ...  mom_res = m
+000002f0: 6f6d 5f66 756e 6373 5b6b 5d28 6461 7461  om_funcs[k](data
+00000300: 2c20 6178 6973 3d30 290d 0a0d 0a20 2072  , axis=0)....  r
+00000310: 6574 7572 6e20 6d6f 6d5f 7265 7320 6966  eturn mom_res if
+00000320: 206b 203c 2033 206f 7220 6e6f 726d 616c   k < 3 or normal
+00000330: 697a 6520 656c 7365 206d 6f6d 5f72 6573  ize else mom_res
+00000340: 202a 206e 702e 7374 6428 6461 7461 2c20   * np.std(data, 
+00000350: 6178 6973 3d30 2920 2a2a 206b 0d0a 0d0a  axis=0) ** k....
+00000360: 0d0a 6465 6620 6361 6c63 5f63 6f6d 6f6d  ..def calc_comom
+00000370: 2874 7261 6365 732c 206d 6d2c 206e 6f72  (traces, mm, nor
+00000380: 6d61 6c69 7a65 6429 3a0d 0a20 206c 6d2c  malized):..  lm,
+00000390: 2072 6d20 3d20 6d6d 0d0a 2020 6966 206c   rm = mm..  if l
+000003a0: 6d20 3d3d 2031 2061 6e64 2072 6d20 3d3d  m == 1 and rm ==
+000003b0: 2031 3a0d 0a20 2020 2065 636d 3220 3d20   1:..    ecm2 = 
+000003c0: 6e70 2e63 6f76 2874 7261 6365 732e 542c  np.cov(traces.T,
+000003d0: 2062 6961 733d 5472 7565 2c20 6464 6f66   bias=True, ddof
+000003e0: 3d30 290d 0a20 2020 2065 636d 3220 3d20  =0)..    ecm2 = 
+000003f0: 7472 6975 5f66 6c61 7474 656e 2865 636d  triu_flatten(ecm
+00000400: 3229 0d0a 2020 656c 7365 3a0d 0a20 2020  2)..  else:..   
+00000410: 2065 6d66 203d 206d 6561 6e66 7265 6528   emf = meanfree(
+00000420: 7472 6163 6573 290d 0a20 2020 2065 636d  traces)..    ecm
+00000430: 3220 3d20 6e70 2e64 6f74 2865 6d66 2e54  2 = np.dot(emf.T
+00000440: 202a 2a20 6c6d 2c20 656d 6620 2a2a 2072   ** lm, emf ** r
+00000450: 6d29 202f 206c 656e 2865 6d66 290d 0a20  m) / len(emf).. 
+00000460: 2020 2065 636d 3220 3d20 7472 6975 5f66     ecm2 = triu_f
+00000470: 6c61 7474 656e 2865 636d 3229 0d0a 2020  latten(ecm2)..  
+00000480: 2020 6563 6d74 203d 2075 6e69 3262 6976    ecmt = uni2biv
+00000490: 6172 2874 7261 6365 732c 202a 6d6d 2c20  ar(traces, *mm, 
+000004a0: 4661 6c73 6529 0d0a 2020 2020 6563 6d74  False)..    ecmt
+000004b0: 203d 206e 702e 6d65 616e 2865 636d 742c   = np.mean(ecmt,
+000004c0: 2061 7869 733d 3029 0d0a 2020 2020 6e74   axis=0)..    nt
+000004d0: 2e61 7373 6572 745f 616c 6c63 6c6f 7365  .assert_allclose
+000004e0: 2865 636d 322c 2065 636d 742c 2061 746f  (ecm2, ecmt, ato
+000004f0: 6c3d 3165 2d30 382c 2065 7272 5f6d 7367  l=1e-08, err_msg
+00000500: 3d66 2765 7272 6f72 2069 6e20 636f 6d6f  =f'error in como
+00000510: 6d65 6e74 206f 7264 6572 207b 6d6d 7d27  ment order {mm}'
+00000520: 290d 0a20 2020 2069 6620 6e6f 726d 616c  )..    if normal
+00000530: 697a 6564 3a0d 0a20 2020 2020 2073 6420  ized:..      sd 
+00000540: 3d20 6e70 2e73 7464 2874 7261 6365 732c  = np.std(traces,
+00000550: 2061 7869 733d 3029 0d0a 2020 2020 2020   axis=0)..      
+00000560: 6563 6d32 202f 3d20 7472 6975 5f66 6c61  ecm2 /= triu_fla
+00000570: 7474 656e 286e 702e 6f75 7465 7228 7364  tten(np.outer(sd
+00000580: 202a 2a20 6c6d 2c20 7364 202a 2a20 726d   ** lm, sd ** rm
+00000590: 2929 0d0a 2020 7265 7475 726e 2065 636d  ))..  return ecm
+000005a0: 320d 0a0d 0a0d 0a64 6566 205f 656e 7375  2......def _ensu
+000005b0: 7265 5f63 6f6d 6f6d 2865 6e67 2c20 7472  re_comom(eng, tr
+000005c0: 6163 6573 302c 2074 7261 6365 7331 2c20  aces0, traces1, 
+000005d0: 6e6f 726d 616c 697a 6564 3d54 7275 6529  normalized=True)
+000005e0: 3a0d 0a20 206e 302c 206e 3120 3d20 6c65  :..  n0, n1 = le
+000005f0: 6e28 7472 6163 6573 3029 2c20 6c65 6e28  n(traces0), len(
+00000600: 7472 6163 6573 3129 0d0a 0d0a 2020 2320  traces1)....  # 
+00000610: 5465 7374 2063 6f75 6e74 730d 0a20 206e  Test counts..  n
+00000620: 742e 6173 7365 7274 5f65 7175 616c 286c  t.assert_equal(l
+00000630: 6973 7428 656e 672e 636f 756e 7473 2830  ist(eng.counts(0
+00000640: 2929 2c20 5b6e 302c 206e 315d 290d 0a0d  )), [n0, n1])...
+00000650: 0a20 2023 2054 6573 7420 3244 0d0a 2020  .  # Test 2D..  
+00000660: 6d61 785f 6d6f 6d65 6e74 203d 2065 6e67  max_moment = eng
+00000670: 2e6d 6f6d 656e 740d 0a0d 0a20 2023 2047  .moment....  # G
+00000680: 6574 206c 6973 7420 6f66 2061 6c6c 2070  et list of all p
+00000690: 6f73 7369 626c 6520 636f 6d6f 6d65 6e74  ossible comoment
+000006a0: 730d 0a20 206c 6d6d 203d 206c 6973 7428  s..  lmm = list(
+000006b0: 5f63 6f6d 6275 2872 616e 6765 2831 2c20  _combu(range(1, 
+000006c0: 6d61 785f 6d6f 6d65 6e74 202b 2031 292c  max_moment + 1),
+000006d0: 2072 3d32 2929 0d0a 0d0a 2020 2320 4765   r=2))....  # Ge
+000006e0: 7420 6174 206f 6e63 650d 0a20 2065 636d  t at once..  ecm
+000006f0: 203d 205b 2863 616c 635f 636f 6d6f 6d28   = [(calc_comom(
+00000700: 7472 6163 6573 302c 206d 6d2c 206e 6f72  traces0, mm, nor
+00000710: 6d61 6c69 7a65 6429 2c20 6361 6c63 5f63  malized), calc_c
+00000720: 6f6d 6f6d 2874 7261 6365 7331 2c20 6d6d  omom(traces1, mm
+00000730: 2c20 6e6f 726d 616c 697a 6564 2929 2066  , normalized)) f
+00000740: 6f72 206d 6d20 696e 206c 6d6d 5d0d 0a20  or mm in lmm].. 
+00000750: 2065 636d 203d 206c 6973 7428 7a69 7028   ecm = list(zip(
+00000760: 2a65 636d 2929 0d0a 2020 6163 6d20 3d20  *ecm))..  acm = 
+00000770: 6e65 7874 2865 6e67 2e63 6f6d 6f6d 656e  next(eng.comomen
+00000780: 7473 286d 6f6d 656e 7473 3d6c 6d6d 2929  ts(moments=lmm))
+00000790: 0d0a 2020 6e74 2e61 7373 6572 745f 616c  ..  nt.assert_al
+000007a0: 6c63 6c6f 7365 2861 636d 2c20 6563 6d2c  lclose(acm, ecm,
+000007b0: 2061 746f 6c3d 3165 2d30 382c 2065 7272   atol=1e-08, err
+000007c0: 5f6d 7367 3d27 6572 726f 7220 696e 2063  _msg='error in c
+000007d0: 6f6d 6f6d 656e 7420 6172 7261 7927 290d  omoment array').
+000007e0: 0a0d 0a20 2023 204f 6e65 2062 7920 6f6e  ...  # One by on
+000007f0: 650d 0a20 2066 6f72 206d 6d20 696e 206c  e..  for mm in l
+00000800: 6d6d 3a0d 0a20 2020 2065 636d 203d 205b  mm:..    ecm = [
+00000810: 6361 6c63 5f63 6f6d 6f6d 2874 7261 6365  calc_comom(trace
+00000820: 7330 2c20 6d6d 2c20 6e6f 726d 616c 697a  s0, mm, normaliz
+00000830: 6564 292c 2063 616c 635f 636f 6d6f 6d28  ed), calc_comom(
+00000840: 7472 6163 6573 312c 206d 6d2c 206e 6f72  traces1, mm, nor
+00000850: 6d61 6c69 7a65 6429 5d0d 0a20 2020 2061  malized)]..    a
+00000860: 636d 203d 205b 636d 5b3a 2c20 305d 2e63  cm = [cm[:, 0].c
+00000870: 6f70 7928 2920 666f 7220 636d 2069 6e20  opy() for cm in 
+00000880: 656e 672e 636f 6d6f 6d65 6e74 7328 6d6f  eng.comoments(mo
+00000890: 6d65 6e74 733d 6d6d 295d 5b30 5d20 2023  ments=mm)][0]  #
+000008a0: 204f 6e6c 7920 6f6e 6520 636c 6173 7369   Only one classi
+000008b0: 6669 6572 0d0a 2020 2020 6e74 2e61 7373  fier..    nt.ass
+000008c0: 6572 745f 616c 6c63 6c6f 7365 2861 636d  ert_allclose(acm
+000008d0: 2c20 6563 6d2c 2061 746f 6c3d 3165 2d30  , ecm, atol=1e-0
+000008e0: 382c 2065 7272 5f6d 7367 3d66 2765 7272  8, err_msg=f'err
+000008f0: 6f72 2069 6e20 636f 6d6f 6d65 6e74 206f  or in comoment o
+00000900: 7264 6572 207b 6d6d 7d27 290d 0a0d 0a0d  rder {mm}').....
+00000910: 0a64 6566 205f 656e 7375 7265 5f6d 6f6d  .def _ensure_mom
+00000920: 2865 6e67 2c20 7472 6163 6573 302c 2074  (eng, traces0, t
+00000930: 7261 6365 7331 2c20 6e6f 726d 616c 697a  races1, normaliz
+00000940: 6564 3d54 7275 6529 3a0d 0a20 206e 302c  ed=True):..  n0,
+00000950: 206e 3120 3d20 6c65 6e28 7472 6163 6573   n1 = len(traces
+00000960: 3029 2c20 6c65 6e28 7472 6163 6573 3129  0), len(traces1)
+00000970: 0d0a 0d0a 2020 2320 5465 7374 2063 6f75  ....  # Test cou
+00000980: 6e74 730d 0a20 206e 742e 6173 7365 7274  nts..  nt.assert
+00000990: 5f65 7175 616c 286c 6973 7428 656e 672e  _equal(list(eng.
+000009a0: 636f 756e 7473 2830 2929 2c20 5b6e 302c  counts(0)), [n0,
+000009b0: 206e 315d 290d 0a0d 0a20 2023 2054 6573   n1])....  # Tes
+000009c0: 7420 3144 0d0a 2020 6d61 785f 6d6f 6d65  t 1D..  max_mome
+000009d0: 6e74 203d 2065 6e67 2e6d 6f6d 656e 7420  nt = eng.moment 
+000009e0: 2a20 656e 672e 6469 6d0d 0a0d 0a20 2023  * eng.dim....  #
+000009f0: 2052 6177 206d 6f6d 656e 740d 0a20 206d   Raw moment..  m
+00000a00: 203d 2031 0d0a 2020 656d 6f6d 203d 205b   = 1..  emom = [
+00000a10: 6361 6c63 5f6d 6f6d 2874 7261 6365 7330  calc_mom(traces0
+00000a20: 2c20 6d2c 206e 6f72 6d61 6c69 7a65 6429  , m, normalized)
+00000a30: 2c20 6361 6c63 5f6d 6f6d 2874 7261 6365  , calc_mom(trace
+00000a40: 7331 2c20 6d2c 206e 6f72 6d61 6c69 7a65  s1, m, normalize
+00000a50: 6429 5d0d 0a20 2061 6d6f 6d20 3d20 5b5f  d)]..  amom = [_
+00000a60: 6d5b 3a2c 2030 5d2e 636f 7079 2829 2066  m[:, 0].copy() f
+00000a70: 6f72 205f 6d20 696e 2065 6e67 2e6d 6f6d  or _m in eng.mom
+00000a80: 656e 7473 286d 6f6d 656e 7473 3d6d 295d  ents(moments=m)]
+00000a90: 5b30 5d20 2023 204f 6e6c 7920 6f6e 6520  [0]  # Only one 
+00000aa0: 636c 6173 7369 6669 6572 0d0a 2020 6e74  classifier..  nt
+00000ab0: 2e61 7373 6572 745f 616c 6c63 6c6f 7365  .assert_allclose
+00000ac0: 2865 6d6f 6d2c 2061 6d6f 6d2c 2061 746f  (emom, amom, ato
+00000ad0: 6c3d 3165 2d30 372c 2065 7272 5f6d 7367  l=1e-07, err_msg
+00000ae0: 3d27 6572 726f 7220 696e 2065 6e67 696e  ='error in engin
+00000af0: 6520 7b7d 206d 6f6d 656e 7420 6f72 6465  e {} moment orde
+00000b00: 7220 7b7d 272e 666f 726d 6174 2865 6e67  r {}'.format(eng
+00000b10: 2e5f 696d 706c 2c20 6d29 290d 0a0d 0a20  ._impl, m)).... 
+00000b20: 2023 2043 656e 7472 616c 206d 6f6d 656e   # Central momen
+00000b30: 740d 0a20 206d 203d 2032 0d0a 2020 656d  t..  m = 2..  em
+00000b40: 6f6d 203d 205b 6361 6c63 5f6d 6f6d 2874  om = [calc_mom(t
+00000b50: 7261 6365 7330 2c20 6d2c 206e 6f72 6d61  races0, m, norma
+00000b60: 6c69 7a65 6429 2c20 6361 6c63 5f6d 6f6d  lized), calc_mom
+00000b70: 2874 7261 6365 7331 2c20 6d2c 206e 6f72  (traces1, m, nor
+00000b80: 6d61 6c69 7a65 6429 5d0d 0a20 2061 6d6f  malized)]..  amo
+00000b90: 6d20 3d20 5b5f 6d5b 3a2c 2030 5d2e 636f  m = [_m[:, 0].co
+00000ba0: 7079 2829 2066 6f72 205f 6d20 696e 2065  py() for _m in e
+00000bb0: 6e67 2e6d 6f6d 656e 7473 286d 6f6d 656e  ng.moments(momen
+00000bc0: 7473 3d5b 6d5d 295d 5b30 5d20 2023 204f  ts=[m])][0]  # O
+00000bd0: 6e6c 7920 6f6e 6520 636c 6173 7369 6669  nly one classifi
+00000be0: 6572 0d0a 2020 6e74 2e61 7373 6572 745f  er..  nt.assert_
+00000bf0: 616c 6c63 6c6f 7365 2865 6d6f 6d2c 2061  allclose(emom, a
+00000c00: 6d6f 6d2c 2065 7272 5f6d 7367 3d27 6572  mom, err_msg='er
+00000c10: 726f 7220 696e 2065 6e67 696e 6520 7b7d  ror in engine {}
+00000c20: 206d 6f6d 656e 7420 6f72 6465 7220 7b7d   moment order {}
+00000c30: 272e 666f 726d 6174 2865 6e67 2e5f 696d  '.format(eng._im
+00000c40: 706c 2c20 6d29 290d 0a0d 0a20 2023 2053  pl, m))....  # S
+00000c50: 7461 6e64 6172 7469 7a65 6420 6d6f 6d65  tandartized mome
+00000c60: 6e74 730d 0a20 2066 6f72 206d 2069 6e20  nts..  for m in 
+00000c70: 7261 6e67 6528 332c 206d 6178 5f6d 6f6d  range(3, max_mom
+00000c80: 656e 7420 2b20 3129 3a0d 0a20 2020 2065  ent + 1):..    e
+00000c90: 6d6f 6d20 3d20 5b63 616c 635f 6d6f 6d28  mom = [calc_mom(
+00000ca0: 7472 6163 6573 302c 206d 2c20 6e6f 726d  traces0, m, norm
+00000cb0: 616c 697a 6564 292c 2063 616c 635f 6d6f  alized), calc_mo
+00000cc0: 6d28 7472 6163 6573 312c 206d 2c20 6e6f  m(traces1, m, no
+00000cd0: 726d 616c 697a 6564 295d 0d0a 2020 2020  rmalized)]..    
+00000ce0: 616d 6f6d 203d 205b 5f6d 5b3a 2c20 305d  amom = [_m[:, 0]
+00000cf0: 2e63 6f70 7928 2920 666f 7220 5f6d 2069  .copy() for _m i
+00000d00: 6e20 656e 672e 6d6f 6d65 6e74 7328 6d6f  n eng.moments(mo
+00000d10: 6d65 6e74 733d 6d29 5d5b 305d 2020 2320  ments=m)][0]  # 
+00000d20: 4f6e 6c79 206f 6e65 2063 6c61 7373 6966  Only one classif
+00000d30: 6965 720d 0a20 2020 206e 742e 6173 7365  ier..    nt.asse
+00000d40: 7274 5f61 6c6c 636c 6f73 6528 656d 6f6d  rt_allclose(emom
+00000d50: 2c20 616d 6f6d 2c20 6174 6f6c 3d31 652d  , amom, atol=1e-
+00000d60: 3037 2c20 6572 725f 6d73 673d 2765 7272  07, err_msg='err
+00000d70: 6f72 2069 6e20 656e 6769 6e65 207b 7d20  or in engine {} 
+00000d80: 6d6f 6d65 6e74 206f 7264 6572 207b 7d27  moment order {}'
+00000d90: 2e66 6f72 6d61 7428 656e 672e 5f69 6d70  .format(eng._imp
+00000da0: 6c2c 206d 2929 0d0a 0d0a 2020 6d6c 6973  l, m))....  mlis
+00000db0: 7420 3d20 6c69 7374 2872 616e 6765 286d  t = list(range(m
+00000dc0: 6178 5f6d 6f6d 656e 7420 2d20 312c 206d  ax_moment - 1, m
+00000dd0: 6178 5f6d 6f6d 656e 7420 2b20 3129 290d  ax_moment + 1)).
+00000de0: 0a20 2061 6d6f 6d20 3d20 6e65 7874 2865  .  amom = next(e
+00000df0: 6e67 2e6d 6f6d 656e 7473 286d 6f6d 656e  ng.moments(momen
+00000e00: 7473 3d6d 6c69 7374 2929 0d0a 2020 666f  ts=mlist))..  fo
+00000e10: 7220 692c 206d 6d30 3120 696e 2065 6e75  r i, mm01 in enu
+00000e20: 6d65 7261 7465 2861 6d6f 6d2e 7472 616e  merate(amom.tran
+00000e30: 7370 6f73 6528 312c 2030 2c20 3229 2c20  spose(1, 0, 2), 
+00000e40: 6e70 2e6d 696e 286d 6c69 7374 2929 3a0d  np.min(mlist)):.
 00000e50: 0a20 2020 2065 6d6f 6d20 3d20 5b63 616c  .    emom = [cal
-00000e60: 635f 6d6f 6d28 7472 6163 6573 302c 206d  c_mom(traces0, m
+00000e60: 635f 6d6f 6d28 7472 6163 6573 302c 2069  c_mom(traces0, i
 00000e70: 2c20 6e6f 726d 616c 697a 6564 292c 2063  , normalized), c
 00000e80: 616c 635f 6d6f 6d28 7472 6163 6573 312c  alc_mom(traces1,
-00000e90: 206d 2c20 6e6f 726d 616c 697a 6564 295d   m, normalized)]
-00000ea0: 0d0a 2020 2020 616d 6f6d 203d 205b 5f6d  ..    amom = [_m
-00000eb0: 5b3a 2c20 305d 2e63 6f70 7928 2920 666f  [:, 0].copy() fo
-00000ec0: 7220 5f6d 2069 6e20 656e 672e 6d6f 6d65  r _m in eng.mome
-00000ed0: 6e74 7328 6d6f 6d65 6e74 733d 5b6d 5d29  nts(moments=[m])
-00000ee0: 5d5b 305d 2020 2320 4f6e 6c79 206f 6e65  ][0]  # Only one
-00000ef0: 2063 6c61 7373 6966 6965 720d 0a20 2020   classifier..   
-00000f00: 206e 742e 6173 7365 7274 5f61 6c6c 636c   nt.assert_allcl
-00000f10: 6f73 6528 656d 6f6d 2c20 616d 6f6d 2c20  ose(emom, amom, 
-00000f20: 6572 725f 6d73 673d 2765 7272 6f72 2069  err_msg='error i
-00000f30: 6e20 656e 6769 6e65 207b 7d20 6d6f 6d65  n engine {} mome
-00000f40: 6e74 206f 7264 6572 207b 7d27 2e66 6f72  nt order {}'.for
-00000f50: 6d61 7428 656e 672e 5f69 6d70 6c2c 206d  mat(eng._impl, m
-00000f60: 2929 0d0a 0d0a 2020 2020 2320 5374 616e  ))....    # Stan
-00000f70: 6461 7274 697a 6564 206d 6f6d 656e 7473  dartized moments
-00000f80: 0d0a 2020 2020 666f 7220 6d20 696e 2072  ..    for m in r
-00000f90: 616e 6765 2833 2c20 6d61 785f 6d6f 6d65  ange(3, max_mome
-00000fa0: 6e74 202b 2031 293a 0d0a 2020 2020 2020  nt + 1):..      
-00000fb0: 656d 6f6d 203d 205b 6361 6c63 5f6d 6f6d  emom = [calc_mom
-00000fc0: 2874 7261 6365 7330 2c20 6d2c 206e 6f72  (traces0, m, nor
-00000fd0: 6d61 6c69 7a65 6429 2c20 6361 6c63 5f6d  malized), calc_m
-00000fe0: 6f6d 2874 7261 6365 7331 2c20 6d2c 206e  om(traces1, m, n
-00000ff0: 6f72 6d61 6c69 7a65 6429 5d0d 0a20 2020  ormalized)]..   
-00001000: 2020 2061 6d6f 6d20 3d20 5b5f 6d5b 3a2c     amom = [_m[:,
-00001010: 2030 5d2e 636f 7079 2829 2066 6f72 205f   0].copy() for _
-00001020: 6d20 696e 2065 6e67 2e6d 6f6d 656e 7473  m in eng.moments
-00001030: 286d 6f6d 656e 7473 3d6d 295d 5b30 5d20  (moments=m)][0] 
-00001040: 2023 204f 6e6c 7920 6f6e 6520 636c 6173   # Only one clas
-00001050: 7369 6669 6572 0d0a 2020 2020 2020 6e74  sifier..      nt
-00001060: 2e61 7373 6572 745f 616c 6c63 6c6f 7365  .assert_allclose
-00001070: 2865 6d6f 6d2c 2061 6d6f 6d2c 2061 746f  (emom, amom, ato
-00001080: 6c3d 3165 2d30 372c 2065 7272 5f6d 7367  l=1e-07, err_msg
-00001090: 3d27 6572 726f 7220 696e 2065 6e67 696e  ='error in engin
-000010a0: 6520 7b7d 206d 6f6d 656e 7420 6f72 6465  e {} moment orde
-000010b0: 7220 7b7d 272e 666f 726d 6174 2865 6e67  r {}'.format(eng
-000010c0: 2e5f 696d 706c 2c20 6d29 290d 0a0d 0a20  ._impl, m)).... 
-000010d0: 2020 206d 6c69 7374 203d 206c 6973 7428     mlist = list(
-000010e0: 7261 6e67 6528 6d61 785f 6d6f 6d65 6e74  range(max_moment
-000010f0: 202d 2031 2c20 6d61 785f 6d6f 6d65 6e74   - 1, max_moment
-00001100: 202b 2031 2929 0d0a 2020 2020 616d 6f6d   + 1))..    amom
-00001110: 203d 206e 6578 7428 656e 672e 6d6f 6d65   = next(eng.mome
-00001120: 6e74 7328 6d6f 6d65 6e74 733d 6d6c 6973  nts(moments=mlis
-00001130: 7429 290d 0a20 2020 2066 6f72 2069 2c20  t))..    for i, 
-00001140: 6d6d 3031 2069 6e20 656e 756d 6572 6174  mm01 in enumerat
-00001150: 6528 616d 6f6d 2e74 7261 6e73 706f 7365  e(amom.transpose
-00001160: 2831 2c20 302c 2032 292c 206e 702e 6d69  (1, 0, 2), np.mi
-00001170: 6e28 6d6c 6973 7429 293a 0d0a 2020 2020  n(mlist)):..    
-00001180: 2020 656d 6f6d 203d 205b 6361 6c63 5f6d    emom = [calc_m
-00001190: 6f6d 2874 7261 6365 7330 2c20 692c 206e  om(traces0, i, n
-000011a0: 6f72 6d61 6c69 7a65 6429 2c20 6361 6c63  ormalized), calc
-000011b0: 5f6d 6f6d 2874 7261 6365 7331 2c20 692c  _mom(traces1, i,
-000011c0: 206e 6f72 6d61 6c69 7a65 6429 5d0d 0a20   normalized)].. 
-000011d0: 2020 2020 206e 742e 6173 7365 7274 5f61       nt.assert_a
-000011e0: 6c6c 636c 6f73 6528 656d 6f6d 2c20 6d6d  llclose(emom, mm
-000011f0: 3031 2c20 6174 6f6c 3d31 652d 3037 2c20  01, atol=1e-07, 
-00001200: 6572 725f 6d73 673d 2765 7272 6f72 2069  err_msg='error i
-00001210: 6e20 656e 6769 6e65 207b 7d20 6d6f 6d65  n engine {} mome
-00001220: 6e74 206f 7264 6572 207b 7d27 2e66 6f72  nt order {}'.for
-00001230: 6d61 7428 656e 672e 5f69 6d70 6c2c 206d  mat(eng._impl, m
-00001240: 2929 0d0a 0d0a 0d0a 636c 6173 7320 5465  ))......class Te
-00001250: 7374 5f62 6976 6172 2875 6e69 7474 6573  st_bivar(unittes
-00001260: 742e 5465 7374 4361 7365 293a 0d0a 2020  t.TestCase):..  
-00001270: 6465 6620 7465 7374 5f69 6e69 7428 7365  def test_init(se
-00001280: 6c66 293a 0d0a 2020 2020 656e 6769 6e65  lf):..    engine
-00001290: 203d 2073 7461 746d 6f6d 656e 7473 2e42   = statmoments.B
-000012a0: 6976 6172 2831 302c 2031 3629 0d0a 0d0a  ivar(10, 16)....
-000012b0: 2020 2020 6174 7420 3d20 6c69 7374 2873      att = list(s
-000012c0: 7461 746d 6f6d 656e 7473 2e73 7461 7474  tatmoments.statt
-000012d0: 6573 7473 2e74 7465 7374 7328 656e 6769  ests.ttests(engi
-000012e0: 6e65 2929 0d0a 2020 2020 7365 6c66 2e61  ne))..    self.a
-000012f0: 7373 6572 7445 7175 616c 286e 702e 6d61  ssertEqual(np.ma
-00001300: 7828 6e70 2e61 6273 2861 7474 2929 2c20  x(np.abs(att)), 
-00001310: 3029 0d0a 0d0a 2020 2020 7365 6c66 2e61  0)....    self.a
-00001320: 7373 6572 7445 7175 616c 286c 656e 2861  ssertEqual(len(a
-00001330: 7474 292c 2031 3629 0d0a 2020 2020 7365  tt), 16)..    se
-00001340: 6c66 2e61 7373 6572 7445 7175 616c 2865  lf.assertEqual(e
-00001350: 6e67 696e 652e 746f 7461 6c5f 636f 756e  ngine.total_coun
-00001360: 742c 2030 290d 0a0d 0a20 2064 6566 2074  t, 0)....  def t
-00001370: 6573 745f 7072 6f6a 5f6b 726e 6c5f 6d65  est_proj_krnl_me
-00001380: 6d73 697a 6528 7365 6c66 293a 0d0a 2020  msize(self):..  
-00001390: 2020 6d6f 6d65 6e74 203d 2032 0d0a 2020    moment = 2..  
-000013a0: 2020 7472 5f6c 656e 2c20 636c 5f6c 656e    tr_len, cl_len
-000013b0: 203d 2031 3030 3030 2c20 310d 0a0d 0a20   = 10000, 1.... 
-000013c0: 2020 206b 6572 6e65 6c73 203d 205b 0d0a     kernels = [..
-000013d0: 2020 2020 2020 2020 7374 6174 6d6f 6d65          statmome
-000013e0: 6e74 732e 6269 7661 725f 7375 6d2c 0d0a  nts.bivar_sum,..
-000013f0: 2020 2020 2020 2020 7374 6174 6d6f 6d65          statmome
-00001400: 6e74 732e 6269 7661 725f 636e 7472 2c0d  nts.bivar_cntr,.
-00001410: 0a20 2020 2020 2020 2073 7461 746d 6f6d  .        statmom
-00001420: 656e 7473 2e62 6976 6172 5f32 7061 7373  ents.bivar_2pass
-00001430: 2c0d 0a20 2020 205d 0d0a 2020 2020 666f  ,..    ]..    fo
-00001440: 7220 6b72 2069 6e20 6b65 726e 656c 733a  r kr in kernels:
-00001450: 0d0a 2020 2020 2020 7365 6c66 2e61 7373  ..      self.ass
-00001460: 6572 7447 7265 6174 6572 286b 722e 6573  ertGreater(kr.es
-00001470: 7469 6d61 7465 5f6d 656d 5f73 697a 6528  timate_mem_size(
-00001480: 7472 5f6c 656e 2c20 636c 5f6c 656e 2c20  tr_len, cl_len, 
-00001490: 6d6f 6d65 6e74 292c 2031 3032 3429 0d0a  moment), 1024)..
-000014a0: 0d0a 2020 2020 6d73 203d 2073 7461 746d  ..    ms = statm
-000014b0: 6f6d 656e 7473 2e42 6976 6172 2e65 7374  oments.Bivar.est
-000014c0: 696d 6174 655f 6d65 6d5f 7369 7a65 2874  imate_mem_size(t
-000014d0: 725f 6c65 6e2c 2063 6c5f 6c65 6e2c 206d  r_len, cl_len, m
-000014e0: 6f6d 656e 743d 3429 0d0a 2020 2020 7365  oment=4)..    se
-000014f0: 6c66 2e61 7373 6572 7447 7265 6174 6572  lf.assertGreater
-00001500: 286d 732c 2031 3020 2a20 3130 3234 202a  (ms, 10 * 1024 *
-00001510: 2031 3032 3429 0d0a 0d0a 2020 6465 6620   1024)....  def 
-00001520: 7465 7374 5f63 6f6d 6f6d 656e 7473 5f61  test_comoments_a
-00001530: 6c6c 5f6b 6572 6e65 6c73 2873 656c 6629  ll_kernels(self)
-00001540: 3a0d 0a20 2020 2074 725f 6c65 6e2c 2063  :..    tr_len, c
-00001550: 6c5f 6c65 6e20 3d20 332c 2031 0d0a 2020  l_len = 3, 1..  
-00001560: 2020 6e30 2c20 6e31 203d 2035 3637 2c20    n0, n1 = 567, 
-00001570: 3839 300d 0a20 2020 2074 7261 6365 7330  890..    traces0
-00001580: 203d 206e 702e 7261 6e64 6f6d 2e72 616e   = np.random.ran
-00001590: 6469 6e74 2830 2c20 3235 362c 2028 6e30  dint(0, 256, (n0
-000015a0: 2c20 7472 5f6c 656e 2929 0d0a 2020 2020  , tr_len))..    
-000015b0: 7472 6163 6573 3120 3d20 6e70 2e72 616e  traces1 = np.ran
-000015c0: 646f 6d2e 7261 6e64 696e 7428 302c 2032  dom.randint(0, 2
-000015d0: 3536 2c20 286e 312c 2074 725f 6c65 6e29  56, (n1, tr_len)
-000015e0: 290d 0a20 2020 2065 6e67 696e 6573 203d  )..    engines =
-000015f0: 2061 6c6c 5f65 6e67 696e 6573 5f32 6428   all_engines_2d(
-00001600: 7472 5f6c 656e 2c20 636c 5f6c 656e 2c20  tr_len, cl_len, 
-00001610: 6d6f 6d65 6e74 3d34 290d 0a0d 0a20 2020  moment=4)....   
-00001620: 2066 6f72 2065 6e67 2069 6e20 656e 6769   for eng in engi
-00001630: 6e65 733a 0d0a 2020 2020 2020 656e 672e  nes:..      eng.
-00001640: 7570 6461 7465 2874 7261 6365 7330 2c20  update(traces0, 
-00001650: 5b27 3027 5d20 2a20 6e30 290d 0a20 2020  ['0'] * n0)..   
-00001660: 2020 2065 6e67 2e75 7064 6174 6528 7472     eng.update(tr
-00001670: 6163 6573 312c 205b 2731 275d 202a 206e  aces1, ['1'] * n
-00001680: 3129 0d0a 0d0a 2020 2020 5f65 6e73 7572  1)....    _ensur
-00001690: 655f 6d6f 6d28 656e 6769 6e65 732c 2074  e_mom(engines, t
-000016a0: 7261 6365 7330 2c20 7472 6163 6573 3129  races0, traces1)
-000016b0: 0d0a 2020 2020 5f65 6e73 7572 655f 636f  ..    _ensure_co
-000016c0: 6d6f 6d28 656e 6769 6e65 732c 2074 7261  mom(engines, tra
-000016d0: 6365 7330 2c20 7472 6163 6573 3129 0d0a  ces0, traces1)..
-000016e0: 0d0a 2020 6465 6620 7465 7374 5f63 6f6d  ..  def test_com
-000016f0: 6f6d 656e 7473 5f61 6c6c 5f6b 6572 6e65  oments_all_kerne
-00001700: 6c73 5f6e 6f72 6d61 6c69 7a65 6428 7365  ls_normalized(se
-00001710: 6c66 293a 0d0a 2020 2020 6e6f 726d 616c  lf):..    normal
-00001720: 697a 6520 3d20 5472 7565 0d0a 2020 2020  ize = True..    
-00001730: 7472 5f6c 656e 2c20 636c 5f6c 656e 203d  tr_len, cl_len =
-00001740: 2033 2c20 310d 0a20 2020 206e 302c 206e   3, 1..    n0, n
-00001750: 3120 3d20 3736 342c 2039 3830 0d0a 2020  1 = 764, 980..  
-00001760: 2020 7472 6163 6573 3020 3d20 6e70 2e72    traces0 = np.r
-00001770: 616e 646f 6d2e 7261 6e64 696e 7428 302c  andom.randint(0,
-00001780: 2032 3536 2c20 286e 302c 2074 725f 6c65   256, (n0, tr_le
-00001790: 6e29 290d 0a20 2020 2074 7261 6365 7331  n))..    traces1
-000017a0: 203d 206e 702e 7261 6e64 6f6d 2e72 616e   = np.random.ran
-000017b0: 6469 6e74 2830 2c20 3235 362c 2028 6e31  dint(0, 256, (n1
-000017c0: 2c20 7472 5f6c 656e 2929 0d0a 2020 2020  , tr_len))..    
-000017d0: 656e 6769 6e65 7320 3d20 616c 6c5f 656e  engines = all_en
-000017e0: 6769 6e65 735f 3264 2874 725f 6c65 6e2c  gines_2d(tr_len,
-000017f0: 2063 6c5f 6c65 6e2c 206d 6f6d 656e 743d   cl_len, moment=
-00001800: 342c 206e 6f72 6d61 6c69 7a65 3d6e 6f72  4, normalize=nor
-00001810: 6d61 6c69 7a65 290d 0a0d 0a20 2020 2066  malize)....    f
-00001820: 6f72 2065 6e67 2069 6e20 656e 6769 6e65  or eng in engine
-00001830: 733a 0d0a 2020 2020 2020 656e 672e 7570  s:..      eng.up
-00001840: 6461 7465 2874 7261 6365 7330 2c20 5b27  date(traces0, ['
-00001850: 3027 5d20 2a20 6e30 290d 0a20 2020 2020  0'] * n0)..     
-00001860: 2065 6e67 2e75 7064 6174 6528 7472 6163   eng.update(trac
-00001870: 6573 312c 205b 2731 275d 202a 206e 3129  es1, ['1'] * n1)
-00001880: 0d0a 0d0a 2020 2020 5f65 6e73 7572 655f  ....    _ensure_
-00001890: 6d6f 6d28 656e 6769 6e65 732c 2074 7261  mom(engines, tra
-000018a0: 6365 7330 2c20 7472 6163 6573 312c 206e  ces0, traces1, n
-000018b0: 6f72 6d61 6c69 7a65 290d 0a20 2020 205f  ormalize)..    _
-000018c0: 656e 7375 7265 5f63 6f6d 6f6d 2865 6e67  ensure_comom(eng
-000018d0: 696e 6573 2c20 7472 6163 6573 302c 2074  ines, traces0, t
-000018e0: 7261 6365 7331 2c20 6e6f 726d 616c 697a  races1, normaliz
-000018f0: 6529 0d0a 0d0a 2020 6465 6620 7465 7374  e)....  def test
-00001900: 5f74 7269 7669 616c 2873 656c 6629 3a0d  _trivial(self):.
-00001910: 0a20 2020 206d 2c20 636c 5f6c 656e 203d  .    m, cl_len =
-00001920: 2034 2c20 310d 0a20 2020 2074 7261 6365   4, 1..    trace
-00001930: 7330 203d 206e 702e 6172 7261 7928 5b0d  s0 = np.array([.
-00001940: 0a20 2020 2020 2020 205b 322c 2020 342c  .        [2,  4,
-00001950: 2020 2035 5d2c 0d0a 2020 2020 2020 2020     5],..        
-00001960: 5b34 2c20 2036 2c20 202d 325d 2c0d 0a20  [4,  6,  -2],.. 
-00001970: 2020 2020 2020 205b 372c 2020 332c 2020         [7,  3,  
-00001980: 2030 5d2c 0d0a 2020 2020 2020 2020 5b38   0],..        [8
-00001990: 2c20 2035 2c20 2020 315d 2c0d 0a20 2020  ,  5,   1],..   
-000019a0: 2020 2020 205b 322c 2020 372c 2020 2036       [2,  7,   6
-000019b0: 5d2c 0d0a 2020 2020 2020 2020 5b39 2c20  ],..        [9, 
-000019c0: 2031 2c20 2020 325d 2c0d 0a20 2020 2020   1,   2],..     
-000019d0: 2020 205b 342c 2020 382c 2020 2d34 5d2c     [4,  8,  -4],
-000019e0: 0d0a 2020 2020 2020 2020 5b31 2c20 2032  ..        [1,  2
-000019f0: 2c20 2020 385d 2c0d 0a20 2020 205d 2c20  ,   8],..    ], 
-00001a00: 6474 7970 653d 6e70 2e69 6e74 3829 0d0a  dtype=np.int8)..
-00001a10: 2020 2020 2320 7472 6163 6573 3020 3d20      # traces0 = 
-00001a20: 6e70 2e72 616e 646f 6d2e 756e 6966 6f72  np.random.unifor
-00001a30: 6d28 302c 2032 302c 2028 3530 2c20 3130  m(0, 20, (50, 10
-00001a40: 2929 2e61 7374 7970 6528 6e70 2e69 6e74  )).astype(np.int
-00001a50: 3829 0d0a 2020 2020 7472 6163 6573 3120  8)..    traces1 
-00001a60: 3d20 2874 7261 6365 7330 202b 206e 702e  = (traces0 + np.
-00001a70: 7369 6e28 7472 6163 6573 3029 202a 2033  sin(traces0) * 3
-00001a80: 292e 6173 7479 7065 286e 702e 696e 7438  ).astype(np.int8
-00001a90: 290d 0a20 2020 2074 7261 6365 7330 5b3a  )..    traces0[:
-00001aa0: 2c20 305d 203d 2028 3320 2a20 7472 6163  , 0] = (3 * trac
-00001ab0: 6573 305b 3a2c 2031 5d20 2f20 3220 2b20  es0[:, 1] / 2 + 
-00001ac0: 3230 292e 6173 7479 7065 286e 702e 696e  20).astype(np.in
-00001ad0: 7438 290d 0a0d 0a20 2020 2061 6c6c 5f74  t8)....    all_t
-00001ae0: 7261 6365 7320 3d20 6e70 2e76 7374 6163  races = np.vstac
-00001af0: 6b28 2874 7261 6365 7330 2c20 7472 6163  k((traces0, trac
-00001b00: 6573 3129 290d 0a20 2020 2074 725f 636f  es1))..    tr_co
-00001b10: 756e 742c 2074 725f 6c65 6e20 3d20 616c  unt, tr_len = al
-00001b20: 6c5f 7472 6163 6573 2e73 6861 7065 0d0a  l_traces.shape..
-00001b30: 2020 2020 616c 6c5f 636c 7320 3d20 6e70      all_cls = np
-00001b40: 2e7a 6572 6f73 2828 7472 5f63 6f75 6e74  .zeros((tr_count
-00001b50: 2c20 636c 5f6c 656e 292c 2064 7479 7065  , cl_len), dtype
-00001b60: 3d6e 702e 7569 6e74 3829 0d0a 2020 2020  =np.uint8)..    
-00001b70: 616c 6c5f 636c 735b 6c65 6e28 7472 6163  all_cls[len(trac
-00001b80: 6573 3029 3a5d 203d 2031 0d0a 0d0a 2020  es0):] = 1....  
-00001b90: 2020 656e 6769 6e65 7320 3d20 616c 6c5f    engines = all_
-00001ba0: 656e 6769 6e65 735f 3264 2874 725f 6c65  engines_2d(tr_le
-00001bb0: 6e2c 2063 6c5f 6c65 6e2c 206d 6f6d 656e  n, cl_len, momen
-00001bc0: 743d 6d2c 2061 6363 5f6d 696e 5f63 6f75  t=m, acc_min_cou
-00001bd0: 6e74 3d33 290d 0a20 2020 2023 2065 6e67  nt=3)..    # eng
-00001be0: 696e 6573 203d 205b 7374 6174 6d6f 6d65  ines = [statmome
-00001bf0: 6e74 732e 4269 7661 7228 7472 5f6c 656e  nts.Bivar(tr_len
-00001c00: 2c20 636c 5f6c 656e 2c20 6b65 726e 656c  , cl_len, kernel
-00001c10: 3d73 7461 746d 6f6d 656e 7473 2e62 6976  =statmoments.biv
-00001c20: 6172 5f73 756d 2c20 2020 2020 206d 6f6d  ar_sum,      mom
-00001c30: 656e 743d 6d2c 2061 6363 5f6d 696e 5f63  ent=m, acc_min_c
-00001c40: 6f75 6e74 3d33 295d 0d0a 0d0a 2020 2020  ount=3)]....    
-00001c50: 2320 6d65 6d31 3020 3d20 7374 6174 6d6f  # mem10 = statmo
-00001c60: 6d65 6e74 732e 6269 7661 725f 7375 6d2e  ments.bivar_sum.
-00001c70: 6573 7469 6d61 7465 5f6d 656d 5f73 697a  estimate_mem_siz
-00001c80: 6528 616c 6c5f 7472 6163 6573 2e73 6861  e(all_traces.sha
-00001c90: 7065 5b31 5d2c 2020 2020 2063 6c5f 6c65  pe[1],     cl_le
-00001ca0: 6e2c 206d 290d 0a20 2020 2023 206d 656d  n, m)..    # mem
-00001cb0: 3131 203d 2073 7461 746d 6f6d 656e 7473  11 = statmoments
-00001cc0: 2e62 6976 6172 5f73 756d 5f6d 6978 2e65  .bivar_sum_mix.e
-00001cd0: 7374 696d 6174 655f 6d65 6d5f 7369 7a65  stimate_mem_size
-00001ce0: 2861 6c6c 5f74 7261 6365 732e 7368 6170  (all_traces.shap
-00001cf0: 655b 315d 2c20 636c 5f6c 656e 2c20 6d29  e[1], cl_len, m)
-00001d00: 0d0a 2020 2020 2320 6d65 6d31 3220 3d20  ..    # mem12 = 
-00001d10: 7374 6174 6d6f 6d65 6e74 732e 6269 7661  statmoments.biva
-00001d20: 725f 3270 6173 732e 6573 7469 6d61 7465  r_2pass.estimate
-00001d30: 5f6d 656d 5f73 697a 6528 616c 6c5f 7472  _mem_size(all_tr
-00001d40: 6163 6573 2e73 6861 7065 5b31 5d2c 2020  aces.shape[1],  
-00001d50: 2063 6c5f 6c65 6e2c 206d 290d 0a20 2020   cl_len, m)..   
-00001d60: 2023 206d 656d 3133 203d 2073 7461 746d   # mem13 = statm
-00001d70: 6f6d 656e 7473 2e62 6976 6172 5f74 7874  oments.bivar_txt
-00001d80: 626b 2e65 7374 696d 6174 655f 6d65 6d5f  bk.estimate_mem_
-00001d90: 7369 7a65 2861 6c6c 5f74 7261 6365 732e  size(all_traces.
-00001da0: 7368 6170 655b 315d 2c20 2020 636c 5f6c  shape[1],   cl_l
-00001db0: 656e 2c20 6d29 0d0a 0d0a 2020 2020 666f  en, m)....    fo
-00001dc0: 7220 656e 6720 696e 2065 6e67 696e 6573  r eng in engines
-00001dd0: 3a0d 0a20 2020 2020 2023 2050 6173 7320  :..      # Pass 
-00001de0: 6f6e 6520 6261 7463 6820 6166 7465 7220  one batch after 
-00001df0: 616e 6f74 6865 720d 0a20 2020 2020 2065  another..      e
-00001e00: 6e67 2e75 7064 6174 6528 616c 6c5f 7472  ng.update(all_tr
-00001e10: 6163 6573 5b3a 365d 2c20 616c 6c5f 636c  aces[:6], all_cl
-00001e20: 735b 3a36 5d29 0d0a 2020 2020 2020 656e  s[:6])..      en
-00001e30: 672e 7570 6461 7465 2861 6c6c 5f74 7261  g.update(all_tra
-00001e40: 6365 735b 363a 5d2c 2061 6c6c 5f63 6c73  ces[6:], all_cls
-00001e50: 5b36 3a5d 290d 0a20 2020 2020 2023 2065  [6:])..      # e
-00001e60: 6e67 2e75 7064 6174 6528 616c 6c5f 7472  ng.update(all_tr
-00001e70: 6163 6573 2c20 616c 6c5f 636c 7329 2020  aces, all_cls)  
-00001e80: 2320 5654 4b20 6361 6e6e 6f74 206c 6561  # VTK cannot lea
-00001e90: 726e 2073 7472 6561 6d69 6e67 6c79 0d0a  rn streamingly..
-00001ea0: 0d0a 2020 2020 5f65 6e73 7572 655f 6d6f  ..    _ensure_mo
-00001eb0: 6d28 656e 6769 6e65 732c 2074 7261 6365  m(engines, trace
-00001ec0: 7330 2c20 7472 6163 6573 3129 0d0a 2020  s0, traces1)..  
-00001ed0: 2020 5f65 6e73 7572 655f 636f 6d6f 6d28    _ensure_comom(
-00001ee0: 656e 6769 6e65 732c 2074 7261 6365 7330  engines, traces0
-00001ef0: 2c20 7472 6163 6573 3129 0d0a 0d0a 2020  , traces1)....  
-00001f00: 2020 2320 6d65 6d30 3020 3d20 656e 6769    # mem00 = engi
-00001f10: 6e65 735b 305d 2e6d 656d 6f72 795f 7369  nes[0].memory_si
-00001f20: 7a65 2020 2320 7375 6d0d 0a20 2020 2023  ze  # sum..    #
-00001f30: 206d 656d 3031 203d 2065 6e67 696e 6573   mem01 = engines
-00001f40: 5b31 5d2e 6d65 6d6f 7279 5f73 697a 6520  [1].memory_size 
-00001f50: 2023 2032 7061 7373 206d 6620 6d75 6c0d   # 2pass mf mul.
-00001f60: 0a20 2020 2023 206d 656d 3032 203d 2065  .    # mem02 = e
-00001f70: 6e67 696e 6573 5b32 5d2e 6d65 6d6f 7279  ngines[2].memory
-00001f80: 5f73 697a 6520 2023 2074 7874 626b 0d0a  _size  # txtbk..
-00001f90: 0d0a 0d0a 6465 6620 7275 6e5f 6f6e 6528  ....def run_one(
-00001fa0: 293a 0d0a 2020 7473 7569 7465 203d 2075  ):..  tsuite = u
-00001fb0: 6e69 7474 6573 742e 5465 7374 5375 6974  nittest.TestSuit
-00001fc0: 6528 290d 0a20 2074 7375 6974 652e 6164  e()..  tsuite.ad
-00001fd0: 6454 6573 7428 5465 7374 5f62 6976 6172  dTest(Test_bivar
-00001fe0: 2827 7465 7374 5f69 6e69 7427 2929 0d0a  ('test_init'))..
-00001ff0: 2020 756e 6974 7465 7374 2e54 6578 7454    unittest.TextT
-00002000: 6573 7452 756e 6e65 7228 7665 7262 6f73  estRunner(verbos
-00002010: 6974 793d 3229 2e72 756e 2874 7375 6974  ity=2).run(tsuit
-00002020: 6529 0d0a 0d0a 0d0a 2320 456e 7472 616e  e)......# Entran
-00002030: 6365 2070 6f69 6e74 0d0a 6966 205f 5f6e  ce point..if __n
-00002040: 616d 655f 5f20 3d3d 2027 5f5f 6d61 696e  ame__ == '__main
-00002050: 5f5f 273a 0d0a 2020 2320 7275 6e5f 6f6e  __':..  # run_on
-00002060: 6528 290d 0a20 2075 6e69 7474 6573 742e  e()..  unittest.
-00002070: 6d61 696e 2861 7267 763d 5b27 6669 7273  main(argv=['firs
-00002080: 742d 6172 672d 6973 2d69 676e 6f72 6564  t-arg-is-ignored
-00002090: 275d 290d 0a                             '])..
+00000e90: 2069 2c20 6e6f 726d 616c 697a 6564 295d   i, normalized)]
+00000ea0: 0d0a 2020 2020 6e74 2e61 7373 6572 745f  ..    nt.assert_
+00000eb0: 616c 6c63 6c6f 7365 2865 6d6f 6d2c 206d  allclose(emom, m
+00000ec0: 6d30 312c 2061 746f 6c3d 3165 2d30 372c  m01, atol=1e-07,
+00000ed0: 2065 7272 5f6d 7367 3d27 6572 726f 7220   err_msg='error 
+00000ee0: 696e 2065 6e67 696e 6520 7b7d 206d 6f6d  in engine {} mom
+00000ef0: 656e 7420 6f72 6465 7220 7b7d 272e 666f  ent order {}'.fo
+00000f00: 726d 6174 2865 6e67 2e5f 696d 706c 2c20  rmat(eng._impl, 
+00000f10: 6d29 290d 0a0d 0a0d 0a65 6e67 3264 5f6c  m))......eng2d_l
+00000f20: 6973 7420 3d20 5b0d 0a20 2020 2073 7461  ist = [..    sta
+00000f30: 746d 6f6d 656e 7473 2e62 6976 6172 5f32  tmoments.bivar_2
+00000f40: 7061 7373 2c0d 0a20 2020 2073 7461 746d  pass,..    statm
+00000f50: 6f6d 656e 7473 2e62 6976 6172 5f74 7874  oments.bivar_txt
+00000f60: 626b 2c0d 0a20 2020 2073 7461 746d 6f6d  bk,..    statmom
+00000f70: 656e 7473 2e62 6976 6172 5f73 756d 2c0d  ents.bivar_sum,.
+00000f80: 0a20 2020 2073 7461 746d 6f6d 656e 7473  .    statmoments
+00000f90: 2e62 6976 6172 5f63 6e74 722c 0d0a 2020  .bivar_cntr,..  
+00000fa0: 2020 7374 6174 6d6f 6d65 6e74 732e 6269    statmoments.bi
+00000fb0: 7661 725f 7375 6d5f 6465 7472 656e 640d  var_sum_detrend.
+00000fc0: 0a5d 0d0a 0d0a 0d0a 4070 7974 6573 742e  .]......@pytest.
+00000fd0: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
+00000fe0: 2822 6d22 2c20 5b32 2c20 345d 290d 0a40  ("m", [2, 4])..@
+00000ff0: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
+00001000: 6d65 7472 697a 6528 226b 6572 6e65 6c32  metrize("kernel2
+00001010: 6422 2c20 656e 6732 645f 6c69 7374 290d  d", eng2d_list).
+00001020: 0a64 6566 2074 6573 745f 696e 6974 286b  .def test_init(k
+00001030: 6572 6e65 6c32 642c 206d 293a 0d0a 2020  ernel2d, m):..  
+00001040: 656e 6769 6e65 203d 2073 7461 746d 6f6d  engine = statmom
+00001050: 656e 7473 2e42 6976 6172 2831 302c 2031  ents.Bivar(10, 1
+00001060: 362c 206d 2c20 6b65 726e 656c 3d6b 6572  6, m, kernel=ker
+00001070: 6e65 6c32 6429 0d0a 2020 6173 7365 7274  nel2d)..  assert
+00001080: 2065 6e67 696e 652e 746f 7461 6c5f 636f   engine.total_co
+00001090: 756e 7420 3d3d 2030 0d0a 0d0a 2020 616d  unt == 0....  am
+000010a0: 6f6d 7320 3d20 5b6d 2e63 6f70 7928 2920  oms = [m.copy() 
+000010b0: 666f 7220 6d20 696e 2065 6e67 696e 652e  for m in engine.
+000010c0: 6d6f 6d65 6e74 7328 295d 0d0a 2020 6173  moments()]..  as
+000010d0: 7365 7274 206e 702e 6d61 7828 6e70 2e61  sert np.max(np.a
+000010e0: 6273 2861 6d6f 6d73 2929 203c 2031 652d  bs(amoms)) < 1e-
+000010f0: 3136 0d0a 2020 6173 7365 7274 206c 656e  16..  assert len
+00001100: 2861 6d6f 6d73 2920 3d3d 2031 360d 0a0d  (amoms) == 16...
+00001110: 0a20 2077 6974 6820 6e74 2e73 7570 7072  .  with nt.suppr
+00001120: 6573 735f 7761 726e 696e 6773 2829 2061  ess_warnings() a
+00001130: 7320 7375 703a 0d0a 2020 2020 2320 436f  s sup:..    # Co
+00001140: 6d6d 6f6d 656e 7473 2069 7373 7565 2077  mmoments issue w
+00001150: 6172 6e69 6e67 730d 0a20 2020 2073 7570  arnings..    sup
+00001160: 2e66 696c 7465 7228 5275 6e74 696d 6557  .filter(RuntimeW
+00001170: 6172 6e69 6e67 2c20 224d 6561 6e20 6f66  arning, "Mean of
+00001180: 2065 6d70 7479 2073 6c69 6365 2229 0d0a   empty slice")..
+00001190: 2020 2020 7375 702e 6669 6c74 6572 2852      sup.filter(R
+000011a0: 756e 7469 6d65 5761 726e 696e 672c 2022  untimeWarning, "
+000011b0: 6469 7669 6465 2062 7920 7a65 726f 2229  divide by zero")
+000011c0: 0d0a 2020 2020 7375 702e 6669 6c74 6572  ..    sup.filter
+000011d0: 2852 756e 7469 6d65 5761 726e 696e 672c  (RuntimeWarning,
+000011e0: 2022 696e 7661 6c69 6420 7661 6c75 6522   "invalid value"
+000011f0: 290d 0a0d 0a20 2020 2061 636f 6d6f 6d73  )....    acomoms
+00001200: 203d 205b 6d2e 636f 7079 2829 2066 6f72   = [m.copy() for
+00001210: 206d 2069 6e20 656e 6769 6e65 2e63 6f6d   m in engine.com
+00001220: 6f6d 656e 7473 2829 5d0d 0a20 2020 2061  oments()]..    a
+00001230: 7373 6572 7420 6e70 2e6d 6178 286e 702e  ssert np.max(np.
+00001240: 6162 7328 6163 6f6d 6f6d 7329 2920 3c20  abs(acomoms)) < 
+00001250: 3165 2d31 360d 0a20 2020 2061 7373 6572  1e-16..    asser
+00001260: 7420 6c65 6e28 6163 6f6d 6f6d 7329 203d  t len(acomoms) =
+00001270: 3d20 3136 0d0a 0d0a 2020 2020 6174 7420  = 16....    att 
+00001280: 3d20 5b74 742e 636f 7079 2829 2066 6f72  = [tt.copy() for
+00001290: 2074 7420 696e 2073 7461 746d 6f6d 656e   tt in statmomen
+000012a0: 7473 2e73 7461 7474 6573 7473 2e74 7465  ts.stattests.tte
+000012b0: 7374 7328 656e 6769 6e65 295d 0d0a 2020  sts(engine)]..  
+000012c0: 2020 6173 7365 7274 206e 702e 6d61 7828    assert np.max(
+000012d0: 6e70 2e61 6273 2861 7474 2929 203c 2031  np.abs(att)) < 1
+000012e0: 652d 3136 0d0a 2020 2020 6173 7365 7274  e-16..    assert
+000012f0: 206c 656e 2861 7474 2920 3d3d 2031 360d   len(att) == 16.
+00001300: 0a0d 0a0d 0a40 7079 7465 7374 2e6d 6172  .....@pytest.mar
+00001310: 6b2e 7061 7261 6d65 7472 697a 6528 226b  k.parametrize("k
+00001320: 6572 6e65 6c32 6422 2c20 656e 6732 645f  ernel2d", eng2d_
+00001330: 6c69 7374 290d 0a64 6566 2074 6573 745f  list)..def test_
+00001340: 6573 745f 6b72 6e6c 5f6d 656d 7369 7a65  est_krnl_memsize
+00001350: 286b 6572 6e65 6c32 6429 3a0d 0a20 2074  (kernel2d):..  t
+00001360: 725f 6c65 6e2c 2063 6c5f 6c65 6e20 3d20  r_len, cl_len = 
+00001370: 3130 3030 302c 2031 0d0a 0d0a 2020 6d73  10000, 1....  ms
+00001380: 203d 206b 6572 6e65 6c32 642e 6573 7469   = kernel2d.esti
+00001390: 6d61 7465 5f6d 656d 5f73 697a 6528 7472  mate_mem_size(tr
+000013a0: 5f6c 656e 2c20 636c 5f6c 656e 2c20 6d6f  _len, cl_len, mo
+000013b0: 6d65 6e74 3d32 290d 0a20 2061 7373 6572  ment=2)..  asser
+000013c0: 7420 6d73 203e 2031 3032 340d 0a0d 0a0d  t ms > 1024.....
+000013d0: 0a64 6566 2074 6573 745f 6573 745f 6f62  .def test_est_ob
+000013e0: 6a5f 6d65 6d73 697a 6528 293a 0d0a 2020  j_memsize():..  
+000013f0: 7472 5f6c 656e 2c20 636c 5f6c 656e 203d  tr_len, cl_len =
+00001400: 2031 3030 3030 2c20 310d 0a20 206d 7320   10000, 1..  ms 
+00001410: 3d20 7374 6174 6d6f 6d65 6e74 732e 4269  = statmoments.Bi
+00001420: 7661 722e 6573 7469 6d61 7465 5f6d 656d  var.estimate_mem
+00001430: 5f73 697a 6528 7472 5f6c 656e 2c20 636c  _size(tr_len, cl
+00001440: 5f6c 656e 2c20 6d6f 6d65 6e74 3d34 290d  _len, moment=4).
+00001450: 0a20 2061 7373 6572 7420 6d73 203e 2031  .  assert ms > 1
+00001460: 3020 2a20 3130 3234 202a 2031 3032 340d  0 * 1024 * 1024.
+00001470: 0a0d 0a0d 0a40 7079 7465 7374 2e6d 6172  .....@pytest.mar
+00001480: 6b2e 7061 7261 6d65 7472 697a 6528 226b  k.parametrize("k
+00001490: 6572 6e65 6c32 6422 2c20 656e 6732 645f  ernel2d", eng2d_
+000014a0: 6c69 7374 290d 0a64 6566 2074 6573 745f  list)..def test_
+000014b0: 6163 745f 6d65 6d6f 7279 5f73 697a 6528  act_memory_size(
+000014c0: 6b65 726e 656c 3264 293a 0d0a 2020 6d6f  kernel2d):..  mo
+000014d0: 6d65 6e74 203d 2034 0d0a 2020 7472 5f6c  ment = 4..  tr_l
+000014e0: 656e 2c20 636c 5f6c 656e 203d 2031 3030  en, cl_len = 100
+000014f0: 302c 2032 0d0a 0d0a 2020 656d 7320 3d20  0, 2....  ems = 
+00001500: 7374 6174 6d6f 6d65 6e74 732e 4269 7661  statmoments.Biva
+00001510: 722e 6573 7469 6d61 7465 5f6d 656d 5f73  r.estimate_mem_s
+00001520: 697a 6528 7472 5f6c 656e 2c20 636c 5f6c  ize(tr_len, cl_l
+00001530: 656e 2c20 6d6f 6d65 6e74 2c20 6b65 726e  en, moment, kern
+00001540: 656c 3d6b 6572 6e65 6c32 6429 0d0a 2020  el=kernel2d)..  
+00001550: 616d 7320 3d20 7374 6174 6d6f 6d65 6e74  ams = statmoment
+00001560: 732e 4269 7661 7228 7472 5f6c 656e 2c20  s.Bivar(tr_len, 
+00001570: 636c 5f6c 656e 2c20 6b65 726e 656c 3d6b  cl_len, kernel=k
+00001580: 6572 6e65 6c32 642c 206d 6f6d 656e 743d  ernel2d, moment=
+00001590: 6d6f 6d65 6e74 292e 6d65 6d6f 7279 5f73  moment).memory_s
+000015a0: 697a 650d 0a0d 0a20 2061 7373 6572 7420  ize....  assert 
+000015b0: 6162 7328 656d 7320 2d20 616d 7329 203c  abs(ems - ams) <
+000015c0: 3d20 3120 3c3c 2032 300d 0a0d 0a0d 0a40  = 1 << 20......@
+000015d0: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
+000015e0: 6d65 7472 697a 6528 226b 6572 6e65 6c32  metrize("kernel2
+000015f0: 6422 2c20 656e 6732 645f 6c69 7374 290d  d", eng2d_list).
+00001600: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
+00001610: 7261 6d65 7472 697a 6528 226e 6f72 6d61  rametrize("norma
+00001620: 6c69 7a65 6422 2c20 5b46 616c 7365 2c20  lized", [False, 
+00001630: 5472 7565 5d29 0d0a 6465 6620 7465 7374  True])..def test
+00001640: 5f63 6f6d 6f6d 656e 7473 5f61 6c6c 5f6b  _comoments_all_k
+00001650: 6572 6e65 6c73 286b 6572 6e65 6c32 642c  ernels(kernel2d,
+00001660: 206e 6f72 6d61 6c69 7a65 6429 3a0d 0a20   normalized):.. 
+00001670: 2074 725f 6c65 6e2c 2063 6c5f 6c65 6e20   tr_len, cl_len 
+00001680: 3d20 332c 2031 0d0a 2020 6e30 2c20 6e31  = 3, 1..  n0, n1
+00001690: 203d 2037 3634 2c20 3938 300d 0a20 2074   = 764, 980..  t
+000016a0: 7261 6365 7330 203d 206e 702e 7261 6e64  races0 = np.rand
+000016b0: 6f6d 2e72 616e 6469 6e74 2830 2c20 3235  om.randint(0, 25
+000016c0: 362c 2028 6e30 2c20 7472 5f6c 656e 2929  6, (n0, tr_len))
+000016d0: 0d0a 2020 7472 6163 6573 3120 3d20 6e70  ..  traces1 = np
+000016e0: 2e72 616e 646f 6d2e 7261 6e64 696e 7428  .random.randint(
+000016f0: 302c 2032 3536 2c20 286e 312c 2074 725f  0, 256, (n1, tr_
+00001700: 6c65 6e29 290d 0a20 2065 6e67 203d 2073  len))..  eng = s
+00001710: 7461 746d 6f6d 656e 7473 2e42 6976 6172  tatmoments.Bivar
+00001720: 2874 725f 6c65 6e2c 2063 6c5f 6c65 6e2c  (tr_len, cl_len,
+00001730: 206b 6572 6e65 6c3d 6b65 726e 656c 3264   kernel=kernel2d
+00001740: 2c20 6d6f 6d65 6e74 3d34 2c20 6e6f 726d  , moment=4, norm
+00001750: 616c 697a 653d 6e6f 726d 616c 697a 6564  alize=normalized
+00001760: 290d 0a0d 0a20 2065 6e67 2e75 7064 6174  )....  eng.updat
+00001770: 6528 7472 6163 6573 302c 205b 2730 275d  e(traces0, ['0']
+00001780: 202a 206e 3029 0d0a 2020 656e 672e 7570   * n0)..  eng.up
+00001790: 6461 7465 2874 7261 6365 7331 2c20 5b27  date(traces1, ['
+000017a0: 3127 5d20 2a20 6e31 290d 0a0d 0a20 205f  1'] * n1)....  _
+000017b0: 656e 7375 7265 5f6d 6f6d 2865 6e67 2c20  ensure_mom(eng, 
+000017c0: 7472 6163 6573 302c 2074 7261 6365 7331  traces0, traces1
+000017d0: 2c20 6e6f 726d 616c 697a 6564 290d 0a20  , normalized).. 
+000017e0: 205f 656e 7375 7265 5f63 6f6d 6f6d 2865   _ensure_comom(e
+000017f0: 6e67 2c20 7472 6163 6573 302c 2074 7261  ng, traces0, tra
+00001800: 6365 7331 2c20 6e6f 726d 616c 697a 6564  ces1, normalized
+00001810: 290d 0a0d 0a0d 0a40 7079 7465 7374 2e66  )......@pytest.f
+00001820: 6978 7475 7265 0d0a 6465 6620 7472 6976  ixture..def triv
+00001830: 6961 6c5f 7472 6163 6573 2829 3a0d 0a20  ial_traces():.. 
+00001840: 2074 7261 6365 7330 203d 206e 702e 6172   traces0 = np.ar
+00001850: 7261 7928 5b0d 0a20 2020 2020 205b 322c  ray([..      [2,
+00001860: 2020 342c 2020 2035 5d2c 0d0a 2020 2020    4,   5],..    
+00001870: 2020 5b34 2c20 2036 2c20 202d 325d 2c0d    [4,  6,  -2],.
+00001880: 0a20 2020 2020 205b 372c 2020 332c 2020  .      [7,  3,  
+00001890: 2030 5d2c 0d0a 2020 2020 2020 5b38 2c20   0],..      [8, 
+000018a0: 2035 2c20 2020 315d 2c0d 0a20 2020 2020   5,   1],..     
+000018b0: 205b 322c 2020 372c 2020 2036 5d2c 0d0a   [2,  7,   6],..
+000018c0: 2020 2020 2020 5b39 2c20 2031 2c20 2020        [9,  1,   
+000018d0: 325d 2c0d 0a20 2020 2020 205b 342c 2020  2],..      [4,  
+000018e0: 382c 2020 2d34 5d2c 0d0a 2020 2020 2020  8,  -4],..      
+000018f0: 5b31 2c20 2032 2c20 2020 385d 2c0d 0a20  [1,  2,   8],.. 
+00001900: 205d 2c20 6474 7970 653d 6e70 2e69 6e74   ], dtype=np.int
+00001910: 3829 0d0a 2020 2320 7472 6163 6573 3020  8)..  # traces0 
+00001920: 3d20 6e70 2e72 616e 646f 6d2e 756e 6966  = np.random.unif
+00001930: 6f72 6d28 302c 2032 302c 2028 3530 2c20  orm(0, 20, (50, 
+00001940: 3130 2929 2e61 7374 7970 6528 6e70 2e69  10)).astype(np.i
+00001950: 6e74 3829 0d0a 2020 7472 6163 6573 3120  nt8)..  traces1 
+00001960: 3d20 2874 7261 6365 7330 202b 206e 702e  = (traces0 + np.
+00001970: 7369 6e28 7472 6163 6573 3029 202a 2033  sin(traces0) * 3
+00001980: 292e 6173 7479 7065 286e 702e 696e 7438  ).astype(np.int8
+00001990: 290d 0a20 2074 7261 6365 7330 5b3a 2c20  )..  traces0[:, 
+000019a0: 305d 203d 2028 3320 2a20 7472 6163 6573  0] = (3 * traces
+000019b0: 305b 3a2c 2031 5d20 2f20 3220 2b20 3230  0[:, 1] / 2 + 20
+000019c0: 292e 6173 7479 7065 286e 702e 696e 7438  ).astype(np.int8
+000019d0: 290d 0a20 2072 6574 7572 6e20 7472 6163  )..  return trac
+000019e0: 6573 302c 2074 7261 6365 7331 0d0a 0d0a  es0, traces1....
+000019f0: 0d0a 4070 7974 6573 742e 6d61 726b 2e70  ..@pytest.mark.p
+00001a00: 6172 616d 6574 7269 7a65 2822 6b65 726e  arametrize("kern
+00001a10: 656c 3264 222c 2065 6e67 3264 5f6c 6973  el2d", eng2d_lis
+00001a20: 7429 0d0a 6465 6620 7465 7374 5f74 7269  t)..def test_tri
+00001a30: 7669 616c 2874 7269 7669 616c 5f74 7261  vial(trivial_tra
+00001a40: 6365 732c 206b 6572 6e65 6c32 6429 3a0d  ces, kernel2d):.
+00001a50: 0a20 206d 2c20 636c 5f6c 656e 203d 2034  .  m, cl_len = 4
+00001a60: 2c20 310d 0a20 2074 7261 6365 7330 2c20  , 1..  traces0, 
+00001a70: 7472 6163 6573 3120 3d20 7472 6976 6961  traces1 = trivia
+00001a80: 6c5f 7472 6163 6573 0d0a 0d0a 2020 616c  l_traces....  al
+00001a90: 6c5f 7472 6163 6573 203d 206e 702e 7673  l_traces = np.vs
+00001aa0: 7461 636b 2828 7472 6163 6573 302c 2074  tack((traces0, t
+00001ab0: 7261 6365 7331 2929 0d0a 2020 7472 5f63  races1))..  tr_c
+00001ac0: 6f75 6e74 2c20 7472 5f6c 656e 203d 2061  ount, tr_len = a
+00001ad0: 6c6c 5f74 7261 6365 732e 7368 6170 650d  ll_traces.shape.
+00001ae0: 0a20 2061 6c6c 5f63 6c73 203d 206e 702e  .  all_cls = np.
+00001af0: 7a65 726f 7328 2874 725f 636f 756e 742c  zeros((tr_count,
+00001b00: 2063 6c5f 6c65 6e29 2c20 6474 7970 653d   cl_len), dtype=
+00001b10: 6e70 2e75 696e 7438 290d 0a20 2061 6c6c  np.uint8)..  all
+00001b20: 5f63 6c73 5b6c 656e 2874 7261 6365 7330  _cls[len(traces0
+00001b30: 293a 5d20 3d20 310d 0a0d 0a20 2065 6e67  ):] = 1....  eng
+00001b40: 203d 2073 7461 746d 6f6d 656e 7473 2e42   = statmoments.B
+00001b50: 6976 6172 2874 725f 6c65 6e2c 2063 6c5f  ivar(tr_len, cl_
+00001b60: 6c65 6e2c 206d 2c20 6b65 726e 656c 3d6b  len, m, kernel=k
+00001b70: 6572 6e65 6c32 642c 2061 6363 5f6d 696e  ernel2d, acc_min
+00001b80: 5f63 6f75 6e74 3d33 290d 0a0d 0a20 2023  _count=3)....  #
+00001b90: 206d 656d 3130 203d 2073 7461 746d 6f6d   mem10 = statmom
+00001ba0: 656e 7473 2e62 6976 6172 5f73 756d 2e65  ents.bivar_sum.e
+00001bb0: 7374 696d 6174 655f 6d65 6d5f 7369 7a65  stimate_mem_size
+00001bc0: 2861 6c6c 5f74 7261 6365 732e 7368 6170  (all_traces.shap
+00001bd0: 655b 315d 2c20 2020 2020 636c 5f6c 656e  e[1],     cl_len
+00001be0: 2c20 6d29 0d0a 2020 2320 6d65 6d31 3120  , m)..  # mem11 
+00001bf0: 3d20 7374 6174 6d6f 6d65 6e74 732e 6269  = statmoments.bi
+00001c00: 7661 725f 7375 6d5f 6d69 782e 6573 7469  var_sum_mix.esti
+00001c10: 6d61 7465 5f6d 656d 5f73 697a 6528 616c  mate_mem_size(al
+00001c20: 6c5f 7472 6163 6573 2e73 6861 7065 5b31  l_traces.shape[1
+00001c30: 5d2c 2063 6c5f 6c65 6e2c 206d 290d 0a20  ], cl_len, m).. 
+00001c40: 2023 206d 656d 3132 203d 2073 7461 746d   # mem12 = statm
+00001c50: 6f6d 656e 7473 2e62 6976 6172 5f32 7061  oments.bivar_2pa
+00001c60: 7373 2e65 7374 696d 6174 655f 6d65 6d5f  ss.estimate_mem_
+00001c70: 7369 7a65 2861 6c6c 5f74 7261 6365 732e  size(all_traces.
+00001c80: 7368 6170 655b 315d 2c20 2020 636c 5f6c  shape[1],   cl_l
+00001c90: 656e 2c20 6d29 0d0a 2020 2320 6d65 6d31  en, m)..  # mem1
+00001ca0: 3320 3d20 7374 6174 6d6f 6d65 6e74 732e  3 = statmoments.
+00001cb0: 6269 7661 725f 7478 7462 6b2e 6573 7469  bivar_txtbk.esti
+00001cc0: 6d61 7465 5f6d 656d 5f73 697a 6528 616c  mate_mem_size(al
+00001cd0: 6c5f 7472 6163 6573 2e73 6861 7065 5b31  l_traces.shape[1
+00001ce0: 5d2c 2020 2063 6c5f 6c65 6e2c 206d 290d  ],   cl_len, m).
+00001cf0: 0a0d 0a20 2023 2050 6173 7320 6f6e 6520  ...  # Pass one 
+00001d00: 6261 7463 6820 6166 7465 7220 616e 6f74  batch after anot
+00001d10: 6865 720d 0a20 2023 2065 6e67 2e75 7064  her..  # eng.upd
+00001d20: 6174 6528 616c 6c5f 7472 6163 6573 5b3a  ate(all_traces[:
+00001d30: 365d 2c20 616c 6c5f 636c 735b 3a36 5d29  6], all_cls[:6])
+00001d40: 0d0a 2020 2320 656e 672e 7570 6461 7465  ..  # eng.update
+00001d50: 2861 6c6c 5f74 7261 6365 735b 363a 5d2c  (all_traces[6:],
+00001d60: 2061 6c6c 5f63 6c73 5b36 3a5d 290d 0a20   all_cls[6:]).. 
+00001d70: 2065 6e67 2e75 7064 6174 6528 616c 6c5f   eng.update(all_
+00001d80: 7472 6163 6573 2c20 616c 6c5f 636c 7329  traces, all_cls)
+00001d90: 2020 2320 5654 4b20 6361 6e6e 6f74 206c    # VTK cannot l
+00001da0: 6561 726e 2073 7472 6561 6d69 6e67 6c79  earn streamingly
+00001db0: 0d0a 0d0a 2020 5f65 6e73 7572 655f 6d6f  ....  _ensure_mo
+00001dc0: 6d28 656e 672c 2074 7261 6365 7330 2c20  m(eng, traces0, 
+00001dd0: 7472 6163 6573 3129 0d0a 2020 5f65 6e73  traces1)..  _ens
+00001de0: 7572 655f 636f 6d6f 6d28 656e 672c 2074  ure_comom(eng, t
+00001df0: 7261 6365 7330 2c20 7472 6163 6573 3129  races0, traces1)
+00001e00: 0d0a 0d0a 2020 2320 6d65 6d30 3020 3d20  ....  # mem00 = 
+00001e10: 656e 6769 6e65 735b 305d 2e6d 656d 6f72  engines[0].memor
+00001e20: 795f 7369 7a65 2020 2320 7375 6d0d 0a20  y_size  # sum.. 
+00001e30: 2023 206d 656d 3031 203d 2065 6e67 696e   # mem01 = engin
+00001e40: 6573 5b31 5d2e 6d65 6d6f 7279 5f73 697a  es[1].memory_siz
+00001e50: 6520 2023 2032 7061 7373 206d 6620 6d75  e  # 2pass mf mu
+00001e60: 6c0d 0a20 2023 206d 656d 3032 203d 2065  l..  # mem02 = e
+00001e70: 6e67 696e 6573 5b32 5d2e 6d65 6d6f 7279  ngines[2].memory
+00001e80: 5f73 697a 6520 2023 2074 7874 626b 0d0a  _size  # txtbk..
+00001e90: 0d0a 0d0a 2320 456e 7472 616e 6365 2070  ....# Entrance p
+00001ea0: 6f69 6e74 0d0a 6966 205f 5f6e 616d 655f  oint..if __name_
+00001eb0: 5f20 3d3d 2027 5f5f 6d61 696e 5f5f 273a  _ == '__main__':
+00001ec0: 0d0a 2020 7079 7465 7374 2e6d 6169 6e28  ..  pytest.main(
+00001ed0: 5b22 2d76 222c 205f 5f66 696c 655f 5f20  ["-v", __file__ 
+00001ee0: 2b20 223a 3a74 6573 745f 696e 6974 225d  + "::test_init"]
+00001ef0: 290d 0a                                  )..
```

### Comparing `statmoments-1.0.4/statmoments/tests/test_stattest.py` & `statmoments-1.0.5/statmoments/tests/test_stattest.py`

 * *Files 22% similar despite different names*

```diff
@@ -1,59 +1,46 @@
-import unittest
+import pytest
+
 import functools
 from itertools import combinations_with_replacement as _combu
 
 import numpy as np
 import numpy.testing as nt
 from numpy.random import normal as _rand
 
-from scipy.stats import ttest_ind
-from scipy.stats import skew, kurtosis
+from scipy.stats import ttest_ind, skew, kurtosis, moment
 
 import statmoments
 from statmoments._statmoments_impl import meanfree, triu_flatten, uni2bivar
 
 
-def all_engines_tt(tr_len, cl_len, moment=2, **kwargs):
-  return [
-      statmoments.Bivar(tr_len, cl_len, kernel=statmoments.bivar_sum,         moment=moment, **kwargs),
-      statmoments.Bivar(tr_len, cl_len, kernel=statmoments.bivar_cntr,        moment=moment, **kwargs),
-      statmoments.Bivar(tr_len, cl_len, kernel=statmoments.bivar_txtbk,       moment=moment, **kwargs),
-      statmoments.Bivar(tr_len, cl_len, kernel=statmoments.bivar_2pass,       moment=moment, **kwargs),
-      statmoments.Bivar(tr_len, cl_len, kernel=statmoments.bivar_sum_detrend, moment=moment, **kwargs),
-  ]
-
-
-def all_engines_tt_1d(tr_len, cl_len, moment=2, **kwargs):
-  return [
-      statmoments.Univar(tr_len, cl_len, kernel=statmoments.univar_sum,          moment=moment, **kwargs),
-      statmoments.Univar(tr_len, cl_len, kernel=statmoments.univar_sum_detrend,  moment=moment, **kwargs),
-  ]
-
-
 def mom_3pass(data, k, normalize=False):
   """ Central moments, 3 pass """
   kwargs = {'axis': 0}
   if k == 1:
     x = data
   else:
     x = meanfree(data)
     if k >= 3 and normalize:
       x = x / np.std(data, **kwargs)
     x = x ** k
   return np.mean(x, **kwargs)
 
 
-def mom_libs(data, k):
+def mom_libs(data, k, normalize=False):
   """ Central moments, numpy and scipy """
-  kwargs = {'axis': 0}
-  # First 4 moments, with sigma-normalized skewness and kurtosis
+  # First 5 moments, with sigma-normalized skewness, kurtosis and 5th
   kurtosis_pearson = lambda x, **a: kurtosis(x, fisher=False, **a)  # noqa: E731
+  stat_moment = lambda x, **a: moment(x, moment=k, **a) / np.std(data, **a)**k  # noqa: E731
   mom_funcs = [np.sum, np.mean, np.var, skew, kurtosis_pearson]
-  return mom_funcs[k](data, **kwargs)
+  mom_funcs += [stat_moment] * 4
+
+  mom_res = mom_funcs[k](data, axis=0)
+
+  return mom_res if k < 3 or normalize else mom_res * np.std(data, axis=0) ** k
 
 
 def mom_sums(data, mom, normalize=False):
   """ Central moments, by definition """
   kwargs = {'axis': 0}
   data_mean = np.mean(data, **kwargs)
   if mom == 1:
@@ -66,395 +53,383 @@
 
 
 def wttest(tr0, tr1):
   """ t-test shortcut """
   return ttest_ind(tr0, tr1, equal_var=False).statistic
 
 
-def find_maxtt(traces_gen, engines, iter_cnt=10):
+def find_maxtt(traces_gen, eng, iter_cnt=10):
   traces = np.vstack(traces_gen())
   classifiers = ['0'] * (len(traces) // 2) + ['1'] * (len(traces) // 2)
 
   for _ in range(iter_cnt):
       traces = np.vstack(list(traces_gen()))
-      for e2d in engines:
-          e2d.update(traces, classifiers)
+      eng.update(traces, classifiers)
 
-  res = [np.nanmax(np.abs(np.vstack([tt.copy() for e2d in engines for tt in statmoments.stattests.ttests(e2d)])), axis=1)]
-  return res
+  act_tt = [tt.copy() for tt in statmoments.stattests.ttests(eng)]
+  return [np.nanmax(np.abs(np.vstack(act_tt)), axis=1)]
 
 
-def ensure_ttest_1d(engines, traces0, traces1):
+def ensure_ttest_1d(eng, traces0, traces1):
   n0, n1 = len(traces0), len(traces1)
 
-  for eng in engines:
-    # Test scalar
-    nt.assert_equal(eng.total_count, n0 + n1)
-
-    # Test 1D
-    max_moment = eng.moment // 2
-
-    # t-test order 1
-    exp_tt = wttest(traces0, traces1)
-    act_tt = next(statmoments.stattests.ttests(eng, moment=1, dim=1)).copy()
-    nt.assert_allclose(act_tt, exp_tt)
-
-    if max_moment < 2:
-      return
-
-    # t-test order 2
-    exp_tt = wttest(meanfree(traces0)**2, meanfree(traces1)**2)
-    act_tt = next(statmoments.stattests.ttests(eng, moment=2, dim=1)).copy()
-    nt.assert_allclose(act_tt, exp_tt)
-
-    if max_moment < 3:
-      return
-
-    # t-test orders 3 and higher
-    for m in range(3, max_moment+1):
-      trstd0 = (meanfree(traces0) / np.std(traces0, axis=0))**m
-      trstd1 = (meanfree(traces1) / np.std(traces1, axis=0))**m
-      exp_tt = wttest(trstd0, trstd1)
-      act_tt = next(statmoments.stattests.ttests(eng, moment=m, dim=1)).copy()
-      nt.assert_allclose(act_tt, exp_tt)
+  # Test scalar
+  nt.assert_equal(eng.total_count, n0 + n1)
 
+  # Test 1D
+  max_ttmoment = eng.moment // 2
 
-def ensure_ttest_2d(engines, traces0, traces1):
+  # t-test order 1
+  exp_tt = wttest(traces0, traces1)
+  act_tt = [tt.copy() for tt in statmoments.stattests.ttests(eng, moment=1, dim=1)]
+  nt.assert_allclose(exp_tt, act_tt[0])
+  nt.assert_allclose(-1 * exp_tt, act_tt[1])
+
+  if max_ttmoment < 2:
+    return
+
+  # t-test order 2
+  exp_tt = wttest(meanfree(traces0)**2, meanfree(traces1)**2)
+  act_tt = [tt.copy() for tt in statmoments.stattests.ttests(eng, moment=2, dim=1)]
+  nt.assert_allclose(exp_tt, act_tt[0])
+  nt.assert_allclose(-1 * exp_tt, act_tt[1])
+
+  if max_ttmoment < 3:
+    return
+
+  # t-test orders 3 and higher
+  for m in range(3, max_ttmoment + 1):
+    trstd0 = (meanfree(traces0) / np.std(traces0, axis=0))**m
+    trstd1 = (meanfree(traces1) / np.std(traces1, axis=0))**m
+    exp_tt = wttest(trstd0, trstd1)
+    act_tt = [tt.copy() for tt in statmoments.stattests.ttests(eng, moment=m, dim=1)]
+    nt.assert_almost_equal(exp_tt, act_tt[0], decimal=5)
+    nt.assert_almost_equal(-1 * exp_tt, act_tt[1], decimal=5)
+
+
+def ensure_ttest_2d(eng, traces0, traces1):
   n0, n1 = len(traces0), len(traces1)
 
-  for eng in engines:
-    # Test scalar
-    nt.assert_equal(eng.total_count, n0 + n1)
-
-    # Test 2D
-    max_moment = eng.moment // 2
-    for mm in _combu(range(1, max_moment + 1), r=2):
-      ett = [wttest(uni2bivar(traces0, *mm), uni2bivar(traces1, *mm))]
-      att = [_tt.copy() for _tt in statmoments.stattests.ttests(eng, moment=mm)]
-      nt.assert_allclose(att, ett, err_msg='Error in ttest order {}'.format(mm))
-      if np.sum(mm) >= 3:
-        ettnorm = [wttest(uni2bivar(traces0, *mm), uni2bivar(traces1, *mm))]
-        nt.assert_almost_equal(att, ettnorm, err_msg='Error in normalized ttest order {}'.format(mm))
-
-
-class Test_moms(unittest.TestCase):
-  def test_trivial(self):
-    traces0 = np.array([
-        [2,  4,  5],
-        [4,  6,  7],
-        [3,  3,  9],
-        [9,  7,  6],
-        [2,  5,  3],
-        [9,  1,  8],
-        [7,  8,  4],
-        [4,  2,  0],
-    ], dtype=np.uint8)
-
-    for i in [1, 2, 3, 4]:
-      mm = [mom_3pass(traces0, i, True), mom_libs(traces0, i), mom_sums(traces0, i, True)]
-      test_all = functools.partial(nt.assert_almost_equal, mm[0])
-      list(map(test_all, mm))
-
-
-class Test_stat(unittest.TestCase):
-  def test_init1(self):
-    engine = statmoments.Univar(10, 16, 2)
-
-    self.assertEqual(engine.total_count, 0)
-
-    att = [tt.copy() for tt in statmoments.stattests.ttests(engine)]
-    self.assertEqual(np.max(np.abs(att)), 0)
-    self.assertEqual(len(att), 16)
-
-  def test_init2(self):
-    engine = statmoments.Bivar(10, 16, 2)
-
-    self.assertEqual(engine.total_count, 0)
-
-    att = [tt.copy() for tt in statmoments.stattests.ttests(engine)]
-    self.assertEqual(np.max(np.abs(att)), 0)
-    self.assertEqual(len(att), 16)
-
-  def test_ttest_1d(self):
-    max_moment = 8
-    tr_len, cl_len = 5, 1
-    n0, n1 = 987, 1234
-    traces0 = np.random.randint(0, 256, (n0, tr_len))
-    # Insert different distribution into some points of one batch
-    traces0[:, 2:4] = np.random.normal(35, 10, (n0, 2)).astype(traces0.dtype)
-    traces1 = np.random.randint(0, 256, (n1, tr_len))
-    engines = all_engines_tt_1d(tr_len, cl_len, moment=max_moment)
-
-    for eng in engines:
-      eng.update(traces0, ['0'] * n0)
-      eng.update(traces1, ['1'] * n1)
-
-    ensure_ttest_1d(engines, traces0, traces1)
-
-    # Ensure t-test finds stat diff
-    for eng in engines:
-      # Find different means
-      for tt1 in statmoments.stattests.ttests(eng, moment=1):
-        nt.assert_array_less(np.abs(tt1[0:2]), 3)
-        self.assertTrue(np.all(np.abs(tt1[2:4]) > 40))
-      # Find different vars
-      for tt2 in statmoments.stattests.ttests(eng, moment=2):
-        nt.assert_array_less(np.abs(tt2[0:2]), 3)
-        self.assertTrue(np.all(np.abs(tt2[2:4]) > 30))
-      # Find no different skews
-      for tt3 in statmoments.stattests.ttests(eng, moment=3):
-        nt.assert_array_less(np.abs(tt3), 2)
-      # Find different kurtoses
-      for tt4 in statmoments.stattests.ttests(eng, moment=4):
-        nt.assert_array_less(np.abs(tt4[0:2]), 3)
-        self.assertTrue(np.all(np.abs(tt4[2:4]) > 2.5))
-
-  def test_ttest_2d(self):
-    max_moment = 4
-    tr_len, cl_len = 4, 1
-    n0, n1 = 987, 1234
-    traces0 = np.random.randint(0, 256, (n0, tr_len))
-    traces1 = np.random.randint(0, 256, (n1, tr_len))
-    # Insert co-dependence to some point of one batch
-    traces0[:, 2] = (3 * traces0[:, 3] / 2 + 20)
-    engines = all_engines_tt(tr_len, cl_len, moment=max_moment)
-
-    for eng in engines:
-      eng.update(traces0, ['0'] * n0)
-      eng.update(traces1, ['1'] * n1)
-
-    # Ensure the highest results for all engines are equal
-    tt2d = [next(statmoments.stattests.ttests(eng)).copy() for eng in engines]
-    test_all = functools.partial(nt.assert_allclose, tt2d[0])
-    list(map(test_all, tt2d))
-
-    ensure_ttest_1d(engines, traces0, traces1)
-    ensure_ttest_2d(engines, traces0, traces1)
-
-    # Ensure t-test finds the inserted correlation
-    for eng in engines:
-      # Find different covars
-      for tt2 in statmoments.stattests.ttests(eng, moment=(1, 1)):
-        nt.assert_array_less(np.abs(tt2[0:7]), 3)
-        self.assertTrue(np.all(np.abs(tt2[7:9]) > 15))
-      # Find no different co-skews
-      for tt3 in statmoments.stattests.ttests(eng, moment=(1, 2)):
-        nt.assert_array_less(np.abs(tt3), 3)
-      # Find different co-kurtoses
-      for tt4 in statmoments.stattests.ttests(eng, moment=(2, 2)):
-        nt.assert_array_less(np.abs(tt4[0:8]), 2)
-        self.assertTrue(np.all(np.abs(tt2[8]) > 6))
-
-  def test_mean_neg(self):
-    # different mean, same variance
-    cl_len = 1
-    m0, m1 = -3.0, 3.0
-    tr_len, tr_cnt = 5, 10
-    traces_gen = lambda: [_rand(loc=m0, size=(tr_cnt, tr_len)), _rand(loc=m1, size=(tr_cnt, tr_len))]  # noqa: E731
-    engines = all_engines_tt(tr_len, cl_len)
-
-    maxsd = find_maxtt(traces_gen, engines)
-    nt.assert_array_less(maxsd, 5)
-
-  def test_same_moms_neg(self):
-    # same mean, same variance
-    cl_len = 1
-    s0, s1 = 2.0, 6.0  # noqa: F841 s1 not used
-    tr_len, tr_cnt = 5, 10
-    traces_gen = lambda: [_rand(scale=s0, size=(tr_cnt, tr_len)), _rand(scale=s0, size=(tr_cnt, tr_len))]  # noqa: E731
-    engines = all_engines_tt(tr_len, cl_len)
-
-    maxsd = find_maxtt(traces_gen, engines)
-    nt.assert_array_less(maxsd, 5)
-
-  def test_2d_pos(self):
-    cl_len = 1
-    m0, m1 = -3.0, 3.0
-    tr_len, tr_cnt = 5, 100
-    _rand = np.random.normal
-    traces_gen1 = lambda: [_rand(loc=m0, size=(tr_cnt, tr_len)), _rand(loc=m1, size=(tr_cnt, tr_len))]  # noqa: E731
-
-    def traces_gen_corr():
-      rnorm = traces_gen1()
-      rnorm[1][:, 1] += rnorm[1][:, 0]
-      return rnorm
-
-    engines = all_engines_tt(tr_len, cl_len)
-
-    maxsd = find_maxtt(traces_gen_corr, engines)
-    nt.assert_array_less(5, maxsd)
-
-    test_all = functools.partial(nt.assert_allclose, maxsd[0])
-    list(map(test_all, maxsd))
-
-  def test_nist(self):
-    # ttest from https://www.itl.nist.gov/div898/handbook/eda/section3/eda353.htm
-    # data  from https://www.itl.nist.gov/div898/handbook/eda/section3/eda3531.htm
-
-    traces = [
-        np.array([18,15,18,16,17,15,14,14,14,15,15,14,15,14,22,18,21,21,10,10,11,9,28,25,19,16,17,19,18,14,14,14,14,12,13,13,18,22,19,18,23,26,25,20,21,13,14,15,14,17,11,13,12,13,15,13,13,14,22,28,13,14,13,14,15,12,13,13,14,13,12,13,18,16,18,18,23,11,12,13,12,18,21,19,21,15,16,15,11,20,21,19,15,26,25,16,16,18,16,13,14,14,14,28,19,18,15,15,16,15,16,14,17,16,15,18,21,20,13,23,20,23,18,19,25,26,18,16,16,15,22,22,24,23,29,25,20,18,19,18,27,13,17,13,13,13,30,26,18,17,16,15,18,21,19,19,16,16,16,16,25,26,31,34,36,20,19,20,19,21,20,25,21,19,21,21,19,18,19,18,18,18,30,31,23,24,22,20,22,20,21,17,18,17,18,17,16,19,19,36,27,23,24,34,35,28,29,27,34,32,28,26,24,19,28,24,27,27,26,24,30,39,35,34,30,22,27,20,18,28,27,34,31,29,27,24,23,38,36,25,38,26,22,36,27,27,32,28,31])[:, np.newaxis],  # noqa: E231,E501
-        np.array([24,27,27,25,31,35,24,19,28,23,27,20,22,18,20,31,32,31,32,24,26,29,24,24,33,33,32,28,19,32,34,26,30,22,22,33,39,36,28,27,21,24,30,34,32,38,37,30,31,37,32,47,41,45,34,33,24,32,39,35,32,37,38,34,34,32,33,32,25,24,37,31,36,36,34,38,32,38,32])[:, np.newaxis],  # noqa: E231,E501
-    ]
-
-    engines = all_engines_tt_1d(1, 2)
-
-    for eng in engines:
-      eng.update(traces[0], [[0, 1]] * len(traces[0]))
-      eng.update(traces[1], [[1, 0]] * len(traces[1]))
-
-      nt.assert_equal(list(eng.counts(0)), [249, 79])
-      nt.assert_equal(list(eng.counts(1)), [79, 249])
-
-      # Request both moments at once for both classifiers
-      allmoms = [m.copy() for m in eng.moments((1, 2))]
-
-      # Ensure means
-      classifier, moment, rvar = 0, 0, 0
-      nt.assert_allclose(allmoms[classifier][:, moment][:, rvar], [20.14458, 30.48101])
-      classifier, moment, rvar = 1, 0, 0
-      nt.assert_allclose(allmoms[classifier][:, moment][:, rvar], [30.48101, 20.14458])
-
-      # Ensure standard deviations
-      classifier, moment, rvar = 0, 1, 0
-      nc = np.array(eng.counts(classifier))
-      sd = np.sqrt(allmoms[classifier][:, moment][:, rvar] * nc / (nc - 1))
-      nt.assert_almost_equal(sd, [6.41470, 6.10771], decimal=5)
-
-      classifier, moment, rvar = 1, 1, 0
-      nc = np.array(eng.counts(classifier))
-      sd = np.sqrt(allmoms[classifier][:, moment][:, rvar] * nc / (nc - 1))
-      nt.assert_almost_equal(sd, [6.10771, 6.41470], decimal=5)
-
-      # Ensure t-test
-      exptt_eq = ttest_ind(traces[0], traces[1], equal_var=True).statistic           # NIST
-      alltt_eq = [m.copy() for m in statmoments.stattests.ttests(eng, equal_var=True)]
-      nt.assert_almost_equal(exptt_eq, -12.62059, decimal=5)
-      nt.assert_almost_equal(alltt_eq, [[-12.62059], [12.62059]], decimal=5)
-
-      alltt_ne = [m.copy() for m in statmoments.stattests.ttests(eng, equal_var=False)]  # Welch
-      exptt_ne = ttest_ind(traces[0], traces[1], equal_var=False).statistic
-      nt.assert_almost_equal(exptt_ne, -12.94627, decimal=5)
-      nt.assert_almost_equal(alltt_ne, [[-12.94627], [12.94627]], decimal=5)
-
-  def test_trivial_1d(self):
-    m, cl_len = 8, 1
-    traces0 = np.array([
-        [2,  4,  5],
-        [4,  6,  7],
-        [3,  3,  9],
-        [9,  7,  6],
-        [2,  5,  3],
-        [9,  1,  8],
-        [7,  8,  4],
-        [4,  2,  0],
-    ], dtype=np.uint8)
-    # traces0 = np.random.uniform(0, 20, (50, 10)).astype(np.uint8)
-    traces1 = (traces0 + np.sin(traces0) * 3).astype(np.uint8)
-
-    n0, n1 = len(traces0), len(traces1)
-
-    engines = [statmoments.Univar(len(traces0[0]), cl_len, kernel=statmoments.univar_sum, moment=m, acc_min_count=3)]
-    for eng in engines:
-      eng.update(traces0, ['0'] * n0)
-      eng.update(traces1, ['1'] * n1)
-
-    # tt 1 ord
-    i = 1
-    tt_act = [next(statmoments.stattests.ttests(eng, moment=i)).copy() for eng in engines]
-
-    tt_exp = wttest(traces0, traces1)
-
-    test_all = functools.partial(nt.assert_almost_equal, tt_exp)
-    list(map(test_all, tt_act))
-
-    # tt 2 ord
-    i = 2
-    tt_act = [next(statmoments.stattests.ttests(eng, moment=i)).copy() for eng in engines]
-
-    mm2 = mom_3pass(traces0, i), mom_3pass(traces1, i)
-    mm4 = mom_3pass(traces0, 2 * i), mom_3pass(traces1, 2 * i)
-    mm4[0][:] = mm4[0] - mm2[0] ** 2
-    mm4[1][:] = mm4[1] - mm2[1] ** 2
-    tt_exp1 = (mm2[0] - mm2[1]) / np.sqrt(mm4[0] / (n0 - 1) + mm4[1] / (n1 - 1))
+  # Test scalar
+  nt.assert_equal(eng.total_count, n0 + n1)
 
-    mf_traces = [meanfree(traces0), meanfree(traces1)]
-    tt_exp2 = wttest(mf_traces[0] ** 2, mf_traces[1] ** 2)
+  # Test 2D
+  max_moment = eng.moment // 2
+  for mm in _combu(range(1, max_moment + 1), r=2):
+    ett = wttest(uni2bivar(traces0, *mm), uni2bivar(traces1, *mm))
+    att = [_tt.copy() for _tt in statmoments.stattests.ttests(eng, moment=mm)]
+    nt.assert_allclose(att[0], ett, err_msg=f'Error in ttest order {mm}')
+    nt.assert_allclose(att[1], -1 * ett, err_msg=f'Error in ttest order {mm}')
+    if np.sum(mm) >= 3:
+      ettnorm = wttest(uni2bivar(traces0, *mm), uni2bivar(traces1, *mm))
+      nt.assert_almost_equal(att[0], ettnorm, err_msg=f'Error in normalized ttest order {mm}')
+      nt.assert_almost_equal(att[1], -1 * ettnorm, err_msg=f'Error in normalized ttest order {mm}')
+
+
+eng2d_list = [
+    statmoments.bivar_2pass,
+    statmoments.bivar_txtbk,
+    statmoments.bivar_sum,
+    statmoments.bivar_cntr,
+    statmoments.bivar_sum_detrend
+]
+
+eng1d_list = [
+    statmoments.univar_sum,
+    statmoments.univar_sum_detrend
+]
+
+
+@pytest.mark.parametrize("kernel1d", eng1d_list)
+def test_init1(kernel1d):
+  engine = statmoments.Univar(10, 16, 2, kernel=kernel1d)
+
+  assert engine.total_count == 0
+
+  att = [tt.copy() for tt in statmoments.stattests.ttests(engine)]
+  assert np.max(np.abs(att)) == 0
+  assert len(att) == 16
+
+
+@pytest.mark.parametrize("kernel2d", eng2d_list)
+def test_init2(kernel2d):
+  engine = statmoments.Bivar(10, 16, 2, kernel=kernel2d)
+
+  assert engine.total_count == 0
+
+  # TODO: Fix this
+  # att = [tt.copy() for tt in statmoments.stattests.ttests(engine)]
+  # assert np.max(np.abs(att)) == 0
+  # assert len(att) == 16
+
+
+@pytest.mark.parametrize("kernel1d", eng1d_list)
+def test_ttest_1d(kernel1d):
+  max_moment = 4
+  tr_len, cl_len = 5, 2
+  n0, n1 = 987, 1234
+  traces0 = np.random.randint(0, 256, (n0, tr_len))
+  # Insert different distribution into some points of one batch
+  traces0[:, 2:4] = np.random.normal(30, 7, (n0, 2)).astype(traces0.dtype)
+  traces1 = np.random.randint(0, 256, (n1, tr_len))
+  eng = statmoments.Univar(tr_len, cl_len, moment=2 * max_moment, kernel=kernel1d)
+
+  eng.update(traces0, ['01'] * n0)
+  eng.update(traces1, [[1, 0]] * n1)
+
+  ensure_ttest_1d(eng, traces0, traces1)
+
+  # Ensure t-test finds stat diff
+  # Find different means
+  for tt1 in statmoments.stattests.ttests(eng, moment=1):
+    nt.assert_array_less(np.abs(tt1[0:2]), 3)
+    assert np.all(np.abs(tt1[2:4]) > 30)
+  # Find different vars
+  for tt2 in statmoments.stattests.ttests(eng, moment=2):
+    nt.assert_array_less(np.abs(tt2[0:2]), 3)
+    assert np.all(np.abs(tt2[2:4]) > 30)
+  # Find no different skews
+  for tt3 in statmoments.stattests.ttests(eng, moment=3):
+    nt.assert_array_less(np.abs(tt3), 2.5)
+  # Find different kurtoses
+  for tt4 in statmoments.stattests.ttests(eng, moment=4):
+    nt.assert_array_less(np.abs(tt4[0:2]), 3)
+    assert np.all(np.abs(tt4[2:4]) > 2.5)
+
+
+@pytest.mark.parametrize("kernel2d", eng2d_list)
+def test_ttest_2d(kernel2d):
+  max_moment = 4
+  tr_len, cl_len = 4, 2
+  n0, n1 = 987, 1234
+  traces0 = np.random.randint(0, 256, (n0, tr_len))
+  traces1 = np.random.randint(0, 256, (n1, tr_len))
+  # Insert co-dependence to some point of one batch
+  traces0[:, 2] = (3 * traces0[:, 3] / 2 + 20)
+  eng = statmoments.Bivar(tr_len, cl_len, moment=max_moment, kernel=kernel2d)
+
+  eng.update(traces0, [[0, 1]] * n0)
+  eng.update(traces1, ['10'] * n1)
+
+  ensure_ttest_1d(eng, traces0, traces1)
+  ensure_ttest_2d(eng, traces0, traces1)
+
+  # Ensure t-test finds the inserted correlation
+  # Find different covars
+  for tt2 in statmoments.stattests.ttests(eng, moment=(1, 1)):
+    nt.assert_array_less(np.abs(tt2[0:7]), 3.2)
+    nt.assert_array_less(15, np.abs(tt2[7:9]))
+  # Find no different co-skews
+  for tt3 in statmoments.stattests.ttests(eng, moment=(1, 2)):
+    nt.assert_array_less(np.abs(tt3), 3.2)
+  # Find different co-kurtoses
+  for tt4 in statmoments.stattests.ttests(eng, moment=(2, 2)):
+    nt.assert_array_less(np.abs(tt4[0:8]), 2.3)
+    nt.assert_array_less(6, np.abs(tt2[8]))
+
+
+@pytest.mark.parametrize("kernel2d", eng2d_list)
+def test_mean_neg(kernel2d):
+  # different mean, same variance
+  cl_len = 1
+  m0, m1 = -4.0, 4.0
+  tr_len, tr_cnt = 5, 31
+  traces_gen = lambda: [_rand(loc=m0, size=(tr_cnt, tr_len)), _rand(loc=m1, size=(tr_cnt, tr_len))]  # noqa: E731
+  eng = statmoments.Bivar(tr_len, cl_len, kernel=kernel2d)
+
+  maxsd = find_maxtt(traces_gen, eng)
+  nt.assert_array_less(maxsd, 5)
+
+
+@pytest.mark.parametrize("kernel2d", eng2d_list)
+def test_same_moms_neg(kernel2d):
+  # same mean, same variance
+  cl_len = 1
+  s0, s1 = 2.0, 6.0  # noqa: F841 s1 not used
+  tr_len, tr_cnt = 5, 53
+  traces_gen = lambda: [_rand(scale=s0, size=(tr_cnt, tr_len)), _rand(scale=s0, size=(tr_cnt, tr_len))]  # noqa: E731
+  eng = statmoments.Bivar(tr_len, cl_len, kernel=kernel2d)
+
+  maxsd = find_maxtt(traces_gen, eng)
+  nt.assert_array_less(maxsd, 5)
+
+
+@pytest.mark.parametrize("kernel2d", eng2d_list)
+def test_2d_pos(kernel2d):
+  cl_len = 1
+  m0, m1 = -3.0, 3.0
+  tr_len, tr_cnt = 5, 101
+  _rand = np.random.normal
+  traces_gen1 = lambda: [_rand(loc=m0, size=(tr_cnt, tr_len)), _rand(loc=m1, size=(tr_cnt, tr_len))]  # noqa: E731
+
+  def traces_gen_corr():
+    rnorm = traces_gen1()
+    rnorm[1][:, 1] += rnorm[1][:, 0]
+    return rnorm
+
+  eng = statmoments.Bivar(tr_len, cl_len, kernel=kernel2d)
+
+  maxsd = find_maxtt(traces_gen_corr, eng)
+  nt.assert_array_less(5, maxsd)
+
+  test_all = functools.partial(nt.assert_allclose, maxsd[0])
+  list(map(test_all, maxsd))
+
+
+@pytest.fixture
+def trivial_traces():
+  traces0 = np.array([
+      [2,  4,   5],
+      [4,  6,  -2],
+      [7,  3,   0],
+      [8,  5,   1],
+      [2,  7,   6],
+      [9,  1,   2],
+      [4,  8,  -4],
+      [1,  2,   8],
+  ], dtype=np.int8)
+  # traces0 = np.random.uniform(0, 20, (50, 10)).astype(np.int8)
+  traces1 = (traces0 + np.sin(traces0) * 3).astype(np.int8)
+  return traces0, traces1
+
+
+@pytest.mark.parametrize("mom", [1, 2, 3, 4, 5])
+@pytest.mark.parametrize("normalized", [True, False])
+def test_moments(trivial_traces, mom, normalized):
+  for traces in trivial_traces:
+    cm = [mom_3pass(traces, mom, normalized), mom_libs(traces, mom, normalized), mom_sums(traces, mom, normalized)]
+    test_all = functools.partial(nt.assert_almost_equal, cm[0])
+    list(map(test_all, cm))
+
+
+@pytest.mark.parametrize("kernel1d", eng1d_list)
+def test_nist(kernel1d):
+  # ttest from https://www.itl.nist.gov/div898/handbook/eda/section3/eda353.htm
+  # data  from https://www.itl.nist.gov/div898/handbook/eda/section3/eda3531.htm
+
+  traces = [
+      np.array([18,15,18,16,17,15,14,14,14,15,15,14,15,14,22,18,21,21,10,10,11,9,28,25,19,16,17,19,18,14,14,14,14,12,13,13,18,22,19,18,23,26,25,20,21,13,14,15,14,17,11,13,12,13,15,13,13,14,22,28,13,14,13,14,15,12,13,13,14,13,12,13,18,16,18,18,23,11,12,13,12,18,21,19,21,15,16,15,11,20,21,19,15,26,25,16,16,18,16,13,14,14,14,28,19,18,15,15,16,15,16,14,17,16,15,18,21,20,13,23,20,23,18,19,25,26,18,16,16,15,22,22,24,23,29,25,20,18,19,18,27,13,17,13,13,13,30,26,18,17,16,15,18,21,19,19,16,16,16,16,25,26,31,34,36,20,19,20,19,21,20,25,21,19,21,21,19,18,19,18,18,18,30,31,23,24,22,20,22,20,21,17,18,17,18,17,16,19,19,36,27,23,24,34,35,28,29,27,34,32,28,26,24,19,28,24,27,27,26,24,30,39,35,34,30,22,27,20,18,28,27,34,31,29,27,24,23,38,36,25,38,26,22,36,27,27,32,28,31])[:, np.newaxis],  # noqa: E231,E501
+      np.array([24,27,27,25,31,35,24,19,28,23,27,20,22,18,20,31,32,31,32,24,26,29,24,24,33,33,32,28,19,32,34,26,30,22,22,33,39,36,28,27,21,24,30,34,32,38,37,30,31,37,32,47,41,45,34,33,24,32,39,35,32,37,38,34,34,32,33,32,25,24,37,31,36,36,34,38,32,38,32])[:, np.newaxis],  # noqa: E231,E501
+  ]
+
+  tr_len, cl_len, m = 1, 2, 1
+  eng = statmoments.Univar(tr_len, cl_len, moment=2 * m, kernel=kernel1d)
+
+  eng.update(traces[0], [[0, 1]] * len(traces[0]))
+  eng.update(traces[1], [[1, 0]] * len(traces[1]))
+
+  nt.assert_equal(list(eng.counts(0)), [249, 79])
+  nt.assert_equal(list(eng.counts(1)), [79, 249])
+
+  # Request both moments at once for both classifiers
+  allmoms = [m.copy() for m in eng.moments((1, 2))]
+
+  # Ensure means
+  classifier, moment, rvar = 0, 0, 0
+  nt.assert_allclose(allmoms[classifier][:, moment][:, rvar], [20.14458, 30.48101])
+  classifier, moment, rvar = 1, 0, 0
+  nt.assert_allclose(allmoms[classifier][:, moment][:, rvar], [30.48101, 20.14458])
+
+  # Ensure standard deviations
+  classifier, moment, rvar = 0, 1, 0
+  nc = np.array(eng.counts(classifier))
+  sd = np.sqrt(allmoms[classifier][:, moment][:, rvar] * nc / (nc - 1))
+  nt.assert_almost_equal(sd, [6.41470, 6.10771], decimal=5)
+
+  classifier, moment, rvar = 1, 1, 0
+  nc = np.array(eng.counts(classifier))
+  sd = np.sqrt(allmoms[classifier][:, moment][:, rvar] * nc / (nc - 1))
+  nt.assert_almost_equal(sd, [6.10771, 6.41470], decimal=5)
+
+  # Ensure t-test
+  exptt_eq = ttest_ind(traces[0], traces[1], equal_var=True).statistic           # NIST
+  alltt_eq = [tt.copy() for tt in statmoments.stattests.ttests(eng, equal_var=True)]
+  nt.assert_almost_equal(exptt_eq, -12.62059, decimal=5)
+  nt.assert_almost_equal(alltt_eq, [[-12.62059], [12.62059]], decimal=5)
+
+  alltt_ne = [m.copy() for m in statmoments.stattests.ttests(eng, equal_var=False)]  # Welch
+  exptt_ne = ttest_ind(traces[0], traces[1], equal_var=False).statistic
+  nt.assert_almost_equal(exptt_ne, -12.94627, decimal=5)
+  nt.assert_almost_equal(alltt_ne, [[-12.94627], [12.94627]], decimal=5)
+
+
+@pytest.mark.parametrize("kernel1d", eng1d_list)
+def test_trivial_1d(trivial_traces, kernel1d):
+  m, cl_len = 4, 1
+  traces0, traces1 = trivial_traces
+
+  n0, n1 = len(traces0), len(traces1)
+
+  eng = statmoments.Univar(len(traces0[0]), cl_len, moment=2 * m, kernel=kernel1d, acc_min_count=3)
+  eng.update(traces0, ['0'] * n0)
+  eng.update(traces1, ['1'] * n1)
+
+  # tt 1 ord
+  i = 1
+  tt_exp = wttest(traces0, traces1)
+  tt_act = next(statmoments.stattests.ttests(eng, moment=i)).copy()
+  nt.assert_almost_equal(tt_exp, tt_act)
+
+  # tt 2 ord
+  i = 2
+  tt_act = next(statmoments.stattests.ttests(eng, moment=i)).copy()
+
+  mm2 = mom_3pass(traces0, i), mom_3pass(traces1, i)
+  mm4 = mom_3pass(traces0, 2 * i), mom_3pass(traces1, 2 * i)
+  mm4[0][:] = mm4[0] - mm2[0] ** 2
+  mm4[1][:] = mm4[1] - mm2[1] ** 2
+  tt_exp1 = (mm2[0] - mm2[1]) / np.sqrt(mm4[0] / (n0 - 1) + mm4[1] / (n1 - 1))
+
+  mf_traces = [meanfree(traces0), meanfree(traces1)]
+  tt_exp2 = wttest(mf_traces[0] ** 2, mf_traces[1] ** 2)
+
+  nt.assert_almost_equal(tt_exp1, tt_exp2)
+  nt.assert_almost_equal(tt_exp1, tt_act)
+
+  # tt 3-4 ord, standartized
+  std = [np.sqrt(mm2[0]), np.sqrt(mm2[1])]
+  for i in [3, 4]:
+    sm20 = (mom_3pass(traces0, 2 * i) - mom_3pass(traces0, i) ** 2) / std[0] ** (2 * i)
+    sm21 = (mom_3pass(traces1, 2 * i) - mom_3pass(traces1, i) ** 2) / std[1] ** (2 * i)
+    sm10 = mom_3pass(traces0, i, True)
+    sm11 = mom_3pass(traces1, i, True)
+    tt_exp1 = (sm10 - sm11) / np.sqrt(sm20 / (n0 - 1) + sm21 / (n1 - 1))
+    tt_exp2 = wttest((mf_traces[0] / std[0]) ** i, (mf_traces[1] / std[1]) ** i)
+    tt_act = next(statmoments.stattests.ttests(eng, moment=i)).copy()
 
     nt.assert_almost_equal(tt_exp1, tt_exp2)
+    nt.assert_almost_equal(tt_exp1, tt_act)
+
+
+@pytest.mark.parametrize("kernel2d", eng2d_list)
+def test_trivial_2d(trivial_traces, kernel2d):
+  m, cl_len = 4, 1
+  traces0, traces1 = trivial_traces
+  n0, n1 = len(traces0), len(traces1)
+
+  eng = statmoments.Bivar(len(traces0[0]), cl_len, moment=m, kernel=kernel2d, acc_min_count=3)
+  eng.update(traces0, ['0'] * n0)
+  eng.update(traces1, ['1'] * n1)
+
+  # tt 1-1 ord
+  m1, m2 = 1, 1
+  tt_exp = wttest(uni2bivar(traces0, m1, m2), uni2bivar(traces1, m1, m2))
+  tt_act = next(statmoments.stattests.ttests(eng, moment=m1)).copy()
+  nt.assert_almost_equal(tt_exp, tt_act)
+
+  # tt 2-2 ord
+  m1, m2 = 2, 2
+  std2d0 = np.var(traces0, axis=0, ddof=0)  # std ** 2 = var
+  std2d1 = np.var(traces1, axis=0, ddof=0)  # std ** 2 = var
+
+  tr2d_std0 = uni2bivar(traces0, m1, m2, False) / triu_flatten(np.outer(std2d0, std2d0))
+  tr2d_std1 = uni2bivar(traces1, m1, m2, False) / triu_flatten(np.outer(std2d1, std2d1))
+
+  tt_exp = wttest(tr2d_std0, tr2d_std1)
+  tt_act = next(statmoments.stattests.ttests(eng, moment=m1)).copy()
 
-    tt_exp = tt_exp2
-    test_all = functools.partial(nt.assert_almost_equal, tt_exp)
-    list(map(test_all, tt_act))
-
-    # tt 3-4 ord
-    std = [np.sqrt(mm2[0]), np.sqrt(mm2[1])]
-    for i in [3, 4]:
-      sm20 = (mom_3pass(traces0, 2 * i) - mom_3pass(traces0, i) ** 2) / std[0] ** (2*i)
-      sm21 = (mom_3pass(traces1, 2 * i) - mom_3pass(traces1, i) ** 2) / std[1] ** (2*i)
-      sm10 = mom_3pass(traces0, i, True)
-      sm11 = mom_3pass(traces1, i, True)
-      tt_exp1 = (sm10 - sm11) / np.sqrt(sm20 / (n0 - 1) + sm21 / (n1 - 1))
-
-      tt_exp2 = wttest((mf_traces[0] / std[0]) ** i, (mf_traces[1] / std[1]) ** i)
-      nt.assert_almost_equal(tt_exp1, tt_exp2)
-
-      tt_exp = tt_exp2
-      tt_act = [next(statmoments.stattests.ttests(eng, moment=i)).copy() for eng in engines]
-
-      test_all = functools.partial(nt.assert_almost_equal, tt_exp)
-      list(map(test_all, tt_act))
-
-  def test_trivial_2d(self):
-    m, cl_len = 4, 1
-    traces0 = np.array([
-        [2,  4,   5],
-        [4,  6,  -2],
-        [7,  3,   0],
-        [8,  5,   1],
-        [2,  7,   6],
-        [9,  1,   2],
-        [4,  8,  -4],
-        [1,  2,   8],
-    ], dtype=np.int8)
-    # traces0 = np.random.uniform(0, 20, (50, 10)).astype(np.int8)
-    traces1 = (traces0 + np.sin(traces0) * 3).astype(np.int8)
-
-    n0, n1 = len(traces0), len(traces1)
-
-    # engines = [statmoments.Bivar(len(traces0[0]), cl_len, kernel=statmoments.bivar_sum, moment=m, acc_min_count=3)]
-    engines = [statmoments.Bivar(len(traces0[0]), cl_len, kernel=statmoments.bivar_2pass, moment=m, acc_min_count=3)]
-    for eng in engines:
-      eng.update(traces0, ['0'] * n0)
-      eng.update(traces1, ['1'] * n1)
-
-    # tt 1-1 ord
-    m1, m2 = 1, 1
-    tt_exp = wttest(uni2bivar(traces0, m1, m2), uni2bivar(traces1, m1, m2))
-    tt_act = [next(statmoments.stattests.ttests(eng, moment=m1)).copy() for eng in engines]
-    test_all = functools.partial(nt.assert_almost_equal, tt_exp)
-    list(map(test_all, tt_act))
-
-    # tt 2-2 ord
-    m1, m2 = 2, 2
-    std2d0 = np.var(traces0, axis=0, ddof=0)  # std ** 2 = sqrt(var)**2 = var
-    std2d1 = np.var(traces1, axis=0, ddof=0)  # std ** 2 = sqrt(var)**2 = var
-
-    tr2d_std0 = uni2bivar(traces0, m1, m2, False) / triu_flatten(np.outer(std2d0, std2d0))
-    tr2d_std1 = uni2bivar(traces1, m1, m2, False) / triu_flatten(np.outer(std2d1, std2d1))
-
-    tt_exp = wttest(tr2d_std0, tr2d_std1)
-    tt_act = [next(statmoments.stattests.ttests(eng, moment=m1)).copy() for eng in engines]
-
-    test_all = functools.partial(nt.assert_almost_equal, tt_exp)
-    list(map(test_all, tt_act))
-
-
-def run_one():
-  tsuite = unittest.TestSuite()
-  tsuite.addTest(Test_stat('test_nist'))
-  unittest.TextTestRunner(verbosity=2).run(tsuite)
+  nt.assert_almost_equal(tt_exp, tt_act)
 
 
 # Entrance point
 if __name__ == '__main__':
-  # run_one()
-  unittest.main(argv=['first-arg-is-ignored'])
+  pytest.main(["-v", __file__ + "::test_ttest_1d"])
```

### Comparing `statmoments-1.0.4/statmoments/univar.py` & `statmoments-1.0.5/statmoments/univar.py`

 * *Files identical despite different names*

### Comparing `statmoments-1.0.4/statmoments.egg-info/PKG-INFO` & `statmoments-1.0.5/README.md`

 * *Files 27% similar despite different names*

```diff
@@ -1,83 +1,49 @@
-Metadata-Version: 2.1
-Name: statmoments
-Version: 1.0.4
-Summary: Fast streaming single-pass univariate/bivariate statistics and t-test
-Author: Anton Kochepasov
-Author-email: akss@me.com
-License: MIT
-Project-URL: Source Code, https://github.com/akochepasov/statmoments/
-Keywords: data-science,univariate,bivariate,statistics,streaming,numpy,vectorization
-Platform: any
-Classifier: Development Status :: 5 - Production/Stable
-Classifier: Environment :: Console
-Classifier: Intended Audience :: Developers
-Classifier: Intended Audience :: Science/Research
-Classifier: Intended Audience :: Financial and Insurance Industry
-Classifier: License :: OSI Approved :: MIT License
-Classifier: Operating System :: OS Independent
-Classifier: Programming Language :: Cython
-Classifier: Programming Language :: Python
-Classifier: Programming Language :: Python :: 3
-Classifier: Programming Language :: Python :: 3.6
-Classifier: Programming Language :: Python :: 3.7
-Classifier: Programming Language :: Python :: 3.8
-Classifier: Programming Language :: Python :: 3.9
-Classifier: Programming Language :: Python :: 3.10
-Classifier: Topic :: Scientific/Engineering :: Artificial Intelligence
-Classifier: Topic :: Scientific/Engineering :: Image Processing
-Classifier: Topic :: Scientific/Engineering :: Information Analysis
-Classifier: Topic :: Scientific/Engineering :: Mathematics
-Classifier: Topic :: Scientific/Engineering :: Physics
-Description-Content-Type: text/markdown
-License-File: LICENSE
-
 # statmoments
 
 Fast streaming univariate and bivariate moments and t-statistics.
 
-statmoments is a library for the fast streaming one-pass computation of univariate and bivariate moments for batches of multiple of waveforms or traces with thousands of sample points. Given the data sorting with classifiers, it can compute Welch's t-test statistics of various orders for arbitrary data partitioning to allow finding relationships and statistical differences among many data splits, which are unknown beforehand. statmoments uses best-of-class BLAS implementation and preprocesses input data to make the most of computational power and perform computations as fast as possible on Windows and Linux platforms.
+statmoments is a library for fast one-pass computation of univariate and bivariate moments for batches of waveforms or traces with thousands of sample points. It can compute Welch's t-test statistics for arbitrary data partitioning, helping find relationships and statistical differences among data splits. Using top BLAS implementations, statmoments preprocesses data to maximize computational efficiency on Windows and Linux.
 
 ## How is that different?
 
-When the difference in input data is really subtle, millions of waveforms should be processed to find the statistically significant difference. Therefore, computationally efficient algorithms for analyzing such volumes of data are crucial for practical use. Due to their nature, computing high-order moments and statistics requires 2- or 3-pass computations. However, not all the data can fit into the available memory. In another case, after initial input has been processed, new data may appear, which requires starting the process over. When the input waveforms contain many thousands of sample points, it adds another dimension to an already complex problem.
+When input data differences are subtle, millions of waveforms may have to be processed to find the statistically significant difference, requiring efficient algorithms. In addition to that, the high-order moment computation need multiple passes and may require starting over once new data appear. With thousands of sample points per waveform, the problem becomes more complex.
 
-This can be overcome with a streaming approach. A streaming algorithm examines a sequence of inputs in a single pass, it processes data as it is collected, without waiting for it to be pre-collected and stored in a persistent storage. Streaming computation is often used to process data from real-time sources, such as oscilloscopes, sensors as well as financial markets. It can also be used to process large datasets that are too large to fit in memory or to process data that is constantly changing. Another name for such an approach is an online algorithm.
+A streaming algorithm process a sequence of inputs in a single pass it is collected, when it's fast enough, it's suitable for real-time sources like oscilloscopes, sensors, and financial markets, or for large datasets that don't fit in memory. The dense matrix representation reduces memory requirements. The accumulator can be converted to co-moments and Welch's t-test statistics on demand. Data batches can be iteratively processed, increasing precision and then discarded. The library handles significant input streams, processing hundreds of megabytes per second.
 
-This library implements streaming algorithms to avoid recomputation, and stores intermediate data in the accumulator. The algorithm also takes into account that covariance and higher matrices are represented by a symmetric matrix, decreasing the memory requirement two-fold. The data update is blazingly fast and at any moment the internal accumulator can be converted to (co-)moments on demand and the moments in turn can be converted to t-statistics with Welch's t-test. Once more data is collected, it can be iteratively processed, increasing the precision of the moments, and discarded. The computation is optimized to consume significant input streams, hundreds of megabytes per second of waveforms, which may contain thousands of points.
 Yet another dimension can be added when the data split is unknown. In other words, which bucket the input waveform belongs to. This library solves this with pre-classification of the input data and computing moments for all the requested data splits.
 
 Some of the benefits of streaming computation include:
 
-- Real-time insights from the data, such as identifying trends and detecting anomalies.
-- Reduced latency of data processing, as the data is processed as generated and then discarded. This is important for applications where time is critical, from financial trading to online gaming.
-- Scalability: Streaming computation can handle large volumes of data. This is important for research that generates large amounts of data, such as astrophysics and financial analysis.
+- Real-time insights for trend identification and anomaly detection
+- Reduced data processing latency, crucial for time-sensitive applications
+- Scalability to handle large data volumes, essential for data-intensive research in fields like astrophysics and financial analysis
 
 ## Where is this needed?
 
-Univariate statistics are used in various fields and contexts to analyze and describe the characteristics of a single variable or data set. Common applications can be:
+Univariate statistics analyze and describe a single variable or dataset. Common applications include
 
-- Descriptive Statistics: summarizing and describing the central tendency, dispersion, and shape of a dataset.
-- Hypothesis Testing: testing hypothesis to determine if there are significant differences or relationships between groups or conditions.
-- Finance and Economics: Examining the performance of financial assets, tracking market trends, and assessing risk in real-time.
+- Descriptive Statistics: Summarizing central tendency, dispersion, and shape of a dataset
+- Hypothesis Testing: Determining significant differences or relationships between groups or conditions
+- Finance and Economics: Examining asset performance, tracking market trends, and assessing risk in real-time
 
-In summary, univariate statistics are a fundamental tool in data analysis and are widely used across a range of fields to explore, summarize, and draw conclusions from single-variable data. They provide essential insights into the characteristics and behavior of individual variables, which can inform decision-making and further research.
+In summary, univariate statistics are fundamental for data analysis, providing essential insights into individual variables across various fields, aiding in decision-making and further research.
 
-Bivariate statistics is a tool for understanding the relationships between two variables. Researchers and practitioners use it in a wide range of fields to make informed decisions and improve outcomes. They can be used to answer a variety of questions, such as:
+Bivariate statistics help understand relationships between two variables, aiding informed decisions across various fields. They address questions like:
 
 - Is there a statistically significant relationship between variables?
 - Which data points are related?
-- If any, how strong is the relationship?
-- Can we use one variable to predict the other variable?
+- How strong is the relationship?
+- Can we use one variable to predict the other?
 
-These statistical methods are used in medical and bioinformatics research, astrophysics, seismology, market predictions, and many more where the input data may be measured in hundreds of gigabytes.
+These statistical methods are used in medical and bioinformatics research, astrophysics, seismology, market predictions, and other fields, handling input data measured in hundreds of gigabytes.
 
 ## Numeric accuracy
 
-The numeric accuracy of results is dependent on the coefficient of variation (COV) of the sample point in the input waveforms. With COV of about 5%, the computed (co-)kurtosis has about 10 correct significant digits for 10'000 waveforms, which is more than enough for the resulting t-test. Increasing data by about 100x additionally loses one more significant digit.
+The numeric accuracy of results depends on the coefficient of variation (COV) of a sample point in the input waveforms. With a COV of about 5%, the computed (co-)kurtosis has about 10 correct significant digits for 10,000 waveforms, sufficient for Welch's t-test. Increasing data by 100x loses one more significant digit.
 
 ## Examples
 
 ### Performing univariate data analysis
 
 ```python
   # Input data parameters
@@ -91,16 +57,16 @@
   # Process input data and split hypotheses
   uveng.update(wforms1, classification1)
 
   # Process more input data and split hypotheses
   uveng.update(wforms2, classification2)
 
   # Get statistical moments
-  mean       = [cm.copy() for cm in uveng.moments(moments=1)]
-  skeweness  = [cm.copy() for cm in uveng.moments(moments=3)]
+  mean       = [cm.copy() for cm in uveng.moments(moments=1)]  # E(X)
+  skeweness  = [cm.copy() for cm in uveng.moments(moments=3)]  # E(X^3)
 
   # Detect statistical differences in the first-order t-test
   for i, tt in enumerate(statmoments.stattests.ttests(uveng, moment=1)):
     if np.any(np.abs(tt) > 5):
       print(f"Data split {i} has different means")
 
   # Process more input data and split hypotheses
@@ -123,20 +89,20 @@
   # Process input data and split hypotheses
   bveng.update(wforms1, classification1)
 
   # Process more input data and split hypotheses
   bveng.update(wforms2, classification2)
 
   # Get bivariate moments
-  covariance    = [cm.copy() for cm in bveng.comoments(moments=(1, 1))]
-  cokurtosis22  = [cm.copy() for cm in bveng.comoments(moments=(2, 2))]
-  cokurtosis13  = [cm.copy() for cm in bveng.comoments(moments=(1, 3))]
+  covariance    = [cm.copy() for cm in bveng.comoments(moments=(1, 1))]  # E(X Y)
+  cokurtosis22  = [cm.copy() for cm in bveng.comoments(moments=(2, 2))]  # E(X^2 Y^2)
+  cokurtosis13  = [cm.copy() for cm in bveng.comoments(moments=(1, 3))]  # E(X^1 Y^3)
 
   # univariate statistical moments are also can be obtained
-  variance   = [cm.copy() for cm in bveng.moments(moments=2)]
+  variance   = [cm.copy() for cm in bveng.moments(moments=2)]  # E(X^2)
 
   # Detect statistical differences in the second order t-test (covariances)
   for i, tt in enumerate(statmoments.stattests.ttests(bveng, moment=(1,1))):
     if np.any(np.abs(tt) > 5):
       print(f"Found stat diff in the split {i}")
 
   # Process more input data and split hypotheses
@@ -144,31 +110,27 @@
 
   # Get updated statistical moments and t-tests
 ```
 
 ### Performing data analysis from the command line
 
 ```shell
-# Find univariate t-test statistics of skeweness for
-# the first 5000 waveform sample points
-# taken from the HDF5 dataset
+# Find univariate t-test statistics of skeweness for the first
+# 5000 waveform sample points, stored in a HDF5 dataset
 python -m statmoments.univar -i data.h5 -m 3 -r 0:5000
 
-# Find bivariate t-test statistics of covariance for
-# the first 1000 waveform sample points
-# Taken from the HDF5 dataset
+# Find bivariate t-test statistics of covariance for the first
+# 1000 waveform sample points, stored in a HDF5 dataset
 python -m statmoments.bivar -i data.h5 -r 0:1000
 ```
 
 More examples can be found in the examples and tests directories.
 
 ## Implementation notes
 
-Since the output data can exhaust the existing RAM, the results are the matrices of statistical moments for the requested region, which is produced in a one-at-a-time fashion for each input classifier. The output moment for each classifier has dimension 2 x M x L, where, M is an index of the requested classifier, L is the region length. t-test is represented by a 1D array for each classifier.
-The **bivariate moments** are represented by the **upper triangle** of the symmetric matrix.
-
+Due to RAM limits, results are produced one at a time for each input classifier as the set of statistical moments. Each classifier's output moment has dimensions 2 x M x L, where M is an index of the requested classifier and L is the region length. The co-moments and t-tests is represented by a 1D array for each classifier. **Bivariate moments** are represented by the **upper triangle** of the symmetric matrix.
 
 ## Installation
 
 ```shell
 pip install statmoments
 ```
```

### Comparing `statmoments-1.0.4/statmoments.egg-info/SOURCES.txt` & `statmoments-1.0.5/statmoments.egg-info/SOURCES.txt`

 * *Files identical despite different names*

