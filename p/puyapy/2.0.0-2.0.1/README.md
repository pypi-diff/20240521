# Comparing `tmp/puyapy-2.0.0-py3-none-any.whl.zip` & `tmp/puyapy-2.0.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,8 +1,8 @@
-Zip file size: 2109864 bytes, number of entries: 965
+Zip file size: 2112030 bytes, number of entries: 966
 -rw-r--r--  2.0 unx      453 b- defN 80-Jan-01 00:00 puya/ARCHITECTURE.md
 -rw-r--r--  2.0 unx      123 b- defN 80-Jan-01 00:00 puya/__init__.py
 -rw-r--r--  2.0 unx     3727 b- defN 80-Jan-01 00:00 puya/__main__.py
 -rw-r--r--  2.0 unx      564 b- defN 80-Jan-01 00:00 puya/_typeshed/README.md
 -rw-r--r--  2.0 unx     5587 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/VERSIONS
 -rw-r--r--  2.0 unx     2479 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/_collections_abc.pyi
 -rw-r--r--  2.0 unx    11408 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/_typeshed/__init__.pyi
@@ -770,63 +770,63 @@
 -rw-r--r--  2.0 unx    15882 b- defN 80-Jan-01 00:00 puya/_vendor/mypy/visitor.py
 -rw-r--r--  2.0 unx     1409 b- defN 80-Jan-01 00:00 puya/_vendor/mypy/xml/mypy-html.css
 -rw-r--r--  2.0 unx     3824 b- defN 80-Jan-01 00:00 puya/_vendor/mypy/xml/mypy-html.xslt
 -rw-r--r--  2.0 unx     4686 b- defN 80-Jan-01 00:00 puya/_vendor/mypy/xml/mypy-txt.xslt
 -rw-r--r--  2.0 unx     2173 b- defN 80-Jan-01 00:00 puya/_vendor/mypy/xml/mypy.xsd
 -rw-r--r--  2.0 unx      661 b- defN 80-Jan-01 00:00 puya/algo_constants.py
 -rw-r--r--  2.0 unx    10673 b- defN 80-Jan-01 00:00 puya/arc32.py
--rw-r--r--  2.0 unx     7435 b- defN 80-Jan-01 00:00 puya/arc4_util.py
+-rw-r--r--  2.0 unx     7499 b- defN 80-Jan-01 00:00 puya/arc4_util.py
 -rw-r--r--  2.0 unx      127 b- defN 80-Jan-01 00:00 puya/avm_type.py
 -rw-r--r--  2.0 unx        0 b- defN 80-Jan-01 00:00 puya/awst/__init__.py
--rw-r--r--  2.0 unx     9829 b- defN 80-Jan-01 00:00 puya/awst/function_traverser.py
--rw-r--r--  2.0 unx    55887 b- defN 80-Jan-01 00:00 puya/awst/nodes.py
--rw-r--r--  2.0 unx    21981 b- defN 80-Jan-01 00:00 puya/awst/to_code_visitor.py
--rw-r--r--  2.0 unx     8282 b- defN 80-Jan-01 00:00 puya/awst/visitors.py
+-rw-r--r--  2.0 unx    10188 b- defN 80-Jan-01 00:00 puya/awst/function_traverser.py
+-rw-r--r--  2.0 unx    56508 b- defN 80-Jan-01 00:00 puya/awst/nodes.py
+-rw-r--r--  2.0 unx    22544 b- defN 80-Jan-01 00:00 puya/awst/to_code_visitor.py
+-rw-r--r--  2.0 unx     8428 b- defN 80-Jan-01 00:00 puya/awst/visitors.py
 -rw-r--r--  2.0 unx    17861 b- defN 80-Jan-01 00:00 puya/awst/wtypes.py
 -rw-r--r--  2.0 unx     1211 b- defN 80-Jan-01 00:00 puya/awst_build/README.md
 -rw-r--r--  2.0 unx        0 b- defN 80-Jan-01 00:00 puya/awst_build/__init__.py
 -rw-r--r--  2.0 unx    13210 b- defN 80-Jan-01 00:00 puya/awst_build/arc4_utils.py
 -rw-r--r--  2.0 unx    12152 b- defN 80-Jan-01 00:00 puya/awst_build/base_mypy_visitor.py
--rw-r--r--  2.0 unx     5442 b- defN 80-Jan-01 00:00 puya/awst_build/constants.py
+-rw-r--r--  2.0 unx     5503 b- defN 80-Jan-01 00:00 puya/awst_build/constants.py
 -rw-r--r--  2.0 unx     9138 b- defN 80-Jan-01 00:00 puya/awst_build/context.py
 -rw-r--r--  2.0 unx    22200 b- defN 80-Jan-01 00:00 puya/awst_build/contract.py
 -rw-r--r--  2.0 unx      667 b- defN 80-Jan-01 00:00 puya/awst_build/contract_data.py
 -rw-r--r--  2.0 unx        0 b- defN 80-Jan-01 00:00 puya/awst_build/eb/__init__.py
 -rw-r--r--  2.0 unx     1099 b- defN 80-Jan-01 00:00 puya/awst_build/eb/_utils.py
 -rw-r--r--  2.0 unx     9182 b- defN 80-Jan-01 00:00 puya/awst_build/eb/app_account_state.py
 -rw-r--r--  2.0 unx     8336 b- defN 80-Jan-01 00:00 puya/awst_build/eb/app_state.py
 -rw-r--r--  2.0 unx      429 b- defN 80-Jan-01 00:00 puya/awst_build/eb/arc4/__init__.py
--rw-r--r--  2.0 unx    10375 b- defN 80-Jan-01 00:00 puya/awst_build/eb/arc4/_utils.py
--rw-r--r--  2.0 unx    13733 b- defN 80-Jan-01 00:00 puya/awst_build/eb/arc4/abi_call.py
+-rw-r--r--  2.0 unx     9328 b- defN 80-Jan-01 00:00 puya/awst_build/eb/arc4/_utils.py
+-rw-r--r--  2.0 unx    16048 b- defN 80-Jan-01 00:00 puya/awst_build/eb/arc4/abi_call.py
 -rw-r--r--  2.0 unx    21741 b- defN 80-Jan-01 00:00 puya/awst_build/eb/arc4/arrays.py
 -rw-r--r--  2.0 unx     7079 b- defN 80-Jan-01 00:00 puya/awst_build/eb/arc4/base.py
 -rw-r--r--  2.0 unx     1958 b- defN 80-Jan-01 00:00 puya/awst_build/eb/arc4/bool.py
 -rw-r--r--  2.0 unx     2856 b- defN 80-Jan-01 00:00 puya/awst_build/eb/arc4/dynamic_bytes.py
 -rw-r--r--  2.0 unx     2267 b- defN 80-Jan-01 00:00 puya/awst_build/eb/arc4/emit.py
 -rw-r--r--  2.0 unx     8276 b- defN 80-Jan-01 00:00 puya/awst_build/eb/arc4/numeric.py
 -rw-r--r--  2.0 unx     5591 b- defN 80-Jan-01 00:00 puya/awst_build/eb/arc4/string.py
 -rw-r--r--  2.0 unx     3832 b- defN 80-Jan-01 00:00 puya/awst_build/eb/arc4/struct.py
 -rw-r--r--  2.0 unx     4583 b- defN 80-Jan-01 00:00 puya/awst_build/eb/arc4/tuple.py
 -rw-r--r--  2.0 unx     4444 b- defN 80-Jan-01 00:00 puya/awst_build/eb/array.py
 -rw-r--r--  2.0 unx    15064 b- defN 80-Jan-01 00:00 puya/awst_build/eb/base.py
 -rw-r--r--  2.0 unx     6237 b- defN 80-Jan-01 00:00 puya/awst_build/eb/biguint.py
 -rw-r--r--  2.0 unx     2267 b- defN 80-Jan-01 00:00 puya/awst_build/eb/bool.py
--rw-r--r--  2.0 unx    12185 b- defN 80-Jan-01 00:00 puya/awst_build/eb/bytes.py
+-rw-r--r--  2.0 unx     9466 b- defN 80-Jan-01 00:00 puya/awst_build/eb/bytes.py
 -rw-r--r--  2.0 unx     1974 b- defN 80-Jan-01 00:00 puya/awst_build/eb/bytes_backed.py
 -rw-r--r--  2.0 unx     3239 b- defN 80-Jan-01 00:00 puya/awst_build/eb/contracts.py
 -rw-r--r--  2.0 unx     3442 b- defN 80-Jan-01 00:00 puya/awst_build/eb/ensure_budget.py
 -rw-r--r--  2.0 unx     9453 b- defN 80-Jan-01 00:00 puya/awst_build/eb/intrinsics.py
 -rw-r--r--  2.0 unx     3521 b- defN 80-Jan-01 00:00 puya/awst_build/eb/log.py
 -rw-r--r--  2.0 unx     1128 b- defN 80-Jan-01 00:00 puya/awst_build/eb/named_int_constants.py
 -rw-r--r--  2.0 unx        0 b- defN 80-Jan-01 00:00 puya/awst_build/eb/reference_types/__init__.py
 -rw-r--r--  2.0 unx     7556 b- defN 80-Jan-01 00:00 puya/awst_build/eb/reference_types/account.py
 -rw-r--r--  2.0 unx     2638 b- defN 80-Jan-01 00:00 puya/awst_build/eb/reference_types/application.py
 -rw-r--r--  2.0 unx     4575 b- defN 80-Jan-01 00:00 puya/awst_build/eb/reference_types/asset.py
 -rw-r--r--  2.0 unx     3237 b- defN 80-Jan-01 00:00 puya/awst_build/eb/reference_types/base.py
--rw-r--r--  2.0 unx     9618 b- defN 80-Jan-01 00:00 puya/awst_build/eb/string.py
+-rw-r--r--  2.0 unx     9724 b- defN 80-Jan-01 00:00 puya/awst_build/eb/string.py
 -rw-r--r--  2.0 unx     1586 b- defN 80-Jan-01 00:00 puya/awst_build/eb/struct.py
 -rw-r--r--  2.0 unx     4078 b- defN 80-Jan-01 00:00 puya/awst_build/eb/subroutine.py
 -rw-r--r--  2.0 unx     2963 b- defN 80-Jan-01 00:00 puya/awst_build/eb/template_variables.py
 -rw-r--r--  2.0 unx      934 b- defN 80-Jan-01 00:00 puya/awst_build/eb/transaction/__init__.py
 -rw-r--r--  2.0 unx     1730 b- defN 80-Jan-01 00:00 puya/awst_build/eb/transaction/base.py
 -rw-r--r--  2.0 unx     1360 b- defN 80-Jan-01 00:00 puya/awst_build/eb/transaction/fields.py
 -rw-r--r--  2.0 unx     5282 b- defN 80-Jan-01 00:00 puya/awst_build/eb/transaction/group.py
@@ -856,26 +856,27 @@
 -rw-r--r--  2.0 unx     2083 b- defN 80-Jan-01 00:00 puya/awst_build/validation/scratch_slots.py
 -rw-r--r--  2.0 unx     6511 b- defN 80-Jan-01 00:00 puya/client_gen.py
 -rw-r--r--  2.0 unx    13918 b- defN 80-Jan-01 00:00 puya/compile.py
 -rw-r--r--  2.0 unx     1858 b- defN 80-Jan-01 00:00 puya/context.py
 -rw-r--r--  2.0 unx     2039 b- defN 80-Jan-01 00:00 puya/errors.py
 -rw-r--r--  2.0 unx      105 b- defN 80-Jan-01 00:00 puya/ir/__init__.py
 -rw-r--r--  2.0 unx    26535 b- defN 80-Jan-01 00:00 puya/ir/arc4_router.py
--rw-r--r--  2.0 unx   183589 b- defN 80-Jan-01 00:00 puya/ir/avm_ops.py
+-rw-r--r--  2.0 unx   183591 b- defN 80-Jan-01 00:00 puya/ir/avm_ops.py
 -rw-r--r--  2.0 unx     1352 b- defN 80-Jan-01 00:00 puya/ir/avm_ops_models.py
 -rw-r--r--  2.0 unx        0 b- defN 80-Jan-01 00:00 puya/ir/builder/__init__.py
--rw-r--r--  2.0 unx     6675 b- defN 80-Jan-01 00:00 puya/ir/builder/_utils.py
+-rw-r--r--  2.0 unx     7247 b- defN 80-Jan-01 00:00 puya/ir/builder/_utils.py
 -rw-r--r--  2.0 unx    57659 b- defN 80-Jan-01 00:00 puya/ir/builder/arc4.py
 -rw-r--r--  2.0 unx     6201 b- defN 80-Jan-01 00:00 puya/ir/builder/assignment.py
 -rw-r--r--  2.0 unx     6175 b- defN 80-Jan-01 00:00 puya/ir/builder/blocks.py
+-rw-r--r--  2.0 unx     6922 b- defN 80-Jan-01 00:00 puya/ir/builder/bytes.py
 -rw-r--r--  2.0 unx     3195 b- defN 80-Jan-01 00:00 puya/ir/builder/callsub.py
 -rw-r--r--  2.0 unx     8738 b- defN 80-Jan-01 00:00 puya/ir/builder/flow_control.py
 -rw-r--r--  2.0 unx    24002 b- defN 80-Jan-01 00:00 puya/ir/builder/iteration.py
 -rw-r--r--  2.0 unx    25112 b- defN 80-Jan-01 00:00 puya/ir/builder/itxn.py
--rw-r--r--  2.0 unx    43992 b- defN 80-Jan-01 00:00 puya/ir/builder/main.py
+-rw-r--r--  2.0 unx    43367 b- defN 80-Jan-01 00:00 puya/ir/builder/main.py
 -rw-r--r--  2.0 unx     5148 b- defN 80-Jan-01 00:00 puya/ir/builder/state.py
 -rw-r--r--  2.0 unx     6658 b- defN 80-Jan-01 00:00 puya/ir/context.py
 -rw-r--r--  2.0 unx        0 b- defN 80-Jan-01 00:00 puya/ir/destructure/__init__.py
 -rw-r--r--  2.0 unx     7028 b- defN 80-Jan-01 00:00 puya/ir/destructure/coalesce_locals.py
 -rw-r--r--  2.0 unx      899 b- defN 80-Jan-01 00:00 puya/ir/destructure/main.py
 -rw-r--r--  2.0 unx     2619 b- defN 80-Jan-01 00:00 puya/ir/destructure/optimize.py
 -rw-r--r--  2.0 unx     4401 b- defN 80-Jan-01 00:00 puya/ir/destructure/parcopy.py
@@ -931,37 +932,37 @@
 -rw-r--r--  2.0 unx    15722 b- defN 80-Jan-01 00:00 puya/parse.py
 -rw-r--r--  2.0 unx        0 b- defN 80-Jan-01 00:00 puya/py.typed
 -rw-r--r--  2.0 unx        0 b- defN 80-Jan-01 00:00 puya/teal/__init__.py
 -rw-r--r--  2.0 unx     2488 b- defN 80-Jan-01 00:00 puya/teal/main.py
 -rw-r--r--  2.0 unx     8386 b- defN 80-Jan-01 00:00 puya/teal/models.py
 -rw-r--r--  2.0 unx        0 b- defN 80-Jan-01 00:00 puya/teal/optimize/__init__.py
 -rw-r--r--  2.0 unx     1645 b- defN 80-Jan-01 00:00 puya/teal/optimize/_data.py
--rw-r--r--  2.0 unx     2703 b- defN 80-Jan-01 00:00 puya/teal/optimize/constant_stack_shuffling.py
+-rw-r--r--  2.0 unx     2704 b- defN 80-Jan-01 00:00 puya/teal/optimize/constant_stack_shuffling.py
 -rw-r--r--  2.0 unx     1618 b- defN 80-Jan-01 00:00 puya/teal/optimize/main.py
 -rw-r--r--  2.0 unx     8381 b- defN 80-Jan-01 00:00 puya/teal/optimize/peephole.py
 -rw-r--r--  2.0 unx     1557 b- defN 80-Jan-01 00:00 puya/teal/optimize/repeated_rotations.py
 -rw-r--r--  2.0 unx     4276 b- defN 80-Jan-01 00:00 puya/teal/optimize/repeated_rotations_search.py
 -rw-r--r--  2.0 unx     1554 b- defN 80-Jan-01 00:00 puya/teal/output.py
 -rw-r--r--  2.0 unx     7535 b- defN 80-Jan-01 00:00 puya/utils.py
 -rw-r--r--  2.0 unx      904 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/__init__.pyi
 -rw-r--r--  2.0 unx     1806 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/_constants.pyi
 -rw-r--r--  2.0 unx     4047 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/_contract.pyi
 -rw-r--r--  2.0 unx      648 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/_hints.pyi
 -rw-r--r--  2.0 unx      370 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/_logic_sig.pyi
 -rw-r--r--  2.0 unx    20981 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/_primitives.pyi
 -rw-r--r--  2.0 unx     9783 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/_reference.pyi
--rw-r--r--  2.0 unx     4332 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/_state.pyi
--rw-r--r--  2.0 unx      549 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/_template_variables.pyi
--rw-r--r--  2.0 unx     5404 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/_transaction.pyi
+-rw-r--r--  2.0 unx     4281 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/_state.pyi
+-rw-r--r--  2.0 unx      459 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/_template_variables.pyi
+-rw-r--r--  2.0 unx     7261 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/_transaction.pyi
 -rw-r--r--  2.0 unx     1416 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/_unsigned_builtins.pyi
 -rw-r--r--  2.0 unx     1040 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/_util.pyi
--rw-r--r--  2.0 unx    20353 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/arc4.pyi
--rw-r--r--  2.0 unx     1491 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/gtxn.pyi
--rw-r--r--  2.0 unx    21474 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/itxn.pyi
+-rw-r--r--  2.0 unx    21458 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/arc4.pyi
+-rw-r--r--  2.0 unx     1511 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/gtxn.pyi
+-rw-r--r--  2.0 unx    21592 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/itxn.pyi
 -rw-r--r--  2.0 unx   150962 b- defN 80-Jan-01 00:00 puya/_typeshed/stdlib/algopy/op.pyi
--rw-r--r--  2.0 unx    34523 b- defN 80-Jan-01 00:00 puyapy-2.0.0.dist-info/COPYING
--rw-r--r--  2.0 unx      657 b- defN 80-Jan-01 00:00 puyapy-2.0.0.dist-info/LICENSE
--rw-r--r--  2.0 unx     5101 b- defN 80-Jan-01 00:00 puyapy-2.0.0.dist-info/METADATA
--rw-r--r--  2.0 unx       88 b- defN 80-Jan-01 00:00 puyapy-2.0.0.dist-info/WHEEL
--rw-r--r--  2.0 unx       83 b- defN 80-Jan-01 00:00 puyapy-2.0.0.dist-info/entry_points.txt
-?rw-r--r--  2.0 unx    97143 b- defN 16-Jan-01 00:00 puyapy-2.0.0.dist-info/RECORD
-965 files, 8611512 bytes uncompressed, 1951710 bytes compressed:  77.3%
+-rw-r--r--  2.0 unx    34523 b- defN 80-Jan-01 00:00 puyapy-2.0.1.dist-info/COPYING
+-rw-r--r--  2.0 unx      657 b- defN 80-Jan-01 00:00 puyapy-2.0.1.dist-info/LICENSE
+-rw-r--r--  2.0 unx     5101 b- defN 80-Jan-01 00:00 puyapy-2.0.1.dist-info/METADATA
+-rw-r--r--  2.0 unx       88 b- defN 80-Jan-01 00:00 puyapy-2.0.1.dist-info/WHEEL
+-rw-r--r--  2.0 unx       83 b- defN 80-Jan-01 00:00 puyapy-2.0.1.dist-info/entry_points.txt
+?rw-r--r--  2.0 unx    97223 b- defN 16-Jan-01 00:00 puyapy-2.0.1.dist-info/RECORD
+966 files, 8621892 bytes uncompressed, 1953752 bytes compressed:  77.3%
```

## zipnote {}

```diff
@@ -2598,14 +2598,17 @@
 
 Filename: puya/ir/builder/assignment.py
 Comment: 
 
 Filename: puya/ir/builder/blocks.py
 Comment: 
 
+Filename: puya/ir/builder/bytes.py
+Comment: 
+
 Filename: puya/ir/builder/callsub.py
 Comment: 
 
 Filename: puya/ir/builder/flow_control.py
 Comment: 
 
 Filename: puya/ir/builder/iteration.py
@@ -2871,26 +2874,26 @@
 
 Filename: puya/_typeshed/stdlib/algopy/itxn.pyi
 Comment: 
 
 Filename: puya/_typeshed/stdlib/algopy/op.pyi
 Comment: 
 
-Filename: puyapy-2.0.0.dist-info/COPYING
+Filename: puyapy-2.0.1.dist-info/COPYING
 Comment: 
 
-Filename: puyapy-2.0.0.dist-info/LICENSE
+Filename: puyapy-2.0.1.dist-info/LICENSE
 Comment: 
 
-Filename: puyapy-2.0.0.dist-info/METADATA
+Filename: puyapy-2.0.1.dist-info/METADATA
 Comment: 
 
-Filename: puyapy-2.0.0.dist-info/WHEEL
+Filename: puyapy-2.0.1.dist-info/WHEEL
 Comment: 
 
-Filename: puyapy-2.0.0.dist-info/entry_points.txt
+Filename: puyapy-2.0.1.dist-info/entry_points.txt
 Comment: 
 
-Filename: puyapy-2.0.0.dist-info/RECORD
+Filename: puyapy-2.0.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## puya/arc4_util.py

```diff
@@ -147,14 +147,16 @@
             | wtypes.account_wtype
             | wtypes.application_wtype
             | wtypes.uint64_wtype
             | wtypes.bool_wtype
             | wtypes.string_wtype
         ):
             return wtype.name
+        case wtypes.biguint_wtype:
+            return "uint512"
         case wtypes.bytes_wtype:
             return "byte[]"
         case wtypes.ARC4Type(alias=alias) if alias is not None:
             return alias
         case wtypes.ARC4UIntN() | wtypes.ARC4UFixedNxM():
             return wtype.name.removeprefix("arc4.")
         case wtypes.WGroupTransaction(transaction_type=transaction_type):
```

## puya/awst/function_traverser.py

```diff
@@ -114,14 +114,23 @@
     def visit_slice_expression(self, expr: awst_nodes.SliceExpression) -> None:
         expr.base.accept(self)
         if isinstance(expr.begin_index, awst_nodes.Expression):
             expr.begin_index.accept(self)
         if isinstance(expr.end_index, awst_nodes.Expression):
             expr.end_index.accept(self)
 
+    def visit_intersection_slice_expression(
+        self, expr: awst_nodes.IntersectionSliceExpression
+    ) -> None:
+        expr.base.accept(self)
+        if isinstance(expr.begin_index, awst_nodes.Expression):
+            expr.begin_index.accept(self)
+        if isinstance(expr.end_index, awst_nodes.Expression):
+            expr.end_index.accept(self)
+
     def visit_index_expression(self, expr: awst_nodes.IndexExpression) -> None:
         expr.base.accept(self)
         expr.index.accept(self)
 
     def visit_conditional_expression(self, expr: awst_nodes.ConditionalExpression) -> None:
         expr.condition.accept(self)
         expr.true_expr.accept(self)
```

## puya/awst/nodes.py

```diff
@@ -549,14 +549,15 @@
         )
 
     @classmethod
     def bool_(cls, immediate: str) -> TxnField:
         return cls(
             wtype=wtypes.bool_wtype,
             immediate=immediate,
+            additional_input_wtypes=(wtypes.uint64_wtype,),
         )
 
     @classmethod
     def account(cls, immediate: str, *, num_values: int = 1) -> TxnField:
         return cls(
             wtype=wtypes.account_wtype,
             immediate=immediate,
@@ -616,16 +617,16 @@
     TxnField.uint64("FirstValidTime", is_inner_param=False),
     TxnField.uint64("LastValid", is_inner_param=False),
     TxnField.bytes_("Note", additional_input_wtypes=(wtypes.string_wtype,)),
     TxnField.bytes_("Lease", is_inner_param=False),
     TxnField.account("Receiver"),
     TxnField.uint64("Amount"),
     TxnField.account("CloseRemainderTo"),
-    TxnField.account("VotePK"),
-    TxnField.account("SelectionPK"),
+    TxnField.bytes_("VotePK"),
+    TxnField.bytes_("SelectionPK"),
     TxnField.uint64("VoteFirst"),
     TxnField.uint64("VoteLast"),
     TxnField.uint64("VoteKeyDilution"),
     TxnField.bytes_("Type"),
     TxnFields.type,
     TxnField.asset("XferAsset"),
     TxnField.uint64("AssetAmount"),
@@ -652,15 +653,15 @@
     TxnField.bytes_("ConfigAssetMetadataHash"),
     TxnField.account("ConfigAssetManager"),
     TxnField.account("ConfigAssetReserve"),
     TxnField.account("ConfigAssetFreeze"),
     TxnField.account("ConfigAssetClawback"),
     TxnField.asset("FreezeAsset"),
     TxnField.account("FreezeAssetAccount"),
-    TxnField.asset("FreezeAssetFrozen"),
+    TxnField.bool_("FreezeAssetFrozen"),
     # v3
     TxnField.uint64("NumAssets", is_inner_param=False),
     TxnField.uint64("NumApplications", is_inner_param=False),
     TxnField.uint64("GlobalNumUint"),
     TxnField.uint64("GlobalNumByteSlice"),
     TxnField.uint64("LocalNumUint"),
     TxnField.uint64("LocalNumByteSlice"),
@@ -687,14 +688,15 @@
     TxnFields.apps,
     # v5
     TxnField.bytes_("Logs", num_values=32, is_inner_param=False),
     # v7
     TxnFields.approval_program_pages,
     TxnFields.clear_state_program_pages,
 ]
+TXN_FIELDS_BY_IMMEDIATE = {f.immediate: f for f in TXN_FIELDS}
 INNER_PARAM_TXN_FIELDS = [f for f in TXN_FIELDS if f.is_inner_param]
 
 
 @attrs.define
 class CreateInnerTransaction(Expression):
     wtype: wtypes.WInnerTransactionFields
     fields: Mapping[TxnField, Expression] = attrs.field(converter=immutabledict)
@@ -898,14 +900,15 @@
 
     def accept(self, visitor: ExpressionVisitor[T]) -> T:
         return visitor.visit_index_expression(self)
 
 
 @attrs.frozen
 class SliceExpression(Expression):
+
     base: Expression = attrs.field(
         validator=expression_has_wtype(
             wtypes.bytes_wtype,
             wtypes.WTuple,
         )
     )
 
@@ -913,14 +916,34 @@
     end_index: Expression | None
 
     def accept(self, visitor: ExpressionVisitor[T]) -> T:
         return visitor.visit_slice_expression(self)
 
 
 @attrs.frozen
+class IntersectionSliceExpression(Expression):
+    """
+    Returns the intersection of the slice indexes and the base
+    """
+
+    base: Expression = attrs.field(
+        validator=expression_has_wtype(
+            wtypes.bytes_wtype,
+            wtypes.WTuple,
+        )
+    )
+
+    begin_index: Expression | int | None
+    end_index: Expression | int | None
+
+    def accept(self, visitor: ExpressionVisitor[T]) -> T:
+        return visitor.visit_intersection_slice_expression(self)
+
+
+@attrs.frozen
 class AppStateExpression(Expression):
     field_name: str
 
     def accept(self, visitor: ExpressionVisitor[T]) -> T:
         return visitor.visit_app_state_expression(self)
```

## puya/awst/to_code_visitor.py

```diff
@@ -425,14 +425,28 @@
 
     def visit_slice_expression(self, expr: nodes.SliceExpression) -> str:
         start = expr.begin_index.accept(self) if expr.begin_index else ""
         stop = expr.end_index.accept(self) if expr.end_index else ""
 
         return f"{expr.base.accept(self)}[{start}:{stop}]"
 
+    def visit_intersection_slice_expression(self, expr: nodes.IntersectionSliceExpression) -> str:
+        start = (
+            expr.begin_index.accept(self)
+            if isinstance(expr.begin_index, nodes.Expression)
+            else expr.begin_index if expr.begin_index is not None else ""
+        )
+        stop = (
+            expr.end_index.accept(self)
+            if isinstance(expr.end_index, nodes.Expression)
+            else expr.end_index if expr.end_index is not None else ""
+        )
+
+        return f"{expr.base.accept(self)}[{start}:{stop}]"
+
     def visit_block(self, statement: nodes.Block) -> list[str]:
         return [line for statement in statement.body for line in statement.accept(self)]
 
     def visit_if_else(self, statement: nodes.IfElse) -> list[str]:
         if_branch = statement.if_branch.accept(self)
         if_block = [
             f"if ({statement.condition.accept(self)}) {{",
```

## puya/awst/visitors.py

```diff
@@ -248,7 +248,12 @@
     def visit_state_get_ex(self, expr: puya.awst.nodes.StateGetEx) -> T: ...
 
     @abstractmethod
     def visit_state_exists(self, expr: puya.awst.nodes.StateExists) -> T: ...
 
     @abstractmethod
     def visit_template_var(self, expr: puya.awst.nodes.TemplateVar) -> T: ...
+
+    @abstractmethod
+    def visit_intersection_slice_expression(
+        self, expr: puya.awst.nodes.IntersectionSliceExpression
+    ) -> T: ...
```

## puya/awst_build/constants.py

```diff
@@ -19,14 +19,15 @@
 CLS_ASSET_ALIAS = f"{ALGOPY_PREFIX}Asset"
 CLS_APPLICATION = f"{ALGOPY_PREFIX}_reference.Application"
 CLS_APPLICATION_ALIAS = f"{ALGOPY_PREFIX}Application"
 CLS_UINT64 = f"{ALGOPY_PREFIX}_primitives.UInt64"
 CLS_UINT64_ALIAS = f"{ALGOPY_PREFIX}UInt64"
 CLS_BYTES = f"{ALGOPY_PREFIX}_primitives.Bytes"
 CLS_BYTES_ALIAS = f"{ALGOPY_PREFIX}Bytes"
+CLS_BYTES_BACKED = f"{ALGOPY_PREFIX}_primitives.BytesBacked"
 CLS_STRING = f"{ALGOPY_PREFIX}_primitives.String"
 CLS_STRING_ALIAS = f"{ALGOPY_PREFIX}String"
 CLS_BIGUINT = f"{ALGOPY_PREFIX}_primitives.BigUInt"
 CLS_BIGUINT_ALIAS = f"{ALGOPY_PREFIX}BigUInt"
 CLS_TRANSACTION_BASE = f"{ALGOPY_PREFIX}gtxn.TransactionBase"
 CLS_LOCAL_STATE = f"{ALGOPY_PREFIX}_state.LocalState"
 CLS_LOCAL_STATE_ALIAS = f"{ALGOPY_PREFIX}LocalState"
```

## puya/awst_build/eb/arc4/_utils.py

```diff
@@ -1,33 +1,29 @@
 from __future__ import annotations
 
 import decimal
 import re
 import typing
 
 import attrs
-import mypy.nodes
-import mypy.types
 
 from puya import arc4_util, log
 from puya.awst import (
     nodes as awst_nodes,
     wtypes,
 )
 from puya.awst.nodes import DecimalConstant, Expression, Literal
-from puya.awst_build import constants
-from puya.awst_build.arc4_utils import arc4_encode, get_arc4_method_config, get_func_types
+from puya.awst_build.arc4_utils import arc4_encode
 from puya.awst_build.eb.base import ExpressionBuilder
-from puya.awst_build.utils import convert_literal, get_decorators_by_fullname
+from puya.awst_build.utils import convert_literal
 from puya.errors import CodeError
 
 if typing.TYPE_CHECKING:
     from collections.abc import Sequence
 
-    from puya.awst_build.context import ASTConversionModuleContext
     from puya.parse import SourceLocation
 
 logger = log.get_logger(__name__)
 _VALID_NAME_PATTERN = re.compile("^[_A-Za-z][A-Za-z0-9_]*$")
 
 
 def convert_arc4_literal(
@@ -116,19 +112,17 @@
     if isinstance(literal_or_expr, awst_nodes.Literal):
         if isinstance(target_wtype, wtypes.ARC4Type):
             return convert_arc4_literal(literal_or_expr, target_wtype)
         return convert_literal(literal_or_expr, target_wtype)
     if isinstance(literal_or_expr, ExpressionBuilder):
         literal_or_expr = literal_or_expr.rvalue()
 
-    if wtypes.has_arc4_equivalent_type(target_wtype):
-        target_wtype = wtypes.avm_to_arc4_equivalent_type(target_wtype)
-        literal_or_expr = arc4_encode(
-            literal_or_expr, target_wtype, literal_or_expr.source_location
-        )
+    if wtypes.has_arc4_equivalent_type(literal_or_expr.wtype):
+        new_wtype = wtypes.avm_to_arc4_equivalent_type(literal_or_expr.wtype)
+        literal_or_expr = arc4_encode(literal_or_expr, new_wtype, literal_or_expr.source_location)
 
     if literal_or_expr.wtype != target_wtype:
         raise CodeError(
             f"Expected type {target_wtype}, got type {literal_or_expr.wtype}",
             literal_or_expr.source_location,
         )
     return literal_or_expr
@@ -143,32 +137,14 @@
     @property
     def method_selector(self) -> str:
         args = ",".join(map(arc4_util.wtype_to_arc4, self.arg_types))
         return_type = self.return_type or wtypes.void_wtype
         return f"{self.method_name}({args}){arc4_util.wtype_to_arc4(return_type)}"
 
 
-def get_arc4_signature(
-    context: ASTConversionModuleContext,
-    type_info: mypy.nodes.TypeInfo,
-    member_name: str,
-    location: SourceLocation,
-) -> ARC4Signature:
-    dec = type_info.get_method(member_name)
-    if isinstance(dec, mypy.nodes.Decorator):
-        decorators = get_decorators_by_fullname(context, dec)
-        abimethod_dec = decorators.get(constants.ABIMETHOD_DECORATOR)
-        if abimethod_dec is not None:
-            func_def = dec.func
-            arc4_method_config = get_arc4_method_config(context, abimethod_dec, func_def)
-            *arg_types, return_type = get_func_types(context, func_def, location).values()
-            return ARC4Signature(arc4_method_config.name, arg_types, return_type)
-    raise CodeError(f"'{type_info.fullname}.{member_name}' is not a valid ARC4 method", location)
-
-
 def get_arc4_args_and_signature(
     method_sig: str, native_args: Sequence[ExpressionBuilder | Literal], loc: SourceLocation
 ) -> tuple[Sequence[Expression], ARC4Signature]:
     method_name, maybe_args, maybe_return_type = _parse_method_signature(method_sig, loc)
     arg_types = list(map(_arg_to_arc4_wtype, native_args)) if maybe_args is None else maybe_args
     num_args = len(native_args)
     num_types = len(arg_types)
```

## puya/awst_build/eb/arc4/abi_call.py

```diff
@@ -7,15 +7,16 @@
 import attrs
 import mypy.nodes
 import mypy.types
 
 from puya import log
 from puya.awst import wtypes
 from puya.awst.nodes import (
-    TXN_FIELDS,
+    TXN_FIELDS_BY_IMMEDIATE,
+    ARC4Decode,
     BytesConstant,
     BytesEncoding,
     CreateInnerTransaction,
     Expression,
     InnerTransactionField,
     Literal,
     MethodConstant,
@@ -23,61 +24,62 @@
     SubmitInnerTransaction,
     TupleExpression,
     TxnField,
     TxnFields,
     UInt64Constant,
 )
 from puya.awst_build import constants
-from puya.awst_build.constants import TransactionType
+from puya.awst_build.arc4_utils import get_arc4_method_config, get_func_types
 from puya.awst_build.eb.arc4._utils import (
     ARC4Signature,
     arc4_tuple_from_items,
     expect_arc4_operand_wtype,
     get_arc4_args_and_signature,
-    get_arc4_signature,
 )
 from puya.awst_build.eb.arc4.base import ARC4FromLogBuilder
 from puya.awst_build.eb.base import (
     ExpressionBuilder,
     GenericClassExpressionBuilder,
     IntermediateExpressionBuilder,
     TypeClassExpressionBuilder,
 )
 from puya.awst_build.eb.subroutine import BaseClassSubroutineInvokerExpressionBuilder
 from puya.awst_build.eb.transaction.fields import get_field_python_name
 from puya.awst_build.eb.transaction.inner_params import get_field_expr
 from puya.awst_build.eb.var_factory import var_expression
+from puya.awst_build.utils import get_decorators_by_fullname
 from puya.errors import CodeError, InternalError
 
 if typing.TYPE_CHECKING:
     from collections.abc import Sequence
 
     from puya.awst_build.context import ASTConversionModuleContext
     from puya.parse import SourceLocation
 
 
 logger = log.get_logger(__name__)
 _APP_TRANSACTION_FIELDS = {
-    get_field_python_name(f): f
-    for f in TXN_FIELDS
-    if f.immediate
-    in (
-        "ApplicationID",
-        "OnCompletion",
-        "ApprovalProgram",
-        "ClearStateProgram",
-        "GlobalNumUInt",
-        "GlobalNumByteSlice",
-        "LocalNumUInt",
-        "LocalNumByteSlice",
-        "ExtraProgramPages",
-        "Fee",
-        "Sender",
-        "Note",
-        "RekeyTo",
+    get_field_python_name(field): field
+    for field in (
+        TXN_FIELDS_BY_IMMEDIATE[immediate]
+        for immediate in (
+            "ApplicationID",
+            "OnCompletion",
+            "ApprovalProgram",
+            "ClearStateProgram",
+            "GlobalNumUint",
+            "GlobalNumByteSlice",
+            "LocalNumUint",
+            "LocalNumByteSlice",
+            "ExtraProgramPages",
+            "Fee",
+            "Sender",
+            "Note",
+            "RekeyTo",
+        )
     )
 }
 
 
 @attrs.frozen
 class _ABICallExpr:
     method: ExpressionBuilder | Literal
@@ -152,15 +154,15 @@
         )
 
 
 class ABICallClassExpressionBuilder(TypeClassExpressionBuilder):
     def __init__(self, result_wtype: wtypes.WType | None, source_location: SourceLocation) -> None:
         super().__init__(source_location)
         self.result_wtype = result_wtype
-        app_itxn_wtype = wtypes.WInnerTransaction.from_type(TransactionType.appl)
+        app_itxn_wtype = wtypes.WInnerTransaction.from_type(constants.TransactionType.appl)
         if _is_typed(result_wtype):
             self.wtype: wtypes.WInnerTransaction | wtypes.WTuple = wtypes.WTuple.from_types(
                 (result_wtype, app_itxn_wtype)
             )
         else:
             self.wtype = app_itxn_wtype
 
@@ -173,37 +175,39 @@
         arg_kinds: list[mypy.nodes.ArgKind],
         arg_names: list[str | None],
         location: SourceLocation,
     ) -> ExpressionBuilder:
         abi_call_expr = _extract_abi_call_args(args, arg_kinds, arg_names, location)
         method = abi_call_expr.method
 
-        result_wtype = self.result_wtype
+        declared_result_wtype = self.result_wtype
         match method:
             case Literal(value=str(method_str)):
                 arc4_args, signature = get_arc4_args_and_signature(
                     method_str, abi_call_expr.abi_args, location
                 )
-                if result_wtype is not None:
+                if declared_result_wtype is not None:
                     # this will be validated against signature below, by comparing
                     # the generated method_selector against the supplied method_str
-                    signature = attrs.evolve(signature, return_type=result_wtype)
+                    signature = attrs.evolve(signature, return_type=declared_result_wtype)
                 elif signature.return_type is None:
                     signature = attrs.evolve(signature, return_type=wtypes.void_wtype)
                 if not signature.method_selector.startswith(method_str):
                     raise CodeError(
                         f"Method selector from args '{signature.method_selector}' "
                         f"does not match provided method selector: '{method_str}'",
                         method.source_location,
                     )
             case (
                 ARC4ClientMethodExpressionBuilder() | BaseClassSubroutineInvokerExpressionBuilder()
             ) as eb:
-                signature = get_arc4_signature(eb.context, eb.type_info, eb.name, location)
-                result_wtype = signature.return_type
+                # in this case the arc4 signature and declared return type are inferred
+                signature, declared_result_wtype = _get_arc4_signature_and_return_wtype(
+                    eb.context, eb.type_info, eb.name, location
+                )
                 num_args = len(abi_call_expr.abi_args)
                 num_types = len(signature.arg_types)
                 if num_types != num_args:
                     raise CodeError(
                         f"Number of arguments ({num_args})"
                         f" does not match signature ({num_types})",
                         location,
@@ -218,32 +222,61 @@
                     location,
                 )
 
         return var_expression(
             _create_abi_call_expr(
                 signature,
                 arc4_args,
+                declared_result_wtype,
                 abi_call_expr.transaction_kwargs,
                 location,
-                return_inner_txn_only=not _is_typed(result_wtype),
             )
         )
 
 
+def _get_arc4_signature_and_return_wtype(
+    context: ASTConversionModuleContext,
+    type_info: mypy.nodes.TypeInfo,
+    member_name: str,
+    location: SourceLocation,
+) -> tuple[ARC4Signature, wtypes.WType]:
+    dec = type_info.get_method(member_name)
+    if isinstance(dec, mypy.nodes.Decorator):
+        decorators = get_decorators_by_fullname(context, dec)
+        abimethod_dec = decorators.get(constants.ABIMETHOD_DECORATOR)
+        if abimethod_dec is not None:
+            func_def = dec.func
+            arc4_method_config = get_arc4_method_config(context, abimethod_dec, func_def)
+            func_wtypes = get_func_types(context, func_def, location).values()
+            *_, return_wtype = func_wtypes
+            *arc4_arg_types, arc4_return_type = (
+                (
+                    wtypes.avm_to_arc4_equivalent_type(func_type)
+                    if wtypes.has_arc4_equivalent_type(func_type)
+                    else func_type
+                )
+                for func_type in func_wtypes
+            )
+            return (
+                ARC4Signature(arc4_method_config.name, arc4_arg_types, arc4_return_type),
+                return_wtype,
+            )
+    raise CodeError(f"'{type_info.fullname}.{member_name}' is not a valid ARC4 method", location)
+
+
 def _is_typed(wtype: wtypes.WType | None) -> typing.TypeGuard[wtypes.WType]:
     return wtype is not None and wtype is not wtypes.void_wtype
 
 
 def _create_abi_call_expr(
     signature: ARC4Signature,
     abi_args: Sequence[Expression],
+    declared_result_wtype: wtypes.WType | None,
     transaction_kwargs: dict[str, ExpressionBuilder | Literal],
     location: SourceLocation,
-    *,
-    return_inner_txn_only: bool,
 ) -> Expression:
     if signature.return_type is None:
         raise InternalError("Expected ARC4Signature.return_type to be defined", location)
     abi_arg_exprs: list[Expression] = [
         MethodConstant(
             value=signature.method_selector,
             source_location=location,
@@ -326,26 +359,42 @@
     )
     itxn = SubmitInnerTransaction(
         itxns=(create_itxn,),
         source_location=location,
         wtype=wtypes.WInnerTransaction.from_type(constants.TransactionType.appl),
     )
 
-    if return_inner_txn_only:
+    if not _is_typed(declared_result_wtype):
         return itxn
     itxn_tmp = SingleEvaluation(itxn)
     last_log = InnerTransactionField(
         source_location=location,
         itxn=itxn_tmp,
         field=TxnFields.last_log,
         wtype=TxnFields.last_log.wtype,
     )
+    abi_result = ARC4FromLogBuilder.abi_expr_from_log(signature.return_type, last_log, location)
+    # the declared result wtype may be different to the arc4 signature return wtype
+    # due to automatic conversion of ARC4 -> native types
+    if declared_result_wtype != signature.return_type:
+        if (
+            wtypes.has_arc4_equivalent_type(declared_result_wtype)
+            and wtypes.avm_to_arc4_equivalent_type(declared_result_wtype) == signature.return_type
+        ):
+            abi_result = ARC4Decode(
+                value=abi_result,
+                wtype=declared_result_wtype,
+                source_location=location,
+            )
+        else:
+            raise InternalError("Return type does not match signature type", location)
+
     return TupleExpression.from_items(
         (
-            ARC4FromLogBuilder.abi_expr_from_log(signature.return_type, last_log, location),
+            abi_result,
             itxn_tmp,
         ),
         location,
     )
 
 
 def _add_array_exprs(
```

## puya/awst_build/eb/bytes.py

```diff
@@ -17,24 +17,18 @@
     BytesUnaryOperation,
     BytesUnaryOperator,
     CallArg,
     EqualityComparison,
     Expression,
     FreeSubroutineTarget,
     IndexExpression,
+    IntersectionSliceExpression,
     Literal,
-    NumericComparison,
-    NumericComparisonExpression,
-    SingleEvaluation,
-    SliceExpression,
     Statement,
     SubroutineCallExpression,
-    UInt64BinaryOperation,
-    UInt64BinaryOperator,
-    UInt64Constant,
 )
 from puya.awst_build import intrinsic_factory
 from puya.awst_build.constants import CLS_BYTES_ALIAS
 from puya.awst_build.eb.base import (
     BuilderBinaryOp,
     BuilderComparisonOp,
     ExpressionBuilder,
@@ -170,40 +164,18 @@
         end_index: ExpressionBuilder | Literal | None,
         stride: ExpressionBuilder | Literal | None,
         location: SourceLocation,
     ) -> ExpressionBuilder:
         if stride is not None:
             raise CodeError("Stride is not supported", location=stride.source_location)
 
-        # since we evaluate self both as base and to get its length,
-        # we need to create a temporary assignment in case it has side effects
-        base = SingleEvaluation(self.expr)
-        begin_index_expr = _eval_slice_component(base, begin_index, location)
-        end_index_expr = _eval_slice_component(base, end_index, location)
-        if begin_index_expr is not None and end_index_expr is not None:
-            # special handling for if begin > end, will devolve into begin == end,
-            # which already returns the correct result of an empty bytes
-            # TODO: maybe we could improve the generated code if the above conversions weren't
-            #       isolated - ie, if we move this sort of checks to before the length
-            #       truncating checks
-            end_index_expr = intrinsic_factory.select(
-                false=end_index_expr,
-                true=begin_index_expr,
-                condition=NumericComparisonExpression(
-                    lhs=begin_index_expr,
-                    operator=NumericComparison.gt,
-                    rhs=end_index_expr,
-                    source_location=location,
-                ),
-                loc=end_index_expr.source_location,
-            )
-        slice_expr: Expression = SliceExpression(
-            base=base,
-            begin_index=begin_index_expr,
-            end_index=end_index_expr,
+        slice_expr: Expression = IntersectionSliceExpression(
+            base=self.expr,
+            begin_index=_eval_slice_component(begin_index),
+            end_index=_eval_slice_component(end_index),
             wtype=self.wtype,
             source_location=location,
         )
         return var_expression(slice_expr)
 
     def iterate(self) -> Iteration:
         return self.rvalue()
@@ -286,57 +258,14 @@
 ) -> BytesBinaryOperator:
     try:
         return BytesBinaryOperator(operator.value)
     except ValueError as ex:
         raise CodeError(f"Unsupported bytes operator {operator.value}", loc) from ex
 
 
-def _eval_slice_component(
-    base: Expression, val: ExpressionBuilder | Literal | None, location: SourceLocation
-) -> Expression | None:
-    if val is None:
-        return None
-
-    len_expr = intrinsic_factory.bytes_len(base, location)
-
-    if isinstance(val, ExpressionBuilder):
-        # no negatives to deal with here, easy
-        index_expr = expect_operand_wtype(val, wtypes.uint64_wtype)
-        temp_index = SingleEvaluation(index_expr)
-        return intrinsic_factory.select(
-            false=len_expr,
-            true=temp_index,
-            condition=NumericComparisonExpression(
-                lhs=temp_index,
-                operator=NumericComparison.lt,
-                rhs=len_expr,
-                source_location=location,
-            ),
-            loc=location,
-        )
-
-    int_lit = val.value
-    if not isinstance(int_lit, int):
-        raise CodeError(f"Invalid literal for slicing: {int_lit!r}", val.source_location)
-    # take the min of abs(int_lit) and len(self.expr)
-    abs_lit_expr = UInt64Constant(value=abs(int_lit), source_location=val.source_location)
-    trunc_value_expr = intrinsic_factory.select(
-        false=len_expr,
-        true=abs_lit_expr,
-        condition=NumericComparisonExpression(
-            lhs=abs_lit_expr,
-            operator=NumericComparison.lt,
-            rhs=len_expr,
-            source_location=location,
-        ),
-        loc=location,
-    )
-    return (
-        trunc_value_expr
-        if int_lit >= 0
-        else UInt64BinaryOperation(
-            left=len_expr,
-            op=UInt64BinaryOperator.sub,
-            right=trunc_value_expr,
-            source_location=location,
-        )
-    )
+def _eval_slice_component(val: ExpressionBuilder | Literal | None) -> Expression | None | int:
+    match val:
+        case None:
+            return None
+        case Literal(value=int(int_value)):
+            return int_value
+    return expect_operand_wtype(val, wtypes.uint64_wtype)
```

## puya/awst_build/eb/string.py

```diff
@@ -253,15 +253,17 @@
                 joined_value = intrinsic_factory.concat(
                     intrinsic_factory.concat(joined_value, sep.rvalue(), location),
                     bytes_expr,
                     location,
                 )
         if joined_value is None:
             joined_value = StringConstant(value="", source_location=location)
-        return var_expression(joined_value)
+        return StringExpressionBuilder(
+            ReinterpretCast(expr=joined_value, wtype=wtypes.string_wtype, source_location=location)
+        )
 
 
 def _get_bytes_expr(expr: Expression) -> ReinterpretCast:
     return ReinterpretCast(
         expr=expr, wtype=wtypes.bytes_wtype, source_location=expr.source_location
     )
```

## puya/ir/avm_ops.py

```diff
@@ -166,15 +166,15 @@
     is available from `addw`.
     """
 
     add_bytes = AVMOpData(
         op_code="b+",
         variants=Variant(
             signature=OpSignature(
-                args=[StackType.bigint, StackType.bigint], returns=[StackType.bytes]
+                args=[StackType.bigint, StackType.bigint], returns=[StackType.bigint]
             ),
             supported_modes=RunMode.any,
         ),
         immediate_types=(),
         cost=10,
         min_avm_version=4,
         supported_modes=RunMode.any,
@@ -4027,15 +4027,15 @@
     is available from `mulw`.
     """
 
     mul_bytes = AVMOpData(
         op_code="b*",
         variants=Variant(
             signature=OpSignature(
-                args=[StackType.bigint, StackType.bigint], returns=[StackType.bytes]
+                args=[StackType.bigint, StackType.bigint], returns=[StackType.bigint]
             ),
             supported_modes=RunMode.any,
         ),
         immediate_types=(),
         cost=20,
         min_avm_version=4,
         supported_modes=RunMode.any,
```

## puya/ir/builder/_utils.py

```diff
@@ -222,7 +222,25 @@
         )
     )
 
 
 def mkblocks(loc: SourceLocation, *comments: str | None) -> Iterator[BasicBlock]:
     for c in comments:
         yield BasicBlock(comment=c, source_location=loc)
+
+
+def extract_const_int(expr: awst_nodes.Expression | int | None) -> int | None:
+    """
+    Check expr is an IntegerConstant, int literal, or None, and return constant value (or None)
+    """
+    match expr:
+        case None:
+            return None
+        case awst_nodes.IntegerConstant(value=value):
+            return value
+        case int(value):
+            return value
+        case _:
+            raise InternalError(
+                f"Expected either constant or None for index, got {type(expr).__name__}",
+                expr.source_location,
+            )
```

## puya/ir/builder/main.py

```diff
@@ -8,16 +8,27 @@
     nodes as awst_nodes,
     wtypes,
 )
 from puya.awst.nodes import BigUIntBinaryOperator, UInt64BinaryOperator
 from puya.errors import CodeError, InternalError
 from puya.ir.avm_ops import AVMOp
 from puya.ir.builder import arc4, flow_control, state
-from puya.ir.builder._utils import assert_value, assign, mkblocks
+from puya.ir.builder._utils import (
+    assert_value,
+    assign,
+    assign_targets,
+    extract_const_int,
+    mkblocks,
+    mktemp,
+)
 from puya.ir.builder.assignment import handle_assignment, handle_assignment_expr
+from puya.ir.builder.bytes import (
+    visit_bytes_intersection_slice_expression,
+    visit_bytes_slice_expression,
+)
 from puya.ir.builder.callsub import visit_subroutine_call_expression
 from puya.ir.builder.iteration import handle_for_in_loop
 from puya.ir.builder.itxn import InnerTransactionBuilder
 from puya.ir.context import IRBuildContext, IRFunctionBuildContext
 from puya.ir.models import (
     AddressConstant,
     BigUIntConstant,
@@ -406,61 +417,39 @@
         else:
             raise InternalError(
                 f"Field access IR lowering"
                 f" not implemented for base type {expr.base.wtype.name}",
                 expr.source_location,
             )
 
+    def visit_intersection_slice_expression(
+        self, expr: awst_nodes.IntersectionSliceExpression
+    ) -> TExpression:
+        if isinstance(expr.wtype, wtypes.WTuple):
+            values = list(self.visit_and_materialise(expr.base))
+            start_i = extract_const_int(expr.begin_index)
+            end_i = extract_const_int(expr.end_index)
+            return ValueTuple(source_location=expr.source_location, values=values[start_i:end_i])
+        elif expr.base.wtype == wtypes.bytes_wtype:
+            return visit_bytes_intersection_slice_expression(self.context, expr)
+        else:
+            raise InternalError(
+                f"IntersectionSlice operation IR lowering not implemented for {expr.wtype.name}",
+                expr.source_location,
+            )
+
     def visit_slice_expression(self, expr: awst_nodes.SliceExpression) -> TExpression:
         """Slices an enumerable type."""
         if isinstance(expr.wtype, wtypes.WTuple):
             values = list(self.visit_and_materialise(expr.base))
             start_i = extract_const_int(expr.begin_index)
             end_i = extract_const_int(expr.end_index)
             return ValueTuple(source_location=expr.source_location, values=values[start_i:end_i])
         elif expr.base.wtype == wtypes.bytes_wtype:
-            base = self.visit_and_materialise_single(expr.base)
-            if expr.begin_index is None and expr.end_index is None:
-                return base
-
-            if expr.begin_index is not None:
-                start_value = self.visit_and_materialise_single(expr.begin_index)
-            else:
-                start_value = UInt64Constant(value=0, source_location=expr.source_location)
-
-            if expr.end_index is not None:
-                stop_value = self.visit_and_materialise_single(expr.end_index)
-                return Intrinsic(
-                    op=AVMOp.substring3,
-                    args=[base, start_value, stop_value],
-                    source_location=expr.source_location,
-                )
-            elif isinstance(start_value, UInt64Constant):
-                # we can use extract without computing the length when the start index is
-                # a constant value and the end index is None (ie end of array)
-                return Intrinsic(
-                    op=AVMOp.extract,
-                    immediates=[start_value.value, 0],
-                    args=[base],
-                    source_location=expr.source_location,
-                )
-            else:
-                (base_length,) = assign(
-                    self.context,
-                    source_location=expr.source_location,
-                    source=Intrinsic(
-                        op=AVMOp.len_, args=[base], source_location=expr.source_location
-                    ),
-                    temp_description="base_length",
-                )
-                return Intrinsic(
-                    op=AVMOp.substring3,
-                    args=[base, start_value, base_length],
-                    source_location=expr.source_location,
-                )
+            return visit_bytes_slice_expression(self.context, expr)
         else:
             raise InternalError(
                 f"Slice operation IR lowering not implemented for {expr.wtype.name}",
                 expr.source_location,
             )
 
     def visit_index_expression(self, expr: awst_nodes.IndexExpression) -> TExpression:
@@ -706,24 +695,42 @@
                 op=AVMOp.or_, args=[left_var, right_var], source_location=expr.source_location
             )
 
         return condition or UInt64Constant(source_location=expr.source_location, value=0)
 
     def visit_reinterpret_cast(self, expr: awst_nodes.ReinterpretCast) -> TExpression:
         # should be a no-op for us, but we validate the cast here too
-        inner_avm_type = wtype_to_ir_type(expr.expr).avm_type
-        outer_avm_type = wtype_to_ir_type(expr).avm_type
+        source = self.visit_expr(expr.expr)
+        (inner_ir_type,) = source.types
+        outer_ir_type = wtype_to_ir_type(expr)
+        # don't need to do anything further if ir types are the same
+        if inner_ir_type == outer_ir_type:
+            return source
+        inner_avm_type = inner_ir_type.avm_type
+        outer_avm_type = outer_ir_type.avm_type
         if inner_avm_type != outer_avm_type:
             raise InternalError(
                 f"Tried to reinterpret {expr.expr.wtype} as {expr.wtype},"
                 " but resulting AVM types are incompatible:"
                 f" {inner_avm_type} and {outer_avm_type}, respectively",
                 expr.source_location,
             )
-        return expr.expr.accept(self)
+        target = mktemp(
+            self.context,
+            outer_ir_type,
+            source_location=expr.source_location,
+            description=f"reinterpret_{outer_ir_type.name}",
+        )
+        assign_targets(
+            self.context,
+            source=source,
+            targets=[target],
+            assignment_location=expr.source_location,
+        )
+        return target
 
     def visit_block(self, block: awst_nodes.Block) -> TStatement:
         for stmt in block.body:
             stmt.accept(self)
 
     def visit_if_else(self, stmt: awst_nodes.IfElse) -> TStatement:
         flow_control.handle_if_else(self.context, stmt)
@@ -1052,28 +1059,14 @@
                 case awst_nodes.NumericComparison.ne:
                     return AVMOp.neq
     raise InternalError(
         f"Unsupported operation of {numeric_comparison_equivalent} on type of {wtype}"
     )
 
 
-def extract_const_int(expr: awst_nodes.Expression | None) -> int | None:
-    """Check expr is an IntegerConstant or None, and return constant value (or None)"""
-    match expr:
-        case None:
-            return None
-        case awst_nodes.IntegerConstant(value=value):
-            return value
-        case _:
-            raise InternalError(
-                f"Expected either constant or None for index, got {type(expr).__name__}",
-                expr.source_location,
-            )
-
-
 def insert_on_create_call(context: IRFunctionBuildContext, to: Subroutine) -> None:
     txn_app_id_intrinsic = Intrinsic(
         source_location=None, op=AVMOp("txn"), immediates=["ApplicationID"]
     )
     (app_id_r,) = assign(
         context,
         source=txn_app_id_intrinsic,
```

## puya/teal/optimize/constant_stack_shuffling.py

```diff
@@ -7,15 +7,15 @@
 def perform_constant_stack_shuffling(block: models.TealBlock) -> bool:
     result = list[models.TealOp]()
     loads = list[models.TealOp]()
     modified = False
     for op in block.ops:
         if _is_constant_load(op):
             loads.append(op)
-        elif loads and op.op_code.startswith("dup"):
+        elif loads and op.op_code in ("dup", "dupn"):
             (n,) = op.immediates or (1,)
             assert isinstance(n, int)
             loads.extend([attrs.evolve(loads[-1], source_location=op.source_location)] * n)
             modified = True
         elif loads:
             match op:
                 case models.Uncover(n=n) if n < len(loads):
```

## puya/_typeshed/stdlib/algopy/_state.pyi

```diff
@@ -8,16 +8,16 @@
     """Local state associated with the application and an account"""
 
     def __init__(
         self,
         type_: type[_TState],
         /,
         *,
-        key: bytes | str | None = None,
-        description: str | None = None,
+        key: bytes | str = ...,
+        description: str = "",
     ) -> None:
         """Declare the local state key and it's associated type
 
         ```python
         self.names = LocalState(algopy.Bytes)
         ```
         """
@@ -88,26 +88,26 @@
 
     @typing.overload
     def __init__(
         self,
         type_: type[_TState],
         /,
         *,
-        key: bytes | str | None = None,
-        description: str | None = None,
+        key: bytes | str = ...,
+        description: str = "",
     ) -> None:
         """Declare the global state key and its type without initializing its value"""
 
     @typing.overload
     def __init__(
         self,
         initial_value: _TState,
         /,
-        key: str | bytes | None = None,
-        description: str | None = None,
+        key: str | bytes = ...,
+        description: str = "",
     ) -> None:
         """Declare the global state key and initialize its value"""
 
     @property
     def value(self) -> _TState:
         """Returns the value or and error if the value is not set
```

## puya/_typeshed/stdlib/algopy/_template_variables.pyi

```diff
@@ -1,12 +1,10 @@
 import typing
 
-from algopy import Bytes, BytesBacked, UInt64
-
-_T_co = typing.TypeVar("_T_co", bound=UInt64 | bool | Bytes | BytesBacked, covariant=True)
+_T_co = typing.TypeVar("_T_co", covariant=True)
 
 class _TemplateVarMethod(typing.Protocol[_T_co]):
     def __call__(self, variable_name: str, /, *, prefix: str = "TMPL_") -> _T_co: ...
 
 class _TemplateVarGeneric(typing.Protocol):
     def __getitem__(self, _: type[_T_co]) -> _TemplateVarMethod[_T_co]: ...
```

## puya/_typeshed/stdlib/algopy/_transaction.pyi

```diff
@@ -1,108 +1,187 @@
 import typing
 
 from algopy import Account, Application, Asset, Bytes, OnCompleteAction, TransactionType, UInt64
 
-class TransactionBaseProtocol(typing.Protocol):
+class _TransactionBaseProtocol(typing.Protocol):
     @property
-    def sender(self) -> Account: ...
+    def sender(self) -> Account:
+        """32 byte address"""
+
     @property
-    def fee(self) -> UInt64: ...
+    def fee(self) -> UInt64:
+        """microalgos"""
+
     @property
-    def first_valid(self) -> UInt64: ...
+    def first_valid(self) -> UInt64:
+        """round number"""
+
     @property
-    def first_valid_time(self) -> UInt64: ...
+    def first_valid_time(self) -> UInt64:
+        """UNIX timestamp of block before txn.FirstValid. Fails if negative"""
+
     @property
-    def last_valid(self) -> UInt64: ...
+    def last_valid(self) -> UInt64:
+        """round number"""
+
     @property
-    def note(self) -> Bytes: ...
+    def note(self) -> Bytes:
+        """Any data up to 1024 bytes"""
+
     @property
-    def lease(self) -> Bytes: ...
+    def lease(self) -> Bytes:
+        """32 byte lease value"""
+
     @property
-    def type_bytes(self) -> Bytes: ...
+    def type_bytes(self) -> Bytes:
+        """Transaction type as bytes"""
+
     @property
-    def type(self) -> TransactionType: ...
+    def type(self) -> TransactionType:
+        """Transaction type as integer"""
+
     @property
-    def group_index(self) -> UInt64: ...
+    def group_index(self) -> UInt64:
+        """Position of this transaction within an atomic transaction group.
+        A stand-alone transaction is implicitly element 0 in a group of 1"""
+
     @property
-    def txn_id(self) -> Bytes: ...
+    def txn_id(self) -> Bytes:
+        """The computed ID for this transaction. 32 bytes."""
+
     @property
-    def rekey_to(self) -> Account: ...
+    def rekey_to(self) -> Account:
+        """32 byte Sender's new AuthAddr"""
 
-class PaymentProtocol(typing.Protocol):
+class _PaymentProtocol(typing.Protocol):
     @property
-    def receiver(self) -> Account: ...
+    def receiver(self) -> Account:
+        """32 byte address"""
+
     @property
-    def amount(self) -> UInt64: ...
+    def amount(self) -> UInt64:
+        """microalgos"""
+
     @property
-    def close_remainder_to(self) -> Account: ...
+    def close_remainder_to(self) -> Account:
+        """32 byte address"""
 
-class KeyRegistrationProtocol(typing.Protocol):
+class _KeyRegistrationProtocol(typing.Protocol):
     @property
-    def vote_key(self) -> Bytes: ...
+    def vote_key(self) -> Bytes:
+        """32 byte address"""
+
     @property
-    def selection_key(self) -> Bytes: ...
+    def selection_key(self) -> Bytes:
+        """32 byte address"""
+
     @property
-    def vote_first(self) -> UInt64: ...
+    def vote_first(self) -> UInt64:
+        """The first round that the participation key is valid."""
+
     @property
-    def vote_last(self) -> UInt64: ...
+    def vote_last(self) -> UInt64:
+        """The last round that the participation key is valid."""
+
     @property
-    def vote_key_dilution(self) -> UInt64: ...
+    def vote_key_dilution(self) -> UInt64:
+        """Dilution for the 2-level participation key"""
+
     @property
-    def non_participation(self) -> bool: ...
+    def non_participation(self) -> bool:
+        """Marks an account nonparticipating for rewards"""
+
     @property
-    def state_proof_key(self) -> Bytes: ...
+    def state_proof_key(self) -> Bytes:
+        """64 byte state proof public key"""
 
-class AssetConfigProtocol(typing.Protocol):
+class _AssetConfigProtocol(typing.Protocol):
     @property
-    def config_asset(self) -> Asset: ...
+    def config_asset(self) -> Asset:
+        """Asset ID in asset config transaction"""
+
     @property
-    def total(self) -> UInt64: ...
+    def total(self) -> UInt64:
+        """Total number of units of this asset created"""
+
     @property
-    def decimals(self) -> UInt64: ...
+    def decimals(self) -> UInt64:
+        """Number of digits to display after the decimal place when displaying the asset"""
+
     @property
-    def default_frozen(self) -> bool: ...
+    def default_frozen(self) -> bool:
+        """Whether the asset's slots are frozen by default or not, 0 or 1"""
+
     @property
-    def unit_name(self) -> Bytes: ...
+    def unit_name(self) -> Bytes:
+        """Unit name of the asset"""
+
     @property
-    def asset_name(self) -> Bytes: ...
+    def asset_name(self) -> Bytes:
+        """The asset name"""
+
     @property
-    def url(self) -> Bytes: ...
+    def url(self) -> Bytes:
+        """URL"""
+
     @property
-    def metadata_hash(self) -> Bytes: ...
+    def metadata_hash(self) -> Bytes:
+        """32 byte commitment to unspecified asset metadata"""
+
     @property
-    def manager(self) -> Account: ...
+    def manager(self) -> Account:
+        """32 byte address"""
+
     @property
-    def reserve(self) -> Account: ...
+    def reserve(self) -> Account:
+        """32 byte address"""
+
     @property
-    def freeze(self) -> Account: ...
+    def freeze(self) -> Account:
+        """32 byte address"""
+
     @property
-    def clawback(self) -> Account: ...
+    def clawback(self) -> Account:
+        """32 byte address"""
 
-class AssetTransferProtocol(typing.Protocol):
+class _AssetTransferProtocol(typing.Protocol):
     @property
-    def xfer_asset(self) -> Asset: ...
+    def xfer_asset(self) -> Asset:
+        """Asset ID"""
+
     @property
-    def asset_amount(self) -> UInt64: ...
+    def asset_amount(self) -> UInt64:
+        """value in Asset's units"""
+
     @property
-    def asset_sender(self) -> Account: ...
+    def asset_sender(self) -> Account:
+        """32 byte address. Source of assets if Sender is the Asset's Clawback address."""
+
     @property
-    def asset_receiver(self) -> Account: ...
+    def asset_receiver(self) -> Account:
+        """32 byte address"""
+
     @property
-    def asset_close_to(self) -> Account: ...
+    def asset_close_to(self) -> Account:
+        """32 byte address"""
 
-class AssetFreezeProtocol(typing.Protocol):
+class _AssetFreezeProtocol(typing.Protocol):
     @property
-    def freeze_asset(self) -> Asset: ...
+    def freeze_asset(self) -> Asset:
+        """Asset ID being frozen or un-frozen"""
+
     @property
-    def freeze_account(self) -> Account: ...
+    def freeze_account(self) -> Account:
+        """32 byte address of the account whose asset slot is being frozen or un-frozen"""
+
     @property
-    def frozen(self) -> bool: ...
+    def frozen(self) -> bool:
+        """The new frozen value, 0 or 1"""
 
-class ApplicationProtocol(typing.Protocol):
+class _ApplicationProtocol(typing.Protocol):
     @property
     def app_id(self) -> Application:
         """ApplicationID from ApplicationCall transaction"""
 
     @property
     def on_completion(self) -> OnCompleteAction:
         """ApplicationCall transaction on completion action"""
```

## puya/_typeshed/stdlib/algopy/arc4.pyi

```diff
@@ -2,61 +2,79 @@
 from collections.abc import Callable, Iterable, Mapping, Reversible, Sequence
 
 import algopy
 
 _P = typing.ParamSpec("_P")
 _R = typing.TypeVar("_R")
 
-AllowedOnCompletes: typing.TypeAlias = Sequence[
-    typing.Literal[
-        "NoOp",
-        "OptIn",
-        "CloseOut",
-        # ClearState has its own program, so is not considered as part of ARC4 routing
-        "UpdateApplication",
-        "DeleteApplication",
-    ]
-    | algopy.OnCompleteAction
-]
 """Allowed completion types for ABI methods: 
 NoOp, OptIn, CloseOut, UpdateApplication and DeleteApplication"""
 
 # TODO: better typing for ABI methods that can be used as an argument source
 # TODO: support declaring state at the class level so it can be used as a default arg source
 _TABIDefaultArgSource: typing.TypeAlias = object
 
 # if we use type aliasing here for Callable[_P, _R], mypy thinks it involves Any...
 @typing.overload
 def abimethod(fn: Callable[_P, _R], /) -> Callable[_P, _R]: ...
 @typing.overload
 def abimethod(
     *,
-    allow_actions: AllowedOnCompletes | None = None,
+    name: str = ...,
     create: typing.Literal["allow", "require", "disallow"] = "disallow",
-    name: str | None = None,
+    allow_actions: Sequence[
+        algopy.OnCompleteAction
+        | typing.Literal[
+            "NoOp",
+            "OptIn",
+            "CloseOut",
+            # ClearState has its own program, so is not considered as part of ARC4 routing
+            "UpdateApplication",
+            "DeleteApplication",
+        ]
+    ] = ("NoOp",),
     readonly: bool = False,
-    default_args: Mapping[str, str | _TABIDefaultArgSource] | None = None,
-) -> Callable[
-    [Callable[_P, _R]],
-    Callable[_P, _R],
-]:
-    """Decorator that indicates a method is an ARC4 ABI method"""
+    default_args: Mapping[str, str | _TABIDefaultArgSource] = ...,
+) -> Callable[[Callable[_P, _R]], Callable[_P, _R]]:
+    """Decorator that indicates a method is an ARC4 ABI method.
+
+    :arg name: Name component of the ABI method selector. Defaults to using the function name.
+    :arg create: Controls the validation of the Application ID. "require" means it must be zero,
+                 "disallow" requires it must be non-zero, and "allow" disables the validation.
+    :arg allow_actions: A sequence of allowed On-Completion Actions to validate against.
+    :arg readonly: If True, then this method can be used via dry-run / simulate.
+    :arg default_args: Default argument sources for clients to use.
+    """
 
 @typing.overload
 def baremethod(fn: Callable[_P, _R], /) -> Callable[_P, _R]: ...
 @typing.overload
 def baremethod(
     *,
-    allow_actions: AllowedOnCompletes | None = None,
     create: typing.Literal["allow", "require", "disallow"] = "disallow",
-) -> Callable[
-    [Callable[_P, _R]],
-    Callable[_P, _R],
-]:
-    """Decorator that indicates a method is an ARC4 bare method"""
+    allow_actions: Sequence[
+        algopy.OnCompleteAction
+        | typing.Literal[
+            "NoOp",
+            "OptIn",
+            "CloseOut",
+            # ClearState has its own program, so is not considered as part of ARC4 routing
+            "UpdateApplication",
+            "DeleteApplication",
+        ]
+    ] = ...,
+) -> Callable[[Callable[_P, _R]], Callable[_P, _R]]:
+    """Decorator that indicates a method is an ARC4 bare method.
+
+    There can be only one bare method on a contract for each given On-Completion Action.
+
+    :arg create: Controls the validation of the Application ID. "require" means it must be zero,
+                 "disallow" requires it must be non-zero, and "allow" disables the validation.
+    :arg allow_actions: Which On-Completion Action(s) to handle.
+    """
 
 def arc4_signature(signature: str, /) -> algopy.Bytes:
     """Returns the ARC4 encoded method selector for the specified signature"""
 
 class ARC4Contract(algopy.Contract):
     """A contract that conforms to the ARC4 ABI specification, functions decorated with
     `@abimethod` or `@baremethod` will form the public interface of the contract
@@ -473,15 +491,15 @@
         approval_program: algopy.Bytes | bytes | tuple[algopy.Bytes, ...] = ...,
         clear_state_program: algopy.Bytes | bytes | tuple[algopy.Bytes, ...] = ...,
         global_num_uint: UInt64 | int = ...,
         global_num_bytes: UInt64 | int = ...,
         local_num_uint: UInt64 | int = ...,
         local_num_bytes: UInt64 | int = ...,
         extra_program_pages: UInt64 | int = ...,
-        fee: algopy.UInt64 | int = ...,
+        fee: algopy.UInt64 | int = 0,
         sender: algopy.Account | str = ...,
         note: algopy.Bytes | bytes | str = ...,
         rekey_to: algopy.Account | str = ...,
     ) -> tuple[_TABIResult_co, algopy.itxn.ApplicationCallInnerTransaction]: ...
 
 class _ABICallProtocolType(typing.Protocol):
     @typing.overload
```

## puya/_typeshed/stdlib/algopy/gtxn.pyi

```diff
@@ -1,48 +1,48 @@
 import typing
 
 from algopy import UInt64
 from algopy._transaction import (
-    ApplicationProtocol,
-    AssetConfigProtocol,
-    AssetFreezeProtocol,
-    AssetTransferProtocol,
-    KeyRegistrationProtocol,
-    PaymentProtocol,
-    TransactionBaseProtocol,
+    _ApplicationProtocol,
+    _AssetConfigProtocol,
+    _AssetFreezeProtocol,
+    _AssetTransferProtocol,
+    _KeyRegistrationProtocol,
+    _PaymentProtocol,
+    _TransactionBaseProtocol,
 )
 
 class _GroupTransaction:
     def __init__(self, group_index: UInt64 | int): ...
 
-class TransactionBase(TransactionBaseProtocol, typing.Protocol):
+class TransactionBase(_TransactionBaseProtocol, typing.Protocol):
     """Shared transaction properties"""
 
-class PaymentTransaction(PaymentProtocol, TransactionBase, _GroupTransaction):
+class PaymentTransaction(_PaymentProtocol, TransactionBase, _GroupTransaction):
     """Payment group transaction"""
 
-class KeyRegistrationTransaction(KeyRegistrationProtocol, TransactionBase, _GroupTransaction):
+class KeyRegistrationTransaction(_KeyRegistrationProtocol, TransactionBase, _GroupTransaction):
     """Key registration group transaction"""
 
-class AssetConfigTransaction(AssetConfigProtocol, TransactionBase, _GroupTransaction):
+class AssetConfigTransaction(_AssetConfigProtocol, TransactionBase, _GroupTransaction):
     """Asset config group transaction"""
 
-class AssetTransferTransaction(AssetTransferProtocol, TransactionBase, _GroupTransaction):
+class AssetTransferTransaction(_AssetTransferProtocol, TransactionBase, _GroupTransaction):
     """Asset transfer group transaction"""
 
-class AssetFreezeTransaction(AssetFreezeProtocol, TransactionBase, _GroupTransaction):
+class AssetFreezeTransaction(_AssetFreezeProtocol, TransactionBase, _GroupTransaction):
     """Asset freeze group transaction"""
 
-class ApplicationCallTransaction(ApplicationProtocol, TransactionBase, _GroupTransaction):
+class ApplicationCallTransaction(_ApplicationProtocol, TransactionBase, _GroupTransaction):
     """Application call group transaction"""
 
 class Transaction(
-    PaymentProtocol,
-    KeyRegistrationProtocol,
-    AssetConfigProtocol,
-    AssetTransferProtocol,
-    AssetFreezeProtocol,
-    ApplicationProtocol,
+    _PaymentProtocol,
+    _KeyRegistrationProtocol,
+    _AssetConfigProtocol,
+    _AssetTransferProtocol,
+    _AssetFreezeProtocol,
+    _ApplicationProtocol,
     TransactionBase,
     _GroupTransaction,
 ):
     """Group Transaction of any type"""
```

## puya/_typeshed/stdlib/algopy/itxn.pyi

```diff
@@ -8,47 +8,47 @@
     BytesBacked,
     OnCompleteAction,
     TransactionType,
     UInt64,
     String,
 )
 from algopy._transaction import (
-    ApplicationProtocol,
-    AssetConfigProtocol,
-    AssetFreezeProtocol,
-    AssetTransferProtocol,
-    KeyRegistrationProtocol,
-    PaymentProtocol,
-    TransactionBaseProtocol,
+    _ApplicationProtocol,
+    _AssetConfigProtocol,
+    _AssetFreezeProtocol,
+    _AssetTransferProtocol,
+    _KeyRegistrationProtocol,
+    _PaymentProtocol,
+    _TransactionBaseProtocol,
 )
 
-class PaymentInnerTransaction(PaymentProtocol, TransactionBaseProtocol, typing.Protocol):
+class PaymentInnerTransaction(_PaymentProtocol, _TransactionBaseProtocol, typing.Protocol):
     """Payment inner transaction"""
 
 class KeyRegistrationInnerTransaction(
-    KeyRegistrationProtocol, TransactionBaseProtocol, typing.Protocol
+    _KeyRegistrationProtocol, _TransactionBaseProtocol, typing.Protocol
 ):
     """Key Registration inner transaction"""
 
-class AssetConfigInnerTransaction(AssetConfigProtocol, TransactionBaseProtocol, typing.Protocol):
+class AssetConfigInnerTransaction(_AssetConfigProtocol, _TransactionBaseProtocol, typing.Protocol):
     """Asset Config inner transaction"""
 
     @property
     def created_asset(self) -> Asset: ...
 
 class AssetTransferInnerTransaction(
-    AssetTransferProtocol, TransactionBaseProtocol, typing.Protocol
+    _AssetTransferProtocol, _TransactionBaseProtocol, typing.Protocol
 ):
     """Asset Transfer inner transaction"""
 
-class AssetFreezeInnerTransaction(AssetFreezeProtocol, TransactionBaseProtocol, typing.Protocol):
+class AssetFreezeInnerTransaction(_AssetFreezeProtocol, _TransactionBaseProtocol, typing.Protocol):
     """Asset Freeze inner transaction"""
 
 class ApplicationCallInnerTransaction(
-    ApplicationProtocol, TransactionBaseProtocol, typing.Protocol
+    _ApplicationProtocol, _TransactionBaseProtocol, typing.Protocol
 ):
     """Application Call inner transaction"""
 
     def logs(self, index: UInt64 | int) -> Bytes:
         """Log messages emitted by an application call"""
 
     @property
@@ -62,15 +62,15 @@
 class InnerTransactionResult(
     PaymentInnerTransaction,
     KeyRegistrationInnerTransaction,
     AssetConfigInnerTransaction,
     AssetTransferInnerTransaction,
     AssetFreezeInnerTransaction,
     ApplicationCallInnerTransaction,
-    TransactionBaseProtocol,
+    _TransactionBaseProtocol,
 ):
     """An inner transaction of any type"""
 
 _TResult_co = typing.TypeVar(
     "_TResult_co",
     covariant=True,
 )
@@ -104,15 +104,15 @@
         ## asset config
         config_asset: Asset | UInt64 | int = ...,
         total: UInt64 | int = ...,
         unit_name: String | Bytes | str | bytes = ...,
         asset_name: String | Bytes | str | bytes = ...,
         decimals: UInt64 | int = ...,
         default_frozen: bool = ...,
-        url: Bytes | bytes | str = ...,
+        url: String | Bytes | bytes | str = ...,
         metadata_hash: Bytes | bytes = ...,
         manager: Account | str = ...,
         reserve: Account | str = ...,
         freeze: Account | str = ...,
         clawback: Account | str = ...,
         ## asset transfer
         xfer_asset: Asset | UInt64 | int = ...,
@@ -122,16 +122,16 @@
         asset_close_to: Account | str = ...,
         ## asset freeze
         freeze_asset: Asset | UInt64 | int = ...,
         freeze_account: Account | str = ...,
         frozen: bool = ...,
         ## application call
         app_id: Application | UInt64 | int = ...,
-        approval_program: Bytes | bytes = ...,
-        clear_state_program: Bytes | bytes = ...,
+        approval_program: Bytes | bytes | tuple[Bytes, ...] = ...,
+        clear_state_program: Bytes | bytes | tuple[Bytes, ...] = ...,
         on_completion: OnCompleteAction | UInt64 | int = ...,
         global_num_uint: UInt64 | int = ...,
         global_num_bytes: UInt64 | int = ...,
         local_num_uint: UInt64 | int = ...,
         local_num_bytes: UInt64 | int = ...,
         extra_program_pages: UInt64 | int = ...,
         app_args: tuple[Bytes, ...] = ...,
@@ -163,15 +163,15 @@
         ## asset config
         config_asset: Asset | UInt64 | int = ...,
         total: UInt64 | int = ...,
         unit_name: String | Bytes | str | bytes = ...,
         asset_name: String | Bytes | str | bytes = ...,
         decimals: UInt64 | int = ...,
         default_frozen: bool = ...,
-        url: Bytes | bytes | str = ...,
+        url: String | Bytes | bytes | str = ...,
         metadata_hash: Bytes | bytes = ...,
         manager: Account | str = ...,
         reserve: Account | str = ...,
         freeze: Account | str = ...,
         clawback: Account | str = ...,
         ## asset transfer
         xfer_asset: Asset | UInt64 | int = ...,
@@ -181,16 +181,16 @@
         asset_close_to: Account | str = ...,
         ## asset freeze
         freeze_asset: Asset | UInt64 | int = ...,
         freeze_account: Account | str = ...,
         frozen: bool = ...,
         ## application call
         app_id: Application | UInt64 | int = ...,
-        approval_program: Bytes | bytes = ...,
-        clear_state_program: Bytes | bytes = ...,
+        approval_program: Bytes | bytes | tuple[Bytes, ...] = ...,
+        clear_state_program: Bytes | bytes | tuple[Bytes, ...] = ...,
         on_completion: OnCompleteAction | UInt64 | int = ...,
         global_num_uint: UInt64 | int = ...,
         global_num_bytes: UInt64 | int = ...,
         local_num_uint: UInt64 | int = ...,
         local_num_bytes: UInt64 | int = ...,
         extra_program_pages: UInt64 | int = ...,
         app_args: tuple[Bytes, ...] = ...,
```

## Comparing `puyapy-2.0.0.dist-info/COPYING` & `puyapy-2.0.1.dist-info/COPYING`

 * *Files identical despite different names*

## Comparing `puyapy-2.0.0.dist-info/LICENSE` & `puyapy-2.0.1.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `puyapy-2.0.0.dist-info/METADATA` & `puyapy-2.0.1.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: puyapy
-Version: 2.0.0
+Version: 2.0.1
 Summary: An optimising compiler for Algorand Python
 License: AGPL-3.0-or-later
 Author: Algorand Foundation
 Author-email: contact@algorand.foundation
 Requires-Python: >=3.12,<4.0
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
```

## Comparing `puyapy-2.0.0.dist-info/RECORD` & `puyapy-2.0.1.dist-info/RECORD`

 * *Files 2% similar despite different names*

```diff
@@ -769,63 +769,63 @@
 puya/_vendor/mypy/visitor.py,sha256=FTsBCo74V8F_Q_uId10wvORCQ8rexQjuQuUWhK21XdU,15882
 puya/_vendor/mypy/xml/mypy-html.css,sha256=-e3IQLmSIuw_RVP8BzyIIsgGg-eOsefWawOg2b3H2KY,1409
 puya/_vendor/mypy/xml/mypy-html.xslt,sha256=19QUoO3-8HArENuzA1n5sgTiIuUHQEl1YuFy9pJCd3M,3824
 puya/_vendor/mypy/xml/mypy-txt.xslt,sha256=r94I7UBJQRb-QVytQdPlpRVi4R1AZ49vgf1HN-DPp4k,4686
 puya/_vendor/mypy/xml/mypy.xsd,sha256=RQw6a6mG9eTaXDT5p2xxLX8rRhfDUyCMCeyDrmLIhdE,2173
 puya/algo_constants.py,sha256=WB8dnfzCGgoe97Mb4-PmxVpx5ZR5YU2j1ym_zgme-e8,661
 puya/arc32.py,sha256=rDmb-kONyl6NqBunWvMbpS8GOVgGjpUdCrgK392XQ8M,10673
-puya/arc4_util.py,sha256=TOqhwbSse7c0kAqSZEw2Ywb0Zn9Yr5hHTKYG_zHcIUg,7435
+puya/arc4_util.py,sha256=6FxW5I6p6jUACoPLOQbxVg1-mGclgI8vsU7Nm-5Yw84,7499
 puya/avm_type.py,sha256=GYOJ4ncoNKBHtc26mvh9Plxpz_f_pd3dUmw_uRzD17M,127
 puya/awst/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-puya/awst/function_traverser.py,sha256=upsoQASI2Ib65YyS1uDHd6u0euIy4n7EwAx0HQqQcdw,9829
-puya/awst/nodes.py,sha256=FaCajXcRIntl2HvChwZBKJFjUCon0mekZSiR2SYWIok,55887
-puya/awst/to_code_visitor.py,sha256=XDksH5XUyceGRUDjJ6yudy_Gy8qKijZOoqjsZ3p6n5k,21981
-puya/awst/visitors.py,sha256=5bnxz2Tr3Wp11XSMswu5JvGBUsdNyF3FuL7WeQvwsNs,8282
+puya/awst/function_traverser.py,sha256=W4pbjKOxIjT5biw0UDZLPhOpOCSBoulh8ufp7uyP_R4,10188
+puya/awst/nodes.py,sha256=7acbUe9sp5ePjpxjeJ92oJvJoZJoU0vEiJBrlI92NoE,56508
+puya/awst/to_code_visitor.py,sha256=U3HZOMhI2ewlVywwhymo8HCeOftd1fccpi9SPC_xvWc,22544
+puya/awst/visitors.py,sha256=aBkCULvBdgYB-_K2x_BGdUOPmazp0lX9cN0oBmkliwM,8428
 puya/awst/wtypes.py,sha256=-f3syHZNV0wGnd2Ecbd2ypVA4VunHAyR02-a_-EvQSM,17861
 puya/awst_build/README.md,sha256=fnCFui_VhpyuhOvxk4d_CgLByB3xpInzAQ-V8a07gm0,1211
 puya/awst_build/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 puya/awst_build/arc4_utils.py,sha256=hwoUCbiF7SaOGZqzEWKh0wexF-kLr-cFRubVXuxKmqg,13210
 puya/awst_build/base_mypy_visitor.py,sha256=OtN9u7tjjAa9SIwDTiZAf4K0sTChIZZQeZFvxwp3I8s,12152
-puya/awst_build/constants.py,sha256=O0Vo2N8VNGq6YPWwUPP19vm6WncGeWRRzxN-iEungVk,5442
+puya/awst_build/constants.py,sha256=mdi-JrQcQQpPXnyhe_fhjYKeNHuYxHMME9dUPxBGKbg,5503
 puya/awst_build/context.py,sha256=xIsPe5Uof5LHOWA6yBQmjtMkttjNIB22okczEdeiVLI,9138
 puya/awst_build/contract.py,sha256=flhxLpZKTRD1o2vkuntfMOajVlWghu73O0to4PjDRZk,22200
 puya/awst_build/contract_data.py,sha256=ymnrATbU0Sr2Z6bBxPwlgUPO2iB8UnzogKKFt-7EC-A,667
 puya/awst_build/eb/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 puya/awst_build/eb/_utils.py,sha256=g4xbA_RffHLihcCaqUfBySejqqgJKA3b7PjyWry2Ap0,1099
 puya/awst_build/eb/app_account_state.py,sha256=AVu31FtTwOHBBAlL-P-uLksTdlj1_p9K4r1Yz7NTHSQ,9182
 puya/awst_build/eb/app_state.py,sha256=6IEeIRje6Oq0DQHz_hRx_Ad0F8ewHQgdtFgX2Qds9wI,8336
 puya/awst_build/eb/arc4/__init__.py,sha256=yK4EcINrGeVLb1YNSjAQ8-H1ZuPg0Lz-CY9J_IpTbj8,429
-puya/awst_build/eb/arc4/_utils.py,sha256=AyP86HCZqUFO4XoNuNsDlDsjQO-Ih3oEuVA_dM16ePQ,10375
-puya/awst_build/eb/arc4/abi_call.py,sha256=0_-GUvbcUqQQWNLrmM0_S8WCVangvGIEet_tzhi_PGY,13733
+puya/awst_build/eb/arc4/_utils.py,sha256=pKIJYoDoKG96xApY6ghq9nyqXNIniVj9k-WuwsQnxFs,9328
+puya/awst_build/eb/arc4/abi_call.py,sha256=4e8peiWTz54LbzydOJSDsALt0sZa4qXFFVCLgxhEx-s,16048
 puya/awst_build/eb/arc4/arrays.py,sha256=79v6wferWm5AYYeAWzNkLAnHcuY6onEPn_n6vTxYUEs,21741
 puya/awst_build/eb/arc4/base.py,sha256=W0Es0sAfcRqI2e4aJmcXIfNNfB6BjmKR-HjpCPciRMU,7079
 puya/awst_build/eb/arc4/bool.py,sha256=fSneZO-i_FPLGrS85bdSe7GPw1IahZwi4_vX3qD5dZ0,1958
 puya/awst_build/eb/arc4/dynamic_bytes.py,sha256=6NP4MGFvWJRaaxWkTxumuaOqjeZD_LxTp1kPRt7J1ks,2856
 puya/awst_build/eb/arc4/emit.py,sha256=hfquNLic0DiqIeFujEXeGOlNG1nGUEkGSRwg1PbxJkA,2267
 puya/awst_build/eb/arc4/numeric.py,sha256=lGXAB-iMtQ4J44M-acsjhsmZVtyBV9H94w-ctSlsfeU,8276
 puya/awst_build/eb/arc4/string.py,sha256=LFu6lNflBqfJw4cCMEVZSQ2zxbLJxMa9bkHLKa5Nmr0,5591
 puya/awst_build/eb/arc4/struct.py,sha256=GPNp1Rr9mCC9yjy0gzgU4kjwhTN4_W6SwSPERcWwSp0,3832
 puya/awst_build/eb/arc4/tuple.py,sha256=iUh2tw3pes-g9bLdk-GdwaE6ZoMb-jW6745RZgpSZo4,4583
 puya/awst_build/eb/array.py,sha256=kFdv86uLAX3E2XLX7woJ_6lmAVBkOujZPPiHcNNtfWs,4444
 puya/awst_build/eb/base.py,sha256=9XW3Yhe9uV5SX5C6hHK7XhmFHXFliUPxsdQd8Mcd8Ws,15064
 puya/awst_build/eb/biguint.py,sha256=ehjECkeBUwve3IS3mnBV-7yjFNhuGw-fMgtEbGhe6Zo,6237
 puya/awst_build/eb/bool.py,sha256=2vvASBsuSzx9gvaFvyk7mc6AIrUMHAkceo4yw6EgzKo,2267
-puya/awst_build/eb/bytes.py,sha256=FEkbFptkkq0eTmegF2E6RrINys3kH3xIdOstaJIB17c,12185
+puya/awst_build/eb/bytes.py,sha256=lRCPJJJgBNeOVtLq0N3NrppWjnUTkKjFb9scxQYGILo,9466
 puya/awst_build/eb/bytes_backed.py,sha256=A4o1btidSS0zrk0tnVrMqZwTdQFBlLc33Ojp_FvEAbE,1974
 puya/awst_build/eb/contracts.py,sha256=eUKm8ekMMm1Q1ffATlNroLLe8cQf9ZrDnqTjn7Lyw7k,3239
 puya/awst_build/eb/ensure_budget.py,sha256=8v72QWDjeYtAPg6Q0rZZMYf9NU8JLbM_11CN6lWIo5s,3442
 puya/awst_build/eb/intrinsics.py,sha256=9IG2zW8nD5ahVzPnbMZQRRNvtUlDcj8memCniR1JD2Y,9453
 puya/awst_build/eb/log.py,sha256=QtFcZNVDVxg0h9tJK0IX_23es_mTQKAuh6nLef1bxt8,3521
 puya/awst_build/eb/named_int_constants.py,sha256=9te_ynj5ltVKX97KCxmVNdLKuqIu1It40YqMvHvixMk,1128
 puya/awst_build/eb/reference_types/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 puya/awst_build/eb/reference_types/account.py,sha256=jyE2YZYUsZDEwmNG8p-N-SwdwaqNF0Ec_1POu-Umv5Q,7556
 puya/awst_build/eb/reference_types/application.py,sha256=3lSffkDmAVMl-BEhSW2500SLdQFgNXjDkhaG-MrFUDI,2638
 puya/awst_build/eb/reference_types/asset.py,sha256=Wi6nDKmWo_sSfpnBbZ97v9Xib33yk0-D5gr053TVXUU,4575
 puya/awst_build/eb/reference_types/base.py,sha256=7CGAzFy0cWX_JHF-1R59DkPhrDiVOP_czYI4FPutBLk,3237
-puya/awst_build/eb/string.py,sha256=lXOmi-CcoVIYk8m3SNlNvAg8iBAPO929f3avkkG6dSg,9618
+puya/awst_build/eb/string.py,sha256=By0w8CAUZnmYBQorGnNtj5QhInO0BsGP6brll8LAhZY,9724
 puya/awst_build/eb/struct.py,sha256=cwuWosas9zl_Cn0OFkXHh3LMPV1GfMBVvDAxfnQr8lY,1586
 puya/awst_build/eb/subroutine.py,sha256=So2vN5uKRj8vVLgZTe7O-5yCj5eMtClmureB1SwyGuQ,4078
 puya/awst_build/eb/template_variables.py,sha256=66JGSGu7bipGDndg-vrz-No7g-Hlj57uFlXEeCpqRfc,2963
 puya/awst_build/eb/transaction/__init__.py,sha256=PmG5aQT08Mtjg45qfJeoQyMHqx8oCaosD5xPf3vSJuM,934
 puya/awst_build/eb/transaction/base.py,sha256=GQNbNHwM_LBG4BRz5FQPDKh-uZoXOJKRkoQzSc4_Vig,1730
 puya/awst_build/eb/transaction/fields.py,sha256=7NKc8riGSgJESb4Ei20Ob0jwCZssgk0cKPsVYhANOco,1360
 puya/awst_build/eb/transaction/group.py,sha256=Hq6zTK_ZrrfVOkDXrRYd6ZykUPgDLUNuZYIA4EQ_eQI,5282
@@ -855,26 +855,27 @@
 puya/awst_build/validation/scratch_slots.py,sha256=c18RY4soW93AJe4sq8KaocnA3Odw7TwD0UkfX_dJ8O4,2083
 puya/client_gen.py,sha256=SMGQrllglwxFlJ24ppAueWNcZtIQiGyTiA58gh_N-Ug,6511
 puya/compile.py,sha256=FTdWUuWVLGElo4bN2uAmRM6o4tkg3YpGey500bRouY4,13918
 puya/context.py,sha256=ou6bPPtIzs1b14j_VCzF7762ZN8C2ksuGqBCteEzcv4,1858
 puya/errors.py,sha256=9z3aeUhPz4qiSYwS5UAzsMd1pomvvZ_feGoo82MDJYA,2039
 puya/ir/__init__.py,sha256=umMbCh7O7ZmsQGNFyD1e3LXav2bTpIWNgSDywb6Zzkk,105
 puya/ir/arc4_router.py,sha256=ziHCHqAy2qdPWdQSZ3iWN9IA8IDiSkkygdFOJZlS9E4,26535
-puya/ir/avm_ops.py,sha256=n3nlxG7Yb3-ONT9DeOSYQTpXdPm9lk7QBcpbaxBkuhE,183589
+puya/ir/avm_ops.py,sha256=46HougWCS3TfgaFrZnXOTlOcS9tIqpiti3tsXpeI72k,183591
 puya/ir/avm_ops_models.py,sha256=upakbyr6Kf-5iad29Sjk0LYQ5X57B0Eps64sUHMc_6s,1352
 puya/ir/builder/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-puya/ir/builder/_utils.py,sha256=ErGwQFppvIqXFAJ136D9ib349e3p7iNizlYMAw3mzFQ,6675
+puya/ir/builder/_utils.py,sha256=XpQefi2MM-TpCmeomE9-6HgrDSVR7CfbkiCelisU4Fg,7247
 puya/ir/builder/arc4.py,sha256=MyzEJ_qMRRiTK1R6jPUH1a9jpZCsZwI61jxXm_oGK-0,57659
 puya/ir/builder/assignment.py,sha256=0E18h4eJoRyBufdicelH6BJgU3EeEhY3qhif-8pRfHE,6201
 puya/ir/builder/blocks.py,sha256=1HWKSe5DLPp91uRYm-CqBQtFL0UIi-CLgGGuc9AXLhI,6175
+puya/ir/builder/bytes.py,sha256=rIw9rYHLd5iwqCgu7TlqUs_OpkxIc31LUx9W4tI3zVg,6922
 puya/ir/builder/callsub.py,sha256=oz-OKHvZP2XpXtQeRQustQ1WtKGrEuzMCV0Ez58318A,3195
 puya/ir/builder/flow_control.py,sha256=ZwUDz_zXyl9-lk6BQYbbZEriqtvqlkEDjXX2oL469ec,8738
 puya/ir/builder/iteration.py,sha256=PNj1J0CF2KSCmKeQHIvOXrN35a4_0AkX6TSrpIB1yE8,24002
 puya/ir/builder/itxn.py,sha256=47XB1UBOqXRLOqNBibKgN-dJRnigyFiBqSMtK-MlpOg,25112
-puya/ir/builder/main.py,sha256=HybNax0wRNELd11OnE1Xkiiw_I9_ATac98_cmJpcL-4,43992
+puya/ir/builder/main.py,sha256=nFexQ-WSFxn6ajHo24Tj-cvGKDz_Wxxwg6cn2Gh1jNc,43367
 puya/ir/builder/state.py,sha256=60jRR1vvb_2vEzObifRrcCPPoeY5gvAXmmi5RnwbUOY,5148
 puya/ir/context.py,sha256=y2nVsdY25YAc4cIwny5dbT6WLWVKhz5YUctJQrVS2vA,6658
 puya/ir/destructure/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 puya/ir/destructure/coalesce_locals.py,sha256=sOPXl-_1Sn1bAKmfoxEr7w4fewicSgH_BKGLBgptoq0,7028
 puya/ir/destructure/main.py,sha256=LS02_vsoZHPc1KZoHDUfYDZaAG98Uuti14sBsH6LXN4,899
 puya/ir/destructure/optimize.py,sha256=6zm1IxQFrvN9J2CYyByMPv8DHbQe3lAnCX3ZgAXepXo,2619
 puya/ir/destructure/parcopy.py,sha256=IMFO1TLMpMZpqDa4xNX7rlFJx5S3hLVjrjwOZTTAv2U,4401
@@ -930,36 +931,36 @@
 puya/parse.py,sha256=sQI6SYvhNPyUSHnwtZR9EK62tQbZih2We3OFKCMdmIE,15722
 puya/py.typed,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 puya/teal/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 puya/teal/main.py,sha256=xelREKKfBcBrRbuBbjXJmKapHV0QqXk46C28CxvgW8w,2488
 puya/teal/models.py,sha256=ktUMcuLACg8tSRtTynGmv3UdUg8Wlf1yMipSWhISE1g,8386
 puya/teal/optimize/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 puya/teal/optimize/_data.py,sha256=QfcPvbUoI7ZVaU2Fe9HhUWycXEM5QYLNt-2d3Htk2WA,1645
-puya/teal/optimize/constant_stack_shuffling.py,sha256=KRQX_uf2cP1scxhymGZP-ovBwgOn0hJRbiQvNXX_U6A,2703
+puya/teal/optimize/constant_stack_shuffling.py,sha256=Kbp6TYS3kOVkAggW-m--LRrcVVe7mVloUNsRCo3Sjc4,2704
 puya/teal/optimize/main.py,sha256=CMQmcewGPi4bn--UPgHNrPO8EAsqMx5smw26KNs0NxA,1618
 puya/teal/optimize/peephole.py,sha256=c4SrVXxz4UCTj1M0aT1WK4htfefINQJq752A8IbnyVE,8381
 puya/teal/optimize/repeated_rotations.py,sha256=4bN_4Yu42ZC8oP80VJOFZXPugAYx3dF2fx2gbXPcFIE,1557
 puya/teal/optimize/repeated_rotations_search.py,sha256=cGgaYGZx3yoEAdJatdnGSL4BfYAMgtfUsnEOHZpwH_4,4276
 puya/teal/output.py,sha256=Sbyo9GPqdSHgoAbRyQehGAi9a6c1xzPtqC8eaUDUciA,1554
 puya/utils.py,sha256=aVKkmH0SGIKgglGbqb7zQB9bTCWahbTKudtqhVwx-Fw,7535
 puya/_typeshed/stdlib/algopy/__init__.pyi,sha256=7eDhxMg6VlWqwCwDECtBAZ7Gs9MLiulXGXudgBgcAVo,904
 puya/_typeshed/stdlib/algopy/_constants.pyi,sha256=e9ZdyynrOWoaTIzd_q-tEJKQ61eSX_jljdsBsyQEVGI,1806
 puya/_typeshed/stdlib/algopy/_contract.pyi,sha256=1H-IuwEZeIVcsMJse0Ux-XpLJeJz1PGntahBjFn-g_k,4047
 puya/_typeshed/stdlib/algopy/_hints.pyi,sha256=zhtGGW-0NicJIM51HUTy9L2JJ6Ffp_w7M51cIhkFzY0,648
 puya/_typeshed/stdlib/algopy/_logic_sig.pyi,sha256=juv7p4QZTNq1G4A3ODX45nPYq7zbya5PfN8Hipxq07Y,370
 puya/_typeshed/stdlib/algopy/_primitives.pyi,sha256=eTGxzpzTZmh8V_gELBGYqQXjFecjYIdf47AJEF5gOBI,20981
 puya/_typeshed/stdlib/algopy/_reference.pyi,sha256=88OmsV6SGMo5FL18HSK9MPda79WDyyfjemr1Wm5DjzA,9783
-puya/_typeshed/stdlib/algopy/_state.pyi,sha256=rEb14xKzHRCBvFsedz3HZOwXlM_Cz6V-WEqyyRq8WY4,4332
-puya/_typeshed/stdlib/algopy/_template_variables.pyi,sha256=5GNAWmBJAH9Mx1BS14jUDGeedYYy5kfM-tUlT5V8wlo,549
-puya/_typeshed/stdlib/algopy/_transaction.pyi,sha256=8L4NkTCdbBUptFNAWCS2b_29Urhyq6QkUicOH-KSA7E,5404
+puya/_typeshed/stdlib/algopy/_state.pyi,sha256=x1B7_Arj1qvWOyOiYG3c0bp6KbpY9DMPvjO5UrOWgVI,4281
+puya/_typeshed/stdlib/algopy/_template_variables.pyi,sha256=YhOI7cW_rjNHlf4Kr-WibzrPj4j42g7vSRDvJTLKM7U,459
+puya/_typeshed/stdlib/algopy/_transaction.pyi,sha256=XOVz_ktnU8RQZlw-7YbIwrgsNylR5qegk8g-V9JUQeM,7261
 puya/_typeshed/stdlib/algopy/_unsigned_builtins.pyi,sha256=-5GkX4Vbj1wxfP6HIppsKd0i_LX8G5LTz-JIEJSIHlU,1416
 puya/_typeshed/stdlib/algopy/_util.pyi,sha256=qNafgMcUc1Tmna26o8W0Ifso-xOeS5neHwYmBeexgtU,1040
-puya/_typeshed/stdlib/algopy/arc4.pyi,sha256=cYB444e_ZgWkkbWzuSIRuEkgU43fiaVgTLPC5akr8n8,20353
-puya/_typeshed/stdlib/algopy/gtxn.pyi,sha256=bhYkoxgrVcczh6sbaKk7xvTOu9otu-t9oWzZXYfuUv0,1491
-puya/_typeshed/stdlib/algopy/itxn.pyi,sha256=3Ij-yRQeIjpyvLcdQAxYPizs4vwq-eG154IH1oopTW8,21474
+puya/_typeshed/stdlib/algopy/arc4.pyi,sha256=zXE9cH_Beu0VaYNCHcTZs3WMwQqQaHKNxf6ff8dVZCU,21458
+puya/_typeshed/stdlib/algopy/gtxn.pyi,sha256=XhjhHYFJ1_3HD2COCg5VF669eZcUMnx5G81obpJzS-o,1511
+puya/_typeshed/stdlib/algopy/itxn.pyi,sha256=plDUR2vFsaHVhKdcjxMOe0SCXLs0jEjBjPzzgDJpl54,21592
 puya/_typeshed/stdlib/algopy/op.pyi,sha256=Oiye2_r8regt4OonOg1qWbsTDc36ChbuEy0DZ_h816k,150962
-puyapy-2.0.0.dist-info/COPYING,sha256=DZak_2itbUtvHzD3E7GNUYSRK6jdOJ-GqncQ2weavLA,34523
-puyapy-2.0.0.dist-info/LICENSE,sha256=jRyAzzkz3HPr-knS8XWyDY8CyuU-L4RtydPP8uGWsUw,657
-puyapy-2.0.0.dist-info/METADATA,sha256=4ls1x-EsyQH21KOixcfJJ_t1BnJxAptvs1Wm0pM8aQg,5101
-puyapy-2.0.0.dist-info/WHEEL,sha256=sP946D7jFCHeNz5Iq4fL4Lu-PrWrFsgfLXbbkciIZwg,88
-puyapy-2.0.0.dist-info/entry_points.txt,sha256=aznvB-Ck-TwWxW6Qtu3akZGtaE_gEtlG3nTtmIez_NU,83
-puyapy-2.0.0.dist-info/RECORD,,
+puyapy-2.0.1.dist-info/COPYING,sha256=DZak_2itbUtvHzD3E7GNUYSRK6jdOJ-GqncQ2weavLA,34523
+puyapy-2.0.1.dist-info/LICENSE,sha256=jRyAzzkz3HPr-knS8XWyDY8CyuU-L4RtydPP8uGWsUw,657
+puyapy-2.0.1.dist-info/METADATA,sha256=32liKwCwasyNm7Fiu3Wuk31gd0OkgS6lJvDHVeQy-9k,5101
+puyapy-2.0.1.dist-info/WHEEL,sha256=sP946D7jFCHeNz5Iq4fL4Lu-PrWrFsgfLXbbkciIZwg,88
+puyapy-2.0.1.dist-info/entry_points.txt,sha256=aznvB-Ck-TwWxW6Qtu3akZGtaE_gEtlG3nTtmIez_NU,83
+puyapy-2.0.1.dist-info/RECORD,,
```

